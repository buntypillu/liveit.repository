exec("import re;import base64");exec(base64.b64decode("IyMjIyMjIyMjIyMjIyNCSUJMSU9URUNBUyBBIElNUE9SVEFSIEUgREVGSU5JQ09FUyMjIyMjIyMjIyMjIyMjIyMjIyMjCmltcG9ydCB1cmxsaWIsdXJsbGliMixzeXMscmUseGJtY3BsdWdpbix4Ym1jZ3VpLHhibWNhZGRvbix4Ym1jLG9zLGpzb24sZ2xvYix0aHJlYWRpbmcsZ3ppcCx4Ym1jdmZzLGNvb2tpZWxpYixwcHJpbnQsZGF0ZXRpbWUsdGhyZWFkLHRpbWUsdXJscGFyc2UsYmFzZTY0LHBsdWdpbnRvb2xzLGNhbGVuZGFyCmltcG9ydCB4bWwuZXRyZWUuRWxlbWVudFRyZWUgYXMgRVQKaW1wb3J0IGZpbGVVdGlscyBhcyBmdQppbXBvcnQgYXN0CmZyb20gcmVzb3VyY2VzLmxpYiBpbXBvcnQgY29tbW9uCmZyb20gdXJsbGliMiBpbXBvcnQgUmVxdWVzdCwgdXJsb3Blbgpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRlCmZyb20gYnM0IGltcG9ydCBCZWF1dGlmdWxTb3VwCmZyb20gcmVzb3VyY2VzLmxpYiBpbXBvcnQgRG93bmxvYWRlciAjRW5lbjkyIGNsYXNzCmZyb20gcmVzb3VyY2VzLmxpYiBpbXBvcnQgUGxheWVyCmZyb20gcmVzb3VyY2VzLmxpYiBpbXBvcnQgVFZBcmNoaXZlCmZyb20gdDBtbTAuY29tbW9uLm5ldCBpbXBvcnQgTmV0CmZyb20gdDBtbTAuY29tbW9uLmFkZG9uIGltcG9ydCBBZGRvbgpmcm9tIHQwbW0wLmNvbW1vbi5uZXQgaW1wb3J0IEh0dHBSZXNwb25zZQpmcm9tIHJlc291cmNlcy5saWIgaW1wb3J0IFVSTFJlc29sdmVyTWVkaWEKZnJvbSByZXNvdXJjZXMubGliIGltcG9ydCBUcmFrdApmcm9tIHJlc291cmNlcy5saWIgaW1wb3J0IERhdGFiYXNlCmZyb20gdW5pY29kZWRhdGEgaW1wb3J0IG5vcm1hbGl6ZQp0cnk6CiAgICBpbXBvcnQgc3NsCiAgICBjb250ZXh0ID0gc3NsLlNTTENvbnRleHQoc3NsLlBST1RPQ09MX1RMU3YxKQpleGNlcHQ6CiAgICBwYXNzCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMgQ09OU1RBTlRFUyAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZ2xvYmFsIGdfdGltZXIKZ2xvYmFsIHRlbGV2aXNpb29uaWxpbmsKZ2xvYmFsIGZpbG1pbGluawpnbG9iYWwgYW5kbWVsaW5rCmdsb2JhbCB1dWVuZHVzbGluawpnbG9iYWwgdXVlbmR1c2VkCmdsb2JhbCB2YW5lbWFsdWtrCmdsb2JhbCB2ZXJzaW9uCmdsb2JhbCBtb2RlCgpyZWxvYWQoc3lzKQpzeXMuc2V0ZGVmYXVsdGVuY29kaW5nKCd1dGY4JykKbW9kZSA9IDMzMzMKdmVyc2lvbiA9ICIiCmthc3V0YWphbmltaSA9ICIiCnNhbGFzb25hID0gIiIKbGVoZWt5bGcgPSAiIgp2YW5lbWFrb29kID0gIiIKdmFuZW1hbHVrayA9ICIiCnRlbGV2aXNpb29uaWxpbmsgPSAiIgpmaWxtaWxpbmsgPSAiIgphbmRtZWxpbmsgPSAiIgoKX0xJSUxMXyA9ICJhSFIwY0RvdkwyeHBkbVZwZEd0dlpHa3VZMjl0TDFCSVVDOTJZV3hwWkdGMFpVRlFVQzV3YUhBPSIKX0xJSUxMXzIgPSAiYUhSMGNEb3ZMMnhwZG1WcGRHdHZaR2t1WTI5dEwxQklVQzlzYVhabGFYUXZiRzluYVc1QlVGQXVjR2h3IgpfX0FERE9OX0lEX18JPSB4Ym1jYWRkb24uQWRkb24oKS5nZXRBZGRvbkluZm8oImlkIikKX19BRERPTl9fCT0geGJtY2FkZG9uLkFkZG9uKF9fQURET05fSURfXykKX19BRERPTlZFUlNJT05fXyA9IF9fQURET05fXy5nZXRBZGRvbkluZm8oJ3ZlcnNpb24nKQpBZGRvblRpdGxlID0gX19BRERPTl9fLmdldEFkZG9uSW5mbygnbmFtZScpCkROU19ERUZJTkUgPSAnJwpfX0FERE9OX0ZPTERFUl9fCT0gX19BRERPTl9fLmdldEFkZG9uSW5mbygncGF0aCcpCl9fU0VUVElOR19fCT0geGJtY2FkZG9uLkFkZG9uKCkuZ2V0U2V0dGluZwpfX0FSVF9GT0xERVJfXwk9IF9fQURET05fRk9MREVSX18gKyAnL3Jlc291cmNlcy9pbWcvJwpfX1NLSU5fXyA9ICd2MicKX19RdWFsaWRhZGVfXyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCdxdWFsaWRhZGVGaWxtZXMnKQpfX0ZBTkFSVF9fID0gb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvLnBuZycpCl9fUEFTVEFfREFET1NfXyA9IEFkZG9uKF9fQURET05fSURfXykuZ2V0X3Byb2ZpbGUoKS5kZWNvZGUoInV0Zi04IikKX19BUElfXyA9IGJhc2U2NC51cmxzYWZlX2I2NGRlY29kZSgnYUhSMGNEb3ZMMjF3WVhCcExtMXNMdz09JykKX19BUElfU0lURV9fID0gYmFzZTY0LnVybHNhZmVfYjY0ZGVjb2RlKCdhSFIwY0RvdkwyMXdZWEJwTG0xc0wyRndhVzVsZHk4PScpCl9fU0lURV9fID0gYmFzZTY0LnVybHNhZmVfYjY0ZGVjb2RlKCdhSFIwY0RvdkwyMXljR2x5WVdONUxtZHhMdz09JykKX19GT0xERVJfRVBHX18gPSBvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdlcGdsaXZlbm93JykKX19DT09LSUVfRklMRV9fID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnbGl2ZW5vdycpCl9fU0lURUFkZG9uX18gPSBiYXNlNjQudXJsc2FmZV9iNjRkZWNvZGUoJ2FIUjBjRG92TDNkM2R5NXdZM1JsWTJ0elpYSjJMbU52YlM5SGNuVndiMHR2WkdrdlFXUmtiMjR2JykKX19TSVRFQkRfXyA9IGJhc2U2NC51cmxzYWZlX2I2NGRlY29kZSgnYUhSMGNEb3ZMM2QzZHk1d1kzUmxZMnR6WlhKMkxtTnZiUzlIY25Wd2IwdHZaR2t2VUVoUUx3PT0nKQpfSUNPTl8gPSBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvbi5wbmcnKQpfX0hFQURFUlNfXyA9IHsnVXNlci1BZ2VudCc6ICdNb3ppbGxhLzUuMCAoTWFjaW50b3NoOyBJbnRlbCBNYWMgT1MgWCAxMC4xMTsgcnY6NDMuMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC80My4wJywgJ0FjY2VwdCc6ICd0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSwqLyo7cT0wLjgnfQpoZWFkZXJzID0geydVc2VyLUFnZW50JzogJ01vemlsbGEvNS4wIChNYWNpbnRvc2g7IEludGVsIE1hYyBPUyBYIDEwLjExOyBydjo0My4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzQzLjAnLCAnQWNjZXB0LUNoYXJzZXQnOiAndXRmLTg7cT0wLjcsKjtxPTAuNycsICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbid9CgpDYXQgPSBfX0FERE9OX18uZ2V0U2V0dGluZygiQ2F0IikKY09yZE5DRiA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJjT3JkTkNGIikKY09yZE5DUyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJjT3JkTkNTIikKCkNsaXN0YT1bICJ0b2RvcyIsICJhY2FvIiwgImFuaW1hY2FvIiwgImF2ZW50dXJhIiwgImNvbWVkaWEiLCAiZHJhbWEiLCAiZmFudGFzaWEiLCAiZmljY2FvLWNpZW50aWZpY2EiLCAicm9tYW5jZSIsICJzdXNwZW5zZSIsICJ0ZXJyb3IiXQpDbGlzdGEzPVsiU2VtIGZpbHRybyAoTW9zdHJhciBUb2RvcykiLCJBw6fDo28iLCAiQW5pbWHDp8OjbyIsICJBdmVudHVyYSIsICJDb23DqWRpYSIsICJEcmFtYSIsICJGYW50YXNpYSIsICJGaWPDp8Ojby1DaWVudMOtZmljYSIsICJSb21hbmNlIiwgIlN1c3BlbnNlIiwgIlRlcnJvciJdCgpkZWYgc2V0Vmlld1MoKToKCXhibWNwbHVnaW4uc2V0Q29udGVudChpbnQoc3lzLmFyZ3ZbMV0pLCAndHZzaG93cycpCmRlZiBzZXRWaWV3TSgpOgoJeGJtY3BsdWdpbi5zZXRDb250ZW50KGludChzeXMuYXJndlsxXSksICdtb3ZpZXMnKQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwkJCQkJCQkgIEluaWNpYXIgQWRkb24JCQkJCQkJCQkJICAjCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpkZWYgX19BTEVSVEFfXyh0ZXh0MT0iIix0ZXh0Mj0iIix0ZXh0Mz0iIik6CglpZiB0ZXh0Mz09IiI6IHhibWNndWkuRGlhbG9nKCkub2sodGV4dDEsdGV4dDIpCgllbGlmIHRleHQyPT0iIjogeGJtY2d1aS5EaWFsb2coKS5vaygiIix0ZXh0MSkKCWVsc2U6IHhibWNndWkuRGlhbG9nKCkub2sodGV4dDEsdGV4dDIsdGV4dDMpCgpkZWYgY3JpYXJNZW51KHBhaSxub21lLGxvZ28sdXJsLHRpcG8sZmFuYXJ0KToKCW1lbnVzID0gewoJCQknbm9tZSc6ICcnLAoJCQknbG9nbyc6ICcnLAoJCQkndXJsJzogJycsCgkJCSd0aXBvJzogJycsCgkJCSdmYW5hcnQnOiAnJwoJCQl9CgltZW51c1snbm9tZSddID0gbm9tZQoJbWVudXNbJ2xvZ28nXSA9IGxvZ28KCW1lbnVzWyd1cmwnXSA9IHVybAoJbWVudXNbJ3RpcG8nXSA9IHRpcG8KCW1lbnVzWydmYW5hcnQnXSA9IGZhbmFydAoJcGFpLmFwcGVuZChtZW51cykKCQpkZWYgbWVudSgpOgoJaWYgKG5vdCBfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fbmFtZScpIG9yIG5vdCBfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fcGFzc3dvcmQnKSk6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnUHJlY2lzYSBkZSBkZWZpbmlyIG8gc2V1IFV0aWxpemFkb3IgZSBTZW5oYScpCgkJYWJyaXJEZWZpbmluY29lcygpCgkJCgllbHNlOgkKCQljaGVja19sb2dpbjIgPSBsb2dpbnBhaW5lbCgpCgkJaWYgY2hlY2tfbG9naW4yWyd1c2VyJ11bJ0Vycm8nXSAhPSAnJzoKCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCBjaGVja19sb2dpbjJbJ3VzZXInXVsnRXJybyddKQoJCWVsc2U6CgkJCV9MSUlMTF8gPSBjaGVja19sb2dpbjJbJ3VzZXInXVsnRE5TJ10KCQkJY2hlY2tfbG9naW4gPSBsb2dpbkxpdmVpdChfTElJTExfKQoJCQkjY2hlY2tfbG9naW4gPSBsb2dpbihfTElJTExfKQoJCQlpZiBjaGVja19sb2dpblsndXNlciddWydyZXN1bHRhZG8nXSA9PSAneWVzJzoKCQkJCWlmIGNoZWNrX2xvZ2luWyd1c2VyJ11bJ2VzdGFkbyddID09ICdJbmFjdGl2byc6CgkJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnQSBzdWEgY29udGEgZXN0w6EgRXhwaXJhZGEuIFBvciBmYXZvciBmYcOnYSBhIHN1YSBSZW5vdmHDp8OjbyBvdSBSZWFjdGl2YcOnw6NvLicpCQkKCQkJCWVsc2U6CgkJCQkJaWYgY2hlY2tfbG9naW5bJ3VzZXInXVsndHJpYWwnXSA9PSAnVGVzdGUnOgoJCQkJCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdBIGNvbnRhIMOpIHVtYSBjb250YSBkZSBUZXN0ZS4gQXDDs3MgbyB0ZXN0ZSBlIGdvc3RhciBmYcOnYSBhIHN1YSBBcXVpc2nDp8Ojby4nKQoJCQkJCWlmIGNoZWNrX2xvZ2luWyd1c2VyJ11bJ2RhdGEnXSA9PSAnMCcgYW5kIGNoZWNrX2xvZ2luWyd1c2VyJ11bJ3RyaWFsJ10gIT0gJ1Rlc3RlJzoKCQkJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnQSBzdWEgY29udGEgZXhwaXJhIEhvamUuIEZhw6dhIGrDoSBhIHN1YSBSZW5vdmHDp8Ojby4nKQoJCQkJCWVsc2U6CgkJCQkJCWlmIGNoZWNrX2xvZ2luWyd1c2VyJ11bJ2RpYXMnXSA9PSAnNScgb3IgY2hlY2tfbG9naW5bJ3VzZXInXVsnZGlhcyddID09ICc0JyBvciBjaGVja19sb2dpblsndXNlciddWydkaWFzJ10gPT0gJzMnIG9yIGNoZWNrX2xvZ2luWyd1c2VyJ11bJ2RpYXMnXSA9PSAnMicgb3IgY2hlY2tfbG9naW5bJ3VzZXInXVsnZGlhcyddID09ICcxJzoKCQkJCQkJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0Egc3VhIGNvbnRhIGV4cGlyYSBkYXF1aSBhICcrc3RyKGNoZWNrX2xvZ2luWyd1c2VyJ11bJ2RhdGEnXSkrICcgZGlhcy4gRmHDp2EgasOhIGEgc3VhIFJlbm92YcOnw6NvLicpCgkJCQkJY3JpYXJNZW51KGNoZWNrX2xvZ2luWydtZW51cyddLCJNaW5oYSBDb250YSIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb19jb24ucG5nJyksX0xJSUxMXywiY29udGEiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19jb24ucG5nJykpCgkJCQkJY3JpYXJNZW51KGNoZWNrX2xvZ2luWydtZW51cyddLCJWZXIgVFYiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fdHYucG5nJyksX0xJSUxMXywidHYiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb190di5wbmcnKSkKCQkJCQljcmlhck1lbnUoY2hlY2tfbG9naW5bJ21lbnVzJ10sIlbDrWRlbyBDbHViZSIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb192aWQucG5nJyksX0xJSUxMXywiZmlsbWVzIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fdmlkLnBuZycpKQoJCQkJCWNyaWFyTWVudShjaGVja19sb2dpblsnbWVudXMnXSwiVFYgQXJjaGl2ZSIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb190dl9hcmMucG5nJyksX0xJSUxMXywidHZhcmNoaXZlIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fdHZfYXJjLnBuZycpKQoJCQkJCQoJCQkJCWZpbG1lc19hcHAgPSBjaGVja19sb2dpbjJbJ3VzZXInXVsnRmlsbWVzX2FwcCddOwoJCQkJCWlmIGZpbG1lc19hcHAgPT0gNCBvciBmaWxtZXNfYXBwID09ICc0JzoKCQkJCQkJY3JpYXJNZW51KGNoZWNrX2xvZ2luWydtZW51cyddLCJFeHRyYXMiLF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJBZGRvbi9JbWFnZW5zL25vdmlkYWRlc3R2LnBuZyIsImV4dHJhcyIsImV4dHJhcyIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3R2X2FyYy5wbmcnKSkKCQkJCQljcmlhck1lbnUoY2hlY2tfbG9naW5bJ21lbnVzJ10sIkNvbmZpZ3VyYcOnw7VlcyIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb19kZWYucG5nJyksImNvbmZpZ3VyYXIiLCJjb25maWd1cmFyIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fZGVmLnBuZycpKQoJCQkJCWNyaWFyTWVudShjaGVja19sb2dpblsnbWVudXMnXSwiTGltcGFyIENhY2hlIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX2xpbS5wbmcnKSwibGltcGFyY2FjaGUiLCJsaW1wYXJjYWNoZSIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2xpbS5wbmcnKSkKCQkJCQljcmlhck1lbnUoY2hlY2tfbG9naW5bJ21lbnVzJ10sIkxpbXBhciBUdWRvIEdyYXZhZG8iLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fbGltLnBuZycpLCJsaW1wYXJ0dWRvIiwibGltcGFydHVkbyIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2xpbS5wbmcnKSkKCQkJCQlpZihjaGVja19sb2dpbjJbJ3VzZXInXVsnRW1haWwnXSAhPSAnJyBhbmQgY2hlY2tfbG9naW4yWyd1c2VyJ11bJ0VtYWlsJ10gIT0gJ2VtYWlsJyk6CgkJCQkJCWFkZExpbmtDYW5hbExpc3RhKCJbQ09MT1IgPSB3aGl0ZV1FbWFpbCBEw7p2aWRhczogWy9DT0xPUl0iK2NoZWNrX2xvZ2luMlsndXNlciddWydFbWFpbCddLCIiLCIiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fY29uLnBuZycpLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19jb24ucG5nJyksJycpCgkJCQkJaWYoY2hlY2tfbG9naW4yWyd1c2VyJ11bJ1dlYlNpdGUnXSAhPSAnJyBhbmQgY2hlY2tfbG9naW4yWyd1c2VyJ11bJ1dlYlNpdGUnXSAhPSAnaHR0cDovLycpOgoJCQkJCQlhZGRMaW5rQ2FuYWxMaXN0YSgiW0NPTE9SID0gd2hpdGVdQXF1aXNpw6fDo286IFsvQ09MT1JdIitjaGVja19sb2dpbjJbJ3VzZXInXVsnV2ViU2l0ZSddLCIiLCIiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fY29uLnBuZycpLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19jb24ucG5nJyksJycpCgkJCQkJTWVudV9pbmljaWFsKGNoZWNrX2xvZ2luLEZhbHNlLCcnKQoJCQkJX19FUEdfXyA9IF9MSUlMTF8rJ3htbHR2LnBocD91c2VybmFtZT0nK19fQURET05fXy5nZXRTZXR0aW5nKCdsb2dpbl9uYW1lJykrJyZwYXNzd29yZD0nK19fQURET05fXy5nZXRTZXR0aW5nKCdsb2dpbl9wYXNzd29yZCcpKycmZXBnX3NoaWZ0PTAnCgkJCQlfX0FERE9OX18uc2V0U2V0dGluZygnbGlzdGFfZXBnJywgX19FUEdfXykKCQkJCXRocmVhZC5zdGFydF9uZXdfdGhyZWFkKG9idGVyX2ZpY2hlaXJvX2VwZywgKCkgKQoJCQkJdmlzdGFfbWVudSgpCgkJCWVsaWYgY2hlY2tfbG9naW5bJ3VzZXInXVsncmVzdWx0YWRvJ10gPT0gJ3V0aWxpemFkb3InOgoJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVXRpbGl6YWRvciBpbmNvcnJldG8uJykKCQkJCWFkZERpcignQWx0ZXJhciBEZWZpbmnDp8O1ZXMnLCAndXJsJywgTm9uZSwgMTAwMCwgJ01pbmlhdHVyYScsIF9fU0lURUFkZG9uX18rIkltYWdlbnMvZGVmaW5pY29lcy5wbmciLCcnLCcnLCcnLCcnLF9fU0lURUFkZG9uX18rIkltYWdlbnMvZGVmaW5pY29lc19mYW5hcnQucG5nIikKCQkJCWFkZERpcignRW50cmFyIG5vdmFtZW50ZScsICd1cmwnLCBOb25lLCBOb25lLCAnTWluaWF0dXJhJywgX19TSVRFQWRkb25fXysiSW1hZ2Vucy9yZXRyb2NlZGVyLnBuZyIsJycsJycsJycsJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2FkZG9uLnBuZycpKQoJCQkJdmlzdGFfbWVudSgpCgkJCWVsaWYgY2hlY2tfbG9naW5bJ3VzZXInXVsncmVzdWx0YWRvJ10gPT0gJ3NlbmhhJzoKCQkJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1NlbmhhIGluY29ycmV0YS4nKQoJCQkJYWRkRGlyKCdBbHRlcmFyIERlZmluacOnw7VlcycsICd1cmwnLCBOb25lLCAxMDAwLCAnTWluaWF0dXJhJywgX19TSVRFQWRkb25fXysiSW1hZ2Vucy9kZWZpbmljb2VzLnBuZyIsJycsJycsJycsJycsX19TSVRFQWRkb25fXysiSW1hZ2Vucy9kZWZpbmljb2VzX2ZhbmFydC5wbmciKQoJCQkJYWRkRGlyKCdFbnRyYXIgbm92YW1lbnRlJywgJ3VybCcsIE5vbmUsIE5vbmUsICdNaW5pYXR1cmEnLCBfX1NJVEVBZGRvbl9fKyJJbWFnZW5zL3JldHJvY2VkZXIucG5nIiwnJywnJywnJywnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fYWRkb24ucG5nJykpCgkJCQl2aXN0YV9tZW51KCkKCQkJZWxpZiBjaGVja19sb2dpblsndXNlciddWydyZXN1bHRhZG8nXSA9PSAnYXRpdm8nOgoJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnTyBlc3RhZG8gZG8gc2V1IFV0aWxpemFkb3IgZW5jb250cmEtc2UgSW5hY3Rpdm8uIFBhcmEgc2FiZXIgbWFpcyBpbmZvcm1hw6fDtWVzIGVudHJlIGVtIGNvbnRhY3RvIHBlbG8gZW1haWwgbGl2ZWl0a29kaUBnbWFpbC5jb20uJykKCQkJCXZpc3RhX21lbnUoKQoJCQllbHNlOgoJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVXRpbGl6YWRvciBvdSBzZW5oYSBJbmNvcnJlY3Rvcy4gQWx0ZXJlIGUgdGVudGUgbm92YW1lbnRlLicpCgkJCQlhZGREaXIoJ0FsdGVyYXIgRGVmaW5pw6fDtWVzJywgJ3VybCcsIDUsICdNaW5pYXR1cmEnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX2RlZi5wbmcnKSwnJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2RlZi5wbmcnKSkKCQkJCWFkZERpcignRW50cmFyIG5vdmFtZW50ZScsICd1cmwnLCBOb25lLCAnTWluaWF0dXJhJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb19saW0ucG5nJyksJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2xpbS5wbmcnKSkKCQkJCXZpc3RhX21lbnUoKQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwkJCQkJCQkgIExvZ2luIEFkZG9uCQkJCQkJCQkJCSAgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZGVmIGxvZ2lucGFpbmVsKCk6CglpbmZvcm1hY29lcyA9IHsKCQkndXNlcicgOiB7CgkJCSdOb21lJzogJycsCgkJCSdBY2Vzc19Ub2tlbic6ICcnLAoJCQknRE5TJzogJycsCgkJCSdFbWFpbCc6ICcnLAoJCQknV2ViU2l0ZSc6ICcnLAoJCQknVmVyQVBQJzogJycsCgkJCSdMaW5rQVBQJzogJycsCgkJCSdFcnJvJzogJycsCgkJCSdTZXJpZXMnOiAnJywKCQkJJ01lbGhvcmFtZW50b3MnOiAnJywKCQkJJ0NsaWVudF9TZWNyZXRfVXNlcic6ICcnLAoJCQknRmlsbWVzX2FwcCc6ICcnCgkJfQoJfQoJdHJ5OgoJCW5ldCA9IE5ldCgpCgkJZGFkb3MgPSB7J25vbWVfYXBwJzogQWRkb25UaXRsZSwgJ3RpcG9fYXBwJzogJ0FkZG9uJywgJ3VzZXJuYW1lJzogX19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX25hbWUiKSwgJ3Bhc3N3b3JkJzogX19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX3Bhc3N3b3JkIil9CgkJY29kaWdvX2ZvbnRlID0gbmV0Lmh0dHBfUE9TVChiYXNlNjQuYjY0ZGVjb2RlKF9MSUlMTF8pLGZvcm1fZGF0YT1kYWRvcyxoZWFkZXJzPV9fSEVBREVSU19fKS5jb250ZW50CgkJZWxlbXMgPSBFVC5mcm9tc3RyaW5nKGNvZGlnb19mb250ZSkKCQlmb3IgY2hpbGQgaW4gZWxlbXM6CgkJCWlmKGNoaWxkLnRhZyA9PSAnZXJybycpOgoJCQkJI2luZm9ybWFjb2VzWyd1c2VyJ11bJ0Vycm8nXSA9IGNoaWxkLnRleHQKCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ05vbWUnXSA9IEFkZG9uVGl0bGUKCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ0FjZXNzX1Rva2VuJ10gPSAnJwoJCQkJX19BRERPTl9fLnNldFNldHRpbmcoJ2FjZXNzX1Rva2VuJywgJycpCgkJCQlpbmZvcm1hY29lc1sndXNlciddWydETlMnXSA9IGJhc2U2NC51cmxzYWZlX2I2NGRlY29kZShfX0FERE9OX18uZ2V0U2V0dGluZygnZG5zX2FkZG9uJykpCgkJCQlfX0VQR19fID0gaW5mb3JtYWNvZXNbJ3VzZXInXVsnRE5TJ10rJ3htbHR2LnBocD91c2VybmFtZT0nK19fQURET05fXy5nZXRTZXR0aW5nKCdsb2dpbl9uYW1lJykrJyZwYXNzd29yZD0nK19fQURET05fXy5nZXRTZXR0aW5nKCdsb2dpbl9wYXNzd29yZCcpKycmZXBnX3NoaWZ0PTAnCgkJCQlfX0FERE9OX18uc2V0U2V0dGluZygnbGlzdGFfZXBnJywgX19FUEdfXykKCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ0VtYWlsJ10gPSAnJwoJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnV2ViU2l0ZSddID0gJycKCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ1ZlckFQUCddID0gX19BRERPTlZFUlNJT05fXwoJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnTGlua0FQUCddID0gJycKCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ01lbGhvcmFtZW50b3MnXSA9ICcnCgkJCQlpbmZvcm1hY29lc1sndXNlciddWydGaWxtZXNfYXBwJ10gPSAnNScKCQkJCV9fQURET05fXy5zZXRTZXR0aW5nKCdlbWFpbCcsICcnKQoJCQkJX19BRERPTl9fLnNldFNldHRpbmcoJ3Bhc3N3b3JkJywgJycpCgkJCQlpbmZvcm1hY29lc1sndXNlciddWydDbGllbnRfU2VjcmV0X1VzZXInXSA9ICcnCgkJCQlfX0FERE9OX18uc2V0U2V0dGluZygnY2xpZW50X3NlY3JldF91c2VyJywgJycpCgkJCWVsaWYoY2hpbGQudGFnID09ICd2YWxpZGFjYW8nKToKCQkJCWZvciBkIGluIGNoaWxkOgoJCQkJCWlmKGQudGFnID09ICdOb21lJyk6CgkJCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ05vbWUnXSA9IGQudGV4dAoJCQkJCWVsaWYoZC50YWcgPT0gJ0FjZXNzX1Rva2VuJyk6CgkJCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ0FjZXNzX1Rva2VuJ10gPSBkLnRleHQKCQkJCQkJX19BRERPTl9fLnNldFNldHRpbmcoJ2FjZXNzX1Rva2VuJywgZC50ZXh0KQoJCQkJCWVsaWYoZC50YWcgPT0gJ0ROUycpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydETlMnXSA9IGQudGV4dAoJCQkJCWVsaWYoZC50YWcgPT0gJ0VtYWlsJyk6CgkJCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ0VtYWlsJ10gPSBkLnRleHQKCQkJCQllbGlmKGQudGFnID09ICdXZWJTaXRlJyk6CgkJCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ1dlYlNpdGUnXSA9IGQudGV4dAoJCQkJCWVsaWYoZC50YWcgPT0gJ1ZlckFQUCcpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydWZXJBUFAnXSA9IGQudGV4dAoJCQkJCWVsaWYoZC50YWcgPT0gJ0xpbmtBUFAnKToKCQkJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnTGlua0FQUCddID0gZC50ZXh0CgkJCQkJZWxpZihkLnRhZyA9PSAnTWVsaG9yYW1lbnRvcycpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydNZWxob3JhbWVudG9zJ10gPSBkLnRleHQKCQkJCQllbGlmKGQudGFnID09ICdmaWxtZXNfYXBwJyk6CgkJCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ0ZpbG1lc19hcHAnXSA9IGQudGV4dAoJCQkJCWVsaWYoZC50YWcgPT0gJ3VzZXJfa29kaScpOgoJCQkJCQlfX0FERE9OX18uc2V0U2V0dGluZygnZW1haWwnLCBkLnRleHQpCgkJCQkJZWxpZihkLnRhZyA9PSAnc2VuaGFfa29kaScpOgoJCQkJCQlfX0FERE9OX18uc2V0U2V0dGluZygncGFzc3dvcmQnLCBkLnRleHQpCgkJCQkJZWxpZihkLnRhZyA9PSAnQ2xpZW50X1NlY3JldF9Vc2VyJyk6CgkJCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ0NsaWVudF9TZWNyZXRfVXNlciddID0gZC50ZXh0CgkJCQkJCV9fQURET05fXy5zZXRTZXR0aW5nKCdjbGllbnRfc2VjcmV0X3VzZXInLCBkLnRleHQpCgkJCWVsc2U6CgkJCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdOw6NvIHNlaSBvIHF1ZSBlc3RvdSBhIGxlci4nKQoJZXhjZXB0OgoJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ05vbWUnXSA9IEFkZG9uVGl0bGUKCQlpbmZvcm1hY29lc1sndXNlciddWydBY2Vzc19Ub2tlbiddID0gJycKCQlfX0FERE9OX18uc2V0U2V0dGluZygnYWNlc3NfVG9rZW4nLCAnJykKCQlpbmZvcm1hY29lc1sndXNlciddWydETlMnXSA9IGJhc2U2NC51cmxzYWZlX2I2NGRlY29kZShfX0FERE9OX18uZ2V0U2V0dGluZygnZG5zX2FkZG9uJykpCgkJX19FUEdfXyA9IGluZm9ybWFjb2VzWyd1c2VyJ11bJ0ROUyddKyd4bWx0di5waHA/dXNlcm5hbWU9JytfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fbmFtZScpKycmcGFzc3dvcmQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fcGFzc3dvcmQnKSsnJmVwZ19zaGlmdD0wJwoJCV9fQURET05fXy5zZXRTZXR0aW5nKCdsaXN0YV9lcGcnLCBfX0VQR19fKQoJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ0VtYWlsJ10gPSAnJwoJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ1dlYlNpdGUnXSA9ICcnCgkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnVmVyQVBQJ10gPSBfX0FERE9OVkVSU0lPTl9fCgkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnTGlua0FQUCddID0gJycKCQlpbmZvcm1hY29lc1sndXNlciddWydNZWxob3JhbWVudG9zJ10gPSAnJwoJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ0ZpbG1lc19hcHAnXSA9ICc1JwoJCV9fQURET05fXy5zZXRTZXR0aW5nKCdlbWFpbCcsICcnKQoJCV9fQURET05fXy5zZXRTZXR0aW5nKCdwYXNzd29yZCcsICcnKQoJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ0NsaWVudF9TZWNyZXRfVXNlciddID0gJycKCQlfX0FERE9OX18uc2V0U2V0dGluZygnY2xpZW50X3NlY3JldF91c2VyJywgJycpCgkJI19fQUxFUlRBX18oQWRkb25UaXRsZSwgJ07Do28gZm9pIHBvc3PDrXZlbCBhYnJpciBhIHDDoWdpbmEuIFBvciBmYXZvciB0ZW50ZSBub3ZhbWVudGUuJykKCQlyZXR1cm4gaW5mb3JtYWNvZXMKCglyZXR1cm4gaW5mb3JtYWNvZXMKCmRlZiBsb2dpbkxpdmVpdCh1cmwpOgoJaW5mb3JtYWNvZXMgPSB7CgkJJ3VzZXInIDogewoJCQkndXNlcm5hbWUnOiAnJywKCQkJJ3Bhc3N3b3JkJzogJycsCgkJCSdlc3RhZG8nOiAnJywKCQkJJ2RhdGEnOiAnJywKCQkJJ2RpYXMnOiAnJywKCQkJJ3RyaWFsJzogJycsCgkJCSdjcmlhY2FvJzogJycsCgkJCSdzZXJpZXMnOiAnJywKCQkJJ2xpc3RhJzogJycsCgkJCSdyZXN1bHRhZG8nOiAnJywKCQkJJ2NvbmVjY29lcyc6ICcnCgkJCQoJCX0sCgkJJ21lbnVzJzogW10KCX0KCXRyeToKCQluZXQgPSBOZXQoKQoJCW5ldC5zZXRfY29va2llcyhfX0NPT0tJRV9GSUxFX18pCgkJZGFkb3MgPSB7J3VzZXJuYW1lJzogX19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX25hbWUiKSwgJ3Bhc3N3b3JkJzogX19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX3Bhc3N3b3JkIil9CgkJY29kaWdvX2ZvbnRlID0gbmV0Lmh0dHBfUE9TVChfX1NJVEVCRF9fKydMb2dpbkFkZG9uMi5waHAnLGZvcm1fZGF0YT1kYWRvcyxoZWFkZXJzPV9fSEVBREVSU19fKS5jb250ZW50CgkJZWxlbXMgPSBFVC5mcm9tc3RyaW5nKGNvZGlnb19mb250ZSkKCQlmb3IgY2hpbGQgaW4gZWxlbXM6CgkJCWlmKGNoaWxkLnRhZyA9PSAnc3VjZXNzbycpOgoJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsncmVzdWx0YWRvJ10gPSBjaGlsZC50ZXh0CgkJCWVsaWYoY2hpbGQudGFnID09ICd1c2VyJyk6CgkJCQlpbmZvcm1hY29lc1sndXNlciddWydsaXN0YSddID0gdXJsCgkJCQlmb3IgZCBpbiBjaGlsZDoKCQkJCQlpZihkLnRhZyA9PSAnRGF0YUZpbScpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydkYXRhJ10gPSBkLnRleHQKCQkJCQllbGlmKGQudGFnID09ICdkaWFzJyk6CgkJCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ2RpYXMnXSA9IGQudGV4dAoJCQkJCWVsaWYoZC50YWcgPT0gJ0RhdGFDcmlhY2FvJyk6CgkJCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ2NyaWFjYW8nXSA9IGQudGV4dAoJCQkJCWVsaWYoZC50YWcgPT0gJ0VxdWlwYW1lbnRvcycpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydjb25lY2NvZXMnXSA9ICJbQ09MT1IgPSB3aGl0ZV1NYXhpbW8gZGUgQ29ubmVjOiBbL0NPTE9SXSIrZC50ZXh0CgkJCQkJZWxpZihkLnRhZyA9PSAnVGlwb1VzZXInKToKCQkJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsndHJpYWwnXSA9IGQudGV4dAoJCQkJCWVsaWYoZC50YWcgPT0gJ0VzdGFkbycpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydlc3RhZG8nXSA9IGQudGV4dAoJCQkJCWVsaWYoZC50YWcgPT0gJ3NlcmllcycpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydzZXJpZXMnXSA9IGQudGV4dAoJCQkJCWVsaWYoZC50YWcgPT0gJ1NlbmhhJyk6CgkJCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ3Bhc3N3b3JkJ10gPSBkLnRleHQKCQkJCQllbGlmKGQudGFnID09ICdVdGlsaXphZG9yJyk6CgkJCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ3VzZXJuYW1lJ10gPSAiW0NPTE9SID0gd2hpdGVdVXRpbGl6YWRvcjogWy9DT0xPUl0iK2QudGV4dAoJCQkjZWxzZToKCQkJIwlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdOw6NvIHNlaSBvIHF1ZSBlc3RvdSBhIGxlci4nKQoJZXhjZXB0OgoJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ3VzZXJuYW1lJ10gPSAiIgoJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ3Bhc3N3b3JkJ10gPSAiIgoJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ2VzdGFkbyddID0gIiIKCQlpbmZvcm1hY29lc1sndXNlciddWydkYXRhJ10gPSAiIgoJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ3RyaWFsJ10gPSAiIgoJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ2NvbmVjY29lcyddID0gIiIKCQlpbmZvcm1hY29lc1sndXNlciddWydzZXJpZXMnXSA9ICIiCgkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnbGlzdGEnXSA9IHVybAoJCXJldHVybiBpbmZvcm1hY29lcwoJCglyZXR1cm4gaW5mb3JtYWNvZXMKCmRlZiBsb2dpbih1cmwpOgoJaW5mb3JtYWNvZXMgPSB7CgkJJ3VzZXInIDogewoJCQkndXNlcm5hbWUnOiAnJywKCQkJJ3Bhc3N3b3JkJzogJycsCgkJCSdlc3RhZG8nOiAnJywKCQkJJ2RhdGEnOiAnJywKCQkJJ3RyaWFsJzogJycsCgkJCSdsaXN0YSc6ICcnLAoJCQknY29uZWNjb2VzJzogJycKCQkJCgkJfSwKCQknbWVudXMnOiBbXQoJfSAjIAoJYW5kbWVsaW5rID0gdXJsKydwbGF5ZXJfYXBpLnBocD91c2VybmFtZT0nK19fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9uYW1lIikrJyZwYXNzd29yZD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9wYXNzd29yZCIpCglhbmRtZWQgPSBncmFiX2VwZyhhbmRtZWxpbmspCglpZiBhbmRtZWQgIT0gTm9uZToKCQlrYXN1dGFqYUFuZG1lZCA9IGFuZG1lZFtzeW5jX2RhdGEoImRYTmxjbDlwYm1adiIpXQoJCWthc3V0YWphQW5kbWVkMiA9IGFuZG1lZFtzeW5jX2RhdGEoImMyVnlkbVZ5WDJsdVptOD0iKV0KCQlzZWlzID0ga2FzdXRhamFBbmRtZWRbZ2V0X2xpdmUoImMzUmhkSFZ6IildCgkJYWVndWIgPSBrYXN1dGFqYUFuZG1lZFtzeW5jX2RhdGEoIlpYaHdYMlJoZEdVPSIpXQoJCWlmIGFlZ3ViOgoJCQlhZWd1YiA9IGRhdGUuZnJvbXRpbWVzdGFtcChpbnQoYWVndWIpKS5zdHJmdGltZSgiJVktJW0tJWQiKQoJCQkjI2VhZWFlbiA9IGthc3V0YWphQW5kbWVkMltzeW5jX2RhdGEoImRHbHRaVjl1YjNjPSIpXQoJCQkKCQkJdmlld1N0YXJ0RGF0ZSA9IGRhdGV0aW1lLmRhdGV0aW1lLm5vdygpLnN0cmZ0aW1lKCIlWS0lbS0lZCIpCgkJCQoJCQlmb3JtYXQgPSAiJVktJW0tJWQiCgkJCQoJCQl0cnk6CgkJCQlob2plMSA9IGRhdGV0aW1lLmRhdGV0aW1lLnN0cnB0aW1lKGFlZ3ViLCBmb3JtYXQpCgkJCWV4Y2VwdCBUeXBlRXJyb3I6CgkJCQlob2plMSA9IGRhdGV0aW1lLmRhdGV0aW1lKCoodGltZS5zdHJwdGltZShhZWd1YiwgZm9ybWF0KVswOjZdKSkKCQkJCgkJCXRyeToKCQkJCWhvamUyID0gZGF0ZXRpbWUuZGF0ZXRpbWUuc3RycHRpbWUodmlld1N0YXJ0RGF0ZSwgZm9ybWF0KQoJCQlleGNlcHQgVHlwZUVycm9yOgoJCQkJaG9qZTIgPSBkYXRldGltZS5kYXRldGltZSgqKHRpbWUuc3RycHRpbWUodmlld1N0YXJ0RGF0ZSwgZm9ybWF0KVswOjZdKSkKCQkJCgkJCWFlZ3ViID0gc3RyKGFicygoaG9qZTEtaG9qZTIpLmRheXMpKQoJCWVsc2U6CgkJCWFlZ3ViID0gdm9kX2NoYW5uZWxzKCJUbVYyWlhJPSIpIAoJCXJhYmJpdHMgPSBrYXN1dGFqYUFuZG1lZFt2b2RfY2hhbm5lbHMoImFYTmZkSEpwWVd3PSIpXQoJCWlmIHJhYmJpdHMgPT0gIjAiOgoJCQlyYWJiaXRzID0gc3luY19kYXRhKCJUbTg9IikKCQllbHNlOgoJCQlyYWJiaXRzID0gc3luY19kYXRhKCJXV1Z6IikKCQlsZWF2ZW1lYWxvbmUgPSBrYXN1dGFqYUFuZG1lZFtnZXRfbGl2ZSgiYldGNFgyTnZibTVsWTNScGIyNXoiKV0KCQlwb2xhcmJlYXJzID0ga2FzdXRhamFBbmRtZWRbc3luY19kYXRhKCJkWE5sY201aGJXVT0iKV0KCQkKCQlpZihwb2xhcmJlYXJzICE9ICcnKToKCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsndXNlcm5hbWUnXSA9ICJbQ09MT1IgPSB3aGl0ZV1VdGlsaXphZG9yOiBbL0NPTE9SXSIrcG9sYXJiZWFycwoJCQlpbmZvcm1hY29lc1sndXNlciddWydlc3RhZG8nXSA9IHNlaXMKCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnZGF0YSddID0gYWVndWIKCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsndHJpYWwnXSA9IHJhYmJpdHMKCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnY29uZWNjb2VzJ10gPSAiW0NPTE9SID0gd2hpdGVdTWF4aW1vIGRlIENvbm5lYzogWy9DT0xPUl0iK2xlYXZlbWVhbG9uZQoJCQlpbmZvcm1hY29lc1sndXNlciddWydsaXN0YSddID0gdXJsCgkKCXJldHVybiBpbmZvcm1hY29lcwoKZGVmIGxvZ2luMigpOgoJcmVzdWx0YWRvID0gRmFsc2UKCXRyeToKCQlwb3N0ID0gdXJsbGliLnVybGVuY29kZSh7J3VzZXJuYW1lJzogX19BRERPTl9fLmdldFNldHRpbmcoJ2VtYWlsJyksICdwYXNzd29yZCc6IF9fQURET05fXy5nZXRTZXR0aW5nKCdwYXNzd29yZCcpIH0pCgkJcmVzdWx0YWRvID0gYWJyaXJfdXJsKF9fQVBJX1NJVEVfXysnbG9naW4ucGhwJywgcG9zdD1wb3N0LCBoZWFkZXI9aGVhZGVycykKCQkKCQlpZiByZXN1bHRhZG8gPT0gJ0ROUyc6CgkJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1RlbSBkZSBhbHRlcmFyIG9zIEROUyBwYXJhIHBvZGVyIHVzdWZydWlyIGRvIF9fQURET05fXy4nKQoJCQlyZXR1cm4gRmFsc2UKCQkJCgkJdHJ5OgoJCQlyZXN1bHRhZG8gPSByZXN1bHRhZG8uZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OgoJCQlyZXN1bHRhZG8gPSByZXN1bHRhZG8uZW5jb2RlKCd1dGYtOCcpCgkJdHJ5OgoJCQlpZiByZXN1bHRhZG9bJ2NvZGlnbyddID09IDIwNDoKCQkJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgcmVzdWx0YWRvWydtZW5zYWdlbSddKQoJCQkJcmV0dXJuIEZhbHNlCgkJZXhjZXB0OgoJCQlwYXNzCgkJCgkJZXNjcmV2ZXJfZmljaGVpcm8ob3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnZGVmaW5pY29lcy5saXZlaXQnKSwgcmVzdWx0YWRvKQoJCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJCSNjb2xvY2FyIG8gbG9nZ2VkaW4KCQl0b2tlbiA9IHJlc3VsdGFkb1snY29va2llJ10KCQlyZWZyZXNoID0gcmVzdWx0YWRvWydleHBpcmEnXQoJCQoJCXRyeToKCQkJdXNlcm5hbWUgPSByZXN1bHRhZG9bJ3VzZXJuYW1lJ10uZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OgoJCQl1c2VybmFtZSA9IHJlc3VsdGFkb1sndXNlcm5hbWUnXS5lbmNvZGUoJ3V0Zi04JykKCQkKCQlfX0FERE9OX18uc2V0U2V0dGluZygndG9rZW5NcnBpcmFjeScsIHRva2VuKQoJCV9fQURET05fXy5zZXRTZXR0aW5nKCdyZWZyZXNoTXJwaXJhY3knLCByZWZyZXNoKQoJCV9fQURET05fXy5zZXRTZXR0aW5nKCdsb2dnZWRpbicsIHVzZXJuYW1lKQoJCQoJCWNhdGVnb3JpYXMgPSByZXN1bHRhZG9bJ2NhdGVnb3JpYXMnXQoJCWVzY3JldmVyX2ZpY2hlaXJvKG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ2NhdGVnb3JpYXMubGl2ZWl0JyksIHN0cihjYXRlZ29yaWFzKSkKCQlyZXR1cm4gVHJ1ZQoJZXhjZXB0OgoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ07Do28gZm9pIHBvc3PDrXZlbCBhYnJpciBhIHDDoWdpbmEuIFBvciBmYXZvciB0ZW50ZSBub3ZhbWVudGUuJykKCQlyZXR1cm4gRmFsc2UKCmRlZiBNZW51X2luaWNpYWwobWVuLGJ1aWxkLHRpcG8pOgoJX25vbWV1c2VyID0gbWVuWyd1c2VyJ11bJ3VzZXJuYW1lJ10KCWZvciBtZW51IGluIG1lblsnbWVudXMnXToKCQlub21lID0gbWVudVsnbm9tZSddCgkJbG9nbyA9IG1lbnVbJ2xvZ28nXQoJCWxpbmsgPSBtZW51Wyd1cmwnXQoJCXRpcG8gPSBtZW51Wyd0aXBvJ10KCQlmYW5hcnQgPSBtZW51WydmYW5hcnQnXQoJCQoJCWlmIHRpcG8gPT0gJ2NvbnRhJyA6CgkJCWFkZERpcihub21lLGxpbmssMiwnTGlzdGEnLGxvZ28sdGlwbyxmYW5hcnQpCgkJZWxpZih0aXBvID09ICd0dicpOgoJCQlhZGREaXIobm9tZSxsaW5rLDMsJ0xpc3RhJyxsb2dvLHRpcG8sZmFuYXJ0KQoJCWVsaWYodGlwbyA9PSAnZmlsbWVzJyk6CgkJCWFkZERpcihub21lLGxpbmssMSwnTGlzdGEnLGxvZ28sdGlwbyxmYW5hcnQpCgkJZWxpZih0aXBvID09ICdleHRyYXMnKToKCQkJYWRkRGlyKG5vbWUsbGluaywxMDYsJ0xpc3RhJyxsb2dvLHRpcG8sZmFuYXJ0KQoJCWVsaWYodGlwbyA9PSAnY29uZmlndXJhcicpOgoJCQlhZGREaXIobm9tZSxsaW5rLDUsJ0xpc3RhJyxsb2dvLHRpcG8sZmFuYXJ0KQoJCWVsaWYgdGlwbyA9PSAndHZhcmNoaXZlJzoKCQkJYWRkRGlyKG5vbWUsbGluayw2LCdMaXN0YScsbG9nbywnJyxmYW5hcnQpCgkJZWxpZih0aXBvID09ICdsaW1wYXJjYWNoZScpOgoJCQlhZGREaXIobm9tZSwgbGluaywgMTMsICdMaXN0YScsbG9nbyx0aXBvLGZhbmFydCkKCQllbGlmKHRpcG8gPT0gJ2xpbXBhcnR1ZG8nKToKCQkJYWRkRGlyKG5vbWUsIGxpbmssIDE0LCAnTGlzdGEnLGxvZ28sdGlwbyxmYW5hcnQpCgkJCgl4Ym1jLmV4ZWN1dGVidWlsdGluKCdOb3RpZmljYXRpb24oJXMsICVzLCAlaSwgJXMpJyUoQWRkb25UaXRsZSxfbm9tZXVzZXIsIDgwMDAsIF9JQ09OXykpCgl4Ym1jcGx1Z2luLmVuZE9mRGlyZWN0b3J5KGludChzeXMuYXJndlsxXSksY2FjaGVUb0Rpc2M9RmFsc2UpCgpkZWYgYWJyaXJFeHRyYXMoKToKCXVybG5vbzEgPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC9idXNjYXJyYWRpb3MucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZhZGRvbj0xJwoJYWRkRGlyKCJSw6FkaW9zIix1cmxub28xLDEwMiwnTGlzdGEnLF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJBZGRvbi9JbWFnZW5zL3JhZGlvcy5wbmciLCdwcmFpYXMnLF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJBZGRvbi9JbWFnZW5zL3JhZGlvc19mYW5hcnQucG5nIikKCXVybG5vbzEgPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC9idXNjYXJwcmFpYXMucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZhZGRvbj0xJwoJYWRkRGlyKCJQcmFpYXMiLHVybG5vbzEsMTAxLCdMaXN0YScsX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrIkFkZG9uL0ltYWdlbnMvbm92aWRhZGVzdHYucG5nIiwncHJhaWFzJyxfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsiQWRkb24vSW1hZ2Vucy9ub3ZpZGFkZXNfZmFuYXJ0LnBuZyIpCgl1cmxub28xID0gX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvYnVzY2FybmV3dGVsZW5vdmVsYXMucGhwP3RpcG89UHJvZ3JhbWFzJmNsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZhZGRvbj0xJwoJYWRkRGlyKCJQcm9ncmFtYXMgZSBUZWxlbm92ZWxhcyIsdXJsbm9vMSwxMDMsJ0xpc3RhJyxfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsiQWRkb24vSW1hZ2Vucy9ub3ZpZGFkZXN0di5wbmciLCdwcmFpYXMnLF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJBZGRvbi9JbWFnZW5zL25vdmlkYWRlc19mYW5hcnQucG5nIikKCXVybG5vbzEgPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC9idXNjYXJuZXd0ZWxlbm92ZWxhcy5waHA/dGlwbz1Kb3JuYWlzJmNsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZhZGRvbj0xJwoJYWRkRGlyKCJKb3JuYWlzIix1cmxub28xLDEwNywnTGlzdGEnLF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJBZGRvbi9JbWFnZW5zL25vdmlkYWRlc3R2LnBuZyIsJ2pvcm5haXMnLF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJBZGRvbi9JbWFnZW5zL25vdmlkYWRlc19mYW5hcnQucG5nIikKCQoJdmlzdGFfbWVudSgpCgpkZWYgbGlzdGFyX2dydXBvczEobW9kb24sdXJsLGZhbmFydCk6CglyZXN1bHRhZG8xID0gZGV2b2x2ZXJlc3VsdGFkbyh1cmwpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbzEpCglmb3IgaSBpbiByZXN1bHRhZG9bJ2NhbmFpcyddOgoJCWlkID0gaVsnSUQnXQoJCW5vbWUgPSAiIgoJCWltYWdlbSA9ICIiCgkJdXJsbiA9ICIiCgkJdHJ5OiBub21lID0gYmFzZTY0LmI2NGRlY29kZShpWydOb21lJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCXRyeTogCgkJCWltYWdlbSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnSW1hZ2VtJ10pLmRlY29kZSgndXRmLTgnKQoJCQlpbWFnZW0gPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsiTG9nb3MvIitpbWFnZW0KCQlleGNlcHQ6IHBhc3MKCQl0cnk6IHVybG4gPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ1VybCddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQlhZGRMaW5rQ2FuYWxMaXN0YShub21lLHVybG4saW1hZ2VtLCcnLGZhbmFydCwgJzAwMDEnKQoJCQpkZWYgbGlzdGFyX2dydXBvczIobW9kb24sdXJsLGZhbmFydCk6CglyZXN1bHRhZG8xID0gZGV2b2x2ZXJlc3VsdGFkbyh1cmwpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbzEpCglmb3IgaSBpbiByZXN1bHRhZG9bJ2NhbmFpcyddOgoJCWlkID0gaVsnSUQnXQoJCW5vbWUgPSAiIgoJCWltYWdlbSA9ICIiCgkJdXJsbiA9ICIiCgkJdHJ5OiBub21lID0gYmFzZTY0LmI2NGRlY29kZShpWydOb21lJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCXRyeTogCgkJCWltYWdlbSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnSW1hZ2VtJ10pLmRlY29kZSgndXRmLTgnKQoJCQlpbWFnZW0gPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsiTG9nb3MvIitpbWFnZW0KCQlleGNlcHQ6IHBhc3MKCQl0cnk6IHVybG4gPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ1VybCddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQlhZGRMaW5rQ2FuYWxMaXN0YShub21lLHVybG4saW1hZ2VtLCcnLGZhbmFydCwgJzAwMDEnKQoJCmRlZiBsaXN0YXJfZ3J1cG9zMyhtb2Rvbix1cmwsZmFuYXJ0KToKCXJlc3VsdGFkbzEgPSBkZXZvbHZlcmVzdWx0YWRvKHVybCkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvMSkKCWZvciBpIGluIHJlc3VsdGFkb1snY2FuYWlzJ106CgkJbm9tZSA9ICIiCgkJaW1hZ2VtID0gIiIKCQl1cmxuID0gIiIKCQl0aXBvID0gIiIKCQl3ZWJzaXRlID0gIiIKCQljYW5hbCA9ICIiCgkJdHJ5OiBub21lID0gYmFzZTY0LmI2NGRlY29kZShpWydOb21lJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCXRyeTogCgkJCWltYWdlbSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnSW1hZ2VtJ10pLmRlY29kZSgndXRmLTgnKQoJCQlpbWFnZW0gPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsiTG9nb3MvIitpbWFnZW0KCQlleGNlcHQ6IHBhc3MKCQl0cnk6IHVybG4gPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ1VybCddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQl0cnk6IHdlYnNpdGUgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ1dlYlNpdGUnXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OiBwYXNzCgkJdHJ5OiB0aXBvID0gaVsnVGlwbyddCgkJZXhjZXB0OiBwYXNzCgkJdHJ5OiBjYW5hbCA9IGlbJ0NhbmFsJ10KCQlleGNlcHQ6IHBhc3MKCQl1cmxub28zID0gX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvYnVzY2FyaW5mb3RlbGVub3ZlbGFzLnBocD90aXBvPScrdGlwbysnJndlYnNpdGU9Jyt3ZWJzaXRlKycmdXJsPScrdXJsbisnJmNsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZhZGRvbj0xJwoJCWFkZERpcihub21lLHVybG5vbzMsMTA0LCdMaXN0YScsaW1hZ2VtLCdQcm9ncmFtYXMnLF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJBZGRvbi9JbWFnZW5zL25vdmlkYWRlc19mYW5hcnQucG5nIikKCmRlZiBsaXN0YXJfZ3J1cG9zNChtb2Rvbix1cmwsaWNvbmltYWdlLGZhbmFydCk6CglyZXN1bHRhZG8xID0gZGV2b2x2ZXJlc3VsdGFkbyh1cmwpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbzEpCglmb3IgaSBpbiByZXN1bHRhZG9bJ2VwaXNvZGlvcyddOgoJCW5vbWUgPSAiIgoJCXVybG4gPSBpWyd1cmwnXQoJCXRyeTogbm9tZSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsndGl0dWxvJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCWFkZExpbmtDYW5hbExpc3RhKG5vbWUsdXJsbixpY29uaW1hZ2UsJ3Byb2dyYW1hcycsZmFuYXJ0LCAnMDAwMScpCgkJCmRlZiBsaXN0YXJfZ3J1cG9zNShtb2Rvbix1cmwsZmFuYXJ0KToKCXJlc3VsdGFkbzEgPSBkZXZvbHZlcmVzdWx0YWRvKHVybCkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvMSkKCWZvciBpIGluIHJlc3VsdGFkb1snY2FuYWlzJ106CgkJbm9tZSA9ICIiCgkJaW1hZ2VtID0gIiIKCQl1cmxuID0gIiIKCQl0aXBvID0gIiIKCQl3ZWJzaXRlID0gIiIKCQljYW5hbCA9ICIiCgkJdHJ5OiBub21lID0gYmFzZTY0LmI2NGRlY29kZShpWydOb21lJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCXRyeTogCgkJCWltYWdlbSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnSW1hZ2VtJ10pLmRlY29kZSgndXRmLTgnKQoJCQlpbWFnZW0gPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsiTG9nb3MvIitpbWFnZW0KCQlleGNlcHQ6IHBhc3MKCQl0cnk6IHVybG4gPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ1VybCddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQl0cnk6IHdlYnNpdGUgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ1dlYlNpdGUnXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OiBwYXNzCgkJdHJ5OiB0aXBvID0gaVsnVGlwbyddCgkJZXhjZXB0OiBwYXNzCgkJdHJ5OiBjYW5hbCA9IGlbJ0NhbmFsJ10KCQlleGNlcHQ6IHBhc3MKCQl1cmxub28zID0gX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvYnVzY2FyaW5mb3RlbGVub3ZlbGFzLnBocD90aXBvPWpvcm5haXMmdXJsPScrdXJsbisnJmNsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZhZGRvbj0xJwoJCWFkZERpcihub21lLHVybG5vbzMsMTA4LCdMaXN0YScsaW1hZ2VtLCdKb3JuYWlzJyxfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsiQWRkb24vSW1hZ2Vucy9ub3ZpZGFkZXNfZmFuYXJ0LnBuZyIpCgpkZWYgbGlzdGFyX2dydXBvczYobW9kb24sdXJsLGljb25pbWFnZSxmYW5hcnQpOgoJcmVzdWx0YWRvMSA9IGRldm9sdmVyZXN1bHRhZG8odXJsKQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8xKQoJZm9yIGkgaW4gcmVzdWx0YWRvWydlcGlzb2Rpb3MnXToKCQlub21lID0gIiIKCQl1cmxuID0gIiIKCQl0cnk6IG5vbWUgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ3RpdHVsbyddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQl0cnk6IHVybG4gPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ3VybCddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQkKCQlhZGREaXIobm9tZSx1cmxuLDEwOSwnTGlzdGEnLGljb25pbWFnZSwnUHJvZ3JhbWFzJyxmYW5hcnQpCgl4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTUpIikKCmRlZiBwbGF5X211bHRfY2FuYWwyKGFyZywgaWNvbiwgbm9tZSk6Cgl4Ym1jLmV4ZWN1dGVidWlsdGluKCdTaG93UGljdHVyZSgiezB9IiknLmZvcm1hdChhcmcpKQoKZGVmIGFicmlyVmlkZW9DbHViZSh1cmwpOgoJY2hlY2tfbG9naW4yID0gbG9naW5wYWluZWwoKQoJZmlsbWVzX2FwcCA9IGNoZWNrX2xvZ2luMlsndXNlciddWydGaWxtZXNfYXBwJ107CglmaWxtaWxpbmsgPSB1cmwrJ2VuaWdtYTIucGhwP3VzZXJuYW1lPScrX19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX25hbWUiKSsnJnBhc3N3b3JkPScrX19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX3Bhc3N3b3JkIikrJyZ0eXBlPWdldF92b2RfY2F0ZWdvcmllcycKCWlmIGZpbG1lc19hcHAgPT0gMCBvciBmaWxtZXNfYXBwID09ICcwJzoKCQlkYXRhYmFzZSA9IERhdGFiYXNlLmNyaWFyRmljaGVpcm9zKCkKCQlhZGREaXIoJ0ZpbG1lcyBkYSBMaXN0YScsZmlsbWlsaW5rLDQsJ01pbmlhdHVyYScsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ZpbG1lcy5wbmcnKSwnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fX19BRERPTl9fLnBuZycpKQoJCWFkZERpcignRmlsbWVzIGRvIEFkZG9uJyx1cmwsMjEsJ01pbmlhdHVyYScsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ZpbG1lcy5wbmcnKSwnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fX19BRERPTl9fLnBuZycpKQoJCWFkZERpcignU8OpcmllcyBkbyBBZGRvbicsdXJsLDIwLCdNaW5pYXR1cmEnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdzZXJpZXMucG5nJyksJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX19fQURET05fXy5wbmcnKSkKCQlhZGREaXIoJ0FuaW1lcyBkbyBBZGRvbicsdXJsLDI0LCdNaW5pYXR1cmEnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdhbmltZS5wbmcnKSwnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fX19BRERPTl9fLnBuZycpKQoJCWFkZERpcignW0NPTE9SIHBpbmtdW0JdUGVzcXVpc2FbL0JdWy9DT0xPUl0nLF9fQVBJX1NJVEVfXywxMjAsJ0xpc3RhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncGVzcXVpc2EucG5nJyksJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX19fQURET05fXy5wbmcnKSkKCWVsaWYgZmlsbWVzX2FwcCA9PSAxIG9yIGZpbG1lc19hcHAgPT0gJzEnOgoJCWFkZERpcignRmlsbWVzIGRhIExpc3RhJyxmaWxtaWxpbmssNCwnTWluaWF0dXJhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZmlsbWVzLnBuZycpLCcnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19fX0FERE9OX18ucG5nJykpCQkKCWVsaWYgZmlsbWVzX2FwcCA9PSAyIG9yIGZpbG1lc19hcHAgPT0gJzInOgoJCWFkZERpcignRmlsbWVzIGRhIExpc3RhJyxmaWxtaWxpbmssNCwnTWluaWF0dXJhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZmlsbWVzLnBuZycpLCcnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19fX0FERE9OX18ucG5nJykpCgkJYWRkRGlyKCdGaWxtZXMgZG8gQWRkb24nLHVybCw3MSwnTWluaWF0dXJhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZmlsbWVzLnBuZycpLCcnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19fX0FERE9OX18ucG5nJykpCgkJYWRkRGlyKCdTw6lyaWVzIGRvIEFkZG9uJyx1cmwsNjAsJ01pbmlhdHVyYScsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Nlcmllcy5wbmcnKSwnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fX19BRERPTl9fLnBuZycpKQoJCWFkZERpcignW0NPTE9SIHBpbmtdW0JdUGVzcXVpc2FbL0JdWy9DT0xPUl0nLHVybCwxNjAsJ0xpc3RhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncGVzcXVpc2EucG5nJyksJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX19fQURET05fXy5wbmcnKSkKCWVsaWYgZmlsbWVzX2FwcCA9PSA0IG9yIGZpbG1lc19hcHAgPT0gJzQnOgoJCWFkZERpcignRmlsbWVzIGRhIExpc3RhJyxmaWxtaWxpbmssNCwnTWluaWF0dXJhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZmlsbWVzLnBuZycpLCcnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19fX0FERE9OX18ucG5nJykpCgkJYWRkRGlyKCdGaWxtZXMgZG8gQWRkb24nLHVybCwyMTExMSwnTWluaWF0dXJhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZmlsbWVzLnBuZycpLCcnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19fX0FERE9OX18ucG5nJykpCgkJYWRkRGlyKCdTw6lyaWVzIGRvIEFkZG9uJyx1cmwsMjExMTIsJ01pbmlhdHVyYScsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Nlcmllcy5wbmcnKSwnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fX19BRERPTl9fLnBuZycpKQoJZWxzZToKCQlhZGREaXIoJ0ZpbG1lcyBkYSBMaXN0YScsZmlsbWlsaW5rLDQsJ01pbmlhdHVyYScsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ZpbG1lcy5wbmcnKSwnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fX19BRERPTl9fLnBuZycpKQkJCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCQkJCQkJCSAgQWJyaXIgSW5mbyBDb250YQkJCQkJCQkJCSAgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZGVmIEFicmlyX0NvbnRhKHVybCk6CglhbmRtZWxpbmsgPSB1cmwrJ3BsYXllcl9hcGkucGhwP3VzZXJuYW1lPScrX19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX25hbWUiKSsnJnBhc3N3b3JkPScrX19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX3Bhc3N3b3JkIikKCWV4ZWN1dGVfYWluZm8oYW5kbWVsaW5rKQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMJCQkJCQkJCQkJCQkJQWJyaXIgSW5mbyBUVlMJCQkJCQkJCQkJCSAjCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZGVmIGFicmltM3UodXJsKToKCXZlcnNpb24gPSBfX0FERE9OVkVSU0lPTl9fCglrYXN1dGFqYW5pbWk9X19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX25hbWUiKQoJc2FsYXNvbmE9X19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX3Bhc3N3b3JkIikKCWxlaGVreWxnPXVybAoJdmFuZW1ha29vZD1fX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fYWR1bHRvcyIpCgl2YW5lbWFsdWtrPV9fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9hZHVsdG9zX3NpbSIpCgkKCXRlbGV2aXNpb29uaWxpbmsgPSB1cmwrJy9lbmlnbWEyLnBocD91c2VybmFtZT0nK19fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9uYW1lIikrJyZwYXNzd29yZD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9wYXNzd29yZCIpKycmdHlwZT1nZXRfbGl2ZV9jYXRlZ29yaWVzJwoJc2VjdXJpdHlfY2hlY2sodGVsZXZpc2lvb25pbGluaykKCmRlZiBzZWN1cml0eV9jaGVjayh1cmwpOgoJdSA9IHVybGxpYjIuUmVxdWVzdCh1cmwsJycpCgl1LmFkZF9oZWFkZXIoJ0FjY2VwdCcsICdhcHBsaWNhdGlvbi94bWwnKQoJdS5hZGRfaGVhZGVyKCdVc2VyLWFnZW50JywgJ01vemlsbGEvNS4wIChXaW5kb3dzOyBVOyBXaW5kb3dzIE5UIDUuMTsgZW4tR0I7IHJ2OjEuOS4wLjMpIEdlY2tvLzIwMDgwOTI0MTcgRmlyZWZveC8zLjAuMycpCglyZXNwb25zZSA9IHVybGxpYjIudXJsb3Blbih1KQoJdHJlZSA9IEVULnBhcnNlKHJlc3BvbnNlKQoJcm9vdEVsZW0gPSB0cmVlLmdldHJvb3QoKQoJZm9yIGNoYW5uZWwgaW4gdHJlZS5maW5kYWxsKCJjaGFubmVsIik6CgkJa2FuYWxpbmltaSA9IGNoYW5uZWwuZmluZCgidGl0bGUiKS50ZXh0CgkJa2FuYWxpbmltaSA9IGJhc2U2NC5iNjRkZWNvZGUoa2FuYWxpbmltaSkKCQlrYXRlZ29vcmlhbGluayA9IGNoYW5uZWwuZmluZCgicGxheWxpc3RfdXJsIikudGV4dAoJCQoJCWFkZERpcihrYW5hbGluaW1pLGthdGVnb29yaWFsaW5rLDgsJ01pbmlhdHVyYScsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb190di5wbmcnKSwnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fdHYucG5nJykpCgkKCXZpc3RhX0dydXBvcygpCgpkZWYgZGV0ZWN0X21vZGlmaWNhdGlvbih1cmwpOgoJZmlsbWlsaW5rID0gdXJsKycvZW5pZ21hMi5waHA/dXNlcm5hbWU9JytfX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fbmFtZSIpKycmcGFzc3dvcmQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fcGFzc3dvcmQiKSsnJnR5cGU9Z2V0X3ZvZF9jYXRlZ29yaWVzJwoJdSA9IHVybGxpYjIuUmVxdWVzdChmaWxtaWxpbmssJycpCgl1LmFkZF9oZWFkZXIoJ0FjY2VwdCcsICdhcHBsaWNhdGlvbi94bWwnKQoJdS5hZGRfaGVhZGVyKCdVc2VyLWFnZW50JywgJ01vemlsbGEvNS4wIChXaW5kb3dzOyBVOyBXaW5kb3dzIE5UIDUuMTsgZW4tR0I7IHJ2OjEuOS4wLjMpIEdlY2tvLzIwMDgwOTI0MTcgRmlyZWZveC8zLjAuMycpCglyZXNwb25zZSA9IHVybGxpYjIudXJsb3Blbih1KQoJdHJlZSA9IEVULnBhcnNlKHJlc3BvbnNlKQoJcm9vdEVsZW0gPSB0cmVlLmdldHJvb3QoKQoJZm9yIGNoYW5uZWwgaW4gdHJlZS5maW5kYWxsKCJjaGFubmVsIik6CgkJZmlsbWluaW1pID0gY2hhbm5lbC5maW5kKCJ0aXRsZSIpLnRleHQKCQlmaWxtaW5pbWkgPSBiYXNlNjQuYjY0ZGVjb2RlKGZpbG1pbmltaSkKCQlrYXRlZ29vcmlhbGluayA9IGNoYW5uZWwuZmluZCgicGxheWxpc3RfdXJsIikudGV4dAoJCQoJCWFkZERpcihmaWxtaW5pbWksa2F0ZWdvb3JpYWxpbmssOSwnTWluaWF0dXJhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX3ZpZC5wbmcnKSwnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fdmlkLnBuZycpKQoJCgl2aXN0YV9HcnVwb3MoKQoKZGVmIHN0cmVhbV92aWRlbyhuYW1lLHVybCxpbWFnZSk6Cgl2YW5lbWFsdWtrPV9fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9hZHVsdG9zX3NpbSIpCglpZiB2YW5lbWFsdWtrID09ICJ0cnVlIjoKCQl2YW5lbWFfbHVrayhuYW1lKQoJdSA9IHVybGxpYjIuUmVxdWVzdCh1cmwsJycpCgl1LmFkZF9oZWFkZXIoJ0FjY2VwdCcsICdhcHBsaWNhdGlvbi94bWwnKQoJdS5hZGRfaGVhZGVyKCdVc2VyLWFnZW50JywgJ01vemlsbGEvNS4wIChXaW5kb3dzOyBVOyBXaW5kb3dzIE5UIDUuMTsgZW4tR0I7IHJ2OjEuOS4wLjMpIEdlY2tvLzIwMDgwOTI0MTcgRmlyZWZveC8zLjAuMycpCglyZXNwb25zZSA9IHVybGxpYjIudXJsb3Blbih1KQoJdHJlZSA9IEVULnBhcnNlKHJlc3BvbnNlKQoJcm9vdEVsZW0gPSB0cmVlLmdldHJvb3QoKQoJZm9yIGNoYW5uZWwgaW4gdHJlZS5maW5kYWxsKHN5bmNfZGF0YSgiWTJoaGJtNWxiQT09IikpOgoJCWthbmFsaW5pbWkgPSBjaGFubmVsLmZpbmQoZ2V0X2xpdmUoImRHbDBiR1U9IikpLnRleHQKCQlrYW5hbGluaW1pID0gYmFzZTY0LmI2NGRlY29kZShrYW5hbGluaW1pKQoJCWthbmFsaW5pbWkgPSBrYW5hbGluaW1pLnBhcnRpdGlvbigiWyIpCgkJc3RyaWltaWxpbmsgPSBjaGFubmVsLmZpbmQoZ2V0X2xpdmUoImMzUnlaV0Z0WDNWeWJBPT0iKSkudGV4dAoJCQoJCXVybGNoYW1hID0gc3RyaWltaWxpbmsuc3BsaXQoJy8nKQoJCXVybG5vbyA9ICcnCgkJdHJ5OgoJCQl1cmxub28gPSB1cmxjaGFtYVs1XQoJCQl1cmxub28gPSB1cmxub28ucmVwbGFjZSgndHMnLCcnKQoJCQl1cmxub28gPSB1cmxub28ucmVwbGFjZSgnbTN1OCcsJycpCgkJZXhjZXB0OgoJCQlwYXNzCgkJCgkJcGlsdCA9IGNoYW5uZWwuZmluZCgiZGVzY19pbWFnZSIpLnRleHQKCQlrYXZhID0ga2FuYWxpbmltaVsxXStrYW5hbGluaW1pWzJdCgkJa2F2YSA9IGthdmEucGFydGl0aW9uKCJdIikKCQlrYXZhID0ga2F2YVsyXQoJCWthdmEgPSBrYXZhLnBhcnRpdGlvbigiCSIpCgkJa2F2YSA9IGthdmFbMl0KCQlzaG91ID0gZ2V0X2xpdmUoIlcwTlBURTlTSUhkb2FYUmxYU1Z6SUZzdlEwOU1UMUpkIiklKGthbmFsaW5pbWlbMF0pK2thdmEKCQlraXJqZWxkdXMgPSBjaGFubmVsLmZpbmQoImRlc2NyaXB0aW9uIikudGV4dAoJCWlmIGtpcmplbGR1czoKCQkJa2lyamVsZHVzID0gYmFzZTY0LmI2NGRlY29kZShraXJqZWxkdXMpCgkJCW55eWQgPSBraXJqZWxkdXMucGFydGl0aW9uKCIoIikKCQkJbnl5ZCA9ICJBZ29yYTogIitueXlkWzBdCgkJCWphcmdtaW5lID0ga2lyamVsZHVzLnBhcnRpdGlvbigiKVxuIikKCQkJamFyZ21pbmUgPSBqYXJnbWluZVsyXS5wYXJ0aXRpb24oIigiKQoJCQlqYXJnbWluZSA9ICJBIHNlZ3VpcjogIitqYXJnbWluZVswXQoJCQlrb2trdSA9IG55eWQramFyZ21pbmUKCQllbHNlOgoJCQlrb2trdSA9ICIiCgkJaWYgcGlsdDoKCQkJYWRkTGlua0NhbmFsTGlzdGEoc2hvdSxzdHJpaW1pbGluayxwaWx0LGtva2t1LG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb190di5wbmcnKSwgdXJsbm9vKQoJCWVsc2U6CgkJCWFkZExpbmtDYW5hbExpc3RhKHNob3Usc3RyaWltaWxpbmssb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb190di5wbmcnKSxrb2trdSxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fdHYucG5nJyksIHVybG5vbykKCQoJeGJtY3BsdWdpbi5zZXRDb250ZW50KGludChzeXMuYXJndlsxXSkgLCJlcGlzb2RlcyIpCgl2aXN0YV9DYW5haXMoKQoKZGVmIGdldF9teWFjY291bnQobmFtZSx1cmwsaW1hZ2UpOgoJdmFuZW1hbHVraz1fX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fYWR1bHRvc19zaW0iKQoJaWYgdmFuZW1hbHVrayA9PSAidHJ1ZSI6CgkJdmFuZW1hX2x1a2sobmFtZSkKCXUgPSB1cmxsaWIyLlJlcXVlc3QodXJsLCcnKQoJdS5hZGRfaGVhZGVyKCdBY2NlcHQnLCAnYXBwbGljYXRpb24veG1sJykKCXUuYWRkX2hlYWRlcignVXNlci1hZ2VudCcsICdNb3ppbGxhLzUuMCAoV2luZG93czsgVTsgV2luZG93cyBOVCA1LjE7IGVuLUdCOyBydjoxLjkuMC4zKSBHZWNrby8yMDA4MDkyNDE3IEZpcmVmb3gvMy4wLjMnKQoJcmVzcG9uc2UgPSB1cmxsaWIyLnVybG9wZW4odSkKCXRyZWUgPSBFVC5wYXJzZShyZXNwb25zZSkKCXJvb3RFbGVtID0gdHJlZS5nZXRyb290KCkKCWZvciBjaGFubmVsIGluIHRyZWUuZmluZGFsbCgiY2hhbm5lbCIpOgoJCXBlYWxraXJpID0gY2hhbm5lbC5maW5kKCJ0aXRsZSIpLnRleHQKCQlwZWFsa2lyaSA9IGJhc2U2NC5iNjRkZWNvZGUocGVhbGtpcmkpCgkJcGVhbGtpcmkgPSBwZWFsa2lyaS5lbmNvZGUoInV0Zi04IikKCQlzdHJpaW1pbGluayA9IGNoYW5uZWwuZmluZCgic3RyZWFtX3VybCIpLnRleHQKCQkKCQl1cmxjaGFtYSA9IHN0cmlpbWlsaW5rLnNwbGl0KCcvJykKCQl1cmxub28gPSAnJwoJCXRyeToKCQkJdXJsbm9vID0gdXJsY2hhbWFbNV0KCQkJdXJsbm9vID0gdXJsbm9vLnJlcGxhY2UoJ3RzJywnJykKCQkJdXJsbm9vID0gdXJsbm9vLnJlcGxhY2UoJ20zdTgnLCcnKQoJCWV4Y2VwdDoKCQkJcGFzcwoJCQoJCXBpbHQgPSBjaGFubmVsLmZpbmQoImRlc2NfaW1hZ2UiKS50ZXh0IAoJCWRlc2NyaXB0ID0gY2hhbm5lbC5maW5kKCJkZXNjcmlwdGlvbiIpLnRleHQKCQlpZiBkZXNjcmlwdDoKCQkJZGVzY3JpcHQgPSBiYXNlNjQuYjY0ZGVjb2RlKGRlc2NyaXB0KQoJCWlmIHBpbHQ6CgkJCWFkZExpbmtDYW5hbExpc3RhKHBlYWxraXJpLHN0cmlpbWlsaW5rLHBpbHQsZGVzY3JpcHQsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3ZpZC5wbmcnKSwgdXJsbm9vKQoJCWVsc2U6CgkJCWFkZExpbmtDYW5hbExpc3RhKHBlYWxraXJpLHN0cmlpbWlsaW5rLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fdHYucG5nJyksZGVzY3JpcHQsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3ZpZC5wbmcnKSwgdXJsbm9vKQoJCgl4Ym1jcGx1Z2luLnNldENvbnRlbnQoaW50KHN5cy5hcmd2WzFdKSAsIm1vdmllcyIpCgl2aXN0YV9DYW5haXMoKQoKZGVmIGFkZExpbmtDYW5hbExpc3RhKHRpdGxlLCB1cmwsIHRodW1ibmFpbCwgcGxvdCwgZmFuYXJ0LCBpZGNhbmFsLCBpc1BsYXlhYmxlPVRydWUsIGZvbGRlcj1GYWxzZSk6Cglvaz1UcnVlCgljbT1bXQoJI2lmKGlkY2FuYWwgIT0gJzAwMDEnKToKCSMJY20uYXBwZW5kKCgnVmVyIHByb2dyYW1hw6fDo28nLCAnWEJNQy5SdW5QbHVnaW4oJXM/bW9kZT0zMSZuYW1lPSVzJnVybD0lcyZpY29uaW1hZ2U9JXMmaWRDYW5hbD0lcyZpZGZmQ2FuYWw9JXMpJyUoc3lzLmFyZ3ZbMF0sdXJsbGliLnF1b3RlX3BsdXModGl0bGUpLCB1cmxsaWIucXVvdGVfcGx1cyh1cmwpLCB1cmxsaWIucXVvdGVfcGx1cyh0aHVtYm5haWwpLCBpZGNhbmFsLCAnJykpKQoJCglsaXN0aXRlbT14Ym1jZ3VpLkxpc3RJdGVtKHRpdGxlLGljb25JbWFnZT10aHVtYm5haWwsdGh1bWJuYWlsSW1hZ2U9dGh1bWJuYWlsKQoJbGlzdGl0ZW0uYWRkQ29udGV4dE1lbnVJdGVtcyhjbSwgcmVwbGFjZUl0ZW1zPUZhbHNlKQoJaW5mb19sYWJlbHM9eyJUaXRsZSI6dGl0bGUsIkZpbGVOYW1lIjp0aXRsZSwiUGxvdCI6cGxvdH0KCWxpc3RpdGVtLnNldEluZm8oICJ2aWRlbyIsIGluZm9fbGFiZWxzICkKCWxpc3RpdGVtLnNldFByb3BlcnR5KCdmYW5hcnRfaW1hZ2UnLCBmYW5hcnQpCglsaXN0aXRlbS5zZXRBcnQoeydmYW5hcnQnOiBmYW5hcnR9KQoJbGlzdGl0ZW0uc2V0UHJvcGVydHkoIlZpZGVvIiwidHJ1ZSIpCgl1ID0gc3lzLmFyZ3ZbMF0gKyAiP3VybD0iICsgc3RyKHVybCkgKyAiJm1vZGU9MTAmbmFtZT0iICsgc3RyKG5hbWUpICsgIiZpY29uaW1hZ2U9IitzdHIoaWNvbmltYWdlKSsiJmZhbmFydD0iK3N0cihmYW5hcnQpKyImcGxvdD0iK3N0cihwbG90KQoJb2s9eGJtY3BsdWdpbi5hZGREaXJlY3RvcnlJdGVtKGhhbmRsZT1pbnQoc3lzLmFyZ3ZbMV0pLHVybD11LGxpc3RpdGVtPWxpc3RpdGVtLGlzRm9sZGVyPWZvbGRlcikKCXJldHVybiBvawoKZGVmIHJ1bl9jcm9uam9iKHRpdGxlLHVybCxpbWFnZSxwbG90LGZhbmFydCk6Cgl2YW5lbWFsdWtrPV9fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9hZHVsdG9zX3NpbSIpCglpZiB2YW5lbWFsdWtrID09ICJ0cnVlIjoKCQl2YW5lbWFfbHVrayhuYW1lKQoJCglpZiBwbG90ID09ICdwcm9ncmFtYXMnOgoJCXVybG4gPSAiIgoJCXRyeTogdXJsbiA9IGJhc2U2NC5iNjRkZWNvZGUodXJsKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQl1cmxjaGFtYSA9IHVybG4uc3BsaXQoJzs7OycpCgkJdXJsbm9vID0gX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvc2VhcmNodXJsLnBocD9jYW5hbD0nK3VybGNoYW1hWzBdKycmdXJsPScrdXJsY2hhbWFbMV0rJyZjbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmYWRkb249MScKCQkKCQltZW5zYWdlbXByb2dyZXNzbyA9IHhibWNndWkuRGlhbG9nUHJvZ3Jlc3MoKQoJCW1lbnNhZ2VtcHJvZ3Jlc3NvLmNyZWF0ZShBZGRvblRpdGxlLCB1J0FicmlyIGVtaXNzw6NvJywnUG9yIGZhdm9yIGFndWFyZGUuLi4nKQoJCW1lbnNhZ2VtcHJvZ3Jlc3NvLnVwZGF0ZSgyNSwgIiIsIHUnT2J0ZXIgdmlkZW8nLCAiIikKCQlyZXN1bHRhZG8xID0gZGV2b2x2ZXJlc3VsdGFkbyh1cmxub28pCgkJbWVuc2FnZW1wcm9ncmVzc28udXBkYXRlKDUwLCAiIiwgdSdQcmVwYXJhLXRlLCB2YWkgY29tZcOnYXIhJywgIiIpCgkJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8xKQoJCW1lbnNhZ2VtcHJvZ3Jlc3NvLnVwZGF0ZSg3NSwgIiIsIHUnQm9hIFNlc3PDo28hISEnLCAiIikKCQl1cmxuID0gIiIKCQlmb3IgaSBpbiByZXN1bHRhZG9bJ2luZm9ybWFjYW8nXToKCQkJdHJ5OiB1cmxuID0gYmFzZTY0LmI2NGRlY29kZShpWyd1cmwnXSkuZGVjb2RlKCd1dGYtOCcpCgkJCWV4Y2VwdDogcGFzcwoJCQkKCQltZW5zYWdlbXByb2dyZXNzby5jbG9zZSgpCgkJeGJtYy5zbGVlcCg1MDAwKQoJCXBsYXlsaXN0ID0geGJtYy5QbGF5TGlzdCh4Ym1jLlBMQVlMSVNUX1ZJREVPKQoJCXBsYXlsaXN0LmNsZWFyKCkKCQlpbmZvX2xhYmVscz17IlRpdGxlIjp0aXRsZSwiRmlsZU5hbWUiOnRpdGxlLCJQbG90IjpwbG90fQoJCWxpc3RpdGVtPXhibWNndWkuTGlzdEl0ZW0odGl0bGUsaWNvbkltYWdlPWltYWdlLHRodW1ibmFpbEltYWdlPWltYWdlKQoJCWxpc3RpdGVtLnNldEluZm8oICJ2aWRlbyIsIGluZm9fbGFiZWxzICkKCQlwbGF5bGlzdC5hZGQodXJsPXVybG4sIGxpc3RpdGVtPWxpc3RpdGVtLCBpbmRleD0xKQoJCXhibWMuUGxheWVyKCkucGxheShwbGF5bGlzdCkKCWVsc2U6CgkJcGxheWxpc3QgPSB4Ym1jLlBsYXlMaXN0KHhibWMuUExBWUxJU1RfVklERU8pCgkJcGxheWxpc3QuY2xlYXIoKQoJCWluZm9fbGFiZWxzPXsiVGl0bGUiOnRpdGxlLCJGaWxlTmFtZSI6dGl0bGUsIlBsb3QiOnBsb3R9CgkJbGlzdGl0ZW09eGJtY2d1aS5MaXN0SXRlbSh0aXRsZSxpY29uSW1hZ2U9aW1hZ2UsdGh1bWJuYWlsSW1hZ2U9aW1hZ2UpCgkJbGlzdGl0ZW0uc2V0SW5mbyggInZpZGVvIiwgaW5mb19sYWJlbHMgKQoJCXBsYXlsaXN0LmFkZCh1cmw9dXJsLCBsaXN0aXRlbT1saXN0aXRlbSwgaW5kZXg9MSkKCQl4Ym1jLlBsYXllcigpLnBsYXkocGxheWxpc3QpCgkKCmRlZiBzeW5jX2RhdGEoY2hhbm5lbCk6Cgl2aWRlbyA9IGJhc2U2NC5iNjRkZWNvZGUoY2hhbm5lbCkKCXJldHVybiB2aWRlbwoKZGVmIHJlc3RhcnRfc2VydmljZShwYXJhbXMpOgoJdmFuZW1hbHVraz1fX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fYWR1bHRvc19zaW0iKQoJaWYgdmFuZW1hbHVrayA9PSAidHJ1ZSI6CgkJcGVhbGtpcmkgPSBwYXJhbXMuZ2V0KHN5bmNfZGF0YSgiZEdsMGJHVT0iKSkKCQl2YW5lbWFfbHVrayhwZWFsa2lyaSkKCWxvcHBsaW5rID0gcGFyYW1zLmdldCh2b2RfY2hhbm5lbHMoImRYSnMiKSkKCQoJeGJtY3BsdWdpbi5zZXRSZXNvbHZlZFVybChpbnQoc3lzLmFyZ3ZbMV0pLCBUcnVlLCBsaXN0aXRlbSkKCmRlZiBncmFiX2VwZyh1cmwpOgoJcmVxID0gdXJsbGliMi5SZXF1ZXN0KHVybCkKCXJlcS5hZGRfaGVhZGVyKHN5bmNfZGF0YSgiVlhObGNpMUJaMlZ1ZEE9PSIpICwgdm9kX2NoYW5uZWxzKCJTMjlrYVNCd2JIVm5hVzRnWW5rZ1RHbDJaU0YwIikpCglyZXNwb25zZSA9IHVybGxpYjIudXJsb3BlbihyZXEpCglsaW5rPXJlc3BvbnNlLnJlYWQoKQoJamRhdGEgPSBqc29uLmxvYWRzKGxpbmsuZGVjb2RlKCd1dGY4JykpCglyZXNwb25zZS5jbG9zZSgpCglpZiBqZGF0YToKCQlyZXR1cm4gamRhdGEKCmRlZiBncmFiX2VwZzIodXJsKToKCXJlcSA9IHVybGxpYjIuUmVxdWVzdCh1cmwpCglyZXEuYWRkX2hlYWRlcignVXNlci1hZ2VudCcsICdNb3ppbGxhLzUuMCAoV2luZG93czsgVTsgV2luZG93cyBOVCA1LjE7IGVuLUdCOyBydjoxLjkuMC4zKSBHZWNrby8yMDA4MDkyNDE3IEZpcmVmb3gvMy4wLjMnKQoJcmVxLmFkZF9oZWFkZXIoc3luY19kYXRhKCJWWE5sY2kxQloyVnVkQT09IikgLCB2b2RfY2hhbm5lbHMoIlMyOWthU0J3YkhWbmFXNGdZbmtnVEdsMlpTRjAiKSkKCXJlc3BvbnNlID0gdXJsbGliMi51cmxvcGVuKHJlcSkKCWxpbms9cmVzcG9uc2UucmVhZCgpCglpZiBsaW5rICE9ICd7InVzZXJfaW5mbyI6eyJhdXRoIjowfX0nOgoJCWpkYXRhID0ganNvbi5sb2FkcyhsaW5rLmRlY29kZSgndXRmOCcpKQoJCXJlc3BvbnNlLmNsb3NlKCkKCQlpZiBqZGF0YToKCQkJcmV0dXJuIGpkYXRhCgllbHNlOgoJCXJldHVybiBOb25lCgkKZGVmIGtvbnRyb2xsKHVybCk6CglyYW5kb21zdHJpbmcgPSBncmFiX2VwZyh1cmwpCglrYXN1dGFqYWluZm8gPSByYW5kb21zdHJpbmdbc3luY19kYXRhKCJkWE5sY2w5cGJtWnYiKV0KCWtvbnRyb2xsID0ga2FzdXRhamFpbmZvW2dldF9saXZlKCJZWFYwYUE9PSIpXQoJcmV0dXJuIGtvbnRyb2xsCmRlZiBnZXRfbGl2ZShjaGFubmVsKToKCXZpZGVvID0gYmFzZTY0LmI2NGRlY29kZShjaGFubmVsKQoJcmV0dXJuIHZpZGVvCmRlZiBleGVjdXRlX2FpbmZvKHVybCk6CglhbmRtZWQgPSBncmFiX2VwZyh1cmwpCglrYXN1dGFqYUFuZG1lZCA9IGFuZG1lZFtzeW5jX2RhdGEoImRYTmxjbDlwYm1adiIpXQoJc2VpcyA9IGthc3V0YWphQW5kbWVkW2dldF9saXZlKCJjM1JoZEhWeiIpXQoJYWVndWIgPSBrYXN1dGFqYUFuZG1lZFtzeW5jX2RhdGEoIlpYaHdYMlJoZEdVPSIpXQoJaWYgYWVndWI6CgkJYWVndWIgPSBkYXRldGltZS5kYXRldGltZS5mcm9tdGltZXN0YW1wKGludChhZWd1YikpLnN0cmZ0aW1lKCclSDolTSAlZC4lbS4lWScpCgllbHNlOgoJCWFlZ3ViID0gdm9kX2NoYW5uZWxzKCJUbVYyWlhJPSIpIAoJcmFiYml0cyA9IGthc3V0YWphQW5kbWVkW3ZvZF9jaGFubmVscygiYVhOZmRISnBZV3c9IildCglpZiByYWJiaXRzID09ICIwIjoKCQlyYWJiaXRzID0gc3luY19kYXRhKCJUbTg9IikKCWVsc2U6CgkJcmFiYml0cyA9IHN5bmNfZGF0YSgiV1dWeiIpCglsZWF2ZW1lYWxvbmUgPSBrYXN1dGFqYUFuZG1lZFtnZXRfbGl2ZSgiYldGNFgyTnZibTVsWTNScGIyNXoiKV0KCXBvbGFyYmVhcnMgPSBrYXN1dGFqYUFuZG1lZFtzeW5jX2RhdGEoImRYTmxjbTVoYldVPSIpXQoJCglhZGRMaW5rQ2FuYWxMaXN0YSgiW0NPTE9SID0gd2hpdGVdVXRpbGl6YWRvcjogWy9DT0xPUl0iK3BvbGFyYmVhcnMsIiIsIiIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb19jb24ucG5nJyksb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2Nvbi5wbmcnKSwnJykKCQoJYWRkTGlua0NhbmFsTGlzdGEoIltDT0xPUiA9IHdoaXRlXUVzdGFkbzogWy9DT0xPUl0iK3NlaXMsIiIsIiIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb19jb24ucG5nJyksb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2Nvbi5wbmcnKSwnJykKCQoJYWRkTGlua0NhbmFsTGlzdGEoIltDT0xPUiA9IHdoaXRlXUV4cGlyYTogWy9DT0xPUl0iK2FlZ3ViLCIiLCIiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fY29uLnBuZycpLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19jb24ucG5nJyksJycpCgkKCWFkZExpbmtDYW5hbExpc3RhKCJbQ09MT1IgPSB3aGl0ZV1Db250YSBkZSBUZXN0ZTogWy9DT0xPUl0iK3JhYmJpdHMsIiIsIiIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb19jb24ucG5nJyksb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2Nvbi5wbmcnKSwnJykKCQoJYWRkTGlua0NhbmFsTGlzdGEoIltDT0xPUiA9IHdoaXRlXU1heGltbyBkZSBDb25uZWM6IFsvQ09MT1JdIitsZWF2ZW1lYWxvbmUsIiIsIiIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb19jb24ucG5nJyksb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2Nvbi5wbmcnKSwnJykKCQoJdmlzdGFfR3J1cG9zKCkKCmRlZiB2YW5lbWFfbHVrayhuYW1lKToKCWEgPSAnWFhYJywgJ0FkdWx0JywgJ0FkdWx0cycsJ0FEVUxUJywnQURVTFRTJywnYWR1bHQnLCdhZHVsdHMnLCdQb3JuJywnUE9STicsJ3Bvcm4nLCdQb3JuJywneHh4JwoJaWYgYW55KHMgaW4gbmFtZSBmb3IgcyBpbiBhKToKCQl4Ym1jLmV4ZWN1dGVidWlsdGluKCh1J1hCTUMuTm90aWZpY2F0aW9uKCJDb250cm9sbyBQYXJlbnRhbCIsICJPIGNhbmFsIGNvbnRlbSBjb250ZXVkbyBhZHVsdG8iLCAyMDAwKScpKQoJCXRleHQgPSBwbHVnaW50b29scy5rZXlib2FyZF9pbnB1dChkZWZhdWx0X3RleHQ9IiIsIHRpdGxlPSJDb2RpZ28gcGFyYSBjb250cm9sbyBwYXJlbnRhbCIpCgkJaWYgdGV4dD09cGx1Z2ludG9vbHMuZ2V0X3NldHRpbmcoc3luY19kYXRhKCJiRzluYVc1ZllXUjFiSFJ2Y3c9PSIpKToKCQkgIHJldHVybgoJCWVsc2U6CgkJICBleGl0KCkKCWVsc2U6CgkJbmFtZSA9ICIiCgpkZWYgRG93bmxvYWRlckNsYXNzKHVybCxkZXN0KToKCWRwID0geGJtY2d1aS5EaWFsb2dQcm9ncmVzcygpCglkcC5jcmVhdGUoc3luY19kYXRhKCJSMlYwZEdsdVp5QjFjR1JoZEdVPSIpLGdldF9saXZlKCJSRzkzYm14dllXUnBibWM9IikpCgl1cmxsaWIudXJscmV0cmlldmUodXJsLGRlc3QsbGFtYmRhIG5iLCBicywgZnMsIHVybD11cmw6IF9wYmhvb2sobmIsYnMsZnMsdXJsLGRwKSkKCmRlZiBfcGJob29rKG51bWJsb2NrcywgYmxvY2tzaXplLCBmaWxlc2l6ZSwgdXJsPU5vbmUsZHA9Tm9uZSk6Cgl0cnk6CgkJcGVyY2VudCA9IG1pbigobnVtYmxvY2tzKmJsb2Nrc2l6ZSoxMDApL2ZpbGVzaXplLCAxMDApCgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnJytwZXJjZW50KQoJCWRwLnVwZGF0ZShwZXJjZW50KQoJZXhjZXB0OgoJCXBlcmNlbnQgPSAxMDAKCQlkcC51cGRhdGUocGVyY2VudCkKCWlmIGRwLmlzY2FuY2VsZWQoKToKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdPIGRvd25sb2FkIGZvaSBjYW5jZWxhZG8uJykKCQlkcC5jbG9zZSgpCgpkZWYgdm9kX2NoYW5uZWxzKGNoYW5uZWwpOgoJdmlkZW8gPSBiYXNlNjQuYjY0ZGVjb2RlKGNoYW5uZWwpCglyZXR1cm4gdmlkZW8KCmRlZiBQbGF5VXJsKG5hbWUsIHVybCwgaWNvbmltYWdlPU5vbmUpOgoJbGlzdGl0ZW0gPSB4Ym1jZ3VpLkxpc3RJdGVtKHBhdGg9dXJsLCB0aHVtYm5haWxJbWFnZT1pY29uaW1hZ2UpCglsaXN0aXRlbS5zZXRJbmZvKHR5cGU9IlZpZGVvIiwgaW5mb0xhYmVscz17ICJUaXRsZSI6IG5hbWUgfSkKCXhibWNwbHVnaW4uc2V0UmVzb2x2ZWRVcmwoaW50KHN5cy5hcmd2WzFdKSwgVHJ1ZSwgbGlzdGl0ZW0pCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwkJCQkJCQkJCQkJCQlNZW51IFRWIEFycXVpdm8JCQkJCQkJCQkJCSAjCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZGVmIGxpc3RhdHZhcmNoaXZlKHVybCk6CgllbmRlcmVjbyA9IHVybCsicGxheWVyX2FwaS5waHA/dXNlcm5hbWU9IitfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fbmFtZScpKyImcGFzc3dvcmQ9IitfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fcGFzc3dvcmQnKSsiJmFjdGlvbj1nZXRfbGl2ZV9zdHJlYW1zIgoJI2lJaUlJSWkgPSB1cmxsaWIyLnVybG9wZW4oZW5kZXJlY28pCgkjb29vMDBPT09vb08JPSBqc29uLmxvYWQoaUlpSUlJaSkKCXJlcSA9IHVybGxpYjIuUmVxdWVzdChlbmRlcmVjbykKCXJlcS5hZGRfaGVhZGVyKHN5bmNfZGF0YSgiVlhObGNpMUJaMlZ1ZEE9PSIpICwgdm9kX2NoYW5uZWxzKCJTMjlrYVNCd2JIVm5hVzRnWW5rZ1RHbDJaU0YwIikpCglyZXNwb25zZSA9IHVybGxpYjIudXJsb3BlbihyZXEpCglsaW5rPXJlc3BvbnNlLnJlYWQoKQoJb29vMDBPT09vb08JPSBqc29uLmxvYWRzKGxpbmsuZGVjb2RlKCd1dGY4JykpCglyZXNwb25zZS5jbG9zZSgpCglPMDBPT09vT29vME8gPSBvb28wME9PT29vT1snYXZhaWxhYmxlX2NoYW5uZWxzJ10KCWZvcglPMDAwT09vMDBvbwlpbglPMDBPT09vT29vME8udmFsdWVzKCk6CgkJb28wT09vID0gTzAwME9PbzAwb29bJ3R2X2FyY2hpdmUnXQoJCWlmKG9vME9PbyA9PSAxKToKCQkJbmFtZXR2PU8wMDBPT28wMG9vWyduYW1lJ10KCQkJc3RyZWFtX2lkPU8wMDBPT28wMG9vWydzdHJlYW1faWQnXQoJCQlsb2dvX3R2PU8wMDBPT28wMG9vWydzdHJlYW1faWNvbiddCgkJCWR1cmF0aW9uID0gTzAwME9PbzAwb29bJ3R2X2FyY2hpdmVfZHVyYXRpb24nXQoJCQkKCQkJYWRkTGlua0dydXBvKG5hbWV0dixsb2dvX3R2LHN0cmVhbV9pZCx1cmwsZHVyYXRpb24sb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3R2X2FyYy5wbmcnKSwxKQoJCgl2aXN0YV9HcnVwb3MoKQoKZGVmIGxpc3RhdHZhcmNoaXZlY2FuYWlzKG5hbWUsc3RyZWFtX2lkLHVybCxkdXJhdGlvbixpY29uaW1hZ2UsZmFuYXJ0KToKCWVuZGVyZWNvID0gdXJsKyJwbGF5ZXJfYXBpLnBocD91c2VybmFtZT0iK19fQURET05fXy5nZXRTZXR0aW5nKCdsb2dpbl9uYW1lJykrIiZwYXNzd29yZD0iK19fQURET05fXy5nZXRTZXR0aW5nKCdsb2dpbl9wYXNzd29yZCcpKyImYWN0aW9uPWdldF9lcGcmc3RyZWFtX2lkPSIrc3RyZWFtX2lkCgkjaUlpSUlJaSA9IHVybGxpYjIudXJsb3BlbihlbmRlcmVjbykKCSNpaWlJMTEJPSBqc29uLmxvYWQoaUlpSUlJaSkKCXJlcSA9IHVybGxpYjIuUmVxdWVzdChlbmRlcmVjbykKCXJlcS5hZGRfaGVhZGVyKHN5bmNfZGF0YSgiVlhObGNpMUJaMlZ1ZEE9PSIpICwgdm9kX2NoYW5uZWxzKCJTMjlrYVNCd2JIVm5hVzRnWW5rZ1RHbDJaU0YwIikpCglyZXNwb25zZSA9IHVybGxpYjIudXJsb3BlbihyZXEpCglsaW5rPXJlc3BvbnNlLnJlYWQoKQoJaWlpSTExCT0ganNvbi5sb2FkcyhsaW5rLmRlY29kZSgndXRmOCcpKQoJcmVzcG9uc2UuY2xvc2UoKQoJCglpaUlpSSA9IGRhdGV0aW1lLmRhdGV0aW1lLnV0Y25vdygpIC0gZGF0ZXRpbWUudGltZWRlbHRhKGRheXM9aW50KGR1cmF0aW9uKSkKCW8wMG9vb08wT28JPWNhbGVuZGFyLnRpbWVnbShpaUlpSS50aW1ldHVwbGUoKSkKCW8wMG9vb08wT28JPWludChvMDBvb29PME9vKQoJbzBPME9PTzBPb28JPXRpbWUudGltZSgpCglvME8wT09PME9vbwk9aW50KG8wTzBPT08wT29vKQoJCglmb3IJaWlJaUlJMQlpbglpaWlJMTEJOgoJCXRpdGxlX3R2ID0gaWlJaUlJMVsndGl0bGUnXQoJCXRpdGxlX3R2PWJhc2U2NC5iNjRkZWNvZGUodGl0bGVfdHYpCgkJc3RhcnQJPSBpbnQoaWlJaUlJMVsnc3RhcnQnXSkKCQllbmQJPSBpbnQoaWlJaUlJMVsnZW5kJ10pCgkJc2VndW5kbyA9IDAuMDE2NjY2NjY2NwoJCQoJCWR1cmFjYW8gPSBpbnQoKGVuZC1zdGFydCkqc2VndW5kbykKCQkKCQlpZihzdGFydCA+IG8wMG9vb08wT28gYW5kIHN0YXJ0IDwgbzBPME9PTzBPb28pOgoJCQlpZiA5MCAtIDkwOglPb28wCSUJT28wb29PMG9vMG9PCS8JT28wb08wb29vCgkJCUlJaSA9IGRhdGV0aW1lLmRhdGV0aW1lLmZyb210aW1lc3RhbXAoaW50KHN0YXJ0KSkuc3RyZnRpbWUoJyVkLiVtICVIOiVNJykKCQkJaTFJaWkxaTFJID0gZGF0ZXRpbWUuZGF0ZXRpbWUuZnJvbXRpbWVzdGFtcChpbnQoc3RhcnQpKS5zdHJmdGltZSgnJVktJW0tJWQ6JUg6JU0nKQoJCQl0aXRsZV90diA9IElJaSArICIgIiArIHRpdGxlX3R2CgkJCWVuZGVyZWNvID0gdXJsKyJzdHJlYW1pbmcvdGltZXNoaWZ0LnBocD91c2VybmFtZT0iK19fQURET05fXy5nZXRTZXR0aW5nKCdsb2dpbl9uYW1lJykrIiZwYXNzd29yZD0iK19fQURET05fXy5nZXRTZXR0aW5nKCdsb2dpbl9wYXNzd29yZCcpKyImc3RyZWFtPSIrc3RyZWFtX2lkKyImc3RhcnQ9IitpMUlpaTFpMUkrIiZkdXJhdGlvbj0iK3N0cihkdXJhY2FvKQoJCQkKCQkJYWRkTGlua0NhbmFsKHRpdGxlX3R2LGVuZGVyZWNvLGljb25pbWFnZSwnMDAwMScsJycpCgkKCXZpc3RhX0NhbmFpcygpCgpkZWYgYWRkTGlua0dydXBvKHRpdGxlLHRodW1ibmFpbCxzdHJlYW1faWQsdXJsLGR1cmF0aW9uLGZhbmFydCx0eXBlKToKCW9rPVRydWUKCQoJbGlzdGl0ZW09eGJtY2d1aS5MaXN0SXRlbSh0aXRsZSxpY29uSW1hZ2U9dGh1bWJuYWlsLHRodW1ibmFpbEltYWdlPXRodW1ibmFpbCkKCWluZm9fbGFiZWxzPXsiVGl0bGUiOnRpdGxlLCJGaWxlTmFtZSI6dGl0bGV9CglsaXN0aXRlbS5zZXRJbmZvKCAidmlkZW8iLCBpbmZvX2xhYmVscyApCglsaXN0aXRlbS5zZXRQcm9wZXJ0eSgnZmFuYXJ0X2ltYWdlJyxmYW5hcnQpCgl4Ym1jcGx1Z2luLnNldFBsdWdpbkZhbmFydChpbnQoc3lzLmFyZ3ZbMV0pLGZhbmFydCkKCQoJdSA9IHN5cy5hcmd2WzBdICsgIj91cmw9IiArIHN0cih1cmwpICsgIiZtb2RlPTcmbmFtZT0iICsgc3RyKHRpdGxlKSArICImaWNvbmltYWdlPSIrc3RyKHRodW1ibmFpbCkrIiZmYW5hcnQ9IitzdHIoZmFuYXJ0KSsiJnN0cmVhbV9pZD0iK3N0cihzdHJlYW1faWQpKyImZHVyYXRpb249IitkdXJhdGlvbgoJCglvaz14Ym1jcGx1Z2luLmFkZERpcmVjdG9yeUl0ZW0oaGFuZGxlPWludChzeXMuYXJndlsxXSksdXJsPXUsbGlzdGl0ZW09bGlzdGl0ZW0saXNGb2xkZXI9VHJ1ZSkKCQoJcmV0dXJuIG9rCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwkJCQkJCQkJCQkJCQlBYnJpciBTZXR0aW5nCQkJCQkJCQkJCSAjCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZGVmIGFicmlyRGVmaW5pbmNvZXMoKToKCV9fQURET05fXy5vcGVuU2V0dGluZ3MoKQoJdmlzdGFfbWVudSgpCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIyMJCUNsZWFyIENhY2hlCQkjIyMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCmRlZiBDTEVBUkNBQ0hFKCk6Cgl4Ym1jX2NhY2hlX3BhdGggPSBvcy5wYXRoLmpvaW4oeGJtYy50cmFuc2xhdGVQYXRoKCdzcGVjaWFsOi8vaG9tZScpLCAnY2FjaGUnKQoJaWYgb3MucGF0aC5leGlzdHMoeGJtY19jYWNoZV9wYXRoKT09VHJ1ZToJCgkJZm9yIHJvb3QsIGRpcnMsIGZpbGVzIGluIG9zLndhbGsoeGJtY19jYWNoZV9wYXRoKToKCQkJZmlsZV9jb3VudCA9IDAKCQkJZmlsZV9jb3VudCArPSBsZW4oZmlsZXMpCgkJCWlmIGZpbGVfY291bnQgPiAwOgoJCgkJCQlkaWFsb2cgPSB4Ym1jZ3VpLkRpYWxvZygpCgkJCQlpZiBkaWFsb2cueWVzbm8oIkFwYWdhciBDYWNoZSBubyBYQk1DLiIsIHN0cihmaWxlX2NvdW50KSArICIgZmljaGVpcm9zIGVuY29udHJhZG9zLiIsICJRdWVyIGFwYWdhciB0b2RvcyBvcyBmaWNoZWlyb3MgZW0gY2FjaGU/Iik6CgkJCQkKCQkJCQlmb3IgZiBpbiBmaWxlczoKCQkJCQkJdHJ5OgoJCQkJCQkJb3MudW5saW5rKG9zLnBhdGguam9pbihyb290LCBmKSkKCQkJCQkJZXhjZXB0OgoJCQkJCQkJcGFzcwoJCQkJCWZvciBkIGluIGRpcnM6CgkJCQkJCXRyeToKCQkJCQkJCXNodXRpbC5ybXRyZWUob3MucGF0aC5qb2luKHJvb3QsIGQpKQoJCQkJCQlleGNlcHQ6CgkJCQkJCQlwYXNzCgkJCQkJCQoJCQllbHNlOgoJCQkJcGFzcwoJaWYgeGJtYy5nZXRDb25kVmlzaWJpbGl0eSgnc3lzdGVtLnBsYXRmb3JtLkFUVjInKToKCQlhdHYyX2NhY2hlX2EgPSBvcy5wYXRoLmpvaW4oJy9wcml2YXRlL3Zhci9tb2JpbGUvTGlicmFyeS9DYWNoZXMvQXBwbGVUVi9WaWRlby8nLCAnT3RoZXInKQoJCQoJCWZvciByb290LCBkaXJzLCBmaWxlcyBpbiBvcy53YWxrKGF0djJfY2FjaGVfYSk6CgkJCWZpbGVfY291bnQgPSAwCgkJCWZpbGVfY291bnQgKz0gbGVuKGZpbGVzKQoJCQoJCQlpZiBmaWxlX2NvdW50ID4gMDoKCgkJCQlkaWFsb2cgPSB4Ym1jZ3VpLkRpYWxvZygpCgkJCQlpZiBkaWFsb2cueWVzbm8oIkFwYWdhciBmaWNoZWlyb3MgQVRWMi4iLCBzdHIoZmlsZV9jb3VudCkgKyAiIGZpY2hlaXJvcyBlbmNvbnRyYWRvcyBlbSAnT3V0cm9zJyIsICJRdWVyIGFwYWdhciB0b2RvcyBvcyBmaWNoZWlyb3MgZW0gY2FjaGU/Iik6CgkJCQkKCQkJCQlmb3IgZiBpbiBmaWxlczoKCQkJCQkJb3MudW5saW5rKG9zLnBhdGguam9pbihyb290LCBmKSkKCQkJCQlmb3IgZCBpbiBkaXJzOgoJCQkJCQlzaHV0aWwucm10cmVlKG9zLnBhdGguam9pbihyb290LCBkKSkKCQkJCQkJCgkJCWVsc2U6CgkJCQlwYXNzCgkJYXR2Ml9jYWNoZV9iID0gb3MucGF0aC5qb2luKCcvcHJpdmF0ZS92YXIvbW9iaWxlL0xpYnJhcnkvQ2FjaGVzL0FwcGxlVFYvVmlkZW8vJywgJ0xvY2FsQW5kUmVudGFsJykKCQkKCQlmb3Igcm9vdCwgZGlycywgZmlsZXMgaW4gb3Mud2FsayhhdHYyX2NhY2hlX2IpOgoJCQlmaWxlX2NvdW50ID0gMAoJCQlmaWxlX2NvdW50ICs9IGxlbihmaWxlcykKCQkKCQkJaWYgZmlsZV9jb3VudCA+IDA6CgoJCQkJZGlhbG9nID0geGJtY2d1aS5EaWFsb2coKQoJCQkJaWYgZGlhbG9nLnllc25vKCJBcGFnYXIgZmljaGVpcm9zIEFUVjIuIiwgc3RyKGZpbGVfY291bnQpICsgIiBmaWNoZWlyb3MgZW5jb250cmFkb3MgZW0gJ0xvY2FsJyIsICJRdWVyIGFwYWdhciB0b2RvcyBvcyBmaWNoZWlyb3MgZW0gY2FjaGU/Iik6CgkJCQkKCQkJCQlmb3IgZiBpbiBmaWxlczoKCQkJCQkJb3MudW5saW5rKG9zLnBhdGguam9pbihyb290LCBmKSkKCQkJCQlmb3IgZCBpbiBkaXJzOgoJCQkJCQlzaHV0aWwucm10cmVlKG9zLnBhdGguam9pbihyb290LCBkKSkKCQkJCQkJCgkJCWVsc2U6CgkJCQlwYXNzCgkJCSAgIyBTZXQgcGF0aCB0byBDeWRpYSBBcmNoaXZlcyBjYWNoZSBmaWxlcwoJCQkJCQkJIAoKCSMgU2V0IHBhdGggdG8gV2hhdCB0aCBGdXJrIGNhY2hlIGZpbGVzCgl3dGZfY2FjaGVfcGF0aCA9IG9zLnBhdGguam9pbih4Ym1jLnRyYW5zbGF0ZVBhdGgoJ3NwZWNpYWw6Ly9wcm9maWxlL2FkZG9uX2RhdGEvcGx1Z2luLnZpZGVvLndoYXR0aGVmdXJrL2NhY2hlJyksICcnKQoJaWYgb3MucGF0aC5leGlzdHMod3RmX2NhY2hlX3BhdGgpPT1UcnVlOgkKCQlmb3Igcm9vdCwgZGlycywgZmlsZXMgaW4gb3Mud2Fsayh3dGZfY2FjaGVfcGF0aCk6CgkJCWZpbGVfY291bnQgPSAwCgkJCWZpbGVfY291bnQgKz0gbGVuKGZpbGVzKQoJCQoJCSMgQ291bnQgZmlsZXMgYW5kIGdpdmUgb3B0aW9uIHRvIGRlbGV0ZQoJCQlpZiBmaWxlX2NvdW50ID4gMDoKCQoJCQkJZGlhbG9nID0geGJtY2d1aS5EaWFsb2coKQoJCQkJaWYgZGlhbG9nLnllc25vKCJBcGFnYXIgYSBjYWNoZSBXVEYuIiwgc3RyKGZpbGVfY291bnQpICsgIiBmaWNoZWlyb3MgZW5jb250cmFkb3MuIiwgIlF1ZXIgYXBhZ2FyIHRvZG9zIG9zIGZpY2hlaXJvcyBlbSBjYWNoZT8iKToKCQkJCQoJCQkJCWZvciBmIGluIGZpbGVzOgoJCQkJCQlvcy51bmxpbmsob3MucGF0aC5qb2luKHJvb3QsIGYpKQoJCQkJCWZvciBkIGluIGRpcnM6CgkJCQkJCXNodXRpbC5ybXRyZWUob3MucGF0aC5qb2luKHJvb3QsIGQpKQoJCQkJCQkKCQkJZWxzZToKCQkJCXBhc3MKCQkJCQoJCQkJIyBTZXQgcGF0aCB0byA0b0QgY2FjaGUgZmlsZXMKCWNoYW5uZWw0X2NhY2hlX3BhdGg9IG9zLnBhdGguam9pbih4Ym1jLnRyYW5zbGF0ZVBhdGgoJ3NwZWNpYWw6Ly9wcm9maWxlL2FkZG9uX2RhdGEvcGx1Z2luLnZpZGVvLjRvZC9jYWNoZScpLCAnJykKCWlmIG9zLnBhdGguZXhpc3RzKGNoYW5uZWw0X2NhY2hlX3BhdGgpPT1UcnVlOgkKCQlmb3Igcm9vdCwgZGlycywgZmlsZXMgaW4gb3Mud2FsayhjaGFubmVsNF9jYWNoZV9wYXRoKToKCQkJZmlsZV9jb3VudCA9IDAKCQkJZmlsZV9jb3VudCArPSBsZW4oZmlsZXMpCgkJCgkJIyBDb3VudCBmaWxlcyBhbmQgZ2l2ZSBvcHRpb24gdG8gZGVsZXRlCgkJCWlmIGZpbGVfY291bnQgPiAwOgoJCgkJCQlkaWFsb2cgPSB4Ym1jZ3VpLkRpYWxvZygpCgkJCQlpZiBkaWFsb2cueWVzbm8oIkFwYWdhciBmaWNoZWlyb3MgNG9EIGVtIGNhY2hlLiIsIHN0cihmaWxlX2NvdW50KSArICIgZmljaGVpcm9zIGVuY29udHJhZG9zLiIsICJRdWVyIGFwYWdhciB0b2RvcyBvcyBmaWNoZWlyb3MgZW0gY2FjaGU/Iik6CgkJCQkKCQkJCQlmb3IgZiBpbiBmaWxlczoKCQkJCQkJb3MudW5saW5rKG9zLnBhdGguam9pbihyb290LCBmKSkKCQkJCQlmb3IgZCBpbiBkaXJzOgoJCQkJCQlzaHV0aWwucm10cmVlKG9zLnBhdGguam9pbihyb290LCBkKSkKCQkJCQkJCgkJCWVsc2U6CgkJCQlwYXNzCgkJCQkKCQkJCSMgU2V0IHBhdGggdG8gQkJDIGlQbGF5ZXIgY2FjaGUgZmlsZXMKCWlwbGF5ZXJfY2FjaGVfcGF0aD0gb3MucGF0aC5qb2luKHhibWMudHJhbnNsYXRlUGF0aCgnc3BlY2lhbDovL3Byb2ZpbGUvYWRkb25fZGF0YS9wbHVnaW4udmlkZW8uaXBsYXllci9pcGxheWVyX2h0dHBfY2FjaGUnKSwgJycpCglpZiBvcy5wYXRoLmV4aXN0cyhpcGxheWVyX2NhY2hlX3BhdGgpPT1UcnVlOgkKCQlmb3Igcm9vdCwgZGlycywgZmlsZXMgaW4gb3Mud2FsayhpcGxheWVyX2NhY2hlX3BhdGgpOgoJCQlmaWxlX2NvdW50ID0gMAoJCQlmaWxlX2NvdW50ICs9IGxlbihmaWxlcykKCQkKCQkjIENvdW50IGZpbGVzIGFuZCBnaXZlIG9wdGlvbiB0byBkZWxldGUKCQkJaWYgZmlsZV9jb3VudCA+IDA6CgkKCQkJCWRpYWxvZyA9IHhibWNndWkuRGlhbG9nKCkKCQkJCWlmIGRpYWxvZy55ZXNubygiQXBhZ2FyIGZpY2hlaXJvcyBCQkMgaVBsYXllciBlbSBjYWNoZS4iLCBzdHIoZmlsZV9jb3VudCkgKyAiIGZpY2hlaXJvcyBlbmNvbnRyYWRvcy4iLCAiUXVlciBhcGFnYXIgdG9kb3Mgb3MgZmljaGVpcm9zIGVtIGNhY2hlPyIpOgoJCQkJCgkJCQkJZm9yIGYgaW4gZmlsZXM6CgkJCQkJCW9zLnVubGluayhvcy5wYXRoLmpvaW4ocm9vdCwgZikpCgkJCQkJZm9yIGQgaW4gZGlyczoKCQkJCQkJc2h1dGlsLnJtdHJlZShvcy5wYXRoLmpvaW4ocm9vdCwgZCkpCgkJCQkJCQoJCQllbHNlOgoJCQkJcGFzcwoJCQkJCgkJCQkKCQkJCSMgU2V0IHBhdGggdG8gU2ltcGxlIERvd25sb2FkZXIgY2FjaGUgZmlsZXMKCWRvd25sb2FkZXJfY2FjaGVfcGF0aCA9IG9zLnBhdGguam9pbih4Ym1jLnRyYW5zbGF0ZVBhdGgoJ3NwZWNpYWw6Ly9wcm9maWxlL2FkZG9uX2RhdGEvc2NyaXB0Lm1vZHVsZS5zaW1wbGUuZG93bmxvYWRlcicpLCAnJykKCWlmIG9zLnBhdGguZXhpc3RzKGRvd25sb2FkZXJfY2FjaGVfcGF0aCk9PVRydWU6CQoJCWZvciByb290LCBkaXJzLCBmaWxlcyBpbiBvcy53YWxrKGRvd25sb2FkZXJfY2FjaGVfcGF0aCk6CgkJCWZpbGVfY291bnQgPSAwCgkJCWZpbGVfY291bnQgKz0gbGVuKGZpbGVzKQoJCQoJCSMgQ291bnQgZmlsZXMgYW5kIGdpdmUgb3B0aW9uIHRvIGRlbGV0ZQoJCQlpZiBmaWxlX2NvdW50ID4gMDoKCQoJCQkJZGlhbG9nID0geGJtY2d1aS5EaWFsb2coKQoJCQkJaWYgZGlhbG9nLnllc25vKCJBcGFnYXIgZmljaGVpcm9zIFNpbXBsZSBEb3dubG9hZGVyIGVtIGNhY2hlLiIsIHN0cihmaWxlX2NvdW50KSArICIgZmljaGVpcm9zIGVuY29udHJhZG9zLiIsICJRdWVyIGFwYWdhciB0b2RvcyBvcyBmaWNoZWlyb3MgZW0gY2FjaGU/Iik6CgkJCQkKCQkJCQlmb3IgZiBpbiBmaWxlczoKCQkJCQkJb3MudW5saW5rKG9zLnBhdGguam9pbihyb290LCBmKSkKCQkJCQlmb3IgZCBpbiBkaXJzOgoJCQkJCQlzaHV0aWwucm10cmVlKG9zLnBhdGguam9pbihyb290LCBkKSkKCQkJCQkJCgkJCWVsc2U6CgkJCQlwYXNzCgkKCWl0dl9jYWNoZV9wYXRoID0gb3MucGF0aC5qb2luKHhibWMudHJhbnNsYXRlUGF0aCgnc3BlY2lhbDovL3Byb2ZpbGUvYWRkb25fZGF0YS9wbHVnaW4udmlkZW8uaXR2L0ltYWdlcycpLCAnJykKCWlmIG9zLnBhdGguZXhpc3RzKGl0dl9jYWNoZV9wYXRoKT09VHJ1ZToJCgkJZm9yIHJvb3QsIGRpcnMsIGZpbGVzIGluIG9zLndhbGsoaXR2X2NhY2hlX3BhdGgpOgoJCQlmaWxlX2NvdW50ID0gMAoJCQlmaWxlX2NvdW50ICs9IGxlbihmaWxlcykKCQkJCgkJCWlmIGZpbGVfY291bnQgPiAwOgoJCgkJCQlkaWFsb2cgPSB4Ym1jZ3VpLkRpYWxvZygpCgkJCQlpZiBkaWFsb2cueWVzbm8oIkFwYWdhciBpdGVtcyBlbSBjYWNoZSIsIHN0cihmaWxlX2NvdW50KSArICIgZmljaGVpcm9zIGVuY29udHJhZG9zLiIsICJRdWVyIGFwYWdhciB0b2RvcyBvcyBmaWNoZWlyb3MgZW0gY2FjaGU/Iik6CgkJCQkKCQkJCQlmb3IgZiBpbiBmaWxlczoKCQkJCQkJb3MudW5saW5rKG9zLnBhdGguam9pbihyb290LCBmKSkKCQkJCQlmb3IgZCBpbiBkaXJzOgoJCQkJCQlzaHV0aWwucm10cmVlKG9zLnBhdGguam9pbihyb290LCBkKSkKCQkJCQkJCgkJCWVsc2U6CgkJCQlwYXNzCglkaWFsb2cgPSB4Ym1jZ3VpLkRpYWxvZygpCglkaWFsb2cub2soQWRkb25UaXRsZSwgIgkJQ2FjaGUgYXBhZ2FkYSBjb20gc3VjZXNzbyEiKQoKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMjIwkgUHVyZ2UgUGFja2FnZXMJCSMjIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZGVmIFBVUkdFUEFDS0FHRVMoKToKCXBhY2thZ2VzX2NhY2hlX3BhdGggPSB4Ym1jLnRyYW5zbGF0ZVBhdGgob3MucGF0aC5qb2luKCdzcGVjaWFsOi8vaG9tZS9hZGRvbnMvcGFja2FnZXMnLCAnJykpCgl0cnk6CQoJCWZvciByb290LCBkaXJzLCBmaWxlcyBpbiBvcy53YWxrKHBhY2thZ2VzX2NhY2hlX3BhdGgpOgoJCQlmaWxlX2NvdW50ID0gMAoJCQlmaWxlX2NvdW50ICs9IGxlbihmaWxlcykKCQkJCgkJCWlmIGZpbGVfY291bnQgPiAwOgoJCgkJCQlkaWFsb2cgPSB4Ym1jZ3VpLkRpYWxvZygpCgkJCQlpZiBkaWFsb2cueWVzbm8oIkV4Y2x1aXIgaW5mb3JtYcOnw6NvIGVtIENhY2hlLiIsIHN0cihmaWxlX2NvdW50KSArICIgZmljaGVpcm9zIGVuY29udHJhZG9zLiIsICJRdWVyIGFwYWdhciB0b2RvcyBvcyBmaWNoZWlyb3M/Iik6CgkJCQkJCQkKCQkJCQlmb3IgZiBpbiBmaWxlczoKCQkJCQkJb3MudW5saW5rKG9zLnBhdGguam9pbihyb290LCBmKSkKCQkJCQlmb3IgZCBpbiBkaXJzOgoJCQkJCQlzaHV0aWwucm10cmVlKG9zLnBhdGguam9pbihyb290LCBkKSkKCQkJCQlkaWFsb2cgPSB4Ym1jZ3VpLkRpYWxvZygpCgkJCQkJZGlhbG9nLm9rKEFkZG9uVGl0bGUsICIJCUtvZGkgbGltcG8gY29tIHN1Y2Vzc28uIikKCQkJCWVsc2U6CgkJCQkJCXBhc3MKCQkJZWxzZToKCQkJCWRpYWxvZyA9IHhibWNndWkuRGlhbG9nKCkKCQkJCWRpYWxvZy5vayhBZGRvblRpdGxlLCAiCQlOw6NvIGZvcmFtIGVuY29udHJhZG9zIGZpY2hlaXJvcyBhIGFwYWdhci4iKQoJZXhjZXB0OiAKCQlkaWFsb2cgPSB4Ym1jZ3VpLkRpYWxvZygpCgkJZGlhbG9nLm9rKEFkZG9uVGl0bGUsICJFcnJvIGFvIHRlbnRhciBhcGFnYXIgZmljaGVpcm9zIGVtIGNhY2hlLiIpCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwkJCQkJCQkJCQkJCUFkZG9uIExJVkVJVCBGaWxtZXMgZSBTZXJpZXMJCQkJCQkJICMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCmRlZiBkZXZvbHZlcmVzdWx0YWRvKHVybG5vbyk6CglyZXN1bHRhZG8gPSBhYnJpcl91cmwodXJsbm9vLCBoZWFkZXI9aGVhZGVycykKCXRyeToKCQlyZXN1bHRhZG8gPSByZXN1bHRhZG8uZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6CgkJcmVzdWx0YWRvID0gcmVzdWx0YWRvLmVuY29kZSgndXRmLTgnKQoJcmV0dXJuIHJlc3VsdGFkbwoKZGVmIGdldENhdGVnb3JpYWxpdmUoaWQsaW5pY2lvKToKCWNhdCA9IGxlcl9maWNoZWlybyhvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdjYXRlZ29yaWFzX2xpdmUubGl2ZWl0JykpLnJlcGxhY2UoJyInLCAiJyIpCglyZXR1cm4gY2F0CgkKZGVmIGdldFNhZ2FzbGl2ZShpZCxpbmljaW8pOgoJY2F0ID0gbGVyX2ZpY2hlaXJvKG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ3NhZ2FzX2xpdmUubGl2ZWl0JykpLnJlcGxhY2UoJyInLCAiJyIpCglyZXR1cm4gY2F0CgpkZWYgZ2V0QW5vc2xpdmUoaWQsaW5pY2lvKToKCWNhdCA9IGxlcl9maWNoZWlybyhvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdhbm9zX2xpdmUubGl2ZWl0JykpLnJlcGxhY2UoJyInLCAiJyIpCglyZXR1cm4gY2F0CgpkZWYgbG9naW5saWxpKGluaWNpbyk6CglyZXN1bHRhZG8gPSBGYWxzZQoJZXJyb3MgPSAiIgoJdHJ5OgoJCXVybG5vbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZhZGRvbj0xJnRpcG89JytpbmljaW8KCQlyZXN1bHRhZG8gPSBkZXZvbHZlcmVzdWx0YWRvKHVybG5vbykKCQllc2NyZXZlcl9maWNoZWlybyhvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdkZWZpbmljb2VzX2xpdmUubGl2ZWl0JyksIHJlc3VsdGFkbykKCQlyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCQljYXRlZ29yaWFzID0gcmVzdWx0YWRvWydncnVwb3MnXQoJCWVzY3JldmVyX2ZpY2hlaXJvKG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ2NhdGVnb3JpYXNfbGl2ZS5saXZlaXQnKSwgc3RyKGNhdGVnb3JpYXMpKQoJCWFub3MgPSByZXN1bHRhZG9bJ2Fub3MnXQoJCWVzY3JldmVyX2ZpY2hlaXJvKG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ2Fub3NfbGl2ZS5saXZlaXQnKSwgc3RyKGFub3MpKQoJCQoJCWlmIGluaWNpbyA9PSAnaW5pY2lvX2ZpbG1lcyc6CgkJCXNhZ2FzID0gcmVzdWx0YWRvWydzYWdhcyddCgkJCWVzY3JldmVyX2ZpY2hlaXJvKG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ3NhZ2FzX2xpdmUubGl2ZWl0JyksIHN0cihzYWdhcykpCgkJcmV0dXJuIFRydWUKCWV4Y2VwdDoKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdOw6NvIGZvaSBwb3Nzw612ZWwgYWJyaXIgYSBww6FnaW5hLiBQb3IgZmF2b3IgdGVudGUgbm92YW1lbnRlLicpCgkJcmV0dXJuIEZhbHNlCgpkZWYgbGlzdGFtZW51c19saXZlaXQxKCk6CgljaGVja19sb2dpbiA9IGxvZ2lubGlsaSgnaW5pY2lvX2ZpbG1lcycpCglpZiBjaGVja19sb2dpbiA9PSBUcnVlOgoJCW1lbnVGaWxtZXMyKG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmaWxtZXMucG5nJyksX19TSVRFQWRkb25fXysnSW1hZ2Vucy9maWxtZXNfZmFuYXJ0LnBuZycpCgllbHNlOgoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0Vycm8gYSBmYXplciBsb2dpbiBuZXN0YSBwYXJ0ZS4gVGVudGUgbm92YW1lbnRlIG1haXMgdGFyZGUuJykKCmRlZiBsaXN0YW1lbnVzX2xpdmVpdDIoKToKCWNoZWNrX2xvZ2luID0gbG9naW5saWxpKCdpbmljaW9fc2VyaWVzJykKCWlmIGNoZWNrX2xvZ2luID09IFRydWU6CgkJbWVudVNlcmllczIob3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Nlcmllcy5wbmcnKSxfX1NJVEVBZGRvbl9fKydJbWFnZW5zL3Nlcmllc19mYW5hcnQucG5nJykKCWVsc2U6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnRXJybyBhIGZhemVyIGxvZ2luIG5lc3RhIHBhcnRlLiBUZW50ZSBub3ZhbWVudGUgbWFpcyB0YXJkZS4nKQoKZGVmIG1lbnVGaWxtZXMyKGljb25pbWFnZSxmYW5hcnQpOgoJYWRkRGlyMignVG9kb3Mgb3MgRmlsbWVzJywgX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89ZmlsbWVzJmdlbmVybz10b2RvcyZhZGRvbj0xJywgMTExMTEsICdmaWxtZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ1RvZG9zIG9zIERlc3RhcXVlcycsIF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPWZpbG1lcyZnZW5lcm89ZGVzdGFxdWVzJmFkZG9uPTEnLCAxMTExMSwgJ2ZpbG1lcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignVG9kYXMgYXMgU2FnYXMnLCBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1maWxtZXMmZ2VuZXJvPXNhZ2FzJmFkZG9uPTEnLCAxMTExOTksICdmaWxtZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ1BvciBBbm8nLCBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1maWxtZXMmZ2VuZXJvPWFub3MmYWRkb249MScsIDExMTE4LCAnZmlsbWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdQb3IgQ2F0ZWdvcmlhJywgX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89ZmlsbWVzJmdlbmVybz1jYXRlZ29yaWEmYWRkb249MScsIDExMTE5LCAnZmlsbWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdQb3IgUmF0aW5nJywgX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89ZmlsbWVzJmdlbmVybz1yYXRpbmcmYWRkb249MScsIDExMTExLCAnZmlsbWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdQYXJhIENyaWFuw6dhcycsIF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPWZpbG1lcyZnZW5lcm89a2lkcyZhZGRvbj0xJywgMTExMTEsICdmaWxtZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ1tDT0xPUiBwaW5rXVtCXVBlc3F1aXNhWy9CXVsvQ09MT1JdJywgX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89ZmlsbWVzJmFkZG9uPTEnLCAxMTEyMCwgJ2ZpbG1lcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJdmlzdGFfbWVudSgpCgpkZWYgbWVudVNlcmllczIoaWNvbmltYWdlLGZhbmFydCk6CglhZGREaXIyKCdUb2RhcyBTZXJpZXMnLCBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1zZXJpZXMmZ2VuZXJvPXRvZG9zJmFkZG9uPTEnLCAxMTExMiwgJ3NlcmllcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignVG9kb3Mgb3MgRGVzdGFxdWVzJywgX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89c2VyaWVzJmdlbmVybz1kZXN0YXF1ZXMmYWRkb249MScsIDExMTEyLCAnc2VyaWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdQb3IgQW5vJywgX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89c2VyaWVzJmdlbmVybz1hbm9zJmFkZG9uPTEnLCAxMTExOCwgJ3NlcmllcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignUG9yIENhdGVnb3JpYScsIF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPXNlcmllcyZnZW5lcm89Y2F0ZWdvcmlhJmFkZG9uPTEnLCAxMTExOSwgJ3NlcmllcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignUG9yIFJhdGluZycsIF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPXNlcmllcyZnZW5lcm89cmF0aW5nJmFkZG9uPTEnLCAxMTExMiwgJ3NlcmllcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignUGFyYSBDcmlhbsOnYXMnLCBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1zZXJpZXMmZ2VuZXJvPWtpZHMmYWRkb249MScsIDExMTEyLCAnc2VyaWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdbQ09MT1IgcGlua11bQl1QZXNxdWlzYVsvQl1bL0NPTE9SXScsIF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPXNlcmllcyZhZGRvbj0xJywgMTExMjAsICdzZXJpZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCXZpc3RhX21lbnUoKQoJCmRlZiBmaWxtZXMyKHVybCk6CglyZXN1bHRhZG8gPSBkZXZvbHZlcmVzdWx0YWRvKHVybCkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJZm9yIGkgaW4gcmVzdWx0YWRvWydpdGVtJ106CgkJc2V0RmlsbWUyKGkpCgkKCWN1cnJlbnQgPSByZXN1bHRhZG9bJ3BhZ2luYWNhbyddWydhdHVhbCddCgl0b3RhbCA9IDAKCXRyeTogdG90YWwgPSByZXN1bHRhZG9bJ3BhZ2luYWNhbyddWyd0b3RhbCddCglleGNlcHQ6IHBhc3MKCXRyeTogcHJveGltbyA9IGJhc2U2NC5iNjRkZWNvZGUocmVzdWx0YWRvWydwYWdpbmFjYW8nXVsnc2VndWludGUnXSkKCWV4Y2VwdDogcGFzcwoJaWYgaW50KGN1cnJlbnQpIDwgaW50KHRvdGFsKToKCQlhZGREaXIyKCdQcsOzeGltYSBww6FnaW5hICgnK3N0cihjdXJyZW50KSsnLycrc3RyKHRvdGFsKSsnKScsIHByb3hpbW8sIDExMTExLCAnZmlsbWVzJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Byb3hpbW8ucG5nJyksMSkKCXZpc3RhX2ZpbG1lc1NlcmllcygpCgkJCmRlZiBzZXJpZXMyKHVybCk6CglyZXN1bHRhZG8gPSBkZXZvbHZlcmVzdWx0YWRvKHVybCkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJCglmb3IgaSBpbiByZXN1bHRhZG9bJ2l0ZW0nXToKCQlzZXRTZXJpZXMyKGkpCgkKCWN1cnJlbnQgPSByZXN1bHRhZG9bJ3BhZ2luYWNhbyddWydhdHVhbCddCgl0b3RhbCA9IDAKCXRyeTogdG90YWwgPSByZXN1bHRhZG9bJ3BhZ2luYWNhbyddWyd0b3RhbCddCglleGNlcHQ6IHBhc3MKCXRyeTogcHJveGltbyA9IGJhc2U2NC5iNjRkZWNvZGUocmVzdWx0YWRvWydwYWdpbmFjYW8nXVsnc2VndWludGUnXSkKCWV4Y2VwdDogcGFzcwoJaWYgaW50KGN1cnJlbnQpIDwgaW50KHRvdGFsKToKCQlhZGREaXIyKCdQcm94aW1hIHBhZ2luYSAoJytzdHIoY3VycmVudCkrJy8nK3N0cih0b3RhbCkrJyknLCBwcm94aW1vLCAxMTExMiwgJ3NlcmllcycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdwcm94aW1vLnBuZycpKQoJdmlzdGFfZmlsbWVzU2VyaWVzKCkKCQoJCmRlZiBzZXRGaWxtZTIoaSk6CgljYXRlZ29yaWEgPSAiIgoJdHJ5OiBjYXRlZ29yaWEgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0dydXBvJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCWdydXBvMiA9ICIiCgl0cnk6IGdydXBvMiA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnR3J1cG8yJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzIAoJCglncnVwbzMgPSAiIgoJdHJ5OiBncnVwbzMgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0dydXBvMyddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglpZiBncnVwbzIgIT0gIiI6CgkJY2F0ZWdvcmlhICs9ICcsJytncnVwbzIKCWlmIGdydXBvMyAhPSAiIjoKCQljYXRlZ29yaWEgKz0gJywnK2dydXBvMwoJCglwdCA9ICcnCgliciA9ICcnCglzZW1MZWdlbmRhID0gJycKCWlkX3ZpZGVvID0gaVsnSUQnXQoJCglub21lID0gJycKCXRyeTogbm9tZSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnTm9tZSddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglub21lZW4gPSAnJwoJdHJ5OiBub21lZW4gPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ05vbWVFTiddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglkZXNjcmljYW8gPSAnJwoJdHJ5OiBkZXNjcmljYW8gPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0Rlc2NyaWNhbyddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglyZWFsaXphZG9yID0gJycKCXRyeTogcmVhbGl6YWRvciA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnUmVhbGl6YWRvciddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglhY3RvcmVzID0gJycKCXRyeTogYWN0b3JlcyA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnQWN0b3JlcyddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCgl5b3V0dWJlID0gJycKCXRyeTogeW91dHViZSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnWW91dHViZSddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCgl1cmwxID0gJycKCXRyeTogdXJsMSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnVXJsJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCXVybDIgPSAnJwoJdHJ5OiB1cmwyID0gYmFzZTY0LmI2NGRlY29kZShpWydVcmwxJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCXVybDMgPSAnJwoJdHJ5OiB1cmwzID0gYmFzZTY0LmI2NGRlY29kZShpWydVcmwyJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCXVybDQgPSAnJwoJdHJ5OiB1cmw0ID0gYmFzZTY0LmI2NGRlY29kZShpWydVcmwzJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCWltZGIgPSAnJwoJdHJ5OiBpbWRiID0gYmFzZTY0LmI2NGRlY29kZShpWydJbWRiJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCWltYWdlbSA9ICcnCgl0cnk6IGltYWdlbSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnSW1hZ2VtJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCWxlZ2VuZGFzID0gJycKCXRyeTogbGVnZW5kYXMgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0xlZ2VuZGFzJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCWFub3MgPSBpWydBbm9Ob3ZvJ10KCQoJaWYgJ2h0dHAnIG5vdCBpbiBpbWFnZW06CgkJaW1hZ2VtID0gX19BUElfXytpbWFnZW0KCQoJaWYgbGVnZW5kYXMgPT0gInNlbWxlZ2VuZGEiIG9yIGlbJ0xlZ2VuZGFzJ10gPT0gIiI6CgkJc2VtTGVnZW5kYSA9ICdbQ09MT1IgcmVkXVtCXVMvIExFR0VOREEgWy9CXVsvQ09MT1JdJwoJaWYgJ0JyYXNpbGVpcm8nIGluIGNhdGVnb3JpYToKCQliciA9ICdbQl1bQ09MT1IgZ3JlZW5dQlsvQ09MT1JdW0NPTE9SIHllbGxvd11SWy9DT0xPUl06IFsvQl0nCglpZiAnUG9ydHUnIGluIGNhdGVnb3JpYToKCQlwdCA9ICdbQl1bQ09MT1IgZ3JlZW5dUFsvQ09MT1JdW0NPTE9SIHJlZF1UWy9DT0xPUl06IFsvQl0nCgkKCXZpc3RvID0gRmFsc2UKCWNvciA9ICd3aGl0ZScKCWlmICdQVCcgaW4gaW1kYjoKCQlpbWRiID0gcmUuY29tcGlsZSgnKC4rPylQVCcpLmZpbmRhbGwoaW1kYilbMF0KCQlwdCA9ICdbQl1bQ09MT1IgZ3JlZW5dUFsvQ09MT1JdW0NPTE9SIHJlZF1UWy9DT0xPUl06IFsvQl0nCgkKCWluZm9MYWJlbHMgPSB7J1RpdGxlJzogbm9tZWVuLCAnWWVhcic6IGFub3MsICdHZW5yZSc6IGNhdGVnb3JpYSwgJ1Bsb3QnOiBkZXNjcmljYW8sICdDYXN0JzogYWN0b3Jlcy5zcGxpdCgnLCcpLCAnVHJhaWxlcic6IHlvdXR1YmUsICdEaXJlY3Rvcic6IHJlYWxpemFkb3IsICdSYXRpbmcnOiBpWydSYXRpbmcnXSwgJ0lNREJOdW1iZXInOiBpbWRiIH0KCglub21lZWUgPSAnW0NPTE9SICcrY29yKyddJytwdCticitzZW1MZWdlbmRhK3JlbW92ZXJBY2VudG9zKG5vbWUpKycgKCcrYW5vcysnKVsvQ09MT1JdJwoJdXJsbm9vID0gX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89ZmlsbWVzJmdlbmVybz1nZXRfdmlkZW8mYWRkb249MSZwZXNxdWlzYT0nK3N0cihpZF92aWRlbykKCWZvdG9vbyA9IGltYWdlbQoJZmFuYXJ0dHQgPSAnaW1hZ2VzL2JhY2tncm91bmQvJytpbWRiKycuanBnJwoJCglhZGRWaWRlbyhub21lZWUsIHVybG5vbywgMTExMTMsIGZvdG9vbywgdmlzdG8sICdmaWxtZScsIDAsIDAsIGluZm9MYWJlbHMsIGZhbmFydHR0LCB0cmFpbGVyPXlvdXR1YmUpCgpkZWYgZ2V0R2VuZXJvczJfbGl2ZSh1cmwsIG1vZG8pOgoJbGlzdGEgPSBbXQoJbGlzdGEgPSBnZXRTYWdhc2xpdmUoJ2luaWNpb19zYWdhcycsIG1vZG8pCgkKCWZvciBjIGluIGFzdC5saXRlcmFsX2V2YWwobGlzdGEpOgoJCWlmIGNbJ0lEJ10gPT0gIjAiOgoJCQljb250aW51ZQoJCXRyeToKCQkJY2F0ID0gYmFzZTY0LmI2NGRlY29kZShjWydOb21lJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDoKCQkJcGFzcwoJCQoJCXVybG5vdm8gPSB1cmwrJyZwZXNxdWlzYT0nK3N0cihjWydJRCddKTsKCQlhZGREaXIyKGNhdCwgdXJsbm92bywgMTExMjEsIG1vZG8sIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdnZW5lcm8ucG5nJykpCgkKCXZpc3RhX21lbnUoKQoKZGVmIGdldEdlbmVyb3NfbGl2ZSh1cmwsIG1vZG8pOgoJbGlzdGEgPSBbXQoJaWYgbW9kbyA9PSAnZmlsbWVzJzoKCQlsaXN0YSA9IGdldENhdGVnb3JpYWxpdmUoJ2luaWNpb19maWxtZXMnLCBtb2RvKQoJZWxzZToKCQlsaXN0YSA9IGdldENhdGVnb3JpYWxpdmUoJ2luaWNpb19zZXJpZXMnLCBtb2RvKQoJCglmb3IgYyBpbiBhc3QubGl0ZXJhbF9ldmFsKGxpc3RhKToKCQlpZiBjWydJRCddID09ICIwIjoKCQkJY29udGludWUKCQl0cnk6CgkJCWNhdCA9IGJhc2U2NC5iNjRkZWNvZGUoY1snTm9tZSddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6CgkJCXBhc3MKCQkKCQl1cmxub3ZvID0gdXJsKycmcGVzcXVpc2E9JytzdHIoY1snSUQnXSk7CgkJYWRkRGlyMihjYXQsIHVybG5vdm8sIDExMTIxLCBtb2RvLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZ2VuZXJvLnBuZycpKQoJCgl2aXN0YV9tZW51KCkKCmRlZiBnZXRZZWFyc19saXZlKHVybCwgbW9kbyk6CglsaXN0YSA9IFtdCglpZiBtb2RvID09ICdmaWxtZXMnOgoJCWxpc3RhID0gZ2V0QW5vc2xpdmUoJ2luaWNpb19maWxtZXMnLCBtb2RvKQoJZWxzZToKCQlsaXN0YSA9IGdldEFub3NsaXZlKCdpbmljaW9fc2VyaWVzJywgbW9kbykKCQoJZm9yIGMgaW4gYXN0LmxpdGVyYWxfZXZhbChsaXN0YSk6CgkJaWYgY1snSUQnXSA9PSAiMCI6CgkJCWNvbnRpbnVlCgkJdHJ5OgoJCQljYXQgPSBiYXNlNjQuYjY0ZGVjb2RlKGNbJ05vbWUnXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OgoJCQlwYXNzCgkJCgkJdXJsbm92byA9IHVybCsnJnBlc3F1aXNhPScrc3RyKGNbJ0lEJ10pOwoJCWFkZERpcjIoY2F0LCB1cmxub3ZvLCAxMTEyMSwgbW9kbywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2dlbmVyby5wbmcnKSkKCQoJdmlzdGFfbWVudSgpCgkKZGVmIGdldEluZm9fbGl2ZSh1cmwsIHRpcG8pOgoJcmVzdWx0YWRvID0gZGV2b2x2ZXJlc3VsdGFkbyh1cmwpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCWZvciBpIGluIHJlc3VsdGFkb1siaXRlbSJdOgoJCWlmIHRpcG8gPT0gJ2ZpbG1lcyc6CgkJCXNldEZpbG1lMihpKQoJCWVsc2U6CgkJCXNldFNlcmllczIoaSkKCQoJY3VycmVudCA9IHJlc3VsdGFkb1sncGFnaW5hY2FvJ11bJ2F0dWFsJ10KCXRvdGFsID0gMAoJdHJ5OiB0b3RhbCA9IHJlc3VsdGFkb1sncGFnaW5hY2FvJ11bJ3RvdGFsJ10KCWV4Y2VwdDogcGFzcwoJdHJ5OiBwcm94aW1vID0gYmFzZTY0LmI2NGRlY29kZShyZXN1bHRhZG9bJ3BhZ2luYWNhbyddWydzZWd1aW50ZSddKQoJZXhjZXB0OiBwYXNzCglpZiBpbnQoY3VycmVudCkgPCBpbnQodG90YWwpOgoJCWFkZERpcjIoJ1Byb3hpbWEgcGFnaW5hICgnK3N0cihjdXJyZW50KSsnLycrc3RyKHRvdGFsKSsnKScsIHByb3hpbW8sIDExMTIxLCB0aXBvLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncHJveGltby5wbmcnKSkKCXZpc3RhX2ZpbG1lc1NlcmllcygpCgkKZGVmIHBlc3F1aXNhX2xpdmUodXJsLCB0aXBvbG8pOgoJY29kaWdvX2ZvbnRlID0gJycKCWRhZG9zID0gJycKCXRhYmVsYSA9ICcnCglzdHJQZXNxdWlzYSA9ICcnCglmaWNoZWlybyA9ICcnCglzaXRlID0gJycKCXF1YWxpZGFkZSA9ICcnCgl0b2tlblBlc3F1aXNhPSAnJwoJcmVzdWx0YWRvID0gJycKCXRpcG9sb3Blc3F1aXNhTm92byA9ICcwJwoJaWYgdGlwb2xvID09ICdmaWxtZXMnOgoJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnZmlsbWVzX3Blc3F1aXNhLmxpdmVpdCcpCgkJdGlwbyA9IDAKCQlxdWFsaWRhZGUgPSBfX1F1YWxpZGFkZV9fCgllbHNlOgoJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnc2VyaWVzX3Blc3F1aXNhLmxpdmVpdCcpCgkJdGlwbyA9IDEKCQlzaXRlID0gJ3NlcmllcycKCQoJaWYgJ3BhZ2UnIG5vdCBpbiB1cmw6CgkJdHJ5OgoJCQl0aXBvbG9wZXNxdWlzYSA9IHhibWNndWkuRGlhbG9nKCkuc2VsZWN0KHUnTyBxdWUgcHJldGVuZGUgcGVzcXVpc2FyPycsIFsnUG9yOiBOb21lUFQgb3UgTm9tZSBFTicsICdQb3I6IFJlYWxpemFkb3InLCdQb3I6IEFjdG9yJ10pCgkJZXhjZXB0OgoJCQlyZXR1cm4gRmFsc2UKCQkKCQlpZiB0aXBvbG9wZXNxdWlzYSA9PSAwOgoJCQl0aXBvbG9wZXNxdWlzYU5vdm8gPSAnMCcKCQllbGlmIHRpcG8gPT0gMToKCQkJdGlwb2xvcGVzcXVpc2FOb3ZvID0gJzEnCgkJZWxpZiB0aXBvID09IDI6CgkJCXRpcG9sb3Blc3F1aXNhTm92byA9ICcyJwoJCQkKCQlfX0FERE9OX18uc2V0U2V0dGluZygndG9rZW5QZXNxdWlzYScsIHRpcG9sb3Blc3F1aXNhTm92bykKCQl0ZWNsYWRvID0geGJtYy5LZXlib2FyZCgnJywgJ08gcXVlIHF1ZXIgcGVzcXVpc2FyPycpCgkJdGVjbGFkby5kb01vZGFsKCkKCQkKCQlpZiB0ZWNsYWRvLmlzQ29uZmlybWVkKCk6CgkJCXN0clBlc3F1aXNhID0gdGVjbGFkby5nZXRUZXh0KCkKCQkJaWYgc3RyUGVzcXVpc2EgPT0gJyc6CgkJCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdJbnNpcmEgYWxnbyBuYSBwZXNxdWlzYS4nKQoJCQkJYWRkRGlyMignQWx0ZXJhciBQZXNxdWlzYScsIHVybCwgMTExMjAsIHRpcG9sbywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Blc3F1aXNhLnBuZycpLCAwKQoJCQkJcmV0dXJuIEZhbHNlCgkJCWVsc2U6CgkJCQl0b2tlblBlc3F1aXNhID0gc3RyUGVzcXVpc2EucmVwbGFjZSgiICIsICIlMjAiKQoJCQkJX19BRERPTl9fLnNldFNldHRpbmcoJ3Rva2VuUGVzcXVpc2FUZXh0bycsIHRva2VuUGVzcXVpc2EpCgkKCXJlc3VsdGFkbyA9IGRldm9sdmVyZXN1bHRhZG8odXJsKycmcGVzcXVpc2E9JytfX0FERE9OX18uZ2V0U2V0dGluZygndG9rZW5QZXNxdWlzYVRleHRvJykrJyZnZW5lcm89cGVzcXVpc2EnK19fQURET05fXy5nZXRTZXR0aW5nKCd0b2tlblBlc3F1aXNhJykpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCWZvciBpIGluIHJlc3VsdGFkb1siaXRlbSJdOgoJCWlmIHRpcG9sbyA9PSAnZmlsbWVzJzoKCQkJc2V0RmlsbWUyKGkpCgkJZWxzZToKCQkJc2V0U2VyaWVzMihpKQoJCgljdXJyZW50ID0gcmVzdWx0YWRvWydwYWdpbmFjYW8nXVsnYXR1YWwnXQoJdG90YWwgPSAwCgl0cnk6IHRvdGFsID0gcmVzdWx0YWRvWydwYWdpbmFjYW8nXVsndG90YWwnXQoJZXhjZXB0OiBwYXNzCgl0cnk6IHByb3hpbW8gPSBiYXNlNjQuYjY0ZGVjb2RlKHJlc3VsdGFkb1sncGFnaW5hY2FvJ11bJ3NlZ3VpbnRlJ10pCglleGNlcHQ6IHBhc3MKCWlmIGludChjdXJyZW50KSA8IGludCh0b3RhbCk6CgkJYWRkRGlyMignUHJveGltYSBwYWdpbmEgKCcrc3RyKGN1cnJlbnQpKycvJytzdHIodG90YWwpKycpJywgcHJveGltbywgMTExMjAsIHRpcG9sbywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Byb3hpbW8ucG5nJykpCgllbHNlOgoJCXhibWNwbHVnaW4uZW5kT2ZEaXJlY3RvcnkoaW50KHN5cy5hcmd2WzFdKSxjYWNoZVRvRGlzYz1GYWxzZSkKCQoJdmlzdGFfZmlsbWVzU2VyaWVzKCkKCmRlZiBzZXRTZXJpZXMyKGkpOgoJY2F0ZWdvcmlhID0gIiIKCXRyeTogY2F0ZWdvcmlhID0gYmFzZTY0LmI2NGRlY29kZShpWydHcnVwbyddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglncnVwbzIgPSAiIgoJdHJ5OiBncnVwbzIgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0dydXBvMiddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcyAKCQoJZ3J1cG8zID0gIiIKCXRyeTogZ3J1cG8zID0gYmFzZTY0LmI2NGRlY29kZShpWydHcnVwbzMnXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJaWYgZ3J1cG8yICE9ICIiOgoJCWNhdGVnb3JpYSArPSAnLCcrZ3J1cG8yCglpZiBncnVwbzMgIT0gIiI6CgkJY2F0ZWdvcmlhICs9ICcsJytncnVwbzMKCQoJaWRfdmlkZW8gPSBpWydJRCddCgkKCW5vbWUgPSAnJwoJdHJ5OiBub21lID0gYmFzZTY0LmI2NGRlY29kZShpWydOb21lJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCW5vbWVlbiA9ICcnCgl0cnk6IG5vbWVlbiA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnTm9tZUVOJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCWRlc2NyaWNhbyA9ICcnCgl0cnk6IGRlc2NyaWNhbyA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnRGVzY3JpY2FvJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCXJlYWxpemFkb3IgPSAnJwoJdHJ5OiByZWFsaXphZG9yID0gYmFzZTY0LmI2NGRlY29kZShpWydSZWFsaXphZG9yJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCWFjdG9yZXMgPSAnJwoJdHJ5OiBhY3RvcmVzID0gYmFzZTY0LmI2NGRlY29kZShpWydBY3RvcmVzJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCXlvdXR1YmUgPSAnJwoJdHJ5OiB5b3V0dWJlID0gYmFzZTY0LmI2NGRlY29kZShpWydZb3V0dWJlJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCWltZGIgPSAnJwoJdHJ5OiBpbWRiID0gYmFzZTY0LmI2NGRlY29kZShpWydJbWRiJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCWFub3MgPSBpWydBbm9Ob3ZvJ10KCXRlbXBvcmFkYXMgPSBpWydUZW1wb3JhZGFzJ10KCQoJaW1hZ2VtID0gJycKCXRyeTogaW1hZ2VtID0gYmFzZTY0LmI2NGRlY29kZShpWydJbWFnZW0nXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJdmlzdG8gPSBGYWxzZQoJcHQgPSAnJwoJYnIgPSAnJwoJc2VtTGVnZW5kYSA9ICcnCglpZiAnQnJhc2lsZWlybycgaW4gY2F0ZWdvcmlhOgoJCWJyID0gJ1tCXVtDT0xPUiBncmVlbl1CWy9DT0xPUl1bQ09MT1IgeWVsbG93XVJbL0NPTE9SXTogWy9CXScKCWlmICdQb3J0dScgaW4gY2F0ZWdvcmlhOgoJCXB0ID0gJ1tCXVtDT0xPUiBncmVlbl1QWy9DT0xPUl1bQ09MT1IgcmVkXVRbL0NPTE9SXTogWy9CXScKCWlmICdQVCcgaW4gaW1kYjoKCQlwdCA9ICdbQl1bQ09MT1IgZ3JlZW5dUFsvQ09MT1JdW0NPTE9SIHJlZF1UWy9DT0xPUl06IFsvQl0nCgkKCWlmICdodHRwJyBub3QgaW4gaW1hZ2VtOgoJCWltYWdlbSA9IF9fQVBJX18raW1hZ2VtCgkKCXVybG5vbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPXNlcmllcyZnZW5lcm89dGVtcG9yYWRhJmFkZG9uPTEmc2VyaWU9JytpZF92aWRlbysnJnRlbXBvcmFkYT0nCgkKCWluZm9MYWJlbHMgPSB7J1RpdGxlJzogbm9tZWVuLCAnWWVhcic6IGFub3MsICdHZW5yZSc6IGNhdGVnb3JpYSwgJ1Bsb3QnOiBkZXNjcmljYW8sICdDYXN0JzogYWN0b3Jlcy5zcGxpdCgnLCcpLCAnVHJhaWxlcic6IHlvdXR1YmUsICdEaXJlY3Rvcic6IHJlYWxpemFkb3IsICdSYXRpbmcnOiBpWydSYXRpbmcnXSwgJ0lNREJOdW1iZXInOiBpbWRiIH0KCQoJbm9tZWVlID0gcHQrYnIrc2VtTGVnZW5kYStyZW1vdmVyQWNlbnRvcyhub21lKSsnICgnK2Fub3MrJyknCglmb3Rvb28gPSBpbWFnZW0KCWZhbmFydHR0ID0gX19BUElfXysnaW1hZ2VzL2JhY2tncm91bmQvJytpbWRiKycuanBnJwoJYWRkRGlyMihub21lZWUsIHVybG5vbywgMTExMTQsIHRlbXBvcmFkYXMsIGZvdG9vbywgdGlwbz0nc2VyaWUnLCBpbmZvTGFiZWxzPWluZm9MYWJlbHMscG9zdGVyPWZhbmFydHR0LHZpc3RvPXZpc3RvKQoJCgkKZGVmIGdldFNlYXNvbnMyKHVybCwgbW9kbyk6CglqPWludChtb2RvKQoJZm9yIGkgaW4gcmFuZ2Uoaik6CgkJYWRkRGlyMigiW0JdVGVtcG9yYWRhWy9CXSAiK3N0cihpKzEpLCB1cmwrc3RyKGkrMSksIDExMTE1LCAnZXBpc29kaW9zJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywndGVtcG9yYWRhcycsICd0ZW1wb3JhZGEnK3N0cihpKzEpKycucG5nJykpCgkKCXZpc3RhX3RlbXBvcmFkYXMoKQoKZGVmIGdldEVwaXNvZGVzMih1cmwpOgoJcmVzdWx0YWRvID0gZGV2b2x2ZXJlc3VsdGFkbyh1cmwpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCWZvciBpIGluIHJlc3VsdGFkb1snaXRlbSddOgoJCXB0ID0gJycKCQliciA9ICcnCgkJZmluYWwgPSAnJwoJCXNlbUxlZ2VuZGEgPSAnJwoJCQoJCXZpc3RvID0gRmFsc2UKCQljb3IgPSAnd2hpdGUnCgkJCgkJbm9tZSA9ICcnCgkJdHJ5OiBub21lID0gYmFzZTY0LmI2NGRlY29kZShpWydOb21lJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCgkJaW1kYiA9ICcnCgkJdHJ5OiBpbWRiID0gYmFzZTY0LmI2NGRlY29kZShpWydJbWRiJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCQoJCWltYWdlbSA9ICcnCgkJdHJ5OiBpbWFnZW0gPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0ltYWdlbSddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQkKCQlsZWdlbmRhcyA9ICcnCgkJdHJ5OiBsZWdlbmRhcyA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnTGVnZW5kYXMnXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OiBwYXNzCgkJCgkJYW5vcyA9IGlbJ0Fub05vdm8nXQoJCgkJaWYgJ2h0dHAnIG5vdCBpbiBpbWFnZW06CgkJCWltYWdlbSA9IF9fQVBJX18raW1hZ2VtCgkKCQlpZiBsZWdlbmRhcyA9PSAic2VtbGVnZW5kYSIgb3IgaVsnTGVnZW5kYXMnXSA9PSAiIjoKCQkJc2VtTGVnZW5kYSA9ICdbQ09MT1IgcmVkXVtCXVMvIExFR0VOREEgWy9CXVsvQ09MT1JdJwoJCQoJCWVwaXNvZGlvID0gaVsnRXBpc29kaW8nXQoJCXRlbXBvcmFkYSA9IGlbJ1RlbXBvcmFkYSddCgkJaWRfdmlkZW8gPSBpWydJRCddCgkJCgkJaW5mb0xhYmVscyA9IHsnVGl0bGUnOiBub21lLCAnQ29kZSc6IGltZGIsICdFcGlzb2RlJzogZXBpc29kaW8sICdTZWFzb24nOiB0ZW1wb3JhZGEgfQoJCW5vbWVlZSA9IHB0K2JyK2ZpbmFsK3NlbUxlZ2VuZGErJ1tDT0xPUiAnK2NvcisnXVtCXUVwaXNvZGlvICcrc3RyKGVwaXNvZGlvKSsnWy9CXVsvQ09MT1JdICcrcmVtb3ZlckFjZW50b3Mobm9tZSkKCQkKCQl1cmxub28gPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1zZXJpZXMmZ2VuZXJvPWdldF92aWRlbyZhZGRvbj0xJnBlc3F1aXNhPScrc3RyKGlkX3ZpZGVvKQoJCWZvdG9vbyA9IGltYWdlbQoJCWZhbmFydHR0ID0gX19BUElfXysnaW1hZ2VzL2JhY2tncm91bmQvJytpbWRiKycuanBnJwoJCWFkZFZpZGVvKG5vbWVlZSwgdXJsbm9vLCAxMTExMywgaW1hZ2VtLCB2aXN0bywgJ2VwaXNvZGlvJywgdGVtcG9yYWRhLCBlcGlzb2RpbywgaW5mb0xhYmVscywgZmFuYXJ0dHQpCgkKCXZpc3RhX2VwaXNvZGlvcygpCgpkZWYgcGxheWVyMihuYW1lLCB1cmwsIGljb25pbWFnZSwgbW9kbywgdGVtcG9yYWRhLCBlcGlzb2RpbywgdGlwb2xvZ2kpOgoJcmVzdWx0YWRvID0gZGV2b2x2ZXJlc3VsdGFkbyh1cmwpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCWluZm9sYWJlbHMgPSBkaWN0KCkKCXBhc3RhRGF0YSA9ICcnCglub21lID0gJycKCWlkVmlkZW8gPSAnMCcKCW1lbnNhZ2VtcHJvZ3Jlc3NvID0geGJtY2d1aS5EaWFsb2dQcm9ncmVzcygpCgltZW5zYWdlbXByb2dyZXNzby5jcmVhdGUoQWRkb25UaXRsZSwgdSdBYnJpciBlbWlzc8OjbycsJ1BvciBmYXZvciBhZ3VhcmRlLi4uJykKCW1lbnNhZ2VtcHJvZ3Jlc3NvLnVwZGF0ZSgyNSwgIiIsIHUnT2J0ZXIgdmlkZW8gZSBsZWdlbmRhJywgIiIpCgoJc3RyZWFtLCBsZWdlbmRhLCBleHRfZyA9IGdldFN0cmVhbUxlZ2VuZGEyKHJlc3VsdGFkb1swXSx0aXBvbG9naSkKCWlmIHN0cmVhbSA9PSBGYWxzZSBhbmQgbGVnZW5kYSA9PSAyMDQ6CgkJbWVuc2FnZW1wcm9ncmVzc28uY2xvc2UoKQoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0FsZ3VtIGVycm8uIFRlbnRlIG1haXMgdGFyZGUnKQoJCXJldHVybiBGYWxzZQoJZWxzZToKCQltZW5zYWdlbXByb2dyZXNzby51cGRhdGUoNTAsICIiLCB1J1ByZXBhcmEtdGUsIHZhaSBjb21lw6dhciEnLCAiIikKCQlwbGF5bGlzdCA9IHhibWMuUGxheUxpc3QoMSkKCQlwbGF5bGlzdC5jbGVhcigpCgkJbGlzdGl0ZW0gPSB4Ym1jZ3VpLkxpc3RJdGVtKG5hbWUsIGljb25JbWFnZT0iRGVmYXVsdFZpZGVvLnBuZyIsIHRodW1ibmFpbEltYWdlPWljb25pbWFnZSkKCgkJbGlzdGl0ZW0uc2V0SW5mbyh0eXBlPSJWaWRlbyIsIGluZm9MYWJlbHM9aW5mb2xhYmVscykKCQlsaXN0aXRlbS5zZXRQcm9wZXJ0eSgnbWltZXR5cGUnLCAndmlkZW8veC1tc3ZpZGVvJykKCQlsaXN0aXRlbS5zZXRQcm9wZXJ0eSgnSXNQbGF5YWJsZScsICd0cnVlJykKCQkKCQlsaXN0aXRlbS5zZXRQYXRoKHBhdGg9c3RyZWFtKQoJCXBsYXlsaXN0LmFkZChzdHJlYW0sIGxpc3RpdGVtKQoJCXhibWNwbHVnaW4uc2V0UmVzb2x2ZWRVcmwoaW50KHN5cy5hcmd2WzFdKSwgVHJ1ZSwgbGlzdGl0ZW0pCgkJbWVuc2FnZW1wcm9ncmVzc28udXBkYXRlKDc1LCAiIiwgdSdCb2EgU2Vzc8OjbyEhIScsICIiKQoKCQlpZiBzdHJlYW0gPT0gRmFsc2U6CgkJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ08gc2Vydmlkb3IgZXNjb2xoaWRvIG7Do28gZGlzcG9uw612ZWwsIGVzY29saGEgb3V0cm8gb3UgdGVudGUgbm92YW1lbnRlIG1haXMgdGFyZGUuJykKCQllbHNlOgoJCQlwbGF5ZXJfbXIgPSBQbGF5ZXIuUGxheWVyKHVybD11cmwsIGlkRmlsbWU9aWRWaWRlbywgcGFzdGFEYXRhPV9fUEFTVEFfREFET1NfXywgdGVtcG9yYWRhPXRlbXBvcmFkYSwgZXBpc29kaW89ZXBpc29kaW8sIG5vbWU9bmFtZSwgbG9nbz1vcy5wYXRoLmpvaW4oX19BRERPTl9GT0xERVJfXywnaWNvbi5wbmcnKSkKCQkJbWVuc2FnZW1wcm9ncmVzc28uY2xvc2UoKQoJCQlwbGF5ZXJfbXIucGxheShwbGF5bGlzdCkKCQkJcGxheWVyX21yLnNldFN1YnRpdGxlcyhsZWdlbmRhKQoJCQl3aGlsZSBwbGF5ZXJfbXIucGxheWluZzoKCQkJCXhibWMuc2xlZXAoNTAwMCkKCQkJCSNwbGF5ZXJfbXIudHJhY2tlclRlbXBvKCkKCmRlZiBnZXRTdHJlYW1MZWdlbmRhMih0dWRvaW5mbyx0aXBvb28pOgoJcmVzdWx0YWRvID0gdHVkb2luZm8KCWkgPSAwCglzZXJ2aWRvcmVzID0gW10KCXRpdHVsb3MgPSBbXQoJbm9tZSA9ICcnCgl1cmwxID0gJycKCXRyeTogdXJsMSA9IGJhc2U2NC5iNjRkZWNvZGUocmVzdWx0YWRvWydVcmwnXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCXVybDIgPSAnJwoJdHJ5OiB1cmwyID0gYmFzZTY0LmI2NGRlY29kZShyZXN1bHRhZG9bJ1VybDEnXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCXVybDMgPSAnJwoJdHJ5OiB1cmwzID0gYmFzZTY0LmI2NGRlY29kZShyZXN1bHRhZG9bJ1VybDInXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCXVybDQgPSAnJwoJdHJ5OiB1cmw0ID0gYmFzZTY0LmI2NGRlY29kZShyZXN1bHRhZG9bJ1VybDMnXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCXVybDUgPSAnJwoJdHJ5OiB1cmw1ID0gYmFzZTY0LmI2NGRlY29kZShyZXN1bHRhZG9bJ1VybDQnXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJaWYgdXJsMSAhPSAnJzoKCQlpKz0xCgkJaWYgJ29sb2FkJyBpbiB1cmwxIG9yICdvcGVubG9hZCcgaW4gdXJsMToKCQkJbm9tZSA9ICJPcGVuTG9hZCIKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3ZpZHppJyBpbiB1cmwxOgoJCQlub21lID0gJ1ZpZHppJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwxKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAnZ29vZ2xlJyBpbiB1cmwxIG9yICdjbG91ZC5tYWlsLnJ1JyBpbiB1cmwxIG9yICcubXA0JyBpbiB1cmwxIG9yICcuYXZpJyBpbiB1cmwxOgoJCQlub21lID0gQWRkb25UaXRsZQoJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwxKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAndXB0b3N0cmVhbS5jb20nIGluIHVybDE6CgkJCW5vbWUgPSAnVXBUb1N0cmVhbScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3JhcGlkdmlkZW8uY29tJyBpbiB1cmwxIG9yICdyYXB0dScgaW4gdXJsMToKCQkJbm9tZSA9ICdSYXB0dScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3ZpZG96YS5uZXQnIGluIHVybDE6CgkJCW5vbWUgPSAnVmlkb3phJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwxKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAnc3RyZWFtYW5nby4nIGluIHVybDE6CgkJCW5vbWUgPSAnU3RyZWFtYW5nbycKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3ZlcnlzdHJlYW0uJyBpbiB1cmwxOgoJCQlub21lID0gJ1ZlcnlTdHJlYW0nCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDEpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCWlmIHVybDIgIT0gJyc6CgkJaSs9MQoJCWlmICdvbG9hZCcgaW4gdXJsMiBvciAnb3BlbmxvYWQnIGluIHVybDI6CgkJCW5vbWUgPSAiT3BlbkxvYWQiCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDIpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICd2aWR6aScgaW4gdXJsMjoKCQkJbm9tZSA9ICdWaWR6aScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMikKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ2dvb2dsZScgaW4gdXJsMiBvciAnY2xvdWQubWFpbC5ydScgaW4gdXJsMiBvciAnLm1wNCcgaW4gdXJsMiBvciAnLmF2aScgaW4gdXJsMjoKCQkJbm9tZSA9IEFkZG9uVGl0bGUKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMikKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3VwdG9zdHJlYW0uY29tJyBpbiB1cmwyOgoJCQlub21lID0gJ1VwVG9TdHJlYW0nCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDIpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICdyYXBpZHZpZGVvLmNvbScgaW4gdXJsMiBvciAncmFwdHUnIGluIHVybDI6CgkJCW5vbWUgPSAnUmFwdHUnCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDIpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICd2aWRvemEubmV0JyBpbiB1cmwyOgoJCQlub21lID0gJ1ZpZG96YScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMikKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3N0cmVhbWFuZ28uJyBpbiB1cmwyOgoJCQlub21lID0gJ1N0cmVhbWFuZ28nCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDIpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICd2ZXJ5c3RyZWFtLicgaW4gdXJsMjoKCQkJbm9tZSA9ICdWZXJ5U3RyZWFtJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwyKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCQoJdHJ5OgoJCWlmIHVybDMgIT0gJyc6CgkJCWkrPTEKCQkJaWYgJ29sb2FkJyBpbiB1cmwzIG9yICdvcGVubG9hZCcgaW4gdXJsMzoKCQkJCW5vbWUgPSAiT3BlbkxvYWQiCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwzKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd2aWR6aScgaW4gdXJsMzoKCQkJCW5vbWUgPSAnVmlkemknCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwzKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdnb29nbGUnIGluIHVybDMgb3IgJ2Nsb3VkLm1haWwucnUnIGluIHVybDMgb3IgJy5tcDQnIGluIHVybDMgb3IgJy5hdmknIGluIHVybDM6CgkJCQlub21lID0gQWRkb25UaXRsZQoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMykKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndXB0b3N0cmVhbS5jb20nIGluIHVybDM6CgkJCQlub21lID0gJ1VwVG9TdHJlYW0nCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwzKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdyYXBpZHZpZGVvLmNvbScgaW4gdXJsMyBvciAncmFwdHUnIGluIHVybDM6CgkJCQlub21lID0gJ1JhcHR1JwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMykKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndmlkb3phLm5ldCcgaW4gdXJsMzoKCQkJCW5vbWUgPSAnVmlkb3phJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMykKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAnc3RyZWFtYW5nby4nIGluIHVybDM6CgkJCQlub21lID0gJ1N0cmVhbWFuZ28nCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwzKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd2ZXJ5c3RyZWFtLicgaW4gdXJsMzoKCQkJCW5vbWUgPSAnVmVyeVN0cmVhbScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDMpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCglleGNlcHQ6CgkJcGFzcwoJdHJ5OgoJCWlmIHVybDQgIT0gJyc6CgkJCWkrPTEKCQkJaWYgJ29sb2FkJyBpbiB1cmw0IG9yICdvcGVubG9hZCcgaW4gdXJsNDoKCQkJCW5vbWUgPSAiT3BlbkxvYWQiCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw0KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd2aWR6aScgaW4gdXJsNDoKCQkJCW5vbWUgPSAnVmlkemknCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw0KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdnb29nbGUnIGluIHVybDQgb3IgJ2Nsb3VkLm1haWwucnUnIGluIHVybDQgb3IgJy5tcDQnIGluIHVybDQgb3IgJy5hdmknIGluIHVybDQ6CgkJCQlub21lID0gQWRkb25UaXRsZQoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsNCkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndXB0b3N0cmVhbS5jb20nIGluIHVybDQ6CgkJCQlub21lID0gJ1VwVG9TdHJlYW0nCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw0KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdyYXBpZHZpZGVvLmNvbScgaW4gdXJsNCBvciAncmFwdHUnIGluIHVybDQ6CgkJCQlub21lID0gJ1JhcHR1JwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsNCkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndmlkb3phLm5ldCcgaW4gdXJsNDoKCQkJCW5vbWUgPSAnVmlkb3phJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsNCkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAnc3RyZWFtYW5nby4nIGluIHVybDQ6CgkJCQlub21lID0gJ1N0cmVhbWFuZ28nCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw0KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd2ZXJ5c3RyZWFtLicgaW4gdXJsNDoKCQkJCW5vbWUgPSAnVmVyeVN0cmVhbScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDQpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCglleGNlcHQ6CgkJcGFzcwoJCgl0cnk6CgkJaWYgdXJsNSAhPSAnJzoKCQkJaSs9MQoJCQlpZiAnb2xvYWQnIGluIHVybDUgb3IgJ29wZW5sb2FkJyBpbiB1cmw1OgoJCQkJbm9tZSA9ICJPcGVuTG9hZCIKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDUpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3ZpZHppJyBpbiB1cmw1OgoJCQkJbm9tZSA9ICdWaWR6aScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDUpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ2dvb2dsZScgaW4gdXJsNSBvciAnY2xvdWQubWFpbC5ydScgaW4gdXJsNSBvciAnLm1wNCcgaW4gdXJsNSBvciAnLmF2aScgaW4gdXJsNToKCQkJCW5vbWUgPSBBZGRvblRpdGxlCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw1KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd1cHRvc3RyZWFtLmNvbScgaW4gdXJsNToKCQkJCW5vbWUgPSAnVXBUb1N0cmVhbScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDUpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3JhcGlkdmlkZW8uY29tJyBpbiB1cmw1IG9yICdyYXB0dScgaW4gdXJsNToKCQkJCW5vbWUgPSAnUmFwdHUnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw1KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd2aWRvemEubmV0JyBpbiB1cmw1OgoJCQkJbm9tZSA9ICdWaWRvemEnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw1KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdzdHJlYW1hbmdvLicgaW4gdXJsNToKCQkJCW5vbWUgPSAnU3RyZWFtYW5nbycKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDUpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3ZlcnlzdHJlYW0uJyBpbiB1cmw1OgoJCQkJbm9tZSA9ICdWZXJ5U3RyZWFtJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsNSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCWV4Y2VwdDoKCQlwYXNzCgkKCXN0cmVhbSA9ICcnCglsZWdlbmRhID0gJycKCWxlZ2VuZGFub3ZhID0gJycKCXRyeToKCQlsZWdlbmRhbm92YSA9IGJhc2U2NC5iNjRkZWNvZGUocmVzdWx0YWRvWydMZWdlbmRhcyddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDoKCQlwYXNzCgkKCWlmICdsaXZlaXQnIGluIGxlZ2VuZGFub3ZhOgoJCWxlZ2VuZGEgPSAnJwoJZWxpZiAnaHR0cCcgaW4gbGVnZW5kYW5vdmE6CgkJbGVnZW5kYSA9IGxlZ2VuZGFub3ZhCgllbGlmICdzdWJzLycgaW4gbGVnZW5kYW5vdmE6CgkJbGVnZW5kYSA9IF9fQVBJX18rbGVnZW5kYW5vdmEKCWVsc2U6CgkJbGVnZW5kYSA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyAibGVnZW5kYXMvIiArbGVnZW5kYW5vdmEKCQoJZXh0X2cgPSAnY29pc28nCglsZWdlbmRhQXV4ID0gbGVnZW5kYQoJc2Vydmlkb3IgPSAwCglpZiBsZW4odGl0dWxvcykgPiAxOgoJCXNlcnZpZG9yID0geGJtY2d1aS5EaWFsb2coKS5zZWxlY3QoJ0VzY29saGEgbyBzZXJ2aWRvcicsIHRpdHVsb3MpCgllbHNlOgoJCXNlcnZpZG9yID0gMAoJCglpZiAndmlkemknIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXZpZHppID0gVVJMUmVzb2x2ZXJNZWRpYS5WaWR6aShzZXJ2aWRvcmVzW3NlcnZpZG9yXSkKCQlzdHJlYW0gPSB2aWR6aS5nZXRNZWRpYVVybCgpCgkJbGVnZW5kYSA9IHZpZHppLmdldFN1YnRpdGxlKCkKCWVsaWYgJ3VwdG9zdHJlYW0uY29tJyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQlzdHJlYW0gPSBVUkxSZXNvbHZlck1lZGlhLlVwVG9TdHJlYW0oc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pLmdldE1lZGlhVXJsKCkKCWVsaWYgJ3NlcnZlci5tcnBpcmFjeS53aW4nIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXN0cmVhbSA9IHNlcnZpZG9yZXNbc2Vydmlkb3JdCgllbGlmICdvbG9hZCcgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJc3RyZWFtID0gVVJMUmVzb2x2ZXJNZWRpYS5PcGVuTG9hZChzZXJ2aWRvcmVzW3NlcnZpZG9yXSkuZ2V0TWVkaWFVcmwoKQoJCWxlZ2VuZGEgPSBVUkxSZXNvbHZlck1lZGlhLk9wZW5Mb2FkKHNlcnZpZG9yZXNbc2Vydmlkb3JdKS5nZXRTdWJ0aXRsZSgpCgkJaWYgbm90ICcudnR0JyBpbiBsZWdlbmRhIG9yIGxlZ2VuZGEgPT0gJyc6CgkJCWxlZ2VuZGEgPSBsZWdlbmRhQXV4CgllbGlmICdkcml2ZS5nb29nbGUuY29tLycgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJc3RyZWFtLCBleHRfZyA9IFVSTFJlc29sdmVyTWVkaWEuR29vZ2xlVmlkZW8oc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pLmdldE1lZGlhVXJsKCkKCWVsaWYgJ2Nsb3VkLm1haWwucnUnIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXN0cmVhbSwgZXh0X2cgPSBVUkxSZXNvbHZlck1lZGlhLkNsb3VkTWFpbFJ1KHNlcnZpZG9yZXNbc2Vydmlkb3JdKS5nZXRNZWRpYVVybCgpCgllbGlmICdyYXBpZHZpZGVvLmNvbScgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl0gb3IgJ3JhcHR1JyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQlyYXBpZCA9IFVSTFJlc29sdmVyTWVkaWEuUmFwaWRWaWRlbyhzZXJ2aWRvcmVzW3NlcnZpZG9yXSkKCQlzdHJlYW0gPSByYXBpZC5nZXRNZWRpYVVybCgpCgkJbGVnZW5kYSA9IHJhcGlkLmdldExlZ2VuZGEoKQoJZWxpZiAndmlkb3phLm5ldCcgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJdmlkb3ogPSBVUkxSZXNvbHZlck1lZGlhLlZpZG96YShzZXJ2aWRvcmVzW3NlcnZpZG9yXSkKCQlzdHJlYW0gPSB2aWRvei5nZXRNZWRpYVVybCgpCgkJbGVnZW5kYSA9IHZpZG96LmdldExlZ2VuZGEoKQoJZWxpZiAnc3RyZWFtYW5nby4nIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXN0cmVhbWFuID0gVVJMUmVzb2x2ZXJNZWRpYS5TdHJlYW1hbmdvKHNlcnZpZG9yZXNbc2Vydmlkb3JdKQoJCXN0cmVhbSA9IHN0cmVhbWFuLmdldE1lZGlhVXJsKCkKCQlsZWdlbmRhID0gc3RyZWFtYW4uZ2V0TGVnZW5kYSgpCgllbGlmICd2ZXJ5c3RyZWFtLicgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJc3RyZWFtYW4gPSBVUkxSZXNvbHZlck1lZGlhLlZlcnlTdHJlYW0oc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pCgkJc3RyZWFtID0gc3RyZWFtYW4uZ2V0TWVkaWFVcmwoKQoJCWxlZ2VuZGEgPSBzdHJlYW1hbi5nZXRMZWdlbmRhKCkKCWVsc2U6CgkJc3RyZWFtID0gc2Vydmlkb3Jlc1tzZXJ2aWRvcl0KCXJldHVybiBzdHJlYW0sIGxlZ2VuZGEsIGV4dF9nCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwkJCQkJCQkJCQkJCUFkZG9uIEZpbG1lcyBlIFNlcmllcwkJCQkJCQkJCSAgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCmRlZiBsaXN0YW1lbnVzc2VyaWVzKG5vbWVfbm92LHVybCxlc3RpbG8sdGlwbyx0aXBvX3VzZXIsc2Vydmlkb3JfdXNlcixpY29uaW1hZ2UsZmFuYXJ0KToKCWNoZWNrX2xvZ2luID0gbG9naW4yKCkKCWlmIGNoZWNrX2xvZ2luID09IFRydWU6CgkJZGF0YWJhc2UgPSBEYXRhYmFzZS5pc0V4aXN0cygpCgkJbWVudVNlcmllcyhvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnc2VyaWVzLnBuZycpLF9fU0lURUFkZG9uX18rJ0ltYWdlbnMvc2VyaWVzX2ZhbmFydC5wbmcnKQoJZWxzZToKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdFcnJvIGEgZmF6ZXIgbG9naW4gbmVzdGEgcGFydGUuIFRlbnRlIG5vdmFtZW50ZSBtYWlzIHRhcmRlLicpCgpkZWYgbGlzdGFtZW51c2ZpbG1lcyhub21lX25vdix1cmwsZXN0aWxvLHRpcG8sdGlwb191c2VyLHNlcnZpZG9yX3VzZXIsaWNvbmltYWdlLGZhbmFydCk6CgljaGVja19sb2dpbiA9IGxvZ2luMigpCglpZiBjaGVja19sb2dpbiA9PSBUcnVlOgoJCWRhdGFiYXNlID0gRGF0YWJhc2UuaXNFeGlzdHMoKQoJCW1lbnVGaWxtZXMob3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ZpbG1lcy5wbmcnKSxfX1NJVEVBZGRvbl9fKydJbWFnZW5zL2ZpbG1lc19mYW5hcnQucG5nJykKCWVsc2U6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnRXJybyBhIGZhemVyIGxvZ2luIG5lc3RhIHBhcnRlLiBUZW50ZSBub3ZhbWVudGUgbWFpcyB0YXJkZS4nKQoKZGVmIGxpc3RhbWVudXNhbmltZXMobm9tZV9ub3YsdXJsLGVzdGlsbyx0aXBvLHRpcG9fdXNlcixzZXJ2aWRvcl91c2VyLGljb25pbWFnZSxmYW5hcnQpOgoJY2hlY2tfbG9naW4gPSBsb2dpbjIoKQoJaWYgY2hlY2tfbG9naW4gPT0gVHJ1ZToKCQlkYXRhYmFzZSA9IERhdGFiYXNlLmlzRXhpc3RzKCkKCQltZW51QW5pbWVzKG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdhbmltZXMucG5nJyksX19TSVRFQWRkb25fXysnSW1hZ2Vucy9zZXJpZXNfZmFuYXJ0LnBuZycpCgllbHNlOgoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0Vycm8gYSBmYXplciBsb2dpbiBuZXN0YSBwYXJ0ZS4gVGVudGUgbm92YW1lbnRlIG1haXMgdGFyZGUuJykKCmRlZiBtZW51RmlsbWVzKGljb25pbWFnZSxmYW5hcnQpOgoJYWRkRGlyMignVG9kb3Mgb3MgRmlsbWVzJywgX19BUElfU0lURV9fKydmaWxtZXMucGhwP3F1YWxpZGFkZT0nK19fUXVhbGlkYWRlX18sIDExMSwgJ2ZpbG1lcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignRmlsbWVzIGVtIERlc3RhcXVlJywgIF9fQVBJX1NJVEVfXysnZmlsbWVzLnBocD9hY3Rpb249ZGVzdGFxdWUmcXVhbGlkYWRlPScrX19RdWFsaWRhZGVfXywgMTExLCAnZmlsbWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdGaWxtZXMgcG9yIEFubycsIF9fQVBJX1NJVEVfXysnZmlsbWVzLnBocD9hY3Rpb249YW5vJywgMTE5LCAnbGlzdGFnZW1Bbm9zJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Fuby5wbmcnKSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignRmlsbWVzIHBvciBHZW5lcm8nLCBfX0FQSV9TSVRFX18rJ2ZpbG1lcy5waHA/YWN0aW9uPWNhdGVnb3JpYScsIDExOCwgJ2xpc3RhZ2VtR2VuZXJvcycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdnZW5lcm8ucG5nJyksIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ0ZpbG1lcyBwb3IgSU1EQiBSYWtpbmcnLCAgX19BUElfU0lURV9fKydmaWxtZXMucGhwP2FjdGlvbj1pbWRiUmFuayZxdWFsaWRhZGU9JytfX1F1YWxpZGFkZV9fLCAxMTEsICdmaWxtZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ0ZpbG1lcyBQYXJhIENyaWFuw6dhcycsICBfX0FQSV9TSVRFX18rJ2ZpbG1lcy5waHA/YWN0aW9uPXB0JnF1YWxpZGFkZT0nK19fUXVhbGlkYWRlX18sIDExMSwgJ2ZpbG1lcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJCgl2aXN0YV9tZW51KCkKCmRlZiBtZW51U2VyaWVzKGljb25pbWFnZSxmYW5hcnQpOgoJYWRkRGlyMignVG9kYXMgYXMgU2VyaWVzJywgX19BUElfU0lURV9fKydzZXJpZXMucGhwJywgMTIzLCAnc2VyaWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdTZXJpZXMgZW0gRGVzdGFxdWUnLCAgX19BUElfU0lURV9fKydzZXJpZXMucGhwP2FjdGlvbj1kZXN0YXF1ZScsIDEyMywgJ3NlcmllcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignU2VyaWVzIHBvciBBbm8nLCBfX0FQSV9TSVRFX18rJ3Nlcmllcy5waHA/YWN0aW9uPWFubycsIDExOSwgJ2xpc3RhZ2VtQW5vcycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdhbm8ucG5nJyksIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ1NlcmllcyBwb3IgR2VuZXJvJywgX19BUElfU0lURV9fKydzZXJpZXMucGhwP2FjdGlvbj1jYXRlZ29yaWEnLCAxMTgsICdsaXN0YWdlbUdlbmVyb3MnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZ2VuZXJvLnBuZycpLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCgoJdmlzdGFfbWVudSgpCgpkZWYgbWVudUFuaW1lcyhpY29uaW1hZ2UsZmFuYXJ0KToKCWFkZERpcjIoJ1RvZG9zIG9zIEFuaW1lcycsIF9fQVBJX1NJVEVfXysnYW5pbWVzLnBocCcsIDEyMywgJ2FuaW1lcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignQW5pbWVzIGVtIERlc3RhcXVlJywgIF9fQVBJX1NJVEVfXysnYW5pbWVzLnBocD9hY3Rpb249ZGVzdGFxdWUnLCAxMjMsICdhbmltZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ0FuaW1lcyBwb3IgQW5vJywgX19BUElfU0lURV9fKydhbmltZXMucGhwP2FjdGlvbj1hbm8nLCAxMTksICdsaXN0YWdlbUFub3MnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnYW5vLnBuZycpLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdBbmltZXMgcG9yIEdlbmVybycsIF9fQVBJX1NJVEVfXysnYW5pbWVzLnBocD9hY3Rpb249Y2F0ZWdvcmlhJywgMTE4LCAnbGlzdGFnZW1HZW5lcm9zJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2dlbmVyby5wbmcnKSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoKCXZpc3RhX21lbnUoKQoKZGVmIGdldExpc3RDYXRlZ29yaWEoKToKCWNhdCA9IGxlcl9maWNoZWlybyhvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdjYXRlZ29yaWFzLmxpdmVpdCcpKS5yZXBsYWNlKCciJywgIiciKQoJcmV0dXJuIGNhdAoKZGVmIHJlbW92ZXJBY2VudG9zKHR4dCwgZW5jb2Rpbmc9J3V0Zi04Jyk6CglyZXR1cm4gbm9ybWFsaXplKCdORktEJywgdHh0LmRlY29kZShlbmNvZGluZykpLmVuY29kZSgnQVNDSUknLCdpZ25vcmUnKQoKZGVmIGVzY3JldmVyX2ZpY2hlaXJvKGZpY2hlaXJvLCBjb250ZXVkbyk6CiAgICBmID0gb3BlbihmaWNoZWlybywgbW9kZT0idyIpCiAgICBmLndyaXRlKGNvbnRldWRvKQogICAgZi5jbG9zZSgpCgpkZWYgbGVyX2ZpY2hlaXJvKGZpY2hlaXJvKToKICAgIGYgPSBvcGVuKGZpY2hlaXJvLCAiciIpCiAgICBjb250ZXVkbyA9ICBmLnJlYWQoKQogICAgZi5jbG9zZSgpCiAgICByZXR1cm4gY29udGV1ZG8KCmRlZiBnZXRDYXRlZ29yaWEoaWQpOgoJY2F0ID0gbGVyX2ZpY2hlaXJvKG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ2NhdGVnb3JpYXMubGl2ZWl0JykpLnJlcGxhY2UoJyInLCAiJyIpCglmb3IgYyBpbiBhc3QubGl0ZXJhbF9ldmFsKGNhdCk6CgkJaWYgaW50KGlkKSA9PSAwOgoJCQlyZXR1cm4gJycKCQlpZiBpbnQoY1snaWRfY2F0ZWdvcmlhJ10pID09IGludChpZCk6CgkJCXRyeToKCQkJCWNhdCA9IGNbJ2NhdGVnb3JpYXMnXS5kZWNvZGUoJ3V0Zi04JykKCQkJZXhjZXB0OgoJCQkJY2F0ID0gY1snY2F0ZWdvcmlhcyddLmVuY29kZSgndXRmLTgnKQoJCQlyZXR1cm4gY2F0CgkKCSIiImlmIGludChpZCkgPT0gMDoKCQlyZXR1cm4gJycKCQoJZm9yIGMsIGkgaW4gY2F0czoKCQlpZiBpbnQoaSkgPT0gaW50KGlkKToKCQkJcmV0dXJuIGMiIiIKCglyZXR1cm4gJycKCQpkZWYgZ2V0Q29va2llKCk6CglyZXR1cm4gJ3VzZXJuYW1lPScrX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuTXJwaXJhY3knKQoKZGVmIHZlcmlmaWNhclZpc3RvTG9jYWwoaWRWaWRlbywgdGVtcG9yYWRhPU5vbmUsIGVwaXNvZGlvPU5vbmUpOgoJcGFzdGFWaXN0bz1vcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCd2aXN0b3MnKQoKCWlmIHRlbXBvcmFkYSBhbmQgZXBpc29kaW86CgkJZmljaGVpcm9WaXN0byA9IG9zLnBhdGguam9pbihwYXN0YVZpc3RvLHN0cihpZFZpZGVvKSsnX1MnK3N0cih0ZW1wb3JhZGEpKyd4JytzdHIoZXBpc29kaW8pKycubGl2ZWl0JykKCWVsc2U6CgkJZmljaGVpcm9WaXN0byA9IG9zLnBhdGguam9pbihwYXN0YVZpc3RvLHN0cihpZFZpZGVvKSsnLmxpdmVpdCcpCgoJaWYgb3MucGF0aC5leGlzdHMoZmljaGVpcm9WaXN0byk6CgkJcmV0dXJuIFRydWUKCWVsc2U6CgkJcmV0dXJuIEZhbHNlCgpkZWYgZmlsbWVzKHVybCwgcGFnaW5hKToKCSNoZWFkZXJzWydBdXRob3JpemF0aW9uJ10gPSAnQmVhcmVyICVzJyAlIF9fQURET05fXy5nZXRTZXR0aW5nKCd0b2tlbk1ycGlyYWN5JykKCSNpZiByZXN1bHRhZG8gPT0gJ0ROUyc6CgkjCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1RlbSBkZSBhbHRlcmFyIG9zIEROUyBwYXJhIHBvZGVyIHVzdWZydWlyIGRvIF9fQURET05fXy4nKQoJIwlyZXR1cm4gRmFsc2UKCXJlc3VsdGFkbyA9IGFicmlyX3VybCh1cmwsIGhlYWRlcj1oZWFkZXJzLCBjb29raWU9Z2V0Q29va2llKCkpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCXZpc3RvcyA9IERhdGFiYXNlLnNlbGVjdEZpbG1lcygpCglvcGNhbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCdtYXJjYXJWaXN0bycpCglmb3IgaSBpbiByZXN1bHRhZG9bJ2RhdGEnXToKCQlzZXRGaWxtZShpLCB2aXN0b3MsIG9wY2FvKQoJdHJ5OiAKCQljdXJyZW50ID0gcmVzdWx0YWRvWydtZXRhJ11bJ2N1cnJlbnQnXQoJZXhjZXB0OiAKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdBZ3VhcmRlIHBlbGEgcHLDs3hpbWEgYXR1YWxpemHDp8Ojby4gT3UgdGVudGUgbWFpcyB0YXJkZS4nKQoJCXJldHVybiBGYWxzZQoJY3VycmVudCA9IHJlc3VsdGFkb1snbWV0YSddWydjdXJyZW50J10KCXRvdGFsID0gcmVzdWx0YWRvWydtZXRhJ11bJ3RvdGFsJ10KCXRyeTogcHJveGltbyA9IHJlc3VsdGFkb1snbWV0YSddWydwYWdpbmFjYW8nXVsnbmV4dCddCglleGNlcHQ6IHBhc3MgCglpZiBpbnQoY3VycmVudCkgPCBpbnQodG90YWwpOgoJCWFkZERpcjIoJ1Byw7N4aW1hIHDDoWdpbmEgKCcrc3RyKGN1cnJlbnQpKycvJytzdHIodG90YWwpKycpJywgcHJveGltbywgMTExLCAnZmlsbWVzJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Byb3hpbW8ucG5nJyksMSkKCXZpc3RhX2ZpbG1lc1NlcmllcygpCgkJCmRlZiBzZXJpZXModXJsKToKCSNoZWFkZXJzWydBdXRob3JpemF0aW9uJ10gPSAnQmVhcmVyICVzJyAlIF9fQURET05fXy5nZXRTZXR0aW5nKCd0b2tlbk1ycGlyYWN5JykKCSNpZiByZXN1bHRhZG8gPT0gJ0ROUyc6CgkjCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1RlbSBkZSBhbHRlcmFyIG9zIEROUyBwYXJhIHBvZGVyIHVzdWZydWlyIGRvIF9fQURET05fXy4nKQoJIwlyZXR1cm4gRmFsc2UKCXJlc3VsdGFkbyA9IGFicmlyX3VybCh1cmwsIGhlYWRlcj1oZWFkZXJzLCBjb29raWU9Z2V0Q29va2llKCkpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCWlmICdzZXJpZScgaW4gdXJsOgoJCXRpcG8gPSAnc2VyaWUnCgllbGlmICdhbmltZScgaW4gdXJsOgoJCXRpcG8gPSAnYW5pbWUnCgkJCglpZiAnc2VyaWUnIGluIHVybDoKCQl0aXBvID0gJ3NlcmllcycKCWVsaWYgJ2FuaW1lJyBpbiB1cmw6CgkJdGlwbyA9ICdhbmltZXMnCgl2aXN0b3MgPSBEYXRhYmFzZS5zZWxlY3RGaWxtZXMoKQoJb3BjYW8gPSBfX0FERE9OX18uZ2V0U2V0dGluZygnbWFyY2FyVmlzdG8nKQoJZm9yIGkgaW4gcmVzdWx0YWRvWydkYXRhJ106CgkJc2V0U2VyaWVzKGksIHZpc3Rvcywgb3BjYW8sIHRpcG8pCgl0cnk6IAoJCWN1cnJlbnQgPSByZXN1bHRhZG9bJ21ldGEnXVsnY3VycmVudCddCglleGNlcHQ6IAoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0FndWFyZGUgcGVsYSBwcsOzeGltYSBhdHVhbGl6YcOnw6NvLiBPdSB0ZW50ZSBtYWlzIHRhcmRlLicpCgkJcmV0dXJuIEZhbHNlCgljdXJyZW50ID0gcmVzdWx0YWRvWydtZXRhJ11bJ2N1cnJlbnQnXQoJdG90YWwgPSByZXN1bHRhZG9bJ21ldGEnXVsndG90YWwnXQoJdHJ5OiBwcm94aW1vID0gcmVzdWx0YWRvWydtZXRhJ11bJ3BhZ2luYWNhbyddWyduZXh0J10KCWV4Y2VwdDogcGFzcyAKCWlmIGludChjdXJyZW50KSA8IGludCh0b3RhbCk6CgkJYWRkRGlyMignUHJveGltYSBwYWdpbmEgKCcrc3RyKGN1cnJlbnQpKycvJytzdHIodG90YWwpKycpJywgcHJveGltbywgMTIzLCAnc2VyaWVzJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Byb3hpbW8ucG5nJykpCgl2aXN0YV9maWxtZXNTZXJpZXMoKQoKZGVmIGdldFNlYXNvbnModXJsKToKCSNoZWFkZXJzWydBdXRob3JpemF0aW9uJ10gPSAnQmVhcmVyICVzJyAlIF9fQURET05fXy5nZXRTZXR0aW5nKCd0b2tlbk1ycGlyYWN5JykKCXJlc3VsdGFkbyA9IGFicmlyX3VybCh1cmwsIGhlYWRlcj1oZWFkZXJzLCBjb29raWU9Z2V0Q29va2llKCkpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbylbJ2RhdGEnXVswXQoJaWQgPSB1cmwuc3BsaXQoJz0nKVstMV0KCWlmICdzZXJpZScgaW4gdXJsOgoJCXVybCA9IF9fQVBJX1NJVEVfXysnc2VyaWVzLnBocD9hY3Rpb249dGVtcG9yYWRhJmlkU2VyaWU9JytpZCsnJm49JXMnCgllbGlmICdhbmltZScgaW4gdXJsOgoJCXVybCA9IF9fQVBJX1NJVEVfXysnYW5pbWVzLnBocD9hY3Rpb249dGVtcG9yYWRhJmlkU2VyaWU9JytpZCsnJm49JXMnCgkKCXRyeToKCQlyZXN1bHRhZG9bJ3RlbXBvcmFkYXMnXSA9IHJlc3VsdGFkb1sndGVtcG9yYWRhcyddLnJlcGxhY2UoJ2VzcGVjaWFsJywgJzk5OScpCglleGNlcHQ6CgkJcGFzcwoJaWYgcmVzdWx0YWRvID09ICdETlMnOgoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1RlbSBkZSBhbHRlcmFyIG9zIEROUyBwYXJhIHBvZGVyIHVzdWZydWlyIGRvIF9fQURET05fXy4nKQoJCXJldHVybiBGYWxzZQoJCglqPTEKCQoJaWYgcmVzdWx0YWRvWyd0ZW1wb3JhZGFzJ10gPT0gIiI6CgkJcmV0dXJuIEZhbHNlCglmb3IgYywgaSBpbiBzb3J0ZWQoanNvbi5sb2FkcyhyZXN1bHRhZG9bJ3RlbXBvcmFkYXMnXSkuaXRlcml0ZW1zKCksIGtleT1sYW1iZGEgaTogaW50KGlbMF0pKToKCQlpZiBjICE9ICc5OTknOgoJCQlhZGREaXIyKCJbQl1UZW1wb3JhZGFbL0JdICIrc3RyKGMpLCAodXJsICUgc3RyKGMpKSwgMTE1LCAnZXBpc29kaW9zJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywndGVtcG9yYWRhcycsICd0ZW1wb3JhZGEnK3N0cihjKSsnLnBuZycpLHBvc3Rlcj1fX0FQSV9fK3Jlc3VsdGFkb1snYmFja2dyb3VuZCddKQoJCWVsc2U6CgkJCWFkZERpcjIoIltCXVRlbXBvcmFkYVsvQl0gIitzdHIoYyksICh1cmwgJSAnOTk5JyksIDExNSwgJ2VwaXNvZGlvcycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sJ3RlbXBvcmFkYXMnLCAndGVtcG9yYWRhJytzdHIoYykrJy5wbmcnKSxwb3N0ZXI9X19BUElfXytyZXN1bHRhZG9bJ2JhY2tncm91bmQnXSkKCQoJdmlzdGFfdGVtcG9yYWRhcygpCgpkZWYgZ2V0RXBpc29kZXModXJsKToKCSNoZWFkZXJzWydBdXRob3JpemF0aW9uJ10gPSAnQmVhcmVyICVzJyAlIF9fQURET05fXy5nZXRTZXR0aW5nKCd0b2tlbk1ycGlyYWN5JykKCXJlc3VsdGFkbyA9IGFicmlyX3VybCh1cmwsIGhlYWRlcj1oZWFkZXJzLCBjb29raWU9Z2V0Q29va2llKCkpCglpZiByZXN1bHRhZG8gPT0gJ0ROUyc6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVGVtIGRlIGFsdGVyYXIgb3MgRE5TIHBhcmEgcG9kZXIgdXN1ZnJ1aXIgZG8gX19BRERPTl9fLicpCgkJcmV0dXJuIEZhbHNlCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCWlmICdzZXJpZScgaW4gdXJsOgoJCXRpcG8gPSAnc2VyaWVzJwoJZWxpZiAnYW5pbWUnIGluIHVybDoKCQl0aXBvID0gJ2FuaW1lcycKCWZvciBpIGluIHJlc3VsdGFkb1snZGF0YSddOgoJCXB0ID0gJycKCQlpbmZvTGFiZWxzID0geydUaXRsZSc6IGlbJ25vbWVfZXBpc29kaW8nXSwgJ0NvZGUnOiBpWydJTUJEJ10sICdFcGlzb2RlJzogaVsnZXBpc29kaW8nXSwgJ1NlYXNvbic6IGlbJ3RlbXBvcmFkYSddIH0KCQkKCQl0cnk6CgkJCW5vbWUgPSBpWydub21lX2VwaXNvZGlvJ10uZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OgoJCQlub21lID0gaVsnbm9tZV9lcGlzb2RpbyddLmVuY29kZSgndXRmLTgnKQoJCWJyID0gJycKCQlmaW5hbCA9ICcnCgkJc2VtTGVnZW5kYSA9ICcnCgkJaWYgaVsnZmltdGVtcG9yYWRhJ10gPT0gMToKCQkJZmluYWwgPSAnW0JdRmluYWwgZGEgVGVtcG9yYWRhIFsvQl0nCgkJaWYgaVsnc2VtbGVnZW5kYSddID09IDE6CgkJCXNlbUxlZ2VuZGEgPSAnW0NPTE9SIHJlZF1bQl1TLyBMRUdFTkRBIFsvQl1bL0NPTE9SXScKCQkjaWYgJ0JyYXNpbGVpcm8nIGluIGNhdGVnb3JpYToKCQkjCWJyID0gJ1tCXVtDT0xPUiBncmVlbl1CWy9DT0xPUl1bQ09MT1IgeWVsbG93XVJbL0NPTE9SXTogWy9CXScKCQkjaWYgJ1BvcnR1JyBpbiBjYXRlZ29yaWE6CgkJIwlwdCA9ICdbQl1bQ09MT1IgZ3JlZW5dUFsvQ09MT1JdW0NPTE9SIHJlZF1UWy9DT0xPUl06IFsvQl0nCgkJaWYgJ1BUJyBpbiBpWydJTUJEJ106CgkJCWlbJ0lNQkQnXSA9IHJlLmNvbXBpbGUoJyguKz8pUFQnKS5maW5kYWxsKGlbJ0lNQkQnXSlbMF0KCQkJcHQgPSAnW0JdW0NPTE9SIGdyZWVuXVBbL0NPTE9SXVtDT0xPUiByZWRdVFsvQ09MT1JdOiBbL0JdJwoJCXZpc3RvID0gRmFsc2UKCQljb3IgPSAnd2hpdGUnCgkJI2lmIGlbJ3Zpc3RvJ10gPT0gMToKCQkjCXZpc3RvID0gVHJ1ZQkKCQkKCQlpbWFnZW0gPSAnJwoJCWlmIGlbJ2ltYWdlbSddID09IDE6CgkJCWltYWdlbSA9IF9fQVBJX18rJ2ltYWdlcy9zZXJpZXMvJytpWydJTUJEJ10rJy5qcGcnCgkJZWxpZiBpWydpbWFnZW0nXSA9PSAwOgoJCQlpbWFnZW0gPSBfX0FQSV9fKydpbWFnZXMvY2FwYXMvJytpWydpbWRiU2VyaWUnXSsnLmpwZycKCQkKCQkjaW1hZ2VtID0gaW1hZ2VtLnJlcGxhY2UoJ1BUJywnJykKCQkjaVsnYmFja2dyb3VuZCddID0gaVsnYmFja2dyb3VuZCddLnJlcGxhY2UoJ1BUJywnJykKCQlpWydiYWNrZ3JvdW5kJ10gPSAnaW1hZ2VzL2JhY2tncm91bmQvJytpWydJTUJEJ10rJy5qcGcnCgkJZmFuYXJ0dHQgPSBfX0FQSV9fK2lbJ2JhY2tncm91bmQnXQoJCQoJCW5vbWVlZSA9IHB0K2JyK2ZpbmFsK3NlbUxlZ2VuZGErJ1tDT0xPUiAnK2NvcisnXVtCXUVwaXNvZGlvICcrc3RyKGlbJ2VwaXNvZGlvJ10pKydbL0JdWy9DT0xPUl0gJytyZW1vdmVyQWNlbnRvcyhub21lKQoJCXVybG5vdm8gPSBfX0FQSV9TSVRFX18rdGlwbysnLnBocD9hY3Rpb249ZXBpc29kaW8maWRTZXJpZT0nK3N0cihpWydpZF9zZXJpZSddKSsnJmlkRXBpc29kaW89JytzdHIoaVsnaWRfZXBpc29kaW8nXSkKCQlhZGRWaWRlbyhub21lZWUsIHVybG5vdm8sIDExMywgaW1hZ2VtLCB2aXN0bywgJ2VwaXNvZGlvJywgaVsndGVtcG9yYWRhJ10sIGlbJ2VwaXNvZGlvJ10sIGluZm9MYWJlbHMsIGZhbmFydHR0KQoJCgl2aXN0YV9lcGlzb2Rpb3MoKQoKZGVmIGdldEdlbmVyb3ModXJsKToKCWxpc3RhID0gZ2V0TGlzdENhdGVnb3JpYSgpCglpZiAnZmlsbWVzJyBpbiB1cmw6CgkJdGlwbyA9IDAKCQlxdWFsaWRhZGUgPSAnJnF1YWxpZGFkZT0nK19fUXVhbGlkYWRlX18KCWVsaWYgJ3NlcmllcycgaW4gdXJsOgoJCXRpcG8gPSAxCgkJcXVhbGlkYWRlID0gJycKCWVsaWYgJ2FuaW1lcycgaW4gdXJsOgoJCXRpcG8gPSAyCgkJcXVhbGlkYWRlID0gJycKCQoJZm9yIGMgaW4gYXN0LmxpdGVyYWxfZXZhbChsaXN0YSk6CgkJaWYgY1snaWRfY2F0ZWdvcmlhJ10gPT0gIjAiOgoJCQljb250aW51ZQoJCXRyeToKCQkJY2F0ID0gY1snY2F0ZWdvcmlhcyddLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDoKCQkJY2F0ID0gY1snY2F0ZWdvcmlhcyddLmVuY29kZSgndXRmLTgnKQoJCQoJCXVybG5vdm8gPSB1cmwrJyZjYXRlZ29yaWE9JytzdHIoY1snaWRfY2F0ZWdvcmlhJ10pK3F1YWxpZGFkZTsKCQlhZGREaXIyKGNhdCwgdXJsbm92bywgMTIyLCAnY2F0ZWdvcmlhcycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdnZW5lcm8ucG5nJykpCgkKCXZpc3RhX21lbnUoKQoKZGVmIHNldEZpbG1lKGksIHZpc3Rvcywgb3BjYW8pOgoJY2F0ZWdvcmlhID0gZ2V0Q2F0ZWdvcmlhKGlbJ2NhdGVnb3JpYTEnXSkKCWlmIGludChpWydjYXRlZ29yaWEyJ10pICE9IDA6CgkJY2F0ZWdvcmlhICs9ICcsJytnZXRDYXRlZ29yaWEoaVsnY2F0ZWdvcmlhMiddKQoJaWYgaW50KGlbJ2NhdGVnb3JpYTMnXSkgIT0gMDoKCQljYXRlZ29yaWEgKz0gJywnK2dldENhdGVnb3JpYShpWydjYXRlZ29yaWEzJ10pCgkKCXB0ID0gJycKCWJyID0gJycKCXNlbUxlZ2VuZGEgPSAnJwoJdmlzdG8gPSBGYWxzZQoJdmlzdG9hID0gRmFsc2UKCXZlcmlmaWNhclZpc3RvTG9jYWwoaVsnaWRfdmlkZW8nXSkKCQoJdHJ5OgoJCW5vbWUgPSBpWydub21lX2luZ2xlcyddLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OgoJCW5vbWUgPSBpWydub21lX2luZ2xlcyddLmVuY29kZSgndXRmLTgnKQoJaWYgJ2h0dHAnIG5vdCBpbiBpWydmb3RvJ106CgkJaVsnZm90byddID0gX19BUElfXysnaW1hZ2VzL2NhcGFzLycraVsnZm90byddLnNwbGl0KCcvJylbLTFdCgkKCWlmIGlbJ2xlZ2VuZGEnXSA9PSAic2VtbGVnZW5kYSI6CgkJc2VtTGVnZW5kYSA9ICdbQ09MT1IgcmVkXVtCXVMvIExFR0VOREEgWy9CXVsvQ09MT1JdJwoJaWYgJ0JyYXNpbGVpcm8nIGluIGNhdGVnb3JpYToKCQliciA9ICdbQl1bQ09MT1IgZ3JlZW5dQlsvQ09MT1JdW0NPTE9SIHllbGxvd11SWy9DT0xPUl06IFsvQl0nCglpZiAnUG9ydHUnIGluIGNhdGVnb3JpYToKCQlwdCA9ICdbQl1bQ09MT1IgZ3JlZW5dUFsvQ09MT1JdW0NPTE9SIHJlZF1UWy9DT0xPUl06IFsvQl0nCgljb3IgPSAid2hpdGUiCglpZiAnUFQnIGluIGlbJ0lNQkQnXToKCQlpWydJTUJEJ10gPSByZS5jb21waWxlKCcoLis/KVBUJykuZmluZGFsbChpWydJTUJEJ10pWzBdCgkJcHQgPSAnW0JdW0NPTE9SIGdyZWVuXVBbL0NPTE9SXVtDT0xPUiByZWRdVFsvQ09MT1JdOiBbL0JdJwoJCglpbWRiUiA9IGpzb24ubG9hZHMoaVsnaW1kYlJhdGluZyddKQoJCglpbmZvTGFiZWxzID0geydUaXRsZSc6IGlbJ25vbWVfaW5nbGVzJ10sICdZZWFyJzogaVsnYW5vJ10sICdHZW5yZSc6IGNhdGVnb3JpYSwgJ1Bsb3QnOmlbJ2Rlc2NyaWNhb192aWRlbyddLCAnQ2FzdCc6aVsnYXRvcmVzJ10uc3BsaXQoJywnKSwgJ1RyYWlsZXInOiBpbWRiUlsndHJhaWxlciddLCAnRGlyZWN0b3InOiBpWydkaXJldG9yJ10sICdSYXRpbmcnOiBpbWRiUlsncmFua2luZyddLCAnSU1EQk51bWJlcic6IGlbJ0lNQkQnXSB9CgoJbm9tZWVlID0gJ1tDT0xPUiAnK2NvcisnXScrcHQrYnIrc2VtTGVnZW5kYStyZW1vdmVyQWNlbnRvcyhub21lKSsnICgnK2lbJ2FubyddKycpWy9DT0xPUl0nCgl1cmxub28gPSBfX0FQSV9TSVRFX18rJ2ZpbG1lcy5waHA/YWN0aW9uPWlkJmlkRmlsbWU9JytzdHIoaVsnaWRfdmlkZW8nXSkKCWZvdG9vbyA9IGlbJ2ZvdG8nXQoJaVsnYmFja2dyb3VuZCddID0gJ2ltYWdlcy9iYWNrZ3JvdW5kLycraVsnSU1CRCddKycuanBnJwoJZmFuYXJ0dHQgPSBfX0FQSV9fK2lbJ2JhY2tncm91bmQnXQoJCglhZGRWaWRlbyhub21lZWUsIHVybG5vbywgMTEzLCBmb3Rvb28sdmlzdG8sICdwbGF5ZXInLCAwLCAwLCBpbmZvTGFiZWxzLCBmYW5hcnR0dCwgdHJhaWxlcj1pbWRiUlsndHJhaWxlciddKQoKZGVmIHNldFNlcmllcyhpLCB2aXN0b3MsIG9wY2FvLCB0aXBvKToKCWNhdGVnb3JpYSA9IGdldENhdGVnb3JpYShpWydjYXRlZ29yaWExJ10pCglpZiBpbnQoaVsnY2F0ZWdvcmlhMiddKSAhPSAwOgoJCWNhdGVnb3JpYSArPSAnLCcrZ2V0Q2F0ZWdvcmlhKGlbJ2NhdGVnb3JpYTInXSkKCWlmIGludChpWydjYXRlZ29yaWEzJ10pICE9IDA6CgkJY2F0ZWdvcmlhICs9ICcsJytnZXRDYXRlZ29yaWEoaVsnY2F0ZWdvcmlhMyddKQoJCglwdCA9ICcnCgliciA9ICcnCglzZW1MZWdlbmRhID0gJycKCSNpZiBpWydsZWdlbmRhJ10gPT0gInNlbWxlZ2VuZGEiOgoJIwlzZW1MZWdlbmRhID0gJ1tDT0xPUiByZWRdW0JdUy8gTEVHRU5EQSBbL0JdWy9DT0xPUl0nCglpZiAnQnJhc2lsZWlybycgaW4gY2F0ZWdvcmlhOgoJCWJyID0gJ1tCXVtDT0xPUiBncmVlbl1CWy9DT0xPUl1bQ09MT1IgeWVsbG93XVJbL0NPTE9SXTogWy9CXScKCWlmICdQb3J0dScgaW4gY2F0ZWdvcmlhOgoJCXB0ID0gJ1tCXVtDT0xPUiBncmVlbl1QWy9DT0xPUl1bQ09MT1IgcmVkXVRbL0NPTE9SXTogWy9CXScKCWlmICdQVCcgaW4gaVsnSU1CRCddOgoJCXB0ID0gJ1tCXVtDT0xPUiBncmVlbl1QWy9DT0xPUl1bQ09MT1IgcmVkXVRbL0NPTE9SXTogWy9CXScKCXZpc3RvID0gRmFsc2UKCXZpc3RvYSA9IEZhbHNlCgl2ZXJpZmljYXJWaXN0b0xvY2FsKGlbJ2lkX3ZpZGVvJ10pCgl0cnk6CgkJbm9tZSA9IGlbJ25vbWVfaW5nbGVzJ10uZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6CgkJbm9tZSA9IGlbJ25vbWVfaW5nbGVzJ10uZW5jb2RlKCd1dGYtOCcpCglpZiAnaHR0cCcgbm90IGluIGlbJ2ZvdG8nXToKCQlpWydmb3RvJ10gPSBfX0FQSV9fKydpbWFnZXMvY2FwYXMvJytpWydmb3RvJ10uc3BsaXQoJy8nKVstMV0KCQkjaVsnZm90byddID0gaVsnZm90byddLnJlcGxhY2UoJ1BUJywnJykKCQoJaW1kYlIgPSBqc29uLmxvYWRzKGlbJ2ltZGJSYXRpbmcnXSkKCXVybG5vbyA9IF9fQVBJX1NJVEVfXyt0aXBvKycucGhwP2FjdGlvbj1pZCZpZFNlcmllPScrc3RyKGlbJ2lkX3ZpZGVvJ10pCglpbmZvTGFiZWxzID0geydUaXRsZSc6IGlbJ25vbWVfaW5nbGVzJ10sICdZZWFyJzogaVsnYW5vJ10sICdHZW5yZSc6IGNhdGVnb3JpYSwgJ1Bsb3QnOiBpWydkZXNjcmljYW9fdmlkZW8nXSwgJ0Nhc3QnOmlbJ2F0b3JlcyddLnNwbGl0KCcsJyksICdUcmFpbGVyJzogaW1kYlJbJ3RyYWlsZXInXSwgJ0RpcmVjdG9yJzogaVsnZGlyZXRvciddLCAnUmF0aW5nJzogaW1kYlJbJ3JhbmtpbmcnXSwgJ0NvZGUnOiBpWydJTUJEJ10gfQoJCglub21lZWUgPSBwdCticitzZW1MZWdlbmRhK3JlbW92ZXJBY2VudG9zKG5vbWUpKycgKCcraVsnYW5vJ10rJyknCglmb3Rvb28gPSBpWydmb3RvJ10KCSNpWydiYWNrZ3JvdW5kJ10gPSBpWydiYWNrZ3JvdW5kJ10ucmVwbGFjZSgnUFQnLCcnKQoJaVsnYmFja2dyb3VuZCddID0gJ2ltYWdlcy9iYWNrZ3JvdW5kLycraVsnSU1CRCddKycuanBnJwoJZmFuYXJ0dHQgPSBfX0FQSV9fK2lbJ2JhY2tncm91bmQnXQoJYWRkRGlyMihub21lZWUsIHVybG5vbywgMTE0LCAndGVtcG9yYWRhcycsIGZvdG9vbywgdGlwbz0nc2VyaWUnLCBpbmZvTGFiZWxzPWluZm9MYWJlbHMscG9zdGVyPWZhbmFydHR0LHZpc3RvPXZpc3RvKQoKZGVmIGNhdGVnb3JpYXModXJsKToKCSNoZWFkZXJzWydBdXRob3JpemF0aW9uJ10gPSAnQmVhcmVyICVzJyAlIF9fQURET05fXy5nZXRTZXR0aW5nKCd0b2tlbk1ycGlyYWN5JykKCXJlc3VsdGFkbyA9IGFicmlyX3VybCh1cmwsIGhlYWRlcj1oZWFkZXJzLCBjb29raWU9Z2V0Q29va2llKCkpCgkjaWYgcmVzdWx0YWRvID09ICdETlMnOgoJIwlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdUZW0gZGUgYWx0ZXJhciBvcyBETlMgcGFyYSBwb2RlciB1c3VmcnVpciBkbyBfX0FERE9OX18uJykKCSMJcmV0dXJuIEZhbHNlCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCXZpc3RvcyA9IERhdGFiYXNlLnNlbGVjdEZpbG1lcygpCglvcGNhbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCdtYXJjYXJWaXN0bycpCglpZiAnc2VyaWUnIGluIHVybDoKCQl0aXBvID0gJ3NlcmllcycKCWVsaWYgJ2FuaW1lJyBpbiB1cmw6CgkJdGlwbyA9ICdhbmltZXMnCglmb3IgaSBpbiByZXN1bHRhZG9bImRhdGEiXToKCQlpZiAnZmlsbWUnIGluIHVybDoKCQkJc2V0RmlsbWUoaSwgdmlzdG9zLCBvcGNhbykKCQllbGlmICdzZXJpZScgaW4gdXJsIG9yICdhbmltZScgaW4gdXJsOgoJCQlzZXRTZXJpZXMoaSwgdmlzdG9zLCBvcGNhbywgdGlwbykKCWN1cnJlbnQgPSByZXN1bHRhZG9bJ21ldGEnXVsnY3VycmVudCddCgl0b3RhbCA9IHJlc3VsdGFkb1snbWV0YSddWyd0b3RhbCddCgl0cnk6IHByb3hpbW8gPSByZXN1bHRhZG9bJ21ldGEnXVsncGFnaW5hY2FvJ11bJ25leHQnXQoJZXhjZXB0OiBwYXNzIAoJaWYgaW50KGN1cnJlbnQpIDwgaW50KHRvdGFsKToKCQlhZGREaXIyKCdQcsOzeGltYSBww6FnaW5hICgnK3N0cihjdXJyZW50KSsnLycrc3RyKHRvdGFsKSsnKScsIHByb3hpbW8sIDEyMSwgJ2Fub3MnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncHJveGltby5wbmcnKSwxKQoJCgl2aXN0YV9maWxtZXNTZXJpZXMoKQoKZGVmIGdldFllYXJzKHVybCk6Cglhbm9zID0gWwoJCQknMjAxOScsCgkJCScyMDE4JywKCQkJJzIwMTcnLAoJCQknMjAxNicsCgkJCScyMDE1JywKCQkJJzIwMTQnLAoJCQknMjAxMycsCgkJCScyMDEyJywKCQkJJzIwMTEnLAoJCQknMjAxMCcsCgkJCScyMDA5JywKCQkJJzIwMDgnLAoJCQknMjAwNycsCgkJCScyMDA2JywKCQkJJzIwMDAtMjAwNScsCgkJCScxOTkwLTE5OTknLAoJCQknMTk4MC0xOTg5JywKCQkJJzE5NzAtMTk3OScsCgkJCScxOTYwLTE5NjknLAoJCQknMTk1MC0xOTU5JywKCQkJJzE5MDAtMTk0OScKCQldCglpZiAnZmlsbWVzJyBpbiB1cmw6CgkJdGlwbyA9IDAKCQlxdWFsaWRhZGUgPSAnJnF1YWxpZGFkZT0nK19fUXVhbGlkYWRlX18KCWVsaWYgJ3NlcmllcycgaW4gdXJsOgoJCXRpcG8gPSAxCgkJcXVhbGlkYWRlID0gJycKCWVsaWYgJ2FuaW1lcycgaW4gdXJsOgoJCXRpcG8gPSAyCgkJcXVhbGlkYWRlID0gJycKCWZvciBpIGluIGFub3M6CgkJdXJsbm92byA9IHVybCsnJmFubz0nK2krcXVhbGlkYWRlOwoJCWFkZERpcjIoaSwgdXJsbm92bywgMTIxLCAnYW5vcycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdhbm8ucG5nJykpCgkJCgl2aXN0YV9tZW51KCkKCmRlZiBhbm9zKHVybCk6CgkjaGVhZGVyc1snQXV0aG9yaXphdGlvbiddID0gJ0JlYXJlciAlcycgJSBfX0FERE9OX18uZ2V0U2V0dGluZygndG9rZW5NcnBpcmFjeScpCglyZXN1bHRhZG8gPSBhYnJpcl91cmwodXJsLCBoZWFkZXI9aGVhZGVycywgY29va2llPWdldENvb2tpZSgpKQoJaWYgcmVzdWx0YWRvID09ICdETlMnOgoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1RlbSBkZSBhbHRlcmFyIG9zIEROUyBwYXJhIHBvZGVyIHVzdWZydWlyIGRvIF9fQURET05fXy4nKQoJCXJldHVybiBGYWxzZQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pCgl2aXN0b3MgPSBEYXRhYmFzZS5zZWxlY3RGaWxtZXMoKQoJb3BjYW8gPSBfX0FERE9OX18uZ2V0U2V0dGluZygnbWFyY2FyVmlzdG8nKQoJaWYgJ3NlcmllJyBpbiB1cmw6CgkJdGlwbyA9ICdzZXJpZXMnCgllbGlmICdhbmltZScgaW4gdXJsOgoJCXRpcG8gPSAnYW5pbWVzJwoJZm9yIGkgaW4gcmVzdWx0YWRvWyJkYXRhIl06CgkJaWYgJ2ZpbG1lJyBpbiB1cmw6CgkJCXNldEZpbG1lKGksIHZpc3Rvcywgb3BjYW8pCgkJZWxpZiAnc2VyaWUnIGluIHVybCBvciAnYW5pbWUnIGluIHVybDoKCQkJc2V0U2VyaWVzKGksIHZpc3Rvcywgb3BjYW8sIHRpcG8pCgkKCXRyeTogCgkJY3VycmVudCA9IHJlc3VsdGFkb1snbWV0YSddWydjdXJyZW50J10KCWV4Y2VwdDogCgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnQWd1YXJkZSBwZWxhIHByw7N4aW1hIGF0dWFsaXphw6fDo28uIE91IHRlbnRlIG1haXMgdGFyZGUuJykKCQlyZXR1cm4gRmFsc2UKCWN1cnJlbnQgPSByZXN1bHRhZG9bJ21ldGEnXVsnY3VycmVudCddCgl0b3RhbCA9IHJlc3VsdGFkb1snbWV0YSddWyd0b3RhbCddCgl0cnk6IHByb3hpbW8gPSByZXN1bHRhZG9bJ21ldGEnXVsncGFnaW5hY2FvJ11bJ25leHQnXQoJZXhjZXB0OiBwYXNzIAoJaWYgaW50KGN1cnJlbnQpIDwgaW50KHRvdGFsKToKCQlhZGREaXIyKCdQcsOzeGltYSBww6FnaW5hICgnK3N0cihjdXJyZW50KSsnLycrc3RyKHRvdGFsKSsnKScsIHByb3hpbW8sIDEyMSwgJ2Fub3MnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncHJveGltby5wbmcnKSwxKQoJCgl2aXN0YV9maWxtZXNTZXJpZXMoKQoKZGVmIGdldEV2ZW50b3MoKToKCSNoZWFkZXJzWydBdXRob3JpemF0aW9uJ10gPSAnQmVhcmVyICVzJyAlIF9fQURET05fXy5nZXRTZXR0aW5nKCd0b2tlbk1ycGlyYWN5JykKCXJlc3VsdGFkbyA9IGFicmlyX3VybChfX0FQSV9TSVRFX18rJ2V2ZW50b3MnLCBoZWFkZXI9aGVhZGVycywgY29va2llPWdldENvb2tpZSgpKQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pCgl0cnk6CgkJaWYgcmVzdWx0YWRvWydjb2RpZ28nXSA9PSAyMDQ6CgkJCXJldHVybiBGYWxzZQoJZXhjZXB0OgoJCXBhc3MKCXJldHVybiByZXN1bHRhZG9bJ2RhdGEnXVsnbm9tZSddCgkJCgkJCmRlZiBwbGF5ZXIobmFtZSx1cmwsaWNvbmltYWdlLHRlbXBvcmFkYSxlcGlzb2RpbyxzZXJpZU5vbWUpOgoJI2hlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICdCZWFyZXIgJXMnICUgX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuTXJwaXJhY3knKQoJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCwgaGVhZGVyPWhlYWRlcnMsIGNvb2tpZT1nZXRDb29raWUoKSkKCWlmIHJlc3VsdGFkbyA9PSAnRE5TJzoKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdUZW0gZGUgYWx0ZXJhciBvcyBETlMgcGFyYSBwb2RlciB1c3VmcnVpciBkbyBfX0FERE9OX18uJykKCQlyZXR1cm4gRmFsc2UKCQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pWzBdCgkjcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pCglpbmZvbGFiZWxzID0gZGljdCgpCgljb2lzbyA9ICcnCglwYXN0YURhdGEgPSAnJwoJdGlwbyA9ICcnCglpZFZpZGVvID0gJycKCWlmICdmaWxtZScgaW4gdXJsOgoJCXRpcG8gPSAnZmlsbWUnCgkJaW5mb2xhYmVsc1snQ29kZSddID0gcmVzdWx0YWRvWydJTUJEJ10KCQlpbmZvbGFiZWxzWydZZWFyJ10gPSByZXN1bHRhZG9bJ2FubyddCgkJaWRWaWRlbyA9IHJlc3VsdGFkb1snaWRfdmlkZW8nXQoJCW5vbWUgPSByZXN1bHRhZG9bJ25vbWVfaW5nbGVzJ10KCQl0ZW1wb3JhZGEgPSAwCgkJZXBpc29kaW8gPSAwCgkJY29pc28gPSAnZmlsbWUnCgllbHNlOgoJCWlmICdzZXJpZScgaW4gdXJsOgoJCQl0aXBvID0gJ3NlcmllJwoJCWVsc2U6CgkJCXRpcG8gPSAnYW5pbWUnCgkJaWRWaWRlbyA9IHJlc3VsdGFkb1snaWRfc2VyaWUnXQoJCW5vbWUgPSByZXN1bHRhZG9bJ25vbWVfZXBpc29kaW8nXQoJCXRlbXBvcmFkYSA9IHJlc3VsdGFkb1sndGVtcG9yYWRhJ10KCQllcGlzb2RpbyA9IHJlc3VsdGFkb1snZXBpc29kaW8nXQoJCWNvaXNvID0gJ291dHJvJwoKCW1lbnNhZ2VtcHJvZ3Jlc3NvID0geGJtY2d1aS5EaWFsb2dQcm9ncmVzcygpCgltZW5zYWdlbXByb2dyZXNzby5jcmVhdGUoQWRkb25UaXRsZSwgdSdBYnJpciBlbWlzc8OjbycsJ1BvciBmYXZvciBhZ3VhcmRlLi4uJykKCW1lbnNhZ2VtcHJvZ3Jlc3NvLnVwZGF0ZSgyNSwgIiIsIHUnT2J0ZXIgdmlkZW8gZSBsZWdlbmRhJywgIiIpCgoJc3RyZWFtLCBsZWdlbmRhLCBleHRfZyA9IGdldFN0cmVhbUxlZ2VuZGEoaWRWaWRlbywgdGlwbywgY29pc289Y29pc28pCglpZiBzdHJlYW0gPT0gRmFsc2UgYW5kIGxlZ2VuZGEgPT0gMjA0OgoJCW1lbnNhZ2VtcHJvZ3Jlc3NvLmNsb3NlKCkKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdUZW0gZGUgZXNwZXJhciA4IGhvcmFzIGF0w6kgY29uc2VndWlyIHZpc3VhbGl6YXIgYWxndW0gdmlkZW8uJykKCQlyZXR1cm4gRmFsc2UKCQoJbWVuc2FnZW1wcm9ncmVzc28udXBkYXRlKDUwLCAiIiwgdSdQcmVwYXJhLXRlLCB2YWkgY29tZcOnYXIhJywgIiIpCglwbGF5bGlzdCA9IHhibWMuUGxheUxpc3QoMSkKCXBsYXlsaXN0LmNsZWFyKCkKCWxpc3RpdGVtID0geGJtY2d1aS5MaXN0SXRlbShuYW1lLCBpY29uSW1hZ2U9IkRlZmF1bHRWaWRlby5wbmciLCB0aHVtYm5haWxJbWFnZT1pY29uaW1hZ2UpCgoJbGlzdGl0ZW0uc2V0SW5mbyh0eXBlPSJWaWRlbyIsIGluZm9MYWJlbHM9aW5mb2xhYmVscykKCWxpc3RpdGVtLnNldFByb3BlcnR5KCdtaW1ldHlwZScsICd2aWRlby94LW1zdmlkZW8nKQoJbGlzdGl0ZW0uc2V0UHJvcGVydHkoJ0lzUGxheWFibGUnLCAndHJ1ZScpCgkKCWxpc3RpdGVtLnNldFBhdGgocGF0aD1zdHJlYW0pCglwbGF5bGlzdC5hZGQoc3RyZWFtLCBsaXN0aXRlbSkKCXhibWNwbHVnaW4uc2V0UmVzb2x2ZWRVcmwoaW50KHN5cy5hcmd2WzFdKSwgVHJ1ZSwgbGlzdGl0ZW0pCgltZW5zYWdlbXByb2dyZXNzby51cGRhdGUoNzUsICIiLCB1J0JvYSBTZXNzw6NvISEhJywgIiIpCgoJaWYgc3RyZWFtID09IEZhbHNlOgoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ08gc2Vydmlkb3IgZXNjb2xoaWRvIG7Do28gZGlzcG9uw612ZWwsIGVzY29saGEgb3V0cm8gb3UgdGVudGUgbm92YW1lbnRlIG1haXMgdGFyZGUuJykKCWVsc2U6CgkJI19fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1N0cmVhbTogJytzdHJlYW0pCgkJcGxheWVyX21yID0gUGxheWVyLlBsYXllcih1cmw9dXJsLCBpZEZpbG1lPWlkVmlkZW8sIHBhc3RhRGF0YT1fX1BBU1RBX0RBRE9TX18sIHRlbXBvcmFkYT10ZW1wb3JhZGEsIGVwaXNvZGlvPWVwaXNvZGlvLCBub21lPW5hbWUsIGxvZ289b3MucGF0aC5qb2luKF9fQURET05fRk9MREVSX18sJ2ljb24ucG5nJykpCgkJCgkJbWVuc2FnZW1wcm9ncmVzc28uY2xvc2UoKQoJCXBsYXllcl9tci5wbGF5KHBsYXlsaXN0KQoJCXBsYXllcl9tci5zZXRTdWJ0aXRsZXMobGVnZW5kYSkKCgkJd2hpbGUgcGxheWVyX21yLnBsYXlpbmc6CgkJCXhibWMuc2xlZXAoNTAwMCkKCQkJI3BsYXllcl9tci50cmFja2VyVGVtcG8oKQoKZGVmIG1hcmNhclZpc3RvKHVybCk6CglyZXN1bHRhZG8gPSBhYnJpcl91cmwodXJsLCBoZWFkZXI9aGVhZGVycywgY29va2llPWdldENvb2tpZSgpKQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pWzBdCglsaW5rcyA9IHVybC5zcGxpdCgnLycpCglvcGNhbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCdtYXJjYXJWaXN0bycpCglpZiAnZmlsbWUnIGluIHVybDoKCQlpZF92aWRlbyA9IHJlc3VsdGFkb1snaWRfdmlkZW8nXQoJCWltZGIgPSByZXN1bHRhZG9bJ0lNQkQnXQoJCXBvc3QgPSB7J2lkX2ZpbG1lJzogaWRfdmlkZW99CgkJdGlwbyA9IDAKCWVsaWYgJ3NlcmllJyBpbiB1cmw6CgkJaW1kYiAgPSByZXN1bHRhZG9bJ2ZvdG9TZXJpZSddLnNwbGl0KCcvJylbLTFdLnNwbGl0KCcuJylbMF0KCQlpZF92aWRlbyA9IHJlc3VsdGFkb1snaWRfc2VyaWUnXQoJCXRlbXBvcmFkYSA9IHJlc3VsdGFkb1sndGVtcG9yYWRhJ10KCQllcGlzb2RpbyA9IHJlc3VsdGFkb1snZXBpc29kaW8nXQoJCXBvc3QgPSB7J2lkX3NlcmllJzogaWRfdmlkZW8sICd0ZW1wb3JhZGEnOiB0ZW1wb3JhZGEsICdlcGlzb2Rpbyc6ZXBpc29kaW99CgkJdGlwbyA9IDEKCWVsaWYgJ2FuaW1lJyBpbiB1cmw6CgkJaW1kYiAgPSByZXN1bHRhZG9bJ2ZvdG9TZXJpZSddLnNwbGl0KCcvJylbLTFdLnNwbGl0KCcuJylbMF0KCQlpZF92aWRlbyA9IHJlc3VsdGFkb1snaWRfc2VyaWUnXQoJCXRlbXBvcmFkYSA9IHJlc3VsdGFkb1sndGVtcG9yYWRhJ10KCQllcGlzb2RpbyA9IHJlc3VsdGFkb1snZXBpc29kaW8nXQoJCXBvc3QgPSB7J2lkX2FuaW1lJzogaWRfdmlkZW8sICd0ZW1wb3JhZGEnOiB0ZW1wb3JhZGEsICdlcGlzb2Rpbyc6ZXBpc29kaW99CgkJdGlwbyA9IDIKCXBhc3RhVmlzdG89b3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywndmlzdG9zJykKCXRyeToKCQlvcy5tYWtlZGlycyhwYXN0YVZpc3RvKQoJZXhjZXB0OgoJCXBhc3MKCWlmIHRpcG8gPT0gMSBvciB0aXBvID09IDI6CgkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4ocGFzdGFWaXN0bywgc3RyKGlkX3ZpZGVvKSsnX1MnK3N0cih0ZW1wb3JhZGEpKyd4JytzdHIoZXBpc29kaW8pKycubGl2ZWl0JykKCWVsaWYgdGlwbyA9PSAwOgoJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKHBhc3RhVmlzdG8sIHN0cihpZF92aWRlbykrJy5saXZlaXQnKQoJaWYgbm90IG9zLnBhdGguZXhpc3RzKGZpY2hlaXJvKToKCQlmID0gb3BlbihmaWNoZWlybywgJ3cnKQoJCWYud3JpdGUoJycpCgkJZi5jbG9zZSgpCgllc2NyZXZlcl9maWNoZWlybyhvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCd2aXN0b3NfZmlsbWVzLmxpdmVpdCcpLCB2aXN0b3NfZmlsbWVzKQoJeGJtYy5leGVjdXRlYnVpbHRpbigiWEJNQy5Ob3RpZmljYXRpb24oIitBZGRvblRpdGxlKyIsIisiTWFyY2FkbyBjb21vIHZpc3RvIisiLCIrIjYwMDEiKyIsIisgb3MucGF0aC5qb2luKGNvbnRyb2xvLmFkZG9uRm9sZGVyLCdpY29uLnBuZycpKyIpIikKCXhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5SZWZyZXNoIikKCmRlZiBtYXJjYXJOYW9WaXN0byh1cmwpOgoJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCwgaGVhZGVyPWhlYWRlcnMsIGNvb2tpZT1nZXRDb29raWUoKSkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKVswXQoJbGlua3MgPSB1cmwuc3BsaXQoJy8nKQoJb3BjYW8gPSBfX0FERE9OX18uZ2V0U2V0dGluZygnbWFyY2FyVmlzdG8nKQoJaWYgJ2ZpbG1lJyBpbiB1cmw6CgkJaWRfdmlkZW8gPSByZXN1bHRhZG9bJ2lkX3ZpZGVvJ10KCQlpbWRiID0gcmVzdWx0YWRvWydJTUJEJ10KCQlwb3N0ID0geydpZF9maWxtZSc6IGlkX3ZpZGVvfQoJCXRpcG8gPSAwCgllbGlmICdzZXJpZScgaW4gdXJsOgoJCWltZGIgID0gcmVzdWx0YWRvWydmb3RvU2VyaWUnXS5zcGxpdCgnLycpWy0xXS5zcGxpdCgnLicpWzBdCgkJaWRfdmlkZW8gPSByZXN1bHRhZG9bJ2lkX3NlcmllJ10KCQl0ZW1wb3JhZGEgPSByZXN1bHRhZG9bJ3RlbXBvcmFkYSddCgkJZXBpc29kaW8gPSByZXN1bHRhZG9bJ2VwaXNvZGlvJ10KCQlwb3N0ID0geydpZF9zZXJpZSc6IGlkX3ZpZGVvLCAndGVtcG9yYWRhJzogdGVtcG9yYWRhLCAnZXBpc29kaW8nOmVwaXNvZGlvfQoJCXRpcG8gPSAxCgllbGlmICdhbmltZScgaW4gdXJsOgoJCWltZGIgID0gcmVzdWx0YWRvWydmb3RvU2VyaWUnXS5zcGxpdCgnLycpWy0xXS5zcGxpdCgnLicpWzBdCgkJaWRfdmlkZW8gPSByZXN1bHRhZG9bJ2lkX3NlcmllJ10KCQl0ZW1wb3JhZGEgPSByZXN1bHRhZG9bJ3RlbXBvcmFkYSddCgkJZXBpc29kaW8gPSByZXN1bHRhZG9bJ2VwaXNvZGlvJ10KCQlwb3N0ID0geydpZF9hbmltZSc6IGlkX3ZpZGVvLCAndGVtcG9yYWRhJzogdGVtcG9yYWRhLCAnZXBpc29kaW8nOmVwaXNvZGlvfQoJCXRpcG8gPSAyCgkKCXBhc3RhVmlzdG89b3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywndmlzdG9zJykKCXRyeToKCQlvcy5tYWtlZGlycyhwYXN0YVZpc3RvKQoJZXhjZXB0OgoJCXBhc3MKCglpZiB0aXBvID09IDEgb3IgdGlwbyA9PSAyOgoJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKHBhc3RhVmlzdG8sIHN0cihpZF92aWRlbykrJ19TJytzdHIodGVtcG9yYWRhKSsneCcrc3RyKGVwaXNvZGlvKSsnLm1ycGlyYWN5JykKCWVsaWYgdGlwbyA9PSAwOgoJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKHBhc3RhVmlzdG8sIHN0cihpZF92aWRlbykrJy5tcnBpcmFjeScpCgoJaWYgb3MucGF0aC5leGlzdHMoZmljaGVpcm8pOgoJCW9zLnJlbW92ZShmaWNoZWlybykKCWVzY3JldmVyX2ZpY2hlaXJvKG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ3Zpc3Rvc19maWxtZXMubGl2ZWl0JyksIHZpc3RvcykKCXhibWMuZXhlY3V0ZWJ1aWx0aW4oIlhCTUMuTm90aWZpY2F0aW9uKCIrQWRkb25UaXRsZSsiLCIrIk1hcmNhZG8gY29tbyB2aXN0byIrIiwiKyI2MDAxIisiLCIrIG9zLnBhdGguam9pbihjb250cm9sby5hZGRvbkZvbGRlciwnaWNvbi5wbmcnKSsiKSIpCgl4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuUmVmcmVzaCIpCgpkZWYgZ2V0U3RyZWFtTGVnZW5kYShpZCwgdGlwbywgY29pc289Tm9uZSk6CglpZiB0aXBvID09ICdmaWxtZSc6CgkJdXJsID0gX19BUElfU0lURV9fK3RpcG8rJ3MucGhwP2FjdGlvbj1saW5rcyZpZEZpbG1lPScraWQKCWlmIHRpcG8gPT0gJ3NlcmllJzoKCQl1cmwgPSBfX0FQSV9TSVRFX18rdGlwbysncy5waHA/YWN0aW9uPWxpbmtzJmlkRXBpc29kaW89JytpZAoJaWYgdGlwbyA9PSAnYW5pbWUnOgoJCXVybCA9IF9fQVBJX1NJVEVfXyt0aXBvKydzLnBocD9hY3Rpb249bGlua3MmaWRFcGlzb2Rpbz0nK2lkCgoJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCwgaGVhZGVyPWhlYWRlcnMsIGNvb2tpZT1nZXRDb29raWUoKSkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJdHJ5OgoJCWlmIHJlc3VsdGFkb1snY29kaWdvJ10gPT0gMjA0OgoJCQlyZXR1cm4gRmFsc2UsIDIwNCwgMjA0CglleGNlcHQ6IAoJCXJlc3VsdGFkbyA9IHJlc3VsdGFkb1swXQoJCglpID0gMAoJc2Vydmlkb3JlcyA9IFtdCgl0aXR1bG9zID0gW10KCW5vbWUgPSAnJwoJCglpZiByZXN1bHRhZG9bJ1VSTCddICE9ICcnOgoJCWkrPTEKCQlpZiAnb3BlbmxvYWQnIGluIHJlc3VsdGFkb1snVVJMJ106CgkJCW5vbWUgPSAiT3BlbkxvYWQiCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMJ10pCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICd2aWR6aScgaW4gcmVzdWx0YWRvWydVUkwnXToKCQkJbm9tZSA9ICdWaWR6aScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwnXSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ2dvb2dsZScgaW4gcmVzdWx0YWRvWydVUkwnXSBvciAnY2xvdWQubWFpbC5ydScgaW4gcmVzdWx0YWRvWydVUkwnXToKCQkJbm9tZSA9IEFkZG9uVGl0bGUKCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwnXSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3VwdG9zdHJlYW0uY29tJyBpbiByZXN1bHRhZG9bJ1VSTCddOgoJCQlub21lID0gJ1VwVG9TdHJlYW0nCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMJ10pCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICdyYXBpZHZpZGVvLmNvbScgaW4gcmVzdWx0YWRvWydVUkwnXSBvciAncmFwdHUnIGluIHJlc3VsdGFkb1snVVJMJ106CgkJCW5vbWUgPSAnUmFwdHUnCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMJ10pCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICd2aWRvemEubmV0JyBpbiByZXN1bHRhZG9bJ1VSTCddOgoJCQlub21lID0gJ1ZpZG96YScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwnXSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3N0cmVhbWFuZ28uJyBpbiByZXN1bHRhZG9bJ1VSTCddOgoJCQlub21lID0gJ1N0cmVhbWFuZ28nCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMJ10pCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCWlmIHJlc3VsdGFkb1snVVJMMiddICE9ICcnOgoJCWkrPTEKCQlpZiAnb3BlbmxvYWQnIGluIHJlc3VsdGFkb1snVVJMMiddOgoJCQlub21lID0gIk9wZW5Mb2FkIgoJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDInXSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3ZpZHppJyBpbiByZXN1bHRhZG9bJ1VSTDInXToKCQkJbm9tZSA9ICdWaWR6aScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwyJ10pCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICdnb29nbGUnIGluIHJlc3VsdGFkb1snVVJMMiddIG9yICdjbG91ZC5tYWlsLnJ1JyBpbiByZXN1bHRhZG9bJ1VSTDInXToKCQkJbm9tZSA9IEFkZG9uVGl0bGUKCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwyJ10pCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICd1cHRvc3RyZWFtLmNvbScgaW4gcmVzdWx0YWRvWydVUkwyJ106CgkJCW5vbWUgPSAnVXBUb1N0cmVhbScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwyJ10pCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICdyYXBpZHZpZGVvLmNvbScgaW4gcmVzdWx0YWRvWydVUkwyJ10gb3IgJ3JhcHR1JyBpbiByZXN1bHRhZG9bJ1VSTDInXToKCQkJbm9tZSA9ICdSYXB0dScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwyJ10pCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICd2aWRvemEubmV0JyBpbiByZXN1bHRhZG9bJ1VSTDInXToKCQkJbm9tZSA9ICdWaWRvemEnCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMMiddKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAnc3RyZWFtYW5nby4nIGluIHJlc3VsdGFkb1snVVJMMiddOgoJCQlub21lID0gJ1N0cmVhbWFuZ28nCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMMiddKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgl0cnk6CgkJaWYgcmVzdWx0YWRvWydVUkwzJ10gIT0gJyc6CgkJCWkrPTEKCQkJaWYgJ29wZW5sb2FkJyBpbiByZXN1bHRhZG9bJ1VSTDMnXToKCQkJCW5vbWUgPSAiT3BlbkxvYWQiCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDMnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndmlkemknIGluIHJlc3VsdGFkb1snVVJMMyddOgoJCQkJbm9tZSA9ICdWaWR6aScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMMyddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdnb29nbGUnIGluIHJlc3VsdGFkb1snVVJMMyddIG9yICdjbG91ZC5tYWlsLnJ1JyBpbiByZXN1bHRhZG9bJ1VSTDMnXToKCQkJCW5vbWUgPSBBZGRvblRpdGxlCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDMnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndXB0b3N0cmVhbS5jb20nIGluIHJlc3VsdGFkb1snVVJMMyddOgoJCQkJbm9tZSA9ICdVcFRvU3RyZWFtJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwzJ10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3JhcGlkdmlkZW8uY29tJyBpbiByZXN1bHRhZG9bJ1VSTDMnXSBvciAncmFwdHUnIGluIHJlc3VsdGFkb1snVVJMMyddOgoJCQkJbm9tZSA9ICdSYXB0dScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMMyddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd2aWRvemEubmV0JyBpbiByZXN1bHRhZG9bJ1VSTDMnXToKCQkJCW5vbWUgPSAnVmlkb3phJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwzJ10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3N0cmVhbWFuZ28uJyBpbiByZXN1bHRhZG9bJ1VSTDMnXToKCQkJCW5vbWUgPSAnU3RyZWFtYW5nbycKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMMyddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJZXhjZXB0OgoJCXBhc3MKCXRyeToKCQlpZiByZXN1bHRhZG9bJ1VSTDQnXSAhPSAnJzoKCQkJaSs9MQoJCQlpZiAnb3BlbmxvYWQnIGluIHJlc3VsdGFkb1snVVJMNCddOgoJCQkJbm9tZSA9ICJPcGVuTG9hZCIKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMNCddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd2aWR6aScgaW4gcmVzdWx0YWRvWydVUkw0J106CgkJCQlub21lID0gJ1ZpZHppJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkw0J10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ2dvb2dsZScgaW4gcmVzdWx0YWRvWydVUkw0J10gb3IgJ2Nsb3VkLm1haWwucnUnIGluIHJlc3VsdGFkb1snVVJMNCddOgoJCQkJbm9tZSA9IEFkZG9uVGl0bGUKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMNCddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd1cHRvc3RyZWFtLmNvbScgaW4gcmVzdWx0YWRvWydVUkw0J106CgkJCQlub21lID0gJ1VwVG9TdHJlYW0nCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDQnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAncmFwaWR2aWRlby5jb20nIGluIHJlc3VsdGFkb1snVVJMNCddIG9yICdyYXB0dScgaW4gcmVzdWx0YWRvWydVUkw0J106CgkJCQlub21lID0gJ1JhcHR1JwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkw0J10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3ZpZG96YS5uZXQnIGluIHJlc3VsdGFkb1snVVJMNCddOgoJCQkJbm9tZSA9ICdWaWRvemEnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDQnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAnc3RyZWFtYW5nby4nIGluIHJlc3VsdGFkb1snVVJMNCddOgoJCQkJbm9tZSA9ICdTdHJlYW1hbmdvJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkw0J10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCglleGNlcHQ6CgkJcGFzcwoJbGVnZW5kYSA9ICcnCglzdHJlYW0gPSAnJwoJaWYgJzovLycgaW4gcmVzdWx0YWRvWydsZWdlbmRhJ10gb3IgcmVzdWx0YWRvWydsZWdlbmRhJ10gPT0gJyc6CgkJbGVnZW5kYSA9IF9fQVBJX18rJ3N1YnMvJXMuc3J0JyAlIHJlc3VsdGFkb1snSU1CRCddCgllbGlmIHJlc3VsdGFkb1snbGVnZW5kYSddICE9ICcnOgoJCWlmIG5vdCAnLnNydCcgaW4gcmVzdWx0YWRvWydsZWdlbmRhJ106CgkJCXJlc3VsdGFkb1snbGVnZW5kYSddID0gcmVzdWx0YWRvWydsZWdlbmRhJ10rJy5zcnQnCgkJbGVnZW5kYSA9IF9fQVBJX18rJ3N1YnMvJXMnICUgcmVzdWx0YWRvWydsZWdlbmRhJ10KCXRyeToKCQlpZiByZXN1bHRhZG9bJ3NlbWxlZ2VuZGEnXSA9PSAxOgoJCQlsZWdlbmRhID0gJycKCWV4Y2VwdDoKCQlwYXNzCglleHRfZyA9ICdjb2lzbycKCWxlZ2VuZGFBdXggPSBsZWdlbmRhCglzZXJ2aWRvciA9IDAKCWlmIGxlbih0aXR1bG9zKSA+IDE6CgkJc2Vydmlkb3IgPSB4Ym1jZ3VpLkRpYWxvZygpLnNlbGVjdCgnRXNjb2xoYSBvIHNlcnZpZG9yJywgdGl0dWxvcykKCWVsc2U6CgkJc2Vydmlkb3IgPSAwCgkKCWlmICd2aWR6aScgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJCXZpZHppID0gVVJMUmVzb2x2ZXJNZWRpYS5WaWR6aShzZXJ2aWRvcmVzW3NlcnZpZG9yXSkKCQkJc3RyZWFtID0gdmlkemkuZ2V0TWVkaWFVcmwoKQoJCQlsZWdlbmRhID0gdmlkemkuZ2V0U3VidGl0bGUoKQoJZWxpZiAndXB0b3N0cmVhbS5jb20nIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXN0cmVhbSA9IFVSTFJlc29sdmVyTWVkaWEuVXBUb1N0cmVhbShzZXJ2aWRvcmVzW3NlcnZpZG9yXSkuZ2V0TWVkaWFVcmwoKQoJZWxpZiAnc2VydmVyLm1ycGlyYWN5LndpbicgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJc3RyZWFtID0gc2Vydmlkb3Jlc1tzZXJ2aWRvcl0KCWVsaWYgJ29wZW5sb2FkJyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQlzdHJlYW0gPSBVUkxSZXNvbHZlck1lZGlhLk9wZW5Mb2FkKHNlcnZpZG9yZXNbc2Vydmlkb3JdKS5nZXRNZWRpYVVybCgpCgkJbGVnZW5kYSA9IFVSTFJlc29sdmVyTWVkaWEuT3BlbkxvYWQoc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pLmdldFN1YnRpdGxlKCkKCQlpZiBub3QgJy52dHQnIGluIGxlZ2VuZGEgb3IgbGVnZW5kYSA9PSAnJzoKCQkJbGVnZW5kYSA9IGxlZ2VuZGFBdXgKCWVsaWYgJ2RyaXZlLmdvb2dsZS5jb20vJyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQlzdHJlYW0sIGV4dF9nID0gVVJMUmVzb2x2ZXJNZWRpYS5Hb29nbGVWaWRlbyhzZXJ2aWRvcmVzW3NlcnZpZG9yXSkuZ2V0TWVkaWFVcmwoKQoJZWxpZiAnY2xvdWQubWFpbC5ydScgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJc3RyZWFtLCBleHRfZyA9IFVSTFJlc29sdmVyTWVkaWEuQ2xvdWRNYWlsUnUoc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pLmdldE1lZGlhVXJsKCkKCWVsaWYgJ3JhcGlkdmlkZW8uY29tJyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXSBvciAncmFwdHUnIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXJhcGlkID0gVVJMUmVzb2x2ZXJNZWRpYS5SYXBpZFZpZGVvKHNlcnZpZG9yZXNbc2Vydmlkb3JdKQoJCXN0cmVhbSA9IHJhcGlkLmdldE1lZGlhVXJsKCkKCQlsZWdlbmRhID0gcmFwaWQuZ2V0TGVnZW5kYSgpCgllbGlmICd2aWRvemEubmV0JyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQl2aWRveiA9IFVSTFJlc29sdmVyTWVkaWEuVmlkb3phKHNlcnZpZG9yZXNbc2Vydmlkb3JdKQoJCXN0cmVhbSA9IHZpZG96LmdldE1lZGlhVXJsKCkKCQlsZWdlbmRhID0gdmlkb3ouZ2V0TGVnZW5kYSgpCgllbGlmICdzdHJlYW1hbmdvLicgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJc3RyZWFtYW4gPSBVUkxSZXNvbHZlck1lZGlhLlN0cmVhbWFuZ28oc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pCgkJc3RyZWFtID0gc3RyZWFtYW4uZ2V0TWVkaWFVcmwoKQoJCWxlZ2VuZGEgPSBzdHJlYW1hbi5nZXRMZWdlbmRhKCkKCQoJaWYgY29pc28gPT0gJ2ZpbG1lJzoKCQlsZWdlbmRhID0gbGVnZW5kYUF1eAoJCWlmIHJlc3VsdGFkb1snSU1CRCddIG5vdCBpbiBsZWdlbmRhOgoJCQlsZWdlbmRhID0gX19BUElfXysnc3Vicy8lcy5zcnQnICUgcmVzdWx0YWRvWydJTUJEJ10KCQoJaWYgbGVnZW5kYSA9PSAnJzoKCQlsZWdlbmRhID0gbGVnZW5kYUF1eAoJcmV0dXJuIHN0cmVhbSwgbGVnZW5kYSwgZXh0X2cKCgpkZWYgcGVzcXVpc2FNb3YodXJsKToKCWNvZGlnb19mb250ZSA9ICcnCglkYWRvcyA9ICcnCgl0YWJlbGEgPSAnJwoJc3RyUGVzcXVpc2EgPSAnJwoJZmljaGVpcm8gPSAnJwoJc2l0ZSA9ICcnCglxdWFsaWRhZGUgPSAnJwoJaWYgJ2ZpbG1lcycgaW4gdXJsOgoJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnZmlsbWVzX3Blc3F1aXNhLmxpdmVpdCcpCgkJdGlwbyA9IDAKCQlxdWFsaWRhZGUgPSBfX1F1YWxpZGFkZV9fCgllbGlmICdzZXJpZXMnIGluIHVybDoKCQlmaWNoZWlybyA9IG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ3Nlcmllc19wZXNxdWlzYS5saXZlaXQnKQoJCXRpcG8gPSAxCgkJc2l0ZSA9ICdzZXJpZXMnCgkJcXVhbGlkYWRlID0gJzInCgllbGlmICdhbmltZXMnIGluIHVybDoKCQlmaWNoZWlybyA9IG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ2FuaW1lc19wZXNxdWlzYS5saXZlaXQnKQoJCXRpcG8gPSAyCgkJc2l0ZSA9ICdhbmltZXMnCgkJcXVhbGlkYWRlID0gJzInCglpZiAncGFnZScgbm90IGluIHVybDoKCQl0cnk6CgkJCXRpcG8gPSB4Ym1jZ3VpLkRpYWxvZygpLnNlbGVjdCh1J09uZGUgcXVlciBwZXNxdWlzYXI/JywgWydGaWxtZXMnLCAnU2VyaWVzJywgJ0FuaW1lcyddKQoJCWV4Y2VwdDoKCQkJcmV0dXJuIEZhbHNlCgkJdGVjbGFkbyA9IHhibWMuS2V5Ym9hcmQoJycsICdPIHF1ZSBxdWVyIHBlc3F1aXNhcj8nKQoJCWlmIHRpcG8gPT0gMDoKCQkJdXJsID0gX19BUElfU0lURV9fKydmaWxtZXMucGhwP2FjdGlvbj1wZXNxdWlzYScKCQkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdmaWxtZXNfcGVzcXVpc2EubGl2ZWl0JykKCQkJcXVhbGlkYWRlID0gX19RdWFsaWRhZGVfXwoJCWVsaWYgdGlwbyA9PSAxOgoJCQl1cmwgPSBfX0FQSV9TSVRFX18rJ3Nlcmllcy5waHA/YWN0aW9uPXBlc3F1aXNhJwoJCQlmaWNoZWlybyA9IG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ3Nlcmllc19wZXNxdWlzYS5saXZlaXQnKQoJCQlxdWFsaWRhZGUgPSAnMicKCQkJc2l0ZSA9ICdzZXJpZXMnCgkJZWxpZiB0aXBvID09IDI6CgkJCXVybCA9IF9fQVBJX1NJVEVfXysnYW5pbWVzLnBocD9hY3Rpb249cGVzcXVpc2EnCgkJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnYW5pbWVzX3Blc3F1aXNhLmxpdmVpdCcpCgkJCXF1YWxpZGFkZSA9ICcyJwoJCQlzaXRlID0gJ2FuaW1lcycKCQlpZiB4Ym1jdmZzLmV4aXN0cyhmaWNoZWlybyk6CgkJCWYgPSBvcGVuKGZpY2hlaXJvLCAiciIpCgkJCXRleHRvID0gZi5yZWFkKCkKCQkJZi5jbG9zZSgpCgkJCXRlY2xhZG8uc2V0RGVmYXVsdCh0ZXh0bykKCQl0ZWNsYWRvLmRvTW9kYWwoKQkKCgkJaWYgdGVjbGFkby5pc0NvbmZpcm1lZCgpOgoJCQlzdHJQZXNxdWlzYSA9IHRlY2xhZG8uZ2V0VGV4dCgpCgkJCWlmIHN0clBlc3F1aXNhID09ICcnOgoJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnSW5zaXJhIGFsZ28gbmEgcGVzcXVpc2EuJykKCQkJCWFkZERpcjIoJ0FsdGVyYXIgUGVzcXVpc2EnLCB1cmwsIDEyNCwgJycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdwZXNxdWlzYS5wbmcnKSwgMCkKCQkJCXJldHVybiBGYWxzZQoJCQlkYWRvcyA9IHVybGxpYi51cmxlbmNvZGUoeyd0ZXh0byc6IHN0clBlc3F1aXNhLCAncXVhbGlkYWRlJzogcXVhbGlkYWRlfSkKCQkJdHJ5OgoJCQkJZiA9IG9wZW4oZmljaGVpcm8sIG1vZGU9InciKQoJCQkJZi53cml0ZShzdHJQZXNxdWlzYSkKCQkJCWYuY2xvc2UoKQoJCQlleGNlcHQ6CgkJCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdOw6NvIGdyYXZvdSBvIGNvbnRldWRvIGVtICcrZmljaGVpcm8pCgkJCXJlc3VsdGFkbyA9IGFicmlyX3VybCh1cmwscG9zdD1kYWRvcywgaGVhZGVyPWhlYWRlcnMsIGNvb2tpZT1nZXRDb29raWUoKSkKCWVsc2U6CgkJaWYgeGJtY3Zmcy5leGlzdHMoZmljaGVpcm8pOgoJCQlmID0gb3BlbihmaWNoZWlybywgInIiKQoJCQl0ZXh0byA9IGYucmVhZCgpCgkJCWYuY2xvc2UoKQoJCWRhZG9zID0gdXJsbGliLnVybGVuY29kZSh7J3RleHRvJzogdGV4dG8sICdxdWFsaWRhZGUnOnF1YWxpZGFkZX0pCgkJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCxwb3N0PWRhZG9zLCBoZWFkZXI9aGVhZGVycywgY29va2llPWdldENvb2tpZSgpKQoJCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCXRyeToKCQlpZiByZXN1bHRhZG9bJ2NvZGlnbyddID09IDIwNDoKCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnRGV2ZSBJbmRpY2FyIHVtIHZhbG9yIHBhcmEgcGVzcXVpc2EuJykKCQkJcmV0dXJuIEZhbHNlCglleGNlcHQ6CgkJcmVzdWx0YWRvID0gcmVzdWx0YWRvCgl2aXN0b3MgPSBEYXRhYmFzZS5zZWxlY3RGaWxtZXMoKQoJb3BjYW8gPSBfX0FERE9OX18uZ2V0U2V0dGluZygnbWFyY2FyVmlzdG8nKQoKCWlmIHJlc3VsdGFkb1snZGF0YSddICE9ICcnOgoJCWlmIHRpcG8gPT0gMDoKCQkJZm9yIGkgaW4gcmVzdWx0YWRvWydkYXRhJ106CgkJCQlzZXRGaWxtZShpLCB2aXN0b3MsIG9wY2FvKQoJCWVsaWYgdGlwbyA9PSAxIG9yIHRpcG8gPT0gMjoKCQkJZm9yIGkgaW4gcmVzdWx0YWRvWydkYXRhJ106CgkJCQlzZXRTZXJpZXMoaSwgdmlzdG9zLCBvcGNhbywgc2l0ZSkKCQkKCQljdXJyZW50ID0gcmVzdWx0YWRvWydtZXRhJ11bJ2N1cnJlbnQnXQoJCXRvdGFsID0gcmVzdWx0YWRvWydtZXRhJ11bJ3RvdGFsJ10KCQl0cnk6IHByb3hpbW8gPSByZXN1bHRhZG9bJ21ldGEnXVsncGFnaW5hY2FvJ11bJ25leHQnXQoJCWV4Y2VwdDogcGFzcyAKCQlpZiBpbnQoY3VycmVudCkgPCBpbnQodG90YWwpOgoJCQlhZGREaXIyKCdQcm94aW1hIHBhZ2luYSAoJytzdHIoY3VycmVudCkrJy8nK3N0cih0b3RhbCkrJyknLCBwcm94aW1vLCAxMjQsICdwZXNxdWlzYScsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdwcm94aW1vLnBuZycpKQoJCWVsc2U6CgkJCXhibWNwbHVnaW4uZW5kT2ZEaXJlY3RvcnkoaW50KHN5cy5hcmd2WzFdKSxjYWNoZVRvRGlzYz1GYWxzZSkKCXZpc3RhX2ZpbG1lc1NlcmllcygpCgpkZWYgcGVzcXVpc2Eoc2VydnVzcyk6Cgljb2RpZ29fZm9udGUgPSAnJwoJZGFkb3MgPSAnJwoJbmV0ID0gTmV0KCkKCSNuZXQuc2V0X2Nvb2tpZXMoX19DT09LSUVfRklMRV9fKQoJdGFiZWxhID0gJycKCXN0clBlc3F1aXNhID0gJycKCWZpY2hlaXJvID0gJycKCXVybCA9ICcnCglpZiAncGFnZScgbm90IGluIHVybDoKCQl1cmwgPSBfX1NJVEVCRF9fKydzZWFyY2gucGhwJwoJCWlmIHRpcG8gPT0gMzoKCQkJdGFiZWxhID0gJ2NhbmFpc19rb2RpJwoJCQlmaWNoZWlybyA9IG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ2NhbmFpcy5saXZlaXQnKQoJCWVsaWYgdGlwbyA9PSA0OgoJCQl0YWJlbGEgPSAncHJhaWFzX2tvZGknCgkJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywncHJhaWFzLmxpdmVpdCcpCgkJZWxpZiB0aXBvID09IDU6CgkJCXRhYmVsYSA9ICdyYWRpb3Nfa29kaScKCQkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdyYWRpb3MubGl2ZWl0JykKCQllbHNlOgoJCQl0YWJlbGEgPSAncHJvZ3JhbWFzX2tvZGknCgkJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywncHJvZ3JhbWFzLmxpdmVpdCcpCgkJCgkJaWYgeGJtY3Zmcy5leGlzdHMoZmljaGVpcm8pOgoJCQlmID0gb3BlbihmaWNoZWlybywgInIiKQoJCQl0ZXh0byA9IGYucmVhZCgpCgkJCWYuY2xvc2UoKQoJCQl0ZWNsYWRvLnNldERlZmF1bHQodGV4dG8pCgkJdGVjbGFkby5kb01vZGFsKCkJCgoJCWlmIHRlY2xhZG8uaXNDb25maXJtZWQoKToKCQkJc3RyUGVzcXVpc2EgPSB0ZWNsYWRvLmdldFRleHQoKQoJCQlkYWRvcyA9IHVybGxpYi51cmxlbmNvZGUoeyd0ZXh0byc6IHN0clBlc3F1aXNhLCAncXVhbGlkYWRlJzogcXVhbGlkYWRlfSkKCQkJdHJ5OgoJCQkJZiA9IG9wZW4oZmljaGVpcm8sIG1vZGU9InciKQoJCQkJZi53cml0ZShzdHJQZXNxdWlzYSkKCQkJCWYuY2xvc2UoKQoJCQlleGNlcHQ6CgkJCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdOw6NvIGdyYXZvdSBvIGNvbnRldWRvIGVtICcrZmljaGVpcm8pCgkJCXJlc3VsdGFkbyA9IGFicmlyX3VybCh1cmwscG9zdD1kYWRvcywgaGVhZGVyPWhlYWRlcnMsIGNvb2tpZT1nZXRDb29raWUoKSkKCWVsc2U6CgkJaWYgeGJtY3Zmcy5leGlzdHMoZmljaGVpcm8pOgoJCQlmID0gb3BlbihmaWNoZWlybywgInIiKQoJCQl0ZXh0byA9IGYucmVhZCgpCgkJCWYuY2xvc2UoKQoJCWRhZG9zID0gdXJsbGliLnVybGVuY29kZSh7J3RleHRvJzogdGV4dG8sICdxdWFsaWRhZGUnOnF1YWxpZGFkZX0pCgkJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCxwb3N0PWRhZG9zLCBoZWFkZXI9aGVhZGVycywgY29va2llPWdldENvb2tpZSgpKQoJCglpZiBzdHJQZXNxdWlzYSAhPSAnJzoKCQlpZiByZXN1bHRhZG8gPT0gJ0ROUyc6CgkJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1RlbSBkZSBhbHRlcmFyIG9zIEROUyBwYXJhIHBvZGVyIHVzdWZydWlyIGRvIF9fQURET05fXy4nKQoJCQlyZXR1cm4gRmFsc2UKCQkKCQl4Ym1jcGx1Z2luLmVuZE9mRGlyZWN0b3J5KGludChzeXMuYXJndlsxXSksY2FjaGVUb0Rpc2M9RmFsc2UpCgkJZGFkb3MgPSB7J3NlYXJjaEJveCc6IHN0clBlc3F1aXNhLCAndGFiZWxhJzogdGFiZWxhfQoJCWNvZGlnb19mb250ZSA9IG5ldC5odHRwX1BPU1QodXJsLCBmb3JtX2RhdGE9ZGFkb3MsIGhlYWRlcnM9X19IRUFERVJTX18pLmNvbnRlbnQuZGVjb2RlKCdsYXRpbi0xJykuZW5jb2RlKCJ1dGYtOCIpCgkJaW5mb3JtYSA9IHsKCQkJCSdzZXJ2aWRvcicgOiB7CgkJCQkJJ25vbWUnOiAnJywKCQkJCQknc2Vydic6ICcnCgkJCQl9LAoJCQkJJ3NlcnZpZG9yZXMnOiBbXSwKCQkJCSdjYW5haXMnOiBbXQoJCQl9CgkJc3VjZXNzbyA9ICdubycKCQllbGVtcyA9IEVULmZyb21zdHJpbmcoY29kaWdvX2ZvbnRlKQoJCQoJCWZvciBjaGlsZGVlIGluIGVsZW1zOgoJCQlpZihjaGlsZGVlLnRhZyA9PSAnc2Vydmlkb3JlcycpOgoJCQkJc2Vydmlkb3IgPSB7CgkJCQkJJ25vbWUnOiAnJywKCQkJCQknbGluayc6ICcnCgkJCQl9CgkJCQlmb3IgZ2cgaW4gY2hpbGRlZToJCgkJCQkJaWYoZ2cudGFnID09ICdOb21lJyk6CgkJCQkJCXNlcnZpZG9yWydub21lJ10gPSBnZy50ZXh0CQoJCQkJCWVsaWYoZ2cudGFnID09ICdTZXJ2aWRvcicpOgoJCQkJCQlzZXJ2aWRvclsnbGluayddID0gZ2cudGV4dAkJCgkJCQkJaW5mb3JtYVsnc2Vydmlkb3JlcyddLmFwcGVuZChzZXJ2aWRvcikKCQkJCgkJZm9yIHNlcnZ2dnYgaW4gaW5mb3JtYVsnc2Vydmlkb3JlcyddOgoJCQlpZihzZXJ2dnZ2Wydub21lJ10gPT0gc2VydnVzcyk6CgkJCQlpbmZvcm1hWydzZXJ2aWRvciddWydub21lJ10gPSBzZXJ2dnZ2Wydub21lJ10KCQkJCWluZm9ybWFbJ3NlcnZpZG9yJ11bJ3NlcnYnXSA9IHNlcnZ2dnZbJ2xpbmsnXQkJCQoJCQoJCWZvciBjaGlsZCBpbiBlbGVtczoKCQkJaWYoY2hpbGQudGFnID09ICdzdWNlc3NvJyk6CgkJCQlzdWNlc3NvID0gY2hpbGQudGV4dAoJCQllbGlmKGNoaWxkLnRhZyA9PSAnY2FuYWlzJyk6CgkJCQljYW5hbCA9IHsKCQkJCQknbm9tZSc6ICcnLAoJCQkJCSdsb2dvJzogJycsCgkJCQkJJ2xpbmsnOiAnJywKCQkJCQknZ3J1cG8nOiAnJywKCQkJCQknbm9tZWlkJzogJycsCgkJCQkJJ2lkbm92byc6ICcnCgkJCQl9CgkJCQlhZGljaW9uYSA9IFRydWUKCQkJCXBhZ2FudGUgPSBGYWxzZQoJCQkJZm9yIGcgaW4gY2hpbGQ6CgkJCQkJYWRpY2lvbmEgPSBUcnVlCgkJCQkJaWYoZy50YWcgPT0gJ05vbWUnKToKCQkJCQkJY2FuYWxbJ25vbWUnXSA9IGcudGV4dAoJCQkJCWVsaWYoZy50YWcgPT0gJ0ltYWdlbScpOgoJCQkJCQljYW5hbFsnbG9nbyddID0gZy50ZXh0CgkJCQkJZWxpZihnLnRhZyA9PSAnUGFnYW50ZScpOgoJCQkJCQlpZihnLnRleHQgPT0gJ3RydWUnKToKCQkJCQkJCXBhZ2FudGUgPSBUcnVlCgkJCQkJZWxpZihnLnRhZyA9PSAnVXJsJyk6CgkJCQkJCXVybGNoYW1hID0gZy50ZXh0LnNwbGl0KCc7JykKCQkJCQkJdXJsbm9vID0gZy50ZXh0CgkJCQkJCXRyeToKCQkJCQkJCWlmKHNlcnZ1c3MgPT0gJ1NlcnZpZG9yMScpOgoJCQkJCQkJCXVybG5vbyA9IHVybGNoYW1hWzBdCgkJCQkJCQllbGlmKHNlcnZ1c3MgPT0gJ1NlcnZpZG9yMicpOgoJCQkJCQkJCXVybG5vbyA9IHVybGNoYW1hWzFdCgkJCQkJCQllbGlmKHNlcnZ1c3MgPT0gJ1NlcnZpZG9yMycpOgoJCQkJCQkJCXVybG5vbyA9IHVybGNoYW1hWzJdCgkJCQkJCQllbGlmKHNlcnZ1c3MgPT0gJ1NlcnZpZG9yNCcpOgoJCQkJCQkJCXVybG5vbyA9IHVybGNoYW1hWzNdCgkJCQkJCQllbGlmKHNlcnZ1c3MgPT0gJ1NlcnZpZG9yNScpOgoJCQkJCQkJCXVybG5vbyA9IHVybGNoYW1hWzRdCgkJCQkJCQllbGlmKHNlcnZ1c3MgPT0gJ1NlcnZpZG9yNicpOgoJCQkJCQkJCXVybG5vbyA9IHVybGNoYW1hWzVdCgkJCQkJCQllbGlmKHNlcnZ1c3MgPT0gJ1NlcnZpZG9yNycpOgoJCQkJCQkJCXVybG5vbyA9IHVybGNoYW1hWzZdCgkJCQkJCQllbGlmKHNlcnZ1c3MgPT0gJ1NlcnZpZG9yOCcpOgoJCQkJCQkJCXVybG5vbyA9IHVybGNoYW1hWzddCgkJCQkJCQkKCQkJCQkJCWlmKHVybG5vbyA9PSAnbmFkYScpOgoJCQkJCQkJCWFkaWNpb25hID0gRmFsc2UKCQkJCQkJCWVsc2U6CgkJCQkJCQkJaWYgcGFnYW50ZToKCQkJCQkJCQkJY2FuYWxbJ2xpbmsnXSA9IGluZm9ybWFbJ3NlcnZpZG9yJ11bJ3NlcnYnXSsnbGl2ZS91dGlsaXphZG9ybGl2ZWl0L3NlbmhhbGl2ZWl0LycrdXJsbm9vCgkJCQkJCQkJZWxzZToKCQkJCQkJCQkJY2FuYWxbJ2xpbmsnXSA9IHVybG5vbwoJCQkJCQlleGNlcHQ6CgkJCQkJCQljYW5hbFsnbGluayddID0gZy50ZXh0CgkJCQkJZWxpZihnLnRhZyA9PSAnR3J1cG8nKToKCQkJCQkJY2FuYWxbJ2dydXBvJ10gPSBnLnRleHQKCQkJCQllbGlmKGcudGFnID09ICdOb21lSUQnKToKCQkJCQkJY2FuYWxbJ25vbWVpZCddID0gZy50ZXh0CgkJCQkJZWxpZihnLnRhZyA9PSAnSUQnKToKCQkJCQkJY2FuYWxbJ2lkbm92byddID0gZy50ZXh0CgkJCQlpZiBhZGljaW9uYToKCQkJCQlpbmZvcm1hWydjYW5haXMnXS5hcHBlbmQoY2FuYWwpCgoJCWlmIHN1Y2Vzc28gPT0gJ3llcyc6CgkJCWFkZERpcjIoJ0FsdGVyYXIgUGVzcXVpc2EnLCBzZXJ2dXNzLCAxMjAsICcnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncGVzcXVpc2EucG5nJyksIDApCgkJCWZvciBjYW5uIGluIGluZm9ybWFbJ2NhbmFpcyddOgoJCQkJbm9tZWUgPSBjYW5uWydub21lJ10KCQkJCWltZyA9IGNhbm5bJ2xvZ28nXQoJCQkJcnRtcCA9IGNhbm5bJ2xpbmsnXS5yZXBsYWNlKCcgcnRtcCcsJ3J0bXAnKS5yZXBsYWNlKCcgcnRzcCcsJ3J0c3AnKS5yZXBsYWNlKCcgaHR0cCcsJ2h0dHAnKS5yZXBsYWNlKCd1dGlsaXphZG9ybGl2ZWl0JyxfX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fbmFtZSIpKS5yZXBsYWNlKCdzZW5oYWxpdmVpdCcsX19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX3Bhc3N3b3JkIikpCgkJCQlncnVwID0gY2FublsnZ3J1cG8nXQoJCQkJaWRfaXQgPSBjYW5uWydub21laWQnXQoJCQkJaWRfcCA9IGNhbm5bJ2lkbm92byddCgkJCQlzcnRfZiA9ICcnCgkJCQlkZXNjcmkgPSAnJwoJCQkJCgkJCQlhZGRMaW5rMihub21lZSxydG1wLCdodHRwOi8vbGl2ZWl0a29kaS5jb20vTG9nb3MvJytpbWcpCgkJCQoJCQl2aXN0YV9DYW5haXMoKQoJZWxzZToKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdJbnNpcmEgYWxnbyBuYSBwZXNxdWlzYS4nKQoJCWFkZERpcjIoJ0FsdGVyYXIgUGVzcXVpc2EnLCBzZXJ2dXNzLCAxMjAsICcnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncGVzcXVpc2EucG5nJyksIDApCgpkZWYgZG93bmxvYWQodXJsLG5hbWUsIHRlbXBvcmFkYSxlcGlzb2RpbyxzZXJpZU5vbWUpOgoJI2hlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICdCZWFyZXIgJXMnICUgX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuTXJwaXJhY3knKQoJbGlua3MgPSB1cmwuc3BsaXQoJy8nKQoJaWYgJ2ZpbG1lJyBpbiB1cmw6CgkJaWRfdmlkZW8gPSBsaW5rc1stMV0KCQl0aXBvID0gMAoJZWxpZiAnc2VyaWUnIGluIHVybDoKCQlpZF92aWRlbyA9IGxpbmtzWzVdCgkJdGVtcG9yYWRhID0gbGlua3NbN10KCQllcGlzb2RpbyA9IGxpbmtzWy0xXQoJCXRpcG8gPSAxCgllbGlmICdhbmltZScgaW4gdXJsOgoJCWlkX3ZpZGVvID0gbGlua3NbNV0KCQl0ZW1wb3JhZGEgPSBsaW5rc1s3XQoJCWVwaXNvZGlvID0gbGlua3NbLTFdCgkJdGlwbyA9IDIKCglyZXN1bHRhZG8gPSBhYnJpcl91cmwodXJsLCBoZWFkZXI9aGVhZGVycykKCWlmIHJlc3VsdGFkbyA9PSAnRE5TJzoKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdUZW0gZGUgYWx0ZXJhciBvcyBETlMgcGFyYSBwb2RlciB1c3VmcnVpciBkbyBfX0FERE9OX18uJykKCQlyZXR1cm4gRmFsc2UKCQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pCgoJc3RyZWFtLCBsZWdlbmRhLCBleHRfZyA9IGdldFN0cmVhbUxlZ2VuZGEocmVzdWx0YWRvKQoKCWZvbGRlciA9IHhibWMudHJhbnNsYXRlUGF0aChfX0FERE9OX18uZ2V0U2V0dGluZygncGFzdGFEb3dubG9hZHMnKSkKCWlmKGZvbGRlciA9PSAnRXNjb2xoYSBhIHBhc3RhIHBhcmEgRG93bmxvYWQnKToKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdTZWxlY2Npb25lIHVtYSBwYXN0YSBwcmltZWlybyBubyBzdWJtZW51IENyZWTDqm5jaWFpcyBvdSBuYXMgQ29uZmlndXJhw6fDtWVzIGRvIF9fQURET05fXy4nKQoJZWxzZToKCQlpZiB0aXBvID4gMDoKCQkJaWYgdGlwbyA9PSAxOgoJCQkJcmVzdWx0YWRvYSA9IGFicmlyX3VybChfX0FQSV9TSVRFX18rJ3NlcmllLycraWRfdmlkZW8sIGhlYWRlcj1oZWFkZXJzKQoJCQllbGlmIHRpcG8gPT0gMjoKCQkJCXJlc3VsdGFkb2EgPSBhYnJpcl91cmwoX19BUElfU0lURV9fKydhbmltZS8nK2lkX3ZpZGVvLCBoZWFkZXI9aGVhZGVycykKCQkJcmVzdWx0YWRvYSA9IGpzb24ubG9hZHMocmVzdWx0YWRvYSkKCQkJaWYgbm90IHhibWN2ZnMuZXhpc3RzKG9zLnBhdGguam9pbihmb2xkZXIsJ3NlcmllcycpKToKCQkJCXhibWN2ZnMubWtkaXJzKG9zLnBhdGguam9pbihmb2xkZXIsJ3NlcmllcycpKQoJCQlpZiBub3QgeGJtY3Zmcy5leGlzdHMob3MucGF0aC5qb2luKGZvbGRlciwnc2VyaWVzJyxyZXN1bHRhZG9hWydub21lX2luZ2xlcyddKSk6CgkJCQl4Ym1jdmZzLm1rZGlycyhvcy5wYXRoLmpvaW4oZm9sZGVyLCdzZXJpZXMnLHJlc3VsdGFkb2FbJ25vbWVfaW5nbGVzJ10pKQoJCQlpZiBub3QgeGJtY3Zmcy5leGlzdHMob3MucGF0aC5qb2luKGZvbGRlciwnc2VyaWVzJyxyZXN1bHRhZG9hWydub21lX2luZ2xlcyddLCJUZW1wb3JhZGEgIitzdHIodGVtcG9yYWRhKSkpOgoJCQkJeGJtY3Zmcy5ta2RpcnMob3MucGF0aC5qb2luKGZvbGRlciwnc2VyaWVzJyxyZXN1bHRhZG9hWydub21lX2luZ2xlcyddLCJUZW1wb3JhZGEgIitzdHIodGVtcG9yYWRhKSkpCgkJCWZvbGRlciA9IG9zLnBhdGguam9pbihmb2xkZXIsICdzZXJpZXMnLCByZXN1bHRhZG9hWydub21lX2luZ2xlcyddLCAiVGVtcG9yYWRhIiwgc3RyKHRlbXBvcmFkYSkpCgkJCW5hbWUgPSAiZSIrc3RyKGVwaXNvZGlvKSsiIC0gIitjbGVhbihyZXN1bHRhZG9bJ25vbWVfZXBpc29kaW8nXSkKCQllbHNlOgoJCQlpZiBub3QgeGJtY3Zmcy5leGlzdHMob3MucGF0aC5qb2luKGZvbGRlciwnZmlsbWVzJykpOgoJCQkJeGJtY3Zmcy5ta2RpcnMob3MucGF0aC5qb2luKGZvbGRlciwnZmlsbWVzJykpCgkJCWZvbGRlciA9IG9zLnBhdGguam9pbihmb2xkZXIsJ2ZpbG1lcycpCgkJCW5hbWUgPSByZXN1bHRhZG9bJ25vbWVfaW5nbGVzJ10KCgkJc3RyZWFtQXV4ID0gY2xlYW4oc3RyZWFtLnNwbGl0KCcvJylbLTFdKQoJCWV4dGVuc2FvU3RyZWFtID0gY2xlYW4oc3RyZWFtQXV4LnNwbGl0KCcuJylbLTFdKQoKCQlpZiAnP21pbScgaW4gZXh0ZW5zYW9TdHJlYW06CgkJCWV4dGVuc2FvU3RyZWFtID0gcmUuY29tcGlsZSgnKC4rPylcP21pbWU9JykuZmluZGFsbChleHRlbnNhb1N0cmVhbSlbMF0KCgkJaWYgZXh0X2cgIT0gJ2NvaXNvJzoKCQkJZXh0ZW5zYW9TdHJlYW0gPSBleHRfZwoKCQlub21lU3RyZWFtID0gbmFtZSsnLicrZXh0ZW5zYW9TdHJlYW0KCQlub21lbGVnZW5kYSA9ICcnCgkJRG93bmxvYWRlci5Eb3dubG9hZGVyKCkuZG93bmxvYWQob3MucGF0aC5qb2luKGZvbGRlci5kZWNvZGUoInV0Zi04IiksIG5vbWVTdHJlYW0pLCBzdHJlYW0sIG5hbWUpCgkJCgkJaWYgbGVnZW5kYXNPbjoKCQkJbGVnZW5kYUF1eCA9IGNsZWFuKGxlZ2VuZGEuc3BsaXQoJy8nKVstMV0pCgkJCWV4dGVuc2FvTGVnZW5kYSA9IGNsZWFuKGxlZ2VuZGFBdXguc3BsaXQoJy4nKVsxXSkKCQkJbm9tZUxlZ2VuZGEgPSBuYW1lKycuJytleHRlbnNhb0xlZ2VuZGEKCQkJZG93bmxvYWRfbGVnZW5kYXMobGVnZW5kYSwgb3MucGF0aC5qb2luKGZvbGRlciwgbm9tZUxlZ2VuZGEpKQoKZGVmIGRvd25sb2FkX2xlZ2VuZGFzKHVybCxwYXRoKToKCWNvbnRlbnRzID0gYWJyaXJfdXJsKHVybCkKCWlmIGNvbnRlbnRzOgoJCWZoID0gb3BlbihwYXRoLCAndycpCgkJZmgud3JpdGUoY29udGVudHMpCgkJZmguY2xvc2UoKQoJcmV0dXJuCgpkZWYgY2xlYW4odGV4dCk6Cgljb21tYW5kPXsnJiM4MjIwOyc6JyInLCcmIzgyMjE7JzonIicsICcmIzgyMTE7JzonLScsJyZhbXA7JzonJicsJyYjODIxNzsnOiInIiwnJiM4MjE2Oyc6IicifQoJcmVnZXggPSByZS5jb21waWxlKCJ8Ii5qb2luKG1hcChyZS5lc2NhcGUsIGNvbW1hbmQua2V5cygpKSkpCglyZXR1cm4gcmVnZXguc3ViKGxhbWJkYSBtbzogY29tbWFuZFttby5ncm91cCgwKV0sIHRleHQpCgpkZWYgYWRkVmlkZW8obmFtZSx1cmwsbW9kZSxpY29uaW1hZ2UsdmlzdG8sdGlwbyx0ZW1wb3JhZGEsZXBpc29kaW8saW5mb0xhYmVscyxwb3N0ZXIsdHJhaWxlcj1GYWxzZSxzZXJpZU5vbWU9RmFsc2UpOgoJbWVudSA9IFtdCgkKCWlmIGluZm9MYWJlbHM6IGluZm9MYWJlbHNBdXggPSBpbmZvTGFiZWxzCgllbHNlOiBpbmZvTGFiZWxzQXV4ID0geydUaXRsZSc6IG5hbWV9CgoJaWYgcG9zdGVyOiBwb3N0ZXJBdXggPSBwb3N0ZXIKCWVsc2U6IHBvc3RlckF1eCA9IGljb25pbWFnZQoJCgl0cnk6CgkJbmFtZSA9IG5hbWUuZW5jb2RlKCd1dGYtOCcpCglleGNlcHQ6CgkJbmFtZSA9IG5hbWUKCQoJdHJ5OgoJCXNlcmllTm9tZSA9IHNlcmllTm9tZS5lbmNvZGUoJ3V0Zi04JykKCWV4Y2VwdDoKCQlzZXJpZU5vbWUgPSBzZXJpZU5vbWUKCWVsc2U6CgkJcGFzcwoKCWZhbmFydCA9IF9fRkFOQVJUX18KCQoJaWYgdGlwbyA9PSAnZmlsbWUnOgoJCXhibWNwbHVnaW4uc2V0Q29udGVudChpbnQoc3lzLmFyZ3ZbMV0pLCAnTW92aWVzJykKCQlpZiBfX0FERE9OX18uZ2V0U2V0dGluZygndHJhaWxlci1maWxtZXMnKSA9PSAndHJ1ZSc6CgkJCXRyeToKCQkJCWlkWW91dHViZSA9IHRyYWlsZXIuc3BsaXQoJz92PScpWy0xXS5zcGxpdCgnLycpWy0xXS5zcGxpdCgnPycpWzBdLnNwbGl0KCcmJylbMF0KCQkJCWxpbmtUcmFpbGVyID0gJ3BsdWdpbjovL3BsdWdpbi52aWRlby55b3V0dWJlL3BsYXkvP3ZpZGVvX2lkPScraWRZb3V0dWJlCgkJCQkjaWRZb3V0dWJlPXRyYWlsZXIuc3BsaXQoJz0nKQoJCQkJI19fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0lEOiAnK2lkWW91dHViZVsxXSkKCQkJCSNsaW5rVHJhaWxlciA9ICdwbHVnaW46Ly9wbHVnaW4udmlkZW8ueW91dHViZS8/cGF0aD0vcm9vdC92aWRlbyZhY3Rpb249cGxheV92aWRlbyZ2aWRlb2lkPScraWRZb3V0dWJlWzFdCgkJCQkjbGlua1RyYWlsZXIgPSB0cmFpbGVyCgkJCWV4Y2VwdDoKCQkJCWxpbmtUcmFpbGVyID0gJycKCQllbHNlOgoJCQlsaW5rVHJhaWxlciA9ICcnCgllbGlmIHRpcG8gPT0gJ3NlcmllJzoKCQl4Ym1jcGx1Z2luLnNldENvbnRlbnQoaW50KHN5cy5hcmd2WzFdKSwgJ3R2c2hvd3MnKQoJCWlkSU1EYiA9IHJlLmNvbXBpbGUoJ2ltZGI9KC4rPykmJykuZmluZGFsbCh1cmwpWzBdCgkJbGlua1RyYWlsZXIgPSAiIgoJZWxpZiB0aXBvID09ICdlcGlzb2Rpbyc6CgkJeGJtY3BsdWdpbi5zZXRDb250ZW50KGludChzeXMuYXJndlsxXSksICdlcGlzb2RlcycpCgkJbGlua1RyYWlsZXIgPSAiIgoJZWxzZToKCQl4Ym1jcGx1Z2luLnNldENvbnRlbnQoaW50KHN5cy5hcmd2WzFdKSwgJ01vdmllcycpCgkJbGlua1RyYWlsZXIgPSAiIgoJCglvdmVybGF5ID0gNgoJcGxheWNvdW50ID0gMAoKCWluZm9MYWJlbHNBdXhbIm92ZXJsYXkiXSA9IG92ZXJsYXkKCWluZm9MYWJlbHNBdXhbInBsYXljb3VudCJdID0gcGxheWNvdW50CgkKCWxpej14Ym1jZ3VpLkxpc3RJdGVtKG5hbWUsIGljb25JbWFnZT1pY29uaW1hZ2UsIHRodW1ibmFpbEltYWdlPWljb25pbWFnZSkKCWxpei5zZXRJbmZvKCB0eXBlPSJWaWRlbyIsIGluZm9MYWJlbHM9aW5mb0xhYmVsc0F1eCkKCWxpei5zZXRQcm9wZXJ0eSgnZmFuYXJ0X2ltYWdlJywgcG9zdGVyKQoJbGl6LnNldEFydCh7J2ZhbmFydCc6IHBvc3Rlcn0pCgkKCQoJaWYgbm90IHNlcmllTm9tZToKCQlzZXJpZU5vbWUgPSAnJwoKCXU9c3lzLmFyZ3ZbMF0rIj91cmw9Iit1cmxsaWIucXVvdGVfcGx1cyh1cmwpKyImbW9kZT0iK3N0cihtb2RlKSsiJnRlbXBvcmFkYT0iK3N0cih0ZW1wb3JhZGEpKyImZXBpc29kaW89IitzdHIoZXBpc29kaW8pKyImbmFtZT0iK3VybGxpYi5xdW90ZV9wbHVzKG5hbWUpKyImaWNvbmltYWdlPSIrdXJsbGliLnF1b3RlX3BsdXMoaWNvbmltYWdlKSsiJnNlcmllTm9tZT0iK3VybGxpYi5xdW90ZV9wbHVzKHNlcmllTm9tZSkKCW9rPVRydWUKCQoJaWYgbGlua1RyYWlsZXIgIT0gIiI6CgkJbWVudS5hcHBlbmQoKCdWZXIgVHJhaWxlcicsICdYQk1DLlBsYXlNZWRpYSglcyknICUgKGxpbmtUcmFpbGVyKSkpCgkJI21lbnUuYXBwZW5kKCgnVmVyIFRyYWlsZXInLCAnWEJNQy5SdW5QbHVnaW4oJXM/bW9kZT0xMDUmbmFtZT0lcyZ1cmw9JXMmaWNvbmltYWdlPSVzKSclKHN5cy5hcmd2WzBdLHVybGxpYi5xdW90ZV9wbHVzKG5hbWUpLCBsaW5rVHJhaWxlciwgdXJsbGliLnF1b3RlX3BsdXMoaWNvbmltYWdlKSkpKQoJCgltZW51LmFwcGVuZCgoJ0Rvd25sb2FkJywgJ1hCTUMuUnVuUGx1Z2luKCVzP21vZGU9MTE3Jm5hbWU9JXMmdXJsPSVzJmljb25pbWFnZT0lcyZzZXJpZU5vbWU9JXMmdGVtcG9yYWRhPSVzJmVwaXNvZGlvPSVzKSclKHN5cy5hcmd2WzBdLHVybGxpYi5xdW90ZV9wbHVzKG5hbWUpLCB1cmxsaWIucXVvdGVfcGx1cyh1cmwpLCB1cmxsaWIucXVvdGVfcGx1cyhpY29uaW1hZ2UpLCB1cmxsaWIucXVvdGVfcGx1cyhzZXJpZU5vbWUpLCBzdHIodGVtcG9yYWRhKSwgc3RyKGVwaXNvZGlvKSkpKQoJbGl6LmFkZENvbnRleHRNZW51SXRlbXMobWVudSwgcmVwbGFjZUl0ZW1zPVRydWUpCglvaz14Ym1jcGx1Z2luLmFkZERpcmVjdG9yeUl0ZW0oaGFuZGxlPWludChzeXMuYXJndlsxXSksdXJsPXUsbGlzdGl0ZW09bGl6LGlzRm9sZGVyPUZhbHNlKQoJcmV0dXJuIG9rCgpkZWYgQWRkRGlyKG5hbWUsIHVybCwgbW9kZSwgaWNvbmltYWdlPScnLCBsb2dvcz0nJywgaW5kZXg9LTEsIG1vdmU9MCwgaXNGb2xkZXI9VHJ1ZSwgSXNQbGF5YWJsZT1GYWxzZSwgYmFja2dyb3VuZD1Ob25lLCBjYWNoZU1pbj0nMCcsIGluZm89JycsIG1ldGFoPScnKToKCXVybFBhcmFtcyA9IHsnbmFtZSc6IG5hbWUsICd1cmwnOiB1cmwsICdtb2RlJzogbW9kZSwgJ2ljb25pbWFnZSc6IGljb25pbWFnZSwgJ2xvZ29zJzogbG9nb3MsICdjYWNoZSc6IGNhY2hlTWluLCAnaW5mbyc6IGluZm8sICdiYWNrZ3JvdW5kJzogYmFja2dyb3VuZCwgJ21ldGFoJzogbWV0YWh9CglsaXogPSB4Ym1jZ3VpLkxpc3RJdGVtKG5hbWUsIGljb25JbWFnZT1pY29uaW1hZ2UsIHRodW1ibmFpbEltYWdlPWljb25pbWFnZSApCglpZiBtZXRhaDoKCQlsaXouc2V0SW5mbyh0eXBlPSJWaWRlbyIsIGluZm9MYWJlbHM9bWV0YWgpCgkJbGl6LnNldEFydCh7InRodW1iIjogbWV0YWhbJ2NvdmVyX3VybCddLCAicG9zdGVyIjogbWV0YWhbJ2NvdmVyX3VybCddLCAiYmFubmVyIjogbWV0YWhbJ2NvdmVyX3VybCddLCAiZmFuYXJ0IjogbWV0YWhbJ2JhY2tkcm9wX3VybCddIH0pCgllbHNlOgoJCWxpei5zZXRJbmZvKHR5cGU9IlZpZGVvIiwgaW5mb0xhYmVscz17ICJUaXRsZSI6IG5hbWUsICJQbG90IjogaW5mbyB9KQoJCSNsaXouc2V0UHJvcGVydHkoIkZhbmFydF9JbWFnZSIsIGxvZ29zKQoJCWxpei5zZXRBcnQoeyJwb3N0ZXIiOiBpY29uaW1hZ2UsICJiYW5uZXIiOiBsb2dvcywgImZhbmFydCI6IGxvZ29zIH0pCgkjbGlzdE1vZGUgPSAyMSAjIExpc3RzCglpZiBJc1BsYXlhYmxlOgoJCWxpei5zZXRQcm9wZXJ0eSgnSXNQbGF5YWJsZScsICd0cnVlJykKCWl0ZW1zID0gW10KCWlmIG1vZGUgPT0gMSBvciBtb2RlID09IDI6CgkJaXRlbXMgPSBbXQoJaWYgbW9kZSA9PSAxMDoKCQl1cmxQYXJhbXNbJ2luZGV4J10gPSBpbmRleAoJCgkjdT1zeXMuYXJndlswXSsiP3VybD0iK3VybGxpYi5xdW90ZV9wbHVzKHVybCkrIiZuYW1lPSIrdXJsbGliLnF1b3RlX3BsdXMobmFtZSkrIiZtb2RlPSIraW50KG1vZGUpKyImbW92ZT0iK2ludChtb3ZlKSsiJmluZGV4PSIraW50KGluZGV4KSsiJmljb25pbWFnZT0iK3N0cihpY29uaW1hZ2UpKyImbG9nb3M9IitzdHIobG9nb3MpKyImY2FjaGU9IitzdHIoY2FjaGVNaW4pKyImaW5mbz0iK3N0cihpbmZvKSsiJmJhY2tncm91bmQ9IitiYWNrZ3JvdW5kKyImbWV0YWg9IitzdHIobWV0YWgpCgkjdT1zeXMuYXJndlswXSsiP3VybD0iK3VybGxpYi5xdW90ZV9wbHVzKHVybCkrIiZtb2RlPSIrc3RyKG1vZGUpKyImbmFtZT0iK3VybGxpYi5xdW90ZV9wbHVzKG5hbWUpKyImc2VuaGE9IitzdHIoc2VuaGEpKyImZXN0aWxvPSIrdXJsbGliLnF1b3RlX3BsdXMoZXN0aWxvKSsiJnRpcG9sb2dpYT0iK3N0cih0aXBvKSsiJnRpcG9fdXNlcj0iK3N0cih0aXBvX3VzZXIpKyImc2Vydmlkb3JfdXNlcj0iK3N0cihzZXJ2aWRvcl91c2VyKSsiJmRhdGFfdXNlcj0iK3N0cihkYXRhX3VzZXIpKyImZmFuYXJ0PSIrc3RyKGZhbmFydCkKCXUgPSAnezB9P3sxfScuZm9ybWF0KHN5cy5hcmd2WzBdLCB1cmxsaWIudXJsZW5jb2RlKHVybFBhcmFtcykpCglvaz14Ym1jcGx1Z2luLmFkZERpcmVjdG9yeUl0ZW0oaGFuZGxlPWludChzeXMuYXJndlsxXSksdXJsPXUsIGxpc3RpdGVtPWxpeixpc0ZvbGRlcj1pc0ZvbGRlcikKCXJldHVybiBvawoKZGVmIEdldEtleWJvYXJkVGV4dCh0aXRsZSA9ICIiLCBkZWZhdWx0VGV4dCA9ICIiKToKCWtleWJvYXJkID0geGJtYy5LZXlib2FyZChkZWZhdWx0VGV4dCwgdGl0bGUpCglrZXlib2FyZC5kb01vZGFsKCkKCXRleHQgPSAiIiBpZiBub3Qga2V5Ym9hcmQuaXNDb25maXJtZWQoKSBlbHNlIGtleWJvYXJkLmdldFRleHQoKQoJcmV0dXJuIHRleHQKCmRlZiBSZWZyZXNoKCk6Cgl4Ym1jLmV4ZWN1dGVidWlsdGluKCJYQk1DLkNvbnRhaW5lci5SZWZyZXNoKCkiKQoKZGVmIFBsYXlVcmwobmFtZSwgdXJsLCBpY29uaW1hZ2U9Tm9uZSwgaW5mbz0nJywgc3ViPScnLCBtZXRhaD0nJyk6CglpZiAiOzs7IiBpbiBiYWNrZ3JvdW5kOgoJCWIgPSBiYWNrZ3JvdW5kLnNwbGl0KCI7OzsiKQoJdXJsID0gcmUuc3ViKCdcLm1wNCQnLCAnLm1wND9wbGF5JywgdXJsKQoJdXJsID0gY29tbW9uLmdldEZpbmFsVXJsKHVybCkKCSN4Ym1jLmxvZygnLS0tIFBsYXlpbmcgInswfSIuIHsxfScuZm9ybWF0KG5hbWUsIHVybCksIDIpCglsaXN0aXRlbSA9IHhibWNndWkuTGlzdEl0ZW0ocGF0aD11cmwpCglpZiBtZXRhaDoKCQlsaXN0aXRlbS5zZXRJbmZvKHR5cGU9IlZpZGVvIiwgaW5mb0xhYmVscz1tZXRhaCkKCWVsc2U6CgkJbGlzdGl0ZW0uc2V0SW5mbyh0eXBlPSJWaWRlbyIsIGluZm9MYWJlbHM9eyJtZWRpYXR5cGUiOiAidmlkZW8iLCAiVGl0bGUiOiBuYW1lLCAiUGxvdCI6IGluZm8gfSkKCWlmIHN1YiE9Jyc6CgkJbGlzdGl0ZW0uc2V0U3VidGl0bGVzKFsnc3BlY2lhbDovL3RlbXAvZXhhbXBsZS5zcnQnLCBzdWIgXSkKCWlmIGljb25pbWFnZSBpcyBub3QgTm9uZToKCQl0cnk6CgkJCWxpc3RpdGVtLnNldEFydCh7J3RodW1iJyA6IGljb25pbWFnZX0pCgkJZXhjZXB0OgoJCQlsaXN0aXRlbS5zZXRUaHVtYm5haWxJbWFnZShpY29uaW1hZ2UpCgl4Ym1jcGx1Z2luLnNldFJlc29sdmVkVXJsKGludChzeXMuYXJndlsxXSksIFRydWUsIGxpc3RpdGVtKQojIC0tLS0tLS0tLS0tLS0tICBGSU0gTkVUQ0lORQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCQkJCQkJCQlGVU5DT0VTIEpBIEZFSVRBUwkJCQkJCQkJICMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKZGVmIGFkZERpcihuYW1lLHVybCxtb2RlLGVzdGlsbyxpY29uaW1hZ2UsdGlwbyxmYW5hcnQscGFzdGE9VHJ1ZSx0b3RhbD0xKToKCXRyeToKCQluYW1lID0gbmFtZS5lbmNvZGUoJ3V0Zi04JykKCWV4Y2VwdDoKCQluYW1lID0gbmFtZQoJaWYodGlwbyA9PSAnbGltcGFyY2FjaGUnIGFuZCB0aXBvID09ICdsaW1wYXJ0dWRvJyk6CQkJCQoJCXU9c3lzLmFyZ3ZbMF0rIj91cmw9Iit1cmxsaWIucXVvdGVfcGx1cyh1cmwpKyImbW9kZT0iK3N0cihtb2RlKQoJZWxzZToKCQl1PXN5cy5hcmd2WzBdKyI/dXJsPSIrdXJsbGliLnF1b3RlX3BsdXModXJsKSsiJm1vZGU9IitzdHIobW9kZSkrIiZuYW1lPSIrdXJsbGliLnF1b3RlX3BsdXMobmFtZSkrIiZlc3RpbG89Iit1cmxsaWIucXVvdGVfcGx1cyhlc3RpbG8pKyImZmFuYXJ0PSIrc3RyKGZhbmFydCkKCW9rPVRydWUKCWxpej14Ym1jZ3VpLkxpc3RJdGVtKG5hbWUsIGljb25JbWFnZT1pY29uaW1hZ2UsIHRodW1ibmFpbEltYWdlPWljb25pbWFnZSkKCWxpei5zZXRQcm9wZXJ0eSgnZmFuYXJ0X2ltYWdlJywgZmFuYXJ0KQoJbGl6LnNldEFydCh7J2ZhbmFydCc6IGZhbmFydH0pCglvaz14Ym1jcGx1Z2luLmFkZERpcmVjdG9yeUl0ZW0oaGFuZGxlPWludChzeXMuYXJndlsxXSksdXJsPXUsbGlzdGl0ZW09bGl6LGlzRm9sZGVyPXBhc3RhLHRvdGFsSXRlbXM9dG90YWwpCglyZXR1cm4gb2sKCmRlZiBhZGREaXIyKG5hbWUsdXJsLG1vZGUsbW9kZTIsaWNvbmltYWdlLHBhZ2luYT0xLHRpcG89Tm9uZSxpbmZvTGFiZWxzPU5vbmUscG9zdGVyPU5vbmUsdmlzdG89RmFsc2UpOgoJaWYgaW5mb0xhYmVsczogaW5mb0xhYmVsc0F1eCA9IGluZm9MYWJlbHMKCWVsc2U6IGluZm9MYWJlbHNBdXggPSB7J1RpdGxlJzogbmFtZX0KCWZhbmFydCA9ICcnCglpZiBwb3N0ZXI6IGZhbmFydCA9IHBvc3RlcgoJZWxzZTogZmFuYXJ0ID0gaWNvbmltYWdlCgkKCXRyeToKCQluYW1lID0gbmFtZS5lbmNvZGUoJ3V0Zi04JykKCWV4Y2VwdDoKCQluYW1lID0gbmFtZQoKCXU9c3lzLmFyZ3ZbMF0rIj91cmw9Iit1cmxsaWIucXVvdGVfcGx1cyh1cmwpKyImbW9kbz0iK21vZGUyKyImbW9kZT0iK3N0cihtb2RlKSsiJm5hbWU9Iit1cmxsaWIucXVvdGVfcGx1cyhuYW1lKQoJCglvaz1UcnVlCgoJI2ZhbmFydCA9IF9fRkFOQVJUX18KCglpZiB0aXBvID09ICdmaWxtZSc6CgkJI2ZhbmFydCA9IHBvc3RlckF1eAoJCXhibWNwbHVnaW4uc2V0Q29udGVudChpbnQoc3lzLmFyZ3ZbMV0pLCAnTW92aWVzJykKCWVsaWYgdGlwbyA9PSAnc2VyaWUnOgoJCSNmYW5hcnQgPSBwb3N0ZXJBdXgKCQl4Ym1jcGx1Z2luLnNldENvbnRlbnQoaW50KHN5cy5hcmd2WzFdKSwgJ3R2c2hvd3MnKQoJZWxpZiB0aXBvID09ICdlcGlzb2Rpbyc6CgkJI2ZhbmFydCA9IHBvc3RlckF1eAoJCXhibWNwbHVnaW4uc2V0Q29udGVudChpbnQoc3lzLmFyZ3ZbMV0pLCAnZXBpc29kZXMnKQoJZWxzZToKCQlpZiBuYW1lICE9ICdSZWZyZXNoJzoKCQkJeGJtY3BsdWdpbi5zZXRDb250ZW50KGludChzeXMuYXJndlsxXSksICdNb3ZpZXMnKQoJCglvdmVybGF5ID0gNgoJcGxheWNvdW50ID0gMAoJCglpbmZvTGFiZWxzQXV4WyJvdmVybGF5Il0gPSBvdmVybGF5CglpbmZvTGFiZWxzQXV4WyJwbGF5Y291bnQiXSA9IHBsYXljb3VudAoJCglsaXo9eGJtY2d1aS5MaXN0SXRlbShuYW1lLCBpY29uSW1hZ2U9aWNvbmltYWdlLCB0aHVtYm5haWxJbWFnZT1pY29uaW1hZ2UpCglsaXouc2V0UHJvcGVydHkoJ2ZhbmFydF9pbWFnZScsIGZhbmFydCkKCWxpei5zZXRBcnQoeydmYW5hcnQnOiBmYW5hcnR9KQoJbGl6LnNldEluZm8oIHR5cGU9IlZpZGVvIiwgaW5mb0xhYmVscz1pbmZvTGFiZWxzQXV4ICkKCglvaz14Ym1jcGx1Z2luLmFkZERpcmVjdG9yeUl0ZW0oaGFuZGxlPWludChzeXMuYXJndlsxXSksdXJsPXUsbGlzdGl0ZW09bGl6LGlzRm9sZGVyPVRydWUpCglyZXR1cm4gb2sKCmRlZiBhZGRMaW5rQ2FuYWwobmFtZSx1cmwsaWNvbmltYWdlLGlkY2FuYWwsaWRfcCk6CglpbmZvTGFiZWxzc3NzID0geyJ0aXRsZSI6IG5hbWUsICJnZW5yZSI6ICdBbGwnfQoJb2s9VHJ1ZQoJY209W10KCQoJaWYoaWRjYW5hbCAhPSAnMDAwMScpOgoJCWNtLmFwcGVuZCgoJ1ZlciBwcm9ncmFtYcOnw6NvJywgJ1hCTUMuUnVuUGx1Z2luKCVzP21vZGU9MzEmbmFtZT0lcyZ1cmw9JXMmaWNvbmltYWdlPSVzJmlkQ2FuYWw9JXMmaWRmZkNhbmFsPSVzKSclKHN5cy5hcmd2WzBdLHVybGxpYi5xdW90ZV9wbHVzKG5hbWUpLCB1cmxsaWIucXVvdGVfcGx1cyh1cmwpLCB1cmxsaWIucXVvdGVfcGx1cyhpY29uaW1hZ2UpLCBpZENhbmFsLCBpZF9wKSkpCgkKCWxpeiA9IHhibWNndWkuTGlzdEl0ZW0obmFtZSwgaWNvbkltYWdlPWljb25pbWFnZSwgdGh1bWJuYWlsSW1hZ2U9aWNvbmltYWdlKQoJbGl6LnNldEluZm8oIHR5cGU9IlZpZGVvIiwgaW5mb0xhYmVscz1pbmZvTGFiZWxzc3NzKQoJbGl6LmFkZENvbnRleHRNZW51SXRlbXMoY20sIHJlcGxhY2VJdGVtcz1GYWxzZSkKCWxpei5zZXRQcm9wZXJ0eSgnSXNQbGF5YWJsZScsICd0cnVlJykKCWxpei5zZXRQcm9wZXJ0eSgnZmFuYXJ0X2ltYWdlJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3R2LnBuZycpKQoJbGl6LnNldEFydCh7J2ZhbmFydCc6IG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb190di5wbmcnKX0pCgl1ID0gc3lzLmFyZ3ZbMF0gKyAiP3VybD0iICsgdXJsbGliLnF1b3RlX3BsdXModXJsKSArICImbW9kZT0xMSZuYW1lPSIgKyB1cmxsaWIucXVvdGVfcGx1cyhuYW1lKSArICImaWNvbmltYWdlPSIgKyB1cmxsaWIucXVvdGVfcGx1cyhpY29uaW1hZ2UpKyImc3RyZWFtX2lkPSIrc3RyKGlkY2FuYWwpCglvaz14Ym1jcGx1Z2luLmFkZERpcmVjdG9yeUl0ZW0oaGFuZGxlPWludChzeXMuYXJndlsxXSksIHVybD11LCBsaXN0aXRlbT1saXopCglyZXR1cm4gb2sKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCQkJCQkJCQkJCQkJCUVQRwkJCQkJCQkJCQkJCQkgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKZGVmIG9idGVyX2ZpY2hlaXJvX2VwZygpOgoJX19FUEdfXyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJsaXN0YV9lcGciKQoJaWYgbm90IHhibWN2ZnMuZXhpc3RzKF9fRk9MREVSX0VQR19fKToKCQl4Ym1jdmZzLm1rZGlycyhfX0ZPTERFUl9FUEdfXykKCgl1bmNvbXByZXNzZWRfcGF0aCA9IG9zLnBhdGguam9pbihfX0ZPTERFUl9FUEdfXywgJ2VwZy54bWwnKQoJdXJsID0gdXJsbGliLnVybG9wZW4oX19FUEdfXykKCWNvZGlnbyA9IHVybC5yZWFkKCkKCXVybC5jbG9zZQoJCglvcGVuKHVuY29tcHJlc3NlZF9wYXRoLCAndycpLndyaXRlKGNvZGlnbykKCmRlZiBnZXRQcm9ncmFtYWNhb0RpYXJpYShpZENhbmFsLCBkaWFob3JhLCBjb2RpZ28pOgoJc291cmNlID0gcmUuY29tcGlsZSgnPHByb2dyYW1tZSBzdGFydD0iKC4rPykgXCswMTAwIiBzdG9wPSIoLis/KSBcKzAxMDAiIGNoYW5uZWw9IicraWRDYW5hbCsnIj5ccys8dGl0bGUgbGFuZz0icHQiPiguKz8pPFwvdGl0bGU+JykuZmluZGFsbChjb2RpZ28pCgoJcHJvZ3JhbWEgPSAnJwoKCWZvciBzdGFydCwgc3RvcCwgcHJvZ3JhbWExICBpbiBzb3VyY2U6CgoJCWlmKGludChzdGFydCkgPCBkaWFob3JhIGFuZCBpbnQoc3RvcCkgPiBkaWFob3JhKToKCQkJcHJvZ3JhbWEgPSBwcm9ncmFtYTEKCXJldHVybiBwcm9ncmFtYQoKCmRlZiBwcm9ncmFtYWNhb19jYW5hbChpZENhbmFsKToKCV9fRVBHX18gPSBfX0FERE9OX18uZ2V0U2V0dGluZygibGlzdGFfZXBnIikKCXVybCA9IHVybGxpYi51cmxvcGVuKF9fRVBHX18pCgljb2RpZ28gPSB1cmwucmVhZCgpCgl1cmwuY2xvc2UKCQoJdHMgPSB0aW1lLnRpbWUoKQoJc3QgPSBpbnQoZGF0ZXRpbWUuZGF0ZXRpbWUuZnJvbXRpbWVzdGFtcCh0cykuc3RyZnRpbWUoJyVZJW0lZCcpKQoKCWRpYWhvcmEgPSBpbnQoc3RyKHN0KSsnMDYwMDAwJykKCWRpYWFtYW5oYSA9IGludChzdHIoc3QrMSkrJzA2MDAwMCcpCgoJc291cmNlID0gcmUuY29tcGlsZSgnPHByb2dyYW1tZSBzdGFydD0iKC4rPykgXCswMTAwIiBzdG9wPSIoLis/KSBcKzAxMDAiIGNoYW5uZWw9IicraWRDYW5hbCsnIj5ccys8dGl0bGUgbGFuZz0icHQiPiguKz8pPFwvdGl0bGU+JykuZmluZGFsbChjb2RpZ28pCgoJcHJvZ3JhbWEgPSAnJwoKCXRpdGxlcz1bJ1tCXVtDT0xPUiB3aGl0ZV1Qcm9ncmFtYcOnw6NvOlsvQ09MT1JdWy9CXSddCgoJCglmb3Igc3RhcnQsIHN0b3AsIHByb2dyYW1hMSBpbiBzb3VyY2U6CgoJCXN0YXJ0MSA9IHJlLmNvbXBpbGUoJyhbMC05XXs0fVswLTFdWzAtOV1bMC0zXVswLTldKShbMC05XXsyfSkoWzAtOV17Mn0pKFswLTldezJ9KScpLmZpbmRhbGwoc3RhcnQpCgkJc3RvcDEgPSByZS5jb21waWxlKCcoWzAtOV17NH1bMC0xXVswLTldWzAtM11bMC05XSkoWzAtOV17Mn0pKFswLTldezJ9KShbMC05XXsyfSknKS5maW5kYWxsKHN0b3ApCgoJCWlmKGludChzdGFydCkgPiBkaWFob3JhIGFuZCBpbnQoc3RhcnQpIDwgZGlhYW1hbmhhICk6CgkJCXRpdGxlcy5hcHBlbmQoJ1xuW0JdJXM6JXMgLT4gJXM6JXNbL0JdIC0gJXMnICUgKHN0YXJ0MVswXVsxXSwgc3RhcnQxWzBdWzJdLCBzdG9wMVswXVsxXSwgc3RvcDFbMF1bMl0sIHByb2dyYW1hMSkpCgoKCXByb2dyYW1hY2FvID0gJ1xuJy5qb2luKHRpdGxlcykKCXRyeToKCQl4Ym1jLmV4ZWN1dGVidWlsdGluKCJBY3RpdmF0ZVdpbmRvdygxMDE0NykiKQoJCXdpbmRvdyA9IHhibWNndWkuV2luZG93KDEwMTQ3KQoJCXhibWMuc2xlZXAoMTAwKQoJCXdpbmRvdy5nZXRDb250cm9sKDEpLnNldExhYmVsKEFkZG9uVGl0bGUpCgkJd2luZG93LmdldENvbnRyb2woNSkuc2V0VGV4dChwcm9ncmFtYWNhbykKCWV4Y2VwdDoKCQlwYXNzCgpkZWYgYWJyaXJfdXJsKHVybCwgcG9zdD1Ob25lLCBoZWFkZXI9Tm9uZSwgY29kZT1GYWxzZSwgZXJybz1GYWxzZSwgY29va2llPU5vbmUpOgoJaWYgaGVhZGVyID09IE5vbmU6CgkJaGVhZGVyID0gaGVhZGVycwoJaWYgY29va2llOgoJCWhlYWRlclsnQ29va2llJ10gPSBjb29raWUKCQoJaWYgcG9zdDoKCQloZWFkZXJbJ0NvbnRlbnQtVHlwZSddID0nYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJwoJCXJlcSA9IHVybGxpYjIuUmVxdWVzdCh1cmwsIGRhdGE9cG9zdCwgaGVhZGVycz1oZWFkZXIpCgllbHNlOgoJCXJlcSA9IHVybGxpYjIuUmVxdWVzdCh1cmwsIGhlYWRlcnM9aGVhZGVyKQoJdHJ5OgoJCXJlc3BvbnNlID0gdXJsbGliMi51cmxvcGVuKHJlcSxjb250ZXh0PWNvbnRleHQpCglleGNlcHQ6CgkJdHJ5OgoJCQlyZXNwb25zZSA9IHVybGxpYjIudXJsb3BlbihyZXEpCgkJZXhjZXB0IHVybGxpYjIuSFRUUEVycm9yIGFzIHJlc3BvbnNlOgoJCQlpZiBlcnJvID09IFRydWU6CgkJCQlyZXR1cm4gc3RyKHJlc3BvbnNlLmNvZGUpLCAiYXNkIgoJbGluaz1yZXNwb25zZS5yZWFkKCkKCQoJaWYgJ2p1ZGljaWFsIGJsYmxibGJsYmwnIGluIGxpbms6CgkJcmV0dXJuICdETlMnCglpZiBjb2RlOgoJCXJldHVybiBzdHIocmVzcG9uc2UuY29kZSksIGxpbmsKCglyZXNwb25zZS5jbG9zZSgpCglyZXR1cm4gbGluawoKZGVmIGFkZExpbmsyKG5hbWUsdXJsLGljb25pbWFnZSk6Cglvaz1UcnVlCglsaXogPSB4Ym1jZ3VpLkxpc3RJdGVtKG5hbWUsIGljb25JbWFnZT1pY29uaW1hZ2UsIHRodW1ibmFpbEltYWdlPWljb25pbWFnZSkKCWxpei5zZXRQcm9wZXJ0eSgnZmFuYXJ0X2ltYWdlJywgaWNvbmltYWdlKQoJbGl6LnNldEFydCh7J2ZhbmFydCc6IGljb25pbWFnZX0pCglsaXouc2V0SW5mbyggdHlwZT0iVmlkZW8iLCBpbmZvTGFiZWxzPXsgIlRpdGxlIjogbmFtZSB9KQoJbGl6LnNldFByb3BlcnR5KCdJc1BsYXlhYmxlJywgJ3RydWUnKQoJdSA9IHN5cy5hcmd2WzBdICsgIj91cmw9IiArIHVybCArICImbW9kZT0xMDYmbmFtZT0iICsgbmFtZSArICImaWNvbmltYWdlPSIgKyBpY29uaW1hZ2UKCW9rPXhibWNwbHVnaW4uYWRkRGlyZWN0b3J5SXRlbShoYW5kbGU9aW50KHN5cy5hcmd2WzFdKSwgdXJsPXUsIGxpc3RpdGVtPWxpeikKCXJldHVybiBvawoKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMJCQkJCQkJICBERUZJTklOQ09FUwkJCQkJCQkJCQkgICMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMJCgpkZWYgdmlzdGFfR3J1cG9zKCk6CglvcGNhbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCdjYW5haXNWaWV3JykKCWlmIG9wY2FvID09ICcwJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwKSIpCgllbGlmIG9wY2FvID09ICcxJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUxKSIpCgllbGlmIG9wY2FvID09ICcyJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwMCkiKQoJZWxpZiBvcGNhbyA9PSAnMyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDkpIikKCWVsaWYgb3BjYW8gPT0gJzMnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA4KSIpCgllbGlmIG9wY2FvID09ICc0JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwNCkiKQoJZWxpZiBvcGNhbyA9PSAnNSc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDMpIikKCWVsaWYgb3BjYW8gPT0gJzYnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTE1KSIpCgllbGlmIG9wY2FvID09ICc3JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDU1KSIpCgpkZWYgdmlzdGFfQ2FuYWlzKCk6CglvcGNhbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCdjYW5haXNWaWV3MicpCglpZiBvcGNhbyA9PSAnMCc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MCkiKQoJZWxpZiBvcGNhbyA9PSAnMSc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MSkiKQoJZWxpZiBvcGNhbyA9PSAnMic6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDApIikKCWVsaWYgb3BjYW8gPT0gJzMnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA5KSIpCgllbGlmIG9wY2FvID09ICczJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwOCkiKQoJZWxpZiBvcGNhbyA9PSAnNCc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDQpIikKCWVsaWYgb3BjYW8gPT0gJzUnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTAzKSIpCgllbGlmIG9wY2FvID09ICc2JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUxNSkiKQoJZWxpZiBvcGNhbyA9PSAnNyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1NSkiKQoKZGVmIHZpc3RhX21lbnUoKToKCW9wY2FvID0gX19BRERPTl9fLmdldFNldHRpbmcoJ21lbnVWaWV3JykKCWlmIG9wY2FvID09ICcwJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwKSIpCgllbGlmIG9wY2FvID09ICcxJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUxKSIpCgllbGlmIG9wY2FvID09ICcyJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwMCkiKQoJZWxpZiBvcGNhbyA9PSAnMyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDkpIikKCWVsaWYgb3BjYW8gPT0gJzMnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA4KSIpCgllbGlmIG9wY2FvID09ICc0JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwNCkiKQoJZWxpZiBvcGNhbyA9PSAnNSc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDMpIikKCWVsaWYgb3BjYW8gPT0gJzYnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTE1KSIpCgllbGlmIG9wY2FvID09ICc3JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDU1KSIpCgpkZWYgdmlzdGFfZmlsbWVzU2VyaWVzKCk6CglvcGNhbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCdmaWxtZXNTZXJpZXNWaWV3JykKCWlmIG9wY2FvID09ICcwJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwKSIpCgllbGlmIG9wY2FvID09ICcxJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUxKSIpCgllbGlmIG9wY2FvID09ICcyJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwMCkiKQoJZWxpZiBvcGNhbyA9PSAnMyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDkpIikKCWVsaWYgb3BjYW8gPT0gJzMnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA4KSIpCgllbGlmIG9wY2FvID09ICc0JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwNCkiKQoJZWxpZiBvcGNhbyA9PSAnNSc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDMpIikKCWVsaWYgb3BjYW8gPT0gJzYnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTE1KSIpCgllbGlmIG9wY2FvID09ICc3JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDU1KSIpCgoKZGVmIHZpc3RhX3RlbXBvcmFkYXMoKToKCW9wY2FvID0gX19BRERPTl9fLmdldFNldHRpbmcoJ3RlbXBvcmFkYXNWaWV3JykKCWlmIG9wY2FvID09ICcwJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwKSIpCgllbGlmIG9wY2FvID09ICcxJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUxKSIpCgllbGlmIG9wY2FvID09ICcyJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwMCkiKQoJZWxpZiBvcGNhbyA9PSAnMyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDkpIikKCWVsaWYgb3BjYW8gPT0gJzMnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA4KSIpCgllbGlmIG9wY2FvID09ICc0JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwNCkiKQoJZWxpZiBvcGNhbyA9PSAnNSc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDMpIikKCWVsaWYgb3BjYW8gPT0gJzYnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTE1KSIpCgllbGlmIG9wY2FvID09ICc3JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDU1KSIpCgpkZWYgdmlzdGFfZXBpc29kaW9zKCk6CgkjeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwKSIpCglvcGNhbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCdlcGlzb2Rpb3NWaWV3JykKCWlmIG9wY2FvID09ICcwJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwKSIpCgllbGlmIG9wY2FvID09ICcxJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUxKSIpCgllbGlmIG9wY2FvID09ICcyJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwMCkiKQoJZWxpZiBvcGNhbyA9PSAnMyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDkpIikKCWVsaWYgb3BjYW8gPT0gJzMnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA4KSIpCgllbGlmIG9wY2FvID09ICc0JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwNCkiKQoJZWxpZiBvcGNhbyA9PSAnNSc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDMpIikKCWVsaWYgb3BjYW8gPT0gJzYnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTE1KSIpCgllbGlmIG9wY2FvID09ICc3JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDU1KSIpCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCQkJCQkJCQkJCQkJR0VUIFBBUkFNUwkJCQkJCQkJCQkJCSAjCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwkJICAKZGVmIGdldF9wYXJhbXMoKToKCXBhcmFtPVtdCglwYXJhbXN0cmluZz1zeXMuYXJndlsyXQoJaWYgbGVuKHBhcmFtc3RyaW5nKT49MjoKCQlwYXJhbXM9c3lzLmFyZ3ZbMl0KCQljbGVhbmVkcGFyYW1zPXBhcmFtcy5yZXBsYWNlKCc/JywnJykKCQlpZiAocGFyYW1zW2xlbihwYXJhbXMpLTFdPT0nLycpOiBwYXJhbXM9cGFyYW1zWzA6bGVuKHBhcmFtcyktMl0KCQlwYWlyc29mcGFyYW1zPWNsZWFuZWRwYXJhbXMuc3BsaXQoJyYnKQoJCXBhcmFtPXt9CgkJZm9yIGkgaW4gcmFuZ2UobGVuKHBhaXJzb2ZwYXJhbXMpKToKCQkJc3BsaXRwYXJhbXM9e30KCQkJc3BsaXRwYXJhbXM9cGFpcnNvZnBhcmFtc1tpXS5zcGxpdCgnPScpCgkJCWlmIChsZW4oc3BsaXRwYXJhbXMpKT09MjogcGFyYW1bc3BsaXRwYXJhbXNbMF1dPXNwbGl0cGFyYW1zWzFdCglyZXR1cm4gcGFyYW0KCgpwYXJhbXM9Z2V0X3BhcmFtcygpCnVybD1Ob25lCmJ1aWxkdGlwbz1Ob25lCm5hbWU9Tm9uZQptb2RlPU5vbmUKbW9kbz1Ob25lCmljb25pbWFnZT1Ob25lCmxpbms9Tm9uZQpzZW5oYT1Ob25lCmVzdGlsbz1Ob25lCnNydGZpbG09Tm9uZQppZENhbmFsPU5vbmUKaWRmZkNhbmFsPU5vbmUKdGlwb2xvZ2lhPU5vbmUKZGVzY3JpY2FvPU5vbmUKdGlwb191c2VyPU5vbmUKc2Vydmlkb3JfdXNlcj1Ob25lCmRhdGFfdXNlcj1Ob25lCnNfc2Vydj1Ob25lCnRpcG89Tm9uZQpzX3VzZXI9Tm9uZQpzX3Bhc3M9Tm9uZQpsZWdlbmRhPU5vbmUKcGFnaW5hPU5vbmUKdGVtcG9yYWRhPU5vbmUKZXBpc29kaW89Tm9uZQpzZXJpZU5vbWU9Tm9uZQpmYW5hcnQ9Tm9uZQp0aHVtYm5haWw9Tm9uZQpzdHJlYW1faWQ9Tm9uZQpkdXJhdGlvbj1Ob25lCnRpcG9zZWxlY3Q9Tm9uZQpiYWNrZ3JvdW5kPU5vbmUKaW5mbz1Ob25lCmxvZ29zPU5vbmUKY2FjaGU9Tm9uZQppbmRleD1Ob25lCm1vdmU9Tm9uZQptZXRhaD1Ob25lCnBsb3Q9Tm9uZQoKdHJ5OiAKCWxvZ29zPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJsb2dvcyJdKQpleGNlcHQ6IAoJcGFyYW1zID0gZGljdCh1cmxwYXJzZS5wYXJzZV9xc2woc3lzLmFyZ3ZbMl0ucmVwbGFjZSgnPycsJycpKSkKCWxvZ29zID0gcGFyYW1zLmdldCgnbG9nb3MnLCAnJykKCnRyeTogCgljYWNoZT11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1siY2FjaGUiXSkKZXhjZXB0OiAKCXBhcmFtcyA9IGRpY3QodXJscGFyc2UucGFyc2VfcXNsKHN5cy5hcmd2WzJdLnJlcGxhY2UoJz8nLCcnKSkpCgljYWNoZSA9IHBhcmFtcy5nZXQoJ2NhY2hlJywgJycpCgp0cnk6IAoJaW5kZXg9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImluZGV4Il0pCmV4Y2VwdDogCglwYXJhbXMgPSBkaWN0KHVybHBhcnNlLnBhcnNlX3FzbChzeXMuYXJndlsyXS5yZXBsYWNlKCc/JywnJykpKQoJaW5kZXggPSBwYXJhbXMuZ2V0KCdpbmRleCcsICcnKQoKdHJ5OiAKCW1vdmU9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbIm1vdmUiXSkKZXhjZXB0OiAKCXBhcmFtcyA9IGRpY3QodXJscGFyc2UucGFyc2VfcXNsKHN5cy5hcmd2WzJdLnJlcGxhY2UoJz8nLCcnKSkpCgltb3ZlID0gcGFyYW1zLmdldCgnbW92ZScsICcnKQoKdHJ5OiAKCW1ldGFoPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJtZXRhaCJdKQpleGNlcHQ6IAoJcGFyYW1zID0gZGljdCh1cmxwYXJzZS5wYXJzZV9xc2woc3lzLmFyZ3ZbMl0ucmVwbGFjZSgnPycsJycpKSkKCW1ldGFoID0gcGFyYW1zLmdldCgnbWV0YWgnLCAnJykKCnRyeTogCgliYWNrZ3JvdW5kPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJiYWNrZ3JvdW5kIl0pCmV4Y2VwdDogCglwYXJhbXMgPSBkaWN0KHVybHBhcnNlLnBhcnNlX3FzbChzeXMuYXJndlsyXS5yZXBsYWNlKCc/JywnJykpKQoJYmFja2dyb3VuZCA9IHBhcmFtcy5nZXQoJ2JhY2tncm91bmQnLCAnJykKCnRyeTogCglpbmZvPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJpbmZvIl0pCmV4Y2VwdDogCglwYXJhbXMgPSBkaWN0KHVybHBhcnNlLnBhcnNlX3FzbChzeXMuYXJndlsyXS5yZXBsYWNlKCc/JywnJykpKQoJaW5mbyA9IHBhcmFtcy5nZXQoJ2luZm8nLCAnJykKCnRyeTogdGlwbz1wYXJhbXNbInRpcG8iXQpleGNlcHQ6IHBhc3MKdHJ5OiBkdXJhdGlvbj11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1siZHVyYXRpb24iXSkKZXhjZXB0OiBwYXNzCnRyeTogc3RyZWFtX2lkPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJzdHJlYW1faWQiXSkKZXhjZXB0OiBwYXNzCnRyeTogdXJsPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJ1cmwiXSkKZXhjZXB0OiBwYXNzCnRyeTogbmFtZT11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sibmFtZSJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBlc3RpbG89dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImVzdGlsbyJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBtb2RlPWludChwYXJhbXNbIm1vZGUiXSkKZXhjZXB0OiBwYXNzCnRyeTogbW9kbz1wYXJhbXNbIm1vZG8iXQpleGNlcHQ6IHBhc3MKdHJ5OiBpY29uaW1hZ2U9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImljb25pbWFnZSJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBzZW5oYT11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sic2VuaGEiXSkKZXhjZXB0OiBwYXNzCnRyeTogaWRDYW5hbD11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1siaWRDYW5hbCJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBpZGZmQ2FuYWw9cGFyYW1zWyJpZGZmQ2FuYWwiXQpleGNlcHQ6IHBhc3MKdHJ5OiBzcnRmaWxtPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJzcnRmaWxtIl0pCmV4Y2VwdDogcGFzcwp0cnk6IHRpcG9sb2dpYT11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sidGlwb2xvZ2lhIl0pCmV4Y2VwdDogcGFzcwp0cnk6IGRlc2NyaWNhbz11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1siZGVzY3JpY2FvIl0pCmV4Y2VwdDogcGFzcwp0cnk6IHRpcG9fdXNlcj11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sidGlwb191c2VyIl0pCmV4Y2VwdDogcGFzcwp0cnk6IHNlcnZpZG9yX3VzZXI9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbInNlcnZpZG9yX3VzZXIiXSkKZXhjZXB0OiBwYXNzCnRyeTogc19zZXJ2PXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJsb2xzZXJ2Il0pCmV4Y2VwdDogcGFzcwp0cnk6IHNfdXNlcj11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sibG9sdXNlciJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBzX3Bhc3M9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImxvbHBhc3MiXSkKZXhjZXB0OiBwYXNzCnRyeTogbGluaz11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sibGluayJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBsZWdlbmRhPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJsZWdlbmRhIl0pCmV4Y2VwdDogcGFzcwp0cnk6IG5hbWU9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbIm5hbWUiXSkKZXhjZXB0OiBwYXNzCnRyeTogdGVtcG9yYWRhPWludChwYXJhbXNbInRlbXBvcmFkYSJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBlcGlzb2Rpbz1pbnQocGFyYW1zWyJlcGlzb2RpbyJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBtb2RlPWludChwYXJhbXNbIm1vZGUiXSkKZXhjZXB0OiBwYXNzCnRyeTogcGFnaW5hPWludChwYXJhbXNbInBhZ2luYSJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBpY29uaW1hZ2U9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImljb25pbWFnZSJdKQpleGNlcHQ6IHBhc3MKdHJ5IDogc2VyaWVOb21lPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJzZXJpZU5vbWUiXSkKZXhjZXB0OiBwYXNzCnRyeSA6IGJ1aWxkdGlwbz11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1siYnVpbGR0aXBvIl0pCmV4Y2VwdDogcGFzcwp0cnkgOiBmYW5hcnQ9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImZhbmFydCJdKQpleGNlcHQ6IHBhc3MKdHJ5IDogcGxvdD11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sicGxvdCJdKQpleGNlcHQ6IHBhc3MKdHJ5IDogdGh1bWJuYWlsPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJ0aHVtYm5haWwiXSkKZXhjZXB0OiBwYXNzCnRyeSA6IGRhdGFfdXNlcj11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1siZGF0YV91c2VyIl0pCmV4Y2VwdDogcGFzcwp0cnkgOiB0aXBvc2VsZWN0PXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJ0aXBvc2VsZWN0Il0pCmV4Y2VwdDogcGFzcwoKCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwkJCQkJCQkJCQkJCQlNT0RPUwkJCQkJCQkJCQkJCQkgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKaWYgbW9kZT09Tm9uZSBvciB1cmw9PU5vbmUgb3IgbGVuKHVybCk8MTogbWVudSgpCmVsaWYgbW9kZT09MTogYWJyaXJWaWRlb0NsdWJlKHN0cih1cmwpKQplbGlmIG1vZGU9PTEwMTogbGlzdGFyX2dydXBvczEobW9kZSx1cmwsZmFuYXJ0KQplbGlmIG1vZGU9PTEwMjogbGlzdGFyX2dydXBvczIobW9kZSx1cmwsZmFuYXJ0KQplbGlmIG1vZGU9PTEwMzogbGlzdGFyX2dydXBvczMobW9kZSx1cmwsZmFuYXJ0KQplbGlmIG1vZGU9PTEwNDogbGlzdGFyX2dydXBvczQobW9kZSx1cmwsaWNvbmltYWdlLGZhbmFydCkKZWxpZiBtb2RlPT0xMDY6IGFicmlyRXh0cmFzKCkKZWxpZiBtb2RlPT0xMDc6IGxpc3Rhcl9ncnVwb3M1KG1vZGUsdXJsLGZhbmFydCkKZWxpZiBtb2RlPT0xMDg6IGxpc3Rhcl9ncnVwb3M2KG1vZGUsdXJsLGljb25pbWFnZSxmYW5hcnQpCmVsaWYgbW9kZT09MTA5OiBwbGF5X211bHRfY2FuYWwyKHVybCxpY29uaW1hZ2Usc3RyKG5hbWUpKQplbGlmIG1vZGU9PTI6IEFicmlyX0NvbnRhKHN0cih1cmwpKQplbGlmIG1vZGU9PTM6IGFicmltM3Uoc3RyKHVybCkpCmVsaWYgbW9kZT09NDogZGV0ZWN0X21vZGlmaWNhdGlvbihzdHIodXJsKSkKZWxpZiBtb2RlPT01OiBhYnJpckRlZmluaW5jb2VzKCkKZWxpZiBtb2RlPT02OiBsaXN0YXR2YXJjaGl2ZShzdHIodXJsKSkKZWxpZiBtb2RlPT03OiBsaXN0YXR2YXJjaGl2ZWNhbmFpcyhzdHIobmFtZSksc3RyZWFtX2lkLHN0cih1cmwpLGR1cmF0aW9uLGljb25pbWFnZSxmYW5hcnQpCmVsaWYgbW9kZT09ODogc3RyZWFtX3ZpZGVvKG5hbWUsdXJsLGljb25pbWFnZSkKZWxpZiBtb2RlPT05OiBnZXRfbXlhY2NvdW50KG5hbWUsdXJsLGljb25pbWFnZSkKZWxpZiBtb2RlPT0xMDogcnVuX2Nyb25qb2IobmFtZSxzdHIodXJsKSxpY29uaW1hZ2UscGxvdCxmYW5hcnQpCmVsaWYgbW9kZT09MTE6IFBsYXlVcmwobmFtZSx1cmwsaWNvbmltYWdlKQplbGlmIG1vZGU9PTEzOiBDTEVBUkNBQ0hFKCkKZWxpZiBtb2RlPT0xNDogUFVSR0VQQUNLQUdFUygpCmVsaWYgbW9kZT09MjA6IGxpc3RhbWVudXNzZXJpZXMoc3RyKG5hbWUpLHN0cih1cmwpLGVzdGlsbyx0aXBvbG9naWEsdGlwb191c2VyLHNlcnZpZG9yX3VzZXIsaWNvbmltYWdlLGZhbmFydCkKZWxpZiBtb2RlPT0yMTogbGlzdGFtZW51c2ZpbG1lcyhzdHIobmFtZSksc3RyKHVybCksZXN0aWxvLHRpcG9sb2dpYSx0aXBvX3VzZXIsc2Vydmlkb3JfdXNlcixpY29uaW1hZ2UsZmFuYXJ0KQplbGlmIG1vZGU9PTI0OiBsaXN0YW1lbnVzYW5pbWVzKHN0cihuYW1lKSxzdHIodXJsKSxlc3RpbG8sdGlwb2xvZ2lhLHRpcG9fdXNlcixzZXJ2aWRvcl91c2VyLGljb25pbWFnZSxmYW5hcnQpCmVsaWYgbW9kZT09MTExMTE6IGZpbG1lczIodXJsKQplbGlmIG1vZGU9PTExMTEyOiBzZXJpZXMyKHVybCkKZWxpZiBtb2RlPT0xMTExMzogcGxheWVyMihuYW1lLCB1cmwsIGljb25pbWFnZSwgbW9kbywgdGVtcG9yYWRhLCBlcGlzb2RpbywgdGlwbykKZWxpZiBtb2RlPT0xMTExNDogZ2V0U2Vhc29uczIodXJsLCBtb2RvKQplbGlmIG1vZGU9PTExMTE1OiBnZXRFcGlzb2RlczIodXJsKQplbGlmIG1vZGU9PTExMTE4OiBnZXRZZWFyc19saXZlKHVybCwgbW9kbykKZWxpZiBtb2RlPT0xMTExOTogZ2V0R2VuZXJvc19saXZlKHVybCwgbW9kbykKZWxpZiBtb2RlPT0xMTExOTk6IGdldEdlbmVyb3MyX2xpdmUodXJsLCBtb2RvKQplbGlmIG1vZGU9PTExMTIwOiBwZXNxdWlzYV9saXZlKHVybCwgbW9kbykKZWxpZiBtb2RlPT0xMTEyMTogZ2V0SW5mb19saXZlKHVybCwgbW9kbykKZWxpZiBtb2RlPT0yMTExMTogbGlzdGFtZW51c19saXZlaXQxKCkKZWxpZiBtb2RlPT0yMTExMjogbGlzdGFtZW51c19saXZlaXQyKCkKZWxpZiBtb2RlPT0xMTE6IGZpbG1lcyh1cmwsIHBhZ2luYSkKZWxpZiBtb2RlPT0xMjM6IHNlcmllcyh1cmwpCmVsaWYgbW9kZT09MTE4OiBnZXRHZW5lcm9zKHVybCkKZWxpZiBtb2RlPT0xMTk6IGdldFllYXJzKHVybCkKZWxpZiBtb2RlPT0xMjA6IHBlc3F1aXNhKHVybCkKZWxpZiBtb2RlPT0xMjE6IGFub3ModXJsKQplbGlmIG1vZGU9PTEyMjogY2F0ZWdvcmlhcyh1cmwpCmVsaWYgbW9kZT09MTEzOiBwbGF5ZXIobmFtZSwgdXJsLCBpY29uaW1hZ2UsIHRlbXBvcmFkYSwgZXBpc29kaW8sIHNlcmllTm9tZSkKZWxpZiBtb2RlPT0xMTQ6IGdldFNlYXNvbnModXJsKQplbGlmIG1vZGU9PTExNTogZ2V0RXBpc29kZXModXJsKQplbGlmIG1vZGU9PTExNzogZG93bmxvYWQodXJsLCBuYW1lLCB0ZW1wb3JhZGEsIGVwaXNvZGlvLCBzZXJpZU5vbWUpCmVsaWYgbW9kZT09MzE6IHByb2dyYW1hY2FvX2NhbmFsKGlkQ2FuYWwpCmVsaWYgbW9kZSA9PSAzMjoKCVBsYXlVcmwyKG5hbWUsIHVybCwgaWNvbmltYWdlKQoKaWYgbW9kZT09Tm9uZSBvciB1cmw9PU5vbmUgb3IgbGVuKHVybCk8MToKCXhibWNwbHVnaW4uZW5kT2ZEaXJlY3RvcnkoaW50KHN5cy5hcmd2WzFdKSxjYWNoZVRvRGlzYz1GYWxzZSkKZWxzZToKCWlmIG1vZGUgIT0zIGFuZCBtb2RlICE9NiBhbmQgbW9kZSAhPTc6IAoJCXhibWNwbHVnaW4uZW5kT2ZEaXJlY3RvcnkoaW50KHN5cy5hcmd2WzFdKSxjYWNoZVRvRGlzYz1GYWxzZSkKCWVsc2U6IAoJCXhibWNwbHVnaW4uZW5kT2ZEaXJlY3RvcnkoaW50KHN5cy5hcmd2WzFdKSxjYWNoZVRvRGlzYz1UcnVlKQ=="))