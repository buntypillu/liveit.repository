exec("import re;import base64");exec(base64.b64decode("IyMjIyMjIyMjIyMjIyNCSUJMSU9URUNBUyBBIElNUE9SVEFSIEUgREVGSU5JQ09FUyMjIyMjIyMjIyMjIyMjIyMjIyMjCmltcG9ydCB1cmxsaWIsdXJsbGliMixzeXMscmUseGJtY3BsdWdpbix4Ym1jZ3VpLHhibWNhZGRvbix4Ym1jLG9zLGpzb24sZ2xvYix0aHJlYWRpbmcsZ3ppcCx4Ym1jdmZzLGNvb2tpZWxpYixwcHJpbnQsZGF0ZXRpbWUsdGhyZWFkLHRpbWUsdXJscGFyc2UsYmFzZTY0LHBsdWdpbnRvb2xzLGNhbGVuZGFyCmltcG9ydCB4bWwuZXRyZWUuRWxlbWVudFRyZWUgYXMgRVQKaW1wb3J0IGZpbGVVdGlscyBhcyBmdQppbXBvcnQgYXN0CmZyb20gcmVzb3VyY2VzLmxpYiBpbXBvcnQgY29tbW9uCmZyb20gdXJsbGliMiBpbXBvcnQgUmVxdWVzdCwgdXJsb3Blbgpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRlCmZyb20gYnM0IGltcG9ydCBCZWF1dGlmdWxTb3VwCmZyb20gcmVzb3VyY2VzLmxpYiBpbXBvcnQgRG93bmxvYWRlciAjRW5lbjkyIGNsYXNzCmZyb20gcmVzb3VyY2VzLmxpYiBpbXBvcnQgUGxheWVyCmZyb20gcmVzb3VyY2VzLmxpYiBpbXBvcnQgVFZBcmNoaXZlCmZyb20gdDBtbTAuY29tbW9uLm5ldCBpbXBvcnQgTmV0CmZyb20gdDBtbTAuY29tbW9uLmFkZG9uIGltcG9ydCBBZGRvbgpmcm9tIHQwbW0wLmNvbW1vbi5uZXQgaW1wb3J0IEh0dHBSZXNwb25zZQpmcm9tIHJlc291cmNlcy5saWIgaW1wb3J0IFVSTFJlc29sdmVyTWVkaWEKZnJvbSByZXNvdXJjZXMubGliIGltcG9ydCBUcmFrdApmcm9tIHJlc291cmNlcy5saWIgaW1wb3J0IERhdGFiYXNlCmZyb20gdW5pY29kZWRhdGEgaW1wb3J0IG5vcm1hbGl6ZQp0cnk6CiAgICBpbXBvcnQgc3NsCiAgICBjb250ZXh0ID0gc3NsLlNTTENvbnRleHQoc3NsLlBST1RPQ09MX1RMU3YxKQpleGNlcHQ6CiAgICBwYXNzCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMgQ09OU1RBTlRFUyAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZ2xvYmFsIGdfdGltZXIKZ2xvYmFsIHRlbGV2aXNpb29uaWxpbmsKZ2xvYmFsIGZpbG1pbGluawpnbG9iYWwgYW5kbWVsaW5rCmdsb2JhbCB1dWVuZHVzbGluawpnbG9iYWwgdXVlbmR1c2VkCmdsb2JhbCB2YW5lbWFsdWtrCmdsb2JhbCB2ZXJzaW9uCmdsb2JhbCBtb2RlCgpyZWxvYWQoc3lzKQpzeXMuc2V0ZGVmYXVsdGVuY29kaW5nKCd1dGY4JykKbW9kZSA9IDMzMzMKdmVyc2lvbiA9ICIiCmthc3V0YWphbmltaSA9ICIiCnNhbGFzb25hID0gIiIKbGVoZWt5bGcgPSAiIgp2YW5lbWFrb29kID0gIiIKdmFuZW1hbHVrayA9ICIiCnRlbGV2aXNpb29uaWxpbmsgPSAiIgpmaWxtaWxpbmsgPSAiIgphbmRtZWxpbmsgPSAiIgoKX0xJSUxMXyA9ICJhSFIwY0RvdkwyeHBkbVZwZEd0dlpHa3VZMjl0TDFCSVVDOTJZV3hwWkdGMFpVRlFVQzV3YUhBPSIKX0xJSUxMXzIgPSAiYUhSMGNEb3ZMMnhwZG1WcGRHdHZaR2t1WTI5dEwxQklVQzlzYVhabGFYUXZiRzluYVc1QlVGQXVjR2h3IgpfX0FERE9OX0lEX18JPSB4Ym1jYWRkb24uQWRkb24oKS5nZXRBZGRvbkluZm8oImlkIikKX19BRERPTl9fCT0geGJtY2FkZG9uLkFkZG9uKF9fQURET05fSURfXykKX19BRERPTlZFUlNJT05fXyA9IF9fQURET05fXy5nZXRBZGRvbkluZm8oJ3ZlcnNpb24nKQpBZGRvblRpdGxlID0gX19BRERPTl9fLmdldEFkZG9uSW5mbygnbmFtZScpCkROU19ERUZJTkUgPSAnJwpfX0FERE9OX0ZPTERFUl9fCT0gX19BRERPTl9fLmdldEFkZG9uSW5mbygncGF0aCcpCl9fU0VUVElOR19fCT0geGJtY2FkZG9uLkFkZG9uKCkuZ2V0U2V0dGluZwpfX0FSVF9GT0xERVJfXwk9IF9fQURET05fRk9MREVSX18gKyAnL3Jlc291cmNlcy9pbWcvJwpfX1NLSU5fXyA9ICd2MicKX19RdWFsaWRhZGVfXyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCdxdWFsaWRhZGVGaWxtZXMnKQpfX0ZBTkFSVF9fID0gb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvLnBuZycpCl9fUEFTVEFfREFET1NfXyA9IEFkZG9uKF9fQURET05fSURfXykuZ2V0X3Byb2ZpbGUoKS5kZWNvZGUoInV0Zi04IikKX19BUElfXyA9IGJhc2U2NC51cmxzYWZlX2I2NGRlY29kZSgnYUhSMGNEb3ZMMjF3WVhCcExtMXNMdz09JykKX19BUElfU0lURV9fID0gYmFzZTY0LnVybHNhZmVfYjY0ZGVjb2RlKCdhSFIwY0RvdkwyMXdZWEJwTG0xc0wyRndhVzVsZHk4PScpCl9fU0lURV9fID0gYmFzZTY0LnVybHNhZmVfYjY0ZGVjb2RlKCdhSFIwY0RvdkwyMXljR2x5WVdONUxtZHhMdz09JykKX19GT0xERVJfRVBHX18gPSBvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdlcGdsaXZlbm93JykKX19DT09LSUVfRklMRV9fID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnbGl2ZW5vdycpCl9fU0lURUFkZG9uX18gPSBiYXNlNjQudXJsc2FmZV9iNjRkZWNvZGUoJ2FIUjBjRG92TDNkM2R5NXdZM1JsWTJ0elpYSjJMbU52YlM5SGNuVndiMHR2WkdrdlFXUmtiMjR2JykKX19TSVRFQkRfXyA9IGJhc2U2NC51cmxzYWZlX2I2NGRlY29kZSgnYUhSMGNEb3ZMM2QzZHk1d1kzUmxZMnR6WlhKMkxtTnZiUzlIY25Wd2IwdHZaR2t2VUVoUUx3PT0nKQpfSUNPTl8gPSBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvbi5wbmcnKQpfX0hFQURFUlNfXyA9IHsnVXNlci1BZ2VudCc6ICdNb3ppbGxhLzUuMCAoTWFjaW50b3NoOyBJbnRlbCBNYWMgT1MgWCAxMC4xMTsgcnY6NDMuMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC80My4wJywgJ0FjY2VwdCc6ICd0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSwqLyo7cT0wLjgnfQpoZWFkZXJzID0geydVc2VyLUFnZW50JzogJ01vemlsbGEvNS4wIChNYWNpbnRvc2g7IEludGVsIE1hYyBPUyBYIDEwLjExOyBydjo0My4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzQzLjAnLCAnQWNjZXB0LUNoYXJzZXQnOiAndXRmLTg7cT0wLjcsKjtxPTAuNycsICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbid9CgpDYXQgPSBfX0FERE9OX18uZ2V0U2V0dGluZygiQ2F0IikKCmRlZiBzZXRWaWV3UygpOgoJeGJtY3BsdWdpbi5zZXRDb250ZW50KGludChzeXMuYXJndlsxXSksICd0dnNob3dzJykKZGVmIHNldFZpZXdNKCk6Cgl4Ym1jcGx1Z2luLnNldENvbnRlbnQoaW50KHN5cy5hcmd2WzFdKSwgJ21vdmllcycpCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCQkJCQkJCSAgSW5pY2lhciBBZGRvbgkJCQkJCQkJCQkgICMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCmRlZiBfX0FMRVJUQV9fKHRleHQxPSIiLHRleHQyPSIiLHRleHQzPSIiKToKCWlmIHRleHQzPT0iIjogeGJtY2d1aS5EaWFsb2coKS5vayh0ZXh0MSx0ZXh0MikKCWVsaWYgdGV4dDI9PSIiOiB4Ym1jZ3VpLkRpYWxvZygpLm9rKCIiLHRleHQxKQoJZWxzZTogeGJtY2d1aS5EaWFsb2coKS5vayh0ZXh0MSx0ZXh0Mix0ZXh0MykKCmRlZiBjcmlhck1lbnUocGFpLG5vbWUsbG9nbyx1cmwsdGlwbyxmYW5hcnQpOgoJbWVudXMgPSB7CgkJCSdub21lJzogJycsCgkJCSdsb2dvJzogJycsCgkJCSd1cmwnOiAnJywKCQkJJ3RpcG8nOiAnJywKCQkJJ2ZhbmFydCc6ICcnCgkJCX0KCW1lbnVzWydub21lJ10gPSBub21lCgltZW51c1snbG9nbyddID0gbG9nbwoJbWVudXNbJ3VybCddID0gdXJsCgltZW51c1sndGlwbyddID0gdGlwbwoJbWVudXNbJ2ZhbmFydCddID0gZmFuYXJ0CglwYWkuYXBwZW5kKG1lbnVzKQoJCmRlZiBtZW51KCk6CglpZiAobm90IF9fQURET05fXy5nZXRTZXR0aW5nKCdsb2dpbl9uYW1lJykgb3Igbm90IF9fQURET05fXy5nZXRTZXR0aW5nKCdsb2dpbl9wYXNzd29yZCcpKToKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdQcmVjaXNhIGRlIGRlZmluaXIgbyBzZXUgVXRpbGl6YWRvciBlIFNlbmhhJykKCQlhYnJpckRlZmluaW5jb2VzKCkKCQkKCWVsc2U6CQoJCWNoZWNrX2xvZ2luMiA9IGxvZ2lucGFpbmVsKCkKCQlpZiBjaGVja19sb2dpbjJbJ3VzZXInXVsnRXJybyddICE9ICcnOgoJCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsIGNoZWNrX2xvZ2luMlsndXNlciddWydFcnJvJ10pCgkJZWxzZToKCQkJX0xJSUxMXyA9IGNoZWNrX2xvZ2luMlsndXNlciddWydETlMnXQoJCQljaGVja19sb2dpbiA9IGxvZ2luTGl2ZWl0KF9MSUlMTF8pCgkJCSNjaGVja19sb2dpbiA9IGxvZ2luKF9MSUlMTF8pCgkJCWlmIGNoZWNrX2xvZ2luWyd1c2VyJ11bJ3Jlc3VsdGFkbyddID09ICd5ZXMnOgoJCQkJaWYgY2hlY2tfbG9naW5bJ3VzZXInXVsnZXN0YWRvJ10gPT0gJ0luYWN0aXZvJzoKCQkJCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdBIHN1YSBjb250YSBlc3TDoSBFeHBpcmFkYS4gUG9yIGZhdm9yIGZhw6dhIGEgc3VhIFJlbm92YcOnw6NvIG91IFJlYWN0aXZhw6fDo28uJykJCQoJCQkJZWxzZToKCQkJCQlpZiBjaGVja19sb2dpblsndXNlciddWyd0cmlhbCddID09ICdUZXN0ZSc6CgkJCQkJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0EgY29udGEgw6kgdW1hIGNvbnRhIGRlIFRlc3RlLiBBcMOzcyBvIHRlc3RlIGUgZ29zdGFyIGZhw6dhIGEgc3VhIEFxdWlzacOnw6NvLicpCgkJCQkJaWYgY2hlY2tfbG9naW5bJ3VzZXInXVsnZGF0YSddID09ICcwJyBhbmQgY2hlY2tfbG9naW5bJ3VzZXInXVsndHJpYWwnXSAhPSAnVGVzdGUnOgoJCQkJCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdBIHN1YSBjb250YSBleHBpcmEgSG9qZS4gRmHDp2EgasOhIGEgc3VhIFJlbm92YcOnw6NvLicpCgkJCQkJZWxzZToKCQkJCQkJaWYgY2hlY2tfbG9naW5bJ3VzZXInXVsnZGlhcyddID09ICc1JyBvciBjaGVja19sb2dpblsndXNlciddWydkaWFzJ10gPT0gJzQnIG9yIGNoZWNrX2xvZ2luWyd1c2VyJ11bJ2RpYXMnXSA9PSAnMycgb3IgY2hlY2tfbG9naW5bJ3VzZXInXVsnZGlhcyddID09ICcyJyBvciBjaGVja19sb2dpblsndXNlciddWydkaWFzJ10gPT0gJzEnOgoJCQkJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnQSBzdWEgY29udGEgZXhwaXJhIGRhcXVpIGEgJytzdHIoY2hlY2tfbG9naW5bJ3VzZXInXVsnZGF0YSddKSsgJyBkaWFzLiBGYcOnYSBqw6EgYSBzdWEgUmVub3Zhw6fDo28uJykKCQkJCQljcmlhck1lbnUoY2hlY2tfbG9naW5bJ21lbnVzJ10sIk1pbmhhIENvbnRhIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX2Nvbi5wbmcnKSxfTElJTExfLCJjb250YSIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2Nvbi5wbmcnKSkKCQkJCQljcmlhck1lbnUoY2hlY2tfbG9naW5bJ21lbnVzJ10sIlZlciBUViIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb190di5wbmcnKSxfTElJTExfLCJ0diIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3R2LnBuZycpKQoJCQkJCWNyaWFyTWVudShjaGVja19sb2dpblsnbWVudXMnXSwiVsOtZGVvIENsdWJlIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX3ZpZC5wbmcnKSxfTElJTExfLCJmaWxtZXMiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb192aWQucG5nJykpCgkJCQkJY3JpYXJNZW51KGNoZWNrX2xvZ2luWydtZW51cyddLCJUViBBcmNoaXZlIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX3R2X2FyYy5wbmcnKSxfTElJTExfLCJ0dmFyY2hpdmUiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb190dl9hcmMucG5nJykpCgkJCQkJCgkJCQkJZmlsbWVzX2FwcCA9IGNoZWNrX2xvZ2luMlsndXNlciddWydGaWxtZXNfYXBwJ107CgkJCQkJY3JpYXJNZW51KGNoZWNrX2xvZ2luWydtZW51cyddLCJFeHRyYXMiLF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJBZGRvbi9JbWFnZW5zL25vdmlkYWRlc3R2LnBuZyIsImV4dHJhcyIsImV4dHJhcyIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3R2X2FyYy5wbmcnKSkKCQkJCQljcmlhck1lbnUoY2hlY2tfbG9naW5bJ21lbnVzJ10sIkNvbmZpZ3VyYcOnw7VlcyIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb19kZWYucG5nJyksImNvbmZpZ3VyYXIiLCJjb25maWd1cmFyIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fZGVmLnBuZycpKQoJCQkJCWNyaWFyTWVudShjaGVja19sb2dpblsnbWVudXMnXSwiTGltcGFyIENhY2hlIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX2xpbS5wbmcnKSwibGltcGFyY2FjaGUiLCJsaW1wYXJjYWNoZSIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2xpbS5wbmcnKSkKCQkJCQljcmlhck1lbnUoY2hlY2tfbG9naW5bJ21lbnVzJ10sIkxpbXBhciBUdWRvIEdyYXZhZG8iLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fbGltLnBuZycpLCJsaW1wYXJ0dWRvIiwibGltcGFydHVkbyIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2xpbS5wbmcnKSkKCQkJCQlpZihjaGVja19sb2dpbjJbJ3VzZXInXVsnRW1haWwnXSAhPSAnJyBhbmQgY2hlY2tfbG9naW4yWyd1c2VyJ11bJ0VtYWlsJ10gIT0gJ2VtYWlsJyk6CgkJCQkJCWFkZExpbmtDYW5hbExpc3RhKCJbQ09MT1IgPSB3aGl0ZV1FbWFpbCBEw7p2aWRhczogWy9DT0xPUl0iK2NoZWNrX2xvZ2luMlsndXNlciddWydFbWFpbCddLCIiLCIiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fY29uLnBuZycpLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19jb24ucG5nJyksJycpCgkJCQkJaWYoY2hlY2tfbG9naW4yWyd1c2VyJ11bJ1dlYlNpdGUnXSAhPSAnJyBhbmQgY2hlY2tfbG9naW4yWyd1c2VyJ11bJ1dlYlNpdGUnXSAhPSAnaHR0cDovLycpOgoJCQkJCQlhZGRMaW5rQ2FuYWxMaXN0YSgiW0NPTE9SID0gd2hpdGVdQXF1aXNpw6fDo286IFsvQ09MT1JdIitjaGVja19sb2dpbjJbJ3VzZXInXVsnV2ViU2l0ZSddLCIiLCIiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fY29uLnBuZycpLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19jb24ucG5nJyksJycpCgkJCQkJaWYoY2hlY2tfbG9naW4yWyd1c2VyJ11bJ05vdGFzJ10gIT0gJycpOgoJCQkJCQlhZGRMaW5rQ2FuYWxMaXN0YSgiW0NPTE9SID0gd2hpdGVdTm90aWZpY2HDp8OjbzogWy9DT0xPUl0iK2NoZWNrX2xvZ2luMlsndXNlciddWydOb3RhcyddLCIiLCIiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fY29uLnBuZycpLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19jb24ucG5nJyksJycpCgkJCQkJTWVudV9pbmljaWFsKGNoZWNrX2xvZ2luLEZhbHNlLCcnKQoJCQkJX19FUEdfXyA9IF9MSUlMTF8rJ3htbHR2LnBocD91c2VybmFtZT0nK19fQURET05fXy5nZXRTZXR0aW5nKCdsb2dpbl9uYW1lJykrJyZwYXNzd29yZD0nK19fQURET05fXy5nZXRTZXR0aW5nKCdsb2dpbl9wYXNzd29yZCcpKycmZXBnX3NoaWZ0PTAnCgkJCQlfX0FERE9OX18uc2V0U2V0dGluZygnbGlzdGFfZXBnJywgX19FUEdfXykKCQkJCXRocmVhZC5zdGFydF9uZXdfdGhyZWFkKG9idGVyX2ZpY2hlaXJvX2VwZywgKCkgKQoJCQkJdmlzdGFfbWVudSgpCgkJCWVsaWYgY2hlY2tfbG9naW5bJ3VzZXInXVsncmVzdWx0YWRvJ10gPT0gJ3V0aWxpemFkb3InOgoJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVXRpbGl6YWRvciBpbmNvcnJldG8uJykKCQkJCWFkZERpcignQWx0ZXJhciBEZWZpbmnDp8O1ZXMnLCAndXJsJywgTm9uZSwgMTAwMCwgJ01pbmlhdHVyYScsIF9fU0lURUFkZG9uX18rIkltYWdlbnMvZGVmaW5pY29lcy5wbmciLCcnLCcnLCcnLCcnLF9fU0lURUFkZG9uX18rIkltYWdlbnMvZGVmaW5pY29lc19mYW5hcnQucG5nIikKCQkJCWFkZERpcignRW50cmFyIG5vdmFtZW50ZScsICd1cmwnLCBOb25lLCBOb25lLCAnTWluaWF0dXJhJywgX19TSVRFQWRkb25fXysiSW1hZ2Vucy9yZXRyb2NlZGVyLnBuZyIsJycsJycsJycsJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2FkZG9uLnBuZycpKQoJCQkJdmlzdGFfbWVudSgpCgkJCWVsaWYgY2hlY2tfbG9naW5bJ3VzZXInXVsncmVzdWx0YWRvJ10gPT0gJ3NlbmhhJzoKCQkJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1NlbmhhIGluY29ycmV0YS4nKQoJCQkJYWRkRGlyKCdBbHRlcmFyIERlZmluacOnw7VlcycsICd1cmwnLCBOb25lLCAxMDAwLCAnTWluaWF0dXJhJywgX19TSVRFQWRkb25fXysiSW1hZ2Vucy9kZWZpbmljb2VzLnBuZyIsJycsJycsJycsJycsX19TSVRFQWRkb25fXysiSW1hZ2Vucy9kZWZpbmljb2VzX2ZhbmFydC5wbmciKQoJCQkJYWRkRGlyKCdFbnRyYXIgbm92YW1lbnRlJywgJ3VybCcsIE5vbmUsIE5vbmUsICdNaW5pYXR1cmEnLCBfX1NJVEVBZGRvbl9fKyJJbWFnZW5zL3JldHJvY2VkZXIucG5nIiwnJywnJywnJywnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fYWRkb24ucG5nJykpCgkJCQl2aXN0YV9tZW51KCkKCQkJZWxpZiBjaGVja19sb2dpblsndXNlciddWydyZXN1bHRhZG8nXSA9PSAnYXRpdm8nOgoJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnTyBlc3RhZG8gZG8gc2V1IFV0aWxpemFkb3IgZW5jb250cmEtc2UgSW5hY3Rpdm8uIFBhcmEgc2FiZXIgbWFpcyBpbmZvcm1hw6fDtWVzIGVudHJlIGVtIGNvbnRhY3RvIHBlbG8gZW1haWwgbGl2ZWl0a29kaUBnbWFpbC5jb20uJykKCQkJCXZpc3RhX21lbnUoKQoJCQllbHNlOgoJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVXRpbGl6YWRvciBvdSBzZW5oYSBJbmNvcnJlY3Rvcy4gQWx0ZXJlIGUgdGVudGUgbm92YW1lbnRlLicpCgkJCQlhZGREaXIoJ0FsdGVyYXIgRGVmaW5pw6fDtWVzJywgJ3VybCcsIDUsICdNaW5pYXR1cmEnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX2RlZi5wbmcnKSwnJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2RlZi5wbmcnKSkKCQkJCWFkZERpcignRW50cmFyIG5vdmFtZW50ZScsICd1cmwnLCBOb25lLCAnTWluaWF0dXJhJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb19saW0ucG5nJyksJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2xpbS5wbmcnKSkKCQkJCXZpc3RhX21lbnUoKQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwkJCQkJCQkgIExvZ2luIEFkZG9uCQkJCQkJCQkJCSAgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZGVmIGxvZ2lucGFpbmVsKCk6CglpbmZvcm1hY29lcyA9IHsKCQkndXNlcicgOiB7CgkJCSdOb21lJzogJycsCgkJCSdBY2Vzc19Ub2tlbic6ICcnLAoJCQknRE5TJzogJycsCgkJCSdFbWFpbCc6ICcnLAoJCQknV2ViU2l0ZSc6ICcnLAoJCQknVmVyQVBQJzogJycsCgkJCSdMaW5rQVBQJzogJycsCgkJCSdFcnJvJzogJycsCgkJCSdTZXJpZXMnOiAnJywKCQkJJ01lbGhvcmFtZW50b3MnOiAnJywKCQkJJ05vdGFzJzogJycsCgkJCSdDbGllbnRfU2VjcmV0X1VzZXInOiAnJywKCQkJJ0ZpbG1lc19hcHAnOiAnJwoJCX0KCX0KCXRyeToKCQluZXQgPSBOZXQoKQoJCWRhZG9zID0geydub21lX2FwcCc6IEFkZG9uVGl0bGUsICd0aXBvX2FwcCc6ICdBZGRvbicsICd1c2VybmFtZSc6IF9fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9uYW1lIiksICdwYXNzd29yZCc6IF9fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9wYXNzd29yZCIpfQoJCWNvZGlnb19mb250ZSA9IG5ldC5odHRwX1BPU1QoYmFzZTY0LmI2NGRlY29kZShfTElJTExfKSxmb3JtX2RhdGE9ZGFkb3MsaGVhZGVycz1fX0hFQURFUlNfXykuY29udGVudAoJCWVsZW1zID0gRVQuZnJvbXN0cmluZyhjb2RpZ29fZm9udGUpCgkJZm9yIGNoaWxkIGluIGVsZW1zOgoJCQlpZihjaGlsZC50YWcgPT0gJ2Vycm8nKToKCQkJCSNpbmZvcm1hY29lc1sndXNlciddWydFcnJvJ10gPSBjaGlsZC50ZXh0CgkJCQlpbmZvcm1hY29lc1sndXNlciddWydOb21lJ10gPSBBZGRvblRpdGxlCgkJCQlpbmZvcm1hY29lc1sndXNlciddWydBY2Vzc19Ub2tlbiddID0gJycKCQkJCV9fQURET05fXy5zZXRTZXR0aW5nKCdhY2Vzc19Ub2tlbicsICcnKQoJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnRE5TJ10gPSBiYXNlNjQudXJsc2FmZV9iNjRkZWNvZGUoX19BRERPTl9fLmdldFNldHRpbmcoJ2Ruc19hZGRvbicpKQoJCQkJX19FUEdfXyA9IGluZm9ybWFjb2VzWyd1c2VyJ11bJ0ROUyddKyd4bWx0di5waHA/dXNlcm5hbWU9JytfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fbmFtZScpKycmcGFzc3dvcmQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fcGFzc3dvcmQnKSsnJmVwZ19zaGlmdD0wJwoJCQkJX19BRERPTl9fLnNldFNldHRpbmcoJ2xpc3RhX2VwZycsIF9fRVBHX18pCgkJCQlpbmZvcm1hY29lc1sndXNlciddWydFbWFpbCddID0gJycKCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ1dlYlNpdGUnXSA9ICcnCgkJCQlpbmZvcm1hY29lc1sndXNlciddWydWZXJBUFAnXSA9IF9fQURET05WRVJTSU9OX18KCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ0xpbmtBUFAnXSA9ICcnCgkJCQlpbmZvcm1hY29lc1sndXNlciddWydNZWxob3JhbWVudG9zJ10gPSAnJwoJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnTm90YXMnXSA9ICcnCgkJCQlpbmZvcm1hY29lc1sndXNlciddWydGaWxtZXNfYXBwJ10gPSAnNScKCQkJCV9fQURET05fXy5zZXRTZXR0aW5nKCdlbWFpbCcsICcnKQoJCQkJX19BRERPTl9fLnNldFNldHRpbmcoJ3Bhc3N3b3JkJywgJycpCgkJCQlpbmZvcm1hY29lc1sndXNlciddWydDbGllbnRfU2VjcmV0X1VzZXInXSA9ICcnCgkJCQlfX0FERE9OX18uc2V0U2V0dGluZygnY2xpZW50X3NlY3JldF91c2VyJywgJycpCgkJCWVsaWYoY2hpbGQudGFnID09ICd2YWxpZGFjYW8nKToKCQkJCWZvciBkIGluIGNoaWxkOgoJCQkJCWlmKGQudGFnID09ICdOb21lJyk6CgkJCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ05vbWUnXSA9IGQudGV4dAoJCQkJCWVsaWYoZC50YWcgPT0gJ0FjZXNzX1Rva2VuJyk6CgkJCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ0FjZXNzX1Rva2VuJ10gPSBkLnRleHQKCQkJCQkJX19BRERPTl9fLnNldFNldHRpbmcoJ2FjZXNzX1Rva2VuJywgZC50ZXh0KQoJCQkJCWVsaWYoZC50YWcgPT0gJ0ROUycpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydETlMnXSA9IGQudGV4dAoJCQkJCWVsaWYoZC50YWcgPT0gJ0VtYWlsJyk6CgkJCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ0VtYWlsJ10gPSBkLnRleHQKCQkJCQllbGlmKGQudGFnID09ICdXZWJTaXRlJyk6CgkJCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ1dlYlNpdGUnXSA9IGQudGV4dAoJCQkJCWVsaWYoZC50YWcgPT0gJ1ZlckFQUCcpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydWZXJBUFAnXSA9IGQudGV4dAoJCQkJCWVsaWYoZC50YWcgPT0gJ0xpbmtBUFAnKToKCQkJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnTGlua0FQUCddID0gZC50ZXh0CgkJCQkJZWxpZihkLnRhZyA9PSAnTWVsaG9yYW1lbnRvcycpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydNZWxob3JhbWVudG9zJ10gPSBkLnRleHQKCQkJCQllbGlmKGQudGFnID09ICdOb3RhcycpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydOb3RhcyddID0gZC50ZXh0CgkJCQkJZWxpZihkLnRhZyA9PSAnZmlsbWVzX2FwcCcpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydGaWxtZXNfYXBwJ10gPSBkLnRleHQKCQkJCQllbGlmKGQudGFnID09ICd1c2VyX2tvZGknKToKCQkJCQkJX19BRERPTl9fLnNldFNldHRpbmcoJ2VtYWlsJywgZC50ZXh0KQoJCQkJCWVsaWYoZC50YWcgPT0gJ3NlbmhhX2tvZGknKToKCQkJCQkJX19BRERPTl9fLnNldFNldHRpbmcoJ3Bhc3N3b3JkJywgZC50ZXh0KQoJCQkJCWVsaWYoZC50YWcgPT0gJ0NsaWVudF9TZWNyZXRfVXNlcicpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydDbGllbnRfU2VjcmV0X1VzZXInXSA9IGQudGV4dAoJCQkJCQlfX0FERE9OX18uc2V0U2V0dGluZygnY2xpZW50X3NlY3JldF91c2VyJywgZC50ZXh0KQoJCQllbHNlOgoJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnTsOjbyBzZWkgbyBxdWUgZXN0b3UgYSBsZXIuJykKCWV4Y2VwdDoKCQlpbmZvcm1hY29lc1sndXNlciddWydOb21lJ10gPSBBZGRvblRpdGxlCgkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnQWNlc3NfVG9rZW4nXSA9ICcnCgkJX19BRERPTl9fLnNldFNldHRpbmcoJ2FjZXNzX1Rva2VuJywgJycpCgkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnRE5TJ10gPSBiYXNlNjQudXJsc2FmZV9iNjRkZWNvZGUoX19BRERPTl9fLmdldFNldHRpbmcoJ2Ruc19hZGRvbicpKQoJCV9fRVBHX18gPSBpbmZvcm1hY29lc1sndXNlciddWydETlMnXSsneG1sdHYucGhwP3VzZXJuYW1lPScrX19BRERPTl9fLmdldFNldHRpbmcoJ2xvZ2luX25hbWUnKSsnJnBhc3N3b3JkPScrX19BRERPTl9fLmdldFNldHRpbmcoJ2xvZ2luX3Bhc3N3b3JkJykrJyZlcGdfc2hpZnQ9MCcKCQlfX0FERE9OX18uc2V0U2V0dGluZygnbGlzdGFfZXBnJywgX19FUEdfXykKCQlpbmZvcm1hY29lc1sndXNlciddWydFbWFpbCddID0gJycKCQlpbmZvcm1hY29lc1sndXNlciddWydXZWJTaXRlJ10gPSAnJwoJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ1ZlckFQUCddID0gX19BRERPTlZFUlNJT05fXwoJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ0xpbmtBUFAnXSA9ICcnCgkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnTWVsaG9yYW1lbnRvcyddID0gJycKCQlpbmZvcm1hY29lc1sndXNlciddWydOb3RhcyddID0gJycKCQlpbmZvcm1hY29lc1sndXNlciddWydGaWxtZXNfYXBwJ10gPSAnNScKCQlfX0FERE9OX18uc2V0U2V0dGluZygnZW1haWwnLCAnJykKCQlfX0FERE9OX18uc2V0U2V0dGluZygncGFzc3dvcmQnLCAnJykKCQlpbmZvcm1hY29lc1sndXNlciddWydDbGllbnRfU2VjcmV0X1VzZXInXSA9ICcnCgkJX19BRERPTl9fLnNldFNldHRpbmcoJ2NsaWVudF9zZWNyZXRfdXNlcicsICcnKQoKCXJldHVybiBpbmZvcm1hY29lcwoKZGVmIGxvZ2luTGl2ZWl0KHVybCk6CglpbmZvcm1hY29lcyA9IHsKCQkndXNlcicgOiB7CgkJCSd1c2VybmFtZSc6ICcnLAoJCQkncGFzc3dvcmQnOiAnJywKCQkJJ2VzdGFkbyc6ICcnLAoJCQknZGF0YSc6ICcnLAoJCQknZGlhcyc6ICcnLAoJCQkndHJpYWwnOiAnJywKCQkJJ2NyaWFjYW8nOiAnJywKCQkJJ3Nlcmllcyc6ICcnLAoJCQknbGlzdGEnOiAnJywKCQkJJ3Jlc3VsdGFkbyc6ICcnLAoJCQknY29uZWNjb2VzJzogJycKCQkJCgkJfSwKCQknbWVudXMnOiBbXQoJfQoJdHJ5OgoJCW5ldCA9IE5ldCgpCgkJbmV0LnNldF9jb29raWVzKF9fQ09PS0lFX0ZJTEVfXykKCQlkYWRvcyA9IHsndXNlcm5hbWUnOiBfX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fbmFtZSIpLCAncGFzc3dvcmQnOiBfX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fcGFzc3dvcmQiKX0KCQljb2RpZ29fZm9udGUgPSBuZXQuaHR0cF9QT1NUKF9fU0lURUJEX18rJ0xvZ2luQWRkb24yLnBocCcsZm9ybV9kYXRhPWRhZG9zLGhlYWRlcnM9X19IRUFERVJTX18pLmNvbnRlbnQKCQllbGVtcyA9IEVULmZyb21zdHJpbmcoY29kaWdvX2ZvbnRlKQoJCWZvciBjaGlsZCBpbiBlbGVtczoKCQkJaWYoY2hpbGQudGFnID09ICdzdWNlc3NvJyk6CgkJCQlpbmZvcm1hY29lc1sndXNlciddWydyZXN1bHRhZG8nXSA9IGNoaWxkLnRleHQKCQkJZWxpZihjaGlsZC50YWcgPT0gJ3VzZXInKToKCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ2xpc3RhJ10gPSB1cmwKCQkJCWZvciBkIGluIGNoaWxkOgoJCQkJCWlmKGQudGFnID09ICdEYXRhRmltJyk6CgkJCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ2RhdGEnXSA9IGQudGV4dAoJCQkJCWVsaWYoZC50YWcgPT0gJ2RpYXMnKToKCQkJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnZGlhcyddID0gZC50ZXh0CgkJCQkJZWxpZihkLnRhZyA9PSAnRGF0YUNyaWFjYW8nKToKCQkJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnY3JpYWNhbyddID0gZC50ZXh0CgkJCQkJZWxpZihkLnRhZyA9PSAnRXF1aXBhbWVudG9zJyk6CgkJCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ2NvbmVjY29lcyddID0gIltDT0xPUiA9IHdoaXRlXU1heGltbyBkZSBDb25uZWM6IFsvQ09MT1JdIitkLnRleHQKCQkJCQllbGlmKGQudGFnID09ICdUaXBvVXNlcicpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWyd0cmlhbCddID0gZC50ZXh0CgkJCQkJZWxpZihkLnRhZyA9PSAnRXN0YWRvJyk6CgkJCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ2VzdGFkbyddID0gZC50ZXh0CgkJCQkJZWxpZihkLnRhZyA9PSAnc2VyaWVzJyk6CgkJCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ3NlcmllcyddID0gZC50ZXh0CgkJCQkJZWxpZihkLnRhZyA9PSAnU2VuaGEnKToKCQkJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsncGFzc3dvcmQnXSA9IGQudGV4dAoJCQkJCWVsaWYoZC50YWcgPT0gJ1V0aWxpemFkb3InKToKCQkJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsndXNlcm5hbWUnXSA9ICJbQ09MT1IgPSB3aGl0ZV1VdGlsaXphZG9yOiBbL0NPTE9SXSIrZC50ZXh0CgkJCSNlbHNlOgoJCQkjCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ07Do28gc2VpIG8gcXVlIGVzdG91IGEgbGVyLicpCglleGNlcHQ6CgkJaW5mb3JtYWNvZXNbJ3VzZXInXVsndXNlcm5hbWUnXSA9ICIiCgkJaW5mb3JtYWNvZXNbJ3VzZXInXVsncGFzc3dvcmQnXSA9ICIiCgkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnZXN0YWRvJ10gPSAiIgoJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ2RhdGEnXSA9ICIiCgkJaW5mb3JtYWNvZXNbJ3VzZXInXVsndHJpYWwnXSA9ICIiCgkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnY29uZWNjb2VzJ10gPSAiIgoJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ3NlcmllcyddID0gIiIKCQlpbmZvcm1hY29lc1sndXNlciddWydsaXN0YSddID0gdXJsCgkJcmV0dXJuIGluZm9ybWFjb2VzCgkKCXJldHVybiBpbmZvcm1hY29lcwoKZGVmIGxvZ2luKHVybCk6CglpbmZvcm1hY29lcyA9IHsKCQkndXNlcicgOiB7CgkJCSd1c2VybmFtZSc6ICcnLAoJCQkncGFzc3dvcmQnOiAnJywKCQkJJ2VzdGFkbyc6ICcnLAoJCQknZGF0YSc6ICcnLAoJCQkndHJpYWwnOiAnJywKCQkJJ2xpc3RhJzogJycsCgkJCSdjb25lY2NvZXMnOiAnJwoJCQkKCQl9LAoJCSdtZW51cyc6IFtdCgl9ICMgCglhbmRtZWxpbmsgPSB1cmwrJ3BsYXllcl9hcGkucGhwP3VzZXJuYW1lPScrX19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX25hbWUiKSsnJnBhc3N3b3JkPScrX19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX3Bhc3N3b3JkIikKCWFuZG1lZCA9IGdyYWJfZXBnKGFuZG1lbGluaykKCWlmIGFuZG1lZCAhPSBOb25lOgoJCWthc3V0YWphQW5kbWVkID0gYW5kbWVkW3N5bmNfZGF0YSgiZFhObGNsOXBibVp2IildCgkJa2FzdXRhamFBbmRtZWQyID0gYW5kbWVkW3N5bmNfZGF0YSgiYzJWeWRtVnlYMmx1Wm04PSIpXQoJCXNlaXMgPSBrYXN1dGFqYUFuZG1lZFtnZXRfbGl2ZSgiYzNSaGRIVnoiKV0KCQlhZWd1YiA9IGthc3V0YWphQW5kbWVkW3N5bmNfZGF0YSgiWlhod1gyUmhkR1U9IildCgkJaWYgYWVndWI6CgkJCWFlZ3ViID0gZGF0ZS5mcm9tdGltZXN0YW1wKGludChhZWd1YikpLnN0cmZ0aW1lKCIlWS0lbS0lZCIpCgkJCSMjZWFlYWVuID0ga2FzdXRhamFBbmRtZWQyW3N5bmNfZGF0YSgiZEdsdFpWOXViM2M9IildCgkJCQoJCQl2aWV3U3RhcnREYXRlID0gZGF0ZXRpbWUuZGF0ZXRpbWUubm93KCkuc3RyZnRpbWUoIiVZLSVtLSVkIikKCQkJCgkJCWZvcm1hdCA9ICIlWS0lbS0lZCIKCQkJCgkJCXRyeToKCQkJCWhvamUxID0gZGF0ZXRpbWUuZGF0ZXRpbWUuc3RycHRpbWUoYWVndWIsIGZvcm1hdCkKCQkJZXhjZXB0IFR5cGVFcnJvcjoKCQkJCWhvamUxID0gZGF0ZXRpbWUuZGF0ZXRpbWUoKih0aW1lLnN0cnB0aW1lKGFlZ3ViLCBmb3JtYXQpWzA6Nl0pKQoJCQkKCQkJdHJ5OgoJCQkJaG9qZTIgPSBkYXRldGltZS5kYXRldGltZS5zdHJwdGltZSh2aWV3U3RhcnREYXRlLCBmb3JtYXQpCgkJCWV4Y2VwdCBUeXBlRXJyb3I6CgkJCQlob2plMiA9IGRhdGV0aW1lLmRhdGV0aW1lKCoodGltZS5zdHJwdGltZSh2aWV3U3RhcnREYXRlLCBmb3JtYXQpWzA6Nl0pKQoJCQkKCQkJYWVndWIgPSBzdHIoYWJzKChob2plMS1ob2plMikuZGF5cykpCgkJZWxzZToKCQkJYWVndWIgPSB2b2RfY2hhbm5lbHMoIlRtVjJaWEk9IikgCgkJcmFiYml0cyA9IGthc3V0YWphQW5kbWVkW3ZvZF9jaGFubmVscygiYVhOZmRISnBZV3c9IildCgkJaWYgcmFiYml0cyA9PSAiMCI6CgkJCXJhYmJpdHMgPSBzeW5jX2RhdGEoIlRtOD0iKQoJCWVsc2U6CgkJCXJhYmJpdHMgPSBzeW5jX2RhdGEoIldXVnoiKQoJCWxlYXZlbWVhbG9uZSA9IGthc3V0YWphQW5kbWVkW2dldF9saXZlKCJiV0Y0WDJOdmJtNWxZM1JwYjI1eiIpXQoJCXBvbGFyYmVhcnMgPSBrYXN1dGFqYUFuZG1lZFtzeW5jX2RhdGEoImRYTmxjbTVoYldVPSIpXQoJCQoJCWlmKHBvbGFyYmVhcnMgIT0gJycpOgoJCQlpbmZvcm1hY29lc1sndXNlciddWyd1c2VybmFtZSddID0gIltDT0xPUiA9IHdoaXRlXVV0aWxpemFkb3I6IFsvQ09MT1JdIitwb2xhcmJlYXJzCgkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ2VzdGFkbyddID0gc2VpcwoJCQlpbmZvcm1hY29lc1sndXNlciddWydkYXRhJ10gPSBhZWd1YgoJCQlpbmZvcm1hY29lc1sndXNlciddWyd0cmlhbCddID0gcmFiYml0cwoJCQlpbmZvcm1hY29lc1sndXNlciddWydjb25lY2NvZXMnXSA9ICJbQ09MT1IgPSB3aGl0ZV1NYXhpbW8gZGUgQ29ubmVjOiBbL0NPTE9SXSIrbGVhdmVtZWFsb25lCgkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ2xpc3RhJ10gPSB1cmwKCQoJcmV0dXJuIGluZm9ybWFjb2VzCgpkZWYgbG9naW4yKCk6CglyZXN1bHRhZG8gPSBGYWxzZQoJdHJ5OgoJCXBvc3QgPSB1cmxsaWIudXJsZW5jb2RlKHsndXNlcm5hbWUnOiBfX0FERE9OX18uZ2V0U2V0dGluZygnZW1haWwnKSwgJ3Bhc3N3b3JkJzogX19BRERPTl9fLmdldFNldHRpbmcoJ3Bhc3N3b3JkJykgfSkKCQlyZXN1bHRhZG8gPSBhYnJpcl91cmwoX19BUElfU0lURV9fKydsb2dpbi5waHAnLCBwb3N0PXBvc3QsIGhlYWRlcj1oZWFkZXJzKQoJCQoJCWlmIHJlc3VsdGFkbyA9PSAnRE5TJzoKCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVGVtIGRlIGFsdGVyYXIgb3MgRE5TIHBhcmEgcG9kZXIgdXN1ZnJ1aXIgZG8gX19BRERPTl9fLicpCgkJCXJldHVybiBGYWxzZQoJCQkKCQl0cnk6CgkJCXJlc3VsdGFkbyA9IHJlc3VsdGFkby5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6CgkJCXJlc3VsdGFkbyA9IHJlc3VsdGFkby5lbmNvZGUoJ3V0Zi04JykKCQl0cnk6CgkJCWlmIHJlc3VsdGFkb1snY29kaWdvJ10gPT0gMjA0OgoJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCByZXN1bHRhZG9bJ21lbnNhZ2VtJ10pCgkJCQlyZXR1cm4gRmFsc2UKCQlleGNlcHQ6CgkJCXBhc3MKCQkKCQllc2NyZXZlcl9maWNoZWlybyhvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdkZWZpbmljb2VzLmxpdmVpdCcpLCByZXN1bHRhZG8pCgkJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pCgkJI2NvbG9jYXIgbyBsb2dnZWRpbgoJCXRva2VuID0gcmVzdWx0YWRvWydjb29raWUnXQoJCXJlZnJlc2ggPSByZXN1bHRhZG9bJ2V4cGlyYSddCgkJCgkJdHJ5OgoJCQl1c2VybmFtZSA9IHJlc3VsdGFkb1sndXNlcm5hbWUnXS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6CgkJCXVzZXJuYW1lID0gcmVzdWx0YWRvWyd1c2VybmFtZSddLmVuY29kZSgndXRmLTgnKQoJCQoJCV9fQURET05fXy5zZXRTZXR0aW5nKCd0b2tlbk1ycGlyYWN5JywgdG9rZW4pCgkJX19BRERPTl9fLnNldFNldHRpbmcoJ3JlZnJlc2hNcnBpcmFjeScsIHJlZnJlc2gpCgkJX19BRERPTl9fLnNldFNldHRpbmcoJ2xvZ2dlZGluJywgdXNlcm5hbWUpCgkJCgkJY2F0ZWdvcmlhcyA9IHJlc3VsdGFkb1snY2F0ZWdvcmlhcyddCgkJZXNjcmV2ZXJfZmljaGVpcm8ob3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnY2F0ZWdvcmlhcy5saXZlaXQnKSwgc3RyKGNhdGVnb3JpYXMpKQoJCXJldHVybiBUcnVlCglleGNlcHQ6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnTsOjbyBmb2kgcG9zc8OtdmVsIGFicmlyIGEgcMOhZ2luYS4gUG9yIGZhdm9yIHRlbnRlIG5vdmFtZW50ZS4nKQoJCXJldHVybiBGYWxzZQoKZGVmIE1lbnVfaW5pY2lhbChtZW4sYnVpbGQsdGlwbyk6Cglfbm9tZXVzZXIgPSBtZW5bJ3VzZXInXVsndXNlcm5hbWUnXQoJZm9yIG1lbnUgaW4gbWVuWydtZW51cyddOgoJCW5vbWUgPSBtZW51Wydub21lJ10KCQlsb2dvID0gbWVudVsnbG9nbyddCgkJbGluayA9IG1lbnVbJ3VybCddCgkJdGlwbyA9IG1lbnVbJ3RpcG8nXQoJCWZhbmFydCA9IG1lbnVbJ2ZhbmFydCddCgkJCgkJaWYgdGlwbyA9PSAnY29udGEnIDoKCQkJYWRkRGlyKG5vbWUsbGluaywyLCdMaXN0YScsbG9nbyx0aXBvLGZhbmFydCkKCQllbGlmKHRpcG8gPT0gJ3R2Jyk6CgkJCWFkZERpcihub21lLGxpbmssMywnTGlzdGEnLGxvZ28sdGlwbyxmYW5hcnQpCgkJZWxpZih0aXBvID09ICdmaWxtZXMnKToKCQkJYWRkRGlyKG5vbWUsbGluaywxLCdMaXN0YScsbG9nbyx0aXBvLGZhbmFydCkKCQllbGlmKHRpcG8gPT0gJ2V4dHJhcycpOgoJCQlhZGREaXIobm9tZSxsaW5rLDEwNiwnTGlzdGEnLGxvZ28sdGlwbyxmYW5hcnQpCgkJZWxpZih0aXBvID09ICdjb25maWd1cmFyJyk6CgkJCWFkZERpcihub21lLGxpbmssNSwnTGlzdGEnLGxvZ28sdGlwbyxmYW5hcnQpCgkJZWxpZiB0aXBvID09ICd0dmFyY2hpdmUnOgoJCQlhZGREaXIobm9tZSxsaW5rLDYsJ0xpc3RhJyxsb2dvLCcnLGZhbmFydCkKCQllbGlmKHRpcG8gPT0gJ2xpbXBhcmNhY2hlJyk6CgkJCWFkZERpcihub21lLCBsaW5rLCAxMywgJ0xpc3RhJyxsb2dvLHRpcG8sZmFuYXJ0KQoJCWVsaWYodGlwbyA9PSAnbGltcGFydHVkbycpOgoJCQlhZGREaXIobm9tZSwgbGluaywgMTQsICdMaXN0YScsbG9nbyx0aXBvLGZhbmFydCkKCQkKCXhibWMuZXhlY3V0ZWJ1aWx0aW4oJ05vdGlmaWNhdGlvbiglcywgJXMsICVpLCAlcyknJShBZGRvblRpdGxlLF9ub21ldXNlciwgODAwMCwgX0lDT05fKSkKCXhibWNwbHVnaW4uZW5kT2ZEaXJlY3RvcnkoaW50KHN5cy5hcmd2WzFdKSxjYWNoZVRvRGlzYz1GYWxzZSkKCmRlZiBhYnJpckV4dHJhcygpOgoJdXJsbm9vMSA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L2J1c2NhcnJhZGlvcy5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJmFkZG9uPTEnCglhZGREaXIoIlLDoWRpb3MiLHVybG5vbzEsMTAyLCdMaXN0YScsX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrIkFkZG9uL0ltYWdlbnMvcmFkaW9zLnBuZyIsJ3ByYWlhcycsX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrIkFkZG9uL0ltYWdlbnMvcmFkaW9zX2ZhbmFydC5wbmciKQoJdXJsbm9vMSA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L2J1c2NhcnByYWlhcy5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJmFkZG9uPTEnCglhZGREaXIoIlByYWlhcyIsdXJsbm9vMSwxMDEsJ0xpc3RhJyxfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsiQWRkb24vSW1hZ2Vucy9ub3ZpZGFkZXN0di5wbmciLCdwcmFpYXMnLF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJBZGRvbi9JbWFnZW5zL25vdmlkYWRlc19mYW5hcnQucG5nIikKCXVybG5vbzEgPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC9idXNjYXJuZXd0ZWxlbm92ZWxhcy5waHA/dGlwbz1Qcm9ncmFtYXMmY2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJmFkZG9uPTEnCglhZGREaXIoIlByb2dyYW1hcyBlIFRlbGVub3ZlbGFzIix1cmxub28xLDEwMywnTGlzdGEnLF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJBZGRvbi9JbWFnZW5zL25vdmlkYWRlc3R2LnBuZyIsJ3ByYWlhcycsX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrIkFkZG9uL0ltYWdlbnMvbm92aWRhZGVzX2ZhbmFydC5wbmciKQoJdXJsbm9vMSA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L2J1c2Nhcm5ld3RlbGVub3ZlbGFzLnBocD90aXBvPUpvcm5haXMmY2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJmFkZG9uPTEnCglhZGREaXIoIkpvcm5haXMiLHVybG5vbzEsMTA3LCdMaXN0YScsX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrIkFkZG9uL0ltYWdlbnMvbm92aWRhZGVzdHYucG5nIiwnam9ybmFpcycsX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrIkFkZG9uL0ltYWdlbnMvbm92aWRhZGVzX2ZhbmFydC5wbmciKQoJCgl2aXN0YV9tZW51KCkKCmRlZiBsaXN0YXJfZ3J1cG9zMShtb2Rvbix1cmwsZmFuYXJ0KToKCXJlc3VsdGFkbzEgPSBkZXZvbHZlcmVzdWx0YWRvKHVybCkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvMSkKCWZvciBpIGluIHJlc3VsdGFkb1snY2FuYWlzJ106CgkJaWQgPSBpWydJRCddCgkJbm9tZSA9ICIiCgkJaW1hZ2VtID0gIiIKCQl1cmxuID0gIiIKCQl0cnk6IG5vbWUgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ05vbWUnXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OiBwYXNzCgkJdHJ5OiAKCQkJaW1hZ2VtID0gYmFzZTY0LmI2NGRlY29kZShpWydJbWFnZW0nXSkuZGVjb2RlKCd1dGYtOCcpCgkJCWltYWdlbSA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJMb2dvcy8iK2ltYWdlbQoJCWV4Y2VwdDogcGFzcwoJCXRyeTogdXJsbiA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnVXJsJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCWFkZExpbmtDYW5hbExpc3RhKG5vbWUsdXJsbixpbWFnZW0sJycsZmFuYXJ0LCAnMDAwMScpCgkJCmRlZiBsaXN0YXJfZ3J1cG9zMihtb2Rvbix1cmwsZmFuYXJ0KToKCXJlc3VsdGFkbzEgPSBkZXZvbHZlcmVzdWx0YWRvKHVybCkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvMSkKCWZvciBpIGluIHJlc3VsdGFkb1snY2FuYWlzJ106CgkJaWQgPSBpWydJRCddCgkJbm9tZSA9ICIiCgkJaW1hZ2VtID0gIiIKCQl1cmxuID0gIiIKCQl0cnk6IG5vbWUgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ05vbWUnXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OiBwYXNzCgkJdHJ5OiAKCQkJaW1hZ2VtID0gYmFzZTY0LmI2NGRlY29kZShpWydJbWFnZW0nXSkuZGVjb2RlKCd1dGYtOCcpCgkJCWltYWdlbSA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJMb2dvcy8iK2ltYWdlbQoJCWV4Y2VwdDogcGFzcwoJCXRyeTogdXJsbiA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnVXJsJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCWFkZExpbmtDYW5hbExpc3RhKG5vbWUsdXJsbixpbWFnZW0sJycsZmFuYXJ0LCAnMDAwMScpCgkKZGVmIGxpc3Rhcl9ncnVwb3MzKG1vZG9uLHVybCxmYW5hcnQpOgoJcmVzdWx0YWRvMSA9IGRldm9sdmVyZXN1bHRhZG8odXJsKQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8xKQoJZm9yIGkgaW4gcmVzdWx0YWRvWydjYW5haXMnXToKCQlub21lID0gIiIKCQlpbWFnZW0gPSAiIgoJCXVybG4gPSAiIgoJCXRpcG8gPSAiIgoJCXdlYnNpdGUgPSAiIgoJCWNhbmFsID0gIiIKCQl0cnk6IG5vbWUgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ05vbWUnXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OiBwYXNzCgkJdHJ5OiAKCQkJaW1hZ2VtID0gYmFzZTY0LmI2NGRlY29kZShpWydJbWFnZW0nXSkuZGVjb2RlKCd1dGYtOCcpCgkJCWltYWdlbSA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJMb2dvcy8iK2ltYWdlbQoJCWV4Y2VwdDogcGFzcwoJCXRyeTogdXJsbiA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnVXJsJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCXRyeTogd2Vic2l0ZSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnV2ViU2l0ZSddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQl0cnk6IHRpcG8gPSBpWydUaXBvJ10KCQlleGNlcHQ6IHBhc3MKCQl0cnk6IGNhbmFsID0gaVsnQ2FuYWwnXQoJCWV4Y2VwdDogcGFzcwoJCXVybG5vbzMgPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC9idXNjYXJpbmZvdGVsZW5vdmVsYXMucGhwP3RpcG89Jyt0aXBvKycmd2Vic2l0ZT0nK3dlYnNpdGUrJyZ1cmw9Jyt1cmxuKycmY2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJmFkZG9uPTEnCgkJYWRkRGlyKG5vbWUsdXJsbm9vMywxMDQsJ0xpc3RhJyxpbWFnZW0sJ1Byb2dyYW1hcycsX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrIkFkZG9uL0ltYWdlbnMvbm92aWRhZGVzX2ZhbmFydC5wbmciKQoKZGVmIGxpc3Rhcl9ncnVwb3M0KG1vZG9uLHVybCxpY29uaW1hZ2UsZmFuYXJ0KToKCXJlc3VsdGFkbzEgPSBkZXZvbHZlcmVzdWx0YWRvKHVybCkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvMSkKCWZvciBpIGluIHJlc3VsdGFkb1snZXBpc29kaW9zJ106CgkJbm9tZSA9ICIiCgkJdXJsbiA9IGlbJ3VybCddCgkJdHJ5OiBub21lID0gYmFzZTY0LmI2NGRlY29kZShpWyd0aXR1bG8nXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OiBwYXNzCgkJYWRkTGlua0NhbmFsTGlzdGEobm9tZSx1cmxuLGljb25pbWFnZSwncHJvZ3JhbWFzJyxmYW5hcnQsICcwMDAxJykKCQkKZGVmIGxpc3Rhcl9ncnVwb3M1KG1vZG9uLHVybCxmYW5hcnQpOgoJcmVzdWx0YWRvMSA9IGRldm9sdmVyZXN1bHRhZG8odXJsKQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8xKQoJZm9yIGkgaW4gcmVzdWx0YWRvWydjYW5haXMnXToKCQlub21lID0gIiIKCQlpbWFnZW0gPSAiIgoJCXVybG4gPSAiIgoJCXRpcG8gPSAiIgoJCXdlYnNpdGUgPSAiIgoJCWNhbmFsID0gIiIKCQl0cnk6IG5vbWUgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ05vbWUnXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OiBwYXNzCgkJdHJ5OiAKCQkJaW1hZ2VtID0gYmFzZTY0LmI2NGRlY29kZShpWydJbWFnZW0nXSkuZGVjb2RlKCd1dGYtOCcpCgkJCWltYWdlbSA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJMb2dvcy8iK2ltYWdlbQoJCWV4Y2VwdDogcGFzcwoJCXRyeTogdXJsbiA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnVXJsJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCXRyeTogd2Vic2l0ZSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnV2ViU2l0ZSddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQl0cnk6IHRpcG8gPSBpWydUaXBvJ10KCQlleGNlcHQ6IHBhc3MKCQl0cnk6IGNhbmFsID0gaVsnQ2FuYWwnXQoJCWV4Y2VwdDogcGFzcwoJCXVybG5vbzMgPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC9idXNjYXJpbmZvdGVsZW5vdmVsYXMucGhwP3RpcG89am9ybmFpcyZ1cmw9Jyt1cmxuKycmY2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJmFkZG9uPTEnCgkJYWRkRGlyKG5vbWUsdXJsbm9vMywxMDgsJ0xpc3RhJyxpbWFnZW0sJ0pvcm5haXMnLF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJBZGRvbi9JbWFnZW5zL25vdmlkYWRlc19mYW5hcnQucG5nIikKCmRlZiBsaXN0YXJfZ3J1cG9zNihtb2Rvbix1cmwsaWNvbmltYWdlLGZhbmFydCk6CglyZXN1bHRhZG8xID0gZGV2b2x2ZXJlc3VsdGFkbyh1cmwpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbzEpCglmb3IgaSBpbiByZXN1bHRhZG9bJ2VwaXNvZGlvcyddOgoJCW5vbWUgPSAiIgoJCXVybG4gPSAiIgoJCXRyeTogbm9tZSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsndGl0dWxvJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCXRyeTogdXJsbiA9IGJhc2U2NC5iNjRkZWNvZGUoaVsndXJsJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCQoJCWFkZERpcihub21lLHVybG4sMTA5LCdMaXN0YScsaWNvbmltYWdlLCdQcm9ncmFtYXMnLGZhbmFydCkKCXhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1NSkiKQoKZGVmIHBsYXlfbXVsdF9jYW5hbDIoYXJnLCBpY29uLCBub21lKToKCXhibWMuZXhlY3V0ZWJ1aWx0aW4oJ1Nob3dQaWN0dXJlKCJ7MH0iKScuZm9ybWF0KGFyZykpCgpkZWYgYWJyaXJWaWRlb0NsdWJlKHVybCk6CgljaGVja19sb2dpbjIgPSBsb2dpbnBhaW5lbCgpCglmaWxtZXNfYXBwID0gY2hlY2tfbG9naW4yWyd1c2VyJ11bJ0ZpbG1lc19hcHAnXTsKCWZpbG1pbGluayA9IHVybCsnZW5pZ21hMi5waHA/dXNlcm5hbWU9JytfX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fbmFtZSIpKycmcGFzc3dvcmQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fcGFzc3dvcmQiKSsnJnR5cGU9Z2V0X3ZvZF9jYXRlZ29yaWVzJwoJc2VyaWxpbmsgPSB1cmwrJ2VuaWdtYTIucGhwP3VzZXJuYW1lPScrX19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX25hbWUiKSsnJnBhc3N3b3JkPScrX19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX3Bhc3N3b3JkIikrJyZ0eXBlPWdldF9zZXJpZXNfY2F0ZWdvcmllcycKCWFkZERpcignRmlsbWVzIGRhIExpc3RhJyxmaWxtaWxpbmssNCwnZmlsbWVzJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZmlsbWVzLnBuZycpLCcnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19fX0FERE9OX18ucG5nJykpCglhZGREaXIoJ1PDqXJpZXMgZGEgTGlzdGEnLHNlcmlsaW5rLDQsJ3Nlcmllcycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Nlcmllcy5wbmcnKSwnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fX19BRERPTl9fLnBuZycpKQoJYWRkRGlyKCdGaWxtZXMgZG8gQWRkb24nLHVybCwyMTExMSwnTWluaWF0dXJhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZmlsbWVzLnBuZycpLCcnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19fX0FERE9OX18ucG5nJykpCglhZGREaXIoJ1PDqXJpZXMgZG8gQWRkb24nLHVybCwyMTExMiwnTWluaWF0dXJhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnc2VyaWVzLnBuZycpLCcnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19fX0FERE9OX18ucG5nJykpCQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwkJCQkJCQkgIEFicmlyIEluZm8gQ29udGEJCQkJCQkJCQkgICMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCmRlZiBBYnJpcl9Db250YSh1cmwpOgoJYW5kbWVsaW5rID0gdXJsKydwbGF5ZXJfYXBpLnBocD91c2VybmFtZT0nK19fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9uYW1lIikrJyZwYXNzd29yZD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9wYXNzd29yZCIpCglleGVjdXRlX2FpbmZvKGFuZG1lbGluaykKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCQkJCQkJCQkJCQkJCUFicmlyIEluZm8gVFZTCQkJCQkJCQkJCQkgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCmRlZiBhYnJpbTN1KHVybCk6Cgl2ZXJzaW9uID0gX19BRERPTlZFUlNJT05fXwoJa2FzdXRhamFuaW1pPV9fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9uYW1lIikKCXNhbGFzb25hPV9fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9wYXNzd29yZCIpCglsZWhla3lsZz11cmwKCXZhbmVtYWtvb2Q9X19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX2FkdWx0b3MiKQoJdmFuZW1hbHVraz1fX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fYWR1bHRvc19zaW0iKQoJCgl0ZWxldmlzaW9vbmlsaW5rID0gdXJsKycvZW5pZ21hMi5waHA/dXNlcm5hbWU9JytfX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fbmFtZSIpKycmcGFzc3dvcmQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fcGFzc3dvcmQiKSsnJnR5cGU9Z2V0X2xpdmVfY2F0ZWdvcmllcycKCXNlY3VyaXR5X2NoZWNrKHRlbGV2aXNpb29uaWxpbmspCgpkZWYgc2VjdXJpdHlfY2hlY2sodXJsKToKCXUgPSB1cmxsaWIyLlJlcXVlc3QodXJsLCcnKQoJdS5hZGRfaGVhZGVyKCdBY2NlcHQnLCAnYXBwbGljYXRpb24veG1sJykKCXUuYWRkX2hlYWRlcignVXNlci1hZ2VudCcsICdNb3ppbGxhLzUuMCAoV2luZG93czsgVTsgV2luZG93cyBOVCA1LjE7IGVuLUdCOyBydjoxLjkuMC4zKSBHZWNrby8yMDA4MDkyNDE3IEZpcmVmb3gvMy4wLjMnKQoJcmVzcG9uc2UgPSB1cmxsaWIyLnVybG9wZW4odSkKCXRyZWUgPSBFVC5wYXJzZShyZXNwb25zZSkKCXJvb3RFbGVtID0gdHJlZS5nZXRyb290KCkKCWZvciBjaGFubmVsIGluIHRyZWUuZmluZGFsbCgiY2hhbm5lbCIpOgoJCWthbmFsaW5pbWkgPSBjaGFubmVsLmZpbmQoInRpdGxlIikudGV4dAoJCWthbmFsaW5pbWkgPSBiYXNlNjQuYjY0ZGVjb2RlKGthbmFsaW5pbWkpCgkJa2F0ZWdvb3JpYWxpbmsgPSBjaGFubmVsLmZpbmQoInBsYXlsaXN0X3VybCIpLnRleHQKCQkKCQlhZGREaXIoa2FuYWxpbmltaSxrYXRlZ29vcmlhbGluayw4LCdNaW5pYXR1cmEnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fdHYucG5nJyksJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3R2LnBuZycpKQoJCgl2aXN0YV9HcnVwb3MoKQoKZGVmIGRldGVjdF9tb2RpZmljYXRpb24odXJsLGVzdGlsbyk6Cgl1ID0gdXJsbGliMi5SZXF1ZXN0KHVybCwnJykKCXUuYWRkX2hlYWRlcignQWNjZXB0JywgJ2FwcGxpY2F0aW9uL3htbCcpCgl1LmFkZF9oZWFkZXIoJ1VzZXItYWdlbnQnLCAnTW96aWxsYS81LjAgKFdpbmRvd3M7IFU7IFdpbmRvd3MgTlQgNS4xOyBlbi1HQjsgcnY6MS45LjAuMykgR2Vja28vMjAwODA5MjQxNyBGaXJlZm94LzMuMC4zJykKCXJlc3BvbnNlID0gdXJsbGliMi51cmxvcGVuKHUpCgl0cmVlID0gRVQucGFyc2UocmVzcG9uc2UpCglyb290RWxlbSA9IHRyZWUuZ2V0cm9vdCgpCglmb3IgY2hhbm5lbCBpbiB0cmVlLmZpbmRhbGwoImNoYW5uZWwiKToKCQlmaWxtaW5pbWkgPSBjaGFubmVsLmZpbmQoInRpdGxlIikudGV4dAoJCWZpbG1pbmltaSA9IGJhc2U2NC5iNjRkZWNvZGUoZmlsbWluaW1pKQoJCWthdGVnb29yaWFsaW5rID0gY2hhbm5lbC5maW5kKCJwbGF5bGlzdF91cmwiKS50ZXh0CgkJaWYgZXN0aWxvID09ICdmaWxtZXMnOgoJCQlhZGREaXIoZmlsbWluaW1pLGthdGVnb29yaWFsaW5rLDksJ01pbmlhdHVyYScsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ZpbG1lcy5wbmcnKSwnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fdmlkLnBuZycpKQoJCWVsaWYgZXN0aWxvID09ICdzZXJpZXMnOgoJCQlhZGREaXIoZmlsbWluaW1pLGthdGVnb29yaWFsaW5rLDQsJ3NlcmllczInLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdzZXJpZXMucG5nJyksJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX19fQURET05fXy5wbmcnKSkKCQllbGlmIGVzdGlsbyA9PSAnc2VyaWVzMic6CgkJCWFkZERpcihmaWxtaW5pbWksa2F0ZWdvb3JpYWxpbmssNCwnc2VyaWVzMycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Nlcmllcy5wbmcnKSwnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fX19BRERPTl9fLnBuZycpKQoJCWVsaWYgZXN0aWxvID09ICdzZXJpZXMzJzoKCQkJYWRkRGlyKGZpbG1pbmltaSxrYXRlZ29vcmlhbGluayw5LCdNaW5pYXR1cmEnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdzZXJpZXMucG5nJyksJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3ZpZC5wbmcnKSkKCQllbHNlOgoJCQlhZGREaXIoZmlsbWluaW1pLGthdGVnb29yaWFsaW5rLDQsJ3NlcmllczInLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdzZXJpZXMucG5nJyksJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX19fQURET05fXy5wbmcnKSkKCQoJdmlzdGFfR3J1cG9zKCkKCmRlZiBzdHJlYW1fdmlkZW8obmFtZSx1cmwsaW1hZ2UpOgoJdmFuZW1hbHVraz1fX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fYWR1bHRvc19zaW0iKQoJaWYgdmFuZW1hbHVrayA9PSAidHJ1ZSI6CgkJdmFuZW1hX2x1a2sobmFtZSkKCXUgPSB1cmxsaWIyLlJlcXVlc3QodXJsLCcnKQoJdS5hZGRfaGVhZGVyKCdBY2NlcHQnLCAnYXBwbGljYXRpb24veG1sJykKCXUuYWRkX2hlYWRlcignVXNlci1hZ2VudCcsICdNb3ppbGxhLzUuMCAoV2luZG93czsgVTsgV2luZG93cyBOVCA1LjE7IGVuLUdCOyBydjoxLjkuMC4zKSBHZWNrby8yMDA4MDkyNDE3IEZpcmVmb3gvMy4wLjMnKQoJcmVzcG9uc2UgPSB1cmxsaWIyLnVybG9wZW4odSkKCXRyZWUgPSBFVC5wYXJzZShyZXNwb25zZSkKCXJvb3RFbGVtID0gdHJlZS5nZXRyb290KCkKCWZvciBjaGFubmVsIGluIHRyZWUuZmluZGFsbChzeW5jX2RhdGEoIlkyaGhibTVsYkE9PSIpKToKCQlrYW5hbGluaW1pID0gY2hhbm5lbC5maW5kKGdldF9saXZlKCJkR2wwYkdVPSIpKS50ZXh0CgkJa2FuYWxpbmltaSA9IGJhc2U2NC5iNjRkZWNvZGUoa2FuYWxpbmltaSkKCQlrYW5hbGluaW1pID0ga2FuYWxpbmltaS5wYXJ0aXRpb24oIlsiKQoJCXN0cmlpbWlsaW5rID0gY2hhbm5lbC5maW5kKGdldF9saXZlKCJjM1J5WldGdFgzVnliQT09IikpLnRleHQKCQkKCQl1cmxjaGFtYSA9IHN0cmlpbWlsaW5rLnNwbGl0KCcvJykKCQl1cmxub28gPSAnJwoJCXRyeToKCQkJdXJsbm9vID0gdXJsY2hhbWFbNV0KCQkJdXJsbm9vID0gdXJsbm9vLnJlcGxhY2UoJ3RzJywnJykKCQkJdXJsbm9vID0gdXJsbm9vLnJlcGxhY2UoJ20zdTgnLCcnKQoJCWV4Y2VwdDoKCQkJcGFzcwoJCQoJCXBpbHQgPSBjaGFubmVsLmZpbmQoImRlc2NfaW1hZ2UiKS50ZXh0CgkJa2F2YSA9IGthbmFsaW5pbWlbMV0ra2FuYWxpbmltaVsyXQoJCWthdmEgPSBrYXZhLnBhcnRpdGlvbigiXSIpCgkJa2F2YSA9IGthdmFbMl0KCQlrYXZhID0ga2F2YS5wYXJ0aXRpb24oIgkiKQoJCWthdmEgPSBrYXZhWzJdCgkJc2hvdSA9IGdldF9saXZlKCJXME5QVEU5U0lIZG9hWFJsWFNWeklGc3ZRMDlNVDFKZCIpJShrYW5hbGluaW1pWzBdKStrYXZhCgkJa2lyamVsZHVzID0gY2hhbm5lbC5maW5kKCJkZXNjcmlwdGlvbiIpLnRleHQKCQlpZiBraXJqZWxkdXM6CgkJCWtpcmplbGR1cyA9IGJhc2U2NC5iNjRkZWNvZGUoa2lyamVsZHVzKQoJCQlueXlkID0ga2lyamVsZHVzLnBhcnRpdGlvbigiKCIpCgkJCW55eWQgPSAiQWdvcmE6ICIrbnl5ZFswXQoJCQlqYXJnbWluZSA9IGtpcmplbGR1cy5wYXJ0aXRpb24oIilcbiIpCgkJCWphcmdtaW5lID0gamFyZ21pbmVbMl0ucGFydGl0aW9uKCIoIikKCQkJamFyZ21pbmUgPSAiQSBzZWd1aXI6ICIramFyZ21pbmVbMF0KCQkJa29ra3UgPSBueXlkK2phcmdtaW5lCgkJZWxzZToKCQkJa29ra3UgPSAiIgoJCWlmIHBpbHQ6CgkJCWFkZExpbmtDYW5hbExpc3RhKHNob3Usc3RyaWltaWxpbmsscGlsdCxrb2trdSxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fdHYucG5nJyksIHVybG5vbykKCQllbHNlOgoJCQlhZGRMaW5rQ2FuYWxMaXN0YShzaG91LHN0cmlpbWlsaW5rLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fdHYucG5nJyksa29ra3Usb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3R2LnBuZycpLCB1cmxub28pCgkKCXhibWNwbHVnaW4uc2V0Q29udGVudChpbnQoc3lzLmFyZ3ZbMV0pICwiZXBpc29kZXMiKQoJdmlzdGFfQ2FuYWlzKCkKCmRlZiBnZXRfbXlhY2NvdW50KG5hbWUsdXJsLGltYWdlKToKCXZhbmVtYWx1a2s9X19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX2FkdWx0b3Nfc2ltIikKCWlmIHZhbmVtYWx1a2sgPT0gInRydWUiOgoJCXZhbmVtYV9sdWtrKG5hbWUpCgl1ID0gdXJsbGliMi5SZXF1ZXN0KHVybCwnJykKCXUuYWRkX2hlYWRlcignQWNjZXB0JywgJ2FwcGxpY2F0aW9uL3htbCcpCgl1LmFkZF9oZWFkZXIoJ1VzZXItYWdlbnQnLCAnTW96aWxsYS81LjAgKFdpbmRvd3M7IFU7IFdpbmRvd3MgTlQgNS4xOyBlbi1HQjsgcnY6MS45LjAuMykgR2Vja28vMjAwODA5MjQxNyBGaXJlZm94LzMuMC4zJykKCXJlc3BvbnNlID0gdXJsbGliMi51cmxvcGVuKHUpCgl0cmVlID0gRVQucGFyc2UocmVzcG9uc2UpCglyb290RWxlbSA9IHRyZWUuZ2V0cm9vdCgpCglmb3IgY2hhbm5lbCBpbiB0cmVlLmZpbmRhbGwoImNoYW5uZWwiKToKCQlwZWFsa2lyaSA9IGNoYW5uZWwuZmluZCgidGl0bGUiKS50ZXh0CgkJcGVhbGtpcmkgPSBiYXNlNjQuYjY0ZGVjb2RlKHBlYWxraXJpKQoJCXBlYWxraXJpID0gcGVhbGtpcmkuZW5jb2RlKCJ1dGYtOCIpCgkJc3RyaWltaWxpbmsgPSBjaGFubmVsLmZpbmQoInN0cmVhbV91cmwiKS50ZXh0CgkJCgkJdXJsY2hhbWEgPSBzdHJpaW1pbGluay5zcGxpdCgnLycpCgkJdXJsbm9vID0gJycKCQl0cnk6CgkJCXVybG5vbyA9IHVybGNoYW1hWzVdCgkJCXVybG5vbyA9IHVybG5vby5yZXBsYWNlKCd0cycsJycpCgkJCXVybG5vbyA9IHVybG5vby5yZXBsYWNlKCdtM3U4JywnJykKCQlleGNlcHQ6CgkJCXBhc3MKCQkKCQlwaWx0ID0gY2hhbm5lbC5maW5kKCJkZXNjX2ltYWdlIikudGV4dCAKCQlkZXNjcmlwdCA9IGNoYW5uZWwuZmluZCgiZGVzY3JpcHRpb24iKS50ZXh0CgkJaWYgZGVzY3JpcHQ6CgkJCWRlc2NyaXB0ID0gYmFzZTY0LmI2NGRlY29kZShkZXNjcmlwdCkKCQlpZiBwaWx0OgoJCQlhZGRMaW5rQ2FuYWxMaXN0YShwZWFsa2lyaSxzdHJpaW1pbGluayxwaWx0LGRlc2NyaXB0LG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb192aWQucG5nJyksIHVybG5vbykKCQllbHNlOgoJCQlhZGRMaW5rQ2FuYWxMaXN0YShwZWFsa2lyaSxzdHJpaW1pbGluayxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX3R2LnBuZycpLGRlc2NyaXB0LG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb192aWQucG5nJyksIHVybG5vbykKCQoJeGJtY3BsdWdpbi5zZXRDb250ZW50KGludChzeXMuYXJndlsxXSkgLCJtb3ZpZXMiKQoJdmlzdGFfQ2FuYWlzKCkKCmRlZiBhZGRMaW5rQ2FuYWxMaXN0YSh0aXRsZSwgdXJsLCB0aHVtYm5haWwsIHBsb3QsIGZhbmFydCwgaWRjYW5hbCwgaXNQbGF5YWJsZT1UcnVlLCBmb2xkZXI9RmFsc2UpOgoJb2s9VHJ1ZQoJY209W10KCSNpZihpZGNhbmFsICE9ICcwMDAxJyk6CgkjCWNtLmFwcGVuZCgoJ1ZlciBwcm9ncmFtYcOnw6NvJywgJ1hCTUMuUnVuUGx1Z2luKCVzP21vZGU9MzEmbmFtZT0lcyZ1cmw9JXMmaWNvbmltYWdlPSVzJmlkQ2FuYWw9JXMmaWRmZkNhbmFsPSVzKSclKHN5cy5hcmd2WzBdLHVybGxpYi5xdW90ZV9wbHVzKHRpdGxlKSwgdXJsbGliLnF1b3RlX3BsdXModXJsKSwgdXJsbGliLnF1b3RlX3BsdXModGh1bWJuYWlsKSwgaWRjYW5hbCwgJycpKSkKCQoJbGlzdGl0ZW09eGJtY2d1aS5MaXN0SXRlbSh0aXRsZSxpY29uSW1hZ2U9dGh1bWJuYWlsLHRodW1ibmFpbEltYWdlPXRodW1ibmFpbCkKCWxpc3RpdGVtLmFkZENvbnRleHRNZW51SXRlbXMoY20sIHJlcGxhY2VJdGVtcz1GYWxzZSkKCWluZm9fbGFiZWxzPXsiVGl0bGUiOnRpdGxlLCJGaWxlTmFtZSI6dGl0bGUsIlBsb3QiOnBsb3R9CglsaXN0aXRlbS5zZXRJbmZvKCAidmlkZW8iLCBpbmZvX2xhYmVscyApCglsaXN0aXRlbS5zZXRQcm9wZXJ0eSgnZmFuYXJ0X2ltYWdlJywgZmFuYXJ0KQoJbGlzdGl0ZW0uc2V0QXJ0KHsnZmFuYXJ0JzogZmFuYXJ0fSkKCWxpc3RpdGVtLnNldFByb3BlcnR5KCJWaWRlbyIsInRydWUiKQoJdSA9IHN5cy5hcmd2WzBdICsgIj91cmw9IiArIHN0cih1cmwpICsgIiZtb2RlPTEwJm5hbWU9IiArIHN0cihuYW1lKSArICImaWNvbmltYWdlPSIrc3RyKGljb25pbWFnZSkrIiZmYW5hcnQ9IitzdHIoZmFuYXJ0KSsiJnBsb3Q9IitzdHIocGxvdCkKCW9rPXhibWNwbHVnaW4uYWRkRGlyZWN0b3J5SXRlbShoYW5kbGU9aW50KHN5cy5hcmd2WzFdKSx1cmw9dSxsaXN0aXRlbT1saXN0aXRlbSxpc0ZvbGRlcj1mb2xkZXIpCglyZXR1cm4gb2sKCmRlZiBydW5fY3JvbmpvYih0aXRsZSx1cmwsaW1hZ2UscGxvdCxmYW5hcnQpOgoJdmFuZW1hbHVraz1fX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fYWR1bHRvc19zaW0iKQoJaWYgdmFuZW1hbHVrayA9PSAidHJ1ZSI6CgkJdmFuZW1hX2x1a2sobmFtZSkKCQoJaWYgcGxvdCA9PSAncHJvZ3JhbWFzJzoKCQl1cmxuID0gIiIKCQl0cnk6IHVybG4gPSBiYXNlNjQuYjY0ZGVjb2RlKHVybCkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OiBwYXNzCgkJdXJsY2hhbWEgPSB1cmxuLnNwbGl0KCc7OzsnKQoJCXVybG5vbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3NlYXJjaHVybC5waHA/Y2FuYWw9Jyt1cmxjaGFtYVswXSsnJnVybD0nK3VybGNoYW1hWzFdKycmY2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJmFkZG9uPTEnCgkJCgkJbWVuc2FnZW1wcm9ncmVzc28gPSB4Ym1jZ3VpLkRpYWxvZ1Byb2dyZXNzKCkKCQltZW5zYWdlbXByb2dyZXNzby5jcmVhdGUoQWRkb25UaXRsZSwgdSdBYnJpciBlbWlzc8OjbycsJ1BvciBmYXZvciBhZ3VhcmRlLi4uJykKCQltZW5zYWdlbXByb2dyZXNzby51cGRhdGUoMjUsICIiLCB1J09idGVyIHZpZGVvJywgIiIpCgkJcmVzdWx0YWRvMSA9IGRldm9sdmVyZXN1bHRhZG8odXJsbm9vKQoJCW1lbnNhZ2VtcHJvZ3Jlc3NvLnVwZGF0ZSg1MCwgIiIsIHUnUHJlcGFyYS10ZSwgdmFpIGNvbWXDp2FyIScsICIiKQoJCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvMSkKCQltZW5zYWdlbXByb2dyZXNzby51cGRhdGUoNzUsICIiLCB1J0JvYSBTZXNzw6NvISEhJywgIiIpCgkJdXJsbiA9ICIiCgkJZm9yIGkgaW4gcmVzdWx0YWRvWydpbmZvcm1hY2FvJ106CgkJCXRyeTogdXJsbiA9IGJhc2U2NC5iNjRkZWNvZGUoaVsndXJsJ10pLmRlY29kZSgndXRmLTgnKQoJCQlleGNlcHQ6IHBhc3MKCQkJCgkJbWVuc2FnZW1wcm9ncmVzc28uY2xvc2UoKQoJCXhibWMuc2xlZXAoNTAwMCkKCQlwbGF5bGlzdCA9IHhibWMuUGxheUxpc3QoeGJtYy5QTEFZTElTVF9WSURFTykKCQlwbGF5bGlzdC5jbGVhcigpCgkJaW5mb19sYWJlbHM9eyJUaXRsZSI6dGl0bGUsIkZpbGVOYW1lIjp0aXRsZSwiUGxvdCI6cGxvdH0KCQlsaXN0aXRlbT14Ym1jZ3VpLkxpc3RJdGVtKHRpdGxlLGljb25JbWFnZT1pbWFnZSx0aHVtYm5haWxJbWFnZT1pbWFnZSkKCQlsaXN0aXRlbS5zZXRJbmZvKCAidmlkZW8iLCBpbmZvX2xhYmVscyApCgkJcGxheWxpc3QuYWRkKHVybD11cmxuLCBsaXN0aXRlbT1saXN0aXRlbSwgaW5kZXg9MSkKCQl4Ym1jLlBsYXllcigpLnBsYXkocGxheWxpc3QpCgllbHNlOgoJCXBsYXlsaXN0ID0geGJtYy5QbGF5TGlzdCh4Ym1jLlBMQVlMSVNUX1ZJREVPKQoJCXBsYXlsaXN0LmNsZWFyKCkKCQlpbmZvX2xhYmVscz17IlRpdGxlIjp0aXRsZSwiRmlsZU5hbWUiOnRpdGxlLCJQbG90IjpwbG90fQoJCWxpc3RpdGVtPXhibWNndWkuTGlzdEl0ZW0odGl0bGUsaWNvbkltYWdlPWltYWdlLHRodW1ibmFpbEltYWdlPWltYWdlKQoJCWxpc3RpdGVtLnNldEluZm8oICJ2aWRlbyIsIGluZm9fbGFiZWxzICkKCQlwbGF5bGlzdC5hZGQodXJsPXVybCwgbGlzdGl0ZW09bGlzdGl0ZW0sIGluZGV4PTEpCgkJeGJtYy5QbGF5ZXIoKS5wbGF5KHBsYXlsaXN0KQoJCgpkZWYgc3luY19kYXRhKGNoYW5uZWwpOgoJdmlkZW8gPSBiYXNlNjQuYjY0ZGVjb2RlKGNoYW5uZWwpCglyZXR1cm4gdmlkZW8KCmRlZiByZXN0YXJ0X3NlcnZpY2UocGFyYW1zKToKCXZhbmVtYWx1a2s9X19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX2FkdWx0b3Nfc2ltIikKCWlmIHZhbmVtYWx1a2sgPT0gInRydWUiOgoJCXBlYWxraXJpID0gcGFyYW1zLmdldChzeW5jX2RhdGEoImRHbDBiR1U9IikpCgkJdmFuZW1hX2x1a2socGVhbGtpcmkpCglsb3BwbGluayA9IHBhcmFtcy5nZXQodm9kX2NoYW5uZWxzKCJkWEpzIikpCgkKCXhibWNwbHVnaW4uc2V0UmVzb2x2ZWRVcmwoaW50KHN5cy5hcmd2WzFdKSwgVHJ1ZSwgbGlzdGl0ZW0pCgpkZWYgZ3JhYl9lcGcodXJsKToKCXJlcSA9IHVybGxpYjIuUmVxdWVzdCh1cmwpCglyZXEuYWRkX2hlYWRlcihzeW5jX2RhdGEoIlZYTmxjaTFCWjJWdWRBPT0iKSAsIHZvZF9jaGFubmVscygiUzI5a2FTQndiSFZuYVc0Z1lua2dUR2wyWlNGMCIpKQoJcmVzcG9uc2UgPSB1cmxsaWIyLnVybG9wZW4ocmVxKQoJbGluaz1yZXNwb25zZS5yZWFkKCkKCWpkYXRhID0ganNvbi5sb2FkcyhsaW5rLmRlY29kZSgndXRmOCcpKQoJcmVzcG9uc2UuY2xvc2UoKQoJaWYgamRhdGE6CgkJcmV0dXJuIGpkYXRhCgpkZWYgZ3JhYl9lcGcyKHVybCk6CglyZXEgPSB1cmxsaWIyLlJlcXVlc3QodXJsKQoJcmVxLmFkZF9oZWFkZXIoJ1VzZXItYWdlbnQnLCAnTW96aWxsYS81LjAgKFdpbmRvd3M7IFU7IFdpbmRvd3MgTlQgNS4xOyBlbi1HQjsgcnY6MS45LjAuMykgR2Vja28vMjAwODA5MjQxNyBGaXJlZm94LzMuMC4zJykKCXJlcS5hZGRfaGVhZGVyKHN5bmNfZGF0YSgiVlhObGNpMUJaMlZ1ZEE9PSIpICwgdm9kX2NoYW5uZWxzKCJTMjlrYVNCd2JIVm5hVzRnWW5rZ1RHbDJaU0YwIikpCglyZXNwb25zZSA9IHVybGxpYjIudXJsb3BlbihyZXEpCglsaW5rPXJlc3BvbnNlLnJlYWQoKQoJaWYgbGluayAhPSAneyJ1c2VyX2luZm8iOnsiYXV0aCI6MH19JzoKCQlqZGF0YSA9IGpzb24ubG9hZHMobGluay5kZWNvZGUoJ3V0ZjgnKSkKCQlyZXNwb25zZS5jbG9zZSgpCgkJaWYgamRhdGE6CgkJCXJldHVybiBqZGF0YQoJZWxzZToKCQlyZXR1cm4gTm9uZQoJCmRlZiBrb250cm9sbCh1cmwpOgoJcmFuZG9tc3RyaW5nID0gZ3JhYl9lcGcodXJsKQoJa2FzdXRhamFpbmZvID0gcmFuZG9tc3RyaW5nW3N5bmNfZGF0YSgiZFhObGNsOXBibVp2IildCglrb250cm9sbCA9IGthc3V0YWphaW5mb1tnZXRfbGl2ZSgiWVhWMGFBPT0iKV0KCXJldHVybiBrb250cm9sbApkZWYgZ2V0X2xpdmUoY2hhbm5lbCk6Cgl2aWRlbyA9IGJhc2U2NC5iNjRkZWNvZGUoY2hhbm5lbCkKCXJldHVybiB2aWRlbwpkZWYgZXhlY3V0ZV9haW5mbyh1cmwpOgoJYW5kbWVkID0gZ3JhYl9lcGcodXJsKQoJa2FzdXRhamFBbmRtZWQgPSBhbmRtZWRbc3luY19kYXRhKCJkWE5sY2w5cGJtWnYiKV0KCXNlaXMgPSBrYXN1dGFqYUFuZG1lZFtnZXRfbGl2ZSgiYzNSaGRIVnoiKV0KCWFlZ3ViID0ga2FzdXRhamFBbmRtZWRbc3luY19kYXRhKCJaWGh3WDJSaGRHVT0iKV0KCWlmIGFlZ3ViOgoJCWFlZ3ViID0gZGF0ZXRpbWUuZGF0ZXRpbWUuZnJvbXRpbWVzdGFtcChpbnQoYWVndWIpKS5zdHJmdGltZSgnJUg6JU0gJWQuJW0uJVknKQoJZWxzZToKCQlhZWd1YiA9IHZvZF9jaGFubmVscygiVG1WMlpYST0iKSAKCXJhYmJpdHMgPSBrYXN1dGFqYUFuZG1lZFt2b2RfY2hhbm5lbHMoImFYTmZkSEpwWVd3PSIpXQoJaWYgcmFiYml0cyA9PSAiMCI6CgkJcmFiYml0cyA9IHN5bmNfZGF0YSgiVG04PSIpCgllbHNlOgoJCXJhYmJpdHMgPSBzeW5jX2RhdGEoIldXVnoiKQoJbGVhdmVtZWFsb25lID0ga2FzdXRhamFBbmRtZWRbZ2V0X2xpdmUoImJXRjRYMk52Ym01bFkzUnBiMjV6IildCglwb2xhcmJlYXJzID0ga2FzdXRhamFBbmRtZWRbc3luY19kYXRhKCJkWE5sY201aGJXVT0iKV0KCQoJYWRkTGlua0NhbmFsTGlzdGEoIltDT0xPUiA9IHdoaXRlXVV0aWxpemFkb3I6IFsvQ09MT1JdIitwb2xhcmJlYXJzLCIiLCIiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fY29uLnBuZycpLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19jb24ucG5nJyksJycpCgkKCWFkZExpbmtDYW5hbExpc3RhKCJbQ09MT1IgPSB3aGl0ZV1Fc3RhZG86IFsvQ09MT1JdIitzZWlzLCIiLCIiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fY29uLnBuZycpLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19jb24ucG5nJyksJycpCgkKCWFkZExpbmtDYW5hbExpc3RhKCJbQ09MT1IgPSB3aGl0ZV1FeHBpcmE6IFsvQ09MT1JdIithZWd1YiwiIiwiIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX2Nvbi5wbmcnKSxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fY29uLnBuZycpLCcnKQoJCglhZGRMaW5rQ2FuYWxMaXN0YSgiW0NPTE9SID0gd2hpdGVdQ29udGEgZGUgVGVzdGU6IFsvQ09MT1JdIityYWJiaXRzLCIiLCIiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fY29uLnBuZycpLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19jb24ucG5nJyksJycpCgkKCWFkZExpbmtDYW5hbExpc3RhKCJbQ09MT1IgPSB3aGl0ZV1NYXhpbW8gZGUgQ29ubmVjOiBbL0NPTE9SXSIrbGVhdmVtZWFsb25lLCIiLCIiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fY29uLnBuZycpLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19jb24ucG5nJyksJycpCgkKCXZpc3RhX0dydXBvcygpCgpkZWYgdmFuZW1hX2x1a2sobmFtZSk6CglhID0gJ1hYWCcsICdBZHVsdCcsICdBZHVsdHMnLCdBRFVMVCcsJ0FEVUxUUycsJ2FkdWx0JywnYWR1bHRzJywnUG9ybicsJ1BPUk4nLCdwb3JuJywnUG9ybicsJ3h4eCcKCWlmIGFueShzIGluIG5hbWUgZm9yIHMgaW4gYSk6CgkJeGJtYy5leGVjdXRlYnVpbHRpbigodSdYQk1DLk5vdGlmaWNhdGlvbigiQ29udHJvbG8gUGFyZW50YWwiLCAiTyBjYW5hbCBjb250ZW0gY29udGV1ZG8gYWR1bHRvIiwgMjAwMCknKSkKCQl0ZXh0ID0gcGx1Z2ludG9vbHMua2V5Ym9hcmRfaW5wdXQoZGVmYXVsdF90ZXh0PSIiLCB0aXRsZT0iQ29kaWdvIHBhcmEgY29udHJvbG8gcGFyZW50YWwiKQoJCWlmIHRleHQ9PXBsdWdpbnRvb2xzLmdldF9zZXR0aW5nKHN5bmNfZGF0YSgiYkc5bmFXNWZZV1IxYkhSdmN3PT0iKSk6CgkJICByZXR1cm4KCQllbHNlOgoJCSAgZXhpdCgpCgllbHNlOgoJCW5hbWUgPSAiIgoKZGVmIERvd25sb2FkZXJDbGFzcyh1cmwsZGVzdCk6CglkcCA9IHhibWNndWkuRGlhbG9nUHJvZ3Jlc3MoKQoJZHAuY3JlYXRlKHN5bmNfZGF0YSgiUjJWMGRHbHVaeUIxY0dSaGRHVT0iKSxnZXRfbGl2ZSgiUkc5M2JteHZZV1JwYm1jPSIpKQoJdXJsbGliLnVybHJldHJpZXZlKHVybCxkZXN0LGxhbWJkYSBuYiwgYnMsIGZzLCB1cmw9dXJsOiBfcGJob29rKG5iLGJzLGZzLHVybCxkcCkpCgpkZWYgX3BiaG9vayhudW1ibG9ja3MsIGJsb2Nrc2l6ZSwgZmlsZXNpemUsIHVybD1Ob25lLGRwPU5vbmUpOgoJdHJ5OgoJCXBlcmNlbnQgPSBtaW4oKG51bWJsb2NrcypibG9ja3NpemUqMTAwKS9maWxlc2l6ZSwgMTAwKQoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJycrcGVyY2VudCkKCQlkcC51cGRhdGUocGVyY2VudCkKCWV4Y2VwdDoKCQlwZXJjZW50ID0gMTAwCgkJZHAudXBkYXRlKHBlcmNlbnQpCglpZiBkcC5pc2NhbmNlbGVkKCk6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnTyBkb3dubG9hZCBmb2kgY2FuY2VsYWRvLicpCgkJZHAuY2xvc2UoKQoKZGVmIHZvZF9jaGFubmVscyhjaGFubmVsKToKCXZpZGVvID0gYmFzZTY0LmI2NGRlY29kZShjaGFubmVsKQoJcmV0dXJuIHZpZGVvCgpkZWYgUGxheVVybChuYW1lLCB1cmwsIGljb25pbWFnZT1Ob25lKToKCWxpc3RpdGVtID0geGJtY2d1aS5MaXN0SXRlbShwYXRoPXVybCwgdGh1bWJuYWlsSW1hZ2U9aWNvbmltYWdlKQoJbGlzdGl0ZW0uc2V0SW5mbyh0eXBlPSJWaWRlbyIsIGluZm9MYWJlbHM9eyAiVGl0bGUiOiBuYW1lIH0pCgl4Ym1jcGx1Z2luLnNldFJlc29sdmVkVXJsKGludChzeXMuYXJndlsxXSksIFRydWUsIGxpc3RpdGVtKQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMJCQkJCQkJCQkJCQkJTWVudSBUViBBcnF1aXZvCQkJCQkJCQkJCQkgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCmRlZiBsaXN0YXR2YXJjaGl2ZSh1cmwpOgoJZW5kZXJlY28gPSB1cmwrInBsYXllcl9hcGkucGhwP3VzZXJuYW1lPSIrX19BRERPTl9fLmdldFNldHRpbmcoJ2xvZ2luX25hbWUnKSsiJnBhc3N3b3JkPSIrX19BRERPTl9fLmdldFNldHRpbmcoJ2xvZ2luX3Bhc3N3b3JkJykrIiZhY3Rpb249Z2V0X2xpdmVfc3RyZWFtcyIKCSNpSWlJSUlpID0gdXJsbGliMi51cmxvcGVuKGVuZGVyZWNvKQoJI29vbzAwT09Pb29PCT0ganNvbi5sb2FkKGlJaUlJSWkpCglyZXEgPSB1cmxsaWIyLlJlcXVlc3QoZW5kZXJlY28pCglyZXEuYWRkX2hlYWRlcihzeW5jX2RhdGEoIlZYTmxjaTFCWjJWdWRBPT0iKSAsIHZvZF9jaGFubmVscygiUzI5a2FTQndiSFZuYVc0Z1lua2dUR2wyWlNGMCIpKQoJcmVzcG9uc2UgPSB1cmxsaWIyLnVybG9wZW4ocmVxKQoJbGluaz1yZXNwb25zZS5yZWFkKCkKCW9vbzAwT09Pb29PCT0ganNvbi5sb2FkcyhsaW5rLmRlY29kZSgndXRmOCcpKQoJcmVzcG9uc2UuY2xvc2UoKQoJTzAwT09Pb09vbzBPID0gb29vMDBPT09vb09bJ2F2YWlsYWJsZV9jaGFubmVscyddCglmb3IJTzAwME9PbzAwb28JaW4JTzAwT09Pb09vbzBPLnZhbHVlcygpOgoJCW9vME9PbyA9IE8wMDBPT28wMG9vWyd0dl9hcmNoaXZlJ10KCQlpZihvbzBPT28gPT0gMSk6CgkJCW5hbWV0dj1PMDAwT09vMDBvb1snbmFtZSddCgkJCXN0cmVhbV9pZD1PMDAwT09vMDBvb1snc3RyZWFtX2lkJ10KCQkJbG9nb190dj1PMDAwT09vMDBvb1snc3RyZWFtX2ljb24nXQoJCQlkdXJhdGlvbiA9IE8wMDBPT28wMG9vWyd0dl9hcmNoaXZlX2R1cmF0aW9uJ10KCQkJCgkJCWFkZExpbmtHcnVwbyhuYW1ldHYsbG9nb190dixzdHJlYW1faWQsdXJsLGR1cmF0aW9uLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb190dl9hcmMucG5nJyksMSkKCQoJdmlzdGFfR3J1cG9zKCkKCmRlZiBsaXN0YXR2YXJjaGl2ZWNhbmFpcyhuYW1lLHN0cmVhbV9pZCx1cmwsZHVyYXRpb24saWNvbmltYWdlLGZhbmFydCk6CgllbmRlcmVjbyA9IHVybCsicGxheWVyX2FwaS5waHA/dXNlcm5hbWU9IitfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fbmFtZScpKyImcGFzc3dvcmQ9IitfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fcGFzc3dvcmQnKSsiJmFjdGlvbj1nZXRfZXBnJnN0cmVhbV9pZD0iK3N0cmVhbV9pZAoJI2lJaUlJSWkgPSB1cmxsaWIyLnVybG9wZW4oZW5kZXJlY28pCgkjaWlpSTExCT0ganNvbi5sb2FkKGlJaUlJSWkpCglyZXEgPSB1cmxsaWIyLlJlcXVlc3QoZW5kZXJlY28pCglyZXEuYWRkX2hlYWRlcihzeW5jX2RhdGEoIlZYTmxjaTFCWjJWdWRBPT0iKSAsIHZvZF9jaGFubmVscygiUzI5a2FTQndiSFZuYVc0Z1lua2dUR2wyWlNGMCIpKQoJcmVzcG9uc2UgPSB1cmxsaWIyLnVybG9wZW4ocmVxKQoJbGluaz1yZXNwb25zZS5yZWFkKCkKCWlpaUkxMQk9IGpzb24ubG9hZHMobGluay5kZWNvZGUoJ3V0ZjgnKSkKCXJlc3BvbnNlLmNsb3NlKCkKCQoJaWlJaUkgPSBkYXRldGltZS5kYXRldGltZS51dGNub3coKSAtIGRhdGV0aW1lLnRpbWVkZWx0YShkYXlzPWludChkdXJhdGlvbikpCglvMDBvb29PME9vCT1jYWxlbmRhci50aW1lZ20oaWlJaUkudGltZXR1cGxlKCkpCglvMDBvb29PME9vCT1pbnQobzAwb29vTzBPbykKCW8wTzBPT08wT29vCT10aW1lLnRpbWUoKQoJbzBPME9PTzBPb28JPWludChvME8wT09PME9vbykKCQoJZm9yCWlpSWlJSTEJaW4JaWlpSTExCToKCQl0aXRsZV90diA9IGlpSWlJSTFbJ3RpdGxlJ10KCQl0aXRsZV90dj1iYXNlNjQuYjY0ZGVjb2RlKHRpdGxlX3R2KQoJCXN0YXJ0CT0gaW50KGlpSWlJSTFbJ3N0YXJ0J10pCgkJZW5kCT0gaW50KGlpSWlJSTFbJ2VuZCddKQoJCXNlZ3VuZG8gPSAwLjAxNjY2NjY2NjcKCQkKCQlkdXJhY2FvID0gaW50KChlbmQtc3RhcnQpKnNlZ3VuZG8pCgkJCgkJaWYoc3RhcnQgPiBvMDBvb29PME9vIGFuZCBzdGFydCA8IG8wTzBPT08wT29vKToKCQkJaWYgOTAgLSA5MDoJT29vMAklCU9vMG9vTzBvbzBvTwkvCU9vMG9PMG9vbwoJCQlJSWkgPSBkYXRldGltZS5kYXRldGltZS5mcm9tdGltZXN0YW1wKGludChzdGFydCkpLnN0cmZ0aW1lKCclZC4lbSAlSDolTScpCgkJCWkxSWlpMWkxSSA9IGRhdGV0aW1lLmRhdGV0aW1lLmZyb210aW1lc3RhbXAoaW50KHN0YXJ0KSkuc3RyZnRpbWUoJyVZLSVtLSVkOiVIOiVNJykKCQkJdGl0bGVfdHYgPSBJSWkgKyAiICIgKyB0aXRsZV90dgoJCQllbmRlcmVjbyA9IHVybCsic3RyZWFtaW5nL3RpbWVzaGlmdC5waHA/dXNlcm5hbWU9IitfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fbmFtZScpKyImcGFzc3dvcmQ9IitfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fcGFzc3dvcmQnKSsiJnN0cmVhbT0iK3N0cmVhbV9pZCsiJnN0YXJ0PSIraTFJaWkxaTFJKyImZHVyYXRpb249IitzdHIoZHVyYWNhbykKCQkJCgkJCWFkZExpbmtDYW5hbCh0aXRsZV90dixlbmRlcmVjbyxpY29uaW1hZ2UsJzAwMDEnLCcnKQoJCgl2aXN0YV9DYW5haXMoKQoKZGVmIGFkZExpbmtHcnVwbyh0aXRsZSx0aHVtYm5haWwsc3RyZWFtX2lkLHVybCxkdXJhdGlvbixmYW5hcnQsdHlwZSk6Cglvaz1UcnVlCgkKCWxpc3RpdGVtPXhibWNndWkuTGlzdEl0ZW0odGl0bGUsaWNvbkltYWdlPXRodW1ibmFpbCx0aHVtYm5haWxJbWFnZT10aHVtYm5haWwpCglpbmZvX2xhYmVscz17IlRpdGxlIjp0aXRsZSwiRmlsZU5hbWUiOnRpdGxlfQoJbGlzdGl0ZW0uc2V0SW5mbyggInZpZGVvIiwgaW5mb19sYWJlbHMgKQoJbGlzdGl0ZW0uc2V0UHJvcGVydHkoJ2ZhbmFydF9pbWFnZScsZmFuYXJ0KQoJeGJtY3BsdWdpbi5zZXRQbHVnaW5GYW5hcnQoaW50KHN5cy5hcmd2WzFdKSxmYW5hcnQpCgkKCXUgPSBzeXMuYXJndlswXSArICI/dXJsPSIgKyBzdHIodXJsKSArICImbW9kZT03Jm5hbWU9IiArIHN0cih0aXRsZSkgKyAiJmljb25pbWFnZT0iK3N0cih0aHVtYm5haWwpKyImZmFuYXJ0PSIrc3RyKGZhbmFydCkrIiZzdHJlYW1faWQ9IitzdHIoc3RyZWFtX2lkKSsiJmR1cmF0aW9uPSIrZHVyYXRpb24KCQoJb2s9eGJtY3BsdWdpbi5hZGREaXJlY3RvcnlJdGVtKGhhbmRsZT1pbnQoc3lzLmFyZ3ZbMV0pLHVybD11LGxpc3RpdGVtPWxpc3RpdGVtLGlzRm9sZGVyPVRydWUpCgkKCXJldHVybiBvawoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMJCQkJCQkJCQkJCQkJQWJyaXIgU2V0dGluZwkJCQkJCQkJCQkgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCmRlZiBhYnJpckRlZmluaW5jb2VzKCk6CglfX0FERE9OX18ub3BlblNldHRpbmdzKCkKCXZpc3RhX21lbnUoKQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyMjCQlDbGVhciBDYWNoZQkJIyMjCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpkZWYgQ0xFQVJDQUNIRSgpOgoJeGJtY19jYWNoZV9wYXRoID0gb3MucGF0aC5qb2luKHhibWMudHJhbnNsYXRlUGF0aCgnc3BlY2lhbDovL2hvbWUnKSwgJ2NhY2hlJykKCWlmIG9zLnBhdGguZXhpc3RzKHhibWNfY2FjaGVfcGF0aCk9PVRydWU6CQoJCWZvciByb290LCBkaXJzLCBmaWxlcyBpbiBvcy53YWxrKHhibWNfY2FjaGVfcGF0aCk6CgkJCWZpbGVfY291bnQgPSAwCgkJCWZpbGVfY291bnQgKz0gbGVuKGZpbGVzKQoJCQlpZiBmaWxlX2NvdW50ID4gMDoKCQoJCQkJZGlhbG9nID0geGJtY2d1aS5EaWFsb2coKQoJCQkJaWYgZGlhbG9nLnllc25vKCJBcGFnYXIgQ2FjaGUgbm8gWEJNQy4iLCBzdHIoZmlsZV9jb3VudCkgKyAiIGZpY2hlaXJvcyBlbmNvbnRyYWRvcy4iLCAiUXVlciBhcGFnYXIgdG9kb3Mgb3MgZmljaGVpcm9zIGVtIGNhY2hlPyIpOgoJCQkJCgkJCQkJZm9yIGYgaW4gZmlsZXM6CgkJCQkJCXRyeToKCQkJCQkJCW9zLnVubGluayhvcy5wYXRoLmpvaW4ocm9vdCwgZikpCgkJCQkJCWV4Y2VwdDoKCQkJCQkJCXBhc3MKCQkJCQlmb3IgZCBpbiBkaXJzOgoJCQkJCQl0cnk6CgkJCQkJCQlzaHV0aWwucm10cmVlKG9zLnBhdGguam9pbihyb290LCBkKSkKCQkJCQkJZXhjZXB0OgoJCQkJCQkJcGFzcwoJCQkJCQkKCQkJZWxzZToKCQkJCXBhc3MKCWlmIHhibWMuZ2V0Q29uZFZpc2liaWxpdHkoJ3N5c3RlbS5wbGF0Zm9ybS5BVFYyJyk6CgkJYXR2Ml9jYWNoZV9hID0gb3MucGF0aC5qb2luKCcvcHJpdmF0ZS92YXIvbW9iaWxlL0xpYnJhcnkvQ2FjaGVzL0FwcGxlVFYvVmlkZW8vJywgJ090aGVyJykKCQkKCQlmb3Igcm9vdCwgZGlycywgZmlsZXMgaW4gb3Mud2FsayhhdHYyX2NhY2hlX2EpOgoJCQlmaWxlX2NvdW50ID0gMAoJCQlmaWxlX2NvdW50ICs9IGxlbihmaWxlcykKCQkKCQkJaWYgZmlsZV9jb3VudCA+IDA6CgoJCQkJZGlhbG9nID0geGJtY2d1aS5EaWFsb2coKQoJCQkJaWYgZGlhbG9nLnllc25vKCJBcGFnYXIgZmljaGVpcm9zIEFUVjIuIiwgc3RyKGZpbGVfY291bnQpICsgIiBmaWNoZWlyb3MgZW5jb250cmFkb3MgZW0gJ091dHJvcyciLCAiUXVlciBhcGFnYXIgdG9kb3Mgb3MgZmljaGVpcm9zIGVtIGNhY2hlPyIpOgoJCQkJCgkJCQkJZm9yIGYgaW4gZmlsZXM6CgkJCQkJCW9zLnVubGluayhvcy5wYXRoLmpvaW4ocm9vdCwgZikpCgkJCQkJZm9yIGQgaW4gZGlyczoKCQkJCQkJc2h1dGlsLnJtdHJlZShvcy5wYXRoLmpvaW4ocm9vdCwgZCkpCgkJCQkJCQoJCQllbHNlOgoJCQkJcGFzcwoJCWF0djJfY2FjaGVfYiA9IG9zLnBhdGguam9pbignL3ByaXZhdGUvdmFyL21vYmlsZS9MaWJyYXJ5L0NhY2hlcy9BcHBsZVRWL1ZpZGVvLycsICdMb2NhbEFuZFJlbnRhbCcpCgkJCgkJZm9yIHJvb3QsIGRpcnMsIGZpbGVzIGluIG9zLndhbGsoYXR2Ml9jYWNoZV9iKToKCQkJZmlsZV9jb3VudCA9IDAKCQkJZmlsZV9jb3VudCArPSBsZW4oZmlsZXMpCgkJCgkJCWlmIGZpbGVfY291bnQgPiAwOgoKCQkJCWRpYWxvZyA9IHhibWNndWkuRGlhbG9nKCkKCQkJCWlmIGRpYWxvZy55ZXNubygiQXBhZ2FyIGZpY2hlaXJvcyBBVFYyLiIsIHN0cihmaWxlX2NvdW50KSArICIgZmljaGVpcm9zIGVuY29udHJhZG9zIGVtICdMb2NhbCciLCAiUXVlciBhcGFnYXIgdG9kb3Mgb3MgZmljaGVpcm9zIGVtIGNhY2hlPyIpOgoJCQkJCgkJCQkJZm9yIGYgaW4gZmlsZXM6CgkJCQkJCW9zLnVubGluayhvcy5wYXRoLmpvaW4ocm9vdCwgZikpCgkJCQkJZm9yIGQgaW4gZGlyczoKCQkJCQkJc2h1dGlsLnJtdHJlZShvcy5wYXRoLmpvaW4ocm9vdCwgZCkpCgkJCQkJCQoJCQllbHNlOgoJCQkJcGFzcwoJCQkgICMgU2V0IHBhdGggdG8gQ3lkaWEgQXJjaGl2ZXMgY2FjaGUgZmlsZXMKCQkJCQkJCSAKCgkjIFNldCBwYXRoIHRvIFdoYXQgdGggRnVyayBjYWNoZSBmaWxlcwoJd3RmX2NhY2hlX3BhdGggPSBvcy5wYXRoLmpvaW4oeGJtYy50cmFuc2xhdGVQYXRoKCdzcGVjaWFsOi8vcHJvZmlsZS9hZGRvbl9kYXRhL3BsdWdpbi52aWRlby53aGF0dGhlZnVyay9jYWNoZScpLCAnJykKCWlmIG9zLnBhdGguZXhpc3RzKHd0Zl9jYWNoZV9wYXRoKT09VHJ1ZToJCgkJZm9yIHJvb3QsIGRpcnMsIGZpbGVzIGluIG9zLndhbGsod3RmX2NhY2hlX3BhdGgpOgoJCQlmaWxlX2NvdW50ID0gMAoJCQlmaWxlX2NvdW50ICs9IGxlbihmaWxlcykKCQkKCQkjIENvdW50IGZpbGVzIGFuZCBnaXZlIG9wdGlvbiB0byBkZWxldGUKCQkJaWYgZmlsZV9jb3VudCA+IDA6CgkKCQkJCWRpYWxvZyA9IHhibWNndWkuRGlhbG9nKCkKCQkJCWlmIGRpYWxvZy55ZXNubygiQXBhZ2FyIGEgY2FjaGUgV1RGLiIsIHN0cihmaWxlX2NvdW50KSArICIgZmljaGVpcm9zIGVuY29udHJhZG9zLiIsICJRdWVyIGFwYWdhciB0b2RvcyBvcyBmaWNoZWlyb3MgZW0gY2FjaGU/Iik6CgkJCQkKCQkJCQlmb3IgZiBpbiBmaWxlczoKCQkJCQkJb3MudW5saW5rKG9zLnBhdGguam9pbihyb290LCBmKSkKCQkJCQlmb3IgZCBpbiBkaXJzOgoJCQkJCQlzaHV0aWwucm10cmVlKG9zLnBhdGguam9pbihyb290LCBkKSkKCQkJCQkJCgkJCWVsc2U6CgkJCQlwYXNzCgkJCQkKCQkJCSMgU2V0IHBhdGggdG8gNG9EIGNhY2hlIGZpbGVzCgljaGFubmVsNF9jYWNoZV9wYXRoPSBvcy5wYXRoLmpvaW4oeGJtYy50cmFuc2xhdGVQYXRoKCdzcGVjaWFsOi8vcHJvZmlsZS9hZGRvbl9kYXRhL3BsdWdpbi52aWRlby40b2QvY2FjaGUnKSwgJycpCglpZiBvcy5wYXRoLmV4aXN0cyhjaGFubmVsNF9jYWNoZV9wYXRoKT09VHJ1ZToJCgkJZm9yIHJvb3QsIGRpcnMsIGZpbGVzIGluIG9zLndhbGsoY2hhbm5lbDRfY2FjaGVfcGF0aCk6CgkJCWZpbGVfY291bnQgPSAwCgkJCWZpbGVfY291bnQgKz0gbGVuKGZpbGVzKQoJCQoJCSMgQ291bnQgZmlsZXMgYW5kIGdpdmUgb3B0aW9uIHRvIGRlbGV0ZQoJCQlpZiBmaWxlX2NvdW50ID4gMDoKCQoJCQkJZGlhbG9nID0geGJtY2d1aS5EaWFsb2coKQoJCQkJaWYgZGlhbG9nLnllc25vKCJBcGFnYXIgZmljaGVpcm9zIDRvRCBlbSBjYWNoZS4iLCBzdHIoZmlsZV9jb3VudCkgKyAiIGZpY2hlaXJvcyBlbmNvbnRyYWRvcy4iLCAiUXVlciBhcGFnYXIgdG9kb3Mgb3MgZmljaGVpcm9zIGVtIGNhY2hlPyIpOgoJCQkJCgkJCQkJZm9yIGYgaW4gZmlsZXM6CgkJCQkJCW9zLnVubGluayhvcy5wYXRoLmpvaW4ocm9vdCwgZikpCgkJCQkJZm9yIGQgaW4gZGlyczoKCQkJCQkJc2h1dGlsLnJtdHJlZShvcy5wYXRoLmpvaW4ocm9vdCwgZCkpCgkJCQkJCQoJCQllbHNlOgoJCQkJcGFzcwoJCQkJCgkJCQkjIFNldCBwYXRoIHRvIEJCQyBpUGxheWVyIGNhY2hlIGZpbGVzCglpcGxheWVyX2NhY2hlX3BhdGg9IG9zLnBhdGguam9pbih4Ym1jLnRyYW5zbGF0ZVBhdGgoJ3NwZWNpYWw6Ly9wcm9maWxlL2FkZG9uX2RhdGEvcGx1Z2luLnZpZGVvLmlwbGF5ZXIvaXBsYXllcl9odHRwX2NhY2hlJyksICcnKQoJaWYgb3MucGF0aC5leGlzdHMoaXBsYXllcl9jYWNoZV9wYXRoKT09VHJ1ZToJCgkJZm9yIHJvb3QsIGRpcnMsIGZpbGVzIGluIG9zLndhbGsoaXBsYXllcl9jYWNoZV9wYXRoKToKCQkJZmlsZV9jb3VudCA9IDAKCQkJZmlsZV9jb3VudCArPSBsZW4oZmlsZXMpCgkJCgkJIyBDb3VudCBmaWxlcyBhbmQgZ2l2ZSBvcHRpb24gdG8gZGVsZXRlCgkJCWlmIGZpbGVfY291bnQgPiAwOgoJCgkJCQlkaWFsb2cgPSB4Ym1jZ3VpLkRpYWxvZygpCgkJCQlpZiBkaWFsb2cueWVzbm8oIkFwYWdhciBmaWNoZWlyb3MgQkJDIGlQbGF5ZXIgZW0gY2FjaGUuIiwgc3RyKGZpbGVfY291bnQpICsgIiBmaWNoZWlyb3MgZW5jb250cmFkb3MuIiwgIlF1ZXIgYXBhZ2FyIHRvZG9zIG9zIGZpY2hlaXJvcyBlbSBjYWNoZT8iKToKCQkJCQoJCQkJCWZvciBmIGluIGZpbGVzOgoJCQkJCQlvcy51bmxpbmsob3MucGF0aC5qb2luKHJvb3QsIGYpKQoJCQkJCWZvciBkIGluIGRpcnM6CgkJCQkJCXNodXRpbC5ybXRyZWUob3MucGF0aC5qb2luKHJvb3QsIGQpKQoJCQkJCQkKCQkJZWxzZToKCQkJCXBhc3MKCQkJCQoJCQkJCgkJCQkjIFNldCBwYXRoIHRvIFNpbXBsZSBEb3dubG9hZGVyIGNhY2hlIGZpbGVzCglkb3dubG9hZGVyX2NhY2hlX3BhdGggPSBvcy5wYXRoLmpvaW4oeGJtYy50cmFuc2xhdGVQYXRoKCdzcGVjaWFsOi8vcHJvZmlsZS9hZGRvbl9kYXRhL3NjcmlwdC5tb2R1bGUuc2ltcGxlLmRvd25sb2FkZXInKSwgJycpCglpZiBvcy5wYXRoLmV4aXN0cyhkb3dubG9hZGVyX2NhY2hlX3BhdGgpPT1UcnVlOgkKCQlmb3Igcm9vdCwgZGlycywgZmlsZXMgaW4gb3Mud2Fsayhkb3dubG9hZGVyX2NhY2hlX3BhdGgpOgoJCQlmaWxlX2NvdW50ID0gMAoJCQlmaWxlX2NvdW50ICs9IGxlbihmaWxlcykKCQkKCQkjIENvdW50IGZpbGVzIGFuZCBnaXZlIG9wdGlvbiB0byBkZWxldGUKCQkJaWYgZmlsZV9jb3VudCA+IDA6CgkKCQkJCWRpYWxvZyA9IHhibWNndWkuRGlhbG9nKCkKCQkJCWlmIGRpYWxvZy55ZXNubygiQXBhZ2FyIGZpY2hlaXJvcyBTaW1wbGUgRG93bmxvYWRlciBlbSBjYWNoZS4iLCBzdHIoZmlsZV9jb3VudCkgKyAiIGZpY2hlaXJvcyBlbmNvbnRyYWRvcy4iLCAiUXVlciBhcGFnYXIgdG9kb3Mgb3MgZmljaGVpcm9zIGVtIGNhY2hlPyIpOgoJCQkJCgkJCQkJZm9yIGYgaW4gZmlsZXM6CgkJCQkJCW9zLnVubGluayhvcy5wYXRoLmpvaW4ocm9vdCwgZikpCgkJCQkJZm9yIGQgaW4gZGlyczoKCQkJCQkJc2h1dGlsLnJtdHJlZShvcy5wYXRoLmpvaW4ocm9vdCwgZCkpCgkJCQkJCQoJCQllbHNlOgoJCQkJcGFzcwoJCglpdHZfY2FjaGVfcGF0aCA9IG9zLnBhdGguam9pbih4Ym1jLnRyYW5zbGF0ZVBhdGgoJ3NwZWNpYWw6Ly9wcm9maWxlL2FkZG9uX2RhdGEvcGx1Z2luLnZpZGVvLml0di9JbWFnZXMnKSwgJycpCglpZiBvcy5wYXRoLmV4aXN0cyhpdHZfY2FjaGVfcGF0aCk9PVRydWU6CQoJCWZvciByb290LCBkaXJzLCBmaWxlcyBpbiBvcy53YWxrKGl0dl9jYWNoZV9wYXRoKToKCQkJZmlsZV9jb3VudCA9IDAKCQkJZmlsZV9jb3VudCArPSBsZW4oZmlsZXMpCgkJCQoJCQlpZiBmaWxlX2NvdW50ID4gMDoKCQoJCQkJZGlhbG9nID0geGJtY2d1aS5EaWFsb2coKQoJCQkJaWYgZGlhbG9nLnllc25vKCJBcGFnYXIgaXRlbXMgZW0gY2FjaGUiLCBzdHIoZmlsZV9jb3VudCkgKyAiIGZpY2hlaXJvcyBlbmNvbnRyYWRvcy4iLCAiUXVlciBhcGFnYXIgdG9kb3Mgb3MgZmljaGVpcm9zIGVtIGNhY2hlPyIpOgoJCQkJCgkJCQkJZm9yIGYgaW4gZmlsZXM6CgkJCQkJCW9zLnVubGluayhvcy5wYXRoLmpvaW4ocm9vdCwgZikpCgkJCQkJZm9yIGQgaW4gZGlyczoKCQkJCQkJc2h1dGlsLnJtdHJlZShvcy5wYXRoLmpvaW4ocm9vdCwgZCkpCgkJCQkJCQoJCQllbHNlOgoJCQkJcGFzcwoJZGlhbG9nID0geGJtY2d1aS5EaWFsb2coKQoJZGlhbG9nLm9rKEFkZG9uVGl0bGUsICIJCUNhY2hlIGFwYWdhZGEgY29tIHN1Y2Vzc28hIikKCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIyMJIFB1cmdlIFBhY2thZ2VzCQkjIyMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCmRlZiBQVVJHRVBBQ0tBR0VTKCk6CglwYWNrYWdlc19jYWNoZV9wYXRoID0geGJtYy50cmFuc2xhdGVQYXRoKG9zLnBhdGguam9pbignc3BlY2lhbDovL2hvbWUvYWRkb25zL3BhY2thZ2VzJywgJycpKQoJdHJ5OgkKCQlmb3Igcm9vdCwgZGlycywgZmlsZXMgaW4gb3Mud2FsayhwYWNrYWdlc19jYWNoZV9wYXRoKToKCQkJZmlsZV9jb3VudCA9IDAKCQkJZmlsZV9jb3VudCArPSBsZW4oZmlsZXMpCgkJCQoJCQlpZiBmaWxlX2NvdW50ID4gMDoKCQoJCQkJZGlhbG9nID0geGJtY2d1aS5EaWFsb2coKQoJCQkJaWYgZGlhbG9nLnllc25vKCJFeGNsdWlyIGluZm9ybWHDp8OjbyBlbSBDYWNoZS4iLCBzdHIoZmlsZV9jb3VudCkgKyAiIGZpY2hlaXJvcyBlbmNvbnRyYWRvcy4iLCAiUXVlciBhcGFnYXIgdG9kb3Mgb3MgZmljaGVpcm9zPyIpOgoJCQkJCQkJCgkJCQkJZm9yIGYgaW4gZmlsZXM6CgkJCQkJCW9zLnVubGluayhvcy5wYXRoLmpvaW4ocm9vdCwgZikpCgkJCQkJZm9yIGQgaW4gZGlyczoKCQkJCQkJc2h1dGlsLnJtdHJlZShvcy5wYXRoLmpvaW4ocm9vdCwgZCkpCgkJCQkJZGlhbG9nID0geGJtY2d1aS5EaWFsb2coKQoJCQkJCWRpYWxvZy5vayhBZGRvblRpdGxlLCAiCQlLb2RpIGxpbXBvIGNvbSBzdWNlc3NvLiIpCgkJCQllbHNlOgoJCQkJCQlwYXNzCgkJCWVsc2U6CgkJCQlkaWFsb2cgPSB4Ym1jZ3VpLkRpYWxvZygpCgkJCQlkaWFsb2cub2soQWRkb25UaXRsZSwgIgkJTsOjbyBmb3JhbSBlbmNvbnRyYWRvcyBmaWNoZWlyb3MgYSBhcGFnYXIuIikKCWV4Y2VwdDogCgkJZGlhbG9nID0geGJtY2d1aS5EaWFsb2coKQoJCWRpYWxvZy5vayhBZGRvblRpdGxlLCAiRXJybyBhbyB0ZW50YXIgYXBhZ2FyIGZpY2hlaXJvcyBlbSBjYWNoZS4iKQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMJCQkJCQkJCQkJCQlBZGRvbiBMSVZFSVQgRmlsbWVzIGUgU2VyaWVzCQkJCQkJCSAjCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwpkZWYgZGV2b2x2ZXJlc3VsdGFkbyh1cmxub28pOgoJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybG5vbywgaGVhZGVyPWhlYWRlcnMpCgl0cnk6CgkJcmVzdWx0YWRvID0gcmVzdWx0YWRvLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OgoJCXJlc3VsdGFkbyA9IHJlc3VsdGFkby5lbmNvZGUoJ3V0Zi04JykKCXJldHVybiByZXN1bHRhZG8KCmRlZiBnZXRDYXRlZ29yaWFsaXZlKGlkLGluaWNpbyk6CgljYXQgPSBsZXJfZmljaGVpcm8ob3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnY2F0ZWdvcmlhc19saXZlLmxpdmVpdCcpKS5yZXBsYWNlKCciJywgIiciKQoJcmV0dXJuIGNhdAoJCmRlZiBnZXRTYWdhc2xpdmUoaWQsaW5pY2lvKToKCWNhdCA9IGxlcl9maWNoZWlybyhvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdzYWdhc19saXZlLmxpdmVpdCcpKS5yZXBsYWNlKCciJywgIiciKQoJcmV0dXJuIGNhdAoKZGVmIGdldEFub3NsaXZlKGlkLGluaWNpbyk6CgljYXQgPSBsZXJfZmljaGVpcm8ob3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnYW5vc19saXZlLmxpdmVpdCcpKS5yZXBsYWNlKCciJywgIiciKQoJcmV0dXJuIGNhdAoKZGVmIGxvZ2lubGlsaShpbmljaW8pOgoJcmVzdWx0YWRvID0gRmFsc2UKCWVycm9zID0gIiIKCXRyeToKCQl1cmxub28gPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmYWRkb249MSZ0aXBvPScraW5pY2lvCgkJcmVzdWx0YWRvID0gZGV2b2x2ZXJlc3VsdGFkbyh1cmxub28pCgkJZXNjcmV2ZXJfZmljaGVpcm8ob3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnZGVmaW5pY29lc19saXZlLmxpdmVpdCcpLCByZXN1bHRhZG8pCgkJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pCgkJY2F0ZWdvcmlhcyA9IHJlc3VsdGFkb1snZ3J1cG9zJ10KCQllc2NyZXZlcl9maWNoZWlybyhvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdjYXRlZ29yaWFzX2xpdmUubGl2ZWl0JyksIHN0cihjYXRlZ29yaWFzKSkKCQlhbm9zID0gcmVzdWx0YWRvWydhbm9zJ10KCQllc2NyZXZlcl9maWNoZWlybyhvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdhbm9zX2xpdmUubGl2ZWl0JyksIHN0cihhbm9zKSkKCQkKCQlpZiBpbmljaW8gPT0gJ2luaWNpb19maWxtZXMnOgoJCQlzYWdhcyA9IHJlc3VsdGFkb1snc2FnYXMnXQoJCQllc2NyZXZlcl9maWNoZWlybyhvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdzYWdhc19saXZlLmxpdmVpdCcpLCBzdHIoc2FnYXMpKQoJCXJldHVybiBUcnVlCglleGNlcHQ6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnTsOjbyBmb2kgcG9zc8OtdmVsIGFicmlyIGEgcMOhZ2luYS4gUG9yIGZhdm9yIHRlbnRlIG5vdmFtZW50ZS4nKQoJCXJldHVybiBGYWxzZQoKZGVmIGxpc3RhbWVudXNfbGl2ZWl0MSgpOgoJY2hlY2tfbG9naW4gPSBsb2dpbmxpbGkoJ2luaWNpb19maWxtZXMnKQoJaWYgY2hlY2tfbG9naW4gPT0gVHJ1ZToKCQltZW51RmlsbWVzMihvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZmlsbWVzLnBuZycpLF9fU0lURUFkZG9uX18rJ0ltYWdlbnMvZmlsbWVzX2ZhbmFydC5wbmcnKQoJZWxzZToKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdFcnJvIGEgZmF6ZXIgbG9naW4gbmVzdGEgcGFydGUuIFRlbnRlIG5vdmFtZW50ZSBtYWlzIHRhcmRlLicpCgpkZWYgbGlzdGFtZW51c19saXZlaXQyKCk6CgljaGVja19sb2dpbiA9IGxvZ2lubGlsaSgnaW5pY2lvX3NlcmllcycpCglpZiBjaGVja19sb2dpbiA9PSBUcnVlOgoJCW1lbnVTZXJpZXMyKG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdzZXJpZXMucG5nJyksX19TSVRFQWRkb25fXysnSW1hZ2Vucy9zZXJpZXNfZmFuYXJ0LnBuZycpCgllbHNlOgoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0Vycm8gYSBmYXplciBsb2dpbiBuZXN0YSBwYXJ0ZS4gVGVudGUgbm92YW1lbnRlIG1haXMgdGFyZGUuJykKCmRlZiBtZW51RmlsbWVzMihpY29uaW1hZ2UsZmFuYXJ0KToKCWFkZERpcjIoJ1RvZG9zIG9zIEZpbG1lcycsIF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPWZpbG1lcyZnZW5lcm89dG9kb3MmYWRkb249MScsIDExMTExLCAnZmlsbWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdUb2RvcyBvcyBEZXN0YXF1ZXMnLCBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1maWxtZXMmZ2VuZXJvPWRlc3RhcXVlcyZhZGRvbj0xJywgMTExMTEsICdmaWxtZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ1RvZGFzIGFzIFNhZ2FzJywgX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89ZmlsbWVzJmdlbmVybz1zYWdhcyZhZGRvbj0xJywgMTExMTk5LCAnZmlsbWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdQb3IgQW5vJywgX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89ZmlsbWVzJmdlbmVybz1hbm9zJmFkZG9uPTEnLCAxMTExOCwgJ2ZpbG1lcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignUG9yIENhdGVnb3JpYScsIF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPWZpbG1lcyZnZW5lcm89Y2F0ZWdvcmlhJmFkZG9uPTEnLCAxMTExOSwgJ2ZpbG1lcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignUG9yIFJhdGluZycsIF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPWZpbG1lcyZnZW5lcm89cmF0aW5nJmFkZG9uPTEnLCAxMTExMSwgJ2ZpbG1lcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignUGFyYSBDcmlhbsOnYXMnLCBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1maWxtZXMmZ2VuZXJvPWtpZHMmYWRkb249MScsIDExMTExLCAnZmlsbWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdbQ09MT1IgcGlua11bQl1QZXNxdWlzYVsvQl1bL0NPTE9SXScsIF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPWZpbG1lcyZhZGRvbj0xJywgMTExMjAsICdmaWxtZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCXZpc3RhX21lbnUoKQoKZGVmIG1lbnVTZXJpZXMyKGljb25pbWFnZSxmYW5hcnQpOgoJYWRkRGlyMignVG9kYXMgU2VyaWVzJywgX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89c2VyaWVzJmdlbmVybz10b2RvcyZhZGRvbj0xJywgMTExMTIsICdzZXJpZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ1RvZG9zIG9zIERlc3RhcXVlcycsIF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPXNlcmllcyZnZW5lcm89ZGVzdGFxdWVzJmFkZG9uPTEnLCAxMTExMiwgJ3NlcmllcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignUG9yIEFubycsIF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPXNlcmllcyZnZW5lcm89YW5vcyZhZGRvbj0xJywgMTExMTgsICdzZXJpZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ1BvciBDYXRlZ29yaWEnLCBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1zZXJpZXMmZ2VuZXJvPWNhdGVnb3JpYSZhZGRvbj0xJywgMTExMTksICdzZXJpZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ1BvciBSYXRpbmcnLCBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1zZXJpZXMmZ2VuZXJvPXJhdGluZyZhZGRvbj0xJywgMTExMTIsICdzZXJpZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ1BhcmEgQ3JpYW7Dp2FzJywgX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89c2VyaWVzJmdlbmVybz1raWRzJmFkZG9uPTEnLCAxMTExMiwgJ3NlcmllcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignW0NPTE9SIHBpbmtdW0JdUGVzcXVpc2FbL0JdWy9DT0xPUl0nLCBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1zZXJpZXMmYWRkb249MScsIDExMTIwLCAnc2VyaWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCgl2aXN0YV9tZW51KCkKCQpkZWYgZmlsbWVzMih1cmwpOgoJcmVzdWx0YWRvID0gZGV2b2x2ZXJlc3VsdGFkbyh1cmwpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCWZvciBpIGluIHJlc3VsdGFkb1snaXRlbSddOgoJCXNldEZpbG1lMihpKQoJCgljdXJyZW50ID0gcmVzdWx0YWRvWydwYWdpbmFjYW8nXVsnYXR1YWwnXQoJdG90YWwgPSAwCgl0cnk6IHRvdGFsID0gcmVzdWx0YWRvWydwYWdpbmFjYW8nXVsndG90YWwnXQoJZXhjZXB0OiBwYXNzCgl0cnk6IHByb3hpbW8gPSBiYXNlNjQuYjY0ZGVjb2RlKHJlc3VsdGFkb1sncGFnaW5hY2FvJ11bJ3NlZ3VpbnRlJ10pCglleGNlcHQ6IHBhc3MKCWlmIGludChjdXJyZW50KSA8IGludCh0b3RhbCk6CgkJYWRkRGlyMignUHLDs3hpbWEgcMOhZ2luYSAoJytzdHIoY3VycmVudCkrJy8nK3N0cih0b3RhbCkrJyknLCBwcm94aW1vLCAxMTExMSwgJ2ZpbG1lcycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdwcm94aW1vLnBuZycpLDEpCgl2aXN0YV9maWxtZXNTZXJpZXMoKQoJCQpkZWYgc2VyaWVzMih1cmwpOgoJcmVzdWx0YWRvID0gZGV2b2x2ZXJlc3VsdGFkbyh1cmwpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCQoJZm9yIGkgaW4gcmVzdWx0YWRvWydpdGVtJ106CgkJc2V0U2VyaWVzMihpKQoJCgljdXJyZW50ID0gcmVzdWx0YWRvWydwYWdpbmFjYW8nXVsnYXR1YWwnXQoJdG90YWwgPSAwCgl0cnk6IHRvdGFsID0gcmVzdWx0YWRvWydwYWdpbmFjYW8nXVsndG90YWwnXQoJZXhjZXB0OiBwYXNzCgl0cnk6IHByb3hpbW8gPSBiYXNlNjQuYjY0ZGVjb2RlKHJlc3VsdGFkb1sncGFnaW5hY2FvJ11bJ3NlZ3VpbnRlJ10pCglleGNlcHQ6IHBhc3MKCWlmIGludChjdXJyZW50KSA8IGludCh0b3RhbCk6CgkJYWRkRGlyMignUHJveGltYSBwYWdpbmEgKCcrc3RyKGN1cnJlbnQpKycvJytzdHIodG90YWwpKycpJywgcHJveGltbywgMTExMTIsICdzZXJpZXMnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncHJveGltby5wbmcnKSkKCXZpc3RhX2ZpbG1lc1NlcmllcygpCgkKCQpkZWYgc2V0RmlsbWUyKGkpOgoJY2F0ZWdvcmlhID0gIiIKCXRyeTogY2F0ZWdvcmlhID0gYmFzZTY0LmI2NGRlY29kZShpWydHcnVwbyddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglncnVwbzIgPSAiIgoJdHJ5OiBncnVwbzIgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0dydXBvMiddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcyAKCQoJZ3J1cG8zID0gIiIKCXRyeTogZ3J1cG8zID0gYmFzZTY0LmI2NGRlY29kZShpWydHcnVwbzMnXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJaWYgZ3J1cG8yICE9ICIiOgoJCWNhdGVnb3JpYSArPSAnLCcrZ3J1cG8yCglpZiBncnVwbzMgIT0gIiI6CgkJY2F0ZWdvcmlhICs9ICcsJytncnVwbzMKCQoJcHQgPSAnJwoJYnIgPSAnJwoJc2VtTGVnZW5kYSA9ICcnCglpZF92aWRlbyA9IGlbJ0lEJ10KCQoJbm9tZSA9ICcnCgl0cnk6IG5vbWUgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ05vbWUnXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJbm9tZWVuID0gJycKCXRyeTogbm9tZWVuID0gYmFzZTY0LmI2NGRlY29kZShpWydOb21lRU4nXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJZGVzY3JpY2FvID0gJycKCXRyeTogZGVzY3JpY2FvID0gYmFzZTY0LmI2NGRlY29kZShpWydEZXNjcmljYW8nXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJcmVhbGl6YWRvciA9ICcnCgl0cnk6IHJlYWxpemFkb3IgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ1JlYWxpemFkb3InXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJYWN0b3JlcyA9ICcnCgl0cnk6IGFjdG9yZXMgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0FjdG9yZXMnXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJeW91dHViZSA9ICcnCgl0cnk6IHlvdXR1YmUgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ1lvdXR1YmUnXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJdXJsMSA9ICcnCgl0cnk6IHVybDEgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ1VybCddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCgl1cmwyID0gJycKCXRyeTogdXJsMiA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnVXJsMSddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCgl1cmwzID0gJycKCXRyeTogdXJsMyA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnVXJsMiddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCgl1cmw0ID0gJycKCXRyeTogdXJsNCA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnVXJsMyddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglpbWRiID0gJycKCXRyeTogaW1kYiA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnSW1kYiddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglpbWFnZW0gPSAnJwoJdHJ5OiBpbWFnZW0gPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0ltYWdlbSddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglsZWdlbmRhcyA9ICcnCgl0cnk6IGxlZ2VuZGFzID0gYmFzZTY0LmI2NGRlY29kZShpWydMZWdlbmRhcyddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglhbm9zID0gaVsnQW5vTm92byddCgkKCWlmICdodHRwJyBub3QgaW4gaW1hZ2VtOgoJCWltYWdlbSA9IF9fQVBJX18raW1hZ2VtCgkKCWlmIGxlZ2VuZGFzID09ICJzZW1sZWdlbmRhIiBvciBpWydMZWdlbmRhcyddID09ICIiOgoJCXNlbUxlZ2VuZGEgPSAnW0NPTE9SIHJlZF1bQl1TLyBMRUdFTkRBIFsvQl1bL0NPTE9SXScKCWlmICdCcmFzaWxlaXJvJyBpbiBjYXRlZ29yaWE6CgkJYnIgPSAnW0JdW0NPTE9SIGdyZWVuXUJbL0NPTE9SXVtDT0xPUiB5ZWxsb3ddUlsvQ09MT1JdOiBbL0JdJwoJaWYgJ1BvcnR1JyBpbiBjYXRlZ29yaWE6CgkJcHQgPSAnW0JdW0NPTE9SIGdyZWVuXVBbL0NPTE9SXVtDT0xPUiByZWRdVFsvQ09MT1JdOiBbL0JdJwoJCgl2aXN0byA9IEZhbHNlCgljb3IgPSAnd2hpdGUnCglpZiAnUFQnIGluIGltZGI6CgkJaW1kYiA9IHJlLmNvbXBpbGUoJyguKz8pUFQnKS5maW5kYWxsKGltZGIpWzBdCgkJcHQgPSAnW0JdW0NPTE9SIGdyZWVuXVBbL0NPTE9SXVtDT0xPUiByZWRdVFsvQ09MT1JdOiBbL0JdJwoJCglpbmZvTGFiZWxzID0geydUaXRsZSc6IG5vbWVlbiwgJ1llYXInOiBhbm9zLCAnR2VucmUnOiBjYXRlZ29yaWEsICdQbG90JzogZGVzY3JpY2FvLCAnQ2FzdCc6IGFjdG9yZXMuc3BsaXQoJywnKSwgJ1RyYWlsZXInOiB5b3V0dWJlLCAnRGlyZWN0b3InOiByZWFsaXphZG9yLCAnUmF0aW5nJzogaVsnUmF0aW5nJ10sICdJTURCTnVtYmVyJzogaW1kYiB9CgoJbm9tZWVlID0gJ1tDT0xPUiAnK2NvcisnXScrcHQrYnIrc2VtTGVnZW5kYStyZW1vdmVyQWNlbnRvcyhub21lKSsnICgnK2Fub3MrJylbL0NPTE9SXScKCXVybG5vbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPWZpbG1lcyZnZW5lcm89Z2V0X3ZpZGVvJmFkZG9uPTEmcGVzcXVpc2E9JytzdHIoaWRfdmlkZW8pCglmb3Rvb28gPSBpbWFnZW0KCWZhbmFydHR0ID0gJ2ltYWdlcy9iYWNrZ3JvdW5kLycraW1kYisnLmpwZycKCQoJYWRkVmlkZW8obm9tZWVlLCB1cmxub28sIDExMTEzLCBmb3Rvb28sIHZpc3RvLCAnZmlsbWUnLCAwLCAwLCBpbmZvTGFiZWxzLCBmYW5hcnR0dCwgdHJhaWxlcj15b3V0dWJlKQoKZGVmIGdldEdlbmVyb3MyX2xpdmUodXJsLCBtb2RvKToKCWxpc3RhID0gW10KCWxpc3RhID0gZ2V0U2FnYXNsaXZlKCdpbmljaW9fc2FnYXMnLCBtb2RvKQoJCglmb3IgYyBpbiBhc3QubGl0ZXJhbF9ldmFsKGxpc3RhKToKCQlpZiBjWydJRCddID09ICIwIjoKCQkJY29udGludWUKCQl0cnk6CgkJCWNhdCA9IGJhc2U2NC5iNjRkZWNvZGUoY1snTm9tZSddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6CgkJCXBhc3MKCQkKCQl1cmxub3ZvID0gdXJsKycmcGVzcXVpc2E9JytzdHIoY1snSUQnXSk7CgkJYWRkRGlyMihjYXQsIHVybG5vdm8sIDExMTIxLCBtb2RvLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZ2VuZXJvLnBuZycpKQoJCgl2aXN0YV9tZW51KCkKCmRlZiBnZXRHZW5lcm9zX2xpdmUodXJsLCBtb2RvKToKCWxpc3RhID0gW10KCWlmIG1vZG8gPT0gJ2ZpbG1lcyc6CgkJbGlzdGEgPSBnZXRDYXRlZ29yaWFsaXZlKCdpbmljaW9fZmlsbWVzJywgbW9kbykKCWVsc2U6CgkJbGlzdGEgPSBnZXRDYXRlZ29yaWFsaXZlKCdpbmljaW9fc2VyaWVzJywgbW9kbykKCQoJZm9yIGMgaW4gYXN0LmxpdGVyYWxfZXZhbChsaXN0YSk6CgkJaWYgY1snSUQnXSA9PSAiMCI6CgkJCWNvbnRpbnVlCgkJdHJ5OgoJCQljYXQgPSBiYXNlNjQuYjY0ZGVjb2RlKGNbJ05vbWUnXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OgoJCQlwYXNzCgkJCgkJdXJsbm92byA9IHVybCsnJnBlc3F1aXNhPScrc3RyKGNbJ0lEJ10pOwoJCWFkZERpcjIoY2F0LCB1cmxub3ZvLCAxMTEyMSwgbW9kbywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2dlbmVyby5wbmcnKSkKCQoJdmlzdGFfbWVudSgpCgpkZWYgZ2V0WWVhcnNfbGl2ZSh1cmwsIG1vZG8pOgoJbGlzdGEgPSBbXQoJaWYgbW9kbyA9PSAnZmlsbWVzJzoKCQlsaXN0YSA9IGdldEFub3NsaXZlKCdpbmljaW9fZmlsbWVzJywgbW9kbykKCWVsc2U6CgkJbGlzdGEgPSBnZXRBbm9zbGl2ZSgnaW5pY2lvX3NlcmllcycsIG1vZG8pCgkKCWZvciBjIGluIGFzdC5saXRlcmFsX2V2YWwobGlzdGEpOgoJCWlmIGNbJ0lEJ10gPT0gIjAiOgoJCQljb250aW51ZQoJCXRyeToKCQkJY2F0ID0gYmFzZTY0LmI2NGRlY29kZShjWydOb21lJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDoKCQkJcGFzcwoJCQoJCXVybG5vdm8gPSB1cmwrJyZwZXNxdWlzYT0nK3N0cihjWydJRCddKTsKCQlhZGREaXIyKGNhdCwgdXJsbm92bywgMTExMjEsIG1vZG8sIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdnZW5lcm8ucG5nJykpCgkKCXZpc3RhX21lbnUoKQoJCmRlZiBnZXRJbmZvX2xpdmUodXJsLCB0aXBvKToKCXJlc3VsdGFkbyA9IGRldm9sdmVyZXN1bHRhZG8odXJsKQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pCglmb3IgaSBpbiByZXN1bHRhZG9bIml0ZW0iXToKCQlpZiB0aXBvID09ICdmaWxtZXMnOgoJCQlzZXRGaWxtZTIoaSkKCQllbHNlOgoJCQlzZXRTZXJpZXMyKGkpCgkKCWN1cnJlbnQgPSByZXN1bHRhZG9bJ3BhZ2luYWNhbyddWydhdHVhbCddCgl0b3RhbCA9IDAKCXRyeTogdG90YWwgPSByZXN1bHRhZG9bJ3BhZ2luYWNhbyddWyd0b3RhbCddCglleGNlcHQ6IHBhc3MKCXRyeTogcHJveGltbyA9IGJhc2U2NC5iNjRkZWNvZGUocmVzdWx0YWRvWydwYWdpbmFjYW8nXVsnc2VndWludGUnXSkKCWV4Y2VwdDogcGFzcwoJaWYgaW50KGN1cnJlbnQpIDwgaW50KHRvdGFsKToKCQlhZGREaXIyKCdQcm94aW1hIHBhZ2luYSAoJytzdHIoY3VycmVudCkrJy8nK3N0cih0b3RhbCkrJyknLCBwcm94aW1vLCAxMTEyMSwgdGlwbywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Byb3hpbW8ucG5nJykpCgl2aXN0YV9maWxtZXNTZXJpZXMoKQoJCmRlZiBwZXNxdWlzYV9saXZlKHVybCwgdGlwb2xvKToKCWNvZGlnb19mb250ZSA9ICcnCglkYWRvcyA9ICcnCgl0YWJlbGEgPSAnJwoJc3RyUGVzcXVpc2EgPSAnJwoJZmljaGVpcm8gPSAnJwoJc2l0ZSA9ICcnCglxdWFsaWRhZGUgPSAnJwoJdG9rZW5QZXNxdWlzYT0gJycKCXJlc3VsdGFkbyA9ICcnCgl0aXBvbG9wZXNxdWlzYU5vdm8gPSAnMCcKCWlmIHRpcG9sbyA9PSAnZmlsbWVzJzoKCQlmaWNoZWlybyA9IG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ2ZpbG1lc19wZXNxdWlzYS5saXZlaXQnKQoJCXRpcG8gPSAwCgkJcXVhbGlkYWRlID0gX19RdWFsaWRhZGVfXwoJZWxzZToKCQlmaWNoZWlybyA9IG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ3Nlcmllc19wZXNxdWlzYS5saXZlaXQnKQoJCXRpcG8gPSAxCgkJc2l0ZSA9ICdzZXJpZXMnCgkKCWlmICdwYWdlJyBub3QgaW4gdXJsOgoJCXRyeToKCQkJdGlwb2xvcGVzcXVpc2EgPSB4Ym1jZ3VpLkRpYWxvZygpLnNlbGVjdCh1J08gcXVlIHByZXRlbmRlIHBlc3F1aXNhcj8nLCBbJ1BvcjogTm9tZVBUIG91IE5vbWUgRU4nLCAnUG9yOiBSZWFsaXphZG9yJywnUG9yOiBBY3RvciddKQoJCWV4Y2VwdDoKCQkJcmV0dXJuIEZhbHNlCgkJCgkJaWYgdGlwb2xvcGVzcXVpc2EgPT0gMDoKCQkJdGlwb2xvcGVzcXVpc2FOb3ZvID0gJzAnCgkJZWxpZiB0aXBvID09IDE6CgkJCXRpcG9sb3Blc3F1aXNhTm92byA9ICcxJwoJCWVsaWYgdGlwbyA9PSAyOgoJCQl0aXBvbG9wZXNxdWlzYU5vdm8gPSAnMicKCQkJCgkJX19BRERPTl9fLnNldFNldHRpbmcoJ3Rva2VuUGVzcXVpc2EnLCB0aXBvbG9wZXNxdWlzYU5vdm8pCgkJdGVjbGFkbyA9IHhibWMuS2V5Ym9hcmQoJycsICdPIHF1ZSBxdWVyIHBlc3F1aXNhcj8nKQoJCXRlY2xhZG8uZG9Nb2RhbCgpCgkJCgkJaWYgdGVjbGFkby5pc0NvbmZpcm1lZCgpOgoJCQlzdHJQZXNxdWlzYSA9IHRlY2xhZG8uZ2V0VGV4dCgpCgkJCWlmIHN0clBlc3F1aXNhID09ICcnOgoJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnSW5zaXJhIGFsZ28gbmEgcGVzcXVpc2EuJykKCQkJCWFkZERpcjIoJ0FsdGVyYXIgUGVzcXVpc2EnLCB1cmwsIDExMTIwLCB0aXBvbG8sIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdwZXNxdWlzYS5wbmcnKSwgMCkKCQkJCXJldHVybiBGYWxzZQoJCQllbHNlOgoJCQkJdG9rZW5QZXNxdWlzYSA9IHN0clBlc3F1aXNhLnJlcGxhY2UoIiAiLCAiJTIwIikKCQkJCV9fQURET05fXy5zZXRTZXR0aW5nKCd0b2tlblBlc3F1aXNhVGV4dG8nLCB0b2tlblBlc3F1aXNhKQoJCglyZXN1bHRhZG8gPSBkZXZvbHZlcmVzdWx0YWRvKHVybCsnJnBlc3F1aXNhPScrX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuUGVzcXVpc2FUZXh0bycpKycmZ2VuZXJvPXBlc3F1aXNhJytfX0FERE9OX18uZ2V0U2V0dGluZygndG9rZW5QZXNxdWlzYScpKQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pCglmb3IgaSBpbiByZXN1bHRhZG9bIml0ZW0iXToKCQlpZiB0aXBvbG8gPT0gJ2ZpbG1lcyc6CgkJCXNldEZpbG1lMihpKQoJCWVsc2U6CgkJCXNldFNlcmllczIoaSkKCQoJY3VycmVudCA9IHJlc3VsdGFkb1sncGFnaW5hY2FvJ11bJ2F0dWFsJ10KCXRvdGFsID0gMAoJdHJ5OiB0b3RhbCA9IHJlc3VsdGFkb1sncGFnaW5hY2FvJ11bJ3RvdGFsJ10KCWV4Y2VwdDogcGFzcwoJdHJ5OiBwcm94aW1vID0gYmFzZTY0LmI2NGRlY29kZShyZXN1bHRhZG9bJ3BhZ2luYWNhbyddWydzZWd1aW50ZSddKQoJZXhjZXB0OiBwYXNzCglpZiBpbnQoY3VycmVudCkgPCBpbnQodG90YWwpOgoJCWFkZERpcjIoJ1Byb3hpbWEgcGFnaW5hICgnK3N0cihjdXJyZW50KSsnLycrc3RyKHRvdGFsKSsnKScsIHByb3hpbW8sIDExMTIwLCB0aXBvbG8sIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdwcm94aW1vLnBuZycpKQoJZWxzZToKCQl4Ym1jcGx1Z2luLmVuZE9mRGlyZWN0b3J5KGludChzeXMuYXJndlsxXSksY2FjaGVUb0Rpc2M9RmFsc2UpCgkKCXZpc3RhX2ZpbG1lc1NlcmllcygpCgpkZWYgc2V0U2VyaWVzMihpKToKCWNhdGVnb3JpYSA9ICIiCgl0cnk6IGNhdGVnb3JpYSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnR3J1cG8nXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJZ3J1cG8yID0gIiIKCXRyeTogZ3J1cG8yID0gYmFzZTY0LmI2NGRlY29kZShpWydHcnVwbzInXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MgCgkKCWdydXBvMyA9ICIiCgl0cnk6IGdydXBvMyA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnR3J1cG8zJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCWlmIGdydXBvMiAhPSAiIjoKCQljYXRlZ29yaWEgKz0gJywnK2dydXBvMgoJaWYgZ3J1cG8zICE9ICIiOgoJCWNhdGVnb3JpYSArPSAnLCcrZ3J1cG8zCgkKCWlkX3ZpZGVvID0gaVsnSUQnXQoJCglub21lID0gJycKCXRyeTogbm9tZSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnTm9tZSddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglub21lZW4gPSAnJwoJdHJ5OiBub21lZW4gPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ05vbWVFTiddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglkZXNjcmljYW8gPSAnJwoJdHJ5OiBkZXNjcmljYW8gPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0Rlc2NyaWNhbyddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglyZWFsaXphZG9yID0gJycKCXRyeTogcmVhbGl6YWRvciA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnUmVhbGl6YWRvciddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglhY3RvcmVzID0gJycKCXRyeTogYWN0b3JlcyA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnQWN0b3JlcyddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCgl5b3V0dWJlID0gJycKCXRyeTogeW91dHViZSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnWW91dHViZSddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglpbWRiID0gJycKCXRyeTogaW1kYiA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnSW1kYiddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglhbm9zID0gaVsnQW5vTm92byddCgl0ZW1wb3JhZGFzID0gaVsnVGVtcG9yYWRhcyddCgkKCWltYWdlbSA9ICcnCgl0cnk6IGltYWdlbSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnSW1hZ2VtJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCXZpc3RvID0gRmFsc2UKCXB0ID0gJycKCWJyID0gJycKCXNlbUxlZ2VuZGEgPSAnJwoJaWYgJ0JyYXNpbGVpcm8nIGluIGNhdGVnb3JpYToKCQliciA9ICdbQl1bQ09MT1IgZ3JlZW5dQlsvQ09MT1JdW0NPTE9SIHllbGxvd11SWy9DT0xPUl06IFsvQl0nCglpZiAnUG9ydHUnIGluIGNhdGVnb3JpYToKCQlwdCA9ICdbQl1bQ09MT1IgZ3JlZW5dUFsvQ09MT1JdW0NPTE9SIHJlZF1UWy9DT0xPUl06IFsvQl0nCglpZiAnUFQnIGluIGltZGI6CgkJcHQgPSAnW0JdW0NPTE9SIGdyZWVuXVBbL0NPTE9SXVtDT0xPUiByZWRdVFsvQ09MT1JdOiBbL0JdJwoJCglpZiAnaHR0cCcgbm90IGluIGltYWdlbToKCQlpbWFnZW0gPSBfX0FQSV9fK2ltYWdlbQoJCgl1cmxub28gPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1zZXJpZXMmZ2VuZXJvPXRlbXBvcmFkYSZhZGRvbj0xJnNlcmllPScraWRfdmlkZW8rJyZ0ZW1wb3JhZGE9JwoJCglpbmZvTGFiZWxzID0geydUaXRsZSc6IG5vbWVlbiwgJ1llYXInOiBhbm9zLCAnR2VucmUnOiBjYXRlZ29yaWEsICdQbG90JzogZGVzY3JpY2FvLCAnQ2FzdCc6IGFjdG9yZXMuc3BsaXQoJywnKSwgJ1RyYWlsZXInOiB5b3V0dWJlLCAnRGlyZWN0b3InOiByZWFsaXphZG9yLCAnUmF0aW5nJzogaVsnUmF0aW5nJ10sICdJTURCTnVtYmVyJzogaW1kYiB9CgkKCW5vbWVlZSA9IHB0K2JyK3NlbUxlZ2VuZGErcmVtb3ZlckFjZW50b3Mobm9tZSkrJyAoJythbm9zKycpJwoJZm90b29vID0gaW1hZ2VtCglmYW5hcnR0dCA9IF9fQVBJX18rJ2ltYWdlcy9iYWNrZ3JvdW5kLycraW1kYisnLmpwZycKCWFkZERpcjIobm9tZWVlLCB1cmxub28sIDExMTE0LCB0ZW1wb3JhZGFzLCBmb3Rvb28sIHRpcG89J3NlcmllJywgaW5mb0xhYmVscz1pbmZvTGFiZWxzLHBvc3Rlcj1mYW5hcnR0dCx2aXN0bz12aXN0bykKCQoJCmRlZiBnZXRTZWFzb25zMih1cmwsIG1vZG8pOgoJaj1pbnQobW9kbykKCWZvciBpIGluIHJhbmdlKGopOgoJCWFkZERpcjIoIltCXVRlbXBvcmFkYVsvQl0gIitzdHIoaSsxKSwgdXJsK3N0cihpKzEpLCAxMTExNSwgJ2VwaXNvZGlvcycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sJ3RlbXBvcmFkYXMnLCAndGVtcG9yYWRhJytzdHIoaSsxKSsnLnBuZycpKQoJCgl2aXN0YV90ZW1wb3JhZGFzKCkKCmRlZiBnZXRFcGlzb2RlczIodXJsKToKCXJlc3VsdGFkbyA9IGRldm9sdmVyZXN1bHRhZG8odXJsKQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pCglmb3IgaSBpbiByZXN1bHRhZG9bJ2l0ZW0nXToKCQlwdCA9ICcnCgkJYnIgPSAnJwoJCWZpbmFsID0gJycKCQlzZW1MZWdlbmRhID0gJycKCQkKCQl2aXN0byA9IEZhbHNlCgkJY29yID0gJ3doaXRlJwoJCQoJCW5vbWUgPSAnJwoJCXRyeTogbm9tZSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnTm9tZSddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQoJCWltZGIgPSAnJwoJCXRyeTogaW1kYiA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnSW1kYiddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQkKCQlpbWFnZW0gPSAnJwoJCXRyeTogaW1hZ2VtID0gYmFzZTY0LmI2NGRlY29kZShpWydJbWFnZW0nXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OiBwYXNzCgkJCgkJbGVnZW5kYXMgPSAnJwoJCXRyeTogbGVnZW5kYXMgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0xlZ2VuZGFzJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCQoJCWFub3MgPSBpWydBbm9Ob3ZvJ10KCQoJCWlmICdodHRwJyBub3QgaW4gaW1hZ2VtOgoJCQlpbWFnZW0gPSBfX0FQSV9fK2ltYWdlbQoJCgkJaWYgbGVnZW5kYXMgPT0gInNlbWxlZ2VuZGEiIG9yIGlbJ0xlZ2VuZGFzJ10gPT0gIiI6CgkJCXNlbUxlZ2VuZGEgPSAnW0NPTE9SIHJlZF1bQl1TLyBMRUdFTkRBIFsvQl1bL0NPTE9SXScKCQkKCQllcGlzb2RpbyA9IGlbJ0VwaXNvZGlvJ10KCQl0ZW1wb3JhZGEgPSBpWydUZW1wb3JhZGEnXQoJCWlkX3ZpZGVvID0gaVsnSUQnXQoJCQoJCWluZm9MYWJlbHMgPSB7J1RpdGxlJzogbm9tZSwgJ0NvZGUnOiBpbWRiLCAnRXBpc29kZSc6IGVwaXNvZGlvLCAnU2Vhc29uJzogdGVtcG9yYWRhIH0KCQlub21lZWUgPSBwdCticitmaW5hbCtzZW1MZWdlbmRhKydbQ09MT1IgJytjb3IrJ11bQl1FcGlzb2RpbyAnK3N0cihlcGlzb2RpbykrJ1svQl1bL0NPTE9SXSAnK3JlbW92ZXJBY2VudG9zKG5vbWUpCgkJCgkJdXJsbm9vID0gX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89c2VyaWVzJmdlbmVybz1nZXRfdmlkZW8mYWRkb249MSZwZXNxdWlzYT0nK3N0cihpZF92aWRlbykKCQlmb3Rvb28gPSBpbWFnZW0KCQlmYW5hcnR0dCA9IF9fQVBJX18rJ2ltYWdlcy9iYWNrZ3JvdW5kLycraW1kYisnLmpwZycKCQlhZGRWaWRlbyhub21lZWUsIHVybG5vbywgMTExMTMsIGltYWdlbSwgdmlzdG8sICdlcGlzb2RpbycsIHRlbXBvcmFkYSwgZXBpc29kaW8sIGluZm9MYWJlbHMsIGZhbmFydHR0KQoJCgl2aXN0YV9lcGlzb2Rpb3MoKQoKZGVmIHBsYXllcjIobmFtZSwgdXJsLCBpY29uaW1hZ2UsIG1vZG8sIHRlbXBvcmFkYSwgZXBpc29kaW8sIHRpcG9sb2dpKToKCXJlc3VsdGFkbyA9IGRldm9sdmVyZXN1bHRhZG8odXJsKQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pCglpbmZvbGFiZWxzID0gZGljdCgpCglwYXN0YURhdGEgPSAnJwoJbm9tZSA9ICcnCglpZFZpZGVvID0gJzAnCgltZW5zYWdlbXByb2dyZXNzbyA9IHhibWNndWkuRGlhbG9nUHJvZ3Jlc3MoKQoJbWVuc2FnZW1wcm9ncmVzc28uY3JlYXRlKEFkZG9uVGl0bGUsIHUnQWJyaXIgZW1pc3PDo28nLCdQb3IgZmF2b3IgYWd1YXJkZS4uLicpCgltZW5zYWdlbXByb2dyZXNzby51cGRhdGUoMjUsICIiLCB1J09idGVyIHZpZGVvIGUgbGVnZW5kYScsICIiKQoKCXN0cmVhbSwgbGVnZW5kYSwgZXh0X2cgPSBnZXRTdHJlYW1MZWdlbmRhMihyZXN1bHRhZG9bMF0sdGlwb2xvZ2kpCglpZiBzdHJlYW0gPT0gRmFsc2UgYW5kIGxlZ2VuZGEgPT0gMjA0OgoJCW1lbnNhZ2VtcHJvZ3Jlc3NvLmNsb3NlKCkKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdBbGd1bSBlcnJvLiBUZW50ZSBtYWlzIHRhcmRlJykKCQlyZXR1cm4gRmFsc2UKCWVsc2U6CgkJbWVuc2FnZW1wcm9ncmVzc28udXBkYXRlKDUwLCAiIiwgdSdQcmVwYXJhLXRlLCB2YWkgY29tZcOnYXIhJywgIiIpCgkJcGxheWxpc3QgPSB4Ym1jLlBsYXlMaXN0KDEpCgkJcGxheWxpc3QuY2xlYXIoKQoJCWxpc3RpdGVtID0geGJtY2d1aS5MaXN0SXRlbShuYW1lLCBpY29uSW1hZ2U9IkRlZmF1bHRWaWRlby5wbmciLCB0aHVtYm5haWxJbWFnZT1pY29uaW1hZ2UpCgoJCWxpc3RpdGVtLnNldEluZm8odHlwZT0iVmlkZW8iLCBpbmZvTGFiZWxzPWluZm9sYWJlbHMpCgkJbGlzdGl0ZW0uc2V0UHJvcGVydHkoJ21pbWV0eXBlJywgJ3ZpZGVvL3gtbXN2aWRlbycpCgkJbGlzdGl0ZW0uc2V0UHJvcGVydHkoJ0lzUGxheWFibGUnLCAndHJ1ZScpCgkJCgkJbGlzdGl0ZW0uc2V0UGF0aChwYXRoPXN0cmVhbSkKCQlwbGF5bGlzdC5hZGQoc3RyZWFtLCBsaXN0aXRlbSkKCQl4Ym1jcGx1Z2luLnNldFJlc29sdmVkVXJsKGludChzeXMuYXJndlsxXSksIFRydWUsIGxpc3RpdGVtKQoJCW1lbnNhZ2VtcHJvZ3Jlc3NvLnVwZGF0ZSg3NSwgIiIsIHUnQm9hIFNlc3PDo28hISEnLCAiIikKCgkJaWYgc3RyZWFtID09IEZhbHNlOgoJCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdPIHNlcnZpZG9yIGVzY29saGlkbyBuw6NvIGRpc3BvbsOtdmVsLCBlc2NvbGhhIG91dHJvIG91IHRlbnRlIG5vdmFtZW50ZSBtYWlzIHRhcmRlLicpCgkJZWxzZToKCQkJcGxheWVyX21yID0gUGxheWVyLlBsYXllcih1cmw9dXJsLCBpZEZpbG1lPWlkVmlkZW8sIHBhc3RhRGF0YT1fX1BBU1RBX0RBRE9TX18sIHRlbXBvcmFkYT10ZW1wb3JhZGEsIGVwaXNvZGlvPWVwaXNvZGlvLCBub21lPW5hbWUsIGxvZ289b3MucGF0aC5qb2luKF9fQURET05fRk9MREVSX18sJ2ljb24ucG5nJykpCgkJCW1lbnNhZ2VtcHJvZ3Jlc3NvLmNsb3NlKCkKCQkJcGxheWVyX21yLnBsYXkocGxheWxpc3QpCgkJCXBsYXllcl9tci5zZXRTdWJ0aXRsZXMobGVnZW5kYSkKCQkJd2hpbGUgcGxheWVyX21yLnBsYXlpbmc6CgkJCQl4Ym1jLnNsZWVwKDUwMDApCgkJCQkjcGxheWVyX21yLnRyYWNrZXJUZW1wbygpCgpkZWYgZ2V0U3RyZWFtTGVnZW5kYTIodHVkb2luZm8sdGlwb29vKToKCXJlc3VsdGFkbyA9IHR1ZG9pbmZvCglpID0gMAoJc2Vydmlkb3JlcyA9IFtdCgl0aXR1bG9zID0gW10KCW5vbWUgPSAnJwoJdXJsMSA9ICcnCgl0cnk6IHVybDEgPSBiYXNlNjQuYjY0ZGVjb2RlKHJlc3VsdGFkb1snVXJsJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgl1cmwyID0gJycKCXRyeTogdXJsMiA9IGJhc2U2NC5iNjRkZWNvZGUocmVzdWx0YWRvWydVcmwxJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgl1cmwzID0gJycKCXRyeTogdXJsMyA9IGJhc2U2NC5iNjRkZWNvZGUocmVzdWx0YWRvWydVcmwyJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgl1cmw0ID0gJycKCXRyeTogdXJsNCA9IGJhc2U2NC5iNjRkZWNvZGUocmVzdWx0YWRvWydVcmwzJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgl1cmw1ID0gJycKCXRyeTogdXJsNSA9IGJhc2U2NC5iNjRkZWNvZGUocmVzdWx0YWRvWydVcmw0J10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCWlmIHVybDEgIT0gJyc6CgkJaSs9MQoJCWlmICdvbG9hZCcgaW4gdXJsMSBvciAnb3BlbmxvYWQnIGluIHVybDE6CgkJCW5vbWUgPSAiT3BlbkxvYWQiCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDEpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICd2aWR6aScgaW4gdXJsMToKCQkJbm9tZSA9ICdWaWR6aScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ2dvb2dsZScgaW4gdXJsMSBvciAnY2xvdWQubWFpbC5ydScgaW4gdXJsMSBvciAnLm1wNCcgaW4gdXJsMSBvciAnLmF2aScgaW4gdXJsMToKCQkJbm9tZSA9IEFkZG9uVGl0bGUKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3VwdG9zdHJlYW0uY29tJyBpbiB1cmwxOgoJCQlub21lID0gJ1VwVG9TdHJlYW0nCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDEpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICdyYXBpZHZpZGVvLmNvbScgaW4gdXJsMSBvciAncmFwdHUnIGluIHVybDE6CgkJCW5vbWUgPSAnUmFwdHUnCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDEpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICd2aWRvemEubmV0JyBpbiB1cmwxOgoJCQlub21lID0gJ1ZpZG96YScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3N0cmVhbWFuZ28uJyBpbiB1cmwxOgoJCQlub21lID0gJ1N0cmVhbWFuZ28nCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDEpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICd2ZXJ5c3RyZWFtLicgaW4gdXJsMToKCQkJbm9tZSA9ICdWZXJ5U3RyZWFtJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwxKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAnbWl4ZHJvcC4nIGluIHVybDE6CgkJCW5vbWUgPSAnTWl4ZHJvcCcKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJaWYgdXJsMiAhPSAnJzoKCQlpKz0xCgkJaWYgJ29sb2FkJyBpbiB1cmwyIG9yICdvcGVubG9hZCcgaW4gdXJsMjoKCQkJbm9tZSA9ICJPcGVuTG9hZCIKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMikKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3ZpZHppJyBpbiB1cmwyOgoJCQlub21lID0gJ1ZpZHppJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwyKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAnZ29vZ2xlJyBpbiB1cmwyIG9yICdjbG91ZC5tYWlsLnJ1JyBpbiB1cmwyIG9yICcubXA0JyBpbiB1cmwyIG9yICcuYXZpJyBpbiB1cmwyOgoJCQlub21lID0gQWRkb25UaXRsZQoJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwyKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAndXB0b3N0cmVhbS5jb20nIGluIHVybDI6CgkJCW5vbWUgPSAnVXBUb1N0cmVhbScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMikKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3JhcGlkdmlkZW8uY29tJyBpbiB1cmwyIG9yICdyYXB0dScgaW4gdXJsMjoKCQkJbm9tZSA9ICdSYXB0dScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMikKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3ZpZG96YS5uZXQnIGluIHVybDI6CgkJCW5vbWUgPSAnVmlkb3phJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwyKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAnc3RyZWFtYW5nby4nIGluIHVybDI6CgkJCW5vbWUgPSAnU3RyZWFtYW5nbycKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMikKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3ZlcnlzdHJlYW0uJyBpbiB1cmwyOgoJCQlub21lID0gJ1ZlcnlTdHJlYW0nCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDIpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICdtaXhkcm9wLicgaW4gdXJsMjoKCQkJbm9tZSA9ICdNaXhkcm9wJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwyKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgl0cnk6CgkJaWYgdXJsMyAhPSAnJzoKCQkJaSs9MQoJCQlpZiAnb2xvYWQnIGluIHVybDMgb3IgJ29wZW5sb2FkJyBpbiB1cmwzOgoJCQkJbm9tZSA9ICJPcGVuTG9hZCIKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDMpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3ZpZHppJyBpbiB1cmwzOgoJCQkJbm9tZSA9ICdWaWR6aScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDMpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ2dvb2dsZScgaW4gdXJsMyBvciAnY2xvdWQubWFpbC5ydScgaW4gdXJsMyBvciAnLm1wNCcgaW4gdXJsMyBvciAnLmF2aScgaW4gdXJsMzoKCQkJCW5vbWUgPSBBZGRvblRpdGxlCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwzKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd1cHRvc3RyZWFtLmNvbScgaW4gdXJsMzoKCQkJCW5vbWUgPSAnVXBUb1N0cmVhbScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDMpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3JhcGlkdmlkZW8uY29tJyBpbiB1cmwzIG9yICdyYXB0dScgaW4gdXJsMzoKCQkJCW5vbWUgPSAnUmFwdHUnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwzKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd2aWRvemEubmV0JyBpbiB1cmwzOgoJCQkJbm9tZSA9ICdWaWRvemEnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwzKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdzdHJlYW1hbmdvLicgaW4gdXJsMzoKCQkJCW5vbWUgPSAnU3RyZWFtYW5nbycKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDMpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3ZlcnlzdHJlYW0uJyBpbiB1cmwzOgoJCQkJbm9tZSA9ICdWZXJ5U3RyZWFtJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMykKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAnbWl4ZHJvcC4nIGluIHVybDM6CgkJCQlub21lID0gJ01peGRyb3AnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwzKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJZXhjZXB0OgoJCXBhc3MKCXRyeToKCQlpZiB1cmw0ICE9ICcnOgoJCQlpKz0xCgkJCWlmICdvbG9hZCcgaW4gdXJsNCBvciAnb3BlbmxvYWQnIGluIHVybDQ6CgkJCQlub21lID0gIk9wZW5Mb2FkIgoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsNCkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndmlkemknIGluIHVybDQ6CgkJCQlub21lID0gJ1ZpZHppJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsNCkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAnZ29vZ2xlJyBpbiB1cmw0IG9yICdjbG91ZC5tYWlsLnJ1JyBpbiB1cmw0IG9yICcubXA0JyBpbiB1cmw0IG9yICcuYXZpJyBpbiB1cmw0OgoJCQkJbm9tZSA9IEFkZG9uVGl0bGUKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDQpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3VwdG9zdHJlYW0uY29tJyBpbiB1cmw0OgoJCQkJbm9tZSA9ICdVcFRvU3RyZWFtJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsNCkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAncmFwaWR2aWRlby5jb20nIGluIHVybDQgb3IgJ3JhcHR1JyBpbiB1cmw0OgoJCQkJbm9tZSA9ICdSYXB0dScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDQpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3ZpZG96YS5uZXQnIGluIHVybDQ6CgkJCQlub21lID0gJ1ZpZG96YScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDQpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3N0cmVhbWFuZ28uJyBpbiB1cmw0OgoJCQkJbm9tZSA9ICdTdHJlYW1hbmdvJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsNCkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndmVyeXN0cmVhbS4nIGluIHVybDQ6CgkJCQlub21lID0gJ1ZlcnlTdHJlYW0nCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw0KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdtaXhkcm9wLicgaW4gdXJsNDoKCQkJCW5vbWUgPSAnTWl4ZHJvcCcKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDQpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCglleGNlcHQ6CgkJcGFzcwoJCgl0cnk6CgkJaWYgdXJsNSAhPSAnJzoKCQkJaSs9MQoJCQlpZiAnb2xvYWQnIGluIHVybDUgb3IgJ29wZW5sb2FkJyBpbiB1cmw1OgoJCQkJbm9tZSA9ICJPcGVuTG9hZCIKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDUpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3ZpZHppJyBpbiB1cmw1OgoJCQkJbm9tZSA9ICdWaWR6aScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDUpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ2dvb2dsZScgaW4gdXJsNSBvciAnY2xvdWQubWFpbC5ydScgaW4gdXJsNSBvciAnLm1wNCcgaW4gdXJsNSBvciAnLmF2aScgaW4gdXJsNToKCQkJCW5vbWUgPSBBZGRvblRpdGxlCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw1KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd1cHRvc3RyZWFtLmNvbScgaW4gdXJsNToKCQkJCW5vbWUgPSAnVXBUb1N0cmVhbScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDUpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3JhcGlkdmlkZW8uY29tJyBpbiB1cmw1IG9yICdyYXB0dScgaW4gdXJsNToKCQkJCW5vbWUgPSAnUmFwdHUnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw1KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd2aWRvemEubmV0JyBpbiB1cmw1OgoJCQkJbm9tZSA9ICdWaWRvemEnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw1KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdzdHJlYW1hbmdvLicgaW4gdXJsNToKCQkJCW5vbWUgPSAnU3RyZWFtYW5nbycKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDUpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3ZlcnlzdHJlYW0uJyBpbiB1cmw1OgoJCQkJbm9tZSA9ICdWZXJ5U3RyZWFtJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsNSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAnbWl4ZHJvcC4nIGluIHVybDU6CgkJCQlub21lID0gJ01peGRyb3AnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw1KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJZXhjZXB0OgoJCXBhc3MKCQoJc3RyZWFtID0gJycKCWxlZ2VuZGEgPSAnJwoJbGVnZW5kYW5vdmEgPSAnJwoJdHJ5OgoJCWxlZ2VuZGFub3ZhID0gYmFzZTY0LmI2NGRlY29kZShyZXN1bHRhZG9bJ0xlZ2VuZGFzJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OgoJCXBhc3MKCQoJaWYgJ2xpdmVpdCcgaW4gbGVnZW5kYW5vdmE6CgkJbGVnZW5kYSA9ICcnCgllbGlmICdodHRwJyBpbiBsZWdlbmRhbm92YToKCQlsZWdlbmRhID0gbGVnZW5kYW5vdmEKCWVsaWYgJ3N1YnMvJyBpbiBsZWdlbmRhbm92YToKCQlsZWdlbmRhID0gX19BUElfXytsZWdlbmRhbm92YQoJZWxzZToKCQlsZWdlbmRhID0gX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrICJsZWdlbmRhcy8iICtsZWdlbmRhbm92YQoJCglleHRfZyA9ICdjb2lzbycKCWxlZ2VuZGFBdXggPSBsZWdlbmRhCglzZXJ2aWRvciA9IDAKCWlmIGxlbih0aXR1bG9zKSA+IDE6CgkJc2Vydmlkb3IgPSB4Ym1jZ3VpLkRpYWxvZygpLnNlbGVjdCgnRXNjb2xoYSBvIHNlcnZpZG9yJywgdGl0dWxvcykKCWVsc2U6CgkJc2Vydmlkb3IgPSAwCgkKCWlmICd2aWR6aScgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJdmlkemkgPSBVUkxSZXNvbHZlck1lZGlhLlZpZHppKHNlcnZpZG9yZXNbc2Vydmlkb3JdKQoJCXN0cmVhbSA9IHZpZHppLmdldE1lZGlhVXJsKCkKCQkjbGVnZW5kYSA9IHZpZHppLmdldFN1YnRpdGxlKCkKCWVsaWYgJ3VwdG9zdHJlYW0uY29tJyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQlzdHJlYW0gPSBVUkxSZXNvbHZlck1lZGlhLlVwVG9TdHJlYW0oc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pLmdldE1lZGlhVXJsKCkKCWVsaWYgJ3NlcnZlci5tcnBpcmFjeS53aW4nIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXN0cmVhbSA9IHNlcnZpZG9yZXNbc2Vydmlkb3JdCgllbGlmICdvbG9hZCcgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJc3RyZWFtID0gVVJMUmVzb2x2ZXJNZWRpYS5PcGVuTG9hZChzZXJ2aWRvcmVzW3NlcnZpZG9yXSkuZ2V0TWVkaWFVcmwoKQoJCSNsZWdlbmRhID0gVVJMUmVzb2x2ZXJNZWRpYS5PcGVuTG9hZChzZXJ2aWRvcmVzW3NlcnZpZG9yXSkuZ2V0U3VidGl0bGUoKQoJCWlmIG5vdCAnLnZ0dCcgaW4gbGVnZW5kYSBvciBsZWdlbmRhID09ICcnOgoJCQlsZWdlbmRhID0gbGVnZW5kYUF1eAoJZWxpZiAnZHJpdmUuZ29vZ2xlLmNvbS8nIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXN0cmVhbSwgZXh0X2cgPSBVUkxSZXNvbHZlck1lZGlhLkdvb2dsZVZpZGVvKHNlcnZpZG9yZXNbc2Vydmlkb3JdKS5nZXRNZWRpYVVybCgpCgllbGlmICdjbG91ZC5tYWlsLnJ1JyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQlzdHJlYW0sIGV4dF9nID0gVVJMUmVzb2x2ZXJNZWRpYS5DbG91ZE1haWxSdShzZXJ2aWRvcmVzW3NlcnZpZG9yXSkuZ2V0TWVkaWFVcmwoKQoJZWxpZiAncmFwaWR2aWRlby5jb20nIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdIG9yICdyYXB0dScgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJcmFwaWQgPSBVUkxSZXNvbHZlck1lZGlhLlJhcGlkVmlkZW8oc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pCgkJc3RyZWFtID0gcmFwaWQuZ2V0TWVkaWFVcmwoKQoJCSNsZWdlbmRhID0gcmFwaWQuZ2V0TGVnZW5kYSgpCgllbGlmICd2aWRvemEubmV0JyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQl2aWRveiA9IFVSTFJlc29sdmVyTWVkaWEuVmlkb3phKHNlcnZpZG9yZXNbc2Vydmlkb3JdKQoJCXN0cmVhbSA9IHZpZG96LmdldE1lZGlhVXJsKCkKCQkjbGVnZW5kYSA9IHZpZG96LmdldExlZ2VuZGEoKQoJZWxpZiAnc3RyZWFtYW5nby4nIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXN0cmVhbWFuID0gVVJMUmVzb2x2ZXJNZWRpYS5TdHJlYW1hbmdvKHNlcnZpZG9yZXNbc2Vydmlkb3JdKQoJCXN0cmVhbSA9IHN0cmVhbWFuLmdldE1lZGlhVXJsKCkKCQkjbGVnZW5kYSA9IHN0cmVhbWFuLmdldExlZ2VuZGEoKQoJZWxpZiAndmVyeXN0cmVhbS4nIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXZlcnlzdHJlID0gVVJMUmVzb2x2ZXJNZWRpYS5WZXJ5U3RyZWFtKHNlcnZpZG9yZXNbc2Vydmlkb3JdKQoJCXN0cmVhbSA9IHZlcnlzdHJlLmdldE1lZGlhVXJsKCkKCQkjbGVnZW5kYSA9IHN0cmVhbWFuLmdldExlZ2VuZGEoKQoJZWxpZiAnbWl4ZHJvcC4nIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCW1peGRyb3AgPSBVUkxSZXNvbHZlck1lZGlhLk1peGRyb3Aoc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pCgkJc3RyZWFtID0gbWl4ZHJvcC5nZXRNZWRpYVVybCgpCgkJI2xlZ2VuZGEgPSBtaXhkcm9wLmdldExlZ2VuZGEoKQoJZWxzZToKCQlzdHJlYW0gPSBzZXJ2aWRvcmVzW3NlcnZpZG9yXQoJcmV0dXJuIHN0cmVhbSwgbGVnZW5kYSwgZXh0X2cKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCQkJCQkJCQkJCQkJQWRkb24gRmlsbWVzIGUgU2VyaWVzCQkJCQkJCQkJICAjCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZGVmIGxpc3RhbWVudXNzZXJpZXMobm9tZV9ub3YsdXJsLGVzdGlsbyx0aXBvLHRpcG9fdXNlcixzZXJ2aWRvcl91c2VyLGljb25pbWFnZSxmYW5hcnQpOgoJY2hlY2tfbG9naW4gPSBsb2dpbjIoKQoJaWYgY2hlY2tfbG9naW4gPT0gVHJ1ZToKCQlkYXRhYmFzZSA9IERhdGFiYXNlLmlzRXhpc3RzKCkKCQltZW51U2VyaWVzKG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdzZXJpZXMucG5nJyksX19TSVRFQWRkb25fXysnSW1hZ2Vucy9zZXJpZXNfZmFuYXJ0LnBuZycpCgllbHNlOgoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0Vycm8gYSBmYXplciBsb2dpbiBuZXN0YSBwYXJ0ZS4gVGVudGUgbm92YW1lbnRlIG1haXMgdGFyZGUuJykKCmRlZiBsaXN0YW1lbnVzZmlsbWVzKG5vbWVfbm92LHVybCxlc3RpbG8sdGlwbyx0aXBvX3VzZXIsc2Vydmlkb3JfdXNlcixpY29uaW1hZ2UsZmFuYXJ0KToKCWNoZWNrX2xvZ2luID0gbG9naW4yKCkKCWlmIGNoZWNrX2xvZ2luID09IFRydWU6CgkJZGF0YWJhc2UgPSBEYXRhYmFzZS5pc0V4aXN0cygpCgkJbWVudUZpbG1lcyhvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZmlsbWVzLnBuZycpLF9fU0lURUFkZG9uX18rJ0ltYWdlbnMvZmlsbWVzX2ZhbmFydC5wbmcnKQoJZWxzZToKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdFcnJvIGEgZmF6ZXIgbG9naW4gbmVzdGEgcGFydGUuIFRlbnRlIG5vdmFtZW50ZSBtYWlzIHRhcmRlLicpCgpkZWYgbGlzdGFtZW51c2FuaW1lcyhub21lX25vdix1cmwsZXN0aWxvLHRpcG8sdGlwb191c2VyLHNlcnZpZG9yX3VzZXIsaWNvbmltYWdlLGZhbmFydCk6CgljaGVja19sb2dpbiA9IGxvZ2luMigpCglpZiBjaGVja19sb2dpbiA9PSBUcnVlOgoJCWRhdGFiYXNlID0gRGF0YWJhc2UuaXNFeGlzdHMoKQoJCW1lbnVBbmltZXMob3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2FuaW1lcy5wbmcnKSxfX1NJVEVBZGRvbl9fKydJbWFnZW5zL3Nlcmllc19mYW5hcnQucG5nJykKCWVsc2U6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnRXJybyBhIGZhemVyIGxvZ2luIG5lc3RhIHBhcnRlLiBUZW50ZSBub3ZhbWVudGUgbWFpcyB0YXJkZS4nKQoKZGVmIG1lbnVGaWxtZXMoaWNvbmltYWdlLGZhbmFydCk6CglhZGREaXIyKCdUb2RvcyBvcyBGaWxtZXMnLCBfX0FQSV9TSVRFX18rJ2ZpbG1lcy5waHA/cXVhbGlkYWRlPScrX19RdWFsaWRhZGVfXywgMTExLCAnZmlsbWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdGaWxtZXMgZW0gRGVzdGFxdWUnLCAgX19BUElfU0lURV9fKydmaWxtZXMucGhwP2FjdGlvbj1kZXN0YXF1ZSZxdWFsaWRhZGU9JytfX1F1YWxpZGFkZV9fLCAxMTEsICdmaWxtZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ0ZpbG1lcyBwb3IgQW5vJywgX19BUElfU0lURV9fKydmaWxtZXMucGhwP2FjdGlvbj1hbm8nLCAxMTksICdsaXN0YWdlbUFub3MnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnYW5vLnBuZycpLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdGaWxtZXMgcG9yIEdlbmVybycsIF9fQVBJX1NJVEVfXysnZmlsbWVzLnBocD9hY3Rpb249Y2F0ZWdvcmlhJywgMTE4LCAnbGlzdGFnZW1HZW5lcm9zJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2dlbmVyby5wbmcnKSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignRmlsbWVzIHBvciBJTURCIFJha2luZycsICBfX0FQSV9TSVRFX18rJ2ZpbG1lcy5waHA/YWN0aW9uPWltZGJSYW5rJnF1YWxpZGFkZT0nK19fUXVhbGlkYWRlX18sIDExMSwgJ2ZpbG1lcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignRmlsbWVzIFBhcmEgQ3JpYW7Dp2FzJywgIF9fQVBJX1NJVEVfXysnZmlsbWVzLnBocD9hY3Rpb249cHQmcXVhbGlkYWRlPScrX19RdWFsaWRhZGVfXywgMTExLCAnZmlsbWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCgkKCXZpc3RhX21lbnUoKQoKZGVmIG1lbnVTZXJpZXMoaWNvbmltYWdlLGZhbmFydCk6CglhZGREaXIyKCdUb2RhcyBhcyBTZXJpZXMnLCBfX0FQSV9TSVRFX18rJ3Nlcmllcy5waHAnLCAxMjMsICdzZXJpZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ1NlcmllcyBlbSBEZXN0YXF1ZScsICBfX0FQSV9TSVRFX18rJ3Nlcmllcy5waHA/YWN0aW9uPWRlc3RhcXVlJywgMTIzLCAnc2VyaWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdTZXJpZXMgcG9yIEFubycsIF9fQVBJX1NJVEVfXysnc2VyaWVzLnBocD9hY3Rpb249YW5vJywgMTE5LCAnbGlzdGFnZW1Bbm9zJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Fuby5wbmcnKSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignU2VyaWVzIHBvciBHZW5lcm8nLCBfX0FQSV9TSVRFX18rJ3Nlcmllcy5waHA/YWN0aW9uPWNhdGVnb3JpYScsIDExOCwgJ2xpc3RhZ2VtR2VuZXJvcycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdnZW5lcm8ucG5nJyksIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCgl2aXN0YV9tZW51KCkKCmRlZiBtZW51QW5pbWVzKGljb25pbWFnZSxmYW5hcnQpOgoJYWRkRGlyMignVG9kb3Mgb3MgQW5pbWVzJywgX19BUElfU0lURV9fKydhbmltZXMucGhwJywgMTIzLCAnYW5pbWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdBbmltZXMgZW0gRGVzdGFxdWUnLCAgX19BUElfU0lURV9fKydhbmltZXMucGhwP2FjdGlvbj1kZXN0YXF1ZScsIDEyMywgJ2FuaW1lcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignQW5pbWVzIHBvciBBbm8nLCBfX0FQSV9TSVRFX18rJ2FuaW1lcy5waHA/YWN0aW9uPWFubycsIDExOSwgJ2xpc3RhZ2VtQW5vcycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdhbm8ucG5nJyksIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ0FuaW1lcyBwb3IgR2VuZXJvJywgX19BUElfU0lURV9fKydhbmltZXMucGhwP2FjdGlvbj1jYXRlZ29yaWEnLCAxMTgsICdsaXN0YWdlbUdlbmVyb3MnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZ2VuZXJvLnBuZycpLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCgoJdmlzdGFfbWVudSgpCgpkZWYgZ2V0TGlzdENhdGVnb3JpYSgpOgoJY2F0ID0gbGVyX2ZpY2hlaXJvKG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ2NhdGVnb3JpYXMubGl2ZWl0JykpLnJlcGxhY2UoJyInLCAiJyIpCglyZXR1cm4gY2F0CgpkZWYgcmVtb3ZlckFjZW50b3ModHh0LCBlbmNvZGluZz0ndXRmLTgnKToKCXJldHVybiBub3JtYWxpemUoJ05GS0QnLCB0eHQuZGVjb2RlKGVuY29kaW5nKSkuZW5jb2RlKCdBU0NJSScsJ2lnbm9yZScpCgpkZWYgZXNjcmV2ZXJfZmljaGVpcm8oZmljaGVpcm8sIGNvbnRldWRvKToKICAgIGYgPSBvcGVuKGZpY2hlaXJvLCBtb2RlPSJ3IikKICAgIGYud3JpdGUoY29udGV1ZG8pCiAgICBmLmNsb3NlKCkKCmRlZiBsZXJfZmljaGVpcm8oZmljaGVpcm8pOgogICAgZiA9IG9wZW4oZmljaGVpcm8sICJyIikKICAgIGNvbnRldWRvID0gIGYucmVhZCgpCiAgICBmLmNsb3NlKCkKICAgIHJldHVybiBjb250ZXVkbwoKZGVmIGdldENhdGVnb3JpYShpZCk6CgljYXQgPSBsZXJfZmljaGVpcm8ob3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnY2F0ZWdvcmlhcy5saXZlaXQnKSkucmVwbGFjZSgnIicsICInIikKCWZvciBjIGluIGFzdC5saXRlcmFsX2V2YWwoY2F0KToKCQlpZiBpbnQoaWQpID09IDA6CgkJCXJldHVybiAnJwoJCWlmIGludChjWydpZF9jYXRlZ29yaWEnXSkgPT0gaW50KGlkKToKCQkJdHJ5OgoJCQkJY2F0ID0gY1snY2F0ZWdvcmlhcyddLmRlY29kZSgndXRmLTgnKQoJCQlleGNlcHQ6CgkJCQljYXQgPSBjWydjYXRlZ29yaWFzJ10uZW5jb2RlKCd1dGYtOCcpCgkJCXJldHVybiBjYXQKCQoJIiIiaWYgaW50KGlkKSA9PSAwOgoJCXJldHVybiAnJwoJCglmb3IgYywgaSBpbiBjYXRzOgoJCWlmIGludChpKSA9PSBpbnQoaWQpOgoJCQlyZXR1cm4gYyIiIgoKCXJldHVybiAnJwoJCmRlZiBnZXRDb29raWUoKToKCXJldHVybiAndXNlcm5hbWU9JytfX0FERE9OX18uZ2V0U2V0dGluZygndG9rZW5NcnBpcmFjeScpCgpkZWYgdmVyaWZpY2FyVmlzdG9Mb2NhbChpZFZpZGVvLCB0ZW1wb3JhZGE9Tm9uZSwgZXBpc29kaW89Tm9uZSk6CglwYXN0YVZpc3RvPW9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ3Zpc3RvcycpCgoJaWYgdGVtcG9yYWRhIGFuZCBlcGlzb2RpbzoKCQlmaWNoZWlyb1Zpc3RvID0gb3MucGF0aC5qb2luKHBhc3RhVmlzdG8sc3RyKGlkVmlkZW8pKydfUycrc3RyKHRlbXBvcmFkYSkrJ3gnK3N0cihlcGlzb2RpbykrJy5saXZlaXQnKQoJZWxzZToKCQlmaWNoZWlyb1Zpc3RvID0gb3MucGF0aC5qb2luKHBhc3RhVmlzdG8sc3RyKGlkVmlkZW8pKycubGl2ZWl0JykKCglpZiBvcy5wYXRoLmV4aXN0cyhmaWNoZWlyb1Zpc3RvKToKCQlyZXR1cm4gVHJ1ZQoJZWxzZToKCQlyZXR1cm4gRmFsc2UKCmRlZiBmaWxtZXModXJsLCBwYWdpbmEpOgoJI2hlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICdCZWFyZXIgJXMnICUgX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuTXJwaXJhY3knKQoJI2lmIHJlc3VsdGFkbyA9PSAnRE5TJzoKCSMJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVGVtIGRlIGFsdGVyYXIgb3MgRE5TIHBhcmEgcG9kZXIgdXN1ZnJ1aXIgZG8gX19BRERPTl9fLicpCgkjCXJldHVybiBGYWxzZQoJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCwgaGVhZGVyPWhlYWRlcnMsIGNvb2tpZT1nZXRDb29raWUoKSkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJdmlzdG9zID0gRGF0YWJhc2Uuc2VsZWN0RmlsbWVzKCkKCW9wY2FvID0gX19BRERPTl9fLmdldFNldHRpbmcoJ21hcmNhclZpc3RvJykKCWZvciBpIGluIHJlc3VsdGFkb1snZGF0YSddOgoJCXNldEZpbG1lKGksIHZpc3Rvcywgb3BjYW8pCgl0cnk6IAoJCWN1cnJlbnQgPSByZXN1bHRhZG9bJ21ldGEnXVsnY3VycmVudCddCglleGNlcHQ6IAoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0FndWFyZGUgcGVsYSBwcsOzeGltYSBhdHVhbGl6YcOnw6NvLiBPdSB0ZW50ZSBtYWlzIHRhcmRlLicpCgkJcmV0dXJuIEZhbHNlCgljdXJyZW50ID0gcmVzdWx0YWRvWydtZXRhJ11bJ2N1cnJlbnQnXQoJdG90YWwgPSByZXN1bHRhZG9bJ21ldGEnXVsndG90YWwnXQoJdHJ5OiBwcm94aW1vID0gcmVzdWx0YWRvWydtZXRhJ11bJ3BhZ2luYWNhbyddWyduZXh0J10KCWV4Y2VwdDogcGFzcyAKCWlmIGludChjdXJyZW50KSA8IGludCh0b3RhbCk6CgkJYWRkRGlyMignUHLDs3hpbWEgcMOhZ2luYSAoJytzdHIoY3VycmVudCkrJy8nK3N0cih0b3RhbCkrJyknLCBwcm94aW1vLCAxMTEsICdmaWxtZXMnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncHJveGltby5wbmcnKSwxKQoJdmlzdGFfZmlsbWVzU2VyaWVzKCkKCQkKZGVmIHNlcmllcyh1cmwpOgoJI2hlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICdCZWFyZXIgJXMnICUgX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuTXJwaXJhY3knKQoJI2lmIHJlc3VsdGFkbyA9PSAnRE5TJzoKCSMJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVGVtIGRlIGFsdGVyYXIgb3MgRE5TIHBhcmEgcG9kZXIgdXN1ZnJ1aXIgZG8gX19BRERPTl9fLicpCgkjCXJldHVybiBGYWxzZQoJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCwgaGVhZGVyPWhlYWRlcnMsIGNvb2tpZT1nZXRDb29raWUoKSkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJaWYgJ3NlcmllJyBpbiB1cmw6CgkJdGlwbyA9ICdzZXJpZScKCWVsaWYgJ2FuaW1lJyBpbiB1cmw6CgkJdGlwbyA9ICdhbmltZScKCQkKCWlmICdzZXJpZScgaW4gdXJsOgoJCXRpcG8gPSAnc2VyaWVzJwoJZWxpZiAnYW5pbWUnIGluIHVybDoKCQl0aXBvID0gJ2FuaW1lcycKCXZpc3RvcyA9IERhdGFiYXNlLnNlbGVjdEZpbG1lcygpCglvcGNhbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCdtYXJjYXJWaXN0bycpCglmb3IgaSBpbiByZXN1bHRhZG9bJ2RhdGEnXToKCQlzZXRTZXJpZXMoaSwgdmlzdG9zLCBvcGNhbywgdGlwbykKCXRyeTogCgkJY3VycmVudCA9IHJlc3VsdGFkb1snbWV0YSddWydjdXJyZW50J10KCWV4Y2VwdDogCgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnQWd1YXJkZSBwZWxhIHByw7N4aW1hIGF0dWFsaXphw6fDo28uIE91IHRlbnRlIG1haXMgdGFyZGUuJykKCQlyZXR1cm4gRmFsc2UKCWN1cnJlbnQgPSByZXN1bHRhZG9bJ21ldGEnXVsnY3VycmVudCddCgl0b3RhbCA9IHJlc3VsdGFkb1snbWV0YSddWyd0b3RhbCddCgl0cnk6IHByb3hpbW8gPSByZXN1bHRhZG9bJ21ldGEnXVsncGFnaW5hY2FvJ11bJ25leHQnXQoJZXhjZXB0OiBwYXNzIAoJaWYgaW50KGN1cnJlbnQpIDwgaW50KHRvdGFsKToKCQlhZGREaXIyKCdQcm94aW1hIHBhZ2luYSAoJytzdHIoY3VycmVudCkrJy8nK3N0cih0b3RhbCkrJyknLCBwcm94aW1vLCAxMjMsICdzZXJpZXMnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncHJveGltby5wbmcnKSkKCXZpc3RhX2ZpbG1lc1NlcmllcygpCgpkZWYgZ2V0U2Vhc29ucyh1cmwpOgoJI2hlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICdCZWFyZXIgJXMnICUgX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuTXJwaXJhY3knKQoJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCwgaGVhZGVyPWhlYWRlcnMsIGNvb2tpZT1nZXRDb29raWUoKSkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKVsnZGF0YSddWzBdCglpZCA9IHVybC5zcGxpdCgnPScpWy0xXQoJaWYgJ3NlcmllJyBpbiB1cmw6CgkJdXJsID0gX19BUElfU0lURV9fKydzZXJpZXMucGhwP2FjdGlvbj10ZW1wb3JhZGEmaWRTZXJpZT0nK2lkKycmbj0lcycKCWVsaWYgJ2FuaW1lJyBpbiB1cmw6CgkJdXJsID0gX19BUElfU0lURV9fKydhbmltZXMucGhwP2FjdGlvbj10ZW1wb3JhZGEmaWRTZXJpZT0nK2lkKycmbj0lcycKCQoJdHJ5OgoJCXJlc3VsdGFkb1sndGVtcG9yYWRhcyddID0gcmVzdWx0YWRvWyd0ZW1wb3JhZGFzJ10ucmVwbGFjZSgnZXNwZWNpYWwnLCAnOTk5JykKCWV4Y2VwdDoKCQlwYXNzCglpZiByZXN1bHRhZG8gPT0gJ0ROUyc6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVGVtIGRlIGFsdGVyYXIgb3MgRE5TIHBhcmEgcG9kZXIgdXN1ZnJ1aXIgZG8gX19BRERPTl9fLicpCgkJcmV0dXJuIEZhbHNlCgkKCWo9MQoJCglpZiByZXN1bHRhZG9bJ3RlbXBvcmFkYXMnXSA9PSAiIjoKCQlyZXR1cm4gRmFsc2UKCWZvciBjLCBpIGluIHNvcnRlZChqc29uLmxvYWRzKHJlc3VsdGFkb1sndGVtcG9yYWRhcyddKS5pdGVyaXRlbXMoKSwga2V5PWxhbWJkYSBpOiBpbnQoaVswXSkpOgoJCWlmIGMgIT0gJzk5OSc6CgkJCWFkZERpcjIoIltCXVRlbXBvcmFkYVsvQl0gIitzdHIoYyksICh1cmwgJSBzdHIoYykpLCAxMTUsICdlcGlzb2Rpb3MnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCd0ZW1wb3JhZGFzJywgJ3RlbXBvcmFkYScrc3RyKGMpKycucG5nJykscG9zdGVyPV9fQVBJX18rcmVzdWx0YWRvWydiYWNrZ3JvdW5kJ10pCgkJZWxzZToKCQkJYWRkRGlyMigiW0JdVGVtcG9yYWRhWy9CXSAiK3N0cihjKSwgKHVybCAlICc5OTknKSwgMTE1LCAnZXBpc29kaW9zJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywndGVtcG9yYWRhcycsICd0ZW1wb3JhZGEnK3N0cihjKSsnLnBuZycpLHBvc3Rlcj1fX0FQSV9fK3Jlc3VsdGFkb1snYmFja2dyb3VuZCddKQoJCgl2aXN0YV90ZW1wb3JhZGFzKCkKCmRlZiBnZXRFcGlzb2Rlcyh1cmwpOgoJI2hlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICdCZWFyZXIgJXMnICUgX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuTXJwaXJhY3knKQoJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCwgaGVhZGVyPWhlYWRlcnMsIGNvb2tpZT1nZXRDb29raWUoKSkKCWlmIHJlc3VsdGFkbyA9PSAnRE5TJzoKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdUZW0gZGUgYWx0ZXJhciBvcyBETlMgcGFyYSBwb2RlciB1c3VmcnVpciBkbyBfX0FERE9OX18uJykKCQlyZXR1cm4gRmFsc2UKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJaWYgJ3NlcmllJyBpbiB1cmw6CgkJdGlwbyA9ICdzZXJpZXMnCgllbGlmICdhbmltZScgaW4gdXJsOgoJCXRpcG8gPSAnYW5pbWVzJwoJZm9yIGkgaW4gcmVzdWx0YWRvWydkYXRhJ106CgkJcHQgPSAnJwoJCWluZm9MYWJlbHMgPSB7J1RpdGxlJzogaVsnbm9tZV9lcGlzb2RpbyddLCAnQ29kZSc6IGlbJ0lNQkQnXSwgJ0VwaXNvZGUnOiBpWydlcGlzb2RpbyddLCAnU2Vhc29uJzogaVsndGVtcG9yYWRhJ10gfQoJCQoJCXRyeToKCQkJbm9tZSA9IGlbJ25vbWVfZXBpc29kaW8nXS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6CgkJCW5vbWUgPSBpWydub21lX2VwaXNvZGlvJ10uZW5jb2RlKCd1dGYtOCcpCgkJYnIgPSAnJwoJCWZpbmFsID0gJycKCQlzZW1MZWdlbmRhID0gJycKCQlpZiBpWydmaW10ZW1wb3JhZGEnXSA9PSAxOgoJCQlmaW5hbCA9ICdbQl1GaW5hbCBkYSBUZW1wb3JhZGEgWy9CXScKCQlpZiBpWydzZW1sZWdlbmRhJ10gPT0gMToKCQkJc2VtTGVnZW5kYSA9ICdbQ09MT1IgcmVkXVtCXVMvIExFR0VOREEgWy9CXVsvQ09MT1JdJwoJCSNpZiAnQnJhc2lsZWlybycgaW4gY2F0ZWdvcmlhOgoJCSMJYnIgPSAnW0JdW0NPTE9SIGdyZWVuXUJbL0NPTE9SXVtDT0xPUiB5ZWxsb3ddUlsvQ09MT1JdOiBbL0JdJwoJCSNpZiAnUG9ydHUnIGluIGNhdGVnb3JpYToKCQkjCXB0ID0gJ1tCXVtDT0xPUiBncmVlbl1QWy9DT0xPUl1bQ09MT1IgcmVkXVRbL0NPTE9SXTogWy9CXScKCQlpZiAnUFQnIGluIGlbJ0lNQkQnXToKCQkJaVsnSU1CRCddID0gcmUuY29tcGlsZSgnKC4rPylQVCcpLmZpbmRhbGwoaVsnSU1CRCddKVswXQoJCQlwdCA9ICdbQl1bQ09MT1IgZ3JlZW5dUFsvQ09MT1JdW0NPTE9SIHJlZF1UWy9DT0xPUl06IFsvQl0nCgkJdmlzdG8gPSBGYWxzZQoJCWNvciA9ICd3aGl0ZScKCQkjaWYgaVsndmlzdG8nXSA9PSAxOgoJCSMJdmlzdG8gPSBUcnVlCQoJCQoJCWltYWdlbSA9ICcnCgkJaWYgaVsnaW1hZ2VtJ10gPT0gMToKCQkJaW1hZ2VtID0gX19BUElfXysnaW1hZ2VzL3Nlcmllcy8nK2lbJ0lNQkQnXSsnLmpwZycKCQllbGlmIGlbJ2ltYWdlbSddID09IDA6CgkJCWltYWdlbSA9IF9fQVBJX18rJ2ltYWdlcy9jYXBhcy8nK2lbJ2ltZGJTZXJpZSddKycuanBnJwoJCQoJCSNpbWFnZW0gPSBpbWFnZW0ucmVwbGFjZSgnUFQnLCcnKQoJCSNpWydiYWNrZ3JvdW5kJ10gPSBpWydiYWNrZ3JvdW5kJ10ucmVwbGFjZSgnUFQnLCcnKQoJCWlbJ2JhY2tncm91bmQnXSA9ICdpbWFnZXMvYmFja2dyb3VuZC8nK2lbJ0lNQkQnXSsnLmpwZycKCQlmYW5hcnR0dCA9IF9fQVBJX18raVsnYmFja2dyb3VuZCddCgkJCgkJbm9tZWVlID0gcHQrYnIrZmluYWwrc2VtTGVnZW5kYSsnW0NPTE9SICcrY29yKyddW0JdRXBpc29kaW8gJytzdHIoaVsnZXBpc29kaW8nXSkrJ1svQl1bL0NPTE9SXSAnK3JlbW92ZXJBY2VudG9zKG5vbWUpCgkJdXJsbm92byA9IF9fQVBJX1NJVEVfXyt0aXBvKycucGhwP2FjdGlvbj1lcGlzb2RpbyZpZFNlcmllPScrc3RyKGlbJ2lkX3NlcmllJ10pKycmaWRFcGlzb2Rpbz0nK3N0cihpWydpZF9lcGlzb2RpbyddKQoJCWFkZFZpZGVvKG5vbWVlZSwgdXJsbm92bywgMTEzLCBpbWFnZW0sIHZpc3RvLCAnZXBpc29kaW8nLCBpWyd0ZW1wb3JhZGEnXSwgaVsnZXBpc29kaW8nXSwgaW5mb0xhYmVscywgZmFuYXJ0dHQpCgkKCXZpc3RhX2VwaXNvZGlvcygpCgpkZWYgZ2V0R2VuZXJvcyh1cmwpOgoJbGlzdGEgPSBnZXRMaXN0Q2F0ZWdvcmlhKCkKCWlmICdmaWxtZXMnIGluIHVybDoKCQl0aXBvID0gMAoJCXF1YWxpZGFkZSA9ICcmcXVhbGlkYWRlPScrX19RdWFsaWRhZGVfXwoJZWxpZiAnc2VyaWVzJyBpbiB1cmw6CgkJdGlwbyA9IDEKCQlxdWFsaWRhZGUgPSAnJwoJZWxpZiAnYW5pbWVzJyBpbiB1cmw6CgkJdGlwbyA9IDIKCQlxdWFsaWRhZGUgPSAnJwoJCglmb3IgYyBpbiBhc3QubGl0ZXJhbF9ldmFsKGxpc3RhKToKCQlpZiBjWydpZF9jYXRlZ29yaWEnXSA9PSAiMCI6CgkJCWNvbnRpbnVlCgkJdHJ5OgoJCQljYXQgPSBjWydjYXRlZ29yaWFzJ10uZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OgoJCQljYXQgPSBjWydjYXRlZ29yaWFzJ10uZW5jb2RlKCd1dGYtOCcpCgkJCgkJdXJsbm92byA9IHVybCsnJmNhdGVnb3JpYT0nK3N0cihjWydpZF9jYXRlZ29yaWEnXSkrcXVhbGlkYWRlOwoJCWFkZERpcjIoY2F0LCB1cmxub3ZvLCAxMjIsICdjYXRlZ29yaWFzJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2dlbmVyby5wbmcnKSkKCQoJdmlzdGFfbWVudSgpCgpkZWYgc2V0RmlsbWUoaSwgdmlzdG9zLCBvcGNhbyk6CgljYXRlZ29yaWEgPSBnZXRDYXRlZ29yaWEoaVsnY2F0ZWdvcmlhMSddKQoJaWYgaW50KGlbJ2NhdGVnb3JpYTInXSkgIT0gMDoKCQljYXRlZ29yaWEgKz0gJywnK2dldENhdGVnb3JpYShpWydjYXRlZ29yaWEyJ10pCglpZiBpbnQoaVsnY2F0ZWdvcmlhMyddKSAhPSAwOgoJCWNhdGVnb3JpYSArPSAnLCcrZ2V0Q2F0ZWdvcmlhKGlbJ2NhdGVnb3JpYTMnXSkKCQoJcHQgPSAnJwoJYnIgPSAnJwoJc2VtTGVnZW5kYSA9ICcnCgl2aXN0byA9IEZhbHNlCgl2aXN0b2EgPSBGYWxzZQoJdmVyaWZpY2FyVmlzdG9Mb2NhbChpWydpZF92aWRlbyddKQoJCgl0cnk6CgkJbm9tZSA9IGlbJ25vbWVfaW5nbGVzJ10uZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6CgkJbm9tZSA9IGlbJ25vbWVfaW5nbGVzJ10uZW5jb2RlKCd1dGYtOCcpCglpZiAnaHR0cCcgbm90IGluIGlbJ2ZvdG8nXToKCQlpWydmb3RvJ10gPSBfX0FQSV9fKydpbWFnZXMvY2FwYXMvJytpWydmb3RvJ10uc3BsaXQoJy8nKVstMV0KCQoJaWYgaVsnbGVnZW5kYSddID09ICJzZW1sZWdlbmRhIjoKCQlzZW1MZWdlbmRhID0gJ1tDT0xPUiByZWRdW0JdUy8gTEVHRU5EQSBbL0JdWy9DT0xPUl0nCglpZiAnQnJhc2lsZWlybycgaW4gY2F0ZWdvcmlhOgoJCWJyID0gJ1tCXVtDT0xPUiBncmVlbl1CWy9DT0xPUl1bQ09MT1IgeWVsbG93XVJbL0NPTE9SXTogWy9CXScKCWlmICdQb3J0dScgaW4gY2F0ZWdvcmlhOgoJCXB0ID0gJ1tCXVtDT0xPUiBncmVlbl1QWy9DT0xPUl1bQ09MT1IgcmVkXVRbL0NPTE9SXTogWy9CXScKCWNvciA9ICJ3aGl0ZSIKCWlmICdQVCcgaW4gaVsnSU1CRCddOgoJCWlbJ0lNQkQnXSA9IHJlLmNvbXBpbGUoJyguKz8pUFQnKS5maW5kYWxsKGlbJ0lNQkQnXSlbMF0KCQlwdCA9ICdbQl1bQ09MT1IgZ3JlZW5dUFsvQ09MT1JdW0NPTE9SIHJlZF1UWy9DT0xPUl06IFsvQl0nCgkKCWltZGJSID0ganNvbi5sb2FkcyhpWydpbWRiUmF0aW5nJ10pCgkKCWluZm9MYWJlbHMgPSB7J1RpdGxlJzogaVsnbm9tZV9pbmdsZXMnXSwgJ1llYXInOiBpWydhbm8nXSwgJ0dlbnJlJzogY2F0ZWdvcmlhLCAnUGxvdCc6aVsnZGVzY3JpY2FvX3ZpZGVvJ10sICdDYXN0JzppWydhdG9yZXMnXS5zcGxpdCgnLCcpLCAnVHJhaWxlcic6IGltZGJSWyd0cmFpbGVyJ10sICdEaXJlY3Rvcic6IGlbJ2RpcmV0b3InXSwgJ1JhdGluZyc6IGltZGJSWydyYW5raW5nJ10sICdJTURCTnVtYmVyJzogaVsnSU1CRCddIH0KCglub21lZWUgPSAnW0NPTE9SICcrY29yKyddJytwdCticitzZW1MZWdlbmRhK3JlbW92ZXJBY2VudG9zKG5vbWUpKycgKCcraVsnYW5vJ10rJylbL0NPTE9SXScKCXVybG5vbyA9IF9fQVBJX1NJVEVfXysnZmlsbWVzLnBocD9hY3Rpb249aWQmaWRGaWxtZT0nK3N0cihpWydpZF92aWRlbyddKQoJZm90b29vID0gaVsnZm90byddCglpWydiYWNrZ3JvdW5kJ10gPSAnaW1hZ2VzL2JhY2tncm91bmQvJytpWydJTUJEJ10rJy5qcGcnCglmYW5hcnR0dCA9IF9fQVBJX18raVsnYmFja2dyb3VuZCddCgkKCWFkZFZpZGVvKG5vbWVlZSwgdXJsbm9vLCAxMTMsIGZvdG9vbyx2aXN0bywgJ3BsYXllcicsIDAsIDAsIGluZm9MYWJlbHMsIGZhbmFydHR0LCB0cmFpbGVyPWltZGJSWyd0cmFpbGVyJ10pCgpkZWYgc2V0U2VyaWVzKGksIHZpc3Rvcywgb3BjYW8sIHRpcG8pOgoJY2F0ZWdvcmlhID0gZ2V0Q2F0ZWdvcmlhKGlbJ2NhdGVnb3JpYTEnXSkKCWlmIGludChpWydjYXRlZ29yaWEyJ10pICE9IDA6CgkJY2F0ZWdvcmlhICs9ICcsJytnZXRDYXRlZ29yaWEoaVsnY2F0ZWdvcmlhMiddKQoJaWYgaW50KGlbJ2NhdGVnb3JpYTMnXSkgIT0gMDoKCQljYXRlZ29yaWEgKz0gJywnK2dldENhdGVnb3JpYShpWydjYXRlZ29yaWEzJ10pCgkKCXB0ID0gJycKCWJyID0gJycKCXNlbUxlZ2VuZGEgPSAnJwoJI2lmIGlbJ2xlZ2VuZGEnXSA9PSAic2VtbGVnZW5kYSI6CgkjCXNlbUxlZ2VuZGEgPSAnW0NPTE9SIHJlZF1bQl1TLyBMRUdFTkRBIFsvQl1bL0NPTE9SXScKCWlmICdCcmFzaWxlaXJvJyBpbiBjYXRlZ29yaWE6CgkJYnIgPSAnW0JdW0NPTE9SIGdyZWVuXUJbL0NPTE9SXVtDT0xPUiB5ZWxsb3ddUlsvQ09MT1JdOiBbL0JdJwoJaWYgJ1BvcnR1JyBpbiBjYXRlZ29yaWE6CgkJcHQgPSAnW0JdW0NPTE9SIGdyZWVuXVBbL0NPTE9SXVtDT0xPUiByZWRdVFsvQ09MT1JdOiBbL0JdJwoJaWYgJ1BUJyBpbiBpWydJTUJEJ106CgkJcHQgPSAnW0JdW0NPTE9SIGdyZWVuXVBbL0NPTE9SXVtDT0xPUiByZWRdVFsvQ09MT1JdOiBbL0JdJwoJdmlzdG8gPSBGYWxzZQoJdmlzdG9hID0gRmFsc2UKCXZlcmlmaWNhclZpc3RvTG9jYWwoaVsnaWRfdmlkZW8nXSkKCXRyeToKCQlub21lID0gaVsnbm9tZV9pbmdsZXMnXS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDoKCQlub21lID0gaVsnbm9tZV9pbmdsZXMnXS5lbmNvZGUoJ3V0Zi04JykKCWlmICdodHRwJyBub3QgaW4gaVsnZm90byddOgoJCWlbJ2ZvdG8nXSA9IF9fQVBJX18rJ2ltYWdlcy9jYXBhcy8nK2lbJ2ZvdG8nXS5zcGxpdCgnLycpWy0xXQoJCSNpWydmb3RvJ10gPSBpWydmb3RvJ10ucmVwbGFjZSgnUFQnLCcnKQoJCglpbWRiUiA9IGpzb24ubG9hZHMoaVsnaW1kYlJhdGluZyddKQoJdXJsbm9vID0gX19BUElfU0lURV9fK3RpcG8rJy5waHA/YWN0aW9uPWlkJmlkU2VyaWU9JytzdHIoaVsnaWRfdmlkZW8nXSkKCWluZm9MYWJlbHMgPSB7J1RpdGxlJzogaVsnbm9tZV9pbmdsZXMnXSwgJ1llYXInOiBpWydhbm8nXSwgJ0dlbnJlJzogY2F0ZWdvcmlhLCAnUGxvdCc6IGlbJ2Rlc2NyaWNhb192aWRlbyddLCAnQ2FzdCc6aVsnYXRvcmVzJ10uc3BsaXQoJywnKSwgJ1RyYWlsZXInOiBpbWRiUlsndHJhaWxlciddLCAnRGlyZWN0b3InOiBpWydkaXJldG9yJ10sICdSYXRpbmcnOiBpbWRiUlsncmFua2luZyddLCAnQ29kZSc6IGlbJ0lNQkQnXSB9CgkKCW5vbWVlZSA9IHB0K2JyK3NlbUxlZ2VuZGErcmVtb3ZlckFjZW50b3Mobm9tZSkrJyAoJytpWydhbm8nXSsnKScKCWZvdG9vbyA9IGlbJ2ZvdG8nXQoJI2lbJ2JhY2tncm91bmQnXSA9IGlbJ2JhY2tncm91bmQnXS5yZXBsYWNlKCdQVCcsJycpCglpWydiYWNrZ3JvdW5kJ10gPSAnaW1hZ2VzL2JhY2tncm91bmQvJytpWydJTUJEJ10rJy5qcGcnCglmYW5hcnR0dCA9IF9fQVBJX18raVsnYmFja2dyb3VuZCddCglhZGREaXIyKG5vbWVlZSwgdXJsbm9vLCAxMTQsICd0ZW1wb3JhZGFzJywgZm90b29vLCB0aXBvPSdzZXJpZScsIGluZm9MYWJlbHM9aW5mb0xhYmVscyxwb3N0ZXI9ZmFuYXJ0dHQsdmlzdG89dmlzdG8pCgpkZWYgY2F0ZWdvcmlhcyh1cmwpOgoJI2hlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICdCZWFyZXIgJXMnICUgX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuTXJwaXJhY3knKQoJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCwgaGVhZGVyPWhlYWRlcnMsIGNvb2tpZT1nZXRDb29raWUoKSkKCSNpZiByZXN1bHRhZG8gPT0gJ0ROUyc6CgkjCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1RlbSBkZSBhbHRlcmFyIG9zIEROUyBwYXJhIHBvZGVyIHVzdWZydWlyIGRvIF9fQURET05fXy4nKQoJIwlyZXR1cm4gRmFsc2UKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJdmlzdG9zID0gRGF0YWJhc2Uuc2VsZWN0RmlsbWVzKCkKCW9wY2FvID0gX19BRERPTl9fLmdldFNldHRpbmcoJ21hcmNhclZpc3RvJykKCWlmICdzZXJpZScgaW4gdXJsOgoJCXRpcG8gPSAnc2VyaWVzJwoJZWxpZiAnYW5pbWUnIGluIHVybDoKCQl0aXBvID0gJ2FuaW1lcycKCWZvciBpIGluIHJlc3VsdGFkb1siZGF0YSJdOgoJCWlmICdmaWxtZScgaW4gdXJsOgoJCQlzZXRGaWxtZShpLCB2aXN0b3MsIG9wY2FvKQoJCWVsaWYgJ3NlcmllJyBpbiB1cmwgb3IgJ2FuaW1lJyBpbiB1cmw6CgkJCXNldFNlcmllcyhpLCB2aXN0b3MsIG9wY2FvLCB0aXBvKQoJY3VycmVudCA9IHJlc3VsdGFkb1snbWV0YSddWydjdXJyZW50J10KCXRvdGFsID0gcmVzdWx0YWRvWydtZXRhJ11bJ3RvdGFsJ10KCXRyeTogcHJveGltbyA9IHJlc3VsdGFkb1snbWV0YSddWydwYWdpbmFjYW8nXVsnbmV4dCddCglleGNlcHQ6IHBhc3MgCglpZiBpbnQoY3VycmVudCkgPCBpbnQodG90YWwpOgoJCWFkZERpcjIoJ1Byw7N4aW1hIHDDoWdpbmEgKCcrc3RyKGN1cnJlbnQpKycvJytzdHIodG90YWwpKycpJywgcHJveGltbywgMTIxLCAnYW5vcycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdwcm94aW1vLnBuZycpLDEpCgkKCXZpc3RhX2ZpbG1lc1NlcmllcygpCgpkZWYgZ2V0WWVhcnModXJsKToKCWFub3MgPSBbCgkJCScyMDE5JywKCQkJJzIwMTgnLAoJCQknMjAxNycsCgkJCScyMDE2JywKCQkJJzIwMTUnLAoJCQknMjAxNCcsCgkJCScyMDEzJywKCQkJJzIwMTInLAoJCQknMjAxMScsCgkJCScyMDEwJywKCQkJJzIwMDknLAoJCQknMjAwOCcsCgkJCScyMDA3JywKCQkJJzIwMDYnLAoJCQknMjAwMC0yMDA1JywKCQkJJzE5OTAtMTk5OScsCgkJCScxOTgwLTE5ODknLAoJCQknMTk3MC0xOTc5JywKCQkJJzE5NjAtMTk2OScsCgkJCScxOTUwLTE5NTknLAoJCQknMTkwMC0xOTQ5JwoJCV0KCWlmICdmaWxtZXMnIGluIHVybDoKCQl0aXBvID0gMAoJCXF1YWxpZGFkZSA9ICcmcXVhbGlkYWRlPScrX19RdWFsaWRhZGVfXwoJZWxpZiAnc2VyaWVzJyBpbiB1cmw6CgkJdGlwbyA9IDEKCQlxdWFsaWRhZGUgPSAnJwoJZWxpZiAnYW5pbWVzJyBpbiB1cmw6CgkJdGlwbyA9IDIKCQlxdWFsaWRhZGUgPSAnJwoJZm9yIGkgaW4gYW5vczoKCQl1cmxub3ZvID0gdXJsKycmYW5vPScraStxdWFsaWRhZGU7CgkJYWRkRGlyMihpLCB1cmxub3ZvLCAxMjEsICdhbm9zJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Fuby5wbmcnKSkKCQkKCXZpc3RhX21lbnUoKQoKZGVmIGFub3ModXJsKToKCSNoZWFkZXJzWydBdXRob3JpemF0aW9uJ10gPSAnQmVhcmVyICVzJyAlIF9fQURET05fXy5nZXRTZXR0aW5nKCd0b2tlbk1ycGlyYWN5JykKCXJlc3VsdGFkbyA9IGFicmlyX3VybCh1cmwsIGhlYWRlcj1oZWFkZXJzLCBjb29raWU9Z2V0Q29va2llKCkpCglpZiByZXN1bHRhZG8gPT0gJ0ROUyc6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVGVtIGRlIGFsdGVyYXIgb3MgRE5TIHBhcmEgcG9kZXIgdXN1ZnJ1aXIgZG8gX19BRERPTl9fLicpCgkJcmV0dXJuIEZhbHNlCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCXZpc3RvcyA9IERhdGFiYXNlLnNlbGVjdEZpbG1lcygpCglvcGNhbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCdtYXJjYXJWaXN0bycpCglpZiAnc2VyaWUnIGluIHVybDoKCQl0aXBvID0gJ3NlcmllcycKCWVsaWYgJ2FuaW1lJyBpbiB1cmw6CgkJdGlwbyA9ICdhbmltZXMnCglmb3IgaSBpbiByZXN1bHRhZG9bImRhdGEiXToKCQlpZiAnZmlsbWUnIGluIHVybDoKCQkJc2V0RmlsbWUoaSwgdmlzdG9zLCBvcGNhbykKCQllbGlmICdzZXJpZScgaW4gdXJsIG9yICdhbmltZScgaW4gdXJsOgoJCQlzZXRTZXJpZXMoaSwgdmlzdG9zLCBvcGNhbywgdGlwbykKCQoJdHJ5OiAKCQljdXJyZW50ID0gcmVzdWx0YWRvWydtZXRhJ11bJ2N1cnJlbnQnXQoJZXhjZXB0OiAKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdBZ3VhcmRlIHBlbGEgcHLDs3hpbWEgYXR1YWxpemHDp8Ojby4gT3UgdGVudGUgbWFpcyB0YXJkZS4nKQoJCXJldHVybiBGYWxzZQoJY3VycmVudCA9IHJlc3VsdGFkb1snbWV0YSddWydjdXJyZW50J10KCXRvdGFsID0gcmVzdWx0YWRvWydtZXRhJ11bJ3RvdGFsJ10KCXRyeTogcHJveGltbyA9IHJlc3VsdGFkb1snbWV0YSddWydwYWdpbmFjYW8nXVsnbmV4dCddCglleGNlcHQ6IHBhc3MgCglpZiBpbnQoY3VycmVudCkgPCBpbnQodG90YWwpOgoJCWFkZERpcjIoJ1Byw7N4aW1hIHDDoWdpbmEgKCcrc3RyKGN1cnJlbnQpKycvJytzdHIodG90YWwpKycpJywgcHJveGltbywgMTIxLCAnYW5vcycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdwcm94aW1vLnBuZycpLDEpCgkKCXZpc3RhX2ZpbG1lc1NlcmllcygpCgpkZWYgZ2V0RXZlbnRvcygpOgoJI2hlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICdCZWFyZXIgJXMnICUgX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuTXJwaXJhY3knKQoJcmVzdWx0YWRvID0gYWJyaXJfdXJsKF9fQVBJX1NJVEVfXysnZXZlbnRvcycsIGhlYWRlcj1oZWFkZXJzLCBjb29raWU9Z2V0Q29va2llKCkpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCXRyeToKCQlpZiByZXN1bHRhZG9bJ2NvZGlnbyddID09IDIwNDoKCQkJcmV0dXJuIEZhbHNlCglleGNlcHQ6CgkJcGFzcwoJcmV0dXJuIHJlc3VsdGFkb1snZGF0YSddWydub21lJ10KCQkKCQkKZGVmIHBsYXllcihuYW1lLHVybCxpY29uaW1hZ2UsdGVtcG9yYWRhLGVwaXNvZGlvLHNlcmllTm9tZSk6CgkjaGVhZGVyc1snQXV0aG9yaXphdGlvbiddID0gJ0JlYXJlciAlcycgJSBfX0FERE9OX18uZ2V0U2V0dGluZygndG9rZW5NcnBpcmFjeScpCglyZXN1bHRhZG8gPSBhYnJpcl91cmwodXJsLCBoZWFkZXI9aGVhZGVycywgY29va2llPWdldENvb2tpZSgpKQoJaWYgcmVzdWx0YWRvID09ICdETlMnOgoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1RlbSBkZSBhbHRlcmFyIG9zIEROUyBwYXJhIHBvZGVyIHVzdWZydWlyIGRvIF9fQURET05fXy4nKQoJCXJldHVybiBGYWxzZQoJCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbylbMF0KCSNyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCWluZm9sYWJlbHMgPSBkaWN0KCkKCWNvaXNvID0gJycKCXBhc3RhRGF0YSA9ICcnCgl0aXBvID0gJycKCWlkVmlkZW8gPSAnJwoJaWYgJ2ZpbG1lJyBpbiB1cmw6CgkJdGlwbyA9ICdmaWxtZScKCQlpbmZvbGFiZWxzWydDb2RlJ10gPSByZXN1bHRhZG9bJ0lNQkQnXQoJCWluZm9sYWJlbHNbJ1llYXInXSA9IHJlc3VsdGFkb1snYW5vJ10KCQlpZFZpZGVvID0gcmVzdWx0YWRvWydpZF92aWRlbyddCgkJbm9tZSA9IHJlc3VsdGFkb1snbm9tZV9pbmdsZXMnXQoJCXRlbXBvcmFkYSA9IDAKCQllcGlzb2RpbyA9IDAKCQljb2lzbyA9ICdmaWxtZScKCWVsc2U6CgkJaWYgJ3NlcmllJyBpbiB1cmw6CgkJCXRpcG8gPSAnc2VyaWUnCgkJZWxzZToKCQkJdGlwbyA9ICdhbmltZScKCQlpZFZpZGVvID0gcmVzdWx0YWRvWydpZF9zZXJpZSddCgkJbm9tZSA9IHJlc3VsdGFkb1snbm9tZV9lcGlzb2RpbyddCgkJdGVtcG9yYWRhID0gcmVzdWx0YWRvWyd0ZW1wb3JhZGEnXQoJCWVwaXNvZGlvID0gcmVzdWx0YWRvWydlcGlzb2RpbyddCgkJY29pc28gPSAnb3V0cm8nCgoJbWVuc2FnZW1wcm9ncmVzc28gPSB4Ym1jZ3VpLkRpYWxvZ1Byb2dyZXNzKCkKCW1lbnNhZ2VtcHJvZ3Jlc3NvLmNyZWF0ZShBZGRvblRpdGxlLCB1J0FicmlyIGVtaXNzw6NvJywnUG9yIGZhdm9yIGFndWFyZGUuLi4nKQoJbWVuc2FnZW1wcm9ncmVzc28udXBkYXRlKDI1LCAiIiwgdSdPYnRlciB2aWRlbyBlIGxlZ2VuZGEnLCAiIikKCglzdHJlYW0sIGxlZ2VuZGEsIGV4dF9nID0gZ2V0U3RyZWFtTGVnZW5kYShpZFZpZGVvLCB0aXBvLCBjb2lzbz1jb2lzbykKCWlmIHN0cmVhbSA9PSBGYWxzZSBhbmQgbGVnZW5kYSA9PSAyMDQ6CgkJbWVuc2FnZW1wcm9ncmVzc28uY2xvc2UoKQoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1RlbSBkZSBlc3BlcmFyIDggaG9yYXMgYXTDqSBjb25zZWd1aXIgdmlzdWFsaXphciBhbGd1bSB2aWRlby4nKQoJCXJldHVybiBGYWxzZQoJCgltZW5zYWdlbXByb2dyZXNzby51cGRhdGUoNTAsICIiLCB1J1ByZXBhcmEtdGUsIHZhaSBjb21lw6dhciEnLCAiIikKCXBsYXlsaXN0ID0geGJtYy5QbGF5TGlzdCgxKQoJcGxheWxpc3QuY2xlYXIoKQoJbGlzdGl0ZW0gPSB4Ym1jZ3VpLkxpc3RJdGVtKG5hbWUsIGljb25JbWFnZT0iRGVmYXVsdFZpZGVvLnBuZyIsIHRodW1ibmFpbEltYWdlPWljb25pbWFnZSkKCglsaXN0aXRlbS5zZXRJbmZvKHR5cGU9IlZpZGVvIiwgaW5mb0xhYmVscz1pbmZvbGFiZWxzKQoJbGlzdGl0ZW0uc2V0UHJvcGVydHkoJ21pbWV0eXBlJywgJ3ZpZGVvL3gtbXN2aWRlbycpCglsaXN0aXRlbS5zZXRQcm9wZXJ0eSgnSXNQbGF5YWJsZScsICd0cnVlJykKCQoJbGlzdGl0ZW0uc2V0UGF0aChwYXRoPXN0cmVhbSkKCXBsYXlsaXN0LmFkZChzdHJlYW0sIGxpc3RpdGVtKQoJeGJtY3BsdWdpbi5zZXRSZXNvbHZlZFVybChpbnQoc3lzLmFyZ3ZbMV0pLCBUcnVlLCBsaXN0aXRlbSkKCW1lbnNhZ2VtcHJvZ3Jlc3NvLnVwZGF0ZSg3NSwgIiIsIHUnQm9hIFNlc3PDo28hISEnLCAiIikKCglpZiBzdHJlYW0gPT0gRmFsc2U6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnTyBzZXJ2aWRvciBlc2NvbGhpZG8gbsOjbyBkaXNwb27DrXZlbCwgZXNjb2xoYSBvdXRybyBvdSB0ZW50ZSBub3ZhbWVudGUgbWFpcyB0YXJkZS4nKQoJZWxzZToKCQkjX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnU3RyZWFtOiAnK3N0cmVhbSkKCQlwbGF5ZXJfbXIgPSBQbGF5ZXIuUGxheWVyKHVybD11cmwsIGlkRmlsbWU9aWRWaWRlbywgcGFzdGFEYXRhPV9fUEFTVEFfREFET1NfXywgdGVtcG9yYWRhPXRlbXBvcmFkYSwgZXBpc29kaW89ZXBpc29kaW8sIG5vbWU9bmFtZSwgbG9nbz1vcy5wYXRoLmpvaW4oX19BRERPTl9GT0xERVJfXywnaWNvbi5wbmcnKSkKCQkKCQltZW5zYWdlbXByb2dyZXNzby5jbG9zZSgpCgkJcGxheWVyX21yLnBsYXkocGxheWxpc3QpCgkJcGxheWVyX21yLnNldFN1YnRpdGxlcyhsZWdlbmRhKQoKCQl3aGlsZSBwbGF5ZXJfbXIucGxheWluZzoKCQkJeGJtYy5zbGVlcCg1MDAwKQoJCQkjcGxheWVyX21yLnRyYWNrZXJUZW1wbygpCgpkZWYgbWFyY2FyVmlzdG8odXJsKToKCXJlc3VsdGFkbyA9IGFicmlyX3VybCh1cmwsIGhlYWRlcj1oZWFkZXJzLCBjb29raWU9Z2V0Q29va2llKCkpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbylbMF0KCWxpbmtzID0gdXJsLnNwbGl0KCcvJykKCW9wY2FvID0gX19BRERPTl9fLmdldFNldHRpbmcoJ21hcmNhclZpc3RvJykKCWlmICdmaWxtZScgaW4gdXJsOgoJCWlkX3ZpZGVvID0gcmVzdWx0YWRvWydpZF92aWRlbyddCgkJaW1kYiA9IHJlc3VsdGFkb1snSU1CRCddCgkJcG9zdCA9IHsnaWRfZmlsbWUnOiBpZF92aWRlb30KCQl0aXBvID0gMAoJZWxpZiAnc2VyaWUnIGluIHVybDoKCQlpbWRiICA9IHJlc3VsdGFkb1snZm90b1NlcmllJ10uc3BsaXQoJy8nKVstMV0uc3BsaXQoJy4nKVswXQoJCWlkX3ZpZGVvID0gcmVzdWx0YWRvWydpZF9zZXJpZSddCgkJdGVtcG9yYWRhID0gcmVzdWx0YWRvWyd0ZW1wb3JhZGEnXQoJCWVwaXNvZGlvID0gcmVzdWx0YWRvWydlcGlzb2RpbyddCgkJcG9zdCA9IHsnaWRfc2VyaWUnOiBpZF92aWRlbywgJ3RlbXBvcmFkYSc6IHRlbXBvcmFkYSwgJ2VwaXNvZGlvJzplcGlzb2Rpb30KCQl0aXBvID0gMQoJZWxpZiAnYW5pbWUnIGluIHVybDoKCQlpbWRiICA9IHJlc3VsdGFkb1snZm90b1NlcmllJ10uc3BsaXQoJy8nKVstMV0uc3BsaXQoJy4nKVswXQoJCWlkX3ZpZGVvID0gcmVzdWx0YWRvWydpZF9zZXJpZSddCgkJdGVtcG9yYWRhID0gcmVzdWx0YWRvWyd0ZW1wb3JhZGEnXQoJCWVwaXNvZGlvID0gcmVzdWx0YWRvWydlcGlzb2RpbyddCgkJcG9zdCA9IHsnaWRfYW5pbWUnOiBpZF92aWRlbywgJ3RlbXBvcmFkYSc6IHRlbXBvcmFkYSwgJ2VwaXNvZGlvJzplcGlzb2Rpb30KCQl0aXBvID0gMgoJcGFzdGFWaXN0bz1vcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCd2aXN0b3MnKQoJdHJ5OgoJCW9zLm1ha2VkaXJzKHBhc3RhVmlzdG8pCglleGNlcHQ6CgkJcGFzcwoJaWYgdGlwbyA9PSAxIG9yIHRpcG8gPT0gMjoKCQlmaWNoZWlybyA9IG9zLnBhdGguam9pbihwYXN0YVZpc3RvLCBzdHIoaWRfdmlkZW8pKydfUycrc3RyKHRlbXBvcmFkYSkrJ3gnK3N0cihlcGlzb2RpbykrJy5saXZlaXQnKQoJZWxpZiB0aXBvID09IDA6CgkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4ocGFzdGFWaXN0bywgc3RyKGlkX3ZpZGVvKSsnLmxpdmVpdCcpCglpZiBub3Qgb3MucGF0aC5leGlzdHMoZmljaGVpcm8pOgoJCWYgPSBvcGVuKGZpY2hlaXJvLCAndycpCgkJZi53cml0ZSgnJykKCQlmLmNsb3NlKCkKCWVzY3JldmVyX2ZpY2hlaXJvKG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ3Zpc3Rvc19maWxtZXMubGl2ZWl0JyksIHZpc3Rvc19maWxtZXMpCgl4Ym1jLmV4ZWN1dGVidWlsdGluKCJYQk1DLk5vdGlmaWNhdGlvbigiK0FkZG9uVGl0bGUrIiwiKyJNYXJjYWRvIGNvbW8gdmlzdG8iKyIsIisiNjAwMSIrIiwiKyBvcy5wYXRoLmpvaW4oY29udHJvbG8uYWRkb25Gb2xkZXIsJ2ljb24ucG5nJykrIikiKQoJeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlJlZnJlc2giKQoKZGVmIG1hcmNhck5hb1Zpc3RvKHVybCk6CglyZXN1bHRhZG8gPSBhYnJpcl91cmwodXJsLCBoZWFkZXI9aGVhZGVycywgY29va2llPWdldENvb2tpZSgpKQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pWzBdCglsaW5rcyA9IHVybC5zcGxpdCgnLycpCglvcGNhbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCdtYXJjYXJWaXN0bycpCglpZiAnZmlsbWUnIGluIHVybDoKCQlpZF92aWRlbyA9IHJlc3VsdGFkb1snaWRfdmlkZW8nXQoJCWltZGIgPSByZXN1bHRhZG9bJ0lNQkQnXQoJCXBvc3QgPSB7J2lkX2ZpbG1lJzogaWRfdmlkZW99CgkJdGlwbyA9IDAKCWVsaWYgJ3NlcmllJyBpbiB1cmw6CgkJaW1kYiAgPSByZXN1bHRhZG9bJ2ZvdG9TZXJpZSddLnNwbGl0KCcvJylbLTFdLnNwbGl0KCcuJylbMF0KCQlpZF92aWRlbyA9IHJlc3VsdGFkb1snaWRfc2VyaWUnXQoJCXRlbXBvcmFkYSA9IHJlc3VsdGFkb1sndGVtcG9yYWRhJ10KCQllcGlzb2RpbyA9IHJlc3VsdGFkb1snZXBpc29kaW8nXQoJCXBvc3QgPSB7J2lkX3NlcmllJzogaWRfdmlkZW8sICd0ZW1wb3JhZGEnOiB0ZW1wb3JhZGEsICdlcGlzb2Rpbyc6ZXBpc29kaW99CgkJdGlwbyA9IDEKCWVsaWYgJ2FuaW1lJyBpbiB1cmw6CgkJaW1kYiAgPSByZXN1bHRhZG9bJ2ZvdG9TZXJpZSddLnNwbGl0KCcvJylbLTFdLnNwbGl0KCcuJylbMF0KCQlpZF92aWRlbyA9IHJlc3VsdGFkb1snaWRfc2VyaWUnXQoJCXRlbXBvcmFkYSA9IHJlc3VsdGFkb1sndGVtcG9yYWRhJ10KCQllcGlzb2RpbyA9IHJlc3VsdGFkb1snZXBpc29kaW8nXQoJCXBvc3QgPSB7J2lkX2FuaW1lJzogaWRfdmlkZW8sICd0ZW1wb3JhZGEnOiB0ZW1wb3JhZGEsICdlcGlzb2Rpbyc6ZXBpc29kaW99CgkJdGlwbyA9IDIKCQoJcGFzdGFWaXN0bz1vcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCd2aXN0b3MnKQoJdHJ5OgoJCW9zLm1ha2VkaXJzKHBhc3RhVmlzdG8pCglleGNlcHQ6CgkJcGFzcwoKCWlmIHRpcG8gPT0gMSBvciB0aXBvID09IDI6CgkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4ocGFzdGFWaXN0bywgc3RyKGlkX3ZpZGVvKSsnX1MnK3N0cih0ZW1wb3JhZGEpKyd4JytzdHIoZXBpc29kaW8pKycubXJwaXJhY3knKQoJZWxpZiB0aXBvID09IDA6CgkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4ocGFzdGFWaXN0bywgc3RyKGlkX3ZpZGVvKSsnLm1ycGlyYWN5JykKCglpZiBvcy5wYXRoLmV4aXN0cyhmaWNoZWlybyk6CgkJb3MucmVtb3ZlKGZpY2hlaXJvKQoJZXNjcmV2ZXJfZmljaGVpcm8ob3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywndmlzdG9zX2ZpbG1lcy5saXZlaXQnKSwgdmlzdG9zKQoJeGJtYy5leGVjdXRlYnVpbHRpbigiWEJNQy5Ob3RpZmljYXRpb24oIitBZGRvblRpdGxlKyIsIisiTWFyY2FkbyBjb21vIHZpc3RvIisiLCIrIjYwMDEiKyIsIisgb3MucGF0aC5qb2luKGNvbnRyb2xvLmFkZG9uRm9sZGVyLCdpY29uLnBuZycpKyIpIikKCXhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5SZWZyZXNoIikKCmRlZiBnZXRTdHJlYW1MZWdlbmRhKGlkLCB0aXBvLCBjb2lzbz1Ob25lKToKCWlmIHRpcG8gPT0gJ2ZpbG1lJzoKCQl1cmwgPSBfX0FQSV9TSVRFX18rdGlwbysncy5waHA/YWN0aW9uPWxpbmtzJmlkRmlsbWU9JytpZAoJaWYgdGlwbyA9PSAnc2VyaWUnOgoJCXVybCA9IF9fQVBJX1NJVEVfXyt0aXBvKydzLnBocD9hY3Rpb249bGlua3MmaWRFcGlzb2Rpbz0nK2lkCglpZiB0aXBvID09ICdhbmltZSc6CgkJdXJsID0gX19BUElfU0lURV9fK3RpcG8rJ3MucGhwP2FjdGlvbj1saW5rcyZpZEVwaXNvZGlvPScraWQKCglyZXN1bHRhZG8gPSBhYnJpcl91cmwodXJsLCBoZWFkZXI9aGVhZGVycywgY29va2llPWdldENvb2tpZSgpKQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pCgl0cnk6CgkJaWYgcmVzdWx0YWRvWydjb2RpZ28nXSA9PSAyMDQ6CgkJCXJldHVybiBGYWxzZSwgMjA0LCAyMDQKCWV4Y2VwdDogCgkJcmVzdWx0YWRvID0gcmVzdWx0YWRvWzBdCgkKCWkgPSAwCglzZXJ2aWRvcmVzID0gW10KCXRpdHVsb3MgPSBbXQoJbm9tZSA9ICcnCgkKCWlmIHJlc3VsdGFkb1snVVJMJ10gIT0gJyc6CgkJaSs9MQoJCWlmICdvcGVubG9hZCcgaW4gcmVzdWx0YWRvWydVUkwnXToKCQkJbm9tZSA9ICJPcGVuTG9hZCIKCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwnXSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3ZpZHppJyBpbiByZXN1bHRhZG9bJ1VSTCddOgoJCQlub21lID0gJ1ZpZHppJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTCddKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAnZ29vZ2xlJyBpbiByZXN1bHRhZG9bJ1VSTCddIG9yICdjbG91ZC5tYWlsLnJ1JyBpbiByZXN1bHRhZG9bJ1VSTCddOgoJCQlub21lID0gQWRkb25UaXRsZQoJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTCddKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAndXB0b3N0cmVhbS5jb20nIGluIHJlc3VsdGFkb1snVVJMJ106CgkJCW5vbWUgPSAnVXBUb1N0cmVhbScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwnXSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3JhcGlkdmlkZW8uY29tJyBpbiByZXN1bHRhZG9bJ1VSTCddIG9yICdyYXB0dScgaW4gcmVzdWx0YWRvWydVUkwnXToKCQkJbm9tZSA9ICdSYXB0dScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwnXSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3ZpZG96YS5uZXQnIGluIHJlc3VsdGFkb1snVVJMJ106CgkJCW5vbWUgPSAnVmlkb3phJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTCddKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAnc3RyZWFtYW5nby4nIGluIHJlc3VsdGFkb1snVVJMJ106CgkJCW5vbWUgPSAnU3RyZWFtYW5nbycKCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwnXSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ21peGRyb3AudG8nIGluIHJlc3VsdGFkb1snVVJMJ10ubG93ZXIoKToKCQkJbm9tZSA9ICdNaXhkcm9wJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTCddKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCglpZiByZXN1bHRhZG9bJ1VSTDInXSAhPSAnJzoKCQlpKz0xCgkJaWYgJ29wZW5sb2FkJyBpbiByZXN1bHRhZG9bJ1VSTDInXToKCQkJbm9tZSA9ICJPcGVuTG9hZCIKCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwyJ10pCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICd2aWR6aScgaW4gcmVzdWx0YWRvWydVUkwyJ106CgkJCW5vbWUgPSAnVmlkemknCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMMiddKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAnZ29vZ2xlJyBpbiByZXN1bHRhZG9bJ1VSTDInXSBvciAnY2xvdWQubWFpbC5ydScgaW4gcmVzdWx0YWRvWydVUkwyJ106CgkJCW5vbWUgPSBBZGRvblRpdGxlCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMMiddKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAndXB0b3N0cmVhbS5jb20nIGluIHJlc3VsdGFkb1snVVJMMiddOgoJCQlub21lID0gJ1VwVG9TdHJlYW0nCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMMiddKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAncmFwaWR2aWRlby5jb20nIGluIHJlc3VsdGFkb1snVVJMMiddIG9yICdyYXB0dScgaW4gcmVzdWx0YWRvWydVUkwyJ106CgkJCW5vbWUgPSAnUmFwdHUnCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMMiddKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAndmlkb3phLm5ldCcgaW4gcmVzdWx0YWRvWydVUkwyJ106CgkJCW5vbWUgPSAnVmlkb3phJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDInXSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3N0cmVhbWFuZ28uJyBpbiByZXN1bHRhZG9bJ1VSTDInXToKCQkJbm9tZSA9ICdTdHJlYW1hbmdvJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDInXSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ21peGRyb3AudG8nIGluIHJlc3VsdGFkb1snVVJMMiddLmxvd2VyKCk6CgkJCW5vbWUgPSAnTWl4ZHJvcCcKCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwyJ10pCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCXRyeToKCQlpZiByZXN1bHRhZG9bJ1VSTDMnXSAhPSAnJzoKCQkJaSs9MQoJCQlpZiAnb3BlbmxvYWQnIGluIHJlc3VsdGFkb1snVVJMMyddOgoJCQkJbm9tZSA9ICJPcGVuTG9hZCIKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMMyddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd2aWR6aScgaW4gcmVzdWx0YWRvWydVUkwzJ106CgkJCQlub21lID0gJ1ZpZHppJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwzJ10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ2dvb2dsZScgaW4gcmVzdWx0YWRvWydVUkwzJ10gb3IgJ2Nsb3VkLm1haWwucnUnIGluIHJlc3VsdGFkb1snVVJMMyddOgoJCQkJbm9tZSA9IEFkZG9uVGl0bGUKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMMyddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd1cHRvc3RyZWFtLmNvbScgaW4gcmVzdWx0YWRvWydVUkwzJ106CgkJCQlub21lID0gJ1VwVG9TdHJlYW0nCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDMnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAncmFwaWR2aWRlby5jb20nIGluIHJlc3VsdGFkb1snVVJMMyddIG9yICdyYXB0dScgaW4gcmVzdWx0YWRvWydVUkwzJ106CgkJCQlub21lID0gJ1JhcHR1JwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwzJ10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3ZpZG96YS5uZXQnIGluIHJlc3VsdGFkb1snVVJMMyddOgoJCQkJbm9tZSA9ICdWaWRvemEnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDMnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAnc3RyZWFtYW5nby4nIGluIHJlc3VsdGFkb1snVVJMMyddOgoJCQkJbm9tZSA9ICdTdHJlYW1hbmdvJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwzJ10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ21peGRyb3AudG8nIGluIHJlc3VsdGFkb1snVVJMMyddLmxvd2VyKCk6CgkJCQlub21lID0gJ01peGRyb3AnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDMnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCWV4Y2VwdDoKCQlwYXNzCgl0cnk6CgkJaWYgcmVzdWx0YWRvWydVUkw0J10gIT0gJyc6CgkJCWkrPTEKCQkJaWYgJ29wZW5sb2FkJyBpbiByZXN1bHRhZG9bJ1VSTDQnXToKCQkJCW5vbWUgPSAiT3BlbkxvYWQiCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDQnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndmlkemknIGluIHJlc3VsdGFkb1snVVJMNCddOgoJCQkJbm9tZSA9ICdWaWR6aScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMNCddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdnb29nbGUnIGluIHJlc3VsdGFkb1snVVJMNCddIG9yICdjbG91ZC5tYWlsLnJ1JyBpbiByZXN1bHRhZG9bJ1VSTDQnXToKCQkJCW5vbWUgPSBBZGRvblRpdGxlCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDQnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndXB0b3N0cmVhbS5jb20nIGluIHJlc3VsdGFkb1snVVJMNCddOgoJCQkJbm9tZSA9ICdVcFRvU3RyZWFtJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkw0J10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3JhcGlkdmlkZW8uY29tJyBpbiByZXN1bHRhZG9bJ1VSTDQnXSBvciAncmFwdHUnIGluIHJlc3VsdGFkb1snVVJMNCddOgoJCQkJbm9tZSA9ICdSYXB0dScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMNCddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd2aWRvemEubmV0JyBpbiByZXN1bHRhZG9bJ1VSTDQnXToKCQkJCW5vbWUgPSAnVmlkb3phJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkw0J10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3N0cmVhbWFuZ28uJyBpbiByZXN1bHRhZG9bJ1VSTDQnXToKCQkJCW5vbWUgPSAnU3RyZWFtYW5nbycKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMNCddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdtaXhkcm9wLnRvJyBpbiByZXN1bHRhZG9bJ1VSTDQnXS5sb3dlcigpOgoJCQkJbm9tZSA9ICdNaXhkcm9wJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkw0J10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCglleGNlcHQ6CgkJcGFzcwoJdHJ5OgoJCWlmIHJlc3VsdGFkb1snVVJMNSddICE9ICcnOgoJCQlpKz0xCgkJCWlmICdvcGVubG9hZCcgaW4gcmVzdWx0YWRvWydVUkw1J106CgkJCQlub21lID0gIk9wZW5Mb2FkIgoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkw1J10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3ZpZHppJyBpbiByZXN1bHRhZG9bJ1VSTDUnXToKCQkJCW5vbWUgPSAnVmlkemknCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDUnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAnZ29vZ2xlJyBpbiByZXN1bHRhZG9bJ1VSTDUnXSBvciAnY2xvdWQubWFpbC5ydScgaW4gcmVzdWx0YWRvWydVUkw1J106CgkJCQlub21lID0gQWRkb25UaXRsZQoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkw1J10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3VwdG9zdHJlYW0uY29tJyBpbiByZXN1bHRhZG9bJ1VSTDUnXToKCQkJCW5vbWUgPSAnVXBUb1N0cmVhbScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMNSddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdyYXBpZHZpZGVvLmNvbScgaW4gcmVzdWx0YWRvWydVUkw1J10gb3IgJ3JhcHR1JyBpbiByZXN1bHRhZG9bJ1VSTDUnXToKCQkJCW5vbWUgPSAnUmFwdHUnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDUnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndmlkb3phLm5ldCcgaW4gcmVzdWx0YWRvWydVUkw1J106CgkJCQlub21lID0gJ1ZpZG96YScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMNSddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdzdHJlYW1hbmdvLicgaW4gcmVzdWx0YWRvWydVUkw1J106CgkJCQlub21lID0gJ1N0cmVhbWFuZ28nCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDUnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAnbWl4ZHJvcC50bycgaW4gcmVzdWx0YWRvWydVUkw1J10ubG93ZXIoKToKCQkJCW5vbWUgPSAnTWl4ZHJvcCcKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMNSddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJZXhjZXB0OgoJCXBhc3MKCXRyeToKCQlpZiByZXN1bHRhZG9bJ1VSTDYnXSAhPSAnJzoKCQkJaSs9MQoJCQlpZiAnb3BlbmxvYWQnIGluIHJlc3VsdGFkb1snVVJMNiddOgoJCQkJbm9tZSA9ICJPcGVuTG9hZCIKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMNiddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd2aWR6aScgaW4gcmVzdWx0YWRvWydVUkw2J106CgkJCQlub21lID0gJ1ZpZHppJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkw2J10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ2dvb2dsZScgaW4gcmVzdWx0YWRvWydVUkw2J10gb3IgJ2Nsb3VkLm1haWwucnUnIGluIHJlc3VsdGFkb1snVVJMNiddOgoJCQkJbm9tZSA9IEFkZG9uVGl0bGUKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMNiddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd1cHRvc3RyZWFtLmNvbScgaW4gcmVzdWx0YWRvWydVUkw2J106CgkJCQlub21lID0gJ1VwVG9TdHJlYW0nCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDYnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAncmFwaWR2aWRlby5jb20nIGluIHJlc3VsdGFkb1snVVJMNiddIG9yICdyYXB0dScgaW4gcmVzdWx0YWRvWydVUkw2J106CgkJCQlub21lID0gJ1JhcHR1JwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkw2J10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3ZpZG96YS5uZXQnIGluIHJlc3VsdGFkb1snVVJMNiddOgoJCQkJbm9tZSA9ICdWaWRvemEnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDYnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAnc3RyZWFtYW5nby4nIGluIHJlc3VsdGFkb1snVVJMNiddOgoJCQkJbm9tZSA9ICdTdHJlYW1hbmdvJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkw2J10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ21peGRyb3AudG8nIGluIHJlc3VsdGFkb1snVVJMNiddLmxvd2VyKCk6CgkJCQlub21lID0gJ01peGRyb3AnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDYnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCWV4Y2VwdDoKCQlwYXNzCgl0cnk6CgkJaWYgcmVzdWx0YWRvWydVUkw3J10gIT0gJyc6CgkJCWkrPTEKCQkJaWYgJ29wZW5sb2FkJyBpbiByZXN1bHRhZG9bJ1VSTDcnXToKCQkJCW5vbWUgPSAiT3BlbkxvYWQiCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDcnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndmlkemknIGluIHJlc3VsdGFkb1snVVJMNyddOgoJCQkJbm9tZSA9ICdWaWR6aScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMNyddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdnb29nbGUnIGluIHJlc3VsdGFkb1snVVJMNyddIG9yICdjbG91ZC5tYWlsLnJ1JyBpbiByZXN1bHRhZG9bJ1VSTDcnXToKCQkJCW5vbWUgPSBBZGRvblRpdGxlCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDcnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndXB0b3N0cmVhbS5jb20nIGluIHJlc3VsdGFkb1snVVJMNyddOgoJCQkJbm9tZSA9ICdVcFRvU3RyZWFtJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkw3J10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3JhcGlkdmlkZW8uY29tJyBpbiByZXN1bHRhZG9bJ1VSTDcnXSBvciAncmFwdHUnIGluIHJlc3VsdGFkb1snVVJMNyddOgoJCQkJbm9tZSA9ICdSYXB0dScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMNyddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd2aWRvemEubmV0JyBpbiByZXN1bHRhZG9bJ1VSTDcnXToKCQkJCW5vbWUgPSAnVmlkb3phJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkw3J10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3N0cmVhbWFuZ28uJyBpbiByZXN1bHRhZG9bJ1VSTDcnXToKCQkJCW5vbWUgPSAnU3RyZWFtYW5nbycKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMNyddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdtaXhkcm9wLnRvJyBpbiByZXN1bHRhZG9bJ1VSTDcnXS5sb3dlcigpOgoJCQkJbm9tZSA9ICdNaXhkcm9wJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkw3J10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCglleGNlcHQ6CgkJcGFzcwoJbGVnZW5kYSA9ICcnCglzdHJlYW0gPSAnJwoJaWYgJzovLycgaW4gcmVzdWx0YWRvWydsZWdlbmRhJ10gb3IgcmVzdWx0YWRvWydsZWdlbmRhJ10gPT0gJyc6CgkJbGVnZW5kYSA9IF9fQVBJX18rJ3N1YnMvJXMuc3J0JyAlIHJlc3VsdGFkb1snSU1CRCddCgllbGlmIHJlc3VsdGFkb1snbGVnZW5kYSddICE9ICcnOgoJCWlmIG5vdCAnLnNydCcgaW4gcmVzdWx0YWRvWydsZWdlbmRhJ106CgkJCXJlc3VsdGFkb1snbGVnZW5kYSddID0gcmVzdWx0YWRvWydsZWdlbmRhJ10rJy5zcnQnCgkJbGVnZW5kYSA9IF9fQVBJX18rJ3N1YnMvJXMnICUgcmVzdWx0YWRvWydsZWdlbmRhJ10KCXRyeToKCQlpZiByZXN1bHRhZG9bJ3NlbWxlZ2VuZGEnXSA9PSAxOgoJCQlsZWdlbmRhID0gJycKCWV4Y2VwdDoKCQlwYXNzCglleHRfZyA9ICdjb2lzbycKCWxlZ2VuZGFBdXggPSBsZWdlbmRhCglzZXJ2aWRvciA9IDAKCWlmIGxlbih0aXR1bG9zKSA+IDE6CgkJc2Vydmlkb3IgPSB4Ym1jZ3VpLkRpYWxvZygpLnNlbGVjdCgnRXNjb2xoYSBvIHNlcnZpZG9yJywgdGl0dWxvcykKCWVsc2U6CgkJc2Vydmlkb3IgPSAwCgkKCWlmICd2aWR6aScgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJCXZpZHppID0gVVJMUmVzb2x2ZXJNZWRpYS5WaWR6aShzZXJ2aWRvcmVzW3NlcnZpZG9yXSkKCQkJc3RyZWFtID0gdmlkemkuZ2V0TWVkaWFVcmwoKQoJCQlsZWdlbmRhID0gdmlkemkuZ2V0U3VidGl0bGUoKQoJZWxpZiAndXB0b3N0cmVhbS5jb20nIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXN0cmVhbSA9IFVSTFJlc29sdmVyTWVkaWEuVXBUb1N0cmVhbShzZXJ2aWRvcmVzW3NlcnZpZG9yXSkuZ2V0TWVkaWFVcmwoKQoJZWxpZiAnc2VydmVyLm1ycGlyYWN5LndpbicgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJc3RyZWFtID0gc2Vydmlkb3Jlc1tzZXJ2aWRvcl0KCWVsaWYgJ29wZW5sb2FkJyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQlzdHJlYW0gPSBVUkxSZXNvbHZlck1lZGlhLk9wZW5Mb2FkKHNlcnZpZG9yZXNbc2Vydmlkb3JdKS5nZXRNZWRpYVVybCgpCgkJbGVnZW5kYSA9IFVSTFJlc29sdmVyTWVkaWEuT3BlbkxvYWQoc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pLmdldFN1YnRpdGxlKCkKCQlpZiBub3QgJy52dHQnIGluIGxlZ2VuZGEgb3IgbGVnZW5kYSA9PSAnJzoKCQkJbGVnZW5kYSA9IGxlZ2VuZGFBdXgKCWVsaWYgJ2RyaXZlLmdvb2dsZS5jb20vJyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQlzdHJlYW0sIGV4dF9nID0gVVJMUmVzb2x2ZXJNZWRpYS5Hb29nbGVWaWRlbyhzZXJ2aWRvcmVzW3NlcnZpZG9yXSkuZ2V0TWVkaWFVcmwoKQoJZWxpZiAnY2xvdWQubWFpbC5ydScgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJc3RyZWFtLCBleHRfZyA9IFVSTFJlc29sdmVyTWVkaWEuQ2xvdWRNYWlsUnUoc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pLmdldE1lZGlhVXJsKCkKCWVsaWYgJ3JhcGlkdmlkZW8uY29tJyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXSBvciAncmFwdHUnIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXJhcGlkID0gVVJMUmVzb2x2ZXJNZWRpYS5SYXBpZFZpZGVvKHNlcnZpZG9yZXNbc2Vydmlkb3JdKQoJCXN0cmVhbSA9IHJhcGlkLmdldE1lZGlhVXJsKCkKCQlsZWdlbmRhID0gcmFwaWQuZ2V0TGVnZW5kYSgpCgllbGlmICd2aWRvemEubmV0JyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQl2aWRveiA9IFVSTFJlc29sdmVyTWVkaWEuVmlkb3phKHNlcnZpZG9yZXNbc2Vydmlkb3JdKQoJCXN0cmVhbSA9IHZpZG96LmdldE1lZGlhVXJsKCkKCQlsZWdlbmRhID0gdmlkb3ouZ2V0TGVnZW5kYSgpCgllbGlmICdzdHJlYW1hbmdvLicgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJc3RyZWFtYW4gPSBVUkxSZXNvbHZlck1lZGlhLlN0cmVhbWFuZ28oc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pCgkJc3RyZWFtID0gc3RyZWFtYW4uZ2V0TWVkaWFVcmwoKQoJCWxlZ2VuZGEgPSBzdHJlYW1hbi5nZXRMZWdlbmRhKCkKCWVsaWYgJ21peGRyb3AuJyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQltaXhkcm9wID0gVVJMUmVzb2x2ZXJNZWRpYS5NaXhkcm9wKHNlcnZpZG9yZXNbc2Vydmlkb3JdKQoJCXN0cmVhbSA9IG1peGRyb3AuZ2V0TWVkaWFVcmwoKQoJCWxlZ2VuZGEgPSBtaXhkcm9wLmdldExlZ2VuZGEoKQoJCglpZiBjb2lzbyA9PSAnZmlsbWUnOgoJCWxlZ2VuZGEgPSBsZWdlbmRhQXV4CgkJaWYgcmVzdWx0YWRvWydJTUJEJ10gbm90IGluIGxlZ2VuZGE6CgkJCWxlZ2VuZGEgPSBfX0FQSV9fKydzdWJzLyVzLnNydCcgJSByZXN1bHRhZG9bJ0lNQkQnXQoJCglpZiBsZWdlbmRhID09ICcnOgoJCWxlZ2VuZGEgPSBsZWdlbmRhQXV4CglyZXR1cm4gc3RyZWFtLCBsZWdlbmRhLCBleHRfZwoKCmRlZiBwZXNxdWlzYU1vdih1cmwpOgoJY29kaWdvX2ZvbnRlID0gJycKCWRhZG9zID0gJycKCXRhYmVsYSA9ICcnCglzdHJQZXNxdWlzYSA9ICcnCglmaWNoZWlybyA9ICcnCglzaXRlID0gJycKCXF1YWxpZGFkZSA9ICcnCglpZiAnZmlsbWVzJyBpbiB1cmw6CgkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdmaWxtZXNfcGVzcXVpc2EubGl2ZWl0JykKCQl0aXBvID0gMAoJCXF1YWxpZGFkZSA9IF9fUXVhbGlkYWRlX18KCWVsaWYgJ3NlcmllcycgaW4gdXJsOgoJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnc2VyaWVzX3Blc3F1aXNhLmxpdmVpdCcpCgkJdGlwbyA9IDEKCQlzaXRlID0gJ3NlcmllcycKCQlxdWFsaWRhZGUgPSAnMicKCWVsaWYgJ2FuaW1lcycgaW4gdXJsOgoJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnYW5pbWVzX3Blc3F1aXNhLmxpdmVpdCcpCgkJdGlwbyA9IDIKCQlzaXRlID0gJ2FuaW1lcycKCQlxdWFsaWRhZGUgPSAnMicKCWlmICdwYWdlJyBub3QgaW4gdXJsOgoJCXRyeToKCQkJdGlwbyA9IHhibWNndWkuRGlhbG9nKCkuc2VsZWN0KHUnT25kZSBxdWVyIHBlc3F1aXNhcj8nLCBbJ0ZpbG1lcycsICdTZXJpZXMnLCAnQW5pbWVzJ10pCgkJZXhjZXB0OgoJCQlyZXR1cm4gRmFsc2UKCQl0ZWNsYWRvID0geGJtYy5LZXlib2FyZCgnJywgJ08gcXVlIHF1ZXIgcGVzcXVpc2FyPycpCgkJaWYgdGlwbyA9PSAwOgoJCQl1cmwgPSBfX0FQSV9TSVRFX18rJ2ZpbG1lcy5waHA/YWN0aW9uPXBlc3F1aXNhJwoJCQlmaWNoZWlybyA9IG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ2ZpbG1lc19wZXNxdWlzYS5saXZlaXQnKQoJCQlxdWFsaWRhZGUgPSBfX1F1YWxpZGFkZV9fCgkJZWxpZiB0aXBvID09IDE6CgkJCXVybCA9IF9fQVBJX1NJVEVfXysnc2VyaWVzLnBocD9hY3Rpb249cGVzcXVpc2EnCgkJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnc2VyaWVzX3Blc3F1aXNhLmxpdmVpdCcpCgkJCXF1YWxpZGFkZSA9ICcyJwoJCQlzaXRlID0gJ3NlcmllcycKCQllbGlmIHRpcG8gPT0gMjoKCQkJdXJsID0gX19BUElfU0lURV9fKydhbmltZXMucGhwP2FjdGlvbj1wZXNxdWlzYScKCQkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdhbmltZXNfcGVzcXVpc2EubGl2ZWl0JykKCQkJcXVhbGlkYWRlID0gJzInCgkJCXNpdGUgPSAnYW5pbWVzJwoJCWlmIHhibWN2ZnMuZXhpc3RzKGZpY2hlaXJvKToKCQkJZiA9IG9wZW4oZmljaGVpcm8sICJyIikKCQkJdGV4dG8gPSBmLnJlYWQoKQoJCQlmLmNsb3NlKCkKCQkJdGVjbGFkby5zZXREZWZhdWx0KHRleHRvKQoJCXRlY2xhZG8uZG9Nb2RhbCgpCQoKCQlpZiB0ZWNsYWRvLmlzQ29uZmlybWVkKCk6CgkJCXN0clBlc3F1aXNhID0gdGVjbGFkby5nZXRUZXh0KCkKCQkJaWYgc3RyUGVzcXVpc2EgPT0gJyc6CgkJCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdJbnNpcmEgYWxnbyBuYSBwZXNxdWlzYS4nKQoJCQkJYWRkRGlyMignQWx0ZXJhciBQZXNxdWlzYScsIHVybCwgMTI0LCAnJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Blc3F1aXNhLnBuZycpLCAwKQoJCQkJcmV0dXJuIEZhbHNlCgkJCWRhZG9zID0gdXJsbGliLnVybGVuY29kZSh7J3RleHRvJzogc3RyUGVzcXVpc2EsICdxdWFsaWRhZGUnOiBxdWFsaWRhZGV9KQoJCQl0cnk6CgkJCQlmID0gb3BlbihmaWNoZWlybywgbW9kZT0idyIpCgkJCQlmLndyaXRlKHN0clBlc3F1aXNhKQoJCQkJZi5jbG9zZSgpCgkJCWV4Y2VwdDoKCQkJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ07Do28gZ3Jhdm91IG8gY29udGV1ZG8gZW0gJytmaWNoZWlybykKCQkJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCxwb3N0PWRhZG9zLCBoZWFkZXI9aGVhZGVycywgY29va2llPWdldENvb2tpZSgpKQoJZWxzZToKCQlpZiB4Ym1jdmZzLmV4aXN0cyhmaWNoZWlybyk6CgkJCWYgPSBvcGVuKGZpY2hlaXJvLCAiciIpCgkJCXRleHRvID0gZi5yZWFkKCkKCQkJZi5jbG9zZSgpCgkJZGFkb3MgPSB1cmxsaWIudXJsZW5jb2RlKHsndGV4dG8nOiB0ZXh0bywgJ3F1YWxpZGFkZSc6cXVhbGlkYWRlfSkKCQlyZXN1bHRhZG8gPSBhYnJpcl91cmwodXJsLHBvc3Q9ZGFkb3MsIGhlYWRlcj1oZWFkZXJzLCBjb29raWU9Z2V0Q29va2llKCkpCgkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJdHJ5OgoJCWlmIHJlc3VsdGFkb1snY29kaWdvJ10gPT0gMjA0OgoJCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdEZXZlIEluZGljYXIgdW0gdmFsb3IgcGFyYSBwZXNxdWlzYS4nKQoJCQlyZXR1cm4gRmFsc2UKCWV4Y2VwdDoKCQlyZXN1bHRhZG8gPSByZXN1bHRhZG8KCXZpc3RvcyA9IERhdGFiYXNlLnNlbGVjdEZpbG1lcygpCglvcGNhbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCdtYXJjYXJWaXN0bycpCgoJaWYgcmVzdWx0YWRvWydkYXRhJ10gIT0gJyc6CgkJaWYgdGlwbyA9PSAwOgoJCQlmb3IgaSBpbiByZXN1bHRhZG9bJ2RhdGEnXToKCQkJCXNldEZpbG1lKGksIHZpc3Rvcywgb3BjYW8pCgkJZWxpZiB0aXBvID09IDEgb3IgdGlwbyA9PSAyOgoJCQlmb3IgaSBpbiByZXN1bHRhZG9bJ2RhdGEnXToKCQkJCXNldFNlcmllcyhpLCB2aXN0b3MsIG9wY2FvLCBzaXRlKQoJCQoJCWN1cnJlbnQgPSByZXN1bHRhZG9bJ21ldGEnXVsnY3VycmVudCddCgkJdG90YWwgPSByZXN1bHRhZG9bJ21ldGEnXVsndG90YWwnXQoJCXRyeTogcHJveGltbyA9IHJlc3VsdGFkb1snbWV0YSddWydwYWdpbmFjYW8nXVsnbmV4dCddCgkJZXhjZXB0OiBwYXNzIAoJCWlmIGludChjdXJyZW50KSA8IGludCh0b3RhbCk6CgkJCWFkZERpcjIoJ1Byb3hpbWEgcGFnaW5hICgnK3N0cihjdXJyZW50KSsnLycrc3RyKHRvdGFsKSsnKScsIHByb3hpbW8sIDEyNCwgJ3Blc3F1aXNhJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Byb3hpbW8ucG5nJykpCgkJZWxzZToKCQkJeGJtY3BsdWdpbi5lbmRPZkRpcmVjdG9yeShpbnQoc3lzLmFyZ3ZbMV0pLGNhY2hlVG9EaXNjPUZhbHNlKQoJdmlzdGFfZmlsbWVzU2VyaWVzKCkKCmRlZiBwZXNxdWlzYShzZXJ2dXNzKToKCWNvZGlnb19mb250ZSA9ICcnCglkYWRvcyA9ICcnCgluZXQgPSBOZXQoKQoJI25ldC5zZXRfY29va2llcyhfX0NPT0tJRV9GSUxFX18pCgl0YWJlbGEgPSAnJwoJc3RyUGVzcXVpc2EgPSAnJwoJZmljaGVpcm8gPSAnJwoJdXJsID0gJycKCWlmICdwYWdlJyBub3QgaW4gdXJsOgoJCXVybCA9IF9fU0lURUJEX18rJ3NlYXJjaC5waHAnCgkJaWYgdGlwbyA9PSAzOgoJCQl0YWJlbGEgPSAnY2FuYWlzX2tvZGknCgkJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnY2FuYWlzLmxpdmVpdCcpCgkJZWxpZiB0aXBvID09IDQ6CgkJCXRhYmVsYSA9ICdwcmFpYXNfa29kaScKCQkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdwcmFpYXMubGl2ZWl0JykKCQllbGlmIHRpcG8gPT0gNToKCQkJdGFiZWxhID0gJ3JhZGlvc19rb2RpJwoJCQlmaWNoZWlybyA9IG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ3JhZGlvcy5saXZlaXQnKQoJCWVsc2U6CgkJCXRhYmVsYSA9ICdwcm9ncmFtYXNfa29kaScKCQkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdwcm9ncmFtYXMubGl2ZWl0JykKCQkKCQlpZiB4Ym1jdmZzLmV4aXN0cyhmaWNoZWlybyk6CgkJCWYgPSBvcGVuKGZpY2hlaXJvLCAiciIpCgkJCXRleHRvID0gZi5yZWFkKCkKCQkJZi5jbG9zZSgpCgkJCXRlY2xhZG8uc2V0RGVmYXVsdCh0ZXh0bykKCQl0ZWNsYWRvLmRvTW9kYWwoKQkKCgkJaWYgdGVjbGFkby5pc0NvbmZpcm1lZCgpOgoJCQlzdHJQZXNxdWlzYSA9IHRlY2xhZG8uZ2V0VGV4dCgpCgkJCWRhZG9zID0gdXJsbGliLnVybGVuY29kZSh7J3RleHRvJzogc3RyUGVzcXVpc2EsICdxdWFsaWRhZGUnOiBxdWFsaWRhZGV9KQoJCQl0cnk6CgkJCQlmID0gb3BlbihmaWNoZWlybywgbW9kZT0idyIpCgkJCQlmLndyaXRlKHN0clBlc3F1aXNhKQoJCQkJZi5jbG9zZSgpCgkJCWV4Y2VwdDoKCQkJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ07Do28gZ3Jhdm91IG8gY29udGV1ZG8gZW0gJytmaWNoZWlybykKCQkJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCxwb3N0PWRhZG9zLCBoZWFkZXI9aGVhZGVycywgY29va2llPWdldENvb2tpZSgpKQoJZWxzZToKCQlpZiB4Ym1jdmZzLmV4aXN0cyhmaWNoZWlybyk6CgkJCWYgPSBvcGVuKGZpY2hlaXJvLCAiciIpCgkJCXRleHRvID0gZi5yZWFkKCkKCQkJZi5jbG9zZSgpCgkJZGFkb3MgPSB1cmxsaWIudXJsZW5jb2RlKHsndGV4dG8nOiB0ZXh0bywgJ3F1YWxpZGFkZSc6cXVhbGlkYWRlfSkKCQlyZXN1bHRhZG8gPSBhYnJpcl91cmwodXJsLHBvc3Q9ZGFkb3MsIGhlYWRlcj1oZWFkZXJzLCBjb29raWU9Z2V0Q29va2llKCkpCgkKCWlmIHN0clBlc3F1aXNhICE9ICcnOgoJCWlmIHJlc3VsdGFkbyA9PSAnRE5TJzoKCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVGVtIGRlIGFsdGVyYXIgb3MgRE5TIHBhcmEgcG9kZXIgdXN1ZnJ1aXIgZG8gX19BRERPTl9fLicpCgkJCXJldHVybiBGYWxzZQoJCQoJCXhibWNwbHVnaW4uZW5kT2ZEaXJlY3RvcnkoaW50KHN5cy5hcmd2WzFdKSxjYWNoZVRvRGlzYz1GYWxzZSkKCQlkYWRvcyA9IHsnc2VhcmNoQm94Jzogc3RyUGVzcXVpc2EsICd0YWJlbGEnOiB0YWJlbGF9CgkJY29kaWdvX2ZvbnRlID0gbmV0Lmh0dHBfUE9TVCh1cmwsIGZvcm1fZGF0YT1kYWRvcywgaGVhZGVycz1fX0hFQURFUlNfXykuY29udGVudC5kZWNvZGUoJ2xhdGluLTEnKS5lbmNvZGUoInV0Zi04IikKCQlpbmZvcm1hID0gewoJCQkJJ3NlcnZpZG9yJyA6IHsKCQkJCQknbm9tZSc6ICcnLAoJCQkJCSdzZXJ2JzogJycKCQkJCX0sCgkJCQknc2Vydmlkb3Jlcyc6IFtdLAoJCQkJJ2NhbmFpcyc6IFtdCgkJCX0KCQlzdWNlc3NvID0gJ25vJwoJCWVsZW1zID0gRVQuZnJvbXN0cmluZyhjb2RpZ29fZm9udGUpCgkJCgkJZm9yIGNoaWxkZWUgaW4gZWxlbXM6CgkJCWlmKGNoaWxkZWUudGFnID09ICdzZXJ2aWRvcmVzJyk6CgkJCQlzZXJ2aWRvciA9IHsKCQkJCQknbm9tZSc6ICcnLAoJCQkJCSdsaW5rJzogJycKCQkJCX0KCQkJCWZvciBnZyBpbiBjaGlsZGVlOgkKCQkJCQlpZihnZy50YWcgPT0gJ05vbWUnKToKCQkJCQkJc2Vydmlkb3JbJ25vbWUnXSA9IGdnLnRleHQJCgkJCQkJZWxpZihnZy50YWcgPT0gJ1NlcnZpZG9yJyk6CgkJCQkJCXNlcnZpZG9yWydsaW5rJ10gPSBnZy50ZXh0CQkKCQkJCQlpbmZvcm1hWydzZXJ2aWRvcmVzJ10uYXBwZW5kKHNlcnZpZG9yKQoJCQkKCQlmb3Igc2VydnZ2diBpbiBpbmZvcm1hWydzZXJ2aWRvcmVzJ106CgkJCWlmKHNlcnZ2dnZbJ25vbWUnXSA9PSBzZXJ2dXNzKToKCQkJCWluZm9ybWFbJ3NlcnZpZG9yJ11bJ25vbWUnXSA9IHNlcnZ2dnZbJ25vbWUnXQoJCQkJaW5mb3JtYVsnc2Vydmlkb3InXVsnc2VydiddID0gc2VydnZ2dlsnbGluayddCQkJCgkJCgkJZm9yIGNoaWxkIGluIGVsZW1zOgoJCQlpZihjaGlsZC50YWcgPT0gJ3N1Y2Vzc28nKToKCQkJCXN1Y2Vzc28gPSBjaGlsZC50ZXh0CgkJCWVsaWYoY2hpbGQudGFnID09ICdjYW5haXMnKToKCQkJCWNhbmFsID0gewoJCQkJCSdub21lJzogJycsCgkJCQkJJ2xvZ28nOiAnJywKCQkJCQknbGluayc6ICcnLAoJCQkJCSdncnVwbyc6ICcnLAoJCQkJCSdub21laWQnOiAnJywKCQkJCQknaWRub3ZvJzogJycKCQkJCX0KCQkJCWFkaWNpb25hID0gVHJ1ZQoJCQkJcGFnYW50ZSA9IEZhbHNlCgkJCQlmb3IgZyBpbiBjaGlsZDoKCQkJCQlhZGljaW9uYSA9IFRydWUKCQkJCQlpZihnLnRhZyA9PSAnTm9tZScpOgoJCQkJCQljYW5hbFsnbm9tZSddID0gZy50ZXh0CgkJCQkJZWxpZihnLnRhZyA9PSAnSW1hZ2VtJyk6CgkJCQkJCWNhbmFsWydsb2dvJ10gPSBnLnRleHQKCQkJCQllbGlmKGcudGFnID09ICdQYWdhbnRlJyk6CgkJCQkJCWlmKGcudGV4dCA9PSAndHJ1ZScpOgoJCQkJCQkJcGFnYW50ZSA9IFRydWUKCQkJCQllbGlmKGcudGFnID09ICdVcmwnKToKCQkJCQkJdXJsY2hhbWEgPSBnLnRleHQuc3BsaXQoJzsnKQoJCQkJCQl1cmxub28gPSBnLnRleHQKCQkJCQkJdHJ5OgoJCQkJCQkJaWYoc2VydnVzcyA9PSAnU2Vydmlkb3IxJyk6CgkJCQkJCQkJdXJsbm9vID0gdXJsY2hhbWFbMF0KCQkJCQkJCWVsaWYoc2VydnVzcyA9PSAnU2Vydmlkb3IyJyk6CgkJCQkJCQkJdXJsbm9vID0gdXJsY2hhbWFbMV0KCQkJCQkJCWVsaWYoc2VydnVzcyA9PSAnU2Vydmlkb3IzJyk6CgkJCQkJCQkJdXJsbm9vID0gdXJsY2hhbWFbMl0KCQkJCQkJCWVsaWYoc2VydnVzcyA9PSAnU2Vydmlkb3I0Jyk6CgkJCQkJCQkJdXJsbm9vID0gdXJsY2hhbWFbM10KCQkJCQkJCWVsaWYoc2VydnVzcyA9PSAnU2Vydmlkb3I1Jyk6CgkJCQkJCQkJdXJsbm9vID0gdXJsY2hhbWFbNF0KCQkJCQkJCWVsaWYoc2VydnVzcyA9PSAnU2Vydmlkb3I2Jyk6CgkJCQkJCQkJdXJsbm9vID0gdXJsY2hhbWFbNV0KCQkJCQkJCWVsaWYoc2VydnVzcyA9PSAnU2Vydmlkb3I3Jyk6CgkJCQkJCQkJdXJsbm9vID0gdXJsY2hhbWFbNl0KCQkJCQkJCWVsaWYoc2VydnVzcyA9PSAnU2Vydmlkb3I4Jyk6CgkJCQkJCQkJdXJsbm9vID0gdXJsY2hhbWFbN10KCQkJCQkJCQoJCQkJCQkJaWYodXJsbm9vID09ICduYWRhJyk6CgkJCQkJCQkJYWRpY2lvbmEgPSBGYWxzZQoJCQkJCQkJZWxzZToKCQkJCQkJCQlpZiBwYWdhbnRlOgoJCQkJCQkJCQljYW5hbFsnbGluayddID0gaW5mb3JtYVsnc2Vydmlkb3InXVsnc2VydiddKydsaXZlL3V0aWxpemFkb3JsaXZlaXQvc2VuaGFsaXZlaXQvJyt1cmxub28KCQkJCQkJCQllbHNlOgoJCQkJCQkJCQljYW5hbFsnbGluayddID0gdXJsbm9vCgkJCQkJCWV4Y2VwdDoKCQkJCQkJCWNhbmFsWydsaW5rJ10gPSBnLnRleHQKCQkJCQllbGlmKGcudGFnID09ICdHcnVwbycpOgoJCQkJCQljYW5hbFsnZ3J1cG8nXSA9IGcudGV4dAoJCQkJCWVsaWYoZy50YWcgPT0gJ05vbWVJRCcpOgoJCQkJCQljYW5hbFsnbm9tZWlkJ10gPSBnLnRleHQKCQkJCQllbGlmKGcudGFnID09ICdJRCcpOgoJCQkJCQljYW5hbFsnaWRub3ZvJ10gPSBnLnRleHQKCQkJCWlmIGFkaWNpb25hOgoJCQkJCWluZm9ybWFbJ2NhbmFpcyddLmFwcGVuZChjYW5hbCkKCgkJaWYgc3VjZXNzbyA9PSAneWVzJzoKCQkJYWRkRGlyMignQWx0ZXJhciBQZXNxdWlzYScsIHNlcnZ1c3MsIDEyMCwgJycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdwZXNxdWlzYS5wbmcnKSwgMCkKCQkJZm9yIGNhbm4gaW4gaW5mb3JtYVsnY2FuYWlzJ106CgkJCQlub21lZSA9IGNhbm5bJ25vbWUnXQoJCQkJaW1nID0gY2FublsnbG9nbyddCgkJCQlydG1wID0gY2FublsnbGluayddLnJlcGxhY2UoJyBydG1wJywncnRtcCcpLnJlcGxhY2UoJyBydHNwJywncnRzcCcpLnJlcGxhY2UoJyBodHRwJywnaHR0cCcpLnJlcGxhY2UoJ3V0aWxpemFkb3JsaXZlaXQnLF9fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9uYW1lIikpLnJlcGxhY2UoJ3NlbmhhbGl2ZWl0JyxfX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fcGFzc3dvcmQiKSkKCQkJCWdydXAgPSBjYW5uWydncnVwbyddCgkJCQlpZF9pdCA9IGNhbm5bJ25vbWVpZCddCgkJCQlpZF9wID0gY2FublsnaWRub3ZvJ10KCQkJCXNydF9mID0gJycKCQkJCWRlc2NyaSA9ICcnCgkJCQkKCQkJCWFkZExpbmsyKG5vbWVlLHJ0bXAsJ2h0dHA6Ly9saXZlaXRrb2RpLmNvbS9Mb2dvcy8nK2ltZykKCQkJCgkJCXZpc3RhX0NhbmFpcygpCgllbHNlOgoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0luc2lyYSBhbGdvIG5hIHBlc3F1aXNhLicpCgkJYWRkRGlyMignQWx0ZXJhciBQZXNxdWlzYScsIHNlcnZ1c3MsIDEyMCwgJycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdwZXNxdWlzYS5wbmcnKSwgMCkKCmRlZiBkb3dubG9hZCh1cmwsbmFtZSwgdGVtcG9yYWRhLGVwaXNvZGlvLHNlcmllTm9tZSk6CgkjaGVhZGVyc1snQXV0aG9yaXphdGlvbiddID0gJ0JlYXJlciAlcycgJSBfX0FERE9OX18uZ2V0U2V0dGluZygndG9rZW5NcnBpcmFjeScpCglsaW5rcyA9IHVybC5zcGxpdCgnLycpCglpZiAnZmlsbWUnIGluIHVybDoKCQlpZF92aWRlbyA9IGxpbmtzWy0xXQoJCXRpcG8gPSAwCgllbGlmICdzZXJpZScgaW4gdXJsOgoJCWlkX3ZpZGVvID0gbGlua3NbNV0KCQl0ZW1wb3JhZGEgPSBsaW5rc1s3XQoJCWVwaXNvZGlvID0gbGlua3NbLTFdCgkJdGlwbyA9IDEKCWVsaWYgJ2FuaW1lJyBpbiB1cmw6CgkJaWRfdmlkZW8gPSBsaW5rc1s1XQoJCXRlbXBvcmFkYSA9IGxpbmtzWzddCgkJZXBpc29kaW8gPSBsaW5rc1stMV0KCQl0aXBvID0gMgoKCXJlc3VsdGFkbyA9IGFicmlyX3VybCh1cmwsIGhlYWRlcj1oZWFkZXJzKQoJaWYgcmVzdWx0YWRvID09ICdETlMnOgoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1RlbSBkZSBhbHRlcmFyIG9zIEROUyBwYXJhIHBvZGVyIHVzdWZydWlyIGRvIF9fQURET05fXy4nKQoJCXJldHVybiBGYWxzZQoJCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCglzdHJlYW0sIGxlZ2VuZGEsIGV4dF9nID0gZ2V0U3RyZWFtTGVnZW5kYShyZXN1bHRhZG8pCgoJZm9sZGVyID0geGJtYy50cmFuc2xhdGVQYXRoKF9fQURET05fXy5nZXRTZXR0aW5nKCdwYXN0YURvd25sb2FkcycpKQoJaWYoZm9sZGVyID09ICdFc2NvbGhhIGEgcGFzdGEgcGFyYSBEb3dubG9hZCcpOgoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1NlbGVjY2lvbmUgdW1hIHBhc3RhIHByaW1laXJvIG5vIHN1Ym1lbnUgQ3JlZMOqbmNpYWlzIG91IG5hcyBDb25maWd1cmHDp8O1ZXMgZG8gX19BRERPTl9fLicpCgllbHNlOgoJCWlmIHRpcG8gPiAwOgoJCQlpZiB0aXBvID09IDE6CgkJCQlyZXN1bHRhZG9hID0gYWJyaXJfdXJsKF9fQVBJX1NJVEVfXysnc2VyaWUvJytpZF92aWRlbywgaGVhZGVyPWhlYWRlcnMpCgkJCWVsaWYgdGlwbyA9PSAyOgoJCQkJcmVzdWx0YWRvYSA9IGFicmlyX3VybChfX0FQSV9TSVRFX18rJ2FuaW1lLycraWRfdmlkZW8sIGhlYWRlcj1oZWFkZXJzKQoJCQlyZXN1bHRhZG9hID0ganNvbi5sb2FkcyhyZXN1bHRhZG9hKQoJCQlpZiBub3QgeGJtY3Zmcy5leGlzdHMob3MucGF0aC5qb2luKGZvbGRlciwnc2VyaWVzJykpOgoJCQkJeGJtY3Zmcy5ta2RpcnMob3MucGF0aC5qb2luKGZvbGRlciwnc2VyaWVzJykpCgkJCWlmIG5vdCB4Ym1jdmZzLmV4aXN0cyhvcy5wYXRoLmpvaW4oZm9sZGVyLCdzZXJpZXMnLHJlc3VsdGFkb2FbJ25vbWVfaW5nbGVzJ10pKToKCQkJCXhibWN2ZnMubWtkaXJzKG9zLnBhdGguam9pbihmb2xkZXIsJ3NlcmllcycscmVzdWx0YWRvYVsnbm9tZV9pbmdsZXMnXSkpCgkJCWlmIG5vdCB4Ym1jdmZzLmV4aXN0cyhvcy5wYXRoLmpvaW4oZm9sZGVyLCdzZXJpZXMnLHJlc3VsdGFkb2FbJ25vbWVfaW5nbGVzJ10sIlRlbXBvcmFkYSAiK3N0cih0ZW1wb3JhZGEpKSk6CgkJCQl4Ym1jdmZzLm1rZGlycyhvcy5wYXRoLmpvaW4oZm9sZGVyLCdzZXJpZXMnLHJlc3VsdGFkb2FbJ25vbWVfaW5nbGVzJ10sIlRlbXBvcmFkYSAiK3N0cih0ZW1wb3JhZGEpKSkKCQkJZm9sZGVyID0gb3MucGF0aC5qb2luKGZvbGRlciwgJ3NlcmllcycsIHJlc3VsdGFkb2FbJ25vbWVfaW5nbGVzJ10sICJUZW1wb3JhZGEiLCBzdHIodGVtcG9yYWRhKSkKCQkJbmFtZSA9ICJlIitzdHIoZXBpc29kaW8pKyIgLSAiK2NsZWFuKHJlc3VsdGFkb1snbm9tZV9lcGlzb2RpbyddKQoJCWVsc2U6CgkJCWlmIG5vdCB4Ym1jdmZzLmV4aXN0cyhvcy5wYXRoLmpvaW4oZm9sZGVyLCdmaWxtZXMnKSk6CgkJCQl4Ym1jdmZzLm1rZGlycyhvcy5wYXRoLmpvaW4oZm9sZGVyLCdmaWxtZXMnKSkKCQkJZm9sZGVyID0gb3MucGF0aC5qb2luKGZvbGRlciwnZmlsbWVzJykKCQkJbmFtZSA9IHJlc3VsdGFkb1snbm9tZV9pbmdsZXMnXQoKCQlzdHJlYW1BdXggPSBjbGVhbihzdHJlYW0uc3BsaXQoJy8nKVstMV0pCgkJZXh0ZW5zYW9TdHJlYW0gPSBjbGVhbihzdHJlYW1BdXguc3BsaXQoJy4nKVstMV0pCgoJCWlmICc/bWltJyBpbiBleHRlbnNhb1N0cmVhbToKCQkJZXh0ZW5zYW9TdHJlYW0gPSByZS5jb21waWxlKCcoLis/KVw/bWltZT0nKS5maW5kYWxsKGV4dGVuc2FvU3RyZWFtKVswXQoKCQlpZiBleHRfZyAhPSAnY29pc28nOgoJCQlleHRlbnNhb1N0cmVhbSA9IGV4dF9nCgoJCW5vbWVTdHJlYW0gPSBuYW1lKycuJytleHRlbnNhb1N0cmVhbQoJCW5vbWVsZWdlbmRhID0gJycKCQlEb3dubG9hZGVyLkRvd25sb2FkZXIoKS5kb3dubG9hZChvcy5wYXRoLmpvaW4oZm9sZGVyLmRlY29kZSgidXRmLTgiKSwgbm9tZVN0cmVhbSksIHN0cmVhbSwgbmFtZSkKCQkKCQlpZiBsZWdlbmRhc09uOgoJCQlsZWdlbmRhQXV4ID0gY2xlYW4obGVnZW5kYS5zcGxpdCgnLycpWy0xXSkKCQkJZXh0ZW5zYW9MZWdlbmRhID0gY2xlYW4obGVnZW5kYUF1eC5zcGxpdCgnLicpWzFdKQoJCQlub21lTGVnZW5kYSA9IG5hbWUrJy4nK2V4dGVuc2FvTGVnZW5kYQoJCQlkb3dubG9hZF9sZWdlbmRhcyhsZWdlbmRhLCBvcy5wYXRoLmpvaW4oZm9sZGVyLCBub21lTGVnZW5kYSkpCgpkZWYgZG93bmxvYWRfbGVnZW5kYXModXJsLHBhdGgpOgoJY29udGVudHMgPSBhYnJpcl91cmwodXJsKQoJaWYgY29udGVudHM6CgkJZmggPSBvcGVuKHBhdGgsICd3JykKCQlmaC53cml0ZShjb250ZW50cykKCQlmaC5jbG9zZSgpCglyZXR1cm4KCmRlZiBjbGVhbih0ZXh0KToKCWNvbW1hbmQ9eycmIzgyMjA7JzonIicsJyYjODIyMTsnOiciJywgJyYjODIxMTsnOictJywnJmFtcDsnOicmJywnJiM4MjE3Oyc6IiciLCcmIzgyMTY7JzoiJyJ9CglyZWdleCA9IHJlLmNvbXBpbGUoInwiLmpvaW4obWFwKHJlLmVzY2FwZSwgY29tbWFuZC5rZXlzKCkpKSkKCXJldHVybiByZWdleC5zdWIobGFtYmRhIG1vOiBjb21tYW5kW21vLmdyb3VwKDApXSwgdGV4dCkKCmRlZiBhZGRWaWRlbyhuYW1lLHVybCxtb2RlLGljb25pbWFnZSx2aXN0byx0aXBvLHRlbXBvcmFkYSxlcGlzb2RpbyxpbmZvTGFiZWxzLHBvc3Rlcix0cmFpbGVyPUZhbHNlLHNlcmllTm9tZT1GYWxzZSk6CgltZW51ID0gW10KCQoJaWYgaW5mb0xhYmVsczogaW5mb0xhYmVsc0F1eCA9IGluZm9MYWJlbHMKCWVsc2U6IGluZm9MYWJlbHNBdXggPSB7J1RpdGxlJzogbmFtZX0KCglpZiBwb3N0ZXI6IHBvc3RlckF1eCA9IHBvc3RlcgoJZWxzZTogcG9zdGVyQXV4ID0gaWNvbmltYWdlCgkKCXRyeToKCQluYW1lID0gbmFtZS5lbmNvZGUoJ3V0Zi04JykKCWV4Y2VwdDoKCQluYW1lID0gbmFtZQoJCgl0cnk6CgkJc2VyaWVOb21lID0gc2VyaWVOb21lLmVuY29kZSgndXRmLTgnKQoJZXhjZXB0OgoJCXNlcmllTm9tZSA9IHNlcmllTm9tZQoJZWxzZToKCQlwYXNzCgoJZmFuYXJ0ID0gX19GQU5BUlRfXwoJCglpZiB0aXBvID09ICdmaWxtZSc6CgkJeGJtY3BsdWdpbi5zZXRDb250ZW50KGludChzeXMuYXJndlsxXSksICdNb3ZpZXMnKQoJCWlmIF9fQURET05fXy5nZXRTZXR0aW5nKCd0cmFpbGVyLWZpbG1lcycpID09ICd0cnVlJzoKCQkJdHJ5OgoJCQkJaWRZb3V0dWJlID0gdHJhaWxlci5zcGxpdCgnP3Y9JylbLTFdLnNwbGl0KCcvJylbLTFdLnNwbGl0KCc/JylbMF0uc3BsaXQoJyYnKVswXQoJCQkJbGlua1RyYWlsZXIgPSAncGx1Z2luOi8vcGx1Z2luLnZpZGVvLnlvdXR1YmUvcGxheS8/dmlkZW9faWQ9JytpZFlvdXR1YmUKCQkJCSNpZFlvdXR1YmU9dHJhaWxlci5zcGxpdCgnPScpCgkJCQkjX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnSUQ6ICcraWRZb3V0dWJlWzFdKQoJCQkJI2xpbmtUcmFpbGVyID0gJ3BsdWdpbjovL3BsdWdpbi52aWRlby55b3V0dWJlLz9wYXRoPS9yb290L3ZpZGVvJmFjdGlvbj1wbGF5X3ZpZGVvJnZpZGVvaWQ9JytpZFlvdXR1YmVbMV0KCQkJCSNsaW5rVHJhaWxlciA9IHRyYWlsZXIKCQkJZXhjZXB0OgoJCQkJbGlua1RyYWlsZXIgPSAnJwoJCWVsc2U6CgkJCWxpbmtUcmFpbGVyID0gJycKCWVsaWYgdGlwbyA9PSAnc2VyaWUnOgoJCXhibWNwbHVnaW4uc2V0Q29udGVudChpbnQoc3lzLmFyZ3ZbMV0pLCAndHZzaG93cycpCgkJaWRJTURiID0gcmUuY29tcGlsZSgnaW1kYj0oLis/KSYnKS5maW5kYWxsKHVybClbMF0KCQlsaW5rVHJhaWxlciA9ICIiCgllbGlmIHRpcG8gPT0gJ2VwaXNvZGlvJzoKCQl4Ym1jcGx1Z2luLnNldENvbnRlbnQoaW50KHN5cy5hcmd2WzFdKSwgJ2VwaXNvZGVzJykKCQlsaW5rVHJhaWxlciA9ICIiCgllbHNlOgoJCXhibWNwbHVnaW4uc2V0Q29udGVudChpbnQoc3lzLmFyZ3ZbMV0pLCAnTW92aWVzJykKCQlsaW5rVHJhaWxlciA9ICIiCgkKCW92ZXJsYXkgPSA2CglwbGF5Y291bnQgPSAwCgoJaW5mb0xhYmVsc0F1eFsib3ZlcmxheSJdID0gb3ZlcmxheQoJaW5mb0xhYmVsc0F1eFsicGxheWNvdW50Il0gPSBwbGF5Y291bnQKCQoJbGl6PXhibWNndWkuTGlzdEl0ZW0obmFtZSwgaWNvbkltYWdlPWljb25pbWFnZSwgdGh1bWJuYWlsSW1hZ2U9aWNvbmltYWdlKQoJbGl6LnNldEluZm8oIHR5cGU9IlZpZGVvIiwgaW5mb0xhYmVscz1pbmZvTGFiZWxzQXV4KQoJbGl6LnNldFByb3BlcnR5KCdmYW5hcnRfaW1hZ2UnLCBwb3N0ZXIpCglsaXouc2V0QXJ0KHsnZmFuYXJ0JzogcG9zdGVyfSkKCQoJCglpZiBub3Qgc2VyaWVOb21lOgoJCXNlcmllTm9tZSA9ICcnCgoJdT1zeXMuYXJndlswXSsiP3VybD0iK3VybGxpYi5xdW90ZV9wbHVzKHVybCkrIiZtb2RlPSIrc3RyKG1vZGUpKyImdGVtcG9yYWRhPSIrc3RyKHRlbXBvcmFkYSkrIiZlcGlzb2Rpbz0iK3N0cihlcGlzb2RpbykrIiZuYW1lPSIrdXJsbGliLnF1b3RlX3BsdXMobmFtZSkrIiZpY29uaW1hZ2U9Iit1cmxsaWIucXVvdGVfcGx1cyhpY29uaW1hZ2UpKyImc2VyaWVOb21lPSIrdXJsbGliLnF1b3RlX3BsdXMoc2VyaWVOb21lKQoJb2s9VHJ1ZQoJCglpZiBsaW5rVHJhaWxlciAhPSAiIjoKCQltZW51LmFwcGVuZCgoJ1ZlciBUcmFpbGVyJywgJ1hCTUMuUGxheU1lZGlhKCVzKScgJSAobGlua1RyYWlsZXIpKSkKCQkjbWVudS5hcHBlbmQoKCdWZXIgVHJhaWxlcicsICdYQk1DLlJ1blBsdWdpbiglcz9tb2RlPTEwNSZuYW1lPSVzJnVybD0lcyZpY29uaW1hZ2U9JXMpJyUoc3lzLmFyZ3ZbMF0sdXJsbGliLnF1b3RlX3BsdXMobmFtZSksIGxpbmtUcmFpbGVyLCB1cmxsaWIucXVvdGVfcGx1cyhpY29uaW1hZ2UpKSkpCgkKCW1lbnUuYXBwZW5kKCgnRG93bmxvYWQnLCAnWEJNQy5SdW5QbHVnaW4oJXM/bW9kZT0xMTcmbmFtZT0lcyZ1cmw9JXMmaWNvbmltYWdlPSVzJnNlcmllTm9tZT0lcyZ0ZW1wb3JhZGE9JXMmZXBpc29kaW89JXMpJyUoc3lzLmFyZ3ZbMF0sdXJsbGliLnF1b3RlX3BsdXMobmFtZSksIHVybGxpYi5xdW90ZV9wbHVzKHVybCksIHVybGxpYi5xdW90ZV9wbHVzKGljb25pbWFnZSksIHVybGxpYi5xdW90ZV9wbHVzKHNlcmllTm9tZSksIHN0cih0ZW1wb3JhZGEpLCBzdHIoZXBpc29kaW8pKSkpCglsaXouYWRkQ29udGV4dE1lbnVJdGVtcyhtZW51LCByZXBsYWNlSXRlbXM9VHJ1ZSkKCW9rPXhibWNwbHVnaW4uYWRkRGlyZWN0b3J5SXRlbShoYW5kbGU9aW50KHN5cy5hcmd2WzFdKSx1cmw9dSxsaXN0aXRlbT1saXosaXNGb2xkZXI9RmFsc2UpCglyZXR1cm4gb2sKCmRlZiBBZGREaXIobmFtZSwgdXJsLCBtb2RlLCBpY29uaW1hZ2U9JycsIGxvZ29zPScnLCBpbmRleD0tMSwgbW92ZT0wLCBpc0ZvbGRlcj1UcnVlLCBJc1BsYXlhYmxlPUZhbHNlLCBiYWNrZ3JvdW5kPU5vbmUsIGNhY2hlTWluPScwJywgaW5mbz0nJywgbWV0YWg9JycpOgoJdXJsUGFyYW1zID0geyduYW1lJzogbmFtZSwgJ3VybCc6IHVybCwgJ21vZGUnOiBtb2RlLCAnaWNvbmltYWdlJzogaWNvbmltYWdlLCAnbG9nb3MnOiBsb2dvcywgJ2NhY2hlJzogY2FjaGVNaW4sICdpbmZvJzogaW5mbywgJ2JhY2tncm91bmQnOiBiYWNrZ3JvdW5kLCAnbWV0YWgnOiBtZXRhaH0KCWxpeiA9IHhibWNndWkuTGlzdEl0ZW0obmFtZSwgaWNvbkltYWdlPWljb25pbWFnZSwgdGh1bWJuYWlsSW1hZ2U9aWNvbmltYWdlICkKCWlmIG1ldGFoOgoJCWxpei5zZXRJbmZvKHR5cGU9IlZpZGVvIiwgaW5mb0xhYmVscz1tZXRhaCkKCQlsaXouc2V0QXJ0KHsidGh1bWIiOiBtZXRhaFsnY292ZXJfdXJsJ10sICJwb3N0ZXIiOiBtZXRhaFsnY292ZXJfdXJsJ10sICJiYW5uZXIiOiBtZXRhaFsnY292ZXJfdXJsJ10sICJmYW5hcnQiOiBtZXRhaFsnYmFja2Ryb3BfdXJsJ10gfSkKCWVsc2U6CgkJbGl6LnNldEluZm8odHlwZT0iVmlkZW8iLCBpbmZvTGFiZWxzPXsgIlRpdGxlIjogbmFtZSwgIlBsb3QiOiBpbmZvIH0pCgkJI2xpei5zZXRQcm9wZXJ0eSgiRmFuYXJ0X0ltYWdlIiwgbG9nb3MpCgkJbGl6LnNldEFydCh7InBvc3RlciI6IGljb25pbWFnZSwgImJhbm5lciI6IGxvZ29zLCAiZmFuYXJ0IjogbG9nb3MgfSkKCSNsaXN0TW9kZSA9IDIxICMgTGlzdHMKCWlmIElzUGxheWFibGU6CgkJbGl6LnNldFByb3BlcnR5KCdJc1BsYXlhYmxlJywgJ3RydWUnKQoJaXRlbXMgPSBbXQoJaWYgbW9kZSA9PSAxIG9yIG1vZGUgPT0gMjoKCQlpdGVtcyA9IFtdCglpZiBtb2RlID09IDEwOgoJCXVybFBhcmFtc1snaW5kZXgnXSA9IGluZGV4CgkKCSN1PXN5cy5hcmd2WzBdKyI/dXJsPSIrdXJsbGliLnF1b3RlX3BsdXModXJsKSsiJm5hbWU9Iit1cmxsaWIucXVvdGVfcGx1cyhuYW1lKSsiJm1vZGU9IitpbnQobW9kZSkrIiZtb3ZlPSIraW50KG1vdmUpKyImaW5kZXg9IitpbnQoaW5kZXgpKyImaWNvbmltYWdlPSIrc3RyKGljb25pbWFnZSkrIiZsb2dvcz0iK3N0cihsb2dvcykrIiZjYWNoZT0iK3N0cihjYWNoZU1pbikrIiZpbmZvPSIrc3RyKGluZm8pKyImYmFja2dyb3VuZD0iK2JhY2tncm91bmQrIiZtZXRhaD0iK3N0cihtZXRhaCkKCSN1PXN5cy5hcmd2WzBdKyI/dXJsPSIrdXJsbGliLnF1b3RlX3BsdXModXJsKSsiJm1vZGU9IitzdHIobW9kZSkrIiZuYW1lPSIrdXJsbGliLnF1b3RlX3BsdXMobmFtZSkrIiZzZW5oYT0iK3N0cihzZW5oYSkrIiZlc3RpbG89Iit1cmxsaWIucXVvdGVfcGx1cyhlc3RpbG8pKyImdGlwb2xvZ2lhPSIrc3RyKHRpcG8pKyImdGlwb191c2VyPSIrc3RyKHRpcG9fdXNlcikrIiZzZXJ2aWRvcl91c2VyPSIrc3RyKHNlcnZpZG9yX3VzZXIpKyImZGF0YV91c2VyPSIrc3RyKGRhdGFfdXNlcikrIiZmYW5hcnQ9IitzdHIoZmFuYXJ0KQoJdSA9ICd7MH0/ezF9Jy5mb3JtYXQoc3lzLmFyZ3ZbMF0sIHVybGxpYi51cmxlbmNvZGUodXJsUGFyYW1zKSkKCW9rPXhibWNwbHVnaW4uYWRkRGlyZWN0b3J5SXRlbShoYW5kbGU9aW50KHN5cy5hcmd2WzFdKSx1cmw9dSwgbGlzdGl0ZW09bGl6LGlzRm9sZGVyPWlzRm9sZGVyKQoJcmV0dXJuIG9rCgpkZWYgR2V0S2V5Ym9hcmRUZXh0KHRpdGxlID0gIiIsIGRlZmF1bHRUZXh0ID0gIiIpOgoJa2V5Ym9hcmQgPSB4Ym1jLktleWJvYXJkKGRlZmF1bHRUZXh0LCB0aXRsZSkKCWtleWJvYXJkLmRvTW9kYWwoKQoJdGV4dCA9ICIiIGlmIG5vdCBrZXlib2FyZC5pc0NvbmZpcm1lZCgpIGVsc2Uga2V5Ym9hcmQuZ2V0VGV4dCgpCglyZXR1cm4gdGV4dAoKZGVmIFJlZnJlc2goKToKCXhibWMuZXhlY3V0ZWJ1aWx0aW4oIlhCTUMuQ29udGFpbmVyLlJlZnJlc2goKSIpCgpkZWYgUGxheVVybChuYW1lLCB1cmwsIGljb25pbWFnZT1Ob25lLCBpbmZvPScnLCBzdWI9JycsIG1ldGFoPScnKToKCWlmICI7OzsiIGluIGJhY2tncm91bmQ6CgkJYiA9IGJhY2tncm91bmQuc3BsaXQoIjs7OyIpCgl1cmwgPSByZS5zdWIoJ1wubXA0JCcsICcubXA0P3BsYXknLCB1cmwpCgl1cmwgPSBjb21tb24uZ2V0RmluYWxVcmwodXJsKQoJI3hibWMubG9nKCctLS0gUGxheWluZyAiezB9Ii4gezF9Jy5mb3JtYXQobmFtZSwgdXJsKSwgMikKCWxpc3RpdGVtID0geGJtY2d1aS5MaXN0SXRlbShwYXRoPXVybCkKCWlmIG1ldGFoOgoJCWxpc3RpdGVtLnNldEluZm8odHlwZT0iVmlkZW8iLCBpbmZvTGFiZWxzPW1ldGFoKQoJZWxzZToKCQlsaXN0aXRlbS5zZXRJbmZvKHR5cGU9IlZpZGVvIiwgaW5mb0xhYmVscz17Im1lZGlhdHlwZSI6ICJ2aWRlbyIsICJUaXRsZSI6IG5hbWUsICJQbG90IjogaW5mbyB9KQoJaWYgc3ViIT0nJzoKCQlsaXN0aXRlbS5zZXRTdWJ0aXRsZXMoWydzcGVjaWFsOi8vdGVtcC9leGFtcGxlLnNydCcsIHN1YiBdKQoJaWYgaWNvbmltYWdlIGlzIG5vdCBOb25lOgoJCXRyeToKCQkJbGlzdGl0ZW0uc2V0QXJ0KHsndGh1bWInIDogaWNvbmltYWdlfSkKCQlleGNlcHQ6CgkJCWxpc3RpdGVtLnNldFRodW1ibmFpbEltYWdlKGljb25pbWFnZSkKCXhibWNwbHVnaW4uc2V0UmVzb2x2ZWRVcmwoaW50KHN5cy5hcmd2WzFdKSwgVHJ1ZSwgbGlzdGl0ZW0pCiMgLS0tLS0tLS0tLS0tLS0gIEZJTSBORVRDSU5FCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMJCQkJCQkJCUZVTkNPRVMgSkEgRkVJVEFTCQkJCQkJCQkgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwpkZWYgYWRkRGlyKG5hbWUsdXJsLG1vZGUsZXN0aWxvLGljb25pbWFnZSx0aXBvLGZhbmFydCxwYXN0YT1UcnVlLHRvdGFsPTEpOgoJdHJ5OgoJCW5hbWUgPSBuYW1lLmVuY29kZSgndXRmLTgnKQoJZXhjZXB0OgoJCW5hbWUgPSBuYW1lCglpZih0aXBvID09ICdsaW1wYXJjYWNoZScgYW5kIHRpcG8gPT0gJ2xpbXBhcnR1ZG8nKToJCQkJCgkJdT1zeXMuYXJndlswXSsiP3VybD0iK3VybGxpYi5xdW90ZV9wbHVzKHVybCkrIiZtb2RlPSIrc3RyKG1vZGUpCgllbHNlOgoJCXU9c3lzLmFyZ3ZbMF0rIj91cmw9Iit1cmxsaWIucXVvdGVfcGx1cyh1cmwpKyImbW9kZT0iK3N0cihtb2RlKSsiJm5hbWU9Iit1cmxsaWIucXVvdGVfcGx1cyhuYW1lKSsiJmVzdGlsbz0iK3VybGxpYi5xdW90ZV9wbHVzKGVzdGlsbykrIiZmYW5hcnQ9IitzdHIoZmFuYXJ0KQoJb2s9VHJ1ZQoJbGl6PXhibWNndWkuTGlzdEl0ZW0obmFtZSwgaWNvbkltYWdlPWljb25pbWFnZSwgdGh1bWJuYWlsSW1hZ2U9aWNvbmltYWdlKQoJbGl6LnNldFByb3BlcnR5KCdmYW5hcnRfaW1hZ2UnLCBmYW5hcnQpCglsaXouc2V0QXJ0KHsnZmFuYXJ0JzogZmFuYXJ0fSkKCW9rPXhibWNwbHVnaW4uYWRkRGlyZWN0b3J5SXRlbShoYW5kbGU9aW50KHN5cy5hcmd2WzFdKSx1cmw9dSxsaXN0aXRlbT1saXosaXNGb2xkZXI9cGFzdGEsdG90YWxJdGVtcz10b3RhbCkKCXJldHVybiBvawoKZGVmIGFkZERpcjIobmFtZSx1cmwsbW9kZSxtb2RlMixpY29uaW1hZ2UscGFnaW5hPTEsdGlwbz1Ob25lLGluZm9MYWJlbHM9Tm9uZSxwb3N0ZXI9Tm9uZSx2aXN0bz1GYWxzZSk6CglpZiBpbmZvTGFiZWxzOiBpbmZvTGFiZWxzQXV4ID0gaW5mb0xhYmVscwoJZWxzZTogaW5mb0xhYmVsc0F1eCA9IHsnVGl0bGUnOiBuYW1lfQoJZmFuYXJ0ID0gJycKCWlmIHBvc3RlcjogZmFuYXJ0ID0gcG9zdGVyCgllbHNlOiBmYW5hcnQgPSBpY29uaW1hZ2UKCQoJdHJ5OgoJCW5hbWUgPSBuYW1lLmVuY29kZSgndXRmLTgnKQoJZXhjZXB0OgoJCW5hbWUgPSBuYW1lCgoJdT1zeXMuYXJndlswXSsiP3VybD0iK3VybGxpYi5xdW90ZV9wbHVzKHVybCkrIiZtb2RvPSIrbW9kZTIrIiZtb2RlPSIrc3RyKG1vZGUpKyImbmFtZT0iK3VybGxpYi5xdW90ZV9wbHVzKG5hbWUpCgkKCW9rPVRydWUKCgkjZmFuYXJ0ID0gX19GQU5BUlRfXwoKCWlmIHRpcG8gPT0gJ2ZpbG1lJzoKCQkjZmFuYXJ0ID0gcG9zdGVyQXV4CgkJeGJtY3BsdWdpbi5zZXRDb250ZW50KGludChzeXMuYXJndlsxXSksICdNb3ZpZXMnKQoJZWxpZiB0aXBvID09ICdzZXJpZSc6CgkJI2ZhbmFydCA9IHBvc3RlckF1eAoJCXhibWNwbHVnaW4uc2V0Q29udGVudChpbnQoc3lzLmFyZ3ZbMV0pLCAndHZzaG93cycpCgllbGlmIHRpcG8gPT0gJ2VwaXNvZGlvJzoKCQkjZmFuYXJ0ID0gcG9zdGVyQXV4CgkJeGJtY3BsdWdpbi5zZXRDb250ZW50KGludChzeXMuYXJndlsxXSksICdlcGlzb2RlcycpCgllbHNlOgoJCWlmIG5hbWUgIT0gJ1JlZnJlc2gnOgoJCQl4Ym1jcGx1Z2luLnNldENvbnRlbnQoaW50KHN5cy5hcmd2WzFdKSwgJ01vdmllcycpCgkKCW92ZXJsYXkgPSA2CglwbGF5Y291bnQgPSAwCgkKCWluZm9MYWJlbHNBdXhbIm92ZXJsYXkiXSA9IG92ZXJsYXkKCWluZm9MYWJlbHNBdXhbInBsYXljb3VudCJdID0gcGxheWNvdW50CgkKCWxpej14Ym1jZ3VpLkxpc3RJdGVtKG5hbWUsIGljb25JbWFnZT1pY29uaW1hZ2UsIHRodW1ibmFpbEltYWdlPWljb25pbWFnZSkKCWxpei5zZXRQcm9wZXJ0eSgnZmFuYXJ0X2ltYWdlJywgZmFuYXJ0KQoJbGl6LnNldEFydCh7J2ZhbmFydCc6IGZhbmFydH0pCglsaXouc2V0SW5mbyggdHlwZT0iVmlkZW8iLCBpbmZvTGFiZWxzPWluZm9MYWJlbHNBdXggKQoKCW9rPXhibWNwbHVnaW4uYWRkRGlyZWN0b3J5SXRlbShoYW5kbGU9aW50KHN5cy5hcmd2WzFdKSx1cmw9dSxsaXN0aXRlbT1saXosaXNGb2xkZXI9VHJ1ZSkKCXJldHVybiBvawoKZGVmIGFkZExpbmtDYW5hbChuYW1lLHVybCxpY29uaW1hZ2UsaWRjYW5hbCxpZF9wKToKCWluZm9MYWJlbHNzc3MgPSB7InRpdGxlIjogbmFtZSwgImdlbnJlIjogJ0FsbCd9Cglvaz1UcnVlCgljbT1bXQoJCglpZihpZGNhbmFsICE9ICcwMDAxJyk6CgkJY20uYXBwZW5kKCgnVmVyIHByb2dyYW1hw6fDo28nLCAnWEJNQy5SdW5QbHVnaW4oJXM/bW9kZT0zMSZuYW1lPSVzJnVybD0lcyZpY29uaW1hZ2U9JXMmaWRDYW5hbD0lcyZpZGZmQ2FuYWw9JXMpJyUoc3lzLmFyZ3ZbMF0sdXJsbGliLnF1b3RlX3BsdXMobmFtZSksIHVybGxpYi5xdW90ZV9wbHVzKHVybCksIHVybGxpYi5xdW90ZV9wbHVzKGljb25pbWFnZSksIGlkQ2FuYWwsIGlkX3ApKSkKCQoJbGl6ID0geGJtY2d1aS5MaXN0SXRlbShuYW1lLCBpY29uSW1hZ2U9aWNvbmltYWdlLCB0aHVtYm5haWxJbWFnZT1pY29uaW1hZ2UpCglsaXouc2V0SW5mbyggdHlwZT0iVmlkZW8iLCBpbmZvTGFiZWxzPWluZm9MYWJlbHNzc3MpCglsaXouYWRkQ29udGV4dE1lbnVJdGVtcyhjbSwgcmVwbGFjZUl0ZW1zPUZhbHNlKQoJbGl6LnNldFByb3BlcnR5KCdJc1BsYXlhYmxlJywgJ3RydWUnKQoJbGl6LnNldFByb3BlcnR5KCdmYW5hcnRfaW1hZ2UnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fdHYucG5nJykpCglsaXouc2V0QXJ0KHsnZmFuYXJ0Jzogb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3R2LnBuZycpfSkKCXUgPSBzeXMuYXJndlswXSArICI/dXJsPSIgKyB1cmxsaWIucXVvdGVfcGx1cyh1cmwpICsgIiZtb2RlPTExJm5hbWU9IiArIHVybGxpYi5xdW90ZV9wbHVzKG5hbWUpICsgIiZpY29uaW1hZ2U9IiArIHVybGxpYi5xdW90ZV9wbHVzKGljb25pbWFnZSkrIiZzdHJlYW1faWQ9IitzdHIoaWRjYW5hbCkKCW9rPXhibWNwbHVnaW4uYWRkRGlyZWN0b3J5SXRlbShoYW5kbGU9aW50KHN5cy5hcmd2WzFdKSwgdXJsPXUsIGxpc3RpdGVtPWxpeikKCXJldHVybiBvawoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMJCQkJCQkJCQkJCQkJRVBHCQkJCQkJCQkJCQkJCSAjCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwpkZWYgb2J0ZXJfZmljaGVpcm9fZXBnKCk6CglfX0VQR19fID0gX19BRERPTl9fLmdldFNldHRpbmcoImxpc3RhX2VwZyIpCglpZiBub3QgeGJtY3Zmcy5leGlzdHMoX19GT0xERVJfRVBHX18pOgoJCXhibWN2ZnMubWtkaXJzKF9fRk9MREVSX0VQR19fKQoKCXVuY29tcHJlc3NlZF9wYXRoID0gb3MucGF0aC5qb2luKF9fRk9MREVSX0VQR19fLCAnZXBnLnhtbCcpCgl1cmwgPSB1cmxsaWIudXJsb3BlbihfX0VQR19fKQoJY29kaWdvID0gdXJsLnJlYWQoKQoJdXJsLmNsb3NlCgkKCW9wZW4odW5jb21wcmVzc2VkX3BhdGgsICd3Jykud3JpdGUoY29kaWdvKQoKZGVmIGdldFByb2dyYW1hY2FvRGlhcmlhKGlkQ2FuYWwsIGRpYWhvcmEsIGNvZGlnbyk6Cglzb3VyY2UgPSByZS5jb21waWxlKCc8cHJvZ3JhbW1lIHN0YXJ0PSIoLis/KSBcKzAxMDAiIHN0b3A9IiguKz8pIFwrMDEwMCIgY2hhbm5lbD0iJytpZENhbmFsKyciPlxzKzx0aXRsZSBsYW5nPSJwdCI+KC4rPyk8XC90aXRsZT4nKS5maW5kYWxsKGNvZGlnbykKCglwcm9ncmFtYSA9ICcnCgoJZm9yIHN0YXJ0LCBzdG9wLCBwcm9ncmFtYTEgIGluIHNvdXJjZToKCgkJaWYoaW50KHN0YXJ0KSA8IGRpYWhvcmEgYW5kIGludChzdG9wKSA+IGRpYWhvcmEpOgoJCQlwcm9ncmFtYSA9IHByb2dyYW1hMQoJcmV0dXJuIHByb2dyYW1hCgoKZGVmIHByb2dyYW1hY2FvX2NhbmFsKGlkQ2FuYWwpOgoJX19FUEdfXyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJsaXN0YV9lcGciKQoJdXJsID0gdXJsbGliLnVybG9wZW4oX19FUEdfXykKCWNvZGlnbyA9IHVybC5yZWFkKCkKCXVybC5jbG9zZQoJCgl0cyA9IHRpbWUudGltZSgpCglzdCA9IGludChkYXRldGltZS5kYXRldGltZS5mcm9tdGltZXN0YW1wKHRzKS5zdHJmdGltZSgnJVklbSVkJykpCgoJZGlhaG9yYSA9IGludChzdHIoc3QpKycwNjAwMDAnKQoJZGlhYW1hbmhhID0gaW50KHN0cihzdCsxKSsnMDYwMDAwJykKCglzb3VyY2UgPSByZS5jb21waWxlKCc8cHJvZ3JhbW1lIHN0YXJ0PSIoLis/KSBcKzAxMDAiIHN0b3A9IiguKz8pIFwrMDEwMCIgY2hhbm5lbD0iJytpZENhbmFsKyciPlxzKzx0aXRsZSBsYW5nPSJwdCI+KC4rPyk8XC90aXRsZT4nKS5maW5kYWxsKGNvZGlnbykKCglwcm9ncmFtYSA9ICcnCgoJdGl0bGVzPVsnW0JdW0NPTE9SIHdoaXRlXVByb2dyYW1hw6fDo286Wy9DT0xPUl1bL0JdJ10KCgkKCWZvciBzdGFydCwgc3RvcCwgcHJvZ3JhbWExIGluIHNvdXJjZToKCgkJc3RhcnQxID0gcmUuY29tcGlsZSgnKFswLTldezR9WzAtMV1bMC05XVswLTNdWzAtOV0pKFswLTldezJ9KShbMC05XXsyfSkoWzAtOV17Mn0pJykuZmluZGFsbChzdGFydCkKCQlzdG9wMSA9IHJlLmNvbXBpbGUoJyhbMC05XXs0fVswLTFdWzAtOV1bMC0zXVswLTldKShbMC05XXsyfSkoWzAtOV17Mn0pKFswLTldezJ9KScpLmZpbmRhbGwoc3RvcCkKCgkJaWYoaW50KHN0YXJ0KSA+IGRpYWhvcmEgYW5kIGludChzdGFydCkgPCBkaWFhbWFuaGEgKToKCQkJdGl0bGVzLmFwcGVuZCgnXG5bQl0lczolcyAtPiAlczolc1svQl0gLSAlcycgJSAoc3RhcnQxWzBdWzFdLCBzdGFydDFbMF1bMl0sIHN0b3AxWzBdWzFdLCBzdG9wMVswXVsyXSwgcHJvZ3JhbWExKSkKCgoJcHJvZ3JhbWFjYW8gPSAnXG4nLmpvaW4odGl0bGVzKQoJdHJ5OgoJCXhibWMuZXhlY3V0ZWJ1aWx0aW4oIkFjdGl2YXRlV2luZG93KDEwMTQ3KSIpCgkJd2luZG93ID0geGJtY2d1aS5XaW5kb3coMTAxNDcpCgkJeGJtYy5zbGVlcCgxMDApCgkJd2luZG93LmdldENvbnRyb2woMSkuc2V0TGFiZWwoQWRkb25UaXRsZSkKCQl3aW5kb3cuZ2V0Q29udHJvbCg1KS5zZXRUZXh0KHByb2dyYW1hY2FvKQoJZXhjZXB0OgoJCXBhc3MKCmRlZiBhYnJpcl91cmwodXJsLCBwb3N0PU5vbmUsIGhlYWRlcj1Ob25lLCBjb2RlPUZhbHNlLCBlcnJvPUZhbHNlLCBjb29raWU9Tm9uZSk6CglpZiBoZWFkZXIgPT0gTm9uZToKCQloZWFkZXIgPSBoZWFkZXJzCglpZiBjb29raWU6CgkJaGVhZGVyWydDb29raWUnXSA9IGNvb2tpZQoJCglpZiBwb3N0OgoJCWhlYWRlclsnQ29udGVudC1UeXBlJ10gPSdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnCgkJcmVxID0gdXJsbGliMi5SZXF1ZXN0KHVybCwgZGF0YT1wb3N0LCBoZWFkZXJzPWhlYWRlcikKCWVsc2U6CgkJcmVxID0gdXJsbGliMi5SZXF1ZXN0KHVybCwgaGVhZGVycz1oZWFkZXIpCgl0cnk6CgkJcmVzcG9uc2UgPSB1cmxsaWIyLnVybG9wZW4ocmVxLGNvbnRleHQ9Y29udGV4dCkKCWV4Y2VwdDoKCQl0cnk6CgkJCXJlc3BvbnNlID0gdXJsbGliMi51cmxvcGVuKHJlcSkKCQlleGNlcHQgdXJsbGliMi5IVFRQRXJyb3IgYXMgcmVzcG9uc2U6CgkJCWlmIGVycm8gPT0gVHJ1ZToKCQkJCXJldHVybiBzdHIocmVzcG9uc2UuY29kZSksICJhc2QiCglsaW5rPXJlc3BvbnNlLnJlYWQoKQoJCglpZiAnanVkaWNpYWwgYmxibGJsYmxibCcgaW4gbGluazoKCQlyZXR1cm4gJ0ROUycKCWlmIGNvZGU6CgkJcmV0dXJuIHN0cihyZXNwb25zZS5jb2RlKSwgbGluawoKCXJlc3BvbnNlLmNsb3NlKCkKCXJldHVybiBsaW5rCgpkZWYgYWRkTGluazIobmFtZSx1cmwsaWNvbmltYWdlKToKCW9rPVRydWUKCWxpeiA9IHhibWNndWkuTGlzdEl0ZW0obmFtZSwgaWNvbkltYWdlPWljb25pbWFnZSwgdGh1bWJuYWlsSW1hZ2U9aWNvbmltYWdlKQoJbGl6LnNldFByb3BlcnR5KCdmYW5hcnRfaW1hZ2UnLCBpY29uaW1hZ2UpCglsaXouc2V0QXJ0KHsnZmFuYXJ0JzogaWNvbmltYWdlfSkKCWxpei5zZXRJbmZvKCB0eXBlPSJWaWRlbyIsIGluZm9MYWJlbHM9eyAiVGl0bGUiOiBuYW1lIH0pCglsaXouc2V0UHJvcGVydHkoJ0lzUGxheWFibGUnLCAndHJ1ZScpCgl1ID0gc3lzLmFyZ3ZbMF0gKyAiP3VybD0iICsgdXJsICsgIiZtb2RlPTEwNiZuYW1lPSIgKyBuYW1lICsgIiZpY29uaW1hZ2U9IiArIGljb25pbWFnZQoJb2s9eGJtY3BsdWdpbi5hZGREaXJlY3RvcnlJdGVtKGhhbmRsZT1pbnQoc3lzLmFyZ3ZbMV0pLCB1cmw9dSwgbGlzdGl0ZW09bGl6KQoJcmV0dXJuIG9rCgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwkJCQkJCQkgIERFRklOSU5DT0VTCQkJCQkJCQkJCSAgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwkKCmRlZiB2aXN0YV9HcnVwb3MoKToKCW9wY2FvID0gX19BRERPTl9fLmdldFNldHRpbmcoJ2NhbmFpc1ZpZXcnKQoJaWYgb3BjYW8gPT0gJzAnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTApIikKCWVsaWYgb3BjYW8gPT0gJzEnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTEpIikKCWVsaWYgb3BjYW8gPT0gJzInOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTAwKSIpCgllbGlmIG9wY2FvID09ICczJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwOSkiKQoJZWxpZiBvcGNhbyA9PSAnMyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDgpIikKCWVsaWYgb3BjYW8gPT0gJzQnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA0KSIpCgllbGlmIG9wY2FvID09ICc1JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwMykiKQoJZWxpZiBvcGNhbyA9PSAnNic6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MTUpIikKCWVsaWYgb3BjYW8gPT0gJzcnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTUpIikKCmRlZiB2aXN0YV9DYW5haXMoKToKCW9wY2FvID0gX19BRERPTl9fLmdldFNldHRpbmcoJ2NhbmFpc1ZpZXcyJykKCWlmIG9wY2FvID09ICcwJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwKSIpCgllbGlmIG9wY2FvID09ICcxJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUxKSIpCgllbGlmIG9wY2FvID09ICcyJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwMCkiKQoJZWxpZiBvcGNhbyA9PSAnMyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDkpIikKCWVsaWYgb3BjYW8gPT0gJzMnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA4KSIpCgllbGlmIG9wY2FvID09ICc0JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwNCkiKQoJZWxpZiBvcGNhbyA9PSAnNSc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDMpIikKCWVsaWYgb3BjYW8gPT0gJzYnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTE1KSIpCgllbGlmIG9wY2FvID09ICc3JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDU1KSIpCgpkZWYgdmlzdGFfbWVudSgpOgoJb3BjYW8gPSBfX0FERE9OX18uZ2V0U2V0dGluZygnbWVudVZpZXcnKQoJaWYgb3BjYW8gPT0gJzAnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTApIikKCWVsaWYgb3BjYW8gPT0gJzEnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTEpIikKCWVsaWYgb3BjYW8gPT0gJzInOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTAwKSIpCgllbGlmIG9wY2FvID09ICczJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwOSkiKQoJZWxpZiBvcGNhbyA9PSAnMyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDgpIikKCWVsaWYgb3BjYW8gPT0gJzQnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA0KSIpCgllbGlmIG9wY2FvID09ICc1JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwMykiKQoJZWxpZiBvcGNhbyA9PSAnNic6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MTUpIikKCWVsaWYgb3BjYW8gPT0gJzcnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTUpIikKCmRlZiB2aXN0YV9maWxtZXNTZXJpZXMoKToKCW9wY2FvID0gX19BRERPTl9fLmdldFNldHRpbmcoJ2ZpbG1lc1Nlcmllc1ZpZXcnKQoJaWYgb3BjYW8gPT0gJzAnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTApIikKCWVsaWYgb3BjYW8gPT0gJzEnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTEpIikKCWVsaWYgb3BjYW8gPT0gJzInOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTAwKSIpCgllbGlmIG9wY2FvID09ICczJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwOSkiKQoJZWxpZiBvcGNhbyA9PSAnMyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDgpIikKCWVsaWYgb3BjYW8gPT0gJzQnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA0KSIpCgllbGlmIG9wY2FvID09ICc1JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwMykiKQoJZWxpZiBvcGNhbyA9PSAnNic6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MTUpIikKCWVsaWYgb3BjYW8gPT0gJzcnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTUpIikKCgpkZWYgdmlzdGFfdGVtcG9yYWRhcygpOgoJb3BjYW8gPSBfX0FERE9OX18uZ2V0U2V0dGluZygndGVtcG9yYWRhc1ZpZXcnKQoJaWYgb3BjYW8gPT0gJzAnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTApIikKCWVsaWYgb3BjYW8gPT0gJzEnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTEpIikKCWVsaWYgb3BjYW8gPT0gJzInOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTAwKSIpCgllbGlmIG9wY2FvID09ICczJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwOSkiKQoJZWxpZiBvcGNhbyA9PSAnMyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDgpIikKCWVsaWYgb3BjYW8gPT0gJzQnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA0KSIpCgllbGlmIG9wY2FvID09ICc1JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwMykiKQoJZWxpZiBvcGNhbyA9PSAnNic6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MTUpIikKCWVsaWYgb3BjYW8gPT0gJzcnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTUpIikKCmRlZiB2aXN0YV9lcGlzb2Rpb3MoKToKCSN4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTApIikKCW9wY2FvID0gX19BRERPTl9fLmdldFNldHRpbmcoJ2VwaXNvZGlvc1ZpZXcnKQoJaWYgb3BjYW8gPT0gJzAnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTApIikKCWVsaWYgb3BjYW8gPT0gJzEnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTEpIikKCWVsaWYgb3BjYW8gPT0gJzInOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTAwKSIpCgllbGlmIG9wY2FvID09ICczJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwOSkiKQoJZWxpZiBvcGNhbyA9PSAnMyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDgpIikKCWVsaWYgb3BjYW8gPT0gJzQnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA0KSIpCgllbGlmIG9wY2FvID09ICc1JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwMykiKQoJZWxpZiBvcGNhbyA9PSAnNic6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MTUpIikKCWVsaWYgb3BjYW8gPT0gJzcnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTUpIikKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMJCQkJCQkJCQkJCQlHRVQgUEFSQU1TCQkJCQkJCQkJCQkJICMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCQkgIApkZWYgZ2V0X3BhcmFtcygpOgoJcGFyYW09W10KCXBhcmFtc3RyaW5nPXN5cy5hcmd2WzJdCglpZiBsZW4ocGFyYW1zdHJpbmcpPj0yOgoJCXBhcmFtcz1zeXMuYXJndlsyXQoJCWNsZWFuZWRwYXJhbXM9cGFyYW1zLnJlcGxhY2UoJz8nLCcnKQoJCWlmIChwYXJhbXNbbGVuKHBhcmFtcyktMV09PScvJyk6IHBhcmFtcz1wYXJhbXNbMDpsZW4ocGFyYW1zKS0yXQoJCXBhaXJzb2ZwYXJhbXM9Y2xlYW5lZHBhcmFtcy5zcGxpdCgnJicpCgkJcGFyYW09e30KCQlmb3IgaSBpbiByYW5nZShsZW4ocGFpcnNvZnBhcmFtcykpOgoJCQlzcGxpdHBhcmFtcz17fQoJCQlzcGxpdHBhcmFtcz1wYWlyc29mcGFyYW1zW2ldLnNwbGl0KCc9JykKCQkJaWYgKGxlbihzcGxpdHBhcmFtcykpPT0yOiBwYXJhbVtzcGxpdHBhcmFtc1swXV09c3BsaXRwYXJhbXNbMV0KCXJldHVybiBwYXJhbQoKCnBhcmFtcz1nZXRfcGFyYW1zKCkKdXJsPU5vbmUKYnVpbGR0aXBvPU5vbmUKbmFtZT1Ob25lCm1vZGU9Tm9uZQptb2RvPU5vbmUKaWNvbmltYWdlPU5vbmUKbGluaz1Ob25lCnNlbmhhPU5vbmUKZXN0aWxvPU5vbmUKc3J0ZmlsbT1Ob25lCmlkQ2FuYWw9Tm9uZQppZGZmQ2FuYWw9Tm9uZQp0aXBvbG9naWE9Tm9uZQpkZXNjcmljYW89Tm9uZQp0aXBvX3VzZXI9Tm9uZQpzZXJ2aWRvcl91c2VyPU5vbmUKZGF0YV91c2VyPU5vbmUKc19zZXJ2PU5vbmUKdGlwbz1Ob25lCnNfdXNlcj1Ob25lCnNfcGFzcz1Ob25lCmxlZ2VuZGE9Tm9uZQpwYWdpbmE9Tm9uZQp0ZW1wb3JhZGE9Tm9uZQplcGlzb2Rpbz1Ob25lCnNlcmllTm9tZT1Ob25lCmZhbmFydD1Ob25lCnRodW1ibmFpbD1Ob25lCnN0cmVhbV9pZD1Ob25lCmR1cmF0aW9uPU5vbmUKdGlwb3NlbGVjdD1Ob25lCmJhY2tncm91bmQ9Tm9uZQppbmZvPU5vbmUKbG9nb3M9Tm9uZQpjYWNoZT1Ob25lCmluZGV4PU5vbmUKbW92ZT1Ob25lCm1ldGFoPU5vbmUKcGxvdD1Ob25lCgp0cnk6IAoJbG9nb3M9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImxvZ29zIl0pCmV4Y2VwdDogCglwYXJhbXMgPSBkaWN0KHVybHBhcnNlLnBhcnNlX3FzbChzeXMuYXJndlsyXS5yZXBsYWNlKCc/JywnJykpKQoJbG9nb3MgPSBwYXJhbXMuZ2V0KCdsb2dvcycsICcnKQoKdHJ5OiAKCWNhY2hlPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJjYWNoZSJdKQpleGNlcHQ6IAoJcGFyYW1zID0gZGljdCh1cmxwYXJzZS5wYXJzZV9xc2woc3lzLmFyZ3ZbMl0ucmVwbGFjZSgnPycsJycpKSkKCWNhY2hlID0gcGFyYW1zLmdldCgnY2FjaGUnLCAnJykKCnRyeTogCglpbmRleD11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1siaW5kZXgiXSkKZXhjZXB0OiAKCXBhcmFtcyA9IGRpY3QodXJscGFyc2UucGFyc2VfcXNsKHN5cy5hcmd2WzJdLnJlcGxhY2UoJz8nLCcnKSkpCglpbmRleCA9IHBhcmFtcy5nZXQoJ2luZGV4JywgJycpCgp0cnk6IAoJbW92ZT11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sibW92ZSJdKQpleGNlcHQ6IAoJcGFyYW1zID0gZGljdCh1cmxwYXJzZS5wYXJzZV9xc2woc3lzLmFyZ3ZbMl0ucmVwbGFjZSgnPycsJycpKSkKCW1vdmUgPSBwYXJhbXMuZ2V0KCdtb3ZlJywgJycpCgp0cnk6IAoJbWV0YWg9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbIm1ldGFoIl0pCmV4Y2VwdDogCglwYXJhbXMgPSBkaWN0KHVybHBhcnNlLnBhcnNlX3FzbChzeXMuYXJndlsyXS5yZXBsYWNlKCc/JywnJykpKQoJbWV0YWggPSBwYXJhbXMuZ2V0KCdtZXRhaCcsICcnKQoKdHJ5OiAKCWJhY2tncm91bmQ9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImJhY2tncm91bmQiXSkKZXhjZXB0OiAKCXBhcmFtcyA9IGRpY3QodXJscGFyc2UucGFyc2VfcXNsKHN5cy5hcmd2WzJdLnJlcGxhY2UoJz8nLCcnKSkpCgliYWNrZ3JvdW5kID0gcGFyYW1zLmdldCgnYmFja2dyb3VuZCcsICcnKQoKdHJ5OiAKCWluZm89dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImluZm8iXSkKZXhjZXB0OiAKCXBhcmFtcyA9IGRpY3QodXJscGFyc2UucGFyc2VfcXNsKHN5cy5hcmd2WzJdLnJlcGxhY2UoJz8nLCcnKSkpCglpbmZvID0gcGFyYW1zLmdldCgnaW5mbycsICcnKQoKdHJ5OiB0aXBvPXBhcmFtc1sidGlwbyJdCmV4Y2VwdDogcGFzcwp0cnk6IGR1cmF0aW9uPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJkdXJhdGlvbiJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBzdHJlYW1faWQ9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbInN0cmVhbV9pZCJdKQpleGNlcHQ6IHBhc3MKdHJ5OiB1cmw9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbInVybCJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBuYW1lPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJuYW1lIl0pCmV4Y2VwdDogcGFzcwp0cnk6IGVzdGlsbz11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1siZXN0aWxvIl0pCmV4Y2VwdDogcGFzcwp0cnk6IG1vZGU9aW50KHBhcmFtc1sibW9kZSJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBtb2RvPXBhcmFtc1sibW9kbyJdCmV4Y2VwdDogcGFzcwp0cnk6IGljb25pbWFnZT11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1siaWNvbmltYWdlIl0pCmV4Y2VwdDogcGFzcwp0cnk6IHNlbmhhPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJzZW5oYSJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBpZENhbmFsPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJpZENhbmFsIl0pCmV4Y2VwdDogcGFzcwp0cnk6IGlkZmZDYW5hbD1wYXJhbXNbImlkZmZDYW5hbCJdCmV4Y2VwdDogcGFzcwp0cnk6IHNydGZpbG09dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbInNydGZpbG0iXSkKZXhjZXB0OiBwYXNzCnRyeTogdGlwb2xvZ2lhPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJ0aXBvbG9naWEiXSkKZXhjZXB0OiBwYXNzCnRyeTogZGVzY3JpY2FvPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJkZXNjcmljYW8iXSkKZXhjZXB0OiBwYXNzCnRyeTogdGlwb191c2VyPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJ0aXBvX3VzZXIiXSkKZXhjZXB0OiBwYXNzCnRyeTogc2Vydmlkb3JfdXNlcj11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sic2Vydmlkb3JfdXNlciJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBzX3NlcnY9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImxvbHNlcnYiXSkKZXhjZXB0OiBwYXNzCnRyeTogc191c2VyPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJsb2x1c2VyIl0pCmV4Y2VwdDogcGFzcwp0cnk6IHNfcGFzcz11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sibG9scGFzcyJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBsaW5rPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJsaW5rIl0pCmV4Y2VwdDogcGFzcwp0cnk6IGxlZ2VuZGE9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImxlZ2VuZGEiXSkKZXhjZXB0OiBwYXNzCnRyeTogbmFtZT11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sibmFtZSJdKQpleGNlcHQ6IHBhc3MKdHJ5OiB0ZW1wb3JhZGE9aW50KHBhcmFtc1sidGVtcG9yYWRhIl0pCmV4Y2VwdDogcGFzcwp0cnk6IGVwaXNvZGlvPWludChwYXJhbXNbImVwaXNvZGlvIl0pCmV4Y2VwdDogcGFzcwp0cnk6IG1vZGU9aW50KHBhcmFtc1sibW9kZSJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBwYWdpbmE9aW50KHBhcmFtc1sicGFnaW5hIl0pCmV4Y2VwdDogcGFzcwp0cnk6IGljb25pbWFnZT11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1siaWNvbmltYWdlIl0pCmV4Y2VwdDogcGFzcwp0cnkgOiBzZXJpZU5vbWU9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbInNlcmllTm9tZSJdKQpleGNlcHQ6IHBhc3MKdHJ5IDogYnVpbGR0aXBvPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJidWlsZHRpcG8iXSkKZXhjZXB0OiBwYXNzCnRyeSA6IGZhbmFydD11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1siZmFuYXJ0Il0pCmV4Y2VwdDogcGFzcwp0cnkgOiBwbG90PXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJwbG90Il0pCmV4Y2VwdDogcGFzcwp0cnkgOiB0aHVtYm5haWw9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbInRodW1ibmFpbCJdKQpleGNlcHQ6IHBhc3MKdHJ5IDogZGF0YV91c2VyPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJkYXRhX3VzZXIiXSkKZXhjZXB0OiBwYXNzCnRyeSA6IHRpcG9zZWxlY3Q9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbInRpcG9zZWxlY3QiXSkKZXhjZXB0OiBwYXNzCgoKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCQkJCQkJCQkJCQkJCU1PRE9TCQkJCQkJCQkJCQkJCSAjCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwppZiBtb2RlPT1Ob25lIG9yIHVybD09Tm9uZSBvciBsZW4odXJsKTwxOiBtZW51KCkKZWxpZiBtb2RlPT0xOiBhYnJpclZpZGVvQ2x1YmUoc3RyKHVybCkpCmVsaWYgbW9kZT09MTAxOiBsaXN0YXJfZ3J1cG9zMShtb2RlLHVybCxmYW5hcnQpCmVsaWYgbW9kZT09MTAyOiBsaXN0YXJfZ3J1cG9zMihtb2RlLHVybCxmYW5hcnQpCmVsaWYgbW9kZT09MTAzOiBsaXN0YXJfZ3J1cG9zMyhtb2RlLHVybCxmYW5hcnQpCmVsaWYgbW9kZT09MTA0OiBsaXN0YXJfZ3J1cG9zNChtb2RlLHVybCxpY29uaW1hZ2UsZmFuYXJ0KQplbGlmIG1vZGU9PTEwNjogYWJyaXJFeHRyYXMoKQplbGlmIG1vZGU9PTEwNzogbGlzdGFyX2dydXBvczUobW9kZSx1cmwsZmFuYXJ0KQplbGlmIG1vZGU9PTEwODogbGlzdGFyX2dydXBvczYobW9kZSx1cmwsaWNvbmltYWdlLGZhbmFydCkKZWxpZiBtb2RlPT0xMDk6IHBsYXlfbXVsdF9jYW5hbDIodXJsLGljb25pbWFnZSxzdHIobmFtZSkpCmVsaWYgbW9kZT09MjogQWJyaXJfQ29udGEoc3RyKHVybCkpCmVsaWYgbW9kZT09MzogYWJyaW0zdShzdHIodXJsKSkKZWxpZiBtb2RlPT00OiBkZXRlY3RfbW9kaWZpY2F0aW9uKHN0cih1cmwpLGVzdGlsbykKZWxpZiBtb2RlPT01OiBhYnJpckRlZmluaW5jb2VzKCkKZWxpZiBtb2RlPT02OiBsaXN0YXR2YXJjaGl2ZShzdHIodXJsKSkKZWxpZiBtb2RlPT03OiBsaXN0YXR2YXJjaGl2ZWNhbmFpcyhzdHIobmFtZSksc3RyZWFtX2lkLHN0cih1cmwpLGR1cmF0aW9uLGljb25pbWFnZSxmYW5hcnQpCmVsaWYgbW9kZT09ODogc3RyZWFtX3ZpZGVvKG5hbWUsdXJsLGljb25pbWFnZSkKZWxpZiBtb2RlPT05OiBnZXRfbXlhY2NvdW50KG5hbWUsdXJsLGljb25pbWFnZSkKZWxpZiBtb2RlPT0xMDogcnVuX2Nyb25qb2IobmFtZSxzdHIodXJsKSxpY29uaW1hZ2UscGxvdCxmYW5hcnQpCmVsaWYgbW9kZT09MTE6IFBsYXlVcmwobmFtZSx1cmwsaWNvbmltYWdlKQplbGlmIG1vZGU9PTEzOiBDTEVBUkNBQ0hFKCkKZWxpZiBtb2RlPT0xNDogUFVSR0VQQUNLQUdFUygpCmVsaWYgbW9kZT09MjA6IGxpc3RhbWVudXNzZXJpZXMoc3RyKG5hbWUpLHN0cih1cmwpLGVzdGlsbyx0aXBvbG9naWEsdGlwb191c2VyLHNlcnZpZG9yX3VzZXIsaWNvbmltYWdlLGZhbmFydCkKZWxpZiBtb2RlPT0yMTogbGlzdGFtZW51c2ZpbG1lcyhzdHIobmFtZSksc3RyKHVybCksZXN0aWxvLHRpcG9sb2dpYSx0aXBvX3VzZXIsc2Vydmlkb3JfdXNlcixpY29uaW1hZ2UsZmFuYXJ0KQplbGlmIG1vZGU9PTI0OiBsaXN0YW1lbnVzYW5pbWVzKHN0cihuYW1lKSxzdHIodXJsKSxlc3RpbG8sdGlwb2xvZ2lhLHRpcG9fdXNlcixzZXJ2aWRvcl91c2VyLGljb25pbWFnZSxmYW5hcnQpCmVsaWYgbW9kZT09MTExMTE6IGZpbG1lczIodXJsKQplbGlmIG1vZGU9PTExMTEyOiBzZXJpZXMyKHVybCkKZWxpZiBtb2RlPT0xMTExMzogcGxheWVyMihuYW1lLCB1cmwsIGljb25pbWFnZSwgbW9kbywgdGVtcG9yYWRhLCBlcGlzb2RpbywgdGlwbykKZWxpZiBtb2RlPT0xMTExNDogZ2V0U2Vhc29uczIodXJsLCBtb2RvKQplbGlmIG1vZGU9PTExMTE1OiBnZXRFcGlzb2RlczIodXJsKQplbGlmIG1vZGU9PTExMTE4OiBnZXRZZWFyc19saXZlKHVybCwgbW9kbykKZWxpZiBtb2RlPT0xMTExOTogZ2V0R2VuZXJvc19saXZlKHVybCwgbW9kbykKZWxpZiBtb2RlPT0xMTExOTk6IGdldEdlbmVyb3MyX2xpdmUodXJsLCBtb2RvKQplbGlmIG1vZGU9PTExMTIwOiBwZXNxdWlzYV9saXZlKHVybCwgbW9kbykKZWxpZiBtb2RlPT0xMTEyMTogZ2V0SW5mb19saXZlKHVybCwgbW9kbykKZWxpZiBtb2RlPT0yMTExMTogbGlzdGFtZW51c19saXZlaXQxKCkKZWxpZiBtb2RlPT0yMTExMjogbGlzdGFtZW51c19saXZlaXQyKCkKZWxpZiBtb2RlPT0xMTE6IGZpbG1lcyh1cmwsIHBhZ2luYSkKZWxpZiBtb2RlPT0xMjM6IHNlcmllcyh1cmwpCmVsaWYgbW9kZT09MTE4OiBnZXRHZW5lcm9zKHVybCkKZWxpZiBtb2RlPT0xMTk6IGdldFllYXJzKHVybCkKZWxpZiBtb2RlPT0xMjA6IHBlc3F1aXNhKHVybCkKZWxpZiBtb2RlPT0xMjE6IGFub3ModXJsKQplbGlmIG1vZGU9PTEyMjogY2F0ZWdvcmlhcyh1cmwpCmVsaWYgbW9kZT09MTEzOiBwbGF5ZXIobmFtZSwgdXJsLCBpY29uaW1hZ2UsIHRlbXBvcmFkYSwgZXBpc29kaW8sIHNlcmllTm9tZSkKZWxpZiBtb2RlPT0xMTQ6IGdldFNlYXNvbnModXJsKQplbGlmIG1vZGU9PTExNTogZ2V0RXBpc29kZXModXJsKQplbGlmIG1vZGU9PTExNzogZG93bmxvYWQodXJsLCBuYW1lLCB0ZW1wb3JhZGEsIGVwaXNvZGlvLCBzZXJpZU5vbWUpCmVsaWYgbW9kZT09MzE6IHByb2dyYW1hY2FvX2NhbmFsKGlkQ2FuYWwpCmVsaWYgbW9kZSA9PSAzMjoKCVBsYXlVcmwyKG5hbWUsIHVybCwgaWNvbmltYWdlKQoKaWYgbW9kZT09Tm9uZSBvciB1cmw9PU5vbmUgb3IgbGVuKHVybCk8MToKCXhibWNwbHVnaW4uZW5kT2ZEaXJlY3RvcnkoaW50KHN5cy5hcmd2WzFdKSxjYWNoZVRvRGlzYz1GYWxzZSkKZWxzZToKCWlmIG1vZGUgIT0zIGFuZCBtb2RlICE9NiBhbmQgbW9kZSAhPTc6IAoJCXhibWNwbHVnaW4uZW5kT2ZEaXJlY3RvcnkoaW50KHN5cy5hcmd2WzFdKSxjYWNoZVRvRGlzYz1GYWxzZSkKCWVsc2U6IAoJCXhibWNwbHVnaW4uZW5kT2ZEaXJlY3RvcnkoaW50KHN5cy5hcmd2WzFdKSxjYWNoZVRvRGlzYz1UcnVlKQ=="))