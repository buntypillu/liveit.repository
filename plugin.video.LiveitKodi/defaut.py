exec("import re;import base64");exec(base64.b64decode("IyMjIyMjIyMjIyMjIyNCSUJMSU9URUNBUyBBIElNUE9SVEFSIEUgREVGSU5JQ09FUyMjIyMjIyMjIyMjIyMjIyMjIyMjCmltcG9ydCB1cmxsaWIsdXJsbGliMixzeXMscmUseGJtY3BsdWdpbix4Ym1jZ3VpLHhibWNhZGRvbix4Ym1jLG9zLGpzb24sZ2xvYix0aHJlYWRpbmcsZ3ppcCx4Ym1jdmZzLGNvb2tpZWxpYixwcHJpbnQsZGF0ZXRpbWUsdGhyZWFkLHRpbWUsdXJscGFyc2UsYmFzZTY0LHBsdWdpbnRvb2xzLGNhbGVuZGFyCmltcG9ydCB4bWwuZXRyZWUuRWxlbWVudFRyZWUgYXMgRVQKaW1wb3J0IGZpbGVVdGlscyBhcyBmdQppbXBvcnQgYXN0CmZyb20gcmVzb3VyY2VzLmxpYiBpbXBvcnQgY29tbW9uCmZyb20gdXJsbGliMiBpbXBvcnQgUmVxdWVzdCwgdXJsb3Blbgpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRlCmZyb20gYnM0IGltcG9ydCBCZWF1dGlmdWxTb3VwCmZyb20gcmVzb3VyY2VzLmxpYiBpbXBvcnQgRG93bmxvYWRlciAjRW5lbjkyIGNsYXNzCmZyb20gcmVzb3VyY2VzLmxpYiBpbXBvcnQgUGxheWVyCmZyb20gcmVzb3VyY2VzLmxpYiBpbXBvcnQgVFZBcmNoaXZlCmZyb20gdDBtbTAuY29tbW9uLm5ldCBpbXBvcnQgTmV0CmZyb20gdDBtbTAuY29tbW9uLmFkZG9uIGltcG9ydCBBZGRvbgpmcm9tIHQwbW0wLmNvbW1vbi5uZXQgaW1wb3J0IEh0dHBSZXNwb25zZQpmcm9tIHJlc291cmNlcy5saWIgaW1wb3J0IFVSTFJlc29sdmVyTWVkaWEKZnJvbSByZXNvdXJjZXMubGliIGltcG9ydCBUcmFrdApmcm9tIHJlc291cmNlcy5saWIgaW1wb3J0IERhdGFiYXNlCmZyb20gdW5pY29kZWRhdGEgaW1wb3J0IG5vcm1hbGl6ZQp0cnk6CiAgICBpbXBvcnQgc3NsCiAgICBjb250ZXh0ID0gc3NsLlNTTENvbnRleHQoc3NsLlBST1RPQ09MX1RMU3YxKQpleGNlcHQ6CiAgICBwYXNzCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMgQ09OU1RBTlRFUyAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZ2xvYmFsIGdfdGltZXIKZ2xvYmFsIHRlbGV2aXNpb29uaWxpbmsKZ2xvYmFsIGZpbG1pbGluawpnbG9iYWwgYW5kbWVsaW5rCmdsb2JhbCB1dWVuZHVzbGluawpnbG9iYWwgdXVlbmR1c2VkCmdsb2JhbCB2YW5lbWFsdWtrCmdsb2JhbCB2ZXJzaW9uCmdsb2JhbCBtb2RlCgpyZWxvYWQoc3lzKQpzeXMuc2V0ZGVmYXVsdGVuY29kaW5nKCd1dGY4JykKbW9kZSA9IDMzMzMKdmVyc2lvbiA9ICIiCmthc3V0YWphbmltaSA9ICIiCnNhbGFzb25hID0gIiIKbGVoZWt5bGcgPSAiIgp2YW5lbWFrb29kID0gIiIKdmFuZW1hbHVrayA9ICIiCnRlbGV2aXNpb29uaWxpbmsgPSAiIgpmaWxtaWxpbmsgPSAiIgphbmRtZWxpbmsgPSAiIgoKX0xJSUxMXyA9ICJhSFIwY0RvdkwyeHBkbVZwZEd0dlpHa3VZMjl0TDFCSVVDOTJZV3hwWkdGMFpVRlFVQzV3YUhBPSIKX0xJSUxMXzIgPSAiYUhSMGNEb3ZMMnhwZG1WcGRHdHZaR2t1WTI5dEwxQklVQzlzYVhabGFYUXZiRzluYVc1QlVGQXVjR2h3IgpfX0FERE9OX0lEX18JPSB4Ym1jYWRkb24uQWRkb24oKS5nZXRBZGRvbkluZm8oImlkIikKX19BRERPTl9fCT0geGJtY2FkZG9uLkFkZG9uKF9fQURET05fSURfXykKX19BRERPTlZFUlNJT05fXyA9IF9fQURET05fXy5nZXRBZGRvbkluZm8oJ3ZlcnNpb24nKQpBZGRvblRpdGxlID0gX19BRERPTl9fLmdldEFkZG9uSW5mbygnbmFtZScpCkROU19ERUZJTkUgPSAnJwpfX0FERE9OX0ZPTERFUl9fCT0gX19BRERPTl9fLmdldEFkZG9uSW5mbygncGF0aCcpCl9fU0VUVElOR19fCT0geGJtY2FkZG9uLkFkZG9uKCkuZ2V0U2V0dGluZwpfX0FSVF9GT0xERVJfXwk9IF9fQURET05fRk9MREVSX18gKyAnL3Jlc291cmNlcy9pbWcvJwpfX1NLSU5fXyA9ICd2MicKX19RdWFsaWRhZGVfXyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCdxdWFsaWRhZGVGaWxtZXMnKQpfX0ZBTkFSVF9fID0gb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvLnBuZycpCl9fUEFTVEFfREFET1NfXyA9IEFkZG9uKF9fQURET05fSURfXykuZ2V0X3Byb2ZpbGUoKS5kZWNvZGUoInV0Zi04IikKX19BUElfXyA9IGJhc2U2NC51cmxzYWZlX2I2NGRlY29kZSgnYUhSMGNEb3ZMMjF3WVhCcExtMXNMdz09JykKX19BUElfU0lURV9fID0gYmFzZTY0LnVybHNhZmVfYjY0ZGVjb2RlKCdhSFIwY0RvdkwyMXdZWEJwTG0xc0wyRndhVzVsZHk4PScpCl9fU0lURV9fID0gYmFzZTY0LnVybHNhZmVfYjY0ZGVjb2RlKCdhSFIwY0RvdkwyMXljR2x5WVdONUxtZHhMdz09JykKX19GT0xERVJfRVBHX18gPSBvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdlcGdsaXZlbm93JykKX19DT09LSUVfRklMRV9fID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnbGl2ZW5vdycpCl9fU0lURUFkZG9uX18gPSBiYXNlNjQudXJsc2FmZV9iNjRkZWNvZGUoJ2FIUjBjRG92TDNkM2R5NXdZM1JsWTJ0elpYSjJMbU52YlM5SGNuVndiMHR2WkdrdlFXUmtiMjR2JykKX19TSVRFQkRfXyA9IGJhc2U2NC51cmxzYWZlX2I2NGRlY29kZSgnYUhSMGNEb3ZMM2QzZHk1d1kzUmxZMnR6WlhKMkxtTnZiUzlIY25Wd2IwdHZaR2t2VUVoUUx3PT0nKQpfSUNPTl8gPSBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvbi5wbmcnKQpfX0hFQURFUlNfXyA9IHsnVXNlci1BZ2VudCc6ICdNb3ppbGxhLzUuMCAoTWFjaW50b3NoOyBJbnRlbCBNYWMgT1MgWCAxMC4xMTsgcnY6NDMuMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC80My4wJywgJ0FjY2VwdCc6ICd0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSwqLyo7cT0wLjgnfQpoZWFkZXJzID0geydVc2VyLUFnZW50JzogJ01vemlsbGEvNS4wIChNYWNpbnRvc2g7IEludGVsIE1hYyBPUyBYIDEwLjExOyBydjo0My4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzQzLjAnLCAnQWNjZXB0LUNoYXJzZXQnOiAndXRmLTg7cT0wLjcsKjtxPTAuNycsICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbid9CgpDYXQgPSBfX0FERE9OX18uZ2V0U2V0dGluZygiQ2F0IikKY09yZE5DRiA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJjT3JkTkNGIikKY09yZE5DUyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJjT3JkTkNTIikKCkNsaXN0YT1bICJ0b2RvcyIsICJhY2FvIiwgImFuaW1hY2FvIiwgImF2ZW50dXJhIiwgImNvbWVkaWEiLCAiZHJhbWEiLCAiZmFudGFzaWEiLCAiZmljY2FvLWNpZW50aWZpY2EiLCAicm9tYW5jZSIsICJzdXNwZW5zZSIsICJ0ZXJyb3IiXQpDbGlzdGEzPVsiU2VtIGZpbHRybyAoTW9zdHJhciBUb2RvcykiLCJBw6fDo28iLCAiQW5pbWHDp8OjbyIsICJBdmVudHVyYSIsICJDb23DqWRpYSIsICJEcmFtYSIsICJGYW50YXNpYSIsICJGaWPDp8Ojby1DaWVudMOtZmljYSIsICJSb21hbmNlIiwgIlN1c3BlbnNlIiwgIlRlcnJvciJdCgpkZWYgc2V0Vmlld1MoKToKCXhibWNwbHVnaW4uc2V0Q29udGVudChpbnQoc3lzLmFyZ3ZbMV0pLCAndHZzaG93cycpCmRlZiBzZXRWaWV3TSgpOgoJeGJtY3BsdWdpbi5zZXRDb250ZW50KGludChzeXMuYXJndlsxXSksICdtb3ZpZXMnKQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwkJCQkJCQkgIEluaWNpYXIgQWRkb24JCQkJCQkJCQkJICAjCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpkZWYgX19BTEVSVEFfXyh0ZXh0MT0iIix0ZXh0Mj0iIix0ZXh0Mz0iIik6CglpZiB0ZXh0Mz09IiI6IHhibWNndWkuRGlhbG9nKCkub2sodGV4dDEsdGV4dDIpCgllbGlmIHRleHQyPT0iIjogeGJtY2d1aS5EaWFsb2coKS5vaygiIix0ZXh0MSkKCWVsc2U6IHhibWNndWkuRGlhbG9nKCkub2sodGV4dDEsdGV4dDIsdGV4dDMpCgpkZWYgY3JpYXJNZW51KHBhaSxub21lLGxvZ28sdXJsLHRpcG8sZmFuYXJ0KToKCW1lbnVzID0gewoJCQknbm9tZSc6ICcnLAoJCQknbG9nbyc6ICcnLAoJCQkndXJsJzogJycsCgkJCSd0aXBvJzogJycsCgkJCSdmYW5hcnQnOiAnJwoJCQl9CgltZW51c1snbm9tZSddID0gbm9tZQoJbWVudXNbJ2xvZ28nXSA9IGxvZ28KCW1lbnVzWyd1cmwnXSA9IHVybAoJbWVudXNbJ3RpcG8nXSA9IHRpcG8KCW1lbnVzWydmYW5hcnQnXSA9IGZhbmFydAoJcGFpLmFwcGVuZChtZW51cykKCQpkZWYgbWVudSgpOgoJaWYgKG5vdCBfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fbmFtZScpIG9yIG5vdCBfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fcGFzc3dvcmQnKSk6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnUHJlY2lzYSBkZSBkZWZpbmlyIG8gc2V1IFV0aWxpemFkb3IgZSBTZW5oYScpCgkJYWJyaXJEZWZpbmluY29lcygpCgkJCgllbHNlOgkKCQljaGVja19sb2dpbjIgPSBsb2dpbnBhaW5lbCgpCgkJaWYgY2hlY2tfbG9naW4yWyd1c2VyJ11bJ0Vycm8nXSAhPSAnJzoKCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCBjaGVja19sb2dpbjJbJ3VzZXInXVsnRXJybyddKQoJCWVsc2U6CgkJCV9MSUlMTF8gPSBjaGVja19sb2dpbjJbJ3VzZXInXVsnRE5TJ10KCQkJY2hlY2tfbG9naW4gPSBsb2dpbkxpdmVpdChfTElJTExfKQoJCQkjY2hlY2tfbG9naW4gPSBsb2dpbihfTElJTExfKQoJCQlpZiBjaGVja19sb2dpblsndXNlciddWydyZXN1bHRhZG8nXSA9PSAneWVzJzoKCQkJCWlmIGNoZWNrX2xvZ2luWyd1c2VyJ11bJ2VzdGFkbyddID09ICdJbmFjdGl2byc6CgkJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnQSBzdWEgY29udGEgZXN0w6EgRXhwaXJhZGEuIFBvciBmYXZvciBmYcOnYSBhIHN1YSBSZW5vdmHDp8OjbyBvdSBSZWFjdGl2YcOnw6NvLicpCQkKCQkJCWVsc2U6CgkJCQkJaWYgY2hlY2tfbG9naW5bJ3VzZXInXVsndHJpYWwnXSA9PSAnVGVzdGUnOgoJCQkJCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdBIGNvbnRhIMOpIHVtYSBjb250YSBkZSBUZXN0ZS4gQXDDs3MgbyB0ZXN0ZSBlIGdvc3RhciBmYcOnYSBhIHN1YSBBcXVpc2nDp8Ojby4nKQoJCQkJCWlmIGNoZWNrX2xvZ2luWyd1c2VyJ11bJ2RhdGEnXSA9PSAnMCcgYW5kIGNoZWNrX2xvZ2luWyd1c2VyJ11bJ3RyaWFsJ10gIT0gJ1Rlc3RlJzoKCQkJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnQSBzdWEgY29udGEgZXhwaXJhIEhvamUuIEZhw6dhIGrDoSBhIHN1YSBSZW5vdmHDp8Ojby4nKQoJCQkJCWVsc2U6CgkJCQkJCWlmIGNoZWNrX2xvZ2luWyd1c2VyJ11bJ2RpYXMnXSA9PSAnNScgb3IgY2hlY2tfbG9naW5bJ3VzZXInXVsnZGlhcyddID09ICc0JyBvciBjaGVja19sb2dpblsndXNlciddWydkaWFzJ10gPT0gJzMnIG9yIGNoZWNrX2xvZ2luWyd1c2VyJ11bJ2RpYXMnXSA9PSAnMicgb3IgY2hlY2tfbG9naW5bJ3VzZXInXVsnZGlhcyddID09ICcxJzoKCQkJCQkJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0Egc3VhIGNvbnRhIGV4cGlyYSBkYXF1aSBhICcrc3RyKGNoZWNrX2xvZ2luWyd1c2VyJ11bJ2RhdGEnXSkrICcgZGlhcy4gRmHDp2EgasOhIGEgc3VhIFJlbm92YcOnw6NvLicpCgkJCQkJY3JpYXJNZW51KGNoZWNrX2xvZ2luWydtZW51cyddLCJNaW5oYSBDb250YSIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb19jb24ucG5nJyksX0xJSUxMXywiY29udGEiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19jb24ucG5nJykpCgkJCQkJY3JpYXJNZW51KGNoZWNrX2xvZ2luWydtZW51cyddLCJWZXIgVFYiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fdHYucG5nJyksX0xJSUxMXywidHYiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb190di5wbmcnKSkKCQkJCQljcmlhck1lbnUoY2hlY2tfbG9naW5bJ21lbnVzJ10sIlbDrWRlbyBDbHViZSIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb192aWQucG5nJyksX0xJSUxMXywiZmlsbWVzIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fdmlkLnBuZycpKQoJCQkJCWNyaWFyTWVudShjaGVja19sb2dpblsnbWVudXMnXSwiVFYgQXJjaGl2ZSIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb190dl9hcmMucG5nJyksX0xJSUxMXywidHZhcmNoaXZlIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fdHZfYXJjLnBuZycpKQoJCQkJCQoJCQkJCWZpbG1lc19hcHAgPSBjaGVja19sb2dpbjJbJ3VzZXInXVsnRmlsbWVzX2FwcCddOwoJCQkJCWlmIGZpbG1lc19hcHAgPT0gNCBvciBmaWxtZXNfYXBwID09ICc0JzoKCQkJCQkJY3JpYXJNZW51KGNoZWNrX2xvZ2luWydtZW51cyddLCJFeHRyYXMiLF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJBZGRvbi9JbWFnZW5zL25vdmlkYWRlc3R2LnBuZyIsImV4dHJhcyIsImV4dHJhcyIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3R2X2FyYy5wbmcnKSkKCQkJCQljcmlhck1lbnUoY2hlY2tfbG9naW5bJ21lbnVzJ10sIkNvbmZpZ3VyYcOnw7VlcyIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb19kZWYucG5nJyksImNvbmZpZ3VyYXIiLCJjb25maWd1cmFyIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fZGVmLnBuZycpKQoJCQkJCWNyaWFyTWVudShjaGVja19sb2dpblsnbWVudXMnXSwiTGltcGFyIENhY2hlIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX2xpbS5wbmcnKSwibGltcGFyY2FjaGUiLCJsaW1wYXJjYWNoZSIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2xpbS5wbmcnKSkKCQkJCQljcmlhck1lbnUoY2hlY2tfbG9naW5bJ21lbnVzJ10sIkxpbXBhciBUdWRvIEdyYXZhZG8iLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fbGltLnBuZycpLCJsaW1wYXJ0dWRvIiwibGltcGFydHVkbyIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2xpbS5wbmcnKSkKCQkJCQlpZihjaGVja19sb2dpbjJbJ3VzZXInXVsnRW1haWwnXSAhPSAnJyBhbmQgY2hlY2tfbG9naW4yWyd1c2VyJ11bJ0VtYWlsJ10gIT0gJ2VtYWlsJyk6CgkJCQkJCWFkZExpbmtDYW5hbExpc3RhKCJbQ09MT1IgPSB3aGl0ZV1FbWFpbCBEw7p2aWRhczogWy9DT0xPUl0iK2NoZWNrX2xvZ2luMlsndXNlciddWydFbWFpbCddLCIiLCIiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fY29uLnBuZycpLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19jb24ucG5nJyksJycpCgkJCQkJaWYoY2hlY2tfbG9naW4yWyd1c2VyJ11bJ1dlYlNpdGUnXSAhPSAnJyBhbmQgY2hlY2tfbG9naW4yWyd1c2VyJ11bJ1dlYlNpdGUnXSAhPSAnaHR0cDovLycpOgoJCQkJCQlhZGRMaW5rQ2FuYWxMaXN0YSgiW0NPTE9SID0gd2hpdGVdQXF1aXNpw6fDo286IFsvQ09MT1JdIitjaGVja19sb2dpbjJbJ3VzZXInXVsnV2ViU2l0ZSddLCIiLCIiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fY29uLnBuZycpLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19jb24ucG5nJyksJycpCgkJCQkJTWVudV9pbmljaWFsKGNoZWNrX2xvZ2luLEZhbHNlLCcnKQoJCQkJX19FUEdfXyA9IF9MSUlMTF8rJ3htbHR2LnBocD91c2VybmFtZT0nK19fQURET05fXy5nZXRTZXR0aW5nKCdsb2dpbl9uYW1lJykrJyZwYXNzd29yZD0nK19fQURET05fXy5nZXRTZXR0aW5nKCdsb2dpbl9wYXNzd29yZCcpKycmZXBnX3NoaWZ0PTAnCgkJCQlfX0FERE9OX18uc2V0U2V0dGluZygnbGlzdGFfZXBnJywgX19FUEdfXykKCQkJCXRocmVhZC5zdGFydF9uZXdfdGhyZWFkKG9idGVyX2ZpY2hlaXJvX2VwZywgKCkgKQoJCQkJdmlzdGFfbWVudSgpCgkJCWVsaWYgY2hlY2tfbG9naW5bJ3VzZXInXVsncmVzdWx0YWRvJ10gPT0gJ3V0aWxpemFkb3InOgoJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVXRpbGl6YWRvciBpbmNvcnJldG8uJykKCQkJCWFkZERpcignQWx0ZXJhciBEZWZpbmnDp8O1ZXMnLCAndXJsJywgTm9uZSwgMTAwMCwgJ01pbmlhdHVyYScsIF9fU0lURUFkZG9uX18rIkltYWdlbnMvZGVmaW5pY29lcy5wbmciLCcnLCcnLCcnLCcnLF9fU0lURUFkZG9uX18rIkltYWdlbnMvZGVmaW5pY29lc19mYW5hcnQucG5nIikKCQkJCWFkZERpcignRW50cmFyIG5vdmFtZW50ZScsICd1cmwnLCBOb25lLCBOb25lLCAnTWluaWF0dXJhJywgX19TSVRFQWRkb25fXysiSW1hZ2Vucy9yZXRyb2NlZGVyLnBuZyIsJycsJycsJycsJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2FkZG9uLnBuZycpKQoJCQkJdmlzdGFfbWVudSgpCgkJCWVsaWYgY2hlY2tfbG9naW5bJ3VzZXInXVsncmVzdWx0YWRvJ10gPT0gJ3NlbmhhJzoKCQkJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1NlbmhhIGluY29ycmV0YS4nKQoJCQkJYWRkRGlyKCdBbHRlcmFyIERlZmluacOnw7VlcycsICd1cmwnLCBOb25lLCAxMDAwLCAnTWluaWF0dXJhJywgX19TSVRFQWRkb25fXysiSW1hZ2Vucy9kZWZpbmljb2VzLnBuZyIsJycsJycsJycsJycsX19TSVRFQWRkb25fXysiSW1hZ2Vucy9kZWZpbmljb2VzX2ZhbmFydC5wbmciKQoJCQkJYWRkRGlyKCdFbnRyYXIgbm92YW1lbnRlJywgJ3VybCcsIE5vbmUsIE5vbmUsICdNaW5pYXR1cmEnLCBfX1NJVEVBZGRvbl9fKyJJbWFnZW5zL3JldHJvY2VkZXIucG5nIiwnJywnJywnJywnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fYWRkb24ucG5nJykpCgkJCQl2aXN0YV9tZW51KCkKCQkJZWxpZiBjaGVja19sb2dpblsndXNlciddWydyZXN1bHRhZG8nXSA9PSAnYXRpdm8nOgoJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnTyBlc3RhZG8gZG8gc2V1IFV0aWxpemFkb3IgZW5jb250cmEtc2UgSW5hY3Rpdm8uIFBhcmEgc2FiZXIgbWFpcyBpbmZvcm1hw6fDtWVzIGVudHJlIGVtIGNvbnRhY3RvIHBlbG8gZW1haWwgbGl2ZWl0a29kaUBnbWFpbC5jb20uJykKCQkJCXZpc3RhX21lbnUoKQoJCQllbHNlOgoJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVXRpbGl6YWRvciBvdSBzZW5oYSBJbmNvcnJlY3Rvcy4gQWx0ZXJlIGUgdGVudGUgbm92YW1lbnRlLicpCgkJCQlhZGREaXIoJ0FsdGVyYXIgRGVmaW5pw6fDtWVzJywgJ3VybCcsIDUsICdNaW5pYXR1cmEnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX2RlZi5wbmcnKSwnJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2RlZi5wbmcnKSkKCQkJCWFkZERpcignRW50cmFyIG5vdmFtZW50ZScsICd1cmwnLCBOb25lLCAnTWluaWF0dXJhJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb19saW0ucG5nJyksJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2xpbS5wbmcnKSkKCQkJCXZpc3RhX21lbnUoKQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwkJCQkJCQkgIExvZ2luIEFkZG9uCQkJCQkJCQkJCSAgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZGVmIGxvZ2lucGFpbmVsKCk6CglpbmZvcm1hY29lcyA9IHsKCQkndXNlcicgOiB7CgkJCSdOb21lJzogJycsCgkJCSdBY2Vzc19Ub2tlbic6ICcnLAoJCQknRE5TJzogJycsCgkJCSdFbWFpbCc6ICcnLAoJCQknV2ViU2l0ZSc6ICcnLAoJCQknVmVyQVBQJzogJycsCgkJCSdMaW5rQVBQJzogJycsCgkJCSdFcnJvJzogJycsCgkJCSdTZXJpZXMnOiAnJywKCQkJJ01lbGhvcmFtZW50b3MnOiAnJywKCQkJJ0NsaWVudF9TZWNyZXRfVXNlcic6ICcnLAoJCQknRmlsbWVzX2FwcCc6ICcnCgkJfQoJfQoJdHJ5OgoJCW5ldCA9IE5ldCgpCgkJZGFkb3MgPSB7J25vbWVfYXBwJzogQWRkb25UaXRsZSwgJ3RpcG9fYXBwJzogJ0FkZG9uJywgJ3VzZXJuYW1lJzogX19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX25hbWUiKSwgJ3Bhc3N3b3JkJzogX19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX3Bhc3N3b3JkIil9CgkJY29kaWdvX2ZvbnRlID0gbmV0Lmh0dHBfUE9TVChiYXNlNjQuYjY0ZGVjb2RlKF9MSUlMTF8pLGZvcm1fZGF0YT1kYWRvcyxoZWFkZXJzPV9fSEVBREVSU19fKS5jb250ZW50CgkJZWxlbXMgPSBFVC5mcm9tc3RyaW5nKGNvZGlnb19mb250ZSkKCQlmb3IgY2hpbGQgaW4gZWxlbXM6CgkJCWlmKGNoaWxkLnRhZyA9PSAnZXJybycpOgoJCQkJI2luZm9ybWFjb2VzWyd1c2VyJ11bJ0Vycm8nXSA9IGNoaWxkLnRleHQKCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ05vbWUnXSA9IEFkZG9uVGl0bGUKCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ0FjZXNzX1Rva2VuJ10gPSAnJwoJCQkJX19BRERPTl9fLnNldFNldHRpbmcoJ2FjZXNzX1Rva2VuJywgJycpCgkJCQlpbmZvcm1hY29lc1sndXNlciddWydETlMnXSA9IGJhc2U2NC51cmxzYWZlX2I2NGRlY29kZShfX0FERE9OX18uZ2V0U2V0dGluZygnZG5zX2FkZG9uJykpCgkJCQlfX0VQR19fID0gaW5mb3JtYWNvZXNbJ3VzZXInXVsnRE5TJ10rJ3htbHR2LnBocD91c2VybmFtZT0nK19fQURET05fXy5nZXRTZXR0aW5nKCdsb2dpbl9uYW1lJykrJyZwYXNzd29yZD0nK19fQURET05fXy5nZXRTZXR0aW5nKCdsb2dpbl9wYXNzd29yZCcpKycmZXBnX3NoaWZ0PTAnCgkJCQlfX0FERE9OX18uc2V0U2V0dGluZygnbGlzdGFfZXBnJywgX19FUEdfXykKCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ0VtYWlsJ10gPSAnJwoJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnV2ViU2l0ZSddID0gJycKCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ1ZlckFQUCddID0gX19BRERPTlZFUlNJT05fXwoJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnTGlua0FQUCddID0gJycKCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ01lbGhvcmFtZW50b3MnXSA9ICcnCgkJCQlpbmZvcm1hY29lc1sndXNlciddWydGaWxtZXNfYXBwJ10gPSAnNScKCQkJCV9fQURET05fXy5zZXRTZXR0aW5nKCdlbWFpbCcsICcnKQoJCQkJX19BRERPTl9fLnNldFNldHRpbmcoJ3Bhc3N3b3JkJywgJycpCgkJCQlpbmZvcm1hY29lc1sndXNlciddWydDbGllbnRfU2VjcmV0X1VzZXInXSA9ICcnCgkJCQlfX0FERE9OX18uc2V0U2V0dGluZygnY2xpZW50X3NlY3JldF91c2VyJywgJycpCgkJCWVsaWYoY2hpbGQudGFnID09ICd2YWxpZGFjYW8nKToKCQkJCWZvciBkIGluIGNoaWxkOgoJCQkJCWlmKGQudGFnID09ICdOb21lJyk6CgkJCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ05vbWUnXSA9IGQudGV4dAoJCQkJCWVsaWYoZC50YWcgPT0gJ0FjZXNzX1Rva2VuJyk6CgkJCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ0FjZXNzX1Rva2VuJ10gPSBkLnRleHQKCQkJCQkJX19BRERPTl9fLnNldFNldHRpbmcoJ2FjZXNzX1Rva2VuJywgZC50ZXh0KQoJCQkJCWVsaWYoZC50YWcgPT0gJ0ROUycpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydETlMnXSA9IGQudGV4dAoJCQkJCWVsaWYoZC50YWcgPT0gJ0VtYWlsJyk6CgkJCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ0VtYWlsJ10gPSBkLnRleHQKCQkJCQllbGlmKGQudGFnID09ICdXZWJTaXRlJyk6CgkJCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ1dlYlNpdGUnXSA9IGQudGV4dAoJCQkJCWVsaWYoZC50YWcgPT0gJ1ZlckFQUCcpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydWZXJBUFAnXSA9IGQudGV4dAoJCQkJCWVsaWYoZC50YWcgPT0gJ0xpbmtBUFAnKToKCQkJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnTGlua0FQUCddID0gZC50ZXh0CgkJCQkJZWxpZihkLnRhZyA9PSAnTWVsaG9yYW1lbnRvcycpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydNZWxob3JhbWVudG9zJ10gPSBkLnRleHQKCQkJCQllbGlmKGQudGFnID09ICdmaWxtZXNfYXBwJyk6CgkJCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ0ZpbG1lc19hcHAnXSA9IGQudGV4dAoJCQkJCWVsaWYoZC50YWcgPT0gJ3VzZXJfa29kaScpOgoJCQkJCQlfX0FERE9OX18uc2V0U2V0dGluZygnZW1haWwnLCBkLnRleHQpCgkJCQkJZWxpZihkLnRhZyA9PSAnc2VuaGFfa29kaScpOgoJCQkJCQlfX0FERE9OX18uc2V0U2V0dGluZygncGFzc3dvcmQnLCBkLnRleHQpCgkJCQkJZWxpZihkLnRhZyA9PSAnQ2xpZW50X1NlY3JldF9Vc2VyJyk6CgkJCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ0NsaWVudF9TZWNyZXRfVXNlciddID0gZC50ZXh0CgkJCQkJCV9fQURET05fXy5zZXRTZXR0aW5nKCdjbGllbnRfc2VjcmV0X3VzZXInLCBkLnRleHQpCgkJCWVsc2U6CgkJCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdOw6NvIHNlaSBvIHF1ZSBlc3RvdSBhIGxlci4nKQoJZXhjZXB0OgoJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ05vbWUnXSA9IEFkZG9uVGl0bGUKCQlpbmZvcm1hY29lc1sndXNlciddWydBY2Vzc19Ub2tlbiddID0gJycKCQlfX0FERE9OX18uc2V0U2V0dGluZygnYWNlc3NfVG9rZW4nLCAnJykKCQlpbmZvcm1hY29lc1sndXNlciddWydETlMnXSA9IGJhc2U2NC51cmxzYWZlX2I2NGRlY29kZShfX0FERE9OX18uZ2V0U2V0dGluZygnZG5zX2FkZG9uJykpCgkJX19FUEdfXyA9IGluZm9ybWFjb2VzWyd1c2VyJ11bJ0ROUyddKyd4bWx0di5waHA/dXNlcm5hbWU9JytfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fbmFtZScpKycmcGFzc3dvcmQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fcGFzc3dvcmQnKSsnJmVwZ19zaGlmdD0wJwoJCV9fQURET05fXy5zZXRTZXR0aW5nKCdsaXN0YV9lcGcnLCBfX0VQR19fKQoJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ0VtYWlsJ10gPSAnJwoJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ1dlYlNpdGUnXSA9ICcnCgkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnVmVyQVBQJ10gPSBfX0FERE9OVkVSU0lPTl9fCgkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnTGlua0FQUCddID0gJycKCQlpbmZvcm1hY29lc1sndXNlciddWydNZWxob3JhbWVudG9zJ10gPSAnJwoJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ0ZpbG1lc19hcHAnXSA9ICc1JwoJCV9fQURET05fXy5zZXRTZXR0aW5nKCdlbWFpbCcsICcnKQoJCV9fQURET05fXy5zZXRTZXR0aW5nKCdwYXNzd29yZCcsICcnKQoJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ0NsaWVudF9TZWNyZXRfVXNlciddID0gJycKCQlfX0FERE9OX18uc2V0U2V0dGluZygnY2xpZW50X3NlY3JldF91c2VyJywgJycpCgkJI19fQUxFUlRBX18oQWRkb25UaXRsZSwgJ07Do28gZm9pIHBvc3PDrXZlbCBhYnJpciBhIHDDoWdpbmEuIFBvciBmYXZvciB0ZW50ZSBub3ZhbWVudGUuJykKCQlyZXR1cm4gaW5mb3JtYWNvZXMKCglyZXR1cm4gaW5mb3JtYWNvZXMKCmRlZiBsb2dpbkxpdmVpdCh1cmwpOgoJaW5mb3JtYWNvZXMgPSB7CgkJJ3VzZXInIDogewoJCQkndXNlcm5hbWUnOiAnJywKCQkJJ3Bhc3N3b3JkJzogJycsCgkJCSdlc3RhZG8nOiAnJywKCQkJJ2RhdGEnOiAnJywKCQkJJ2RpYXMnOiAnJywKCQkJJ3RyaWFsJzogJycsCgkJCSdjcmlhY2FvJzogJycsCgkJCSdzZXJpZXMnOiAnJywKCQkJJ2xpc3RhJzogJycsCgkJCSdyZXN1bHRhZG8nOiAnJywKCQkJJ2NvbmVjY29lcyc6ICcnCgkJCQoJCX0sCgkJJ21lbnVzJzogW10KCX0KCXRyeToKCQluZXQgPSBOZXQoKQoJCW5ldC5zZXRfY29va2llcyhfX0NPT0tJRV9GSUxFX18pCgkJZGFkb3MgPSB7J3VzZXJuYW1lJzogX19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX25hbWUiKSwgJ3Bhc3N3b3JkJzogX19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX3Bhc3N3b3JkIil9CgkJY29kaWdvX2ZvbnRlID0gbmV0Lmh0dHBfUE9TVChfX1NJVEVCRF9fKydMb2dpbkFkZG9uMi5waHAnLGZvcm1fZGF0YT1kYWRvcyxoZWFkZXJzPV9fSEVBREVSU19fKS5jb250ZW50CgkJZWxlbXMgPSBFVC5mcm9tc3RyaW5nKGNvZGlnb19mb250ZSkKCQlmb3IgY2hpbGQgaW4gZWxlbXM6CgkJCWlmKGNoaWxkLnRhZyA9PSAnc3VjZXNzbycpOgoJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsncmVzdWx0YWRvJ10gPSBjaGlsZC50ZXh0CgkJCWVsaWYoY2hpbGQudGFnID09ICd1c2VyJyk6CgkJCQlpbmZvcm1hY29lc1sndXNlciddWydsaXN0YSddID0gdXJsCgkJCQlmb3IgZCBpbiBjaGlsZDoKCQkJCQlpZihkLnRhZyA9PSAnRGF0YUZpbScpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydkYXRhJ10gPSBkLnRleHQKCQkJCQllbGlmKGQudGFnID09ICdkaWFzJyk6CgkJCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ2RpYXMnXSA9IGQudGV4dAoJCQkJCWVsaWYoZC50YWcgPT0gJ0RhdGFDcmlhY2FvJyk6CgkJCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ2NyaWFjYW8nXSA9IGQudGV4dAoJCQkJCWVsaWYoZC50YWcgPT0gJ0VxdWlwYW1lbnRvcycpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydjb25lY2NvZXMnXSA9ICJbQ09MT1IgPSB3aGl0ZV1NYXhpbW8gZGUgQ29ubmVjOiBbL0NPTE9SXSIrZC50ZXh0CgkJCQkJZWxpZihkLnRhZyA9PSAnVGlwb1VzZXInKToKCQkJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsndHJpYWwnXSA9IGQudGV4dAoJCQkJCWVsaWYoZC50YWcgPT0gJ0VzdGFkbycpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydlc3RhZG8nXSA9IGQudGV4dAoJCQkJCWVsaWYoZC50YWcgPT0gJ3NlcmllcycpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydzZXJpZXMnXSA9IGQudGV4dAoJCQkJCWVsaWYoZC50YWcgPT0gJ1NlbmhhJyk6CgkJCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ3Bhc3N3b3JkJ10gPSBkLnRleHQKCQkJCQllbGlmKGQudGFnID09ICdVdGlsaXphZG9yJyk6CgkJCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ3VzZXJuYW1lJ10gPSAiW0NPTE9SID0gd2hpdGVdVXRpbGl6YWRvcjogWy9DT0xPUl0iK2QudGV4dAoJCQkjZWxzZToKCQkJIwlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdOw6NvIHNlaSBvIHF1ZSBlc3RvdSBhIGxlci4nKQoJZXhjZXB0OgoJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ3VzZXJuYW1lJ10gPSAiIgoJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ3Bhc3N3b3JkJ10gPSAiIgoJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ2VzdGFkbyddID0gIiIKCQlpbmZvcm1hY29lc1sndXNlciddWydkYXRhJ10gPSAiIgoJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ3RyaWFsJ10gPSAiIgoJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ2NvbmVjY29lcyddID0gIiIKCQlpbmZvcm1hY29lc1sndXNlciddWydzZXJpZXMnXSA9ICIiCgkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnbGlzdGEnXSA9IHVybAoJCXJldHVybiBpbmZvcm1hY29lcwoJCglyZXR1cm4gaW5mb3JtYWNvZXMKCmRlZiBsb2dpbih1cmwpOgoJaW5mb3JtYWNvZXMgPSB7CgkJJ3VzZXInIDogewoJCQkndXNlcm5hbWUnOiAnJywKCQkJJ3Bhc3N3b3JkJzogJycsCgkJCSdlc3RhZG8nOiAnJywKCQkJJ2RhdGEnOiAnJywKCQkJJ3RyaWFsJzogJycsCgkJCSdsaXN0YSc6ICcnLAoJCQknY29uZWNjb2VzJzogJycKCQkJCgkJfSwKCQknbWVudXMnOiBbXQoJfSAjIAoJYW5kbWVsaW5rID0gdXJsKydwbGF5ZXJfYXBpLnBocD91c2VybmFtZT0nK19fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9uYW1lIikrJyZwYXNzd29yZD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9wYXNzd29yZCIpCglhbmRtZWQgPSBncmFiX2VwZyhhbmRtZWxpbmspCglpZiBhbmRtZWQgIT0gTm9uZToKCQlrYXN1dGFqYUFuZG1lZCA9IGFuZG1lZFtzeW5jX2RhdGEoImRYTmxjbDlwYm1adiIpXQoJCWthc3V0YWphQW5kbWVkMiA9IGFuZG1lZFtzeW5jX2RhdGEoImMyVnlkbVZ5WDJsdVptOD0iKV0KCQlzZWlzID0ga2FzdXRhamFBbmRtZWRbZ2V0X2xpdmUoImMzUmhkSFZ6IildCgkJYWVndWIgPSBrYXN1dGFqYUFuZG1lZFtzeW5jX2RhdGEoIlpYaHdYMlJoZEdVPSIpXQoJCWlmIGFlZ3ViOgoJCQlhZWd1YiA9IGRhdGUuZnJvbXRpbWVzdGFtcChpbnQoYWVndWIpKS5zdHJmdGltZSgiJVktJW0tJWQiKQoJCQkjI2VhZWFlbiA9IGthc3V0YWphQW5kbWVkMltzeW5jX2RhdGEoImRHbHRaVjl1YjNjPSIpXQoJCQkKCQkJdmlld1N0YXJ0RGF0ZSA9IGRhdGV0aW1lLmRhdGV0aW1lLm5vdygpLnN0cmZ0aW1lKCIlWS0lbS0lZCIpCgkJCQoJCQlmb3JtYXQgPSAiJVktJW0tJWQiCgkJCQoJCQl0cnk6CgkJCQlob2plMSA9IGRhdGV0aW1lLmRhdGV0aW1lLnN0cnB0aW1lKGFlZ3ViLCBmb3JtYXQpCgkJCWV4Y2VwdCBUeXBlRXJyb3I6CgkJCQlob2plMSA9IGRhdGV0aW1lLmRhdGV0aW1lKCoodGltZS5zdHJwdGltZShhZWd1YiwgZm9ybWF0KVswOjZdKSkKCQkJCgkJCXRyeToKCQkJCWhvamUyID0gZGF0ZXRpbWUuZGF0ZXRpbWUuc3RycHRpbWUodmlld1N0YXJ0RGF0ZSwgZm9ybWF0KQoJCQlleGNlcHQgVHlwZUVycm9yOgoJCQkJaG9qZTIgPSBkYXRldGltZS5kYXRldGltZSgqKHRpbWUuc3RycHRpbWUodmlld1N0YXJ0RGF0ZSwgZm9ybWF0KVswOjZdKSkKCQkJCgkJCWFlZ3ViID0gc3RyKGFicygoaG9qZTEtaG9qZTIpLmRheXMpKQoJCWVsc2U6CgkJCWFlZ3ViID0gdm9kX2NoYW5uZWxzKCJUbVYyWlhJPSIpIAoJCXJhYmJpdHMgPSBrYXN1dGFqYUFuZG1lZFt2b2RfY2hhbm5lbHMoImFYTmZkSEpwWVd3PSIpXQoJCWlmIHJhYmJpdHMgPT0gIjAiOgoJCQlyYWJiaXRzID0gc3luY19kYXRhKCJUbTg9IikKCQllbHNlOgoJCQlyYWJiaXRzID0gc3luY19kYXRhKCJXV1Z6IikKCQlsZWF2ZW1lYWxvbmUgPSBrYXN1dGFqYUFuZG1lZFtnZXRfbGl2ZSgiYldGNFgyTnZibTVsWTNScGIyNXoiKV0KCQlwb2xhcmJlYXJzID0ga2FzdXRhamFBbmRtZWRbc3luY19kYXRhKCJkWE5sY201aGJXVT0iKV0KCQkKCQlpZihwb2xhcmJlYXJzICE9ICcnKToKCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsndXNlcm5hbWUnXSA9ICJbQ09MT1IgPSB3aGl0ZV1VdGlsaXphZG9yOiBbL0NPTE9SXSIrcG9sYXJiZWFycwoJCQlpbmZvcm1hY29lc1sndXNlciddWydlc3RhZG8nXSA9IHNlaXMKCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnZGF0YSddID0gYWVndWIKCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsndHJpYWwnXSA9IHJhYmJpdHMKCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnY29uZWNjb2VzJ10gPSAiW0NPTE9SID0gd2hpdGVdTWF4aW1vIGRlIENvbm5lYzogWy9DT0xPUl0iK2xlYXZlbWVhbG9uZQoJCQlpbmZvcm1hY29lc1sndXNlciddWydsaXN0YSddID0gdXJsCgkKCXJldHVybiBpbmZvcm1hY29lcwoKZGVmIGxvZ2luMigpOgoJcmVzdWx0YWRvID0gRmFsc2UKCXRyeToKCQlwb3N0ID0gdXJsbGliLnVybGVuY29kZSh7J3VzZXJuYW1lJzogX19BRERPTl9fLmdldFNldHRpbmcoJ2VtYWlsJyksICdwYXNzd29yZCc6IF9fQURET05fXy5nZXRTZXR0aW5nKCdwYXNzd29yZCcpIH0pCgkJcmVzdWx0YWRvID0gYWJyaXJfdXJsKF9fQVBJX1NJVEVfXysnbG9naW4ucGhwJywgcG9zdD1wb3N0LCBoZWFkZXI9aGVhZGVycykKCQkKCQlpZiByZXN1bHRhZG8gPT0gJ0ROUyc6CgkJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1RlbSBkZSBhbHRlcmFyIG9zIEROUyBwYXJhIHBvZGVyIHVzdWZydWlyIGRvIF9fQURET05fXy4nKQoJCQlyZXR1cm4gRmFsc2UKCQkJCgkJdHJ5OgoJCQlyZXN1bHRhZG8gPSByZXN1bHRhZG8uZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OgoJCQlyZXN1bHRhZG8gPSByZXN1bHRhZG8uZW5jb2RlKCd1dGYtOCcpCgkJdHJ5OgoJCQlpZiByZXN1bHRhZG9bJ2NvZGlnbyddID09IDIwNDoKCQkJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgcmVzdWx0YWRvWydtZW5zYWdlbSddKQoJCQkJcmV0dXJuIEZhbHNlCgkJZXhjZXB0OgoJCQlwYXNzCgkJCgkJZXNjcmV2ZXJfZmljaGVpcm8ob3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnZGVmaW5pY29lcy5saXZlaXQnKSwgcmVzdWx0YWRvKQoJCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJCSNjb2xvY2FyIG8gbG9nZ2VkaW4KCQl0b2tlbiA9IHJlc3VsdGFkb1snY29va2llJ10KCQlyZWZyZXNoID0gcmVzdWx0YWRvWydleHBpcmEnXQoJCQoJCXRyeToKCQkJdXNlcm5hbWUgPSByZXN1bHRhZG9bJ3VzZXJuYW1lJ10uZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OgoJCQl1c2VybmFtZSA9IHJlc3VsdGFkb1sndXNlcm5hbWUnXS5lbmNvZGUoJ3V0Zi04JykKCQkKCQlfX0FERE9OX18uc2V0U2V0dGluZygndG9rZW5NcnBpcmFjeScsIHRva2VuKQoJCV9fQURET05fXy5zZXRTZXR0aW5nKCdyZWZyZXNoTXJwaXJhY3knLCByZWZyZXNoKQoJCV9fQURET05fXy5zZXRTZXR0aW5nKCdsb2dnZWRpbicsIHVzZXJuYW1lKQoJCQoJCWNhdGVnb3JpYXMgPSByZXN1bHRhZG9bJ2NhdGVnb3JpYXMnXQoJCWVzY3JldmVyX2ZpY2hlaXJvKG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ2NhdGVnb3JpYXMubGl2ZWl0JyksIHN0cihjYXRlZ29yaWFzKSkKCQlyZXR1cm4gVHJ1ZQoJZXhjZXB0OgoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ07Do28gZm9pIHBvc3PDrXZlbCBhYnJpciBhIHDDoWdpbmEuIFBvciBmYXZvciB0ZW50ZSBub3ZhbWVudGUuJykKCQlyZXR1cm4gRmFsc2UKCmRlZiBNZW51X2luaWNpYWwobWVuLGJ1aWxkLHRpcG8pOgoJX25vbWV1c2VyID0gbWVuWyd1c2VyJ11bJ3VzZXJuYW1lJ10KCWZvciBtZW51IGluIG1lblsnbWVudXMnXToKCQlub21lID0gbWVudVsnbm9tZSddCgkJbG9nbyA9IG1lbnVbJ2xvZ28nXQoJCWxpbmsgPSBtZW51Wyd1cmwnXQoJCXRpcG8gPSBtZW51Wyd0aXBvJ10KCQlmYW5hcnQgPSBtZW51WydmYW5hcnQnXQoJCQoJCWlmIHRpcG8gPT0gJ2NvbnRhJyA6CgkJCWFkZERpcihub21lLGxpbmssMiwnTGlzdGEnLGxvZ28sdGlwbyxmYW5hcnQpCgkJZWxpZih0aXBvID09ICd0dicpOgoJCQlhZGREaXIobm9tZSxsaW5rLDMsJ0xpc3RhJyxsb2dvLHRpcG8sZmFuYXJ0KQoJCWVsaWYodGlwbyA9PSAnZmlsbWVzJyk6CgkJCWFkZERpcihub21lLGxpbmssMSwnTGlzdGEnLGxvZ28sdGlwbyxmYW5hcnQpCgkJZWxpZih0aXBvID09ICdleHRyYXMnKToKCQkJYWRkRGlyKG5vbWUsbGluaywxMDYsJ0xpc3RhJyxsb2dvLHRpcG8sZmFuYXJ0KQoJCWVsaWYodGlwbyA9PSAnY29uZmlndXJhcicpOgoJCQlhZGREaXIobm9tZSxsaW5rLDUsJ0xpc3RhJyxsb2dvLHRpcG8sZmFuYXJ0KQoJCWVsaWYgdGlwbyA9PSAndHZhcmNoaXZlJzoKCQkJYWRkRGlyKG5vbWUsbGluayw2LCdMaXN0YScsbG9nbywnJyxmYW5hcnQpCgkJZWxpZih0aXBvID09ICdsaW1wYXJjYWNoZScpOgoJCQlhZGREaXIobm9tZSwgbGluaywgMTMsICdMaXN0YScsbG9nbyx0aXBvLGZhbmFydCkKCQllbGlmKHRpcG8gPT0gJ2xpbXBhcnR1ZG8nKToKCQkJYWRkRGlyKG5vbWUsIGxpbmssIDE0LCAnTGlzdGEnLGxvZ28sdGlwbyxmYW5hcnQpCgkJCgl4Ym1jLmV4ZWN1dGVidWlsdGluKCdOb3RpZmljYXRpb24oJXMsICVzLCAlaSwgJXMpJyUoQWRkb25UaXRsZSxfbm9tZXVzZXIsIDgwMDAsIF9JQ09OXykpCgl4Ym1jcGx1Z2luLmVuZE9mRGlyZWN0b3J5KGludChzeXMuYXJndlsxXSksY2FjaGVUb0Rpc2M9RmFsc2UpCgpkZWYgYWJyaXJFeHRyYXMoKToKCXVybG5vbzEgPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC9idXNjYXJyYWRpb3MucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZhZGRvbj0xJwoJYWRkRGlyKCJSw6FkaW9zIix1cmxub28xLDEwMiwnTGlzdGEnLF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJBZGRvbi9JbWFnZW5zL3JhZGlvcy5wbmciLCdwcmFpYXMnLF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJBZGRvbi9JbWFnZW5zL3JhZGlvc19mYW5hcnQucG5nIikKCXVybG5vbzEgPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC9idXNjYXJwcmFpYXMucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZhZGRvbj0xJwoJYWRkRGlyKCJQcmFpYXMiLHVybG5vbzEsMTAxLCdMaXN0YScsX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrIkFkZG9uL0ltYWdlbnMvbm92aWRhZGVzdHYucG5nIiwncHJhaWFzJyxfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsiQWRkb24vSW1hZ2Vucy9ub3ZpZGFkZXNfZmFuYXJ0LnBuZyIpCgl1cmxub28xID0gX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvYnVzY2FybmV3dGVsZW5vdmVsYXMucGhwP3RpcG89UHJvZ3JhbWFzJmNsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZhZGRvbj0xJwoJYWRkRGlyKCJQcm9ncmFtYXMgZSBUZWxlbm92ZWxhcyIsdXJsbm9vMSwxMDMsJ0xpc3RhJyxfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsiQWRkb24vSW1hZ2Vucy9ub3ZpZGFkZXN0di5wbmciLCdwcmFpYXMnLF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJBZGRvbi9JbWFnZW5zL25vdmlkYWRlc19mYW5hcnQucG5nIikKCXVybG5vbzEgPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC9idXNjYXJuZXd0ZWxlbm92ZWxhcy5waHA/dGlwbz1Kb3JuYWlzJmNsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZhZGRvbj0xJwoJYWRkRGlyKCJKb3JuYWlzIix1cmxub28xLDEwNywnTGlzdGEnLF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJBZGRvbi9JbWFnZW5zL25vdmlkYWRlc3R2LnBuZyIsJ2pvcm5haXMnLF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJBZGRvbi9JbWFnZW5zL25vdmlkYWRlc19mYW5hcnQucG5nIikKCQoJdmlzdGFfbWVudSgpCgpkZWYgbGlzdGFyX2dydXBvczEobW9kb24sdXJsLGZhbmFydCk6CglyZXN1bHRhZG8xID0gZGV2b2x2ZXJlc3VsdGFkbyh1cmwpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbzEpCglmb3IgaSBpbiByZXN1bHRhZG9bJ2NhbmFpcyddOgoJCWlkID0gaVsnSUQnXQoJCW5vbWUgPSAiIgoJCWltYWdlbSA9ICIiCgkJdXJsbiA9ICIiCgkJdHJ5OiBub21lID0gYmFzZTY0LmI2NGRlY29kZShpWydOb21lJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCXRyeTogCgkJCWltYWdlbSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnSW1hZ2VtJ10pLmRlY29kZSgndXRmLTgnKQoJCQlpbWFnZW0gPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsiTG9nb3MvIitpbWFnZW0KCQlleGNlcHQ6IHBhc3MKCQl0cnk6IHVybG4gPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ1VybCddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQlhZGRMaW5rQ2FuYWxMaXN0YShub21lLHVybG4saW1hZ2VtLCcnLGZhbmFydCwgJzAwMDEnKQoJCQpkZWYgbGlzdGFyX2dydXBvczIobW9kb24sdXJsLGZhbmFydCk6CglyZXN1bHRhZG8xID0gZGV2b2x2ZXJlc3VsdGFkbyh1cmwpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbzEpCglmb3IgaSBpbiByZXN1bHRhZG9bJ2NhbmFpcyddOgoJCWlkID0gaVsnSUQnXQoJCW5vbWUgPSAiIgoJCWltYWdlbSA9ICIiCgkJdXJsbiA9ICIiCgkJdHJ5OiBub21lID0gYmFzZTY0LmI2NGRlY29kZShpWydOb21lJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCXRyeTogCgkJCWltYWdlbSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnSW1hZ2VtJ10pLmRlY29kZSgndXRmLTgnKQoJCQlpbWFnZW0gPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsiTG9nb3MvIitpbWFnZW0KCQlleGNlcHQ6IHBhc3MKCQl0cnk6IHVybG4gPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ1VybCddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQlhZGRMaW5rQ2FuYWxMaXN0YShub21lLHVybG4saW1hZ2VtLCcnLGZhbmFydCwgJzAwMDEnKQoJCmRlZiBsaXN0YXJfZ3J1cG9zMyhtb2Rvbix1cmwsZmFuYXJ0KToKCXJlc3VsdGFkbzEgPSBkZXZvbHZlcmVzdWx0YWRvKHVybCkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvMSkKCWZvciBpIGluIHJlc3VsdGFkb1snY2FuYWlzJ106CgkJbm9tZSA9ICIiCgkJaW1hZ2VtID0gIiIKCQl1cmxuID0gIiIKCQl0aXBvID0gIiIKCQl3ZWJzaXRlID0gIiIKCQljYW5hbCA9ICIiCgkJdHJ5OiBub21lID0gYmFzZTY0LmI2NGRlY29kZShpWydOb21lJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCXRyeTogCgkJCWltYWdlbSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnSW1hZ2VtJ10pLmRlY29kZSgndXRmLTgnKQoJCQlpbWFnZW0gPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsiTG9nb3MvIitpbWFnZW0KCQlleGNlcHQ6IHBhc3MKCQl0cnk6IHVybG4gPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ1VybCddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQl0cnk6IHdlYnNpdGUgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ1dlYlNpdGUnXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OiBwYXNzCgkJdHJ5OiB0aXBvID0gaVsnVGlwbyddCgkJZXhjZXB0OiBwYXNzCgkJdHJ5OiBjYW5hbCA9IGlbJ0NhbmFsJ10KCQlleGNlcHQ6IHBhc3MKCQl1cmxub28zID0gX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvYnVzY2FyaW5mb3RlbGVub3ZlbGFzLnBocD90aXBvPScrdGlwbysnJndlYnNpdGU9Jyt3ZWJzaXRlKycmdXJsPScrdXJsbisnJmNsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZhZGRvbj0xJwoJCWFkZERpcihub21lLHVybG5vbzMsMTA0LCdMaXN0YScsaW1hZ2VtLCdQcm9ncmFtYXMnLF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJBZGRvbi9JbWFnZW5zL25vdmlkYWRlc19mYW5hcnQucG5nIikKCmRlZiBsaXN0YXJfZ3J1cG9zNChtb2Rvbix1cmwsaWNvbmltYWdlLGZhbmFydCk6CglyZXN1bHRhZG8xID0gZGV2b2x2ZXJlc3VsdGFkbyh1cmwpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbzEpCglmb3IgaSBpbiByZXN1bHRhZG9bJ2VwaXNvZGlvcyddOgoJCW5vbWUgPSAiIgoJCXVybG4gPSBpWyd1cmwnXQoJCXRyeTogbm9tZSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsndGl0dWxvJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCWFkZExpbmtDYW5hbExpc3RhKG5vbWUsdXJsbixpY29uaW1hZ2UsJ3Byb2dyYW1hcycsZmFuYXJ0LCAnMDAwMScpCgkJCmRlZiBsaXN0YXJfZ3J1cG9zNShtb2Rvbix1cmwsZmFuYXJ0KToKCXJlc3VsdGFkbzEgPSBkZXZvbHZlcmVzdWx0YWRvKHVybCkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvMSkKCWZvciBpIGluIHJlc3VsdGFkb1snY2FuYWlzJ106CgkJbm9tZSA9ICIiCgkJaW1hZ2VtID0gIiIKCQl1cmxuID0gIiIKCQl0aXBvID0gIiIKCQl3ZWJzaXRlID0gIiIKCQljYW5hbCA9ICIiCgkJdHJ5OiBub21lID0gYmFzZTY0LmI2NGRlY29kZShpWydOb21lJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCXRyeTogCgkJCWltYWdlbSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnSW1hZ2VtJ10pLmRlY29kZSgndXRmLTgnKQoJCQlpbWFnZW0gPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsiTG9nb3MvIitpbWFnZW0KCQlleGNlcHQ6IHBhc3MKCQl0cnk6IHVybG4gPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ1VybCddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQl0cnk6IHdlYnNpdGUgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ1dlYlNpdGUnXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OiBwYXNzCgkJdHJ5OiB0aXBvID0gaVsnVGlwbyddCgkJZXhjZXB0OiBwYXNzCgkJdHJ5OiBjYW5hbCA9IGlbJ0NhbmFsJ10KCQlleGNlcHQ6IHBhc3MKCQl1cmxub28zID0gX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvYnVzY2FyaW5mb3RlbGVub3ZlbGFzLnBocD90aXBvPWpvcm5haXMmdXJsPScrdXJsbisnJmNsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZhZGRvbj0xJwoJCWFkZERpcihub21lLHVybG5vbzMsMTA4LCdMaXN0YScsaW1hZ2VtLCdKb3JuYWlzJyxfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsiQWRkb24vSW1hZ2Vucy9ub3ZpZGFkZXNfZmFuYXJ0LnBuZyIpCgpkZWYgbGlzdGFyX2dydXBvczYobW9kb24sdXJsLGljb25pbWFnZSxmYW5hcnQpOgoJcmVzdWx0YWRvMSA9IGRldm9sdmVyZXN1bHRhZG8odXJsKQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8xKQoJZm9yIGkgaW4gcmVzdWx0YWRvWydlcGlzb2Rpb3MnXToKCQlub21lID0gIiIKCQl1cmxuID0gIiIKCQl0cnk6IG5vbWUgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ3RpdHVsbyddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQl0cnk6IHVybG4gPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ3VybCddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQkKCQlhZGREaXIobm9tZSx1cmxuLDEwOSwnTGlzdGEnLGljb25pbWFnZSwnUHJvZ3JhbWFzJyxmYW5hcnQpCgl4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTUpIikKCmRlZiBwbGF5X211bHRfY2FuYWwyKGFyZywgaWNvbiwgbm9tZSk6Cgl4Ym1jLmV4ZWN1dGVidWlsdGluKCdTaG93UGljdHVyZSgiezB9IiknLmZvcm1hdChhcmcpKQoKZGVmIGFicmlyVmlkZW9DbHViZSh1cmwpOgoJY2hlY2tfbG9naW4yID0gbG9naW5wYWluZWwoKQoJZmlsbWVzX2FwcCA9IGNoZWNrX2xvZ2luMlsndXNlciddWydGaWxtZXNfYXBwJ107CglmaWxtaWxpbmsgPSB1cmwrJ2VuaWdtYTIucGhwP3VzZXJuYW1lPScrX19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX25hbWUiKSsnJnBhc3N3b3JkPScrX19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX3Bhc3N3b3JkIikrJyZ0eXBlPWdldF92b2RfY2F0ZWdvcmllcycKCWlmIGZpbG1lc19hcHAgPT0gMCBvciBmaWxtZXNfYXBwID09ICcwJzoKCQlkYXRhYmFzZSA9IERhdGFiYXNlLmNyaWFyRmljaGVpcm9zKCkKCQlhZGREaXIoJ0ZpbG1lcyBkYSBMaXN0YScsZmlsbWlsaW5rLDQsJ01pbmlhdHVyYScsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ZpbG1lcy5wbmcnKSwnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fX19BRERPTl9fLnBuZycpKQoJCWFkZERpcignRmlsbWVzIGRvIEFkZG9uJyx1cmwsMjEsJ01pbmlhdHVyYScsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ZpbG1lcy5wbmcnKSwnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fX19BRERPTl9fLnBuZycpKQoJCWFkZERpcignU8OpcmllcyBkbyBBZGRvbicsdXJsLDIwLCdNaW5pYXR1cmEnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdzZXJpZXMucG5nJyksJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX19fQURET05fXy5wbmcnKSkKCQlhZGREaXIoJ0FuaW1lcyBkbyBBZGRvbicsdXJsLDI0LCdNaW5pYXR1cmEnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdhbmltZS5wbmcnKSwnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fX19BRERPTl9fLnBuZycpKQoJCWFkZERpcignW0NPTE9SIHBpbmtdW0JdUGVzcXVpc2FbL0JdWy9DT0xPUl0nLF9fQVBJX1NJVEVfXywxMjAsJ0xpc3RhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncGVzcXVpc2EucG5nJyksJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX19fQURET05fXy5wbmcnKSkKCWVsaWYgZmlsbWVzX2FwcCA9PSAxIG9yIGZpbG1lc19hcHAgPT0gJzEnOgoJCWFkZERpcignRmlsbWVzIGRhIExpc3RhJyxmaWxtaWxpbmssNCwnTWluaWF0dXJhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZmlsbWVzLnBuZycpLCcnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19fX0FERE9OX18ucG5nJykpCQkKCWVsaWYgZmlsbWVzX2FwcCA9PSAyIG9yIGZpbG1lc19hcHAgPT0gJzInOgoJCWFkZERpcignRmlsbWVzIGRhIExpc3RhJyxmaWxtaWxpbmssNCwnTWluaWF0dXJhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZmlsbWVzLnBuZycpLCcnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19fX0FERE9OX18ucG5nJykpCgkJYWRkRGlyKCdGaWxtZXMgZG8gQWRkb24nLHVybCw3MSwnTWluaWF0dXJhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZmlsbWVzLnBuZycpLCcnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19fX0FERE9OX18ucG5nJykpCgkJYWRkRGlyKCdTw6lyaWVzIGRvIEFkZG9uJyx1cmwsNjAsJ01pbmlhdHVyYScsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Nlcmllcy5wbmcnKSwnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fX19BRERPTl9fLnBuZycpKQoJCWFkZERpcignW0NPTE9SIHBpbmtdW0JdUGVzcXVpc2FbL0JdWy9DT0xPUl0nLHVybCwxNjAsJ0xpc3RhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncGVzcXVpc2EucG5nJyksJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX19fQURET05fXy5wbmcnKSkKCWVsaWYgZmlsbWVzX2FwcCA9PSA0IG9yIGZpbG1lc19hcHAgPT0gJzQnOgoJCWFkZERpcignRmlsbWVzIGRhIExpc3RhJyxmaWxtaWxpbmssNCwnTWluaWF0dXJhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZmlsbWVzLnBuZycpLCcnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19fX0FERE9OX18ucG5nJykpCgkJYWRkRGlyKCdGaWxtZXMgZG8gQWRkb24nLHVybCwyMTExMSwnTWluaWF0dXJhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZmlsbWVzLnBuZycpLCcnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19fX0FERE9OX18ucG5nJykpCgkJYWRkRGlyKCdTw6lyaWVzIGRvIEFkZG9uJyx1cmwsMjExMTIsJ01pbmlhdHVyYScsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Nlcmllcy5wbmcnKSwnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fX19BRERPTl9fLnBuZycpKQoJZWxzZToKCQlhZGREaXIoJ0ZpbG1lcyBkYSBMaXN0YScsZmlsbWlsaW5rLDQsJ01pbmlhdHVyYScsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ZpbG1lcy5wbmcnKSwnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fX19BRERPTl9fLnBuZycpKQkJCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCQkJCQkJCSAgQWJyaXIgSW5mbyBDb250YQkJCQkJCQkJCSAgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZGVmIEFicmlyX0NvbnRhKHVybCk6CglhbmRtZWxpbmsgPSB1cmwrJ3BsYXllcl9hcGkucGhwP3VzZXJuYW1lPScrX19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX25hbWUiKSsnJnBhc3N3b3JkPScrX19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX3Bhc3N3b3JkIikKCWV4ZWN1dGVfYWluZm8oYW5kbWVsaW5rKQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMJCQkJCQkJCQkJCQkJQWJyaXIgSW5mbyBUVlMJCQkJCQkJCQkJCSAjCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZGVmIGFicmltM3UodXJsKToKCXZlcnNpb24gPSBfX0FERE9OVkVSU0lPTl9fCglrYXN1dGFqYW5pbWk9X19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX25hbWUiKQoJc2FsYXNvbmE9X19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX3Bhc3N3b3JkIikKCWxlaGVreWxnPXVybAoJdmFuZW1ha29vZD1fX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fYWR1bHRvcyIpCgl2YW5lbWFsdWtrPV9fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9hZHVsdG9zX3NpbSIpCgkKCXRlbGV2aXNpb29uaWxpbmsgPSB1cmwrJy9lbmlnbWEyLnBocD91c2VybmFtZT0nK19fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9uYW1lIikrJyZwYXNzd29yZD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9wYXNzd29yZCIpKycmdHlwZT1nZXRfbGl2ZV9jYXRlZ29yaWVzJwoJc2VjdXJpdHlfY2hlY2sodGVsZXZpc2lvb25pbGluaykKCmRlZiBzZWN1cml0eV9jaGVjayh1cmwpOgoJdSA9IHVybGxpYjIuUmVxdWVzdCh1cmwsJycpCgl1LmFkZF9oZWFkZXIoJ0FjY2VwdCcsICdhcHBsaWNhdGlvbi94bWwnKQoJdS5hZGRfaGVhZGVyKCdVc2VyLWFnZW50JywgJ01vemlsbGEvNS4wIChXaW5kb3dzOyBVOyBXaW5kb3dzIE5UIDUuMTsgZW4tR0I7IHJ2OjEuOS4wLjMpIEdlY2tvLzIwMDgwOTI0MTcgRmlyZWZveC8zLjAuMycpCglyZXNwb25zZSA9IHVybGxpYjIudXJsb3Blbih1KQoJdHJlZSA9IEVULnBhcnNlKHJlc3BvbnNlKQoJcm9vdEVsZW0gPSB0cmVlLmdldHJvb3QoKQoJZm9yIGNoYW5uZWwgaW4gdHJlZS5maW5kYWxsKCJjaGFubmVsIik6CgkJa2FuYWxpbmltaSA9IGNoYW5uZWwuZmluZCgidGl0bGUiKS50ZXh0CgkJa2FuYWxpbmltaSA9IGJhc2U2NC5iNjRkZWNvZGUoa2FuYWxpbmltaSkKCQlrYXRlZ29vcmlhbGluayA9IGNoYW5uZWwuZmluZCgicGxheWxpc3RfdXJsIikudGV4dAoJCQoJCWFkZERpcihrYW5hbGluaW1pLGthdGVnb29yaWFsaW5rLDgsJ01pbmlhdHVyYScsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb190di5wbmcnKSwnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fdHYucG5nJykpCgkKCXZpc3RhX0dydXBvcygpCgpkZWYgZGV0ZWN0X21vZGlmaWNhdGlvbih1cmwpOgoJZmlsbWlsaW5rID0gdXJsKycvZW5pZ21hMi5waHA/dXNlcm5hbWU9JytfX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fbmFtZSIpKycmcGFzc3dvcmQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fcGFzc3dvcmQiKSsnJnR5cGU9Z2V0X3ZvZF9jYXRlZ29yaWVzJwoJdSA9IHVybGxpYjIuUmVxdWVzdChmaWxtaWxpbmssJycpCgl1LmFkZF9oZWFkZXIoJ0FjY2VwdCcsICdhcHBsaWNhdGlvbi94bWwnKQoJdS5hZGRfaGVhZGVyKCdVc2VyLWFnZW50JywgJ01vemlsbGEvNS4wIChXaW5kb3dzOyBVOyBXaW5kb3dzIE5UIDUuMTsgZW4tR0I7IHJ2OjEuOS4wLjMpIEdlY2tvLzIwMDgwOTI0MTcgRmlyZWZveC8zLjAuMycpCglyZXNwb25zZSA9IHVybGxpYjIudXJsb3Blbih1KQoJdHJlZSA9IEVULnBhcnNlKHJlc3BvbnNlKQoJcm9vdEVsZW0gPSB0cmVlLmdldHJvb3QoKQoJZm9yIGNoYW5uZWwgaW4gdHJlZS5maW5kYWxsKCJjaGFubmVsIik6CgkJZmlsbWluaW1pID0gY2hhbm5lbC5maW5kKCJ0aXRsZSIpLnRleHQKCQlmaWxtaW5pbWkgPSBiYXNlNjQuYjY0ZGVjb2RlKGZpbG1pbmltaSkKCQlrYXRlZ29vcmlhbGluayA9IGNoYW5uZWwuZmluZCgicGxheWxpc3RfdXJsIikudGV4dAoJCQoJCWFkZERpcihmaWxtaW5pbWksa2F0ZWdvb3JpYWxpbmssOSwnTWluaWF0dXJhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX3ZpZC5wbmcnKSwnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fdmlkLnBuZycpKQoJCgl2aXN0YV9HcnVwb3MoKQoKZGVmIHN0cmVhbV92aWRlbyhuYW1lLHVybCxpbWFnZSk6Cgl2YW5lbWFsdWtrPV9fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9hZHVsdG9zX3NpbSIpCglpZiB2YW5lbWFsdWtrID09ICJ0cnVlIjoKCQl2YW5lbWFfbHVrayhuYW1lKQoJdSA9IHVybGxpYjIuUmVxdWVzdCh1cmwsJycpCgl1LmFkZF9oZWFkZXIoJ0FjY2VwdCcsICdhcHBsaWNhdGlvbi94bWwnKQoJdS5hZGRfaGVhZGVyKCdVc2VyLWFnZW50JywgJ01vemlsbGEvNS4wIChXaW5kb3dzOyBVOyBXaW5kb3dzIE5UIDUuMTsgZW4tR0I7IHJ2OjEuOS4wLjMpIEdlY2tvLzIwMDgwOTI0MTcgRmlyZWZveC8zLjAuMycpCglyZXNwb25zZSA9IHVybGxpYjIudXJsb3Blbih1KQoJdHJlZSA9IEVULnBhcnNlKHJlc3BvbnNlKQoJcm9vdEVsZW0gPSB0cmVlLmdldHJvb3QoKQoJZm9yIGNoYW5uZWwgaW4gdHJlZS5maW5kYWxsKHN5bmNfZGF0YSgiWTJoaGJtNWxiQT09IikpOgoJCWthbmFsaW5pbWkgPSBjaGFubmVsLmZpbmQoZ2V0X2xpdmUoImRHbDBiR1U9IikpLnRleHQKCQlrYW5hbGluaW1pID0gYmFzZTY0LmI2NGRlY29kZShrYW5hbGluaW1pKQoJCWthbmFsaW5pbWkgPSBrYW5hbGluaW1pLnBhcnRpdGlvbigiWyIpCgkJc3RyaWltaWxpbmsgPSBjaGFubmVsLmZpbmQoZ2V0X2xpdmUoImMzUnlaV0Z0WDNWeWJBPT0iKSkudGV4dAoJCQoJCXVybGNoYW1hID0gc3RyaWltaWxpbmsuc3BsaXQoJy8nKQoJCXVybG5vbyA9ICcnCgkJdHJ5OgoJCQl1cmxub28gPSB1cmxjaGFtYVs1XQoJCQl1cmxub28gPSB1cmxub28ucmVwbGFjZSgndHMnLCcnKQoJCQl1cmxub28gPSB1cmxub28ucmVwbGFjZSgnbTN1OCcsJycpCgkJZXhjZXB0OgoJCQlwYXNzCgkJCgkJcGlsdCA9IGNoYW5uZWwuZmluZCgiZGVzY19pbWFnZSIpLnRleHQKCQlrYXZhID0ga2FuYWxpbmltaVsxXStrYW5hbGluaW1pWzJdCgkJa2F2YSA9IGthdmEucGFydGl0aW9uKCJdIikKCQlrYXZhID0ga2F2YVsyXQoJCWthdmEgPSBrYXZhLnBhcnRpdGlvbigiCSIpCgkJa2F2YSA9IGthdmFbMl0KCQlzaG91ID0gZ2V0X2xpdmUoIlcwTlBURTlTSUhkb2FYUmxYU1Z6SUZzdlEwOU1UMUpkIiklKGthbmFsaW5pbWlbMF0pK2thdmEKCQlraXJqZWxkdXMgPSBjaGFubmVsLmZpbmQoImRlc2NyaXB0aW9uIikudGV4dAoJCWlmIGtpcmplbGR1czoKCQkJa2lyamVsZHVzID0gYmFzZTY0LmI2NGRlY29kZShraXJqZWxkdXMpCgkJCW55eWQgPSBraXJqZWxkdXMucGFydGl0aW9uKCIoIikKCQkJbnl5ZCA9ICJBZ29yYTogIitueXlkWzBdCgkJCWphcmdtaW5lID0ga2lyamVsZHVzLnBhcnRpdGlvbigiKVxuIikKCQkJamFyZ21pbmUgPSBqYXJnbWluZVsyXS5wYXJ0aXRpb24oIigiKQoJCQlqYXJnbWluZSA9ICJBIHNlZ3VpcjogIitqYXJnbWluZVswXQoJCQlrb2trdSA9IG55eWQramFyZ21pbmUKCQllbHNlOgoJCQlrb2trdSA9ICIiCgkJaWYgcGlsdDoKCQkJYWRkTGlua0NhbmFsTGlzdGEoc2hvdSxzdHJpaW1pbGluayxwaWx0LGtva2t1LG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb190di5wbmcnKSwgdXJsbm9vKQoJCWVsc2U6CgkJCWFkZExpbmtDYW5hbExpc3RhKHNob3Usc3RyaWltaWxpbmssb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb190di5wbmcnKSxrb2trdSxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fdHYucG5nJyksIHVybG5vbykKCQoJeGJtY3BsdWdpbi5zZXRDb250ZW50KGludChzeXMuYXJndlsxXSkgLCJlcGlzb2RlcyIpCgl2aXN0YV9DYW5haXMoKQoKZGVmIGdldF9teWFjY291bnQobmFtZSx1cmwsaW1hZ2UpOgoJdmFuZW1hbHVraz1fX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fYWR1bHRvc19zaW0iKQoJaWYgdmFuZW1hbHVrayA9PSAidHJ1ZSI6CgkJdmFuZW1hX2x1a2sobmFtZSkKCXUgPSB1cmxsaWIyLlJlcXVlc3QodXJsLCcnKQoJdS5hZGRfaGVhZGVyKCdBY2NlcHQnLCAnYXBwbGljYXRpb24veG1sJykKCXUuYWRkX2hlYWRlcignVXNlci1hZ2VudCcsICdNb3ppbGxhLzUuMCAoV2luZG93czsgVTsgV2luZG93cyBOVCA1LjE7IGVuLUdCOyBydjoxLjkuMC4zKSBHZWNrby8yMDA4MDkyNDE3IEZpcmVmb3gvMy4wLjMnKQoJcmVzcG9uc2UgPSB1cmxsaWIyLnVybG9wZW4odSkKCXRyZWUgPSBFVC5wYXJzZShyZXNwb25zZSkKCXJvb3RFbGVtID0gdHJlZS5nZXRyb290KCkKCWZvciBjaGFubmVsIGluIHRyZWUuZmluZGFsbCgiY2hhbm5lbCIpOgoJCXBlYWxraXJpID0gY2hhbm5lbC5maW5kKCJ0aXRsZSIpLnRleHQKCQlwZWFsa2lyaSA9IGJhc2U2NC5iNjRkZWNvZGUocGVhbGtpcmkpCgkJcGVhbGtpcmkgPSBwZWFsa2lyaS5lbmNvZGUoInV0Zi04IikKCQlzdHJpaW1pbGluayA9IGNoYW5uZWwuZmluZCgic3RyZWFtX3VybCIpLnRleHQKCQkKCQl1cmxjaGFtYSA9IHN0cmlpbWlsaW5rLnNwbGl0KCcvJykKCQl1cmxub28gPSAnJwoJCXRyeToKCQkJdXJsbm9vID0gdXJsY2hhbWFbNV0KCQkJdXJsbm9vID0gdXJsbm9vLnJlcGxhY2UoJ3RzJywnJykKCQkJdXJsbm9vID0gdXJsbm9vLnJlcGxhY2UoJ20zdTgnLCcnKQoJCWV4Y2VwdDoKCQkJcGFzcwoJCQoJCXBpbHQgPSBjaGFubmVsLmZpbmQoImRlc2NfaW1hZ2UiKS50ZXh0IAoJCWRlc2NyaXB0ID0gY2hhbm5lbC5maW5kKCJkZXNjcmlwdGlvbiIpLnRleHQKCQlpZiBkZXNjcmlwdDoKCQkJZGVzY3JpcHQgPSBiYXNlNjQuYjY0ZGVjb2RlKGRlc2NyaXB0KQoJCWlmIHBpbHQ6CgkJCWFkZExpbmtDYW5hbExpc3RhKHBlYWxraXJpLHN0cmlpbWlsaW5rLHBpbHQsZGVzY3JpcHQsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3ZpZC5wbmcnKSwgdXJsbm9vKQoJCWVsc2U6CgkJCWFkZExpbmtDYW5hbExpc3RhKHBlYWxraXJpLHN0cmlpbWlsaW5rLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fdHYucG5nJyksZGVzY3JpcHQsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3ZpZC5wbmcnKSwgdXJsbm9vKQoJCgl4Ym1jcGx1Z2luLnNldENvbnRlbnQoaW50KHN5cy5hcmd2WzFdKSAsIm1vdmllcyIpCgl2aXN0YV9DYW5haXMoKQoKZGVmIGFkZExpbmtDYW5hbExpc3RhKHRpdGxlLCB1cmwsIHRodW1ibmFpbCwgcGxvdCwgZmFuYXJ0LCBpZGNhbmFsLCBpc1BsYXlhYmxlPVRydWUsIGZvbGRlcj1GYWxzZSk6Cglvaz1UcnVlCgljbT1bXQoJI2lmKGlkY2FuYWwgIT0gJzAwMDEnKToKCSMJY20uYXBwZW5kKCgnVmVyIHByb2dyYW1hw6fDo28nLCAnWEJNQy5SdW5QbHVnaW4oJXM/bW9kZT0zMSZuYW1lPSVzJnVybD0lcyZpY29uaW1hZ2U9JXMmaWRDYW5hbD0lcyZpZGZmQ2FuYWw9JXMpJyUoc3lzLmFyZ3ZbMF0sdXJsbGliLnF1b3RlX3BsdXModGl0bGUpLCB1cmxsaWIucXVvdGVfcGx1cyh1cmwpLCB1cmxsaWIucXVvdGVfcGx1cyh0aHVtYm5haWwpLCBpZGNhbmFsLCAnJykpKQoJCglsaXN0aXRlbT14Ym1jZ3VpLkxpc3RJdGVtKHRpdGxlLGljb25JbWFnZT10aHVtYm5haWwsdGh1bWJuYWlsSW1hZ2U9dGh1bWJuYWlsKQoJbGlzdGl0ZW0uYWRkQ29udGV4dE1lbnVJdGVtcyhjbSwgcmVwbGFjZUl0ZW1zPUZhbHNlKQoJaW5mb19sYWJlbHM9eyJUaXRsZSI6dGl0bGUsIkZpbGVOYW1lIjp0aXRsZSwiUGxvdCI6cGxvdH0KCWxpc3RpdGVtLnNldEluZm8oICJ2aWRlbyIsIGluZm9fbGFiZWxzICkKCWxpc3RpdGVtLnNldFByb3BlcnR5KCdmYW5hcnRfaW1hZ2UnLCBmYW5hcnQpCglsaXN0aXRlbS5zZXRBcnQoeydmYW5hcnQnOiBmYW5hcnR9KQoJbGlzdGl0ZW0uc2V0UHJvcGVydHkoIlZpZGVvIiwidHJ1ZSIpCgl1ID0gc3lzLmFyZ3ZbMF0gKyAiP3VybD0iICsgc3RyKHVybCkgKyAiJm1vZGU9MTAmbmFtZT0iICsgc3RyKG5hbWUpICsgIiZpY29uaW1hZ2U9IitzdHIoaWNvbmltYWdlKSsiJmZhbmFydD0iK3N0cihmYW5hcnQpKyImcGxvdD0iK3N0cihwbG90KQoJb2s9eGJtY3BsdWdpbi5hZGREaXJlY3RvcnlJdGVtKGhhbmRsZT1pbnQoc3lzLmFyZ3ZbMV0pLHVybD11LGxpc3RpdGVtPWxpc3RpdGVtLGlzRm9sZGVyPWZvbGRlcikKCXJldHVybiBvawoKZGVmIHJ1bl9jcm9uam9iKHRpdGxlLHVybCxpbWFnZSxwbG90LGZhbmFydCk6Cgl2YW5lbWFsdWtrPV9fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9hZHVsdG9zX3NpbSIpCglpZiB2YW5lbWFsdWtrID09ICJ0cnVlIjoKCQl2YW5lbWFfbHVrayhuYW1lKQoJCglpZiBwbG90ID09ICdwcm9ncmFtYXMnOgoJCXVybG4gPSAiIgoJCXRyeTogdXJsbiA9IGJhc2U2NC5iNjRkZWNvZGUodXJsKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQl1cmxjaGFtYSA9IHVybG4uc3BsaXQoJzs7OycpCgkJdXJsbm9vID0gX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvc2VhcmNodXJsLnBocD9jYW5hbD0nK3VybGNoYW1hWzBdKycmdXJsPScrdXJsY2hhbWFbMV0rJyZjbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmYWRkb249MScKCQkKCQltZW5zYWdlbXByb2dyZXNzbyA9IHhibWNndWkuRGlhbG9nUHJvZ3Jlc3MoKQoJCW1lbnNhZ2VtcHJvZ3Jlc3NvLmNyZWF0ZShBZGRvblRpdGxlLCB1J0FicmlyIGVtaXNzw6NvJywnUG9yIGZhdm9yIGFndWFyZGUuLi4nKQoJCW1lbnNhZ2VtcHJvZ3Jlc3NvLnVwZGF0ZSgyNSwgIiIsIHUnT2J0ZXIgdmlkZW8nLCAiIikKCQlyZXN1bHRhZG8xID0gZGV2b2x2ZXJlc3VsdGFkbyh1cmxub28pCgkJbWVuc2FnZW1wcm9ncmVzc28udXBkYXRlKDUwLCAiIiwgdSdQcmVwYXJhLXRlLCB2YWkgY29tZcOnYXIhJywgIiIpCgkJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8xKQoJCW1lbnNhZ2VtcHJvZ3Jlc3NvLnVwZGF0ZSg3NSwgIiIsIHUnQm9hIFNlc3PDo28hISEnLCAiIikKCQl1cmxuID0gIiIKCQlmb3IgaSBpbiByZXN1bHRhZG9bJ2luZm9ybWFjYW8nXToKCQkJdHJ5OiB1cmxuID0gYmFzZTY0LmI2NGRlY29kZShpWyd1cmwnXSkuZGVjb2RlKCd1dGYtOCcpCgkJCWV4Y2VwdDogcGFzcwoJCQkKCQltZW5zYWdlbXByb2dyZXNzby5jbG9zZSgpCgkJeGJtYy5zbGVlcCg1MDAwKQoJCXBsYXlsaXN0ID0geGJtYy5QbGF5TGlzdCh4Ym1jLlBMQVlMSVNUX1ZJREVPKQoJCXBsYXlsaXN0LmNsZWFyKCkKCQlpbmZvX2xhYmVscz17IlRpdGxlIjp0aXRsZSwiRmlsZU5hbWUiOnRpdGxlLCJQbG90IjpwbG90fQoJCWxpc3RpdGVtPXhibWNndWkuTGlzdEl0ZW0odGl0bGUsaWNvbkltYWdlPWltYWdlLHRodW1ibmFpbEltYWdlPWltYWdlKQoJCWxpc3RpdGVtLnNldEluZm8oICJ2aWRlbyIsIGluZm9fbGFiZWxzICkKCQlwbGF5bGlzdC5hZGQodXJsPXVybG4sIGxpc3RpdGVtPWxpc3RpdGVtLCBpbmRleD0xKQoJCXhibWMuUGxheWVyKCkucGxheShwbGF5bGlzdCkKCWVsc2U6CgkJcGxheWxpc3QgPSB4Ym1jLlBsYXlMaXN0KHhibWMuUExBWUxJU1RfVklERU8pCgkJcGxheWxpc3QuY2xlYXIoKQoJCWluZm9fbGFiZWxzPXsiVGl0bGUiOnRpdGxlLCJGaWxlTmFtZSI6dGl0bGUsIlBsb3QiOnBsb3R9CgkJbGlzdGl0ZW09eGJtY2d1aS5MaXN0SXRlbSh0aXRsZSxpY29uSW1hZ2U9aW1hZ2UsdGh1bWJuYWlsSW1hZ2U9aW1hZ2UpCgkJbGlzdGl0ZW0uc2V0SW5mbyggInZpZGVvIiwgaW5mb19sYWJlbHMgKQoJCXBsYXlsaXN0LmFkZCh1cmw9dXJsLCBsaXN0aXRlbT1saXN0aXRlbSwgaW5kZXg9MSkKCQl4Ym1jLlBsYXllcigpLnBsYXkocGxheWxpc3QpCgkKCmRlZiBzeW5jX2RhdGEoY2hhbm5lbCk6Cgl2aWRlbyA9IGJhc2U2NC5iNjRkZWNvZGUoY2hhbm5lbCkKCXJldHVybiB2aWRlbwoKZGVmIHJlc3RhcnRfc2VydmljZShwYXJhbXMpOgoJdmFuZW1hbHVraz1fX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fYWR1bHRvc19zaW0iKQoJaWYgdmFuZW1hbHVrayA9PSAidHJ1ZSI6CgkJcGVhbGtpcmkgPSBwYXJhbXMuZ2V0KHN5bmNfZGF0YSgiZEdsMGJHVT0iKSkKCQl2YW5lbWFfbHVrayhwZWFsa2lyaSkKCWxvcHBsaW5rID0gcGFyYW1zLmdldCh2b2RfY2hhbm5lbHMoImRYSnMiKSkKCQoJeGJtY3BsdWdpbi5zZXRSZXNvbHZlZFVybChpbnQoc3lzLmFyZ3ZbMV0pLCBUcnVlLCBsaXN0aXRlbSkKCmRlZiBncmFiX2VwZyh1cmwpOgoJcmVxID0gdXJsbGliMi5SZXF1ZXN0KHVybCkKCXJlcS5hZGRfaGVhZGVyKHN5bmNfZGF0YSgiVlhObGNpMUJaMlZ1ZEE9PSIpICwgdm9kX2NoYW5uZWxzKCJTMjlrYVNCd2JIVm5hVzRnWW5rZ1RHbDJaU0YwIikpCglyZXNwb25zZSA9IHVybGxpYjIudXJsb3BlbihyZXEpCglsaW5rPXJlc3BvbnNlLnJlYWQoKQoJamRhdGEgPSBqc29uLmxvYWRzKGxpbmsuZGVjb2RlKCd1dGY4JykpCglyZXNwb25zZS5jbG9zZSgpCglpZiBqZGF0YToKCQlyZXR1cm4gamRhdGEKCmRlZiBncmFiX2VwZzIodXJsKToKCXJlcSA9IHVybGxpYjIuUmVxdWVzdCh1cmwpCglyZXEuYWRkX2hlYWRlcignVXNlci1hZ2VudCcsICdNb3ppbGxhLzUuMCAoV2luZG93czsgVTsgV2luZG93cyBOVCA1LjE7IGVuLUdCOyBydjoxLjkuMC4zKSBHZWNrby8yMDA4MDkyNDE3IEZpcmVmb3gvMy4wLjMnKQoJcmVxLmFkZF9oZWFkZXIoc3luY19kYXRhKCJWWE5sY2kxQloyVnVkQT09IikgLCB2b2RfY2hhbm5lbHMoIlMyOWthU0J3YkhWbmFXNGdZbmtnVEdsMlpTRjAiKSkKCXJlc3BvbnNlID0gdXJsbGliMi51cmxvcGVuKHJlcSkKCWxpbms9cmVzcG9uc2UucmVhZCgpCglpZiBsaW5rICE9ICd7InVzZXJfaW5mbyI6eyJhdXRoIjowfX0nOgoJCWpkYXRhID0ganNvbi5sb2FkcyhsaW5rLmRlY29kZSgndXRmOCcpKQoJCXJlc3BvbnNlLmNsb3NlKCkKCQlpZiBqZGF0YToKCQkJcmV0dXJuIGpkYXRhCgllbHNlOgoJCXJldHVybiBOb25lCgkKZGVmIGtvbnRyb2xsKHVybCk6CglyYW5kb21zdHJpbmcgPSBncmFiX2VwZyh1cmwpCglrYXN1dGFqYWluZm8gPSByYW5kb21zdHJpbmdbc3luY19kYXRhKCJkWE5sY2w5cGJtWnYiKV0KCWtvbnRyb2xsID0ga2FzdXRhamFpbmZvW2dldF9saXZlKCJZWFYwYUE9PSIpXQoJcmV0dXJuIGtvbnRyb2xsCmRlZiBnZXRfbGl2ZShjaGFubmVsKToKCXZpZGVvID0gYmFzZTY0LmI2NGRlY29kZShjaGFubmVsKQoJcmV0dXJuIHZpZGVvCmRlZiBleGVjdXRlX2FpbmZvKHVybCk6CglhbmRtZWQgPSBncmFiX2VwZyh1cmwpCglrYXN1dGFqYUFuZG1lZCA9IGFuZG1lZFtzeW5jX2RhdGEoImRYTmxjbDlwYm1adiIpXQoJc2VpcyA9IGthc3V0YWphQW5kbWVkW2dldF9saXZlKCJjM1JoZEhWeiIpXQoJYWVndWIgPSBrYXN1dGFqYUFuZG1lZFtzeW5jX2RhdGEoIlpYaHdYMlJoZEdVPSIpXQoJaWYgYWVndWI6CgkJYWVndWIgPSBkYXRldGltZS5kYXRldGltZS5mcm9tdGltZXN0YW1wKGludChhZWd1YikpLnN0cmZ0aW1lKCclSDolTSAlZC4lbS4lWScpCgllbHNlOgoJCWFlZ3ViID0gdm9kX2NoYW5uZWxzKCJUbVYyWlhJPSIpIAoJcmFiYml0cyA9IGthc3V0YWphQW5kbWVkW3ZvZF9jaGFubmVscygiYVhOZmRISnBZV3c9IildCglpZiByYWJiaXRzID09ICIwIjoKCQlyYWJiaXRzID0gc3luY19kYXRhKCJUbTg9IikKCWVsc2U6CgkJcmFiYml0cyA9IHN5bmNfZGF0YSgiV1dWeiIpCglsZWF2ZW1lYWxvbmUgPSBrYXN1dGFqYUFuZG1lZFtnZXRfbGl2ZSgiYldGNFgyTnZibTVsWTNScGIyNXoiKV0KCXBvbGFyYmVhcnMgPSBrYXN1dGFqYUFuZG1lZFtzeW5jX2RhdGEoImRYTmxjbTVoYldVPSIpXQoJCglhZGRMaW5rQ2FuYWxMaXN0YSgiW0NPTE9SID0gd2hpdGVdVXRpbGl6YWRvcjogWy9DT0xPUl0iK3BvbGFyYmVhcnMsIiIsIiIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb19jb24ucG5nJyksb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2Nvbi5wbmcnKSwnJykKCQoJYWRkTGlua0NhbmFsTGlzdGEoIltDT0xPUiA9IHdoaXRlXUVzdGFkbzogWy9DT0xPUl0iK3NlaXMsIiIsIiIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb19jb24ucG5nJyksb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2Nvbi5wbmcnKSwnJykKCQoJYWRkTGlua0NhbmFsTGlzdGEoIltDT0xPUiA9IHdoaXRlXUV4cGlyYTogWy9DT0xPUl0iK2FlZ3ViLCIiLCIiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fY29uLnBuZycpLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19jb24ucG5nJyksJycpCgkKCWFkZExpbmtDYW5hbExpc3RhKCJbQ09MT1IgPSB3aGl0ZV1Db250YSBkZSBUZXN0ZTogWy9DT0xPUl0iK3JhYmJpdHMsIiIsIiIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb19jb24ucG5nJyksb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2Nvbi5wbmcnKSwnJykKCQoJYWRkTGlua0NhbmFsTGlzdGEoIltDT0xPUiA9IHdoaXRlXU1heGltbyBkZSBDb25uZWM6IFsvQ09MT1JdIitsZWF2ZW1lYWxvbmUsIiIsIiIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb19jb24ucG5nJyksb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2Nvbi5wbmcnKSwnJykKCQoJdmlzdGFfR3J1cG9zKCkKCmRlZiB2YW5lbWFfbHVrayhuYW1lKToKCWEgPSAnWFhYJywgJ0FkdWx0JywgJ0FkdWx0cycsJ0FEVUxUJywnQURVTFRTJywnYWR1bHQnLCdhZHVsdHMnLCdQb3JuJywnUE9STicsJ3Bvcm4nLCdQb3JuJywneHh4JwoJaWYgYW55KHMgaW4gbmFtZSBmb3IgcyBpbiBhKToKCQl4Ym1jLmV4ZWN1dGVidWlsdGluKCh1J1hCTUMuTm90aWZpY2F0aW9uKCJDb250cm9sbyBQYXJlbnRhbCIsICJPIGNhbmFsIGNvbnRlbSBjb250ZXVkbyBhZHVsdG8iLCAyMDAwKScpKQoJCXRleHQgPSBwbHVnaW50b29scy5rZXlib2FyZF9pbnB1dChkZWZhdWx0X3RleHQ9IiIsIHRpdGxlPSJDb2RpZ28gcGFyYSBjb250cm9sbyBwYXJlbnRhbCIpCgkJaWYgdGV4dD09cGx1Z2ludG9vbHMuZ2V0X3NldHRpbmcoc3luY19kYXRhKCJiRzluYVc1ZllXUjFiSFJ2Y3c9PSIpKToKCQkgIHJldHVybgoJCWVsc2U6CgkJICBleGl0KCkKCWVsc2U6CgkJbmFtZSA9ICIiCgpkZWYgRG93bmxvYWRlckNsYXNzKHVybCxkZXN0KToKCWRwID0geGJtY2d1aS5EaWFsb2dQcm9ncmVzcygpCglkcC5jcmVhdGUoc3luY19kYXRhKCJSMlYwZEdsdVp5QjFjR1JoZEdVPSIpLGdldF9saXZlKCJSRzkzYm14dllXUnBibWM9IikpCgl1cmxsaWIudXJscmV0cmlldmUodXJsLGRlc3QsbGFtYmRhIG5iLCBicywgZnMsIHVybD11cmw6IF9wYmhvb2sobmIsYnMsZnMsdXJsLGRwKSkKCmRlZiBfcGJob29rKG51bWJsb2NrcywgYmxvY2tzaXplLCBmaWxlc2l6ZSwgdXJsPU5vbmUsZHA9Tm9uZSk6Cgl0cnk6CgkJcGVyY2VudCA9IG1pbigobnVtYmxvY2tzKmJsb2Nrc2l6ZSoxMDApL2ZpbGVzaXplLCAxMDApCgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnJytwZXJjZW50KQoJCWRwLnVwZGF0ZShwZXJjZW50KQoJZXhjZXB0OgoJCXBlcmNlbnQgPSAxMDAKCQlkcC51cGRhdGUocGVyY2VudCkKCWlmIGRwLmlzY2FuY2VsZWQoKToKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdPIGRvd25sb2FkIGZvaSBjYW5jZWxhZG8uJykKCQlkcC5jbG9zZSgpCgpkZWYgdm9kX2NoYW5uZWxzKGNoYW5uZWwpOgoJdmlkZW8gPSBiYXNlNjQuYjY0ZGVjb2RlKGNoYW5uZWwpCglyZXR1cm4gdmlkZW8KCmRlZiBQbGF5VXJsKG5hbWUsIHVybCwgaWNvbmltYWdlPU5vbmUpOgoJbGlzdGl0ZW0gPSB4Ym1jZ3VpLkxpc3RJdGVtKHBhdGg9dXJsLCB0aHVtYm5haWxJbWFnZT1pY29uaW1hZ2UpCglsaXN0aXRlbS5zZXRJbmZvKHR5cGU9IlZpZGVvIiwgaW5mb0xhYmVscz17ICJUaXRsZSI6IG5hbWUgfSkKCXhibWNwbHVnaW4uc2V0UmVzb2x2ZWRVcmwoaW50KHN5cy5hcmd2WzFdKSwgVHJ1ZSwgbGlzdGl0ZW0pCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwkJCQkJCQkJCQkJCQlNZW51IFRWIEFycXVpdm8JCQkJCQkJCQkJCSAjCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZGVmIGxpc3RhdHZhcmNoaXZlKHVybCk6CgllbmRlcmVjbyA9IHVybCsicGxheWVyX2FwaS5waHA/dXNlcm5hbWU9IitfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fbmFtZScpKyImcGFzc3dvcmQ9IitfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fcGFzc3dvcmQnKSsiJmFjdGlvbj1nZXRfbGl2ZV9zdHJlYW1zIgoJI2lJaUlJSWkgPSB1cmxsaWIyLnVybG9wZW4oZW5kZXJlY28pCgkjb29vMDBPT09vb08JPSBqc29uLmxvYWQoaUlpSUlJaSkKCXJlcSA9IHVybGxpYjIuUmVxdWVzdChlbmRlcmVjbykKCXJlcS5hZGRfaGVhZGVyKHN5bmNfZGF0YSgiVlhObGNpMUJaMlZ1ZEE9PSIpICwgdm9kX2NoYW5uZWxzKCJTMjlrYVNCd2JIVm5hVzRnWW5rZ1RHbDJaU0YwIikpCglyZXNwb25zZSA9IHVybGxpYjIudXJsb3BlbihyZXEpCglsaW5rPXJlc3BvbnNlLnJlYWQoKQoJb29vMDBPT09vb08JPSBqc29uLmxvYWRzKGxpbmsuZGVjb2RlKCd1dGY4JykpCglyZXNwb25zZS5jbG9zZSgpCglPMDBPT09vT29vME8gPSBvb28wME9PT29vT1snYXZhaWxhYmxlX2NoYW5uZWxzJ10KCWZvcglPMDAwT09vMDBvbwlpbglPMDBPT09vT29vME8udmFsdWVzKCk6CgkJb28wT09vID0gTzAwME9PbzAwb29bJ3R2X2FyY2hpdmUnXQoJCWlmKG9vME9PbyA9PSAxKToKCQkJbmFtZXR2PU8wMDBPT28wMG9vWyduYW1lJ10KCQkJc3RyZWFtX2lkPU8wMDBPT28wMG9vWydzdHJlYW1faWQnXQoJCQlsb2dvX3R2PU8wMDBPT28wMG9vWydzdHJlYW1faWNvbiddCgkJCWR1cmF0aW9uID0gTzAwME9PbzAwb29bJ3R2X2FyY2hpdmVfZHVyYXRpb24nXQoJCQkKCQkJYWRkTGlua0dydXBvKG5hbWV0dixsb2dvX3R2LHN0cmVhbV9pZCx1cmwsZHVyYXRpb24sb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3R2X2FyYy5wbmcnKSwxKQoJCgl2aXN0YV9HcnVwb3MoKQoKZGVmIGxpc3RhdHZhcmNoaXZlY2FuYWlzKG5hbWUsc3RyZWFtX2lkLHVybCxkdXJhdGlvbixpY29uaW1hZ2UsZmFuYXJ0KToKCWVuZGVyZWNvID0gdXJsKyJwbGF5ZXJfYXBpLnBocD91c2VybmFtZT0iK19fQURET05fXy5nZXRTZXR0aW5nKCdsb2dpbl9uYW1lJykrIiZwYXNzd29yZD0iK19fQURET05fXy5nZXRTZXR0aW5nKCdsb2dpbl9wYXNzd29yZCcpKyImYWN0aW9uPWdldF9lcGcmc3RyZWFtX2lkPSIrc3RyZWFtX2lkCgkjaUlpSUlJaSA9IHVybGxpYjIudXJsb3BlbihlbmRlcmVjbykKCSNpaWlJMTEJPSBqc29uLmxvYWQoaUlpSUlJaSkKCXJlcSA9IHVybGxpYjIuUmVxdWVzdChlbmRlcmVjbykKCXJlcS5hZGRfaGVhZGVyKHN5bmNfZGF0YSgiVlhObGNpMUJaMlZ1ZEE9PSIpICwgdm9kX2NoYW5uZWxzKCJTMjlrYVNCd2JIVm5hVzRnWW5rZ1RHbDJaU0YwIikpCglyZXNwb25zZSA9IHVybGxpYjIudXJsb3BlbihyZXEpCglsaW5rPXJlc3BvbnNlLnJlYWQoKQoJaWlpSTExCT0ganNvbi5sb2FkcyhsaW5rLmRlY29kZSgndXRmOCcpKQoJcmVzcG9uc2UuY2xvc2UoKQoJCglpaUlpSSA9IGRhdGV0aW1lLmRhdGV0aW1lLnV0Y25vdygpIC0gZGF0ZXRpbWUudGltZWRlbHRhKGRheXM9aW50KGR1cmF0aW9uKSkKCW8wMG9vb08wT28JPWNhbGVuZGFyLnRpbWVnbShpaUlpSS50aW1ldHVwbGUoKSkKCW8wMG9vb08wT28JPWludChvMDBvb29PME9vKQoJbzBPME9PTzBPb28JPXRpbWUudGltZSgpCglvME8wT09PME9vbwk9aW50KG8wTzBPT08wT29vKQoJCglmb3IJaWlJaUlJMQlpbglpaWlJMTEJOgoJCXRpdGxlX3R2ID0gaWlJaUlJMVsndGl0bGUnXQoJCXRpdGxlX3R2PWJhc2U2NC5iNjRkZWNvZGUodGl0bGVfdHYpCgkJc3RhcnQJPSBpbnQoaWlJaUlJMVsnc3RhcnQnXSkKCQllbmQJPSBpbnQoaWlJaUlJMVsnZW5kJ10pCgkJc2VndW5kbyA9IDAuMDE2NjY2NjY2NwoJCQoJCWR1cmFjYW8gPSBpbnQoKGVuZC1zdGFydCkqc2VndW5kbykKCQkKCQlpZihzdGFydCA+IG8wMG9vb08wT28gYW5kIHN0YXJ0IDwgbzBPME9PTzBPb28pOgoJCQlpZiA5MCAtIDkwOglPb28wCSUJT28wb29PMG9vMG9PCS8JT28wb08wb29vCgkJCUlJaSA9IGRhdGV0aW1lLmRhdGV0aW1lLmZyb210aW1lc3RhbXAoaW50KHN0YXJ0KSkuc3RyZnRpbWUoJyVkLiVtICVIOiVNJykKCQkJaTFJaWkxaTFJID0gZGF0ZXRpbWUuZGF0ZXRpbWUuZnJvbXRpbWVzdGFtcChpbnQoc3RhcnQpKS5zdHJmdGltZSgnJVktJW0tJWQ6JUg6JU0nKQoJCQl0aXRsZV90diA9IElJaSArICIgIiArIHRpdGxlX3R2CgkJCWVuZGVyZWNvID0gdXJsKyJzdHJlYW1pbmcvdGltZXNoaWZ0LnBocD91c2VybmFtZT0iK19fQURET05fXy5nZXRTZXR0aW5nKCdsb2dpbl9uYW1lJykrIiZwYXNzd29yZD0iK19fQURET05fXy5nZXRTZXR0aW5nKCdsb2dpbl9wYXNzd29yZCcpKyImc3RyZWFtPSIrc3RyZWFtX2lkKyImc3RhcnQ9IitpMUlpaTFpMUkrIiZkdXJhdGlvbj0iK3N0cihkdXJhY2FvKQoJCQkKCQkJYWRkTGlua0NhbmFsKHRpdGxlX3R2LGVuZGVyZWNvLGljb25pbWFnZSwnMDAwMScsJycpCgkKCXZpc3RhX0NhbmFpcygpCgpkZWYgYWRkTGlua0dydXBvKHRpdGxlLHRodW1ibmFpbCxzdHJlYW1faWQsdXJsLGR1cmF0aW9uLGZhbmFydCx0eXBlKToKCW9rPVRydWUKCQoJbGlzdGl0ZW09eGJtY2d1aS5MaXN0SXRlbSh0aXRsZSxpY29uSW1hZ2U9dGh1bWJuYWlsLHRodW1ibmFpbEltYWdlPXRodW1ibmFpbCkKCWluZm9fbGFiZWxzPXsiVGl0bGUiOnRpdGxlLCJGaWxlTmFtZSI6dGl0bGV9CglsaXN0aXRlbS5zZXRJbmZvKCAidmlkZW8iLCBpbmZvX2xhYmVscyApCglsaXN0aXRlbS5zZXRQcm9wZXJ0eSgnZmFuYXJ0X2ltYWdlJyxmYW5hcnQpCgl4Ym1jcGx1Z2luLnNldFBsdWdpbkZhbmFydChpbnQoc3lzLmFyZ3ZbMV0pLGZhbmFydCkKCQoJdSA9IHN5cy5hcmd2WzBdICsgIj91cmw9IiArIHN0cih1cmwpICsgIiZtb2RlPTcmbmFtZT0iICsgc3RyKHRpdGxlKSArICImaWNvbmltYWdlPSIrc3RyKHRodW1ibmFpbCkrIiZmYW5hcnQ9IitzdHIoZmFuYXJ0KSsiJnN0cmVhbV9pZD0iK3N0cihzdHJlYW1faWQpKyImZHVyYXRpb249IitkdXJhdGlvbgoJCglvaz14Ym1jcGx1Z2luLmFkZERpcmVjdG9yeUl0ZW0oaGFuZGxlPWludChzeXMuYXJndlsxXSksdXJsPXUsbGlzdGl0ZW09bGlzdGl0ZW0saXNGb2xkZXI9VHJ1ZSkKCQoJcmV0dXJuIG9rCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwkJCQkJCQkJCQkJCQlBYnJpciBTZXR0aW5nCQkJCQkJCQkJCSAjCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZGVmIGFicmlyRGVmaW5pbmNvZXMoKToKCV9fQURET05fXy5vcGVuU2V0dGluZ3MoKQoJdmlzdGFfbWVudSgpCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIyMJCUNsZWFyIENhY2hlCQkjIyMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCmRlZiBDTEVBUkNBQ0hFKCk6Cgl4Ym1jX2NhY2hlX3BhdGggPSBvcy5wYXRoLmpvaW4oeGJtYy50cmFuc2xhdGVQYXRoKCdzcGVjaWFsOi8vaG9tZScpLCAnY2FjaGUnKQoJaWYgb3MucGF0aC5leGlzdHMoeGJtY19jYWNoZV9wYXRoKT09VHJ1ZToJCgkJZm9yIHJvb3QsIGRpcnMsIGZpbGVzIGluIG9zLndhbGsoeGJtY19jYWNoZV9wYXRoKToKCQkJZmlsZV9jb3VudCA9IDAKCQkJZmlsZV9jb3VudCArPSBsZW4oZmlsZXMpCgkJCWlmIGZpbGVfY291bnQgPiAwOgoJCgkJCQlkaWFsb2cgPSB4Ym1jZ3VpLkRpYWxvZygpCgkJCQlpZiBkaWFsb2cueWVzbm8oIkFwYWdhciBDYWNoZSBubyBYQk1DLiIsIHN0cihmaWxlX2NvdW50KSArICIgZmljaGVpcm9zIGVuY29udHJhZG9zLiIsICJRdWVyIGFwYWdhciB0b2RvcyBvcyBmaWNoZWlyb3MgZW0gY2FjaGU/Iik6CgkJCQkKCQkJCQlmb3IgZiBpbiBmaWxlczoKCQkJCQkJdHJ5OgoJCQkJCQkJb3MudW5saW5rKG9zLnBhdGguam9pbihyb290LCBmKSkKCQkJCQkJZXhjZXB0OgoJCQkJCQkJcGFzcwoJCQkJCWZvciBkIGluIGRpcnM6CgkJCQkJCXRyeToKCQkJCQkJCXNodXRpbC5ybXRyZWUob3MucGF0aC5qb2luKHJvb3QsIGQpKQoJCQkJCQlleGNlcHQ6CgkJCQkJCQlwYXNzCgkJCQkJCQoJCQllbHNlOgoJCQkJcGFzcwoJaWYgeGJtYy5nZXRDb25kVmlzaWJpbGl0eSgnc3lzdGVtLnBsYXRmb3JtLkFUVjInKToKCQlhdHYyX2NhY2hlX2EgPSBvcy5wYXRoLmpvaW4oJy9wcml2YXRlL3Zhci9tb2JpbGUvTGlicmFyeS9DYWNoZXMvQXBwbGVUVi9WaWRlby8nLCAnT3RoZXInKQoJCQoJCWZvciByb290LCBkaXJzLCBmaWxlcyBpbiBvcy53YWxrKGF0djJfY2FjaGVfYSk6CgkJCWZpbGVfY291bnQgPSAwCgkJCWZpbGVfY291bnQgKz0gbGVuKGZpbGVzKQoJCQoJCQlpZiBmaWxlX2NvdW50ID4gMDoKCgkJCQlkaWFsb2cgPSB4Ym1jZ3VpLkRpYWxvZygpCgkJCQlpZiBkaWFsb2cueWVzbm8oIkFwYWdhciBmaWNoZWlyb3MgQVRWMi4iLCBzdHIoZmlsZV9jb3VudCkgKyAiIGZpY2hlaXJvcyBlbmNvbnRyYWRvcyBlbSAnT3V0cm9zJyIsICJRdWVyIGFwYWdhciB0b2RvcyBvcyBmaWNoZWlyb3MgZW0gY2FjaGU/Iik6CgkJCQkKCQkJCQlmb3IgZiBpbiBmaWxlczoKCQkJCQkJb3MudW5saW5rKG9zLnBhdGguam9pbihyb290LCBmKSkKCQkJCQlmb3IgZCBpbiBkaXJzOgoJCQkJCQlzaHV0aWwucm10cmVlKG9zLnBhdGguam9pbihyb290LCBkKSkKCQkJCQkJCgkJCWVsc2U6CgkJCQlwYXNzCgkJYXR2Ml9jYWNoZV9iID0gb3MucGF0aC5qb2luKCcvcHJpdmF0ZS92YXIvbW9iaWxlL0xpYnJhcnkvQ2FjaGVzL0FwcGxlVFYvVmlkZW8vJywgJ0xvY2FsQW5kUmVudGFsJykKCQkKCQlmb3Igcm9vdCwgZGlycywgZmlsZXMgaW4gb3Mud2FsayhhdHYyX2NhY2hlX2IpOgoJCQlmaWxlX2NvdW50ID0gMAoJCQlmaWxlX2NvdW50ICs9IGxlbihmaWxlcykKCQkKCQkJaWYgZmlsZV9jb3VudCA+IDA6CgoJCQkJZGlhbG9nID0geGJtY2d1aS5EaWFsb2coKQoJCQkJaWYgZGlhbG9nLnllc25vKCJBcGFnYXIgZmljaGVpcm9zIEFUVjIuIiwgc3RyKGZpbGVfY291bnQpICsgIiBmaWNoZWlyb3MgZW5jb250cmFkb3MgZW0gJ0xvY2FsJyIsICJRdWVyIGFwYWdhciB0b2RvcyBvcyBmaWNoZWlyb3MgZW0gY2FjaGU/Iik6CgkJCQkKCQkJCQlmb3IgZiBpbiBmaWxlczoKCQkJCQkJb3MudW5saW5rKG9zLnBhdGguam9pbihyb290LCBmKSkKCQkJCQlmb3IgZCBpbiBkaXJzOgoJCQkJCQlzaHV0aWwucm10cmVlKG9zLnBhdGguam9pbihyb290LCBkKSkKCQkJCQkJCgkJCWVsc2U6CgkJCQlwYXNzCgkJCSAgIyBTZXQgcGF0aCB0byBDeWRpYSBBcmNoaXZlcyBjYWNoZSBmaWxlcwoJCQkJCQkJIAoKCSMgU2V0IHBhdGggdG8gV2hhdCB0aCBGdXJrIGNhY2hlIGZpbGVzCgl3dGZfY2FjaGVfcGF0aCA9IG9zLnBhdGguam9pbih4Ym1jLnRyYW5zbGF0ZVBhdGgoJ3NwZWNpYWw6Ly9wcm9maWxlL2FkZG9uX2RhdGEvcGx1Z2luLnZpZGVvLndoYXR0aGVmdXJrL2NhY2hlJyksICcnKQoJaWYgb3MucGF0aC5leGlzdHMod3RmX2NhY2hlX3BhdGgpPT1UcnVlOgkKCQlmb3Igcm9vdCwgZGlycywgZmlsZXMgaW4gb3Mud2Fsayh3dGZfY2FjaGVfcGF0aCk6CgkJCWZpbGVfY291bnQgPSAwCgkJCWZpbGVfY291bnQgKz0gbGVuKGZpbGVzKQoJCQoJCSMgQ291bnQgZmlsZXMgYW5kIGdpdmUgb3B0aW9uIHRvIGRlbGV0ZQoJCQlpZiBmaWxlX2NvdW50ID4gMDoKCQoJCQkJZGlhbG9nID0geGJtY2d1aS5EaWFsb2coKQoJCQkJaWYgZGlhbG9nLnllc25vKCJBcGFnYXIgYSBjYWNoZSBXVEYuIiwgc3RyKGZpbGVfY291bnQpICsgIiBmaWNoZWlyb3MgZW5jb250cmFkb3MuIiwgIlF1ZXIgYXBhZ2FyIHRvZG9zIG9zIGZpY2hlaXJvcyBlbSBjYWNoZT8iKToKCQkJCQoJCQkJCWZvciBmIGluIGZpbGVzOgoJCQkJCQlvcy51bmxpbmsob3MucGF0aC5qb2luKHJvb3QsIGYpKQoJCQkJCWZvciBkIGluIGRpcnM6CgkJCQkJCXNodXRpbC5ybXRyZWUob3MucGF0aC5qb2luKHJvb3QsIGQpKQoJCQkJCQkKCQkJZWxzZToKCQkJCXBhc3MKCQkJCQoJCQkJIyBTZXQgcGF0aCB0byA0b0QgY2FjaGUgZmlsZXMKCWNoYW5uZWw0X2NhY2hlX3BhdGg9IG9zLnBhdGguam9pbih4Ym1jLnRyYW5zbGF0ZVBhdGgoJ3NwZWNpYWw6Ly9wcm9maWxlL2FkZG9uX2RhdGEvcGx1Z2luLnZpZGVvLjRvZC9jYWNoZScpLCAnJykKCWlmIG9zLnBhdGguZXhpc3RzKGNoYW5uZWw0X2NhY2hlX3BhdGgpPT1UcnVlOgkKCQlmb3Igcm9vdCwgZGlycywgZmlsZXMgaW4gb3Mud2FsayhjaGFubmVsNF9jYWNoZV9wYXRoKToKCQkJZmlsZV9jb3VudCA9IDAKCQkJZmlsZV9jb3VudCArPSBsZW4oZmlsZXMpCgkJCgkJIyBDb3VudCBmaWxlcyBhbmQgZ2l2ZSBvcHRpb24gdG8gZGVsZXRlCgkJCWlmIGZpbGVfY291bnQgPiAwOgoJCgkJCQlkaWFsb2cgPSB4Ym1jZ3VpLkRpYWxvZygpCgkJCQlpZiBkaWFsb2cueWVzbm8oIkFwYWdhciBmaWNoZWlyb3MgNG9EIGVtIGNhY2hlLiIsIHN0cihmaWxlX2NvdW50KSArICIgZmljaGVpcm9zIGVuY29udHJhZG9zLiIsICJRdWVyIGFwYWdhciB0b2RvcyBvcyBmaWNoZWlyb3MgZW0gY2FjaGU/Iik6CgkJCQkKCQkJCQlmb3IgZiBpbiBmaWxlczoKCQkJCQkJb3MudW5saW5rKG9zLnBhdGguam9pbihyb290LCBmKSkKCQkJCQlmb3IgZCBpbiBkaXJzOgoJCQkJCQlzaHV0aWwucm10cmVlKG9zLnBhdGguam9pbihyb290LCBkKSkKCQkJCQkJCgkJCWVsc2U6CgkJCQlwYXNzCgkJCQkKCQkJCSMgU2V0IHBhdGggdG8gQkJDIGlQbGF5ZXIgY2FjaGUgZmlsZXMKCWlwbGF5ZXJfY2FjaGVfcGF0aD0gb3MucGF0aC5qb2luKHhibWMudHJhbnNsYXRlUGF0aCgnc3BlY2lhbDovL3Byb2ZpbGUvYWRkb25fZGF0YS9wbHVnaW4udmlkZW8uaXBsYXllci9pcGxheWVyX2h0dHBfY2FjaGUnKSwgJycpCglpZiBvcy5wYXRoLmV4aXN0cyhpcGxheWVyX2NhY2hlX3BhdGgpPT1UcnVlOgkKCQlmb3Igcm9vdCwgZGlycywgZmlsZXMgaW4gb3Mud2FsayhpcGxheWVyX2NhY2hlX3BhdGgpOgoJCQlmaWxlX2NvdW50ID0gMAoJCQlmaWxlX2NvdW50ICs9IGxlbihmaWxlcykKCQkKCQkjIENvdW50IGZpbGVzIGFuZCBnaXZlIG9wdGlvbiB0byBkZWxldGUKCQkJaWYgZmlsZV9jb3VudCA+IDA6CgkKCQkJCWRpYWxvZyA9IHhibWNndWkuRGlhbG9nKCkKCQkJCWlmIGRpYWxvZy55ZXNubygiQXBhZ2FyIGZpY2hlaXJvcyBCQkMgaVBsYXllciBlbSBjYWNoZS4iLCBzdHIoZmlsZV9jb3VudCkgKyAiIGZpY2hlaXJvcyBlbmNvbnRyYWRvcy4iLCAiUXVlciBhcGFnYXIgdG9kb3Mgb3MgZmljaGVpcm9zIGVtIGNhY2hlPyIpOgoJCQkJCgkJCQkJZm9yIGYgaW4gZmlsZXM6CgkJCQkJCW9zLnVubGluayhvcy5wYXRoLmpvaW4ocm9vdCwgZikpCgkJCQkJZm9yIGQgaW4gZGlyczoKCQkJCQkJc2h1dGlsLnJtdHJlZShvcy5wYXRoLmpvaW4ocm9vdCwgZCkpCgkJCQkJCQoJCQllbHNlOgoJCQkJcGFzcwoJCQkJCgkJCQkKCQkJCSMgU2V0IHBhdGggdG8gU2ltcGxlIERvd25sb2FkZXIgY2FjaGUgZmlsZXMKCWRvd25sb2FkZXJfY2FjaGVfcGF0aCA9IG9zLnBhdGguam9pbih4Ym1jLnRyYW5zbGF0ZVBhdGgoJ3NwZWNpYWw6Ly9wcm9maWxlL2FkZG9uX2RhdGEvc2NyaXB0Lm1vZHVsZS5zaW1wbGUuZG93bmxvYWRlcicpLCAnJykKCWlmIG9zLnBhdGguZXhpc3RzKGRvd25sb2FkZXJfY2FjaGVfcGF0aCk9PVRydWU6CQoJCWZvciByb290LCBkaXJzLCBmaWxlcyBpbiBvcy53YWxrKGRvd25sb2FkZXJfY2FjaGVfcGF0aCk6CgkJCWZpbGVfY291bnQgPSAwCgkJCWZpbGVfY291bnQgKz0gbGVuKGZpbGVzKQoJCQoJCSMgQ291bnQgZmlsZXMgYW5kIGdpdmUgb3B0aW9uIHRvIGRlbGV0ZQoJCQlpZiBmaWxlX2NvdW50ID4gMDoKCQoJCQkJZGlhbG9nID0geGJtY2d1aS5EaWFsb2coKQoJCQkJaWYgZGlhbG9nLnllc25vKCJBcGFnYXIgZmljaGVpcm9zIFNpbXBsZSBEb3dubG9hZGVyIGVtIGNhY2hlLiIsIHN0cihmaWxlX2NvdW50KSArICIgZmljaGVpcm9zIGVuY29udHJhZG9zLiIsICJRdWVyIGFwYWdhciB0b2RvcyBvcyBmaWNoZWlyb3MgZW0gY2FjaGU/Iik6CgkJCQkKCQkJCQlmb3IgZiBpbiBmaWxlczoKCQkJCQkJb3MudW5saW5rKG9zLnBhdGguam9pbihyb290LCBmKSkKCQkJCQlmb3IgZCBpbiBkaXJzOgoJCQkJCQlzaHV0aWwucm10cmVlKG9zLnBhdGguam9pbihyb290LCBkKSkKCQkJCQkJCgkJCWVsc2U6CgkJCQlwYXNzCgkKCWl0dl9jYWNoZV9wYXRoID0gb3MucGF0aC5qb2luKHhibWMudHJhbnNsYXRlUGF0aCgnc3BlY2lhbDovL3Byb2ZpbGUvYWRkb25fZGF0YS9wbHVnaW4udmlkZW8uaXR2L0ltYWdlcycpLCAnJykKCWlmIG9zLnBhdGguZXhpc3RzKGl0dl9jYWNoZV9wYXRoKT09VHJ1ZToJCgkJZm9yIHJvb3QsIGRpcnMsIGZpbGVzIGluIG9zLndhbGsoaXR2X2NhY2hlX3BhdGgpOgoJCQlmaWxlX2NvdW50ID0gMAoJCQlmaWxlX2NvdW50ICs9IGxlbihmaWxlcykKCQkJCgkJCWlmIGZpbGVfY291bnQgPiAwOgoJCgkJCQlkaWFsb2cgPSB4Ym1jZ3VpLkRpYWxvZygpCgkJCQlpZiBkaWFsb2cueWVzbm8oIkFwYWdhciBpdGVtcyBlbSBjYWNoZSIsIHN0cihmaWxlX2NvdW50KSArICIgZmljaGVpcm9zIGVuY29udHJhZG9zLiIsICJRdWVyIGFwYWdhciB0b2RvcyBvcyBmaWNoZWlyb3MgZW0gY2FjaGU/Iik6CgkJCQkKCQkJCQlmb3IgZiBpbiBmaWxlczoKCQkJCQkJb3MudW5saW5rKG9zLnBhdGguam9pbihyb290LCBmKSkKCQkJCQlmb3IgZCBpbiBkaXJzOgoJCQkJCQlzaHV0aWwucm10cmVlKG9zLnBhdGguam9pbihyb290LCBkKSkKCQkJCQkJCgkJCWVsc2U6CgkJCQlwYXNzCglkaWFsb2cgPSB4Ym1jZ3VpLkRpYWxvZygpCglkaWFsb2cub2soQWRkb25UaXRsZSwgIgkJQ2FjaGUgYXBhZ2FkYSBjb20gc3VjZXNzbyEiKQoKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMjIwkgUHVyZ2UgUGFja2FnZXMJCSMjIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZGVmIFBVUkdFUEFDS0FHRVMoKToKCXBhY2thZ2VzX2NhY2hlX3BhdGggPSB4Ym1jLnRyYW5zbGF0ZVBhdGgob3MucGF0aC5qb2luKCdzcGVjaWFsOi8vaG9tZS9hZGRvbnMvcGFja2FnZXMnLCAnJykpCgl0cnk6CQoJCWZvciByb290LCBkaXJzLCBmaWxlcyBpbiBvcy53YWxrKHBhY2thZ2VzX2NhY2hlX3BhdGgpOgoJCQlmaWxlX2NvdW50ID0gMAoJCQlmaWxlX2NvdW50ICs9IGxlbihmaWxlcykKCQkJCgkJCWlmIGZpbGVfY291bnQgPiAwOgoJCgkJCQlkaWFsb2cgPSB4Ym1jZ3VpLkRpYWxvZygpCgkJCQlpZiBkaWFsb2cueWVzbm8oIkV4Y2x1aXIgaW5mb3JtYcOnw6NvIGVtIENhY2hlLiIsIHN0cihmaWxlX2NvdW50KSArICIgZmljaGVpcm9zIGVuY29udHJhZG9zLiIsICJRdWVyIGFwYWdhciB0b2RvcyBvcyBmaWNoZWlyb3M/Iik6CgkJCQkJCQkKCQkJCQlmb3IgZiBpbiBmaWxlczoKCQkJCQkJb3MudW5saW5rKG9zLnBhdGguam9pbihyb290LCBmKSkKCQkJCQlmb3IgZCBpbiBkaXJzOgoJCQkJCQlzaHV0aWwucm10cmVlKG9zLnBhdGguam9pbihyb290LCBkKSkKCQkJCQlkaWFsb2cgPSB4Ym1jZ3VpLkRpYWxvZygpCgkJCQkJZGlhbG9nLm9rKEFkZG9uVGl0bGUsICIJCUtvZGkgbGltcG8gY29tIHN1Y2Vzc28uIikKCQkJCWVsc2U6CgkJCQkJCXBhc3MKCQkJZWxzZToKCQkJCWRpYWxvZyA9IHhibWNndWkuRGlhbG9nKCkKCQkJCWRpYWxvZy5vayhBZGRvblRpdGxlLCAiCQlOw6NvIGZvcmFtIGVuY29udHJhZG9zIGZpY2hlaXJvcyBhIGFwYWdhci4iKQoJZXhjZXB0OiAKCQlkaWFsb2cgPSB4Ym1jZ3VpLkRpYWxvZygpCgkJZGlhbG9nLm9rKEFkZG9uVGl0bGUsICJFcnJvIGFvIHRlbnRhciBhcGFnYXIgZmljaGVpcm9zIGVtIGNhY2hlLiIpCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwkJCQkJCQkJCQkJCUFkZG9uIExJVkVJVCBGaWxtZXMgZSBTZXJpZXMJCQkJCQkJICMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCmRlZiBkZXZvbHZlcmVzdWx0YWRvKHVybG5vbyk6CglyZXN1bHRhZG8gPSBhYnJpcl91cmwodXJsbm9vLCBoZWFkZXI9aGVhZGVycykKCXRyeToKCQlyZXN1bHRhZG8gPSByZXN1bHRhZG8uZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6CgkJcmVzdWx0YWRvID0gcmVzdWx0YWRvLmVuY29kZSgndXRmLTgnKQoJcmV0dXJuIHJlc3VsdGFkbwoKZGVmIGdldENhdGVnb3JpYWxpdmUoaWQsaW5pY2lvKToKCWNhdCA9IGxlcl9maWNoZWlybyhvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdjYXRlZ29yaWFzX2xpdmUubGl2ZWl0JykpLnJlcGxhY2UoJyInLCAiJyIpCglyZXR1cm4gY2F0CgkKZGVmIGdldFNhZ2FzbGl2ZShpZCxpbmljaW8pOgoJY2F0ID0gbGVyX2ZpY2hlaXJvKG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ3NhZ2FzX2xpdmUubGl2ZWl0JykpLnJlcGxhY2UoJyInLCAiJyIpCglyZXR1cm4gY2F0CgpkZWYgZ2V0QW5vc2xpdmUoaWQsaW5pY2lvKToKCWNhdCA9IGxlcl9maWNoZWlybyhvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdhbm9zX2xpdmUubGl2ZWl0JykpLnJlcGxhY2UoJyInLCAiJyIpCglyZXR1cm4gY2F0CgpkZWYgbG9naW5saWxpKGluaWNpbyk6CglyZXN1bHRhZG8gPSBGYWxzZQoJZXJyb3MgPSAiIgoJdHJ5OgoJCXVybG5vbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZhZGRvbj0xJnRpcG89JytpbmljaW8KCQlyZXN1bHRhZG8gPSBkZXZvbHZlcmVzdWx0YWRvKHVybG5vbykKCQllc2NyZXZlcl9maWNoZWlybyhvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdkZWZpbmljb2VzX2xpdmUubGl2ZWl0JyksIHJlc3VsdGFkbykKCQlyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCQljYXRlZ29yaWFzID0gcmVzdWx0YWRvWydncnVwb3MnXQoJCWVzY3JldmVyX2ZpY2hlaXJvKG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ2NhdGVnb3JpYXNfbGl2ZS5saXZlaXQnKSwgc3RyKGNhdGVnb3JpYXMpKQoJCWFub3MgPSByZXN1bHRhZG9bJ2Fub3MnXQoJCWVzY3JldmVyX2ZpY2hlaXJvKG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ2Fub3NfbGl2ZS5saXZlaXQnKSwgc3RyKGFub3MpKQoJCQoJCWlmIGluaWNpbyA9PSAnaW5pY2lvX2ZpbG1lcyc6CgkJCXNhZ2FzID0gcmVzdWx0YWRvWydzYWdhcyddCgkJCWVzY3JldmVyX2ZpY2hlaXJvKG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ3NhZ2FzX2xpdmUubGl2ZWl0JyksIHN0cihzYWdhcykpCgkJcmV0dXJuIFRydWUKCWV4Y2VwdDoKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdOw6NvIGZvaSBwb3Nzw612ZWwgYWJyaXIgYSBww6FnaW5hLiBQb3IgZmF2b3IgdGVudGUgbm92YW1lbnRlLicpCgkJcmV0dXJuIEZhbHNlCgpkZWYgbGlzdGFtZW51c19saXZlaXQxKCk6CgljaGVja19sb2dpbiA9IGxvZ2lubGlsaSgnaW5pY2lvX2ZpbG1lcycpCglpZiBjaGVja19sb2dpbiA9PSBUcnVlOgoJCW1lbnVGaWxtZXMyKG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmaWxtZXMucG5nJyksX19TSVRFQWRkb25fXysnSW1hZ2Vucy9maWxtZXNfZmFuYXJ0LnBuZycpCgllbHNlOgoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0Vycm8gYSBmYXplciBsb2dpbiBuZXN0YSBwYXJ0ZS4gVGVudGUgbm92YW1lbnRlIG1haXMgdGFyZGUuJykKCmRlZiBsaXN0YW1lbnVzX2xpdmVpdDIoKToKCWNoZWNrX2xvZ2luID0gbG9naW5saWxpKCdpbmljaW9fc2VyaWVzJykKCWlmIGNoZWNrX2xvZ2luID09IFRydWU6CgkJbWVudVNlcmllczIob3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Nlcmllcy5wbmcnKSxfX1NJVEVBZGRvbl9fKydJbWFnZW5zL3Nlcmllc19mYW5hcnQucG5nJykKCWVsc2U6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnRXJybyBhIGZhemVyIGxvZ2luIG5lc3RhIHBhcnRlLiBUZW50ZSBub3ZhbWVudGUgbWFpcyB0YXJkZS4nKQoKZGVmIG1lbnVGaWxtZXMyKGljb25pbWFnZSxmYW5hcnQpOgoJYWRkRGlyMignVG9kb3Mgb3MgRmlsbWVzJywgX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89ZmlsbWVzJmdlbmVybz10b2RvcyZhZGRvbj0xJywgMTExMTEsICdmaWxtZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ1RvZG9zIG9zIERlc3RhcXVlcycsIF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPWZpbG1lcyZnZW5lcm89ZGVzdGFxdWVzJmFkZG9uPTEnLCAxMTExMSwgJ2ZpbG1lcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignVG9kYXMgYXMgU2FnYXMnLCBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1maWxtZXMmZ2VuZXJvPXNhZ2FzJmFkZG9uPTEnLCAxMTExOTksICdmaWxtZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ1BvciBBbm8nLCBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1maWxtZXMmZ2VuZXJvPWFub3MmYWRkb249MScsIDExMTE4LCAnZmlsbWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdQb3IgQ2F0ZWdvcmlhJywgX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89ZmlsbWVzJmdlbmVybz1jYXRlZ29yaWEmYWRkb249MScsIDExMTE5LCAnZmlsbWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdQb3IgUmF0aW5nJywgX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89ZmlsbWVzJmdlbmVybz1yYXRpbmcmYWRkb249MScsIDExMTExLCAnZmlsbWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdQYXJhIENyaWFuw6dhcycsIF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPWZpbG1lcyZnZW5lcm89a2lkcyZhZGRvbj0xJywgMTExMTEsICdmaWxtZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ1tDT0xPUiBwaW5rXVtCXVBlc3F1aXNhWy9CXVsvQ09MT1JdJywgX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89ZmlsbWVzJmFkZG9uPTEnLCAxMTEyMCwgJ2ZpbG1lcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJdmlzdGFfbWVudSgpCgpkZWYgbWVudVNlcmllczIoaWNvbmltYWdlLGZhbmFydCk6CglhZGREaXIyKCdUb2RhcyBTZXJpZXMnLCBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1zZXJpZXMmZ2VuZXJvPXRvZG9zJmFkZG9uPTEnLCAxMTExMiwgJ3NlcmllcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignVG9kb3Mgb3MgRGVzdGFxdWVzJywgX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89c2VyaWVzJmdlbmVybz1kZXN0YXF1ZXMmYWRkb249MScsIDExMTEyLCAnc2VyaWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdQb3IgQW5vJywgX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89c2VyaWVzJmdlbmVybz1hbm9zJmFkZG9uPTEnLCAxMTExOCwgJ3NlcmllcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignUG9yIENhdGVnb3JpYScsIF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPXNlcmllcyZnZW5lcm89Y2F0ZWdvcmlhJmFkZG9uPTEnLCAxMTExOSwgJ3NlcmllcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignUG9yIFJhdGluZycsIF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPXNlcmllcyZnZW5lcm89cmF0aW5nJmFkZG9uPTEnLCAxMTExMiwgJ3NlcmllcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignUGFyYSBDcmlhbsOnYXMnLCBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1zZXJpZXMmZ2VuZXJvPWtpZHMmYWRkb249MScsIDExMTEyLCAnc2VyaWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdbQ09MT1IgcGlua11bQl1QZXNxdWlzYVsvQl1bL0NPTE9SXScsIF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPXNlcmllcyZhZGRvbj0xJywgMTExMjAsICdzZXJpZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCXZpc3RhX21lbnUoKQoJCmRlZiBmaWxtZXMyKHVybCk6CglyZXN1bHRhZG8gPSBkZXZvbHZlcmVzdWx0YWRvKHVybCkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJZm9yIGkgaW4gcmVzdWx0YWRvWydpdGVtJ106CgkJc2V0RmlsbWUyKGkpCgkKCWN1cnJlbnQgPSByZXN1bHRhZG9bJ3BhZ2luYWNhbyddWydhdHVhbCddCgl0b3RhbCA9IDAKCXRyeTogdG90YWwgPSByZXN1bHRhZG9bJ3BhZ2luYWNhbyddWyd0b3RhbCddCglleGNlcHQ6IHBhc3MKCXRyeTogcHJveGltbyA9IGJhc2U2NC5iNjRkZWNvZGUocmVzdWx0YWRvWydwYWdpbmFjYW8nXVsnc2VndWludGUnXSkKCWV4Y2VwdDogcGFzcwoJaWYgaW50KGN1cnJlbnQpIDwgaW50KHRvdGFsKToKCQlhZGREaXIyKCdQcsOzeGltYSBww6FnaW5hICgnK3N0cihjdXJyZW50KSsnLycrc3RyKHRvdGFsKSsnKScsIHByb3hpbW8sIDExMTExLCAnZmlsbWVzJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Byb3hpbW8ucG5nJyksMSkKCXZpc3RhX2ZpbG1lc1NlcmllcygpCgkJCmRlZiBzZXJpZXMyKHVybCk6CglyZXN1bHRhZG8gPSBkZXZvbHZlcmVzdWx0YWRvKHVybCkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJCglmb3IgaSBpbiByZXN1bHRhZG9bJ2l0ZW0nXToKCQlzZXRTZXJpZXMyKGkpCgkKCWN1cnJlbnQgPSByZXN1bHRhZG9bJ3BhZ2luYWNhbyddWydhdHVhbCddCgl0b3RhbCA9IDAKCXRyeTogdG90YWwgPSByZXN1bHRhZG9bJ3BhZ2luYWNhbyddWyd0b3RhbCddCglleGNlcHQ6IHBhc3MKCXRyeTogcHJveGltbyA9IGJhc2U2NC5iNjRkZWNvZGUocmVzdWx0YWRvWydwYWdpbmFjYW8nXVsnc2VndWludGUnXSkKCWV4Y2VwdDogcGFzcwoJaWYgaW50KGN1cnJlbnQpIDwgaW50KHRvdGFsKToKCQlhZGREaXIyKCdQcm94aW1hIHBhZ2luYSAoJytzdHIoY3VycmVudCkrJy8nK3N0cih0b3RhbCkrJyknLCBwcm94aW1vLCAxMTExMiwgJ3NlcmllcycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdwcm94aW1vLnBuZycpKQoJdmlzdGFfZmlsbWVzU2VyaWVzKCkKCQoJCmRlZiBzZXRGaWxtZTIoaSk6CgljYXRlZ29yaWEgPSAiIgoJdHJ5OiBjYXRlZ29yaWEgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0dydXBvJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCWdydXBvMiA9ICIiCgl0cnk6IGdydXBvMiA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnR3J1cG8yJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzIAoJCglncnVwbzMgPSAiIgoJdHJ5OiBncnVwbzMgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0dydXBvMyddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglpZiBncnVwbzIgIT0gIiI6CgkJY2F0ZWdvcmlhICs9ICcsJytncnVwbzIKCWlmIGdydXBvMyAhPSAiIjoKCQljYXRlZ29yaWEgKz0gJywnK2dydXBvMwoJCglwdCA9ICcnCgliciA9ICcnCglzZW1MZWdlbmRhID0gJycKCWlkX3ZpZGVvID0gaVsnSUQnXQoJCglub21lID0gJycKCXRyeTogbm9tZSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnTm9tZSddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglub21lZW4gPSAnJwoJdHJ5OiBub21lZW4gPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ05vbWVFTiddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglkZXNjcmljYW8gPSAnJwoJdHJ5OiBkZXNjcmljYW8gPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0Rlc2NyaWNhbyddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglyZWFsaXphZG9yID0gJycKCXRyeTogcmVhbGl6YWRvciA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnUmVhbGl6YWRvciddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglhY3RvcmVzID0gJycKCXRyeTogYWN0b3JlcyA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnQWN0b3JlcyddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCgl5b3V0dWJlID0gJycKCXRyeTogeW91dHViZSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnWW91dHViZSddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCgl1cmwxID0gJycKCXRyeTogdXJsMSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnVXJsJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCXVybDIgPSAnJwoJdHJ5OiB1cmwyID0gYmFzZTY0LmI2NGRlY29kZShpWydVcmwxJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCXVybDMgPSAnJwoJdHJ5OiB1cmwzID0gYmFzZTY0LmI2NGRlY29kZShpWydVcmwyJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCXVybDQgPSAnJwoJdHJ5OiB1cmw0ID0gYmFzZTY0LmI2NGRlY29kZShpWydVcmwzJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCWltZGIgPSAnJwoJdHJ5OiBpbWRiID0gYmFzZTY0LmI2NGRlY29kZShpWydJbWRiJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCWltYWdlbSA9ICcnCgl0cnk6IGltYWdlbSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnSW1hZ2VtJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCWxlZ2VuZGFzID0gJycKCXRyeTogbGVnZW5kYXMgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0xlZ2VuZGFzJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCWFub3MgPSBpWydBbm9Ob3ZvJ10KCQoJaWYgJ2h0dHAnIG5vdCBpbiBpbWFnZW06CgkJaW1hZ2VtID0gX19BUElfXytpbWFnZW0KCQoJaWYgbGVnZW5kYXMgPT0gInNlbWxlZ2VuZGEiIG9yIGlbJ0xlZ2VuZGFzJ10gPT0gIiI6CgkJc2VtTGVnZW5kYSA9ICdbQ09MT1IgcmVkXVtCXVMvIExFR0VOREEgWy9CXVsvQ09MT1JdJwoJaWYgJ0JyYXNpbGVpcm8nIGluIGNhdGVnb3JpYToKCQliciA9ICdbQl1bQ09MT1IgZ3JlZW5dQlsvQ09MT1JdW0NPTE9SIHllbGxvd11SWy9DT0xPUl06IFsvQl0nCglpZiAnUG9ydHUnIGluIGNhdGVnb3JpYToKCQlwdCA9ICdbQl1bQ09MT1IgZ3JlZW5dUFsvQ09MT1JdW0NPTE9SIHJlZF1UWy9DT0xPUl06IFsvQl0nCgkKCXZpc3RvID0gRmFsc2UKCWNvciA9ICd3aGl0ZScKCWlmICdQVCcgaW4gaW1kYjoKCQlpbWRiID0gcmUuY29tcGlsZSgnKC4rPylQVCcpLmZpbmRhbGwoaW1kYilbMF0KCQlwdCA9ICdbQl1bQ09MT1IgZ3JlZW5dUFsvQ09MT1JdW0NPTE9SIHJlZF1UWy9DT0xPUl06IFsvQl0nCgkKCWluZm9MYWJlbHMgPSB7J1RpdGxlJzogbm9tZWVuLCAnWWVhcic6IGFub3MsICdHZW5yZSc6IGNhdGVnb3JpYSwgJ1Bsb3QnOiBkZXNjcmljYW8sICdDYXN0JzogYWN0b3Jlcy5zcGxpdCgnLCcpLCAnVHJhaWxlcic6IHlvdXR1YmUsICdEaXJlY3Rvcic6IHJlYWxpemFkb3IsICdSYXRpbmcnOiBpWydSYXRpbmcnXSwgJ0lNREJOdW1iZXInOiBpbWRiIH0KCglub21lZWUgPSAnW0NPTE9SICcrY29yKyddJytwdCticitzZW1MZWdlbmRhK3JlbW92ZXJBY2VudG9zKG5vbWUpKycgKCcrYW5vcysnKVsvQ09MT1JdJwoJdXJsbm9vID0gX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89ZmlsbWVzJmdlbmVybz1nZXRfdmlkZW8mYWRkb249MSZwZXNxdWlzYT0nK3N0cihpZF92aWRlbykKCWZvdG9vbyA9IGltYWdlbQoJZmFuYXJ0dHQgPSAnaW1hZ2VzL2JhY2tncm91bmQvJytpbWRiKycuanBnJwoJCglhZGRWaWRlbyhub21lZWUsIHVybG5vbywgMTExMTMsIGZvdG9vbywgdmlzdG8sICdmaWxtZScsIDAsIDAsIGluZm9MYWJlbHMsIGZhbmFydHR0LCB0cmFpbGVyPXlvdXR1YmUpCgpkZWYgZ2V0R2VuZXJvczJfbGl2ZSh1cmwsIG1vZG8pOgoJbGlzdGEgPSBbXQoJbGlzdGEgPSBnZXRTYWdhc2xpdmUoJ2luaWNpb19zYWdhcycsIG1vZG8pCgkKCWZvciBjIGluIGFzdC5saXRlcmFsX2V2YWwobGlzdGEpOgoJCWlmIGNbJ0lEJ10gPT0gIjAiOgoJCQljb250aW51ZQoJCXRyeToKCQkJY2F0ID0gYmFzZTY0LmI2NGRlY29kZShjWydOb21lJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDoKCQkJcGFzcwoJCQoJCXVybG5vdm8gPSB1cmwrJyZwZXNxdWlzYT0nK3N0cihjWydJRCddKTsKCQlhZGREaXIyKGNhdCwgdXJsbm92bywgMTExMjEsIG1vZG8sIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdnZW5lcm8ucG5nJykpCgkKCXZpc3RhX21lbnUoKQoKZGVmIGdldEdlbmVyb3NfbGl2ZSh1cmwsIG1vZG8pOgoJbGlzdGEgPSBbXQoJaWYgbW9kbyA9PSAnZmlsbWVzJzoKCQlsaXN0YSA9IGdldENhdGVnb3JpYWxpdmUoJ2luaWNpb19maWxtZXMnLCBtb2RvKQoJZWxzZToKCQlsaXN0YSA9IGdldENhdGVnb3JpYWxpdmUoJ2luaWNpb19zZXJpZXMnLCBtb2RvKQoJCglmb3IgYyBpbiBhc3QubGl0ZXJhbF9ldmFsKGxpc3RhKToKCQlpZiBjWydJRCddID09ICIwIjoKCQkJY29udGludWUKCQl0cnk6CgkJCWNhdCA9IGJhc2U2NC5iNjRkZWNvZGUoY1snTm9tZSddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6CgkJCXBhc3MKCQkKCQl1cmxub3ZvID0gdXJsKycmcGVzcXVpc2E9JytzdHIoY1snSUQnXSk7CgkJYWRkRGlyMihjYXQsIHVybG5vdm8sIDExMTIxLCBtb2RvLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZ2VuZXJvLnBuZycpKQoJCgl2aXN0YV9tZW51KCkKCmRlZiBnZXRZZWFyc19saXZlKHVybCwgbW9kbyk6CglsaXN0YSA9IFtdCglpZiBtb2RvID09ICdmaWxtZXMnOgoJCWxpc3RhID0gZ2V0QW5vc2xpdmUoJ2luaWNpb19maWxtZXMnLCBtb2RvKQoJZWxzZToKCQlsaXN0YSA9IGdldEFub3NsaXZlKCdpbmljaW9fc2VyaWVzJywgbW9kbykKCQoJZm9yIGMgaW4gYXN0LmxpdGVyYWxfZXZhbChsaXN0YSk6CgkJaWYgY1snSUQnXSA9PSAiMCI6CgkJCWNvbnRpbnVlCgkJdHJ5OgoJCQljYXQgPSBiYXNlNjQuYjY0ZGVjb2RlKGNbJ05vbWUnXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OgoJCQlwYXNzCgkJCgkJdXJsbm92byA9IHVybCsnJnBlc3F1aXNhPScrc3RyKGNbJ0lEJ10pOwoJCWFkZERpcjIoY2F0LCB1cmxub3ZvLCAxMTEyMSwgbW9kbywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2dlbmVyby5wbmcnKSkKCQoJdmlzdGFfbWVudSgpCgkKZGVmIGdldEluZm9fbGl2ZSh1cmwsIHRpcG8pOgoJcmVzdWx0YWRvID0gZGV2b2x2ZXJlc3VsdGFkbyh1cmwpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCWZvciBpIGluIHJlc3VsdGFkb1siaXRlbSJdOgoJCWlmIHRpcG8gPT0gJ2ZpbG1lcyc6CgkJCXNldEZpbG1lMihpKQoJCWVsc2U6CgkJCXNldFNlcmllczIoaSkKCQoJY3VycmVudCA9IHJlc3VsdGFkb1sncGFnaW5hY2FvJ11bJ2F0dWFsJ10KCXRvdGFsID0gMAoJdHJ5OiB0b3RhbCA9IHJlc3VsdGFkb1sncGFnaW5hY2FvJ11bJ3RvdGFsJ10KCWV4Y2VwdDogcGFzcwoJdHJ5OiBwcm94aW1vID0gYmFzZTY0LmI2NGRlY29kZShyZXN1bHRhZG9bJ3BhZ2luYWNhbyddWydzZWd1aW50ZSddKQoJZXhjZXB0OiBwYXNzCglpZiBpbnQoY3VycmVudCkgPCBpbnQodG90YWwpOgoJCWFkZERpcjIoJ1Byb3hpbWEgcGFnaW5hICgnK3N0cihjdXJyZW50KSsnLycrc3RyKHRvdGFsKSsnKScsIHByb3hpbW8sIDExMTIxLCB0aXBvLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncHJveGltby5wbmcnKSkKCXZpc3RhX2ZpbG1lc1NlcmllcygpCgkKZGVmIHBlc3F1aXNhX2xpdmUodXJsLCB0aXBvbG8pOgoJY29kaWdvX2ZvbnRlID0gJycKCWRhZG9zID0gJycKCXRhYmVsYSA9ICcnCglzdHJQZXNxdWlzYSA9ICcnCglmaWNoZWlybyA9ICcnCglzaXRlID0gJycKCXF1YWxpZGFkZSA9ICcnCgl0b2tlblBlc3F1aXNhPSAnJwoJcmVzdWx0YWRvID0gJycKCXRpcG9sb3Blc3F1aXNhTm92byA9ICcwJwoJaWYgdGlwb2xvID09ICdmaWxtZXMnOgoJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnZmlsbWVzX3Blc3F1aXNhLmxpdmVpdCcpCgkJdGlwbyA9IDAKCQlxdWFsaWRhZGUgPSBfX1F1YWxpZGFkZV9fCgllbHNlOgoJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnc2VyaWVzX3Blc3F1aXNhLmxpdmVpdCcpCgkJdGlwbyA9IDEKCQlzaXRlID0gJ3NlcmllcycKCQoJaWYgJ3BhZ2UnIG5vdCBpbiB1cmw6CgkJdHJ5OgoJCQl0aXBvbG9wZXNxdWlzYSA9IHhibWNndWkuRGlhbG9nKCkuc2VsZWN0KHUnTyBxdWUgcHJldGVuZGUgcGVzcXVpc2FyPycsIFsnUG9yOiBOb21lUFQgb3UgTm9tZSBFTicsICdQb3I6IFJlYWxpemFkb3InLCdQb3I6IEFjdG9yJ10pCgkJZXhjZXB0OgoJCQlyZXR1cm4gRmFsc2UKCQkKCQlpZiB0aXBvbG9wZXNxdWlzYSA9PSAwOgoJCQl0aXBvbG9wZXNxdWlzYU5vdm8gPSAnMCcKCQllbGlmIHRpcG8gPT0gMToKCQkJdGlwb2xvcGVzcXVpc2FOb3ZvID0gJzEnCgkJZWxpZiB0aXBvID09IDI6CgkJCXRpcG9sb3Blc3F1aXNhTm92byA9ICcyJwoJCQkKCQlfX0FERE9OX18uc2V0U2V0dGluZygndG9rZW5QZXNxdWlzYScsIHRpcG9sb3Blc3F1aXNhTm92bykKCQl0ZWNsYWRvID0geGJtYy5LZXlib2FyZCgnJywgJ08gcXVlIHF1ZXIgcGVzcXVpc2FyPycpCgkJdGVjbGFkby5kb01vZGFsKCkKCQkKCQlpZiB0ZWNsYWRvLmlzQ29uZmlybWVkKCk6CgkJCXN0clBlc3F1aXNhID0gdGVjbGFkby5nZXRUZXh0KCkKCQkJaWYgc3RyUGVzcXVpc2EgPT0gJyc6CgkJCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdJbnNpcmEgYWxnbyBuYSBwZXNxdWlzYS4nKQoJCQkJYWRkRGlyMignQWx0ZXJhciBQZXNxdWlzYScsIHVybCwgMTExMjAsIHRpcG9sbywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Blc3F1aXNhLnBuZycpLCAwKQoJCQkJcmV0dXJuIEZhbHNlCgkJCWVsc2U6CgkJCQl0b2tlblBlc3F1aXNhID0gc3RyUGVzcXVpc2EucmVwbGFjZSgiICIsICIlMjAiKQoJCQkJX19BRERPTl9fLnNldFNldHRpbmcoJ3Rva2VuUGVzcXVpc2FUZXh0bycsIHRva2VuUGVzcXVpc2EpCgkKCXJlc3VsdGFkbyA9IGRldm9sdmVyZXN1bHRhZG8odXJsKycmcGVzcXVpc2E9JytfX0FERE9OX18uZ2V0U2V0dGluZygndG9rZW5QZXNxdWlzYVRleHRvJykrJyZnZW5lcm89cGVzcXVpc2EnK19fQURET05fXy5nZXRTZXR0aW5nKCd0b2tlblBlc3F1aXNhJykpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCWZvciBpIGluIHJlc3VsdGFkb1siaXRlbSJdOgoJCWlmIHRpcG9sbyA9PSAnZmlsbWVzJzoKCQkJc2V0RmlsbWUyKGkpCgkJZWxzZToKCQkJc2V0U2VyaWVzMihpKQoJCgljdXJyZW50ID0gcmVzdWx0YWRvWydwYWdpbmFjYW8nXVsnYXR1YWwnXQoJdG90YWwgPSAwCgl0cnk6IHRvdGFsID0gcmVzdWx0YWRvWydwYWdpbmFjYW8nXVsndG90YWwnXQoJZXhjZXB0OiBwYXNzCgl0cnk6IHByb3hpbW8gPSBiYXNlNjQuYjY0ZGVjb2RlKHJlc3VsdGFkb1sncGFnaW5hY2FvJ11bJ3NlZ3VpbnRlJ10pCglleGNlcHQ6IHBhc3MKCWlmIGludChjdXJyZW50KSA8IGludCh0b3RhbCk6CgkJYWRkRGlyMignUHJveGltYSBwYWdpbmEgKCcrc3RyKGN1cnJlbnQpKycvJytzdHIodG90YWwpKycpJywgcHJveGltbywgMTExMjAsIHRpcG9sbywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Byb3hpbW8ucG5nJykpCgllbHNlOgoJCXhibWNwbHVnaW4uZW5kT2ZEaXJlY3RvcnkoaW50KHN5cy5hcmd2WzFdKSxjYWNoZVRvRGlzYz1GYWxzZSkKCQoJdmlzdGFfZmlsbWVzU2VyaWVzKCkKCmRlZiBzZXRTZXJpZXMyKGkpOgoJY2F0ZWdvcmlhID0gIiIKCXRyeTogY2F0ZWdvcmlhID0gYmFzZTY0LmI2NGRlY29kZShpWydHcnVwbyddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglncnVwbzIgPSAiIgoJdHJ5OiBncnVwbzIgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0dydXBvMiddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcyAKCQoJZ3J1cG8zID0gIiIKCXRyeTogZ3J1cG8zID0gYmFzZTY0LmI2NGRlY29kZShpWydHcnVwbzMnXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJaWYgZ3J1cG8yICE9ICIiOgoJCWNhdGVnb3JpYSArPSAnLCcrZ3J1cG8yCglpZiBncnVwbzMgIT0gIiI6CgkJY2F0ZWdvcmlhICs9ICcsJytncnVwbzMKCQoJaWRfdmlkZW8gPSBpWydJRCddCgkKCW5vbWUgPSAnJwoJdHJ5OiBub21lID0gYmFzZTY0LmI2NGRlY29kZShpWydOb21lJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCW5vbWVlbiA9ICcnCgl0cnk6IG5vbWVlbiA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnTm9tZUVOJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCWRlc2NyaWNhbyA9ICcnCgl0cnk6IGRlc2NyaWNhbyA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnRGVzY3JpY2FvJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCXJlYWxpemFkb3IgPSAnJwoJdHJ5OiByZWFsaXphZG9yID0gYmFzZTY0LmI2NGRlY29kZShpWydSZWFsaXphZG9yJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCWFjdG9yZXMgPSAnJwoJdHJ5OiBhY3RvcmVzID0gYmFzZTY0LmI2NGRlY29kZShpWydBY3RvcmVzJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCXlvdXR1YmUgPSAnJwoJdHJ5OiB5b3V0dWJlID0gYmFzZTY0LmI2NGRlY29kZShpWydZb3V0dWJlJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCWltZGIgPSAnJwoJdHJ5OiBpbWRiID0gYmFzZTY0LmI2NGRlY29kZShpWydJbWRiJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCWFub3MgPSBpWydBbm9Ob3ZvJ10KCXRlbXBvcmFkYXMgPSBpWydUZW1wb3JhZGFzJ10KCQoJaW1hZ2VtID0gJycKCXRyeTogaW1hZ2VtID0gYmFzZTY0LmI2NGRlY29kZShpWydJbWFnZW0nXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJdmlzdG8gPSBGYWxzZQoJcHQgPSAnJwoJYnIgPSAnJwoJc2VtTGVnZW5kYSA9ICcnCglpZiAnQnJhc2lsZWlybycgaW4gY2F0ZWdvcmlhOgoJCWJyID0gJ1tCXVtDT0xPUiBncmVlbl1CWy9DT0xPUl1bQ09MT1IgeWVsbG93XVJbL0NPTE9SXTogWy9CXScKCWlmICdQb3J0dScgaW4gY2F0ZWdvcmlhOgoJCXB0ID0gJ1tCXVtDT0xPUiBncmVlbl1QWy9DT0xPUl1bQ09MT1IgcmVkXVRbL0NPTE9SXTogWy9CXScKCWlmICdQVCcgaW4gaW1kYjoKCQlwdCA9ICdbQl1bQ09MT1IgZ3JlZW5dUFsvQ09MT1JdW0NPTE9SIHJlZF1UWy9DT0xPUl06IFsvQl0nCgkKCWlmICdodHRwJyBub3QgaW4gaW1hZ2VtOgoJCWltYWdlbSA9IF9fQVBJX18raW1hZ2VtCgkKCXVybG5vbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPXNlcmllcyZnZW5lcm89dGVtcG9yYWRhJmFkZG9uPTEmc2VyaWU9JytpZF92aWRlbysnJnRlbXBvcmFkYT0nCgkKCWluZm9MYWJlbHMgPSB7J1RpdGxlJzogbm9tZWVuLCAnWWVhcic6IGFub3MsICdHZW5yZSc6IGNhdGVnb3JpYSwgJ1Bsb3QnOiBkZXNjcmljYW8sICdDYXN0JzogYWN0b3Jlcy5zcGxpdCgnLCcpLCAnVHJhaWxlcic6IHlvdXR1YmUsICdEaXJlY3Rvcic6IHJlYWxpemFkb3IsICdSYXRpbmcnOiBpWydSYXRpbmcnXSwgJ0lNREJOdW1iZXInOiBpbWRiIH0KCQoJbm9tZWVlID0gcHQrYnIrc2VtTGVnZW5kYStyZW1vdmVyQWNlbnRvcyhub21lKSsnICgnK2Fub3MrJyknCglmb3Rvb28gPSBpbWFnZW0KCWZhbmFydHR0ID0gX19BUElfXysnaW1hZ2VzL2JhY2tncm91bmQvJytpbWRiKycuanBnJwoJYWRkRGlyMihub21lZWUsIHVybG5vbywgMTExMTQsIHRlbXBvcmFkYXMsIGZvdG9vbywgdGlwbz0nc2VyaWUnLCBpbmZvTGFiZWxzPWluZm9MYWJlbHMscG9zdGVyPWZhbmFydHR0LHZpc3RvPXZpc3RvKQoJCgkKZGVmIGdldFNlYXNvbnMyKHVybCwgbW9kbyk6CglqPWludChtb2RvKQoJZm9yIGkgaW4gcmFuZ2Uoaik6CgkJYWRkRGlyMigiW0JdVGVtcG9yYWRhWy9CXSAiK3N0cihpKzEpLCB1cmwrc3RyKGkrMSksIDExMTE1LCAnZXBpc29kaW9zJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywndGVtcG9yYWRhcycsICd0ZW1wb3JhZGEnK3N0cihpKzEpKycucG5nJykpCgkKCXZpc3RhX3RlbXBvcmFkYXMoKQoKZGVmIGdldEVwaXNvZGVzMih1cmwpOgoJcmVzdWx0YWRvID0gZGV2b2x2ZXJlc3VsdGFkbyh1cmwpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCWZvciBpIGluIHJlc3VsdGFkb1snaXRlbSddOgoJCXB0ID0gJycKCQliciA9ICcnCgkJZmluYWwgPSAnJwoJCXNlbUxlZ2VuZGEgPSAnJwoJCQoJCXZpc3RvID0gRmFsc2UKCQljb3IgPSAnd2hpdGUnCgkJCgkJbm9tZSA9ICcnCgkJdHJ5OiBub21lID0gYmFzZTY0LmI2NGRlY29kZShpWydOb21lJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCgkJaW1kYiA9ICcnCgkJdHJ5OiBpbWRiID0gYmFzZTY0LmI2NGRlY29kZShpWydJbWRiJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCQoJCWltYWdlbSA9ICcnCgkJdHJ5OiBpbWFnZW0gPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0ltYWdlbSddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQkKCQlsZWdlbmRhcyA9ICcnCgkJdHJ5OiBsZWdlbmRhcyA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnTGVnZW5kYXMnXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OiBwYXNzCgkJCgkJYW5vcyA9IGlbJ0Fub05vdm8nXQoJCgkJaWYgJ2h0dHAnIG5vdCBpbiBpbWFnZW06CgkJCWltYWdlbSA9IF9fQVBJX18raW1hZ2VtCgkKCQlpZiBsZWdlbmRhcyA9PSAic2VtbGVnZW5kYSIgb3IgaVsnTGVnZW5kYXMnXSA9PSAiIjoKCQkJc2VtTGVnZW5kYSA9ICdbQ09MT1IgcmVkXVtCXVMvIExFR0VOREEgWy9CXVsvQ09MT1JdJwoJCQoJCWVwaXNvZGlvID0gaVsnRXBpc29kaW8nXQoJCXRlbXBvcmFkYSA9IGlbJ1RlbXBvcmFkYSddCgkJaWRfdmlkZW8gPSBpWydJRCddCgkJCgkJaW5mb0xhYmVscyA9IHsnVGl0bGUnOiBub21lLCAnQ29kZSc6IGltZGIsICdFcGlzb2RlJzogZXBpc29kaW8sICdTZWFzb24nOiB0ZW1wb3JhZGEgfQoJCW5vbWVlZSA9IHB0K2JyK2ZpbmFsK3NlbUxlZ2VuZGErJ1tDT0xPUiAnK2NvcisnXVtCXUVwaXNvZGlvICcrc3RyKGVwaXNvZGlvKSsnWy9CXVsvQ09MT1JdICcrcmVtb3ZlckFjZW50b3Mobm9tZSkKCQkKCQl1cmxub28gPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1zZXJpZXMmZ2VuZXJvPWdldF92aWRlbyZhZGRvbj0xJnBlc3F1aXNhPScrc3RyKGlkX3ZpZGVvKQoJCWZvdG9vbyA9IGltYWdlbQoJCWZhbmFydHR0ID0gX19BUElfXysnaW1hZ2VzL2JhY2tncm91bmQvJytpbWRiKycuanBnJwoJCWFkZFZpZGVvKG5vbWVlZSwgdXJsbm9vLCAxMTExMywgaW1hZ2VtLCB2aXN0bywgJ2VwaXNvZGlvJywgdGVtcG9yYWRhLCBlcGlzb2RpbywgaW5mb0xhYmVscywgZmFuYXJ0dHQpCgkKCXZpc3RhX2VwaXNvZGlvcygpCgpkZWYgcGxheWVyMihuYW1lLCB1cmwsIGljb25pbWFnZSwgbW9kbywgdGVtcG9yYWRhLCBlcGlzb2RpbywgdGlwb2xvZ2kpOgoJcmVzdWx0YWRvID0gZGV2b2x2ZXJlc3VsdGFkbyh1cmwpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCWluZm9sYWJlbHMgPSBkaWN0KCkKCXBhc3RhRGF0YSA9ICcnCglub21lID0gJycKCWlkVmlkZW8gPSAnMCcKCW1lbnNhZ2VtcHJvZ3Jlc3NvID0geGJtY2d1aS5EaWFsb2dQcm9ncmVzcygpCgltZW5zYWdlbXByb2dyZXNzby5jcmVhdGUoQWRkb25UaXRsZSwgdSdBYnJpciBlbWlzc8OjbycsJ1BvciBmYXZvciBhZ3VhcmRlLi4uJykKCW1lbnNhZ2VtcHJvZ3Jlc3NvLnVwZGF0ZSgyNSwgIiIsIHUnT2J0ZXIgdmlkZW8gZSBsZWdlbmRhJywgIiIpCgoJc3RyZWFtLCBsZWdlbmRhLCBleHRfZyA9IGdldFN0cmVhbUxlZ2VuZGEyKHJlc3VsdGFkb1swXSx0aXBvbG9naSkKCWlmIHN0cmVhbSA9PSBGYWxzZSBhbmQgbGVnZW5kYSA9PSAyMDQ6CgkJbWVuc2FnZW1wcm9ncmVzc28uY2xvc2UoKQoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0FsZ3VtIGVycm8uIFRlbnRlIG1haXMgdGFyZGUnKQoJCXJldHVybiBGYWxzZQoJZWxzZToKCQltZW5zYWdlbXByb2dyZXNzby51cGRhdGUoNTAsICIiLCB1J1ByZXBhcmEtdGUsIHZhaSBjb21lw6dhciEnLCAiIikKCQlwbGF5bGlzdCA9IHhibWMuUGxheUxpc3QoMSkKCQlwbGF5bGlzdC5jbGVhcigpCgkJbGlzdGl0ZW0gPSB4Ym1jZ3VpLkxpc3RJdGVtKG5hbWUsIGljb25JbWFnZT0iRGVmYXVsdFZpZGVvLnBuZyIsIHRodW1ibmFpbEltYWdlPWljb25pbWFnZSkKCgkJbGlzdGl0ZW0uc2V0SW5mbyh0eXBlPSJWaWRlbyIsIGluZm9MYWJlbHM9aW5mb2xhYmVscykKCQlsaXN0aXRlbS5zZXRQcm9wZXJ0eSgnbWltZXR5cGUnLCAndmlkZW8veC1tc3ZpZGVvJykKCQlsaXN0aXRlbS5zZXRQcm9wZXJ0eSgnSXNQbGF5YWJsZScsICd0cnVlJykKCQkKCQlsaXN0aXRlbS5zZXRQYXRoKHBhdGg9c3RyZWFtKQoJCXBsYXlsaXN0LmFkZChzdHJlYW0sIGxpc3RpdGVtKQoJCXhibWNwbHVnaW4uc2V0UmVzb2x2ZWRVcmwoaW50KHN5cy5hcmd2WzFdKSwgVHJ1ZSwgbGlzdGl0ZW0pCgkJbWVuc2FnZW1wcm9ncmVzc28udXBkYXRlKDc1LCAiIiwgdSdCb2EgU2Vzc8OjbyEhIScsICIiKQoKCQlpZiBzdHJlYW0gPT0gRmFsc2U6CgkJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ08gc2Vydmlkb3IgZXNjb2xoaWRvIG7Do28gZGlzcG9uw612ZWwsIGVzY29saGEgb3V0cm8gb3UgdGVudGUgbm92YW1lbnRlIG1haXMgdGFyZGUuJykKCQllbHNlOgoJCQlwbGF5ZXJfbXIgPSBQbGF5ZXIuUGxheWVyKHVybD11cmwsIGlkRmlsbWU9aWRWaWRlbywgcGFzdGFEYXRhPV9fUEFTVEFfREFET1NfXywgdGVtcG9yYWRhPXRlbXBvcmFkYSwgZXBpc29kaW89ZXBpc29kaW8sIG5vbWU9bmFtZSwgbG9nbz1vcy5wYXRoLmpvaW4oX19BRERPTl9GT0xERVJfXywnaWNvbi5wbmcnKSkKCQkJbWVuc2FnZW1wcm9ncmVzc28uY2xvc2UoKQoJCQlwbGF5ZXJfbXIucGxheShwbGF5bGlzdCkKCQkJcGxheWVyX21yLnNldFN1YnRpdGxlcyhsZWdlbmRhKQoJCQl3aGlsZSBwbGF5ZXJfbXIucGxheWluZzoKCQkJCXhibWMuc2xlZXAoNTAwMCkKCQkJCSNwbGF5ZXJfbXIudHJhY2tlclRlbXBvKCkKCmRlZiBnZXRTdHJlYW1MZWdlbmRhMih0dWRvaW5mbyx0aXBvb28pOgoJcmVzdWx0YWRvID0gdHVkb2luZm8KCWkgPSAwCglzZXJ2aWRvcmVzID0gW10KCXRpdHVsb3MgPSBbXQoJbm9tZSA9ICcnCgl1cmwxID0gJycKCXRyeTogdXJsMSA9IGJhc2U2NC5iNjRkZWNvZGUocmVzdWx0YWRvWydVcmwnXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCXVybDIgPSAnJwoJdHJ5OiB1cmwyID0gYmFzZTY0LmI2NGRlY29kZShyZXN1bHRhZG9bJ1VybDEnXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCXVybDMgPSAnJwoJdHJ5OiB1cmwzID0gYmFzZTY0LmI2NGRlY29kZShyZXN1bHRhZG9bJ1VybDInXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCXVybDQgPSAnJwoJdHJ5OiB1cmw0ID0gYmFzZTY0LmI2NGRlY29kZShyZXN1bHRhZG9bJ1VybDMnXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCXVybDUgPSAnJwoJdHJ5OiB1cmw1ID0gYmFzZTY0LmI2NGRlY29kZShyZXN1bHRhZG9bJ1VybDQnXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJaWYgdXJsMSAhPSAnJzoKCQlpKz0xCgkJaWYgJ29sb2FkJyBpbiB1cmwxIG9yICdvcGVubG9hZCcgaW4gdXJsMToKCQkJbm9tZSA9ICJPcGVuTG9hZCIKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3ZpZHppJyBpbiB1cmwxOgoJCQlub21lID0gJ1ZpZHppJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwxKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAnZ29vZ2xlJyBpbiB1cmwxIG9yICdjbG91ZC5tYWlsLnJ1JyBpbiB1cmwxIG9yICcubXA0JyBpbiB1cmwxIG9yICcuYXZpJyBpbiB1cmwxOgoJCQlub21lID0gQWRkb25UaXRsZQoJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwxKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAndXB0b3N0cmVhbS5jb20nIGluIHVybDE6CgkJCW5vbWUgPSAnVXBUb1N0cmVhbScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3JhcGlkdmlkZW8uY29tJyBpbiB1cmwxIG9yICdyYXB0dScgaW4gdXJsMToKCQkJbm9tZSA9ICdSYXB0dScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3ZpZG96YS5uZXQnIGluIHVybDE6CgkJCW5vbWUgPSAnVmlkb3phJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwxKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAnc3RyZWFtYW5nby4nIGluIHVybDE6CgkJCW5vbWUgPSAnU3RyZWFtYW5nbycKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3ZlcnlzdHJlYW0uJyBpbiB1cmwxOgoJCQlub21lID0gJ1ZlcnlTdHJlYW0nCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDEpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICdtaXhkcm9wLnRvJyBpbiB1cmwxOgoJCQlub21lID0gJ01peGRyb3AnCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDEpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCWlmIHVybDIgIT0gJyc6CgkJaSs9MQoJCWlmICdvbG9hZCcgaW4gdXJsMiBvciAnb3BlbmxvYWQnIGluIHVybDI6CgkJCW5vbWUgPSAiT3BlbkxvYWQiCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDIpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICd2aWR6aScgaW4gdXJsMjoKCQkJbm9tZSA9ICdWaWR6aScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMikKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ2dvb2dsZScgaW4gdXJsMiBvciAnY2xvdWQubWFpbC5ydScgaW4gdXJsMiBvciAnLm1wNCcgaW4gdXJsMiBvciAnLmF2aScgaW4gdXJsMjoKCQkJbm9tZSA9IEFkZG9uVGl0bGUKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMikKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3VwdG9zdHJlYW0uY29tJyBpbiB1cmwyOgoJCQlub21lID0gJ1VwVG9TdHJlYW0nCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDIpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICdyYXBpZHZpZGVvLmNvbScgaW4gdXJsMiBvciAncmFwdHUnIGluIHVybDI6CgkJCW5vbWUgPSAnUmFwdHUnCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDIpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICd2aWRvemEubmV0JyBpbiB1cmwyOgoJCQlub21lID0gJ1ZpZG96YScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMikKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3N0cmVhbWFuZ28uJyBpbiB1cmwyOgoJCQlub21lID0gJ1N0cmVhbWFuZ28nCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDIpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICd2ZXJ5c3RyZWFtLicgaW4gdXJsMjoKCQkJbm9tZSA9ICdWZXJ5U3RyZWFtJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwyKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAnbWl4ZHJvcC50bycgaW4gdXJsMjoKCQkJbm9tZSA9ICdNaXhkcm9wJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwyKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgl0cnk6CgkJaWYgdXJsMyAhPSAnJzoKCQkJaSs9MQoJCQlpZiAnb2xvYWQnIGluIHVybDMgb3IgJ29wZW5sb2FkJyBpbiB1cmwzOgoJCQkJbm9tZSA9ICJPcGVuTG9hZCIKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDMpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3ZpZHppJyBpbiB1cmwzOgoJCQkJbm9tZSA9ICdWaWR6aScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDMpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ2dvb2dsZScgaW4gdXJsMyBvciAnY2xvdWQubWFpbC5ydScgaW4gdXJsMyBvciAnLm1wNCcgaW4gdXJsMyBvciAnLmF2aScgaW4gdXJsMzoKCQkJCW5vbWUgPSBBZGRvblRpdGxlCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwzKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd1cHRvc3RyZWFtLmNvbScgaW4gdXJsMzoKCQkJCW5vbWUgPSAnVXBUb1N0cmVhbScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDMpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3JhcGlkdmlkZW8uY29tJyBpbiB1cmwzIG9yICdyYXB0dScgaW4gdXJsMzoKCQkJCW5vbWUgPSAnUmFwdHUnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwzKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd2aWRvemEubmV0JyBpbiB1cmwzOgoJCQkJbm9tZSA9ICdWaWRvemEnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwzKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdzdHJlYW1hbmdvLicgaW4gdXJsMzoKCQkJCW5vbWUgPSAnU3RyZWFtYW5nbycKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDMpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3ZlcnlzdHJlYW0uJyBpbiB1cmwzOgoJCQkJbm9tZSA9ICdWZXJ5U3RyZWFtJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMykKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAnbWl4ZHJvcC50bycgaW4gdXJsMzoKCQkJCW5vbWUgPSAnTWl4ZHJvcCcKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDMpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCglleGNlcHQ6CgkJcGFzcwoJdHJ5OgoJCWlmIHVybDQgIT0gJyc6CgkJCWkrPTEKCQkJaWYgJ29sb2FkJyBpbiB1cmw0IG9yICdvcGVubG9hZCcgaW4gdXJsNDoKCQkJCW5vbWUgPSAiT3BlbkxvYWQiCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw0KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd2aWR6aScgaW4gdXJsNDoKCQkJCW5vbWUgPSAnVmlkemknCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw0KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdnb29nbGUnIGluIHVybDQgb3IgJ2Nsb3VkLm1haWwucnUnIGluIHVybDQgb3IgJy5tcDQnIGluIHVybDQgb3IgJy5hdmknIGluIHVybDQ6CgkJCQlub21lID0gQWRkb25UaXRsZQoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsNCkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndXB0b3N0cmVhbS5jb20nIGluIHVybDQ6CgkJCQlub21lID0gJ1VwVG9TdHJlYW0nCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw0KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdyYXBpZHZpZGVvLmNvbScgaW4gdXJsNCBvciAncmFwdHUnIGluIHVybDQ6CgkJCQlub21lID0gJ1JhcHR1JwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsNCkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndmlkb3phLm5ldCcgaW4gdXJsNDoKCQkJCW5vbWUgPSAnVmlkb3phJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsNCkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAnc3RyZWFtYW5nby4nIGluIHVybDQ6CgkJCQlub21lID0gJ1N0cmVhbWFuZ28nCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw0KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd2ZXJ5c3RyZWFtLicgaW4gdXJsNDoKCQkJCW5vbWUgPSAnVmVyeVN0cmVhbScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDQpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ21peGRyb3AudG8nIGluIHVybDQ6CgkJCQlub21lID0gJ01peGRyb3AnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw0KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJZXhjZXB0OgoJCXBhc3MKCQoJdHJ5OgoJCWlmIHVybDUgIT0gJyc6CgkJCWkrPTEKCQkJaWYgJ29sb2FkJyBpbiB1cmw1IG9yICdvcGVubG9hZCcgaW4gdXJsNToKCQkJCW5vbWUgPSAiT3BlbkxvYWQiCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw1KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd2aWR6aScgaW4gdXJsNToKCQkJCW5vbWUgPSAnVmlkemknCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw1KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdnb29nbGUnIGluIHVybDUgb3IgJ2Nsb3VkLm1haWwucnUnIGluIHVybDUgb3IgJy5tcDQnIGluIHVybDUgb3IgJy5hdmknIGluIHVybDU6CgkJCQlub21lID0gQWRkb25UaXRsZQoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsNSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndXB0b3N0cmVhbS5jb20nIGluIHVybDU6CgkJCQlub21lID0gJ1VwVG9TdHJlYW0nCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw1KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdyYXBpZHZpZGVvLmNvbScgaW4gdXJsNSBvciAncmFwdHUnIGluIHVybDU6CgkJCQlub21lID0gJ1JhcHR1JwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsNSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndmlkb3phLm5ldCcgaW4gdXJsNToKCQkJCW5vbWUgPSAnVmlkb3phJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsNSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAnc3RyZWFtYW5nby4nIGluIHVybDU6CgkJCQlub21lID0gJ1N0cmVhbWFuZ28nCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw1KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd2ZXJ5c3RyZWFtLicgaW4gdXJsNToKCQkJCW5vbWUgPSAnVmVyeVN0cmVhbScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDUpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ21peGRyb3AudG8nIGluIHVybDU6CgkJCQlub21lID0gJ01peGRyb3AnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw1KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJZXhjZXB0OgoJCXBhc3MKCQoJc3RyZWFtID0gJycKCWxlZ2VuZGEgPSAnJwoJbGVnZW5kYW5vdmEgPSAnJwoJdHJ5OgoJCWxlZ2VuZGFub3ZhID0gYmFzZTY0LmI2NGRlY29kZShyZXN1bHRhZG9bJ0xlZ2VuZGFzJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OgoJCXBhc3MKCQoJaWYgJ2xpdmVpdCcgaW4gbGVnZW5kYW5vdmE6CgkJbGVnZW5kYSA9ICcnCgllbGlmICdodHRwJyBpbiBsZWdlbmRhbm92YToKCQlsZWdlbmRhID0gbGVnZW5kYW5vdmEKCWVsaWYgJ3N1YnMvJyBpbiBsZWdlbmRhbm92YToKCQlsZWdlbmRhID0gX19BUElfXytsZWdlbmRhbm92YQoJZWxzZToKCQlsZWdlbmRhID0gX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrICJsZWdlbmRhcy8iICtsZWdlbmRhbm92YQoJCglleHRfZyA9ICdjb2lzbycKCWxlZ2VuZGFBdXggPSBsZWdlbmRhCglzZXJ2aWRvciA9IDAKCWlmIGxlbih0aXR1bG9zKSA+IDE6CgkJc2Vydmlkb3IgPSB4Ym1jZ3VpLkRpYWxvZygpLnNlbGVjdCgnRXNjb2xoYSBvIHNlcnZpZG9yJywgdGl0dWxvcykKCWVsc2U6CgkJc2Vydmlkb3IgPSAwCgkKCWlmICd2aWR6aScgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJdmlkemkgPSBVUkxSZXNvbHZlck1lZGlhLlZpZHppKHNlcnZpZG9yZXNbc2Vydmlkb3JdKQoJCXN0cmVhbSA9IHZpZHppLmdldE1lZGlhVXJsKCkKCQkjbGVnZW5kYSA9IHZpZHppLmdldFN1YnRpdGxlKCkKCWVsaWYgJ3VwdG9zdHJlYW0uY29tJyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQlzdHJlYW0gPSBVUkxSZXNvbHZlck1lZGlhLlVwVG9TdHJlYW0oc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pLmdldE1lZGlhVXJsKCkKCWVsaWYgJ3NlcnZlci5tcnBpcmFjeS53aW4nIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXN0cmVhbSA9IHNlcnZpZG9yZXNbc2Vydmlkb3JdCgllbGlmICdvbG9hZCcgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJc3RyZWFtID0gVVJMUmVzb2x2ZXJNZWRpYS5PcGVuTG9hZChzZXJ2aWRvcmVzW3NlcnZpZG9yXSkuZ2V0TWVkaWFVcmwoKQoJCSNsZWdlbmRhID0gVVJMUmVzb2x2ZXJNZWRpYS5PcGVuTG9hZChzZXJ2aWRvcmVzW3NlcnZpZG9yXSkuZ2V0U3VidGl0bGUoKQoJCWlmIG5vdCAnLnZ0dCcgaW4gbGVnZW5kYSBvciBsZWdlbmRhID09ICcnOgoJCQlsZWdlbmRhID0gbGVnZW5kYUF1eAoJZWxpZiAnZHJpdmUuZ29vZ2xlLmNvbS8nIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXN0cmVhbSwgZXh0X2cgPSBVUkxSZXNvbHZlck1lZGlhLkdvb2dsZVZpZGVvKHNlcnZpZG9yZXNbc2Vydmlkb3JdKS5nZXRNZWRpYVVybCgpCgllbGlmICdjbG91ZC5tYWlsLnJ1JyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQlzdHJlYW0sIGV4dF9nID0gVVJMUmVzb2x2ZXJNZWRpYS5DbG91ZE1haWxSdShzZXJ2aWRvcmVzW3NlcnZpZG9yXSkuZ2V0TWVkaWFVcmwoKQoJZWxpZiAncmFwaWR2aWRlby5jb20nIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdIG9yICdyYXB0dScgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJcmFwaWQgPSBVUkxSZXNvbHZlck1lZGlhLlJhcGlkVmlkZW8oc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pCgkJc3RyZWFtID0gcmFwaWQuZ2V0TWVkaWFVcmwoKQoJCSNsZWdlbmRhID0gcmFwaWQuZ2V0TGVnZW5kYSgpCgllbGlmICd2aWRvemEubmV0JyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQl2aWRveiA9IFVSTFJlc29sdmVyTWVkaWEuVmlkb3phKHNlcnZpZG9yZXNbc2Vydmlkb3JdKQoJCXN0cmVhbSA9IHZpZG96LmdldE1lZGlhVXJsKCkKCQkjbGVnZW5kYSA9IHZpZG96LmdldExlZ2VuZGEoKQoJZWxpZiAnc3RyZWFtYW5nby4nIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXN0cmVhbWFuID0gVVJMUmVzb2x2ZXJNZWRpYS5TdHJlYW1hbmdvKHNlcnZpZG9yZXNbc2Vydmlkb3JdKQoJCXN0cmVhbSA9IHN0cmVhbWFuLmdldE1lZGlhVXJsKCkKCQkjbGVnZW5kYSA9IHN0cmVhbWFuLmdldExlZ2VuZGEoKQoJZWxpZiAndmVyeXN0cmVhbS4nIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXZlcnlzdHJlID0gVVJMUmVzb2x2ZXJNZWRpYS5WZXJ5U3RyZWFtKHNlcnZpZG9yZXNbc2Vydmlkb3JdKQoJCXN0cmVhbSA9IHZlcnlzdHJlLmdldE1lZGlhVXJsKCkKCQkjbGVnZW5kYSA9IHN0cmVhbWFuLmdldExlZ2VuZGEoKQoJZWxpZiAnbWl4ZHJvcC4nIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCW1peGRyb3AgPSBVUkxSZXNvbHZlck1lZGlhLk1peGRyb3Aoc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pCgkJc3RyZWFtID0gbWl4ZHJvcC5nZXRNZWRpYVVybCgpCgkJI2xlZ2VuZGEgPSBtaXhkcm9wLmdldExlZ2VuZGEoKQoJZWxzZToKCQlzdHJlYW0gPSBzZXJ2aWRvcmVzW3NlcnZpZG9yXQoJcmV0dXJuIHN0cmVhbSwgbGVnZW5kYSwgZXh0X2cKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCQkJCQkJCQkJCQkJQWRkb24gRmlsbWVzIGUgU2VyaWVzCQkJCQkJCQkJICAjCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZGVmIGxpc3RhbWVudXNzZXJpZXMobm9tZV9ub3YsdXJsLGVzdGlsbyx0aXBvLHRpcG9fdXNlcixzZXJ2aWRvcl91c2VyLGljb25pbWFnZSxmYW5hcnQpOgoJY2hlY2tfbG9naW4gPSBsb2dpbjIoKQoJaWYgY2hlY2tfbG9naW4gPT0gVHJ1ZToKCQlkYXRhYmFzZSA9IERhdGFiYXNlLmlzRXhpc3RzKCkKCQltZW51U2VyaWVzKG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdzZXJpZXMucG5nJyksX19TSVRFQWRkb25fXysnSW1hZ2Vucy9zZXJpZXNfZmFuYXJ0LnBuZycpCgllbHNlOgoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0Vycm8gYSBmYXplciBsb2dpbiBuZXN0YSBwYXJ0ZS4gVGVudGUgbm92YW1lbnRlIG1haXMgdGFyZGUuJykKCmRlZiBsaXN0YW1lbnVzZmlsbWVzKG5vbWVfbm92LHVybCxlc3RpbG8sdGlwbyx0aXBvX3VzZXIsc2Vydmlkb3JfdXNlcixpY29uaW1hZ2UsZmFuYXJ0KToKCWNoZWNrX2xvZ2luID0gbG9naW4yKCkKCWlmIGNoZWNrX2xvZ2luID09IFRydWU6CgkJZGF0YWJhc2UgPSBEYXRhYmFzZS5pc0V4aXN0cygpCgkJbWVudUZpbG1lcyhvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZmlsbWVzLnBuZycpLF9fU0lURUFkZG9uX18rJ0ltYWdlbnMvZmlsbWVzX2ZhbmFydC5wbmcnKQoJZWxzZToKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdFcnJvIGEgZmF6ZXIgbG9naW4gbmVzdGEgcGFydGUuIFRlbnRlIG5vdmFtZW50ZSBtYWlzIHRhcmRlLicpCgpkZWYgbGlzdGFtZW51c2FuaW1lcyhub21lX25vdix1cmwsZXN0aWxvLHRpcG8sdGlwb191c2VyLHNlcnZpZG9yX3VzZXIsaWNvbmltYWdlLGZhbmFydCk6CgljaGVja19sb2dpbiA9IGxvZ2luMigpCglpZiBjaGVja19sb2dpbiA9PSBUcnVlOgoJCWRhdGFiYXNlID0gRGF0YWJhc2UuaXNFeGlzdHMoKQoJCW1lbnVBbmltZXMob3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2FuaW1lcy5wbmcnKSxfX1NJVEVBZGRvbl9fKydJbWFnZW5zL3Nlcmllc19mYW5hcnQucG5nJykKCWVsc2U6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnRXJybyBhIGZhemVyIGxvZ2luIG5lc3RhIHBhcnRlLiBUZW50ZSBub3ZhbWVudGUgbWFpcyB0YXJkZS4nKQoKZGVmIG1lbnVGaWxtZXMoaWNvbmltYWdlLGZhbmFydCk6CglhZGREaXIyKCdUb2RvcyBvcyBGaWxtZXMnLCBfX0FQSV9TSVRFX18rJ2ZpbG1lcy5waHA/cXVhbGlkYWRlPScrX19RdWFsaWRhZGVfXywgMTExLCAnZmlsbWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdGaWxtZXMgZW0gRGVzdGFxdWUnLCAgX19BUElfU0lURV9fKydmaWxtZXMucGhwP2FjdGlvbj1kZXN0YXF1ZSZxdWFsaWRhZGU9JytfX1F1YWxpZGFkZV9fLCAxMTEsICdmaWxtZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ0ZpbG1lcyBwb3IgQW5vJywgX19BUElfU0lURV9fKydmaWxtZXMucGhwP2FjdGlvbj1hbm8nLCAxMTksICdsaXN0YWdlbUFub3MnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnYW5vLnBuZycpLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdGaWxtZXMgcG9yIEdlbmVybycsIF9fQVBJX1NJVEVfXysnZmlsbWVzLnBocD9hY3Rpb249Y2F0ZWdvcmlhJywgMTE4LCAnbGlzdGFnZW1HZW5lcm9zJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2dlbmVyby5wbmcnKSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignRmlsbWVzIHBvciBJTURCIFJha2luZycsICBfX0FQSV9TSVRFX18rJ2ZpbG1lcy5waHA/YWN0aW9uPWltZGJSYW5rJnF1YWxpZGFkZT0nK19fUXVhbGlkYWRlX18sIDExMSwgJ2ZpbG1lcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignRmlsbWVzIFBhcmEgQ3JpYW7Dp2FzJywgIF9fQVBJX1NJVEVfXysnZmlsbWVzLnBocD9hY3Rpb249cHQmcXVhbGlkYWRlPScrX19RdWFsaWRhZGVfXywgMTExLCAnZmlsbWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCgkKCXZpc3RhX21lbnUoKQoKZGVmIG1lbnVTZXJpZXMoaWNvbmltYWdlLGZhbmFydCk6CglhZGREaXIyKCdUb2RhcyBhcyBTZXJpZXMnLCBfX0FQSV9TSVRFX18rJ3Nlcmllcy5waHAnLCAxMjMsICdzZXJpZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ1NlcmllcyBlbSBEZXN0YXF1ZScsICBfX0FQSV9TSVRFX18rJ3Nlcmllcy5waHA/YWN0aW9uPWRlc3RhcXVlJywgMTIzLCAnc2VyaWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdTZXJpZXMgcG9yIEFubycsIF9fQVBJX1NJVEVfXysnc2VyaWVzLnBocD9hY3Rpb249YW5vJywgMTE5LCAnbGlzdGFnZW1Bbm9zJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Fuby5wbmcnKSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignU2VyaWVzIHBvciBHZW5lcm8nLCBfX0FQSV9TSVRFX18rJ3Nlcmllcy5waHA/YWN0aW9uPWNhdGVnb3JpYScsIDExOCwgJ2xpc3RhZ2VtR2VuZXJvcycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdnZW5lcm8ucG5nJyksIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCgl2aXN0YV9tZW51KCkKCmRlZiBtZW51QW5pbWVzKGljb25pbWFnZSxmYW5hcnQpOgoJYWRkRGlyMignVG9kb3Mgb3MgQW5pbWVzJywgX19BUElfU0lURV9fKydhbmltZXMucGhwJywgMTIzLCAnYW5pbWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdBbmltZXMgZW0gRGVzdGFxdWUnLCAgX19BUElfU0lURV9fKydhbmltZXMucGhwP2FjdGlvbj1kZXN0YXF1ZScsIDEyMywgJ2FuaW1lcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignQW5pbWVzIHBvciBBbm8nLCBfX0FQSV9TSVRFX18rJ2FuaW1lcy5waHA/YWN0aW9uPWFubycsIDExOSwgJ2xpc3RhZ2VtQW5vcycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdhbm8ucG5nJyksIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ0FuaW1lcyBwb3IgR2VuZXJvJywgX19BUElfU0lURV9fKydhbmltZXMucGhwP2FjdGlvbj1jYXRlZ29yaWEnLCAxMTgsICdsaXN0YWdlbUdlbmVyb3MnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZ2VuZXJvLnBuZycpLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCgoJdmlzdGFfbWVudSgpCgpkZWYgZ2V0TGlzdENhdGVnb3JpYSgpOgoJY2F0ID0gbGVyX2ZpY2hlaXJvKG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ2NhdGVnb3JpYXMubGl2ZWl0JykpLnJlcGxhY2UoJyInLCAiJyIpCglyZXR1cm4gY2F0CgpkZWYgcmVtb3ZlckFjZW50b3ModHh0LCBlbmNvZGluZz0ndXRmLTgnKToKCXJldHVybiBub3JtYWxpemUoJ05GS0QnLCB0eHQuZGVjb2RlKGVuY29kaW5nKSkuZW5jb2RlKCdBU0NJSScsJ2lnbm9yZScpCgpkZWYgZXNjcmV2ZXJfZmljaGVpcm8oZmljaGVpcm8sIGNvbnRldWRvKToKICAgIGYgPSBvcGVuKGZpY2hlaXJvLCBtb2RlPSJ3IikKICAgIGYud3JpdGUoY29udGV1ZG8pCiAgICBmLmNsb3NlKCkKCmRlZiBsZXJfZmljaGVpcm8oZmljaGVpcm8pOgogICAgZiA9IG9wZW4oZmljaGVpcm8sICJyIikKICAgIGNvbnRldWRvID0gIGYucmVhZCgpCiAgICBmLmNsb3NlKCkKICAgIHJldHVybiBjb250ZXVkbwoKZGVmIGdldENhdGVnb3JpYShpZCk6CgljYXQgPSBsZXJfZmljaGVpcm8ob3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnY2F0ZWdvcmlhcy5saXZlaXQnKSkucmVwbGFjZSgnIicsICInIikKCWZvciBjIGluIGFzdC5saXRlcmFsX2V2YWwoY2F0KToKCQlpZiBpbnQoaWQpID09IDA6CgkJCXJldHVybiAnJwoJCWlmIGludChjWydpZF9jYXRlZ29yaWEnXSkgPT0gaW50KGlkKToKCQkJdHJ5OgoJCQkJY2F0ID0gY1snY2F0ZWdvcmlhcyddLmRlY29kZSgndXRmLTgnKQoJCQlleGNlcHQ6CgkJCQljYXQgPSBjWydjYXRlZ29yaWFzJ10uZW5jb2RlKCd1dGYtOCcpCgkJCXJldHVybiBjYXQKCQoJIiIiaWYgaW50KGlkKSA9PSAwOgoJCXJldHVybiAnJwoJCglmb3IgYywgaSBpbiBjYXRzOgoJCWlmIGludChpKSA9PSBpbnQoaWQpOgoJCQlyZXR1cm4gYyIiIgoKCXJldHVybiAnJwoJCmRlZiBnZXRDb29raWUoKToKCXJldHVybiAndXNlcm5hbWU9JytfX0FERE9OX18uZ2V0U2V0dGluZygndG9rZW5NcnBpcmFjeScpCgpkZWYgdmVyaWZpY2FyVmlzdG9Mb2NhbChpZFZpZGVvLCB0ZW1wb3JhZGE9Tm9uZSwgZXBpc29kaW89Tm9uZSk6CglwYXN0YVZpc3RvPW9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ3Zpc3RvcycpCgoJaWYgdGVtcG9yYWRhIGFuZCBlcGlzb2RpbzoKCQlmaWNoZWlyb1Zpc3RvID0gb3MucGF0aC5qb2luKHBhc3RhVmlzdG8sc3RyKGlkVmlkZW8pKydfUycrc3RyKHRlbXBvcmFkYSkrJ3gnK3N0cihlcGlzb2RpbykrJy5saXZlaXQnKQoJZWxzZToKCQlmaWNoZWlyb1Zpc3RvID0gb3MucGF0aC5qb2luKHBhc3RhVmlzdG8sc3RyKGlkVmlkZW8pKycubGl2ZWl0JykKCglpZiBvcy5wYXRoLmV4aXN0cyhmaWNoZWlyb1Zpc3RvKToKCQlyZXR1cm4gVHJ1ZQoJZWxzZToKCQlyZXR1cm4gRmFsc2UKCmRlZiBmaWxtZXModXJsLCBwYWdpbmEpOgoJI2hlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICdCZWFyZXIgJXMnICUgX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuTXJwaXJhY3knKQoJI2lmIHJlc3VsdGFkbyA9PSAnRE5TJzoKCSMJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVGVtIGRlIGFsdGVyYXIgb3MgRE5TIHBhcmEgcG9kZXIgdXN1ZnJ1aXIgZG8gX19BRERPTl9fLicpCgkjCXJldHVybiBGYWxzZQoJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCwgaGVhZGVyPWhlYWRlcnMsIGNvb2tpZT1nZXRDb29raWUoKSkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJdmlzdG9zID0gRGF0YWJhc2Uuc2VsZWN0RmlsbWVzKCkKCW9wY2FvID0gX19BRERPTl9fLmdldFNldHRpbmcoJ21hcmNhclZpc3RvJykKCWZvciBpIGluIHJlc3VsdGFkb1snZGF0YSddOgoJCXNldEZpbG1lKGksIHZpc3Rvcywgb3BjYW8pCgl0cnk6IAoJCWN1cnJlbnQgPSByZXN1bHRhZG9bJ21ldGEnXVsnY3VycmVudCddCglleGNlcHQ6IAoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0FndWFyZGUgcGVsYSBwcsOzeGltYSBhdHVhbGl6YcOnw6NvLiBPdSB0ZW50ZSBtYWlzIHRhcmRlLicpCgkJcmV0dXJuIEZhbHNlCgljdXJyZW50ID0gcmVzdWx0YWRvWydtZXRhJ11bJ2N1cnJlbnQnXQoJdG90YWwgPSByZXN1bHRhZG9bJ21ldGEnXVsndG90YWwnXQoJdHJ5OiBwcm94aW1vID0gcmVzdWx0YWRvWydtZXRhJ11bJ3BhZ2luYWNhbyddWyduZXh0J10KCWV4Y2VwdDogcGFzcyAKCWlmIGludChjdXJyZW50KSA8IGludCh0b3RhbCk6CgkJYWRkRGlyMignUHLDs3hpbWEgcMOhZ2luYSAoJytzdHIoY3VycmVudCkrJy8nK3N0cih0b3RhbCkrJyknLCBwcm94aW1vLCAxMTEsICdmaWxtZXMnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncHJveGltby5wbmcnKSwxKQoJdmlzdGFfZmlsbWVzU2VyaWVzKCkKCQkKZGVmIHNlcmllcyh1cmwpOgoJI2hlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICdCZWFyZXIgJXMnICUgX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuTXJwaXJhY3knKQoJI2lmIHJlc3VsdGFkbyA9PSAnRE5TJzoKCSMJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVGVtIGRlIGFsdGVyYXIgb3MgRE5TIHBhcmEgcG9kZXIgdXN1ZnJ1aXIgZG8gX19BRERPTl9fLicpCgkjCXJldHVybiBGYWxzZQoJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCwgaGVhZGVyPWhlYWRlcnMsIGNvb2tpZT1nZXRDb29raWUoKSkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJaWYgJ3NlcmllJyBpbiB1cmw6CgkJdGlwbyA9ICdzZXJpZScKCWVsaWYgJ2FuaW1lJyBpbiB1cmw6CgkJdGlwbyA9ICdhbmltZScKCQkKCWlmICdzZXJpZScgaW4gdXJsOgoJCXRpcG8gPSAnc2VyaWVzJwoJZWxpZiAnYW5pbWUnIGluIHVybDoKCQl0aXBvID0gJ2FuaW1lcycKCXZpc3RvcyA9IERhdGFiYXNlLnNlbGVjdEZpbG1lcygpCglvcGNhbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCdtYXJjYXJWaXN0bycpCglmb3IgaSBpbiByZXN1bHRhZG9bJ2RhdGEnXToKCQlzZXRTZXJpZXMoaSwgdmlzdG9zLCBvcGNhbywgdGlwbykKCXRyeTogCgkJY3VycmVudCA9IHJlc3VsdGFkb1snbWV0YSddWydjdXJyZW50J10KCWV4Y2VwdDogCgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnQWd1YXJkZSBwZWxhIHByw7N4aW1hIGF0dWFsaXphw6fDo28uIE91IHRlbnRlIG1haXMgdGFyZGUuJykKCQlyZXR1cm4gRmFsc2UKCWN1cnJlbnQgPSByZXN1bHRhZG9bJ21ldGEnXVsnY3VycmVudCddCgl0b3RhbCA9IHJlc3VsdGFkb1snbWV0YSddWyd0b3RhbCddCgl0cnk6IHByb3hpbW8gPSByZXN1bHRhZG9bJ21ldGEnXVsncGFnaW5hY2FvJ11bJ25leHQnXQoJZXhjZXB0OiBwYXNzIAoJaWYgaW50KGN1cnJlbnQpIDwgaW50KHRvdGFsKToKCQlhZGREaXIyKCdQcm94aW1hIHBhZ2luYSAoJytzdHIoY3VycmVudCkrJy8nK3N0cih0b3RhbCkrJyknLCBwcm94aW1vLCAxMjMsICdzZXJpZXMnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncHJveGltby5wbmcnKSkKCXZpc3RhX2ZpbG1lc1NlcmllcygpCgpkZWYgZ2V0U2Vhc29ucyh1cmwpOgoJI2hlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICdCZWFyZXIgJXMnICUgX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuTXJwaXJhY3knKQoJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCwgaGVhZGVyPWhlYWRlcnMsIGNvb2tpZT1nZXRDb29raWUoKSkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKVsnZGF0YSddWzBdCglpZCA9IHVybC5zcGxpdCgnPScpWy0xXQoJaWYgJ3NlcmllJyBpbiB1cmw6CgkJdXJsID0gX19BUElfU0lURV9fKydzZXJpZXMucGhwP2FjdGlvbj10ZW1wb3JhZGEmaWRTZXJpZT0nK2lkKycmbj0lcycKCWVsaWYgJ2FuaW1lJyBpbiB1cmw6CgkJdXJsID0gX19BUElfU0lURV9fKydhbmltZXMucGhwP2FjdGlvbj10ZW1wb3JhZGEmaWRTZXJpZT0nK2lkKycmbj0lcycKCQoJdHJ5OgoJCXJlc3VsdGFkb1sndGVtcG9yYWRhcyddID0gcmVzdWx0YWRvWyd0ZW1wb3JhZGFzJ10ucmVwbGFjZSgnZXNwZWNpYWwnLCAnOTk5JykKCWV4Y2VwdDoKCQlwYXNzCglpZiByZXN1bHRhZG8gPT0gJ0ROUyc6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVGVtIGRlIGFsdGVyYXIgb3MgRE5TIHBhcmEgcG9kZXIgdXN1ZnJ1aXIgZG8gX19BRERPTl9fLicpCgkJcmV0dXJuIEZhbHNlCgkKCWo9MQoJCglpZiByZXN1bHRhZG9bJ3RlbXBvcmFkYXMnXSA9PSAiIjoKCQlyZXR1cm4gRmFsc2UKCWZvciBjLCBpIGluIHNvcnRlZChqc29uLmxvYWRzKHJlc3VsdGFkb1sndGVtcG9yYWRhcyddKS5pdGVyaXRlbXMoKSwga2V5PWxhbWJkYSBpOiBpbnQoaVswXSkpOgoJCWlmIGMgIT0gJzk5OSc6CgkJCWFkZERpcjIoIltCXVRlbXBvcmFkYVsvQl0gIitzdHIoYyksICh1cmwgJSBzdHIoYykpLCAxMTUsICdlcGlzb2Rpb3MnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCd0ZW1wb3JhZGFzJywgJ3RlbXBvcmFkYScrc3RyKGMpKycucG5nJykscG9zdGVyPV9fQVBJX18rcmVzdWx0YWRvWydiYWNrZ3JvdW5kJ10pCgkJZWxzZToKCQkJYWRkRGlyMigiW0JdVGVtcG9yYWRhWy9CXSAiK3N0cihjKSwgKHVybCAlICc5OTknKSwgMTE1LCAnZXBpc29kaW9zJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywndGVtcG9yYWRhcycsICd0ZW1wb3JhZGEnK3N0cihjKSsnLnBuZycpLHBvc3Rlcj1fX0FQSV9fK3Jlc3VsdGFkb1snYmFja2dyb3VuZCddKQoJCgl2aXN0YV90ZW1wb3JhZGFzKCkKCmRlZiBnZXRFcGlzb2Rlcyh1cmwpOgoJI2hlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICdCZWFyZXIgJXMnICUgX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuTXJwaXJhY3knKQoJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCwgaGVhZGVyPWhlYWRlcnMsIGNvb2tpZT1nZXRDb29raWUoKSkKCWlmIHJlc3VsdGFkbyA9PSAnRE5TJzoKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdUZW0gZGUgYWx0ZXJhciBvcyBETlMgcGFyYSBwb2RlciB1c3VmcnVpciBkbyBfX0FERE9OX18uJykKCQlyZXR1cm4gRmFsc2UKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJaWYgJ3NlcmllJyBpbiB1cmw6CgkJdGlwbyA9ICdzZXJpZXMnCgllbGlmICdhbmltZScgaW4gdXJsOgoJCXRpcG8gPSAnYW5pbWVzJwoJZm9yIGkgaW4gcmVzdWx0YWRvWydkYXRhJ106CgkJcHQgPSAnJwoJCWluZm9MYWJlbHMgPSB7J1RpdGxlJzogaVsnbm9tZV9lcGlzb2RpbyddLCAnQ29kZSc6IGlbJ0lNQkQnXSwgJ0VwaXNvZGUnOiBpWydlcGlzb2RpbyddLCAnU2Vhc29uJzogaVsndGVtcG9yYWRhJ10gfQoJCQoJCXRyeToKCQkJbm9tZSA9IGlbJ25vbWVfZXBpc29kaW8nXS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6CgkJCW5vbWUgPSBpWydub21lX2VwaXNvZGlvJ10uZW5jb2RlKCd1dGYtOCcpCgkJYnIgPSAnJwoJCWZpbmFsID0gJycKCQlzZW1MZWdlbmRhID0gJycKCQlpZiBpWydmaW10ZW1wb3JhZGEnXSA9PSAxOgoJCQlmaW5hbCA9ICdbQl1GaW5hbCBkYSBUZW1wb3JhZGEgWy9CXScKCQlpZiBpWydzZW1sZWdlbmRhJ10gPT0gMToKCQkJc2VtTGVnZW5kYSA9ICdbQ09MT1IgcmVkXVtCXVMvIExFR0VOREEgWy9CXVsvQ09MT1JdJwoJCSNpZiAnQnJhc2lsZWlybycgaW4gY2F0ZWdvcmlhOgoJCSMJYnIgPSAnW0JdW0NPTE9SIGdyZWVuXUJbL0NPTE9SXVtDT0xPUiB5ZWxsb3ddUlsvQ09MT1JdOiBbL0JdJwoJCSNpZiAnUG9ydHUnIGluIGNhdGVnb3JpYToKCQkjCXB0ID0gJ1tCXVtDT0xPUiBncmVlbl1QWy9DT0xPUl1bQ09MT1IgcmVkXVRbL0NPTE9SXTogWy9CXScKCQlpZiAnUFQnIGluIGlbJ0lNQkQnXToKCQkJaVsnSU1CRCddID0gcmUuY29tcGlsZSgnKC4rPylQVCcpLmZpbmRhbGwoaVsnSU1CRCddKVswXQoJCQlwdCA9ICdbQl1bQ09MT1IgZ3JlZW5dUFsvQ09MT1JdW0NPTE9SIHJlZF1UWy9DT0xPUl06IFsvQl0nCgkJdmlzdG8gPSBGYWxzZQoJCWNvciA9ICd3aGl0ZScKCQkjaWYgaVsndmlzdG8nXSA9PSAxOgoJCSMJdmlzdG8gPSBUcnVlCQoJCQoJCWltYWdlbSA9ICcnCgkJaWYgaVsnaW1hZ2VtJ10gPT0gMToKCQkJaW1hZ2VtID0gX19BUElfXysnaW1hZ2VzL3Nlcmllcy8nK2lbJ0lNQkQnXSsnLmpwZycKCQllbGlmIGlbJ2ltYWdlbSddID09IDA6CgkJCWltYWdlbSA9IF9fQVBJX18rJ2ltYWdlcy9jYXBhcy8nK2lbJ2ltZGJTZXJpZSddKycuanBnJwoJCQoJCSNpbWFnZW0gPSBpbWFnZW0ucmVwbGFjZSgnUFQnLCcnKQoJCSNpWydiYWNrZ3JvdW5kJ10gPSBpWydiYWNrZ3JvdW5kJ10ucmVwbGFjZSgnUFQnLCcnKQoJCWlbJ2JhY2tncm91bmQnXSA9ICdpbWFnZXMvYmFja2dyb3VuZC8nK2lbJ0lNQkQnXSsnLmpwZycKCQlmYW5hcnR0dCA9IF9fQVBJX18raVsnYmFja2dyb3VuZCddCgkJCgkJbm9tZWVlID0gcHQrYnIrZmluYWwrc2VtTGVnZW5kYSsnW0NPTE9SICcrY29yKyddW0JdRXBpc29kaW8gJytzdHIoaVsnZXBpc29kaW8nXSkrJ1svQl1bL0NPTE9SXSAnK3JlbW92ZXJBY2VudG9zKG5vbWUpCgkJdXJsbm92byA9IF9fQVBJX1NJVEVfXyt0aXBvKycucGhwP2FjdGlvbj1lcGlzb2RpbyZpZFNlcmllPScrc3RyKGlbJ2lkX3NlcmllJ10pKycmaWRFcGlzb2Rpbz0nK3N0cihpWydpZF9lcGlzb2RpbyddKQoJCWFkZFZpZGVvKG5vbWVlZSwgdXJsbm92bywgMTEzLCBpbWFnZW0sIHZpc3RvLCAnZXBpc29kaW8nLCBpWyd0ZW1wb3JhZGEnXSwgaVsnZXBpc29kaW8nXSwgaW5mb0xhYmVscywgZmFuYXJ0dHQpCgkKCXZpc3RhX2VwaXNvZGlvcygpCgpkZWYgZ2V0R2VuZXJvcyh1cmwpOgoJbGlzdGEgPSBnZXRMaXN0Q2F0ZWdvcmlhKCkKCWlmICdmaWxtZXMnIGluIHVybDoKCQl0aXBvID0gMAoJCXF1YWxpZGFkZSA9ICcmcXVhbGlkYWRlPScrX19RdWFsaWRhZGVfXwoJZWxpZiAnc2VyaWVzJyBpbiB1cmw6CgkJdGlwbyA9IDEKCQlxdWFsaWRhZGUgPSAnJwoJZWxpZiAnYW5pbWVzJyBpbiB1cmw6CgkJdGlwbyA9IDIKCQlxdWFsaWRhZGUgPSAnJwoJCglmb3IgYyBpbiBhc3QubGl0ZXJhbF9ldmFsKGxpc3RhKToKCQlpZiBjWydpZF9jYXRlZ29yaWEnXSA9PSAiMCI6CgkJCWNvbnRpbnVlCgkJdHJ5OgoJCQljYXQgPSBjWydjYXRlZ29yaWFzJ10uZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OgoJCQljYXQgPSBjWydjYXRlZ29yaWFzJ10uZW5jb2RlKCd1dGYtOCcpCgkJCgkJdXJsbm92byA9IHVybCsnJmNhdGVnb3JpYT0nK3N0cihjWydpZF9jYXRlZ29yaWEnXSkrcXVhbGlkYWRlOwoJCWFkZERpcjIoY2F0LCB1cmxub3ZvLCAxMjIsICdjYXRlZ29yaWFzJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2dlbmVyby5wbmcnKSkKCQoJdmlzdGFfbWVudSgpCgpkZWYgc2V0RmlsbWUoaSwgdmlzdG9zLCBvcGNhbyk6CgljYXRlZ29yaWEgPSBnZXRDYXRlZ29yaWEoaVsnY2F0ZWdvcmlhMSddKQoJaWYgaW50KGlbJ2NhdGVnb3JpYTInXSkgIT0gMDoKCQljYXRlZ29yaWEgKz0gJywnK2dldENhdGVnb3JpYShpWydjYXRlZ29yaWEyJ10pCglpZiBpbnQoaVsnY2F0ZWdvcmlhMyddKSAhPSAwOgoJCWNhdGVnb3JpYSArPSAnLCcrZ2V0Q2F0ZWdvcmlhKGlbJ2NhdGVnb3JpYTMnXSkKCQoJcHQgPSAnJwoJYnIgPSAnJwoJc2VtTGVnZW5kYSA9ICcnCgl2aXN0byA9IEZhbHNlCgl2aXN0b2EgPSBGYWxzZQoJdmVyaWZpY2FyVmlzdG9Mb2NhbChpWydpZF92aWRlbyddKQoJCgl0cnk6CgkJbm9tZSA9IGlbJ25vbWVfaW5nbGVzJ10uZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6CgkJbm9tZSA9IGlbJ25vbWVfaW5nbGVzJ10uZW5jb2RlKCd1dGYtOCcpCglpZiAnaHR0cCcgbm90IGluIGlbJ2ZvdG8nXToKCQlpWydmb3RvJ10gPSBfX0FQSV9fKydpbWFnZXMvY2FwYXMvJytpWydmb3RvJ10uc3BsaXQoJy8nKVstMV0KCQoJaWYgaVsnbGVnZW5kYSddID09ICJzZW1sZWdlbmRhIjoKCQlzZW1MZWdlbmRhID0gJ1tDT0xPUiByZWRdW0JdUy8gTEVHRU5EQSBbL0JdWy9DT0xPUl0nCglpZiAnQnJhc2lsZWlybycgaW4gY2F0ZWdvcmlhOgoJCWJyID0gJ1tCXVtDT0xPUiBncmVlbl1CWy9DT0xPUl1bQ09MT1IgeWVsbG93XVJbL0NPTE9SXTogWy9CXScKCWlmICdQb3J0dScgaW4gY2F0ZWdvcmlhOgoJCXB0ID0gJ1tCXVtDT0xPUiBncmVlbl1QWy9DT0xPUl1bQ09MT1IgcmVkXVRbL0NPTE9SXTogWy9CXScKCWNvciA9ICJ3aGl0ZSIKCWlmICdQVCcgaW4gaVsnSU1CRCddOgoJCWlbJ0lNQkQnXSA9IHJlLmNvbXBpbGUoJyguKz8pUFQnKS5maW5kYWxsKGlbJ0lNQkQnXSlbMF0KCQlwdCA9ICdbQl1bQ09MT1IgZ3JlZW5dUFsvQ09MT1JdW0NPTE9SIHJlZF1UWy9DT0xPUl06IFsvQl0nCgkKCWltZGJSID0ganNvbi5sb2FkcyhpWydpbWRiUmF0aW5nJ10pCgkKCWluZm9MYWJlbHMgPSB7J1RpdGxlJzogaVsnbm9tZV9pbmdsZXMnXSwgJ1llYXInOiBpWydhbm8nXSwgJ0dlbnJlJzogY2F0ZWdvcmlhLCAnUGxvdCc6aVsnZGVzY3JpY2FvX3ZpZGVvJ10sICdDYXN0JzppWydhdG9yZXMnXS5zcGxpdCgnLCcpLCAnVHJhaWxlcic6IGltZGJSWyd0cmFpbGVyJ10sICdEaXJlY3Rvcic6IGlbJ2RpcmV0b3InXSwgJ1JhdGluZyc6IGltZGJSWydyYW5raW5nJ10sICdJTURCTnVtYmVyJzogaVsnSU1CRCddIH0KCglub21lZWUgPSAnW0NPTE9SICcrY29yKyddJytwdCticitzZW1MZWdlbmRhK3JlbW92ZXJBY2VudG9zKG5vbWUpKycgKCcraVsnYW5vJ10rJylbL0NPTE9SXScKCXVybG5vbyA9IF9fQVBJX1NJVEVfXysnZmlsbWVzLnBocD9hY3Rpb249aWQmaWRGaWxtZT0nK3N0cihpWydpZF92aWRlbyddKQoJZm90b29vID0gaVsnZm90byddCglpWydiYWNrZ3JvdW5kJ10gPSAnaW1hZ2VzL2JhY2tncm91bmQvJytpWydJTUJEJ10rJy5qcGcnCglmYW5hcnR0dCA9IF9fQVBJX18raVsnYmFja2dyb3VuZCddCgkKCWFkZFZpZGVvKG5vbWVlZSwgdXJsbm9vLCAxMTMsIGZvdG9vbyx2aXN0bywgJ3BsYXllcicsIDAsIDAsIGluZm9MYWJlbHMsIGZhbmFydHR0LCB0cmFpbGVyPWltZGJSWyd0cmFpbGVyJ10pCgpkZWYgc2V0U2VyaWVzKGksIHZpc3Rvcywgb3BjYW8sIHRpcG8pOgoJY2F0ZWdvcmlhID0gZ2V0Q2F0ZWdvcmlhKGlbJ2NhdGVnb3JpYTEnXSkKCWlmIGludChpWydjYXRlZ29yaWEyJ10pICE9IDA6CgkJY2F0ZWdvcmlhICs9ICcsJytnZXRDYXRlZ29yaWEoaVsnY2F0ZWdvcmlhMiddKQoJaWYgaW50KGlbJ2NhdGVnb3JpYTMnXSkgIT0gMDoKCQljYXRlZ29yaWEgKz0gJywnK2dldENhdGVnb3JpYShpWydjYXRlZ29yaWEzJ10pCgkKCXB0ID0gJycKCWJyID0gJycKCXNlbUxlZ2VuZGEgPSAnJwoJI2lmIGlbJ2xlZ2VuZGEnXSA9PSAic2VtbGVnZW5kYSI6CgkjCXNlbUxlZ2VuZGEgPSAnW0NPTE9SIHJlZF1bQl1TLyBMRUdFTkRBIFsvQl1bL0NPTE9SXScKCWlmICdCcmFzaWxlaXJvJyBpbiBjYXRlZ29yaWE6CgkJYnIgPSAnW0JdW0NPTE9SIGdyZWVuXUJbL0NPTE9SXVtDT0xPUiB5ZWxsb3ddUlsvQ09MT1JdOiBbL0JdJwoJaWYgJ1BvcnR1JyBpbiBjYXRlZ29yaWE6CgkJcHQgPSAnW0JdW0NPTE9SIGdyZWVuXVBbL0NPTE9SXVtDT0xPUiByZWRdVFsvQ09MT1JdOiBbL0JdJwoJaWYgJ1BUJyBpbiBpWydJTUJEJ106CgkJcHQgPSAnW0JdW0NPTE9SIGdyZWVuXVBbL0NPTE9SXVtDT0xPUiByZWRdVFsvQ09MT1JdOiBbL0JdJwoJdmlzdG8gPSBGYWxzZQoJdmlzdG9hID0gRmFsc2UKCXZlcmlmaWNhclZpc3RvTG9jYWwoaVsnaWRfdmlkZW8nXSkKCXRyeToKCQlub21lID0gaVsnbm9tZV9pbmdsZXMnXS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDoKCQlub21lID0gaVsnbm9tZV9pbmdsZXMnXS5lbmNvZGUoJ3V0Zi04JykKCWlmICdodHRwJyBub3QgaW4gaVsnZm90byddOgoJCWlbJ2ZvdG8nXSA9IF9fQVBJX18rJ2ltYWdlcy9jYXBhcy8nK2lbJ2ZvdG8nXS5zcGxpdCgnLycpWy0xXQoJCSNpWydmb3RvJ10gPSBpWydmb3RvJ10ucmVwbGFjZSgnUFQnLCcnKQoJCglpbWRiUiA9IGpzb24ubG9hZHMoaVsnaW1kYlJhdGluZyddKQoJdXJsbm9vID0gX19BUElfU0lURV9fK3RpcG8rJy5waHA/YWN0aW9uPWlkJmlkU2VyaWU9JytzdHIoaVsnaWRfdmlkZW8nXSkKCWluZm9MYWJlbHMgPSB7J1RpdGxlJzogaVsnbm9tZV9pbmdsZXMnXSwgJ1llYXInOiBpWydhbm8nXSwgJ0dlbnJlJzogY2F0ZWdvcmlhLCAnUGxvdCc6IGlbJ2Rlc2NyaWNhb192aWRlbyddLCAnQ2FzdCc6aVsnYXRvcmVzJ10uc3BsaXQoJywnKSwgJ1RyYWlsZXInOiBpbWRiUlsndHJhaWxlciddLCAnRGlyZWN0b3InOiBpWydkaXJldG9yJ10sICdSYXRpbmcnOiBpbWRiUlsncmFua2luZyddLCAnQ29kZSc6IGlbJ0lNQkQnXSB9CgkKCW5vbWVlZSA9IHB0K2JyK3NlbUxlZ2VuZGErcmVtb3ZlckFjZW50b3Mobm9tZSkrJyAoJytpWydhbm8nXSsnKScKCWZvdG9vbyA9IGlbJ2ZvdG8nXQoJI2lbJ2JhY2tncm91bmQnXSA9IGlbJ2JhY2tncm91bmQnXS5yZXBsYWNlKCdQVCcsJycpCglpWydiYWNrZ3JvdW5kJ10gPSAnaW1hZ2VzL2JhY2tncm91bmQvJytpWydJTUJEJ10rJy5qcGcnCglmYW5hcnR0dCA9IF9fQVBJX18raVsnYmFja2dyb3VuZCddCglhZGREaXIyKG5vbWVlZSwgdXJsbm9vLCAxMTQsICd0ZW1wb3JhZGFzJywgZm90b29vLCB0aXBvPSdzZXJpZScsIGluZm9MYWJlbHM9aW5mb0xhYmVscyxwb3N0ZXI9ZmFuYXJ0dHQsdmlzdG89dmlzdG8pCgpkZWYgY2F0ZWdvcmlhcyh1cmwpOgoJI2hlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICdCZWFyZXIgJXMnICUgX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuTXJwaXJhY3knKQoJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCwgaGVhZGVyPWhlYWRlcnMsIGNvb2tpZT1nZXRDb29raWUoKSkKCSNpZiByZXN1bHRhZG8gPT0gJ0ROUyc6CgkjCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1RlbSBkZSBhbHRlcmFyIG9zIEROUyBwYXJhIHBvZGVyIHVzdWZydWlyIGRvIF9fQURET05fXy4nKQoJIwlyZXR1cm4gRmFsc2UKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJdmlzdG9zID0gRGF0YWJhc2Uuc2VsZWN0RmlsbWVzKCkKCW9wY2FvID0gX19BRERPTl9fLmdldFNldHRpbmcoJ21hcmNhclZpc3RvJykKCWlmICdzZXJpZScgaW4gdXJsOgoJCXRpcG8gPSAnc2VyaWVzJwoJZWxpZiAnYW5pbWUnIGluIHVybDoKCQl0aXBvID0gJ2FuaW1lcycKCWZvciBpIGluIHJlc3VsdGFkb1siZGF0YSJdOgoJCWlmICdmaWxtZScgaW4gdXJsOgoJCQlzZXRGaWxtZShpLCB2aXN0b3MsIG9wY2FvKQoJCWVsaWYgJ3NlcmllJyBpbiB1cmwgb3IgJ2FuaW1lJyBpbiB1cmw6CgkJCXNldFNlcmllcyhpLCB2aXN0b3MsIG9wY2FvLCB0aXBvKQoJY3VycmVudCA9IHJlc3VsdGFkb1snbWV0YSddWydjdXJyZW50J10KCXRvdGFsID0gcmVzdWx0YWRvWydtZXRhJ11bJ3RvdGFsJ10KCXRyeTogcHJveGltbyA9IHJlc3VsdGFkb1snbWV0YSddWydwYWdpbmFjYW8nXVsnbmV4dCddCglleGNlcHQ6IHBhc3MgCglpZiBpbnQoY3VycmVudCkgPCBpbnQodG90YWwpOgoJCWFkZERpcjIoJ1Byw7N4aW1hIHDDoWdpbmEgKCcrc3RyKGN1cnJlbnQpKycvJytzdHIodG90YWwpKycpJywgcHJveGltbywgMTIxLCAnYW5vcycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdwcm94aW1vLnBuZycpLDEpCgkKCXZpc3RhX2ZpbG1lc1NlcmllcygpCgpkZWYgZ2V0WWVhcnModXJsKToKCWFub3MgPSBbCgkJCScyMDE5JywKCQkJJzIwMTgnLAoJCQknMjAxNycsCgkJCScyMDE2JywKCQkJJzIwMTUnLAoJCQknMjAxNCcsCgkJCScyMDEzJywKCQkJJzIwMTInLAoJCQknMjAxMScsCgkJCScyMDEwJywKCQkJJzIwMDknLAoJCQknMjAwOCcsCgkJCScyMDA3JywKCQkJJzIwMDYnLAoJCQknMjAwMC0yMDA1JywKCQkJJzE5OTAtMTk5OScsCgkJCScxOTgwLTE5ODknLAoJCQknMTk3MC0xOTc5JywKCQkJJzE5NjAtMTk2OScsCgkJCScxOTUwLTE5NTknLAoJCQknMTkwMC0xOTQ5JwoJCV0KCWlmICdmaWxtZXMnIGluIHVybDoKCQl0aXBvID0gMAoJCXF1YWxpZGFkZSA9ICcmcXVhbGlkYWRlPScrX19RdWFsaWRhZGVfXwoJZWxpZiAnc2VyaWVzJyBpbiB1cmw6CgkJdGlwbyA9IDEKCQlxdWFsaWRhZGUgPSAnJwoJZWxpZiAnYW5pbWVzJyBpbiB1cmw6CgkJdGlwbyA9IDIKCQlxdWFsaWRhZGUgPSAnJwoJZm9yIGkgaW4gYW5vczoKCQl1cmxub3ZvID0gdXJsKycmYW5vPScraStxdWFsaWRhZGU7CgkJYWRkRGlyMihpLCB1cmxub3ZvLCAxMjEsICdhbm9zJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Fuby5wbmcnKSkKCQkKCXZpc3RhX21lbnUoKQoKZGVmIGFub3ModXJsKToKCSNoZWFkZXJzWydBdXRob3JpemF0aW9uJ10gPSAnQmVhcmVyICVzJyAlIF9fQURET05fXy5nZXRTZXR0aW5nKCd0b2tlbk1ycGlyYWN5JykKCXJlc3VsdGFkbyA9IGFicmlyX3VybCh1cmwsIGhlYWRlcj1oZWFkZXJzLCBjb29raWU9Z2V0Q29va2llKCkpCglpZiByZXN1bHRhZG8gPT0gJ0ROUyc6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVGVtIGRlIGFsdGVyYXIgb3MgRE5TIHBhcmEgcG9kZXIgdXN1ZnJ1aXIgZG8gX19BRERPTl9fLicpCgkJcmV0dXJuIEZhbHNlCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCXZpc3RvcyA9IERhdGFiYXNlLnNlbGVjdEZpbG1lcygpCglvcGNhbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCdtYXJjYXJWaXN0bycpCglpZiAnc2VyaWUnIGluIHVybDoKCQl0aXBvID0gJ3NlcmllcycKCWVsaWYgJ2FuaW1lJyBpbiB1cmw6CgkJdGlwbyA9ICdhbmltZXMnCglmb3IgaSBpbiByZXN1bHRhZG9bImRhdGEiXToKCQlpZiAnZmlsbWUnIGluIHVybDoKCQkJc2V0RmlsbWUoaSwgdmlzdG9zLCBvcGNhbykKCQllbGlmICdzZXJpZScgaW4gdXJsIG9yICdhbmltZScgaW4gdXJsOgoJCQlzZXRTZXJpZXMoaSwgdmlzdG9zLCBvcGNhbywgdGlwbykKCQoJdHJ5OiAKCQljdXJyZW50ID0gcmVzdWx0YWRvWydtZXRhJ11bJ2N1cnJlbnQnXQoJZXhjZXB0OiAKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdBZ3VhcmRlIHBlbGEgcHLDs3hpbWEgYXR1YWxpemHDp8Ojby4gT3UgdGVudGUgbWFpcyB0YXJkZS4nKQoJCXJldHVybiBGYWxzZQoJY3VycmVudCA9IHJlc3VsdGFkb1snbWV0YSddWydjdXJyZW50J10KCXRvdGFsID0gcmVzdWx0YWRvWydtZXRhJ11bJ3RvdGFsJ10KCXRyeTogcHJveGltbyA9IHJlc3VsdGFkb1snbWV0YSddWydwYWdpbmFjYW8nXVsnbmV4dCddCglleGNlcHQ6IHBhc3MgCglpZiBpbnQoY3VycmVudCkgPCBpbnQodG90YWwpOgoJCWFkZERpcjIoJ1Byw7N4aW1hIHDDoWdpbmEgKCcrc3RyKGN1cnJlbnQpKycvJytzdHIodG90YWwpKycpJywgcHJveGltbywgMTIxLCAnYW5vcycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdwcm94aW1vLnBuZycpLDEpCgkKCXZpc3RhX2ZpbG1lc1NlcmllcygpCgpkZWYgZ2V0RXZlbnRvcygpOgoJI2hlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICdCZWFyZXIgJXMnICUgX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuTXJwaXJhY3knKQoJcmVzdWx0YWRvID0gYWJyaXJfdXJsKF9fQVBJX1NJVEVfXysnZXZlbnRvcycsIGhlYWRlcj1oZWFkZXJzLCBjb29raWU9Z2V0Q29va2llKCkpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCXRyeToKCQlpZiByZXN1bHRhZG9bJ2NvZGlnbyddID09IDIwNDoKCQkJcmV0dXJuIEZhbHNlCglleGNlcHQ6CgkJcGFzcwoJcmV0dXJuIHJlc3VsdGFkb1snZGF0YSddWydub21lJ10KCQkKCQkKZGVmIHBsYXllcihuYW1lLHVybCxpY29uaW1hZ2UsdGVtcG9yYWRhLGVwaXNvZGlvLHNlcmllTm9tZSk6CgkjaGVhZGVyc1snQXV0aG9yaXphdGlvbiddID0gJ0JlYXJlciAlcycgJSBfX0FERE9OX18uZ2V0U2V0dGluZygndG9rZW5NcnBpcmFjeScpCglyZXN1bHRhZG8gPSBhYnJpcl91cmwodXJsLCBoZWFkZXI9aGVhZGVycywgY29va2llPWdldENvb2tpZSgpKQoJaWYgcmVzdWx0YWRvID09ICdETlMnOgoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1RlbSBkZSBhbHRlcmFyIG9zIEROUyBwYXJhIHBvZGVyIHVzdWZydWlyIGRvIF9fQURET05fXy4nKQoJCXJldHVybiBGYWxzZQoJCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbylbMF0KCSNyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCWluZm9sYWJlbHMgPSBkaWN0KCkKCWNvaXNvID0gJycKCXBhc3RhRGF0YSA9ICcnCgl0aXBvID0gJycKCWlkVmlkZW8gPSAnJwoJaWYgJ2ZpbG1lJyBpbiB1cmw6CgkJdGlwbyA9ICdmaWxtZScKCQlpbmZvbGFiZWxzWydDb2RlJ10gPSByZXN1bHRhZG9bJ0lNQkQnXQoJCWluZm9sYWJlbHNbJ1llYXInXSA9IHJlc3VsdGFkb1snYW5vJ10KCQlpZFZpZGVvID0gcmVzdWx0YWRvWydpZF92aWRlbyddCgkJbm9tZSA9IHJlc3VsdGFkb1snbm9tZV9pbmdsZXMnXQoJCXRlbXBvcmFkYSA9IDAKCQllcGlzb2RpbyA9IDAKCQljb2lzbyA9ICdmaWxtZScKCWVsc2U6CgkJaWYgJ3NlcmllJyBpbiB1cmw6CgkJCXRpcG8gPSAnc2VyaWUnCgkJZWxzZToKCQkJdGlwbyA9ICdhbmltZScKCQlpZFZpZGVvID0gcmVzdWx0YWRvWydpZF9zZXJpZSddCgkJbm9tZSA9IHJlc3VsdGFkb1snbm9tZV9lcGlzb2RpbyddCgkJdGVtcG9yYWRhID0gcmVzdWx0YWRvWyd0ZW1wb3JhZGEnXQoJCWVwaXNvZGlvID0gcmVzdWx0YWRvWydlcGlzb2RpbyddCgkJY29pc28gPSAnb3V0cm8nCgoJbWVuc2FnZW1wcm9ncmVzc28gPSB4Ym1jZ3VpLkRpYWxvZ1Byb2dyZXNzKCkKCW1lbnNhZ2VtcHJvZ3Jlc3NvLmNyZWF0ZShBZGRvblRpdGxlLCB1J0FicmlyIGVtaXNzw6NvJywnUG9yIGZhdm9yIGFndWFyZGUuLi4nKQoJbWVuc2FnZW1wcm9ncmVzc28udXBkYXRlKDI1LCAiIiwgdSdPYnRlciB2aWRlbyBlIGxlZ2VuZGEnLCAiIikKCglzdHJlYW0sIGxlZ2VuZGEsIGV4dF9nID0gZ2V0U3RyZWFtTGVnZW5kYShpZFZpZGVvLCB0aXBvLCBjb2lzbz1jb2lzbykKCWlmIHN0cmVhbSA9PSBGYWxzZSBhbmQgbGVnZW5kYSA9PSAyMDQ6CgkJbWVuc2FnZW1wcm9ncmVzc28uY2xvc2UoKQoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1RlbSBkZSBlc3BlcmFyIDggaG9yYXMgYXTDqSBjb25zZWd1aXIgdmlzdWFsaXphciBhbGd1bSB2aWRlby4nKQoJCXJldHVybiBGYWxzZQoJCgltZW5zYWdlbXByb2dyZXNzby51cGRhdGUoNTAsICIiLCB1J1ByZXBhcmEtdGUsIHZhaSBjb21lw6dhciEnLCAiIikKCXBsYXlsaXN0ID0geGJtYy5QbGF5TGlzdCgxKQoJcGxheWxpc3QuY2xlYXIoKQoJbGlzdGl0ZW0gPSB4Ym1jZ3VpLkxpc3RJdGVtKG5hbWUsIGljb25JbWFnZT0iRGVmYXVsdFZpZGVvLnBuZyIsIHRodW1ibmFpbEltYWdlPWljb25pbWFnZSkKCglsaXN0aXRlbS5zZXRJbmZvKHR5cGU9IlZpZGVvIiwgaW5mb0xhYmVscz1pbmZvbGFiZWxzKQoJbGlzdGl0ZW0uc2V0UHJvcGVydHkoJ21pbWV0eXBlJywgJ3ZpZGVvL3gtbXN2aWRlbycpCglsaXN0aXRlbS5zZXRQcm9wZXJ0eSgnSXNQbGF5YWJsZScsICd0cnVlJykKCQoJbGlzdGl0ZW0uc2V0UGF0aChwYXRoPXN0cmVhbSkKCXBsYXlsaXN0LmFkZChzdHJlYW0sIGxpc3RpdGVtKQoJeGJtY3BsdWdpbi5zZXRSZXNvbHZlZFVybChpbnQoc3lzLmFyZ3ZbMV0pLCBUcnVlLCBsaXN0aXRlbSkKCW1lbnNhZ2VtcHJvZ3Jlc3NvLnVwZGF0ZSg3NSwgIiIsIHUnQm9hIFNlc3PDo28hISEnLCAiIikKCglpZiBzdHJlYW0gPT0gRmFsc2U6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnTyBzZXJ2aWRvciBlc2NvbGhpZG8gbsOjbyBkaXNwb27DrXZlbCwgZXNjb2xoYSBvdXRybyBvdSB0ZW50ZSBub3ZhbWVudGUgbWFpcyB0YXJkZS4nKQoJZWxzZToKCQkjX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnU3RyZWFtOiAnK3N0cmVhbSkKCQlwbGF5ZXJfbXIgPSBQbGF5ZXIuUGxheWVyKHVybD11cmwsIGlkRmlsbWU9aWRWaWRlbywgcGFzdGFEYXRhPV9fUEFTVEFfREFET1NfXywgdGVtcG9yYWRhPXRlbXBvcmFkYSwgZXBpc29kaW89ZXBpc29kaW8sIG5vbWU9bmFtZSwgbG9nbz1vcy5wYXRoLmpvaW4oX19BRERPTl9GT0xERVJfXywnaWNvbi5wbmcnKSkKCQkKCQltZW5zYWdlbXByb2dyZXNzby5jbG9zZSgpCgkJcGxheWVyX21yLnBsYXkocGxheWxpc3QpCgkJcGxheWVyX21yLnNldFN1YnRpdGxlcyhsZWdlbmRhKQoKCQl3aGlsZSBwbGF5ZXJfbXIucGxheWluZzoKCQkJeGJtYy5zbGVlcCg1MDAwKQoJCQkjcGxheWVyX21yLnRyYWNrZXJUZW1wbygpCgpkZWYgbWFyY2FyVmlzdG8odXJsKToKCXJlc3VsdGFkbyA9IGFicmlyX3VybCh1cmwsIGhlYWRlcj1oZWFkZXJzLCBjb29raWU9Z2V0Q29va2llKCkpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbylbMF0KCWxpbmtzID0gdXJsLnNwbGl0KCcvJykKCW9wY2FvID0gX19BRERPTl9fLmdldFNldHRpbmcoJ21hcmNhclZpc3RvJykKCWlmICdmaWxtZScgaW4gdXJsOgoJCWlkX3ZpZGVvID0gcmVzdWx0YWRvWydpZF92aWRlbyddCgkJaW1kYiA9IHJlc3VsdGFkb1snSU1CRCddCgkJcG9zdCA9IHsnaWRfZmlsbWUnOiBpZF92aWRlb30KCQl0aXBvID0gMAoJZWxpZiAnc2VyaWUnIGluIHVybDoKCQlpbWRiICA9IHJlc3VsdGFkb1snZm90b1NlcmllJ10uc3BsaXQoJy8nKVstMV0uc3BsaXQoJy4nKVswXQoJCWlkX3ZpZGVvID0gcmVzdWx0YWRvWydpZF9zZXJpZSddCgkJdGVtcG9yYWRhID0gcmVzdWx0YWRvWyd0ZW1wb3JhZGEnXQoJCWVwaXNvZGlvID0gcmVzdWx0YWRvWydlcGlzb2RpbyddCgkJcG9zdCA9IHsnaWRfc2VyaWUnOiBpZF92aWRlbywgJ3RlbXBvcmFkYSc6IHRlbXBvcmFkYSwgJ2VwaXNvZGlvJzplcGlzb2Rpb30KCQl0aXBvID0gMQoJZWxpZiAnYW5pbWUnIGluIHVybDoKCQlpbWRiICA9IHJlc3VsdGFkb1snZm90b1NlcmllJ10uc3BsaXQoJy8nKVstMV0uc3BsaXQoJy4nKVswXQoJCWlkX3ZpZGVvID0gcmVzdWx0YWRvWydpZF9zZXJpZSddCgkJdGVtcG9yYWRhID0gcmVzdWx0YWRvWyd0ZW1wb3JhZGEnXQoJCWVwaXNvZGlvID0gcmVzdWx0YWRvWydlcGlzb2RpbyddCgkJcG9zdCA9IHsnaWRfYW5pbWUnOiBpZF92aWRlbywgJ3RlbXBvcmFkYSc6IHRlbXBvcmFkYSwgJ2VwaXNvZGlvJzplcGlzb2Rpb30KCQl0aXBvID0gMgoJcGFzdGFWaXN0bz1vcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCd2aXN0b3MnKQoJdHJ5OgoJCW9zLm1ha2VkaXJzKHBhc3RhVmlzdG8pCglleGNlcHQ6CgkJcGFzcwoJaWYgdGlwbyA9PSAxIG9yIHRpcG8gPT0gMjoKCQlmaWNoZWlybyA9IG9zLnBhdGguam9pbihwYXN0YVZpc3RvLCBzdHIoaWRfdmlkZW8pKydfUycrc3RyKHRlbXBvcmFkYSkrJ3gnK3N0cihlcGlzb2RpbykrJy5saXZlaXQnKQoJZWxpZiB0aXBvID09IDA6CgkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4ocGFzdGFWaXN0bywgc3RyKGlkX3ZpZGVvKSsnLmxpdmVpdCcpCglpZiBub3Qgb3MucGF0aC5leGlzdHMoZmljaGVpcm8pOgoJCWYgPSBvcGVuKGZpY2hlaXJvLCAndycpCgkJZi53cml0ZSgnJykKCQlmLmNsb3NlKCkKCWVzY3JldmVyX2ZpY2hlaXJvKG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ3Zpc3Rvc19maWxtZXMubGl2ZWl0JyksIHZpc3Rvc19maWxtZXMpCgl4Ym1jLmV4ZWN1dGVidWlsdGluKCJYQk1DLk5vdGlmaWNhdGlvbigiK0FkZG9uVGl0bGUrIiwiKyJNYXJjYWRvIGNvbW8gdmlzdG8iKyIsIisiNjAwMSIrIiwiKyBvcy5wYXRoLmpvaW4oY29udHJvbG8uYWRkb25Gb2xkZXIsJ2ljb24ucG5nJykrIikiKQoJeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlJlZnJlc2giKQoKZGVmIG1hcmNhck5hb1Zpc3RvKHVybCk6CglyZXN1bHRhZG8gPSBhYnJpcl91cmwodXJsLCBoZWFkZXI9aGVhZGVycywgY29va2llPWdldENvb2tpZSgpKQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pWzBdCglsaW5rcyA9IHVybC5zcGxpdCgnLycpCglvcGNhbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCdtYXJjYXJWaXN0bycpCglpZiAnZmlsbWUnIGluIHVybDoKCQlpZF92aWRlbyA9IHJlc3VsdGFkb1snaWRfdmlkZW8nXQoJCWltZGIgPSByZXN1bHRhZG9bJ0lNQkQnXQoJCXBvc3QgPSB7J2lkX2ZpbG1lJzogaWRfdmlkZW99CgkJdGlwbyA9IDAKCWVsaWYgJ3NlcmllJyBpbiB1cmw6CgkJaW1kYiAgPSByZXN1bHRhZG9bJ2ZvdG9TZXJpZSddLnNwbGl0KCcvJylbLTFdLnNwbGl0KCcuJylbMF0KCQlpZF92aWRlbyA9IHJlc3VsdGFkb1snaWRfc2VyaWUnXQoJCXRlbXBvcmFkYSA9IHJlc3VsdGFkb1sndGVtcG9yYWRhJ10KCQllcGlzb2RpbyA9IHJlc3VsdGFkb1snZXBpc29kaW8nXQoJCXBvc3QgPSB7J2lkX3NlcmllJzogaWRfdmlkZW8sICd0ZW1wb3JhZGEnOiB0ZW1wb3JhZGEsICdlcGlzb2Rpbyc6ZXBpc29kaW99CgkJdGlwbyA9IDEKCWVsaWYgJ2FuaW1lJyBpbiB1cmw6CgkJaW1kYiAgPSByZXN1bHRhZG9bJ2ZvdG9TZXJpZSddLnNwbGl0KCcvJylbLTFdLnNwbGl0KCcuJylbMF0KCQlpZF92aWRlbyA9IHJlc3VsdGFkb1snaWRfc2VyaWUnXQoJCXRlbXBvcmFkYSA9IHJlc3VsdGFkb1sndGVtcG9yYWRhJ10KCQllcGlzb2RpbyA9IHJlc3VsdGFkb1snZXBpc29kaW8nXQoJCXBvc3QgPSB7J2lkX2FuaW1lJzogaWRfdmlkZW8sICd0ZW1wb3JhZGEnOiB0ZW1wb3JhZGEsICdlcGlzb2Rpbyc6ZXBpc29kaW99CgkJdGlwbyA9IDIKCQoJcGFzdGFWaXN0bz1vcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCd2aXN0b3MnKQoJdHJ5OgoJCW9zLm1ha2VkaXJzKHBhc3RhVmlzdG8pCglleGNlcHQ6CgkJcGFzcwoKCWlmIHRpcG8gPT0gMSBvciB0aXBvID09IDI6CgkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4ocGFzdGFWaXN0bywgc3RyKGlkX3ZpZGVvKSsnX1MnK3N0cih0ZW1wb3JhZGEpKyd4JytzdHIoZXBpc29kaW8pKycubXJwaXJhY3knKQoJZWxpZiB0aXBvID09IDA6CgkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4ocGFzdGFWaXN0bywgc3RyKGlkX3ZpZGVvKSsnLm1ycGlyYWN5JykKCglpZiBvcy5wYXRoLmV4aXN0cyhmaWNoZWlybyk6CgkJb3MucmVtb3ZlKGZpY2hlaXJvKQoJZXNjcmV2ZXJfZmljaGVpcm8ob3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywndmlzdG9zX2ZpbG1lcy5saXZlaXQnKSwgdmlzdG9zKQoJeGJtYy5leGVjdXRlYnVpbHRpbigiWEJNQy5Ob3RpZmljYXRpb24oIitBZGRvblRpdGxlKyIsIisiTWFyY2FkbyBjb21vIHZpc3RvIisiLCIrIjYwMDEiKyIsIisgb3MucGF0aC5qb2luKGNvbnRyb2xvLmFkZG9uRm9sZGVyLCdpY29uLnBuZycpKyIpIikKCXhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5SZWZyZXNoIikKCmRlZiBnZXRTdHJlYW1MZWdlbmRhKGlkLCB0aXBvLCBjb2lzbz1Ob25lKToKCWlmIHRpcG8gPT0gJ2ZpbG1lJzoKCQl1cmwgPSBfX0FQSV9TSVRFX18rdGlwbysncy5waHA/YWN0aW9uPWxpbmtzJmlkRmlsbWU9JytpZAoJaWYgdGlwbyA9PSAnc2VyaWUnOgoJCXVybCA9IF9fQVBJX1NJVEVfXyt0aXBvKydzLnBocD9hY3Rpb249bGlua3MmaWRFcGlzb2Rpbz0nK2lkCglpZiB0aXBvID09ICdhbmltZSc6CgkJdXJsID0gX19BUElfU0lURV9fK3RpcG8rJ3MucGhwP2FjdGlvbj1saW5rcyZpZEVwaXNvZGlvPScraWQKCglyZXN1bHRhZG8gPSBhYnJpcl91cmwodXJsLCBoZWFkZXI9aGVhZGVycywgY29va2llPWdldENvb2tpZSgpKQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pCgl0cnk6CgkJaWYgcmVzdWx0YWRvWydjb2RpZ28nXSA9PSAyMDQ6CgkJCXJldHVybiBGYWxzZSwgMjA0LCAyMDQKCWV4Y2VwdDogCgkJcmVzdWx0YWRvID0gcmVzdWx0YWRvWzBdCgkKCWkgPSAwCglzZXJ2aWRvcmVzID0gW10KCXRpdHVsb3MgPSBbXQoJbm9tZSA9ICcnCgkKCWlmIHJlc3VsdGFkb1snVVJMJ10gIT0gJyc6CgkJaSs9MQoJCWlmICdvcGVubG9hZCcgaW4gcmVzdWx0YWRvWydVUkwnXToKCQkJbm9tZSA9ICJPcGVuTG9hZCIKCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwnXSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3ZpZHppJyBpbiByZXN1bHRhZG9bJ1VSTCddOgoJCQlub21lID0gJ1ZpZHppJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTCddKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAnZ29vZ2xlJyBpbiByZXN1bHRhZG9bJ1VSTCddIG9yICdjbG91ZC5tYWlsLnJ1JyBpbiByZXN1bHRhZG9bJ1VSTCddOgoJCQlub21lID0gQWRkb25UaXRsZQoJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTCddKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAndXB0b3N0cmVhbS5jb20nIGluIHJlc3VsdGFkb1snVVJMJ106CgkJCW5vbWUgPSAnVXBUb1N0cmVhbScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwnXSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3JhcGlkdmlkZW8uY29tJyBpbiByZXN1bHRhZG9bJ1VSTCddIG9yICdyYXB0dScgaW4gcmVzdWx0YWRvWydVUkwnXToKCQkJbm9tZSA9ICdSYXB0dScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwnXSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3ZpZG96YS5uZXQnIGluIHJlc3VsdGFkb1snVVJMJ106CgkJCW5vbWUgPSAnVmlkb3phJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTCddKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAnc3RyZWFtYW5nby4nIGluIHJlc3VsdGFkb1snVVJMJ106CgkJCW5vbWUgPSAnU3RyZWFtYW5nbycKCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwnXSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ21peGRyb3AudG8nIGluIHJlc3VsdGFkb1snVVJMJ10ubG93ZXIoKToKCQkJbm9tZSA9ICdNaXhkcm9wJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTCddKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCglpZiByZXN1bHRhZG9bJ1VSTDInXSAhPSAnJzoKCQlpKz0xCgkJaWYgJ29wZW5sb2FkJyBpbiByZXN1bHRhZG9bJ1VSTDInXToKCQkJbm9tZSA9ICJPcGVuTG9hZCIKCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwyJ10pCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICd2aWR6aScgaW4gcmVzdWx0YWRvWydVUkwyJ106CgkJCW5vbWUgPSAnVmlkemknCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMMiddKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAnZ29vZ2xlJyBpbiByZXN1bHRhZG9bJ1VSTDInXSBvciAnY2xvdWQubWFpbC5ydScgaW4gcmVzdWx0YWRvWydVUkwyJ106CgkJCW5vbWUgPSBBZGRvblRpdGxlCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMMiddKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAndXB0b3N0cmVhbS5jb20nIGluIHJlc3VsdGFkb1snVVJMMiddOgoJCQlub21lID0gJ1VwVG9TdHJlYW0nCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMMiddKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAncmFwaWR2aWRlby5jb20nIGluIHJlc3VsdGFkb1snVVJMMiddIG9yICdyYXB0dScgaW4gcmVzdWx0YWRvWydVUkwyJ106CgkJCW5vbWUgPSAnUmFwdHUnCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMMiddKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAndmlkb3phLm5ldCcgaW4gcmVzdWx0YWRvWydVUkwyJ106CgkJCW5vbWUgPSAnVmlkb3phJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDInXSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3N0cmVhbWFuZ28uJyBpbiByZXN1bHRhZG9bJ1VSTDInXToKCQkJbm9tZSA9ICdTdHJlYW1hbmdvJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDInXSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ21peGRyb3AudG8nIGluIHJlc3VsdGFkb1snVVJMMiddLmxvd2VyKCk6CgkJCW5vbWUgPSAnTWl4ZHJvcCcKCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwyJ10pCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCXRyeToKCQlpZiByZXN1bHRhZG9bJ1VSTDMnXSAhPSAnJzoKCQkJaSs9MQoJCQlpZiAnb3BlbmxvYWQnIGluIHJlc3VsdGFkb1snVVJMMyddOgoJCQkJbm9tZSA9ICJPcGVuTG9hZCIKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMMyddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd2aWR6aScgaW4gcmVzdWx0YWRvWydVUkwzJ106CgkJCQlub21lID0gJ1ZpZHppJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwzJ10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ2dvb2dsZScgaW4gcmVzdWx0YWRvWydVUkwzJ10gb3IgJ2Nsb3VkLm1haWwucnUnIGluIHJlc3VsdGFkb1snVVJMMyddOgoJCQkJbm9tZSA9IEFkZG9uVGl0bGUKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMMyddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd1cHRvc3RyZWFtLmNvbScgaW4gcmVzdWx0YWRvWydVUkwzJ106CgkJCQlub21lID0gJ1VwVG9TdHJlYW0nCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDMnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAncmFwaWR2aWRlby5jb20nIGluIHJlc3VsdGFkb1snVVJMMyddIG9yICdyYXB0dScgaW4gcmVzdWx0YWRvWydVUkwzJ106CgkJCQlub21lID0gJ1JhcHR1JwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwzJ10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3ZpZG96YS5uZXQnIGluIHJlc3VsdGFkb1snVVJMMyddOgoJCQkJbm9tZSA9ICdWaWRvemEnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDMnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAnc3RyZWFtYW5nby4nIGluIHJlc3VsdGFkb1snVVJMMyddOgoJCQkJbm9tZSA9ICdTdHJlYW1hbmdvJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwzJ10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ21peGRyb3AudG8nIGluIHJlc3VsdGFkb1snVVJMMyddLmxvd2VyKCk6CgkJCQlub21lID0gJ01peGRyb3AnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDMnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCWV4Y2VwdDoKCQlwYXNzCgl0cnk6CgkJaWYgcmVzdWx0YWRvWydVUkw0J10gIT0gJyc6CgkJCWkrPTEKCQkJaWYgJ29wZW5sb2FkJyBpbiByZXN1bHRhZG9bJ1VSTDQnXToKCQkJCW5vbWUgPSAiT3BlbkxvYWQiCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDQnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndmlkemknIGluIHJlc3VsdGFkb1snVVJMNCddOgoJCQkJbm9tZSA9ICdWaWR6aScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMNCddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdnb29nbGUnIGluIHJlc3VsdGFkb1snVVJMNCddIG9yICdjbG91ZC5tYWlsLnJ1JyBpbiByZXN1bHRhZG9bJ1VSTDQnXToKCQkJCW5vbWUgPSBBZGRvblRpdGxlCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDQnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndXB0b3N0cmVhbS5jb20nIGluIHJlc3VsdGFkb1snVVJMNCddOgoJCQkJbm9tZSA9ICdVcFRvU3RyZWFtJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkw0J10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3JhcGlkdmlkZW8uY29tJyBpbiByZXN1bHRhZG9bJ1VSTDQnXSBvciAncmFwdHUnIGluIHJlc3VsdGFkb1snVVJMNCddOgoJCQkJbm9tZSA9ICdSYXB0dScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMNCddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd2aWRvemEubmV0JyBpbiByZXN1bHRhZG9bJ1VSTDQnXToKCQkJCW5vbWUgPSAnVmlkb3phJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkw0J10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3N0cmVhbWFuZ28uJyBpbiByZXN1bHRhZG9bJ1VSTDQnXToKCQkJCW5vbWUgPSAnU3RyZWFtYW5nbycKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMNCddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdtaXhkcm9wLnRvJyBpbiByZXN1bHRhZG9bJ1VSTDQnXS5sb3dlcigpOgoJCQkJbm9tZSA9ICdNaXhkcm9wJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkw0J10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCglleGNlcHQ6CgkJcGFzcwoJdHJ5OgoJCWlmIHJlc3VsdGFkb1snVVJMNSddICE9ICcnOgoJCQlpKz0xCgkJCWlmICdvcGVubG9hZCcgaW4gcmVzdWx0YWRvWydVUkw1J106CgkJCQlub21lID0gIk9wZW5Mb2FkIgoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkw1J10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3ZpZHppJyBpbiByZXN1bHRhZG9bJ1VSTDUnXToKCQkJCW5vbWUgPSAnVmlkemknCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDUnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAnZ29vZ2xlJyBpbiByZXN1bHRhZG9bJ1VSTDUnXSBvciAnY2xvdWQubWFpbC5ydScgaW4gcmVzdWx0YWRvWydVUkw1J106CgkJCQlub21lID0gQWRkb25UaXRsZQoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkw1J10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3VwdG9zdHJlYW0uY29tJyBpbiByZXN1bHRhZG9bJ1VSTDUnXToKCQkJCW5vbWUgPSAnVXBUb1N0cmVhbScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMNSddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdyYXBpZHZpZGVvLmNvbScgaW4gcmVzdWx0YWRvWydVUkw1J10gb3IgJ3JhcHR1JyBpbiByZXN1bHRhZG9bJ1VSTDUnXToKCQkJCW5vbWUgPSAnUmFwdHUnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDUnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndmlkb3phLm5ldCcgaW4gcmVzdWx0YWRvWydVUkw1J106CgkJCQlub21lID0gJ1ZpZG96YScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMNSddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdzdHJlYW1hbmdvLicgaW4gcmVzdWx0YWRvWydVUkw1J106CgkJCQlub21lID0gJ1N0cmVhbWFuZ28nCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDUnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAnbWl4ZHJvcC50bycgaW4gcmVzdWx0YWRvWydVUkw1J10ubG93ZXIoKToKCQkJCW5vbWUgPSAnTWl4ZHJvcCcKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMNSddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJZXhjZXB0OgoJCXBhc3MKCXRyeToKCQlpZiByZXN1bHRhZG9bJ1VSTDYnXSAhPSAnJzoKCQkJaSs9MQoJCQlpZiAnb3BlbmxvYWQnIGluIHJlc3VsdGFkb1snVVJMNiddOgoJCQkJbm9tZSA9ICJPcGVuTG9hZCIKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMNiddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd2aWR6aScgaW4gcmVzdWx0YWRvWydVUkw2J106CgkJCQlub21lID0gJ1ZpZHppJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkw2J10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ2dvb2dsZScgaW4gcmVzdWx0YWRvWydVUkw2J10gb3IgJ2Nsb3VkLm1haWwucnUnIGluIHJlc3VsdGFkb1snVVJMNiddOgoJCQkJbm9tZSA9IEFkZG9uVGl0bGUKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMNiddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd1cHRvc3RyZWFtLmNvbScgaW4gcmVzdWx0YWRvWydVUkw2J106CgkJCQlub21lID0gJ1VwVG9TdHJlYW0nCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDYnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAncmFwaWR2aWRlby5jb20nIGluIHJlc3VsdGFkb1snVVJMNiddIG9yICdyYXB0dScgaW4gcmVzdWx0YWRvWydVUkw2J106CgkJCQlub21lID0gJ1JhcHR1JwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkw2J10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3ZpZG96YS5uZXQnIGluIHJlc3VsdGFkb1snVVJMNiddOgoJCQkJbm9tZSA9ICdWaWRvemEnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDYnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAnc3RyZWFtYW5nby4nIGluIHJlc3VsdGFkb1snVVJMNiddOgoJCQkJbm9tZSA9ICdTdHJlYW1hbmdvJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkw2J10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ21peGRyb3AudG8nIGluIHJlc3VsdGFkb1snVVJMNiddLmxvd2VyKCk6CgkJCQlub21lID0gJ01peGRyb3AnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDYnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCWV4Y2VwdDoKCQlwYXNzCgl0cnk6CgkJaWYgcmVzdWx0YWRvWydVUkw3J10gIT0gJyc6CgkJCWkrPTEKCQkJaWYgJ29wZW5sb2FkJyBpbiByZXN1bHRhZG9bJ1VSTDcnXToKCQkJCW5vbWUgPSAiT3BlbkxvYWQiCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDcnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndmlkemknIGluIHJlc3VsdGFkb1snVVJMNyddOgoJCQkJbm9tZSA9ICdWaWR6aScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMNyddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdnb29nbGUnIGluIHJlc3VsdGFkb1snVVJMNyddIG9yICdjbG91ZC5tYWlsLnJ1JyBpbiByZXN1bHRhZG9bJ1VSTDcnXToKCQkJCW5vbWUgPSBBZGRvblRpdGxlCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDcnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndXB0b3N0cmVhbS5jb20nIGluIHJlc3VsdGFkb1snVVJMNyddOgoJCQkJbm9tZSA9ICdVcFRvU3RyZWFtJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkw3J10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3JhcGlkdmlkZW8uY29tJyBpbiByZXN1bHRhZG9bJ1VSTDcnXSBvciAncmFwdHUnIGluIHJlc3VsdGFkb1snVVJMNyddOgoJCQkJbm9tZSA9ICdSYXB0dScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMNyddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd2aWRvemEubmV0JyBpbiByZXN1bHRhZG9bJ1VSTDcnXToKCQkJCW5vbWUgPSAnVmlkb3phJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkw3J10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3N0cmVhbWFuZ28uJyBpbiByZXN1bHRhZG9bJ1VSTDcnXToKCQkJCW5vbWUgPSAnU3RyZWFtYW5nbycKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMNyddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdtaXhkcm9wLnRvJyBpbiByZXN1bHRhZG9bJ1VSTDcnXS5sb3dlcigpOgoJCQkJbm9tZSA9ICdNaXhkcm9wJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkw3J10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCglleGNlcHQ6CgkJcGFzcwoJbGVnZW5kYSA9ICcnCglzdHJlYW0gPSAnJwoJaWYgJzovLycgaW4gcmVzdWx0YWRvWydsZWdlbmRhJ10gb3IgcmVzdWx0YWRvWydsZWdlbmRhJ10gPT0gJyc6CgkJbGVnZW5kYSA9IF9fQVBJX18rJ3N1YnMvJXMuc3J0JyAlIHJlc3VsdGFkb1snSU1CRCddCgllbGlmIHJlc3VsdGFkb1snbGVnZW5kYSddICE9ICcnOgoJCWlmIG5vdCAnLnNydCcgaW4gcmVzdWx0YWRvWydsZWdlbmRhJ106CgkJCXJlc3VsdGFkb1snbGVnZW5kYSddID0gcmVzdWx0YWRvWydsZWdlbmRhJ10rJy5zcnQnCgkJbGVnZW5kYSA9IF9fQVBJX18rJ3N1YnMvJXMnICUgcmVzdWx0YWRvWydsZWdlbmRhJ10KCXRyeToKCQlpZiByZXN1bHRhZG9bJ3NlbWxlZ2VuZGEnXSA9PSAxOgoJCQlsZWdlbmRhID0gJycKCWV4Y2VwdDoKCQlwYXNzCglleHRfZyA9ICdjb2lzbycKCWxlZ2VuZGFBdXggPSBsZWdlbmRhCglzZXJ2aWRvciA9IDAKCWlmIGxlbih0aXR1bG9zKSA+IDE6CgkJc2Vydmlkb3IgPSB4Ym1jZ3VpLkRpYWxvZygpLnNlbGVjdCgnRXNjb2xoYSBvIHNlcnZpZG9yJywgdGl0dWxvcykKCWVsc2U6CgkJc2Vydmlkb3IgPSAwCgkKCWlmICd2aWR6aScgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJCXZpZHppID0gVVJMUmVzb2x2ZXJNZWRpYS5WaWR6aShzZXJ2aWRvcmVzW3NlcnZpZG9yXSkKCQkJc3RyZWFtID0gdmlkemkuZ2V0TWVkaWFVcmwoKQoJCQlsZWdlbmRhID0gdmlkemkuZ2V0U3VidGl0bGUoKQoJZWxpZiAndXB0b3N0cmVhbS5jb20nIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXN0cmVhbSA9IFVSTFJlc29sdmVyTWVkaWEuVXBUb1N0cmVhbShzZXJ2aWRvcmVzW3NlcnZpZG9yXSkuZ2V0TWVkaWFVcmwoKQoJZWxpZiAnc2VydmVyLm1ycGlyYWN5LndpbicgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJc3RyZWFtID0gc2Vydmlkb3Jlc1tzZXJ2aWRvcl0KCWVsaWYgJ29wZW5sb2FkJyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQlzdHJlYW0gPSBVUkxSZXNvbHZlck1lZGlhLk9wZW5Mb2FkKHNlcnZpZG9yZXNbc2Vydmlkb3JdKS5nZXRNZWRpYVVybCgpCgkJbGVnZW5kYSA9IFVSTFJlc29sdmVyTWVkaWEuT3BlbkxvYWQoc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pLmdldFN1YnRpdGxlKCkKCQlpZiBub3QgJy52dHQnIGluIGxlZ2VuZGEgb3IgbGVnZW5kYSA9PSAnJzoKCQkJbGVnZW5kYSA9IGxlZ2VuZGFBdXgKCWVsaWYgJ2RyaXZlLmdvb2dsZS5jb20vJyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQlzdHJlYW0sIGV4dF9nID0gVVJMUmVzb2x2ZXJNZWRpYS5Hb29nbGVWaWRlbyhzZXJ2aWRvcmVzW3NlcnZpZG9yXSkuZ2V0TWVkaWFVcmwoKQoJZWxpZiAnY2xvdWQubWFpbC5ydScgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJc3RyZWFtLCBleHRfZyA9IFVSTFJlc29sdmVyTWVkaWEuQ2xvdWRNYWlsUnUoc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pLmdldE1lZGlhVXJsKCkKCWVsaWYgJ3JhcGlkdmlkZW8uY29tJyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXSBvciAncmFwdHUnIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXJhcGlkID0gVVJMUmVzb2x2ZXJNZWRpYS5SYXBpZFZpZGVvKHNlcnZpZG9yZXNbc2Vydmlkb3JdKQoJCXN0cmVhbSA9IHJhcGlkLmdldE1lZGlhVXJsKCkKCQlsZWdlbmRhID0gcmFwaWQuZ2V0TGVnZW5kYSgpCgllbGlmICd2aWRvemEubmV0JyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQl2aWRveiA9IFVSTFJlc29sdmVyTWVkaWEuVmlkb3phKHNlcnZpZG9yZXNbc2Vydmlkb3JdKQoJCXN0cmVhbSA9IHZpZG96LmdldE1lZGlhVXJsKCkKCQlsZWdlbmRhID0gdmlkb3ouZ2V0TGVnZW5kYSgpCgllbGlmICdzdHJlYW1hbmdvLicgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJc3RyZWFtYW4gPSBVUkxSZXNvbHZlck1lZGlhLlN0cmVhbWFuZ28oc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pCgkJc3RyZWFtID0gc3RyZWFtYW4uZ2V0TWVkaWFVcmwoKQoJCWxlZ2VuZGEgPSBzdHJlYW1hbi5nZXRMZWdlbmRhKCkKCWVsaWYgJ21peGRyb3AuJyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQltaXhkcm9wID0gVVJMUmVzb2x2ZXJNZWRpYS5NaXhkcm9wKHNlcnZpZG9yZXNbc2Vydmlkb3JdKQoJCXN0cmVhbSA9IG1peGRyb3AuZ2V0TWVkaWFVcmwoKQoJCWxlZ2VuZGEgPSBtaXhkcm9wLmdldExlZ2VuZGEoKQoJCglpZiBjb2lzbyA9PSAnZmlsbWUnOgoJCWxlZ2VuZGEgPSBsZWdlbmRhQXV4CgkJaWYgcmVzdWx0YWRvWydJTUJEJ10gbm90IGluIGxlZ2VuZGE6CgkJCWxlZ2VuZGEgPSBfX0FQSV9fKydzdWJzLyVzLnNydCcgJSByZXN1bHRhZG9bJ0lNQkQnXQoJCglpZiBsZWdlbmRhID09ICcnOgoJCWxlZ2VuZGEgPSBsZWdlbmRhQXV4CglyZXR1cm4gc3RyZWFtLCBsZWdlbmRhLCBleHRfZwoKCmRlZiBwZXNxdWlzYU1vdih1cmwpOgoJY29kaWdvX2ZvbnRlID0gJycKCWRhZG9zID0gJycKCXRhYmVsYSA9ICcnCglzdHJQZXNxdWlzYSA9ICcnCglmaWNoZWlybyA9ICcnCglzaXRlID0gJycKCXF1YWxpZGFkZSA9ICcnCglpZiAnZmlsbWVzJyBpbiB1cmw6CgkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdmaWxtZXNfcGVzcXVpc2EubGl2ZWl0JykKCQl0aXBvID0gMAoJCXF1YWxpZGFkZSA9IF9fUXVhbGlkYWRlX18KCWVsaWYgJ3NlcmllcycgaW4gdXJsOgoJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnc2VyaWVzX3Blc3F1aXNhLmxpdmVpdCcpCgkJdGlwbyA9IDEKCQlzaXRlID0gJ3NlcmllcycKCQlxdWFsaWRhZGUgPSAnMicKCWVsaWYgJ2FuaW1lcycgaW4gdXJsOgoJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnYW5pbWVzX3Blc3F1aXNhLmxpdmVpdCcpCgkJdGlwbyA9IDIKCQlzaXRlID0gJ2FuaW1lcycKCQlxdWFsaWRhZGUgPSAnMicKCWlmICdwYWdlJyBub3QgaW4gdXJsOgoJCXRyeToKCQkJdGlwbyA9IHhibWNndWkuRGlhbG9nKCkuc2VsZWN0KHUnT25kZSBxdWVyIHBlc3F1aXNhcj8nLCBbJ0ZpbG1lcycsICdTZXJpZXMnLCAnQW5pbWVzJ10pCgkJZXhjZXB0OgoJCQlyZXR1cm4gRmFsc2UKCQl0ZWNsYWRvID0geGJtYy5LZXlib2FyZCgnJywgJ08gcXVlIHF1ZXIgcGVzcXVpc2FyPycpCgkJaWYgdGlwbyA9PSAwOgoJCQl1cmwgPSBfX0FQSV9TSVRFX18rJ2ZpbG1lcy5waHA/YWN0aW9uPXBlc3F1aXNhJwoJCQlmaWNoZWlybyA9IG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ2ZpbG1lc19wZXNxdWlzYS5saXZlaXQnKQoJCQlxdWFsaWRhZGUgPSBfX1F1YWxpZGFkZV9fCgkJZWxpZiB0aXBvID09IDE6CgkJCXVybCA9IF9fQVBJX1NJVEVfXysnc2VyaWVzLnBocD9hY3Rpb249cGVzcXVpc2EnCgkJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnc2VyaWVzX3Blc3F1aXNhLmxpdmVpdCcpCgkJCXF1YWxpZGFkZSA9ICcyJwoJCQlzaXRlID0gJ3NlcmllcycKCQllbGlmIHRpcG8gPT0gMjoKCQkJdXJsID0gX19BUElfU0lURV9fKydhbmltZXMucGhwP2FjdGlvbj1wZXNxdWlzYScKCQkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdhbmltZXNfcGVzcXVpc2EubGl2ZWl0JykKCQkJcXVhbGlkYWRlID0gJzInCgkJCXNpdGUgPSAnYW5pbWVzJwoJCWlmIHhibWN2ZnMuZXhpc3RzKGZpY2hlaXJvKToKCQkJZiA9IG9wZW4oZmljaGVpcm8sICJyIikKCQkJdGV4dG8gPSBmLnJlYWQoKQoJCQlmLmNsb3NlKCkKCQkJdGVjbGFkby5zZXREZWZhdWx0KHRleHRvKQoJCXRlY2xhZG8uZG9Nb2RhbCgpCQoKCQlpZiB0ZWNsYWRvLmlzQ29uZmlybWVkKCk6CgkJCXN0clBlc3F1aXNhID0gdGVjbGFkby5nZXRUZXh0KCkKCQkJaWYgc3RyUGVzcXVpc2EgPT0gJyc6CgkJCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdJbnNpcmEgYWxnbyBuYSBwZXNxdWlzYS4nKQoJCQkJYWRkRGlyMignQWx0ZXJhciBQZXNxdWlzYScsIHVybCwgMTI0LCAnJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Blc3F1aXNhLnBuZycpLCAwKQoJCQkJcmV0dXJuIEZhbHNlCgkJCWRhZG9zID0gdXJsbGliLnVybGVuY29kZSh7J3RleHRvJzogc3RyUGVzcXVpc2EsICdxdWFsaWRhZGUnOiBxdWFsaWRhZGV9KQoJCQl0cnk6CgkJCQlmID0gb3BlbihmaWNoZWlybywgbW9kZT0idyIpCgkJCQlmLndyaXRlKHN0clBlc3F1aXNhKQoJCQkJZi5jbG9zZSgpCgkJCWV4Y2VwdDoKCQkJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ07Do28gZ3Jhdm91IG8gY29udGV1ZG8gZW0gJytmaWNoZWlybykKCQkJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCxwb3N0PWRhZG9zLCBoZWFkZXI9aGVhZGVycywgY29va2llPWdldENvb2tpZSgpKQoJZWxzZToKCQlpZiB4Ym1jdmZzLmV4aXN0cyhmaWNoZWlybyk6CgkJCWYgPSBvcGVuKGZpY2hlaXJvLCAiciIpCgkJCXRleHRvID0gZi5yZWFkKCkKCQkJZi5jbG9zZSgpCgkJZGFkb3MgPSB1cmxsaWIudXJsZW5jb2RlKHsndGV4dG8nOiB0ZXh0bywgJ3F1YWxpZGFkZSc6cXVhbGlkYWRlfSkKCQlyZXN1bHRhZG8gPSBhYnJpcl91cmwodXJsLHBvc3Q9ZGFkb3MsIGhlYWRlcj1oZWFkZXJzLCBjb29raWU9Z2V0Q29va2llKCkpCgkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJdHJ5OgoJCWlmIHJlc3VsdGFkb1snY29kaWdvJ10gPT0gMjA0OgoJCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdEZXZlIEluZGljYXIgdW0gdmFsb3IgcGFyYSBwZXNxdWlzYS4nKQoJCQlyZXR1cm4gRmFsc2UKCWV4Y2VwdDoKCQlyZXN1bHRhZG8gPSByZXN1bHRhZG8KCXZpc3RvcyA9IERhdGFiYXNlLnNlbGVjdEZpbG1lcygpCglvcGNhbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCdtYXJjYXJWaXN0bycpCgoJaWYgcmVzdWx0YWRvWydkYXRhJ10gIT0gJyc6CgkJaWYgdGlwbyA9PSAwOgoJCQlmb3IgaSBpbiByZXN1bHRhZG9bJ2RhdGEnXToKCQkJCXNldEZpbG1lKGksIHZpc3Rvcywgb3BjYW8pCgkJZWxpZiB0aXBvID09IDEgb3IgdGlwbyA9PSAyOgoJCQlmb3IgaSBpbiByZXN1bHRhZG9bJ2RhdGEnXToKCQkJCXNldFNlcmllcyhpLCB2aXN0b3MsIG9wY2FvLCBzaXRlKQoJCQoJCWN1cnJlbnQgPSByZXN1bHRhZG9bJ21ldGEnXVsnY3VycmVudCddCgkJdG90YWwgPSByZXN1bHRhZG9bJ21ldGEnXVsndG90YWwnXQoJCXRyeTogcHJveGltbyA9IHJlc3VsdGFkb1snbWV0YSddWydwYWdpbmFjYW8nXVsnbmV4dCddCgkJZXhjZXB0OiBwYXNzIAoJCWlmIGludChjdXJyZW50KSA8IGludCh0b3RhbCk6CgkJCWFkZERpcjIoJ1Byb3hpbWEgcGFnaW5hICgnK3N0cihjdXJyZW50KSsnLycrc3RyKHRvdGFsKSsnKScsIHByb3hpbW8sIDEyNCwgJ3Blc3F1aXNhJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Byb3hpbW8ucG5nJykpCgkJZWxzZToKCQkJeGJtY3BsdWdpbi5lbmRPZkRpcmVjdG9yeShpbnQoc3lzLmFyZ3ZbMV0pLGNhY2hlVG9EaXNjPUZhbHNlKQoJdmlzdGFfZmlsbWVzU2VyaWVzKCkKCmRlZiBwZXNxdWlzYShzZXJ2dXNzKToKCWNvZGlnb19mb250ZSA9ICcnCglkYWRvcyA9ICcnCgluZXQgPSBOZXQoKQoJI25ldC5zZXRfY29va2llcyhfX0NPT0tJRV9GSUxFX18pCgl0YWJlbGEgPSAnJwoJc3RyUGVzcXVpc2EgPSAnJwoJZmljaGVpcm8gPSAnJwoJdXJsID0gJycKCWlmICdwYWdlJyBub3QgaW4gdXJsOgoJCXVybCA9IF9fU0lURUJEX18rJ3NlYXJjaC5waHAnCgkJaWYgdGlwbyA9PSAzOgoJCQl0YWJlbGEgPSAnY2FuYWlzX2tvZGknCgkJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnY2FuYWlzLmxpdmVpdCcpCgkJZWxpZiB0aXBvID09IDQ6CgkJCXRhYmVsYSA9ICdwcmFpYXNfa29kaScKCQkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdwcmFpYXMubGl2ZWl0JykKCQllbGlmIHRpcG8gPT0gNToKCQkJdGFiZWxhID0gJ3JhZGlvc19rb2RpJwoJCQlmaWNoZWlybyA9IG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ3JhZGlvcy5saXZlaXQnKQoJCWVsc2U6CgkJCXRhYmVsYSA9ICdwcm9ncmFtYXNfa29kaScKCQkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdwcm9ncmFtYXMubGl2ZWl0JykKCQkKCQlpZiB4Ym1jdmZzLmV4aXN0cyhmaWNoZWlybyk6CgkJCWYgPSBvcGVuKGZpY2hlaXJvLCAiciIpCgkJCXRleHRvID0gZi5yZWFkKCkKCQkJZi5jbG9zZSgpCgkJCXRlY2xhZG8uc2V0RGVmYXVsdCh0ZXh0bykKCQl0ZWNsYWRvLmRvTW9kYWwoKQkKCgkJaWYgdGVjbGFkby5pc0NvbmZpcm1lZCgpOgoJCQlzdHJQZXNxdWlzYSA9IHRlY2xhZG8uZ2V0VGV4dCgpCgkJCWRhZG9zID0gdXJsbGliLnVybGVuY29kZSh7J3RleHRvJzogc3RyUGVzcXVpc2EsICdxdWFsaWRhZGUnOiBxdWFsaWRhZGV9KQoJCQl0cnk6CgkJCQlmID0gb3BlbihmaWNoZWlybywgbW9kZT0idyIpCgkJCQlmLndyaXRlKHN0clBlc3F1aXNhKQoJCQkJZi5jbG9zZSgpCgkJCWV4Y2VwdDoKCQkJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ07Do28gZ3Jhdm91IG8gY29udGV1ZG8gZW0gJytmaWNoZWlybykKCQkJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCxwb3N0PWRhZG9zLCBoZWFkZXI9aGVhZGVycywgY29va2llPWdldENvb2tpZSgpKQoJZWxzZToKCQlpZiB4Ym1jdmZzLmV4aXN0cyhmaWNoZWlybyk6CgkJCWYgPSBvcGVuKGZpY2hlaXJvLCAiciIpCgkJCXRleHRvID0gZi5yZWFkKCkKCQkJZi5jbG9zZSgpCgkJZGFkb3MgPSB1cmxsaWIudXJsZW5jb2RlKHsndGV4dG8nOiB0ZXh0bywgJ3F1YWxpZGFkZSc6cXVhbGlkYWRlfSkKCQlyZXN1bHRhZG8gPSBhYnJpcl91cmwodXJsLHBvc3Q9ZGFkb3MsIGhlYWRlcj1oZWFkZXJzLCBjb29raWU9Z2V0Q29va2llKCkpCgkKCWlmIHN0clBlc3F1aXNhICE9ICcnOgoJCWlmIHJlc3VsdGFkbyA9PSAnRE5TJzoKCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVGVtIGRlIGFsdGVyYXIgb3MgRE5TIHBhcmEgcG9kZXIgdXN1ZnJ1aXIgZG8gX19BRERPTl9fLicpCgkJCXJldHVybiBGYWxzZQoJCQoJCXhibWNwbHVnaW4uZW5kT2ZEaXJlY3RvcnkoaW50KHN5cy5hcmd2WzFdKSxjYWNoZVRvRGlzYz1GYWxzZSkKCQlkYWRvcyA9IHsnc2VhcmNoQm94Jzogc3RyUGVzcXVpc2EsICd0YWJlbGEnOiB0YWJlbGF9CgkJY29kaWdvX2ZvbnRlID0gbmV0Lmh0dHBfUE9TVCh1cmwsIGZvcm1fZGF0YT1kYWRvcywgaGVhZGVycz1fX0hFQURFUlNfXykuY29udGVudC5kZWNvZGUoJ2xhdGluLTEnKS5lbmNvZGUoInV0Zi04IikKCQlpbmZvcm1hID0gewoJCQkJJ3NlcnZpZG9yJyA6IHsKCQkJCQknbm9tZSc6ICcnLAoJCQkJCSdzZXJ2JzogJycKCQkJCX0sCgkJCQknc2Vydmlkb3Jlcyc6IFtdLAoJCQkJJ2NhbmFpcyc6IFtdCgkJCX0KCQlzdWNlc3NvID0gJ25vJwoJCWVsZW1zID0gRVQuZnJvbXN0cmluZyhjb2RpZ29fZm9udGUpCgkJCgkJZm9yIGNoaWxkZWUgaW4gZWxlbXM6CgkJCWlmKGNoaWxkZWUudGFnID09ICdzZXJ2aWRvcmVzJyk6CgkJCQlzZXJ2aWRvciA9IHsKCQkJCQknbm9tZSc6ICcnLAoJCQkJCSdsaW5rJzogJycKCQkJCX0KCQkJCWZvciBnZyBpbiBjaGlsZGVlOgkKCQkJCQlpZihnZy50YWcgPT0gJ05vbWUnKToKCQkJCQkJc2Vydmlkb3JbJ25vbWUnXSA9IGdnLnRleHQJCgkJCQkJZWxpZihnZy50YWcgPT0gJ1NlcnZpZG9yJyk6CgkJCQkJCXNlcnZpZG9yWydsaW5rJ10gPSBnZy50ZXh0CQkKCQkJCQlpbmZvcm1hWydzZXJ2aWRvcmVzJ10uYXBwZW5kKHNlcnZpZG9yKQoJCQkKCQlmb3Igc2VydnZ2diBpbiBpbmZvcm1hWydzZXJ2aWRvcmVzJ106CgkJCWlmKHNlcnZ2dnZbJ25vbWUnXSA9PSBzZXJ2dXNzKToKCQkJCWluZm9ybWFbJ3NlcnZpZG9yJ11bJ25vbWUnXSA9IHNlcnZ2dnZbJ25vbWUnXQoJCQkJaW5mb3JtYVsnc2Vydmlkb3InXVsnc2VydiddID0gc2VydnZ2dlsnbGluayddCQkJCgkJCgkJZm9yIGNoaWxkIGluIGVsZW1zOgoJCQlpZihjaGlsZC50YWcgPT0gJ3N1Y2Vzc28nKToKCQkJCXN1Y2Vzc28gPSBjaGlsZC50ZXh0CgkJCWVsaWYoY2hpbGQudGFnID09ICdjYW5haXMnKToKCQkJCWNhbmFsID0gewoJCQkJCSdub21lJzogJycsCgkJCQkJJ2xvZ28nOiAnJywKCQkJCQknbGluayc6ICcnLAoJCQkJCSdncnVwbyc6ICcnLAoJCQkJCSdub21laWQnOiAnJywKCQkJCQknaWRub3ZvJzogJycKCQkJCX0KCQkJCWFkaWNpb25hID0gVHJ1ZQoJCQkJcGFnYW50ZSA9IEZhbHNlCgkJCQlmb3IgZyBpbiBjaGlsZDoKCQkJCQlhZGljaW9uYSA9IFRydWUKCQkJCQlpZihnLnRhZyA9PSAnTm9tZScpOgoJCQkJCQljYW5hbFsnbm9tZSddID0gZy50ZXh0CgkJCQkJZWxpZihnLnRhZyA9PSAnSW1hZ2VtJyk6CgkJCQkJCWNhbmFsWydsb2dvJ10gPSBnLnRleHQKCQkJCQllbGlmKGcudGFnID09ICdQYWdhbnRlJyk6CgkJCQkJCWlmKGcudGV4dCA9PSAndHJ1ZScpOgoJCQkJCQkJcGFnYW50ZSA9IFRydWUKCQkJCQllbGlmKGcudGFnID09ICdVcmwnKToKCQkJCQkJdXJsY2hhbWEgPSBnLnRleHQuc3BsaXQoJzsnKQoJCQkJCQl1cmxub28gPSBnLnRleHQKCQkJCQkJdHJ5OgoJCQkJCQkJaWYoc2VydnVzcyA9PSAnU2Vydmlkb3IxJyk6CgkJCQkJCQkJdXJsbm9vID0gdXJsY2hhbWFbMF0KCQkJCQkJCWVsaWYoc2VydnVzcyA9PSAnU2Vydmlkb3IyJyk6CgkJCQkJCQkJdXJsbm9vID0gdXJsY2hhbWFbMV0KCQkJCQkJCWVsaWYoc2VydnVzcyA9PSAnU2Vydmlkb3IzJyk6CgkJCQkJCQkJdXJsbm9vID0gdXJsY2hhbWFbMl0KCQkJCQkJCWVsaWYoc2VydnVzcyA9PSAnU2Vydmlkb3I0Jyk6CgkJCQkJCQkJdXJsbm9vID0gdXJsY2hhbWFbM10KCQkJCQkJCWVsaWYoc2VydnVzcyA9PSAnU2Vydmlkb3I1Jyk6CgkJCQkJCQkJdXJsbm9vID0gdXJsY2hhbWFbNF0KCQkJCQkJCWVsaWYoc2VydnVzcyA9PSAnU2Vydmlkb3I2Jyk6CgkJCQkJCQkJdXJsbm9vID0gdXJsY2hhbWFbNV0KCQkJCQkJCWVsaWYoc2VydnVzcyA9PSAnU2Vydmlkb3I3Jyk6CgkJCQkJCQkJdXJsbm9vID0gdXJsY2hhbWFbNl0KCQkJCQkJCWVsaWYoc2VydnVzcyA9PSAnU2Vydmlkb3I4Jyk6CgkJCQkJCQkJdXJsbm9vID0gdXJsY2hhbWFbN10KCQkJCQkJCQoJCQkJCQkJaWYodXJsbm9vID09ICduYWRhJyk6CgkJCQkJCQkJYWRpY2lvbmEgPSBGYWxzZQoJCQkJCQkJZWxzZToKCQkJCQkJCQlpZiBwYWdhbnRlOgoJCQkJCQkJCQljYW5hbFsnbGluayddID0gaW5mb3JtYVsnc2Vydmlkb3InXVsnc2VydiddKydsaXZlL3V0aWxpemFkb3JsaXZlaXQvc2VuaGFsaXZlaXQvJyt1cmxub28KCQkJCQkJCQllbHNlOgoJCQkJCQkJCQljYW5hbFsnbGluayddID0gdXJsbm9vCgkJCQkJCWV4Y2VwdDoKCQkJCQkJCWNhbmFsWydsaW5rJ10gPSBnLnRleHQKCQkJCQllbGlmKGcudGFnID09ICdHcnVwbycpOgoJCQkJCQljYW5hbFsnZ3J1cG8nXSA9IGcudGV4dAoJCQkJCWVsaWYoZy50YWcgPT0gJ05vbWVJRCcpOgoJCQkJCQljYW5hbFsnbm9tZWlkJ10gPSBnLnRleHQKCQkJCQllbGlmKGcudGFnID09ICdJRCcpOgoJCQkJCQljYW5hbFsnaWRub3ZvJ10gPSBnLnRleHQKCQkJCWlmIGFkaWNpb25hOgoJCQkJCWluZm9ybWFbJ2NhbmFpcyddLmFwcGVuZChjYW5hbCkKCgkJaWYgc3VjZXNzbyA9PSAneWVzJzoKCQkJYWRkRGlyMignQWx0ZXJhciBQZXNxdWlzYScsIHNlcnZ1c3MsIDEyMCwgJycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdwZXNxdWlzYS5wbmcnKSwgMCkKCQkJZm9yIGNhbm4gaW4gaW5mb3JtYVsnY2FuYWlzJ106CgkJCQlub21lZSA9IGNhbm5bJ25vbWUnXQoJCQkJaW1nID0gY2FublsnbG9nbyddCgkJCQlydG1wID0gY2FublsnbGluayddLnJlcGxhY2UoJyBydG1wJywncnRtcCcpLnJlcGxhY2UoJyBydHNwJywncnRzcCcpLnJlcGxhY2UoJyBodHRwJywnaHR0cCcpLnJlcGxhY2UoJ3V0aWxpemFkb3JsaXZlaXQnLF9fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9uYW1lIikpLnJlcGxhY2UoJ3NlbmhhbGl2ZWl0JyxfX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fcGFzc3dvcmQiKSkKCQkJCWdydXAgPSBjYW5uWydncnVwbyddCgkJCQlpZF9pdCA9IGNhbm5bJ25vbWVpZCddCgkJCQlpZF9wID0gY2FublsnaWRub3ZvJ10KCQkJCXNydF9mID0gJycKCQkJCWRlc2NyaSA9ICcnCgkJCQkKCQkJCWFkZExpbmsyKG5vbWVlLHJ0bXAsJ2h0dHA6Ly9saXZlaXRrb2RpLmNvbS9Mb2dvcy8nK2ltZykKCQkJCgkJCXZpc3RhX0NhbmFpcygpCgllbHNlOgoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0luc2lyYSBhbGdvIG5hIHBlc3F1aXNhLicpCgkJYWRkRGlyMignQWx0ZXJhciBQZXNxdWlzYScsIHNlcnZ1c3MsIDEyMCwgJycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdwZXNxdWlzYS5wbmcnKSwgMCkKCmRlZiBkb3dubG9hZCh1cmwsbmFtZSwgdGVtcG9yYWRhLGVwaXNvZGlvLHNlcmllTm9tZSk6CgkjaGVhZGVyc1snQXV0aG9yaXphdGlvbiddID0gJ0JlYXJlciAlcycgJSBfX0FERE9OX18uZ2V0U2V0dGluZygndG9rZW5NcnBpcmFjeScpCglsaW5rcyA9IHVybC5zcGxpdCgnLycpCglpZiAnZmlsbWUnIGluIHVybDoKCQlpZF92aWRlbyA9IGxpbmtzWy0xXQoJCXRpcG8gPSAwCgllbGlmICdzZXJpZScgaW4gdXJsOgoJCWlkX3ZpZGVvID0gbGlua3NbNV0KCQl0ZW1wb3JhZGEgPSBsaW5rc1s3XQoJCWVwaXNvZGlvID0gbGlua3NbLTFdCgkJdGlwbyA9IDEKCWVsaWYgJ2FuaW1lJyBpbiB1cmw6CgkJaWRfdmlkZW8gPSBsaW5rc1s1XQoJCXRlbXBvcmFkYSA9IGxpbmtzWzddCgkJZXBpc29kaW8gPSBsaW5rc1stMV0KCQl0aXBvID0gMgoKCXJlc3VsdGFkbyA9IGFicmlyX3VybCh1cmwsIGhlYWRlcj1oZWFkZXJzKQoJaWYgcmVzdWx0YWRvID09ICdETlMnOgoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1RlbSBkZSBhbHRlcmFyIG9zIEROUyBwYXJhIHBvZGVyIHVzdWZydWlyIGRvIF9fQURET05fXy4nKQoJCXJldHVybiBGYWxzZQoJCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCglzdHJlYW0sIGxlZ2VuZGEsIGV4dF9nID0gZ2V0U3RyZWFtTGVnZW5kYShyZXN1bHRhZG8pCgoJZm9sZGVyID0geGJtYy50cmFuc2xhdGVQYXRoKF9fQURET05fXy5nZXRTZXR0aW5nKCdwYXN0YURvd25sb2FkcycpKQoJaWYoZm9sZGVyID09ICdFc2NvbGhhIGEgcGFzdGEgcGFyYSBEb3dubG9hZCcpOgoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1NlbGVjY2lvbmUgdW1hIHBhc3RhIHByaW1laXJvIG5vIHN1Ym1lbnUgQ3JlZMOqbmNpYWlzIG91IG5hcyBDb25maWd1cmHDp8O1ZXMgZG8gX19BRERPTl9fLicpCgllbHNlOgoJCWlmIHRpcG8gPiAwOgoJCQlpZiB0aXBvID09IDE6CgkJCQlyZXN1bHRhZG9hID0gYWJyaXJfdXJsKF9fQVBJX1NJVEVfXysnc2VyaWUvJytpZF92aWRlbywgaGVhZGVyPWhlYWRlcnMpCgkJCWVsaWYgdGlwbyA9PSAyOgoJCQkJcmVzdWx0YWRvYSA9IGFicmlyX3VybChfX0FQSV9TSVRFX18rJ2FuaW1lLycraWRfdmlkZW8sIGhlYWRlcj1oZWFkZXJzKQoJCQlyZXN1bHRhZG9hID0ganNvbi5sb2FkcyhyZXN1bHRhZG9hKQoJCQlpZiBub3QgeGJtY3Zmcy5leGlzdHMob3MucGF0aC5qb2luKGZvbGRlciwnc2VyaWVzJykpOgoJCQkJeGJtY3Zmcy5ta2RpcnMob3MucGF0aC5qb2luKGZvbGRlciwnc2VyaWVzJykpCgkJCWlmIG5vdCB4Ym1jdmZzLmV4aXN0cyhvcy5wYXRoLmpvaW4oZm9sZGVyLCdzZXJpZXMnLHJlc3VsdGFkb2FbJ25vbWVfaW5nbGVzJ10pKToKCQkJCXhibWN2ZnMubWtkaXJzKG9zLnBhdGguam9pbihmb2xkZXIsJ3NlcmllcycscmVzdWx0YWRvYVsnbm9tZV9pbmdsZXMnXSkpCgkJCWlmIG5vdCB4Ym1jdmZzLmV4aXN0cyhvcy5wYXRoLmpvaW4oZm9sZGVyLCdzZXJpZXMnLHJlc3VsdGFkb2FbJ25vbWVfaW5nbGVzJ10sIlRlbXBvcmFkYSAiK3N0cih0ZW1wb3JhZGEpKSk6CgkJCQl4Ym1jdmZzLm1rZGlycyhvcy5wYXRoLmpvaW4oZm9sZGVyLCdzZXJpZXMnLHJlc3VsdGFkb2FbJ25vbWVfaW5nbGVzJ10sIlRlbXBvcmFkYSAiK3N0cih0ZW1wb3JhZGEpKSkKCQkJZm9sZGVyID0gb3MucGF0aC5qb2luKGZvbGRlciwgJ3NlcmllcycsIHJlc3VsdGFkb2FbJ25vbWVfaW5nbGVzJ10sICJUZW1wb3JhZGEiLCBzdHIodGVtcG9yYWRhKSkKCQkJbmFtZSA9ICJlIitzdHIoZXBpc29kaW8pKyIgLSAiK2NsZWFuKHJlc3VsdGFkb1snbm9tZV9lcGlzb2RpbyddKQoJCWVsc2U6CgkJCWlmIG5vdCB4Ym1jdmZzLmV4aXN0cyhvcy5wYXRoLmpvaW4oZm9sZGVyLCdmaWxtZXMnKSk6CgkJCQl4Ym1jdmZzLm1rZGlycyhvcy5wYXRoLmpvaW4oZm9sZGVyLCdmaWxtZXMnKSkKCQkJZm9sZGVyID0gb3MucGF0aC5qb2luKGZvbGRlciwnZmlsbWVzJykKCQkJbmFtZSA9IHJlc3VsdGFkb1snbm9tZV9pbmdsZXMnXQoKCQlzdHJlYW1BdXggPSBjbGVhbihzdHJlYW0uc3BsaXQoJy8nKVstMV0pCgkJZXh0ZW5zYW9TdHJlYW0gPSBjbGVhbihzdHJlYW1BdXguc3BsaXQoJy4nKVstMV0pCgoJCWlmICc/bWltJyBpbiBleHRlbnNhb1N0cmVhbToKCQkJZXh0ZW5zYW9TdHJlYW0gPSByZS5jb21waWxlKCcoLis/KVw/bWltZT0nKS5maW5kYWxsKGV4dGVuc2FvU3RyZWFtKVswXQoKCQlpZiBleHRfZyAhPSAnY29pc28nOgoJCQlleHRlbnNhb1N0cmVhbSA9IGV4dF9nCgoJCW5vbWVTdHJlYW0gPSBuYW1lKycuJytleHRlbnNhb1N0cmVhbQoJCW5vbWVsZWdlbmRhID0gJycKCQlEb3dubG9hZGVyLkRvd25sb2FkZXIoKS5kb3dubG9hZChvcy5wYXRoLmpvaW4oZm9sZGVyLmRlY29kZSgidXRmLTgiKSwgbm9tZVN0cmVhbSksIHN0cmVhbSwgbmFtZSkKCQkKCQlpZiBsZWdlbmRhc09uOgoJCQlsZWdlbmRhQXV4ID0gY2xlYW4obGVnZW5kYS5zcGxpdCgnLycpWy0xXSkKCQkJZXh0ZW5zYW9MZWdlbmRhID0gY2xlYW4obGVnZW5kYUF1eC5zcGxpdCgnLicpWzFdKQoJCQlub21lTGVnZW5kYSA9IG5hbWUrJy4nK2V4dGVuc2FvTGVnZW5kYQoJCQlkb3dubG9hZF9sZWdlbmRhcyhsZWdlbmRhLCBvcy5wYXRoLmpvaW4oZm9sZGVyLCBub21lTGVnZW5kYSkpCgpkZWYgZG93bmxvYWRfbGVnZW5kYXModXJsLHBhdGgpOgoJY29udGVudHMgPSBhYnJpcl91cmwodXJsKQoJaWYgY29udGVudHM6CgkJZmggPSBvcGVuKHBhdGgsICd3JykKCQlmaC53cml0ZShjb250ZW50cykKCQlmaC5jbG9zZSgpCglyZXR1cm4KCmRlZiBjbGVhbih0ZXh0KToKCWNvbW1hbmQ9eycmIzgyMjA7JzonIicsJyYjODIyMTsnOiciJywgJyYjODIxMTsnOictJywnJmFtcDsnOicmJywnJiM4MjE3Oyc6IiciLCcmIzgyMTY7JzoiJyJ9CglyZWdleCA9IHJlLmNvbXBpbGUoInwiLmpvaW4obWFwKHJlLmVzY2FwZSwgY29tbWFuZC5rZXlzKCkpKSkKCXJldHVybiByZWdleC5zdWIobGFtYmRhIG1vOiBjb21tYW5kW21vLmdyb3VwKDApXSwgdGV4dCkKCmRlZiBhZGRWaWRlbyhuYW1lLHVybCxtb2RlLGljb25pbWFnZSx2aXN0byx0aXBvLHRlbXBvcmFkYSxlcGlzb2RpbyxpbmZvTGFiZWxzLHBvc3Rlcix0cmFpbGVyPUZhbHNlLHNlcmllTm9tZT1GYWxzZSk6CgltZW51ID0gW10KCQoJaWYgaW5mb0xhYmVsczogaW5mb0xhYmVsc0F1eCA9IGluZm9MYWJlbHMKCWVsc2U6IGluZm9MYWJlbHNBdXggPSB7J1RpdGxlJzogbmFtZX0KCglpZiBwb3N0ZXI6IHBvc3RlckF1eCA9IHBvc3RlcgoJZWxzZTogcG9zdGVyQXV4ID0gaWNvbmltYWdlCgkKCXRyeToKCQluYW1lID0gbmFtZS5lbmNvZGUoJ3V0Zi04JykKCWV4Y2VwdDoKCQluYW1lID0gbmFtZQoJCgl0cnk6CgkJc2VyaWVOb21lID0gc2VyaWVOb21lLmVuY29kZSgndXRmLTgnKQoJZXhjZXB0OgoJCXNlcmllTm9tZSA9IHNlcmllTm9tZQoJZWxzZToKCQlwYXNzCgoJZmFuYXJ0ID0gX19GQU5BUlRfXwoJCglpZiB0aXBvID09ICdmaWxtZSc6CgkJeGJtY3BsdWdpbi5zZXRDb250ZW50KGludChzeXMuYXJndlsxXSksICdNb3ZpZXMnKQoJCWlmIF9fQURET05fXy5nZXRTZXR0aW5nKCd0cmFpbGVyLWZpbG1lcycpID09ICd0cnVlJzoKCQkJdHJ5OgoJCQkJaWRZb3V0dWJlID0gdHJhaWxlci5zcGxpdCgnP3Y9JylbLTFdLnNwbGl0KCcvJylbLTFdLnNwbGl0KCc/JylbMF0uc3BsaXQoJyYnKVswXQoJCQkJbGlua1RyYWlsZXIgPSAncGx1Z2luOi8vcGx1Z2luLnZpZGVvLnlvdXR1YmUvcGxheS8/dmlkZW9faWQ9JytpZFlvdXR1YmUKCQkJCSNpZFlvdXR1YmU9dHJhaWxlci5zcGxpdCgnPScpCgkJCQkjX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnSUQ6ICcraWRZb3V0dWJlWzFdKQoJCQkJI2xpbmtUcmFpbGVyID0gJ3BsdWdpbjovL3BsdWdpbi52aWRlby55b3V0dWJlLz9wYXRoPS9yb290L3ZpZGVvJmFjdGlvbj1wbGF5X3ZpZGVvJnZpZGVvaWQ9JytpZFlvdXR1YmVbMV0KCQkJCSNsaW5rVHJhaWxlciA9IHRyYWlsZXIKCQkJZXhjZXB0OgoJCQkJbGlua1RyYWlsZXIgPSAnJwoJCWVsc2U6CgkJCWxpbmtUcmFpbGVyID0gJycKCWVsaWYgdGlwbyA9PSAnc2VyaWUnOgoJCXhibWNwbHVnaW4uc2V0Q29udGVudChpbnQoc3lzLmFyZ3ZbMV0pLCAndHZzaG93cycpCgkJaWRJTURiID0gcmUuY29tcGlsZSgnaW1kYj0oLis/KSYnKS5maW5kYWxsKHVybClbMF0KCQlsaW5rVHJhaWxlciA9ICIiCgllbGlmIHRpcG8gPT0gJ2VwaXNvZGlvJzoKCQl4Ym1jcGx1Z2luLnNldENvbnRlbnQoaW50KHN5cy5hcmd2WzFdKSwgJ2VwaXNvZGVzJykKCQlsaW5rVHJhaWxlciA9ICIiCgllbHNlOgoJCXhibWNwbHVnaW4uc2V0Q29udGVudChpbnQoc3lzLmFyZ3ZbMV0pLCAnTW92aWVzJykKCQlsaW5rVHJhaWxlciA9ICIiCgkKCW92ZXJsYXkgPSA2CglwbGF5Y291bnQgPSAwCgoJaW5mb0xhYmVsc0F1eFsib3ZlcmxheSJdID0gb3ZlcmxheQoJaW5mb0xhYmVsc0F1eFsicGxheWNvdW50Il0gPSBwbGF5Y291bnQKCQoJbGl6PXhibWNndWkuTGlzdEl0ZW0obmFtZSwgaWNvbkltYWdlPWljb25pbWFnZSwgdGh1bWJuYWlsSW1hZ2U9aWNvbmltYWdlKQoJbGl6LnNldEluZm8oIHR5cGU9IlZpZGVvIiwgaW5mb0xhYmVscz1pbmZvTGFiZWxzQXV4KQoJbGl6LnNldFByb3BlcnR5KCdmYW5hcnRfaW1hZ2UnLCBwb3N0ZXIpCglsaXouc2V0QXJ0KHsnZmFuYXJ0JzogcG9zdGVyfSkKCQoJCglpZiBub3Qgc2VyaWVOb21lOgoJCXNlcmllTm9tZSA9ICcnCgoJdT1zeXMuYXJndlswXSsiP3VybD0iK3VybGxpYi5xdW90ZV9wbHVzKHVybCkrIiZtb2RlPSIrc3RyKG1vZGUpKyImdGVtcG9yYWRhPSIrc3RyKHRlbXBvcmFkYSkrIiZlcGlzb2Rpbz0iK3N0cihlcGlzb2RpbykrIiZuYW1lPSIrdXJsbGliLnF1b3RlX3BsdXMobmFtZSkrIiZpY29uaW1hZ2U9Iit1cmxsaWIucXVvdGVfcGx1cyhpY29uaW1hZ2UpKyImc2VyaWVOb21lPSIrdXJsbGliLnF1b3RlX3BsdXMoc2VyaWVOb21lKQoJb2s9VHJ1ZQoJCglpZiBsaW5rVHJhaWxlciAhPSAiIjoKCQltZW51LmFwcGVuZCgoJ1ZlciBUcmFpbGVyJywgJ1hCTUMuUGxheU1lZGlhKCVzKScgJSAobGlua1RyYWlsZXIpKSkKCQkjbWVudS5hcHBlbmQoKCdWZXIgVHJhaWxlcicsICdYQk1DLlJ1blBsdWdpbiglcz9tb2RlPTEwNSZuYW1lPSVzJnVybD0lcyZpY29uaW1hZ2U9JXMpJyUoc3lzLmFyZ3ZbMF0sdXJsbGliLnF1b3RlX3BsdXMobmFtZSksIGxpbmtUcmFpbGVyLCB1cmxsaWIucXVvdGVfcGx1cyhpY29uaW1hZ2UpKSkpCgkKCW1lbnUuYXBwZW5kKCgnRG93bmxvYWQnLCAnWEJNQy5SdW5QbHVnaW4oJXM/bW9kZT0xMTcmbmFtZT0lcyZ1cmw9JXMmaWNvbmltYWdlPSVzJnNlcmllTm9tZT0lcyZ0ZW1wb3JhZGE9JXMmZXBpc29kaW89JXMpJyUoc3lzLmFyZ3ZbMF0sdXJsbGliLnF1b3RlX3BsdXMobmFtZSksIHVybGxpYi5xdW90ZV9wbHVzKHVybCksIHVybGxpYi5xdW90ZV9wbHVzKGljb25pbWFnZSksIHVybGxpYi5xdW90ZV9wbHVzKHNlcmllTm9tZSksIHN0cih0ZW1wb3JhZGEpLCBzdHIoZXBpc29kaW8pKSkpCglsaXouYWRkQ29udGV4dE1lbnVJdGVtcyhtZW51LCByZXBsYWNlSXRlbXM9VHJ1ZSkKCW9rPXhibWNwbHVnaW4uYWRkRGlyZWN0b3J5SXRlbShoYW5kbGU9aW50KHN5cy5hcmd2WzFdKSx1cmw9dSxsaXN0aXRlbT1saXosaXNGb2xkZXI9RmFsc2UpCglyZXR1cm4gb2sKCmRlZiBBZGREaXIobmFtZSwgdXJsLCBtb2RlLCBpY29uaW1hZ2U9JycsIGxvZ29zPScnLCBpbmRleD0tMSwgbW92ZT0wLCBpc0ZvbGRlcj1UcnVlLCBJc1BsYXlhYmxlPUZhbHNlLCBiYWNrZ3JvdW5kPU5vbmUsIGNhY2hlTWluPScwJywgaW5mbz0nJywgbWV0YWg9JycpOgoJdXJsUGFyYW1zID0geyduYW1lJzogbmFtZSwgJ3VybCc6IHVybCwgJ21vZGUnOiBtb2RlLCAnaWNvbmltYWdlJzogaWNvbmltYWdlLCAnbG9nb3MnOiBsb2dvcywgJ2NhY2hlJzogY2FjaGVNaW4sICdpbmZvJzogaW5mbywgJ2JhY2tncm91bmQnOiBiYWNrZ3JvdW5kLCAnbWV0YWgnOiBtZXRhaH0KCWxpeiA9IHhibWNndWkuTGlzdEl0ZW0obmFtZSwgaWNvbkltYWdlPWljb25pbWFnZSwgdGh1bWJuYWlsSW1hZ2U9aWNvbmltYWdlICkKCWlmIG1ldGFoOgoJCWxpei5zZXRJbmZvKHR5cGU9IlZpZGVvIiwgaW5mb0xhYmVscz1tZXRhaCkKCQlsaXouc2V0QXJ0KHsidGh1bWIiOiBtZXRhaFsnY292ZXJfdXJsJ10sICJwb3N0ZXIiOiBtZXRhaFsnY292ZXJfdXJsJ10sICJiYW5uZXIiOiBtZXRhaFsnY292ZXJfdXJsJ10sICJmYW5hcnQiOiBtZXRhaFsnYmFja2Ryb3BfdXJsJ10gfSkKCWVsc2U6CgkJbGl6LnNldEluZm8odHlwZT0iVmlkZW8iLCBpbmZvTGFiZWxzPXsgIlRpdGxlIjogbmFtZSwgIlBsb3QiOiBpbmZvIH0pCgkJI2xpei5zZXRQcm9wZXJ0eSgiRmFuYXJ0X0ltYWdlIiwgbG9nb3MpCgkJbGl6LnNldEFydCh7InBvc3RlciI6IGljb25pbWFnZSwgImJhbm5lciI6IGxvZ29zLCAiZmFuYXJ0IjogbG9nb3MgfSkKCSNsaXN0TW9kZSA9IDIxICMgTGlzdHMKCWlmIElzUGxheWFibGU6CgkJbGl6LnNldFByb3BlcnR5KCdJc1BsYXlhYmxlJywgJ3RydWUnKQoJaXRlbXMgPSBbXQoJaWYgbW9kZSA9PSAxIG9yIG1vZGUgPT0gMjoKCQlpdGVtcyA9IFtdCglpZiBtb2RlID09IDEwOgoJCXVybFBhcmFtc1snaW5kZXgnXSA9IGluZGV4CgkKCSN1PXN5cy5hcmd2WzBdKyI/dXJsPSIrdXJsbGliLnF1b3RlX3BsdXModXJsKSsiJm5hbWU9Iit1cmxsaWIucXVvdGVfcGx1cyhuYW1lKSsiJm1vZGU9IitpbnQobW9kZSkrIiZtb3ZlPSIraW50KG1vdmUpKyImaW5kZXg9IitpbnQoaW5kZXgpKyImaWNvbmltYWdlPSIrc3RyKGljb25pbWFnZSkrIiZsb2dvcz0iK3N0cihsb2dvcykrIiZjYWNoZT0iK3N0cihjYWNoZU1pbikrIiZpbmZvPSIrc3RyKGluZm8pKyImYmFja2dyb3VuZD0iK2JhY2tncm91bmQrIiZtZXRhaD0iK3N0cihtZXRhaCkKCSN1PXN5cy5hcmd2WzBdKyI/dXJsPSIrdXJsbGliLnF1b3RlX3BsdXModXJsKSsiJm1vZGU9IitzdHIobW9kZSkrIiZuYW1lPSIrdXJsbGliLnF1b3RlX3BsdXMobmFtZSkrIiZzZW5oYT0iK3N0cihzZW5oYSkrIiZlc3RpbG89Iit1cmxsaWIucXVvdGVfcGx1cyhlc3RpbG8pKyImdGlwb2xvZ2lhPSIrc3RyKHRpcG8pKyImdGlwb191c2VyPSIrc3RyKHRpcG9fdXNlcikrIiZzZXJ2aWRvcl91c2VyPSIrc3RyKHNlcnZpZG9yX3VzZXIpKyImZGF0YV91c2VyPSIrc3RyKGRhdGFfdXNlcikrIiZmYW5hcnQ9IitzdHIoZmFuYXJ0KQoJdSA9ICd7MH0/ezF9Jy5mb3JtYXQoc3lzLmFyZ3ZbMF0sIHVybGxpYi51cmxlbmNvZGUodXJsUGFyYW1zKSkKCW9rPXhibWNwbHVnaW4uYWRkRGlyZWN0b3J5SXRlbShoYW5kbGU9aW50KHN5cy5hcmd2WzFdKSx1cmw9dSwgbGlzdGl0ZW09bGl6LGlzRm9sZGVyPWlzRm9sZGVyKQoJcmV0dXJuIG9rCgpkZWYgR2V0S2V5Ym9hcmRUZXh0KHRpdGxlID0gIiIsIGRlZmF1bHRUZXh0ID0gIiIpOgoJa2V5Ym9hcmQgPSB4Ym1jLktleWJvYXJkKGRlZmF1bHRUZXh0LCB0aXRsZSkKCWtleWJvYXJkLmRvTW9kYWwoKQoJdGV4dCA9ICIiIGlmIG5vdCBrZXlib2FyZC5pc0NvbmZpcm1lZCgpIGVsc2Uga2V5Ym9hcmQuZ2V0VGV4dCgpCglyZXR1cm4gdGV4dAoKZGVmIFJlZnJlc2goKToKCXhibWMuZXhlY3V0ZWJ1aWx0aW4oIlhCTUMuQ29udGFpbmVyLlJlZnJlc2goKSIpCgpkZWYgUGxheVVybChuYW1lLCB1cmwsIGljb25pbWFnZT1Ob25lLCBpbmZvPScnLCBzdWI9JycsIG1ldGFoPScnKToKCWlmICI7OzsiIGluIGJhY2tncm91bmQ6CgkJYiA9IGJhY2tncm91bmQuc3BsaXQoIjs7OyIpCgl1cmwgPSByZS5zdWIoJ1wubXA0JCcsICcubXA0P3BsYXknLCB1cmwpCgl1cmwgPSBjb21tb24uZ2V0RmluYWxVcmwodXJsKQoJI3hibWMubG9nKCctLS0gUGxheWluZyAiezB9Ii4gezF9Jy5mb3JtYXQobmFtZSwgdXJsKSwgMikKCWxpc3RpdGVtID0geGJtY2d1aS5MaXN0SXRlbShwYXRoPXVybCkKCWlmIG1ldGFoOgoJCWxpc3RpdGVtLnNldEluZm8odHlwZT0iVmlkZW8iLCBpbmZvTGFiZWxzPW1ldGFoKQoJZWxzZToKCQlsaXN0aXRlbS5zZXRJbmZvKHR5cGU9IlZpZGVvIiwgaW5mb0xhYmVscz17Im1lZGlhdHlwZSI6ICJ2aWRlbyIsICJUaXRsZSI6IG5hbWUsICJQbG90IjogaW5mbyB9KQoJaWYgc3ViIT0nJzoKCQlsaXN0aXRlbS5zZXRTdWJ0aXRsZXMoWydzcGVjaWFsOi8vdGVtcC9leGFtcGxlLnNydCcsIHN1YiBdKQoJaWYgaWNvbmltYWdlIGlzIG5vdCBOb25lOgoJCXRyeToKCQkJbGlzdGl0ZW0uc2V0QXJ0KHsndGh1bWInIDogaWNvbmltYWdlfSkKCQlleGNlcHQ6CgkJCWxpc3RpdGVtLnNldFRodW1ibmFpbEltYWdlKGljb25pbWFnZSkKCXhibWNwbHVnaW4uc2V0UmVzb2x2ZWRVcmwoaW50KHN5cy5hcmd2WzFdKSwgVHJ1ZSwgbGlzdGl0ZW0pCiMgLS0tLS0tLS0tLS0tLS0gIEZJTSBORVRDSU5FCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMJCQkJCQkJCUZVTkNPRVMgSkEgRkVJVEFTCQkJCQkJCQkgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwpkZWYgYWRkRGlyKG5hbWUsdXJsLG1vZGUsZXN0aWxvLGljb25pbWFnZSx0aXBvLGZhbmFydCxwYXN0YT1UcnVlLHRvdGFsPTEpOgoJdHJ5OgoJCW5hbWUgPSBuYW1lLmVuY29kZSgndXRmLTgnKQoJZXhjZXB0OgoJCW5hbWUgPSBuYW1lCglpZih0aXBvID09ICdsaW1wYXJjYWNoZScgYW5kIHRpcG8gPT0gJ2xpbXBhcnR1ZG8nKToJCQkJCgkJdT1zeXMuYXJndlswXSsiP3VybD0iK3VybGxpYi5xdW90ZV9wbHVzKHVybCkrIiZtb2RlPSIrc3RyKG1vZGUpCgllbHNlOgoJCXU9c3lzLmFyZ3ZbMF0rIj91cmw9Iit1cmxsaWIucXVvdGVfcGx1cyh1cmwpKyImbW9kZT0iK3N0cihtb2RlKSsiJm5hbWU9Iit1cmxsaWIucXVvdGVfcGx1cyhuYW1lKSsiJmVzdGlsbz0iK3VybGxpYi5xdW90ZV9wbHVzKGVzdGlsbykrIiZmYW5hcnQ9IitzdHIoZmFuYXJ0KQoJb2s9VHJ1ZQoJbGl6PXhibWNndWkuTGlzdEl0ZW0obmFtZSwgaWNvbkltYWdlPWljb25pbWFnZSwgdGh1bWJuYWlsSW1hZ2U9aWNvbmltYWdlKQoJbGl6LnNldFByb3BlcnR5KCdmYW5hcnRfaW1hZ2UnLCBmYW5hcnQpCglsaXouc2V0QXJ0KHsnZmFuYXJ0JzogZmFuYXJ0fSkKCW9rPXhibWNwbHVnaW4uYWRkRGlyZWN0b3J5SXRlbShoYW5kbGU9aW50KHN5cy5hcmd2WzFdKSx1cmw9dSxsaXN0aXRlbT1saXosaXNGb2xkZXI9cGFzdGEsdG90YWxJdGVtcz10b3RhbCkKCXJldHVybiBvawoKZGVmIGFkZERpcjIobmFtZSx1cmwsbW9kZSxtb2RlMixpY29uaW1hZ2UscGFnaW5hPTEsdGlwbz1Ob25lLGluZm9MYWJlbHM9Tm9uZSxwb3N0ZXI9Tm9uZSx2aXN0bz1GYWxzZSk6CglpZiBpbmZvTGFiZWxzOiBpbmZvTGFiZWxzQXV4ID0gaW5mb0xhYmVscwoJZWxzZTogaW5mb0xhYmVsc0F1eCA9IHsnVGl0bGUnOiBuYW1lfQoJZmFuYXJ0ID0gJycKCWlmIHBvc3RlcjogZmFuYXJ0ID0gcG9zdGVyCgllbHNlOiBmYW5hcnQgPSBpY29uaW1hZ2UKCQoJdHJ5OgoJCW5hbWUgPSBuYW1lLmVuY29kZSgndXRmLTgnKQoJZXhjZXB0OgoJCW5hbWUgPSBuYW1lCgoJdT1zeXMuYXJndlswXSsiP3VybD0iK3VybGxpYi5xdW90ZV9wbHVzKHVybCkrIiZtb2RvPSIrbW9kZTIrIiZtb2RlPSIrc3RyKG1vZGUpKyImbmFtZT0iK3VybGxpYi5xdW90ZV9wbHVzKG5hbWUpCgkKCW9rPVRydWUKCgkjZmFuYXJ0ID0gX19GQU5BUlRfXwoKCWlmIHRpcG8gPT0gJ2ZpbG1lJzoKCQkjZmFuYXJ0ID0gcG9zdGVyQXV4CgkJeGJtY3BsdWdpbi5zZXRDb250ZW50KGludChzeXMuYXJndlsxXSksICdNb3ZpZXMnKQoJZWxpZiB0aXBvID09ICdzZXJpZSc6CgkJI2ZhbmFydCA9IHBvc3RlckF1eAoJCXhibWNwbHVnaW4uc2V0Q29udGVudChpbnQoc3lzLmFyZ3ZbMV0pLCAndHZzaG93cycpCgllbGlmIHRpcG8gPT0gJ2VwaXNvZGlvJzoKCQkjZmFuYXJ0ID0gcG9zdGVyQXV4CgkJeGJtY3BsdWdpbi5zZXRDb250ZW50KGludChzeXMuYXJndlsxXSksICdlcGlzb2RlcycpCgllbHNlOgoJCWlmIG5hbWUgIT0gJ1JlZnJlc2gnOgoJCQl4Ym1jcGx1Z2luLnNldENvbnRlbnQoaW50KHN5cy5hcmd2WzFdKSwgJ01vdmllcycpCgkKCW92ZXJsYXkgPSA2CglwbGF5Y291bnQgPSAwCgkKCWluZm9MYWJlbHNBdXhbIm92ZXJsYXkiXSA9IG92ZXJsYXkKCWluZm9MYWJlbHNBdXhbInBsYXljb3VudCJdID0gcGxheWNvdW50CgkKCWxpej14Ym1jZ3VpLkxpc3RJdGVtKG5hbWUsIGljb25JbWFnZT1pY29uaW1hZ2UsIHRodW1ibmFpbEltYWdlPWljb25pbWFnZSkKCWxpei5zZXRQcm9wZXJ0eSgnZmFuYXJ0X2ltYWdlJywgZmFuYXJ0KQoJbGl6LnNldEFydCh7J2ZhbmFydCc6IGZhbmFydH0pCglsaXouc2V0SW5mbyggdHlwZT0iVmlkZW8iLCBpbmZvTGFiZWxzPWluZm9MYWJlbHNBdXggKQoKCW9rPXhibWNwbHVnaW4uYWRkRGlyZWN0b3J5SXRlbShoYW5kbGU9aW50KHN5cy5hcmd2WzFdKSx1cmw9dSxsaXN0aXRlbT1saXosaXNGb2xkZXI9VHJ1ZSkKCXJldHVybiBvawoKZGVmIGFkZExpbmtDYW5hbChuYW1lLHVybCxpY29uaW1hZ2UsaWRjYW5hbCxpZF9wKToKCWluZm9MYWJlbHNzc3MgPSB7InRpdGxlIjogbmFtZSwgImdlbnJlIjogJ0FsbCd9Cglvaz1UcnVlCgljbT1bXQoJCglpZihpZGNhbmFsICE9ICcwMDAxJyk6CgkJY20uYXBwZW5kKCgnVmVyIHByb2dyYW1hw6fDo28nLCAnWEJNQy5SdW5QbHVnaW4oJXM/bW9kZT0zMSZuYW1lPSVzJnVybD0lcyZpY29uaW1hZ2U9JXMmaWRDYW5hbD0lcyZpZGZmQ2FuYWw9JXMpJyUoc3lzLmFyZ3ZbMF0sdXJsbGliLnF1b3RlX3BsdXMobmFtZSksIHVybGxpYi5xdW90ZV9wbHVzKHVybCksIHVybGxpYi5xdW90ZV9wbHVzKGljb25pbWFnZSksIGlkQ2FuYWwsIGlkX3ApKSkKCQoJbGl6ID0geGJtY2d1aS5MaXN0SXRlbShuYW1lLCBpY29uSW1hZ2U9aWNvbmltYWdlLCB0aHVtYm5haWxJbWFnZT1pY29uaW1hZ2UpCglsaXouc2V0SW5mbyggdHlwZT0iVmlkZW8iLCBpbmZvTGFiZWxzPWluZm9MYWJlbHNzc3MpCglsaXouYWRkQ29udGV4dE1lbnVJdGVtcyhjbSwgcmVwbGFjZUl0ZW1zPUZhbHNlKQoJbGl6LnNldFByb3BlcnR5KCdJc1BsYXlhYmxlJywgJ3RydWUnKQoJbGl6LnNldFByb3BlcnR5KCdmYW5hcnRfaW1hZ2UnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fdHYucG5nJykpCglsaXouc2V0QXJ0KHsnZmFuYXJ0Jzogb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3R2LnBuZycpfSkKCXUgPSBzeXMuYXJndlswXSArICI/dXJsPSIgKyB1cmxsaWIucXVvdGVfcGx1cyh1cmwpICsgIiZtb2RlPTExJm5hbWU9IiArIHVybGxpYi5xdW90ZV9wbHVzKG5hbWUpICsgIiZpY29uaW1hZ2U9IiArIHVybGxpYi5xdW90ZV9wbHVzKGljb25pbWFnZSkrIiZzdHJlYW1faWQ9IitzdHIoaWRjYW5hbCkKCW9rPXhibWNwbHVnaW4uYWRkRGlyZWN0b3J5SXRlbShoYW5kbGU9aW50KHN5cy5hcmd2WzFdKSwgdXJsPXUsIGxpc3RpdGVtPWxpeikKCXJldHVybiBvawoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMJCQkJCQkJCQkJCQkJRVBHCQkJCQkJCQkJCQkJCSAjCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwpkZWYgb2J0ZXJfZmljaGVpcm9fZXBnKCk6CglfX0VQR19fID0gX19BRERPTl9fLmdldFNldHRpbmcoImxpc3RhX2VwZyIpCglpZiBub3QgeGJtY3Zmcy5leGlzdHMoX19GT0xERVJfRVBHX18pOgoJCXhibWN2ZnMubWtkaXJzKF9fRk9MREVSX0VQR19fKQoKCXVuY29tcHJlc3NlZF9wYXRoID0gb3MucGF0aC5qb2luKF9fRk9MREVSX0VQR19fLCAnZXBnLnhtbCcpCgl1cmwgPSB1cmxsaWIudXJsb3BlbihfX0VQR19fKQoJY29kaWdvID0gdXJsLnJlYWQoKQoJdXJsLmNsb3NlCgkKCW9wZW4odW5jb21wcmVzc2VkX3BhdGgsICd3Jykud3JpdGUoY29kaWdvKQoKZGVmIGdldFByb2dyYW1hY2FvRGlhcmlhKGlkQ2FuYWwsIGRpYWhvcmEsIGNvZGlnbyk6Cglzb3VyY2UgPSByZS5jb21waWxlKCc8cHJvZ3JhbW1lIHN0YXJ0PSIoLis/KSBcKzAxMDAiIHN0b3A9IiguKz8pIFwrMDEwMCIgY2hhbm5lbD0iJytpZENhbmFsKyciPlxzKzx0aXRsZSBsYW5nPSJwdCI+KC4rPyk8XC90aXRsZT4nKS5maW5kYWxsKGNvZGlnbykKCglwcm9ncmFtYSA9ICcnCgoJZm9yIHN0YXJ0LCBzdG9wLCBwcm9ncmFtYTEgIGluIHNvdXJjZToKCgkJaWYoaW50KHN0YXJ0KSA8IGRpYWhvcmEgYW5kIGludChzdG9wKSA+IGRpYWhvcmEpOgoJCQlwcm9ncmFtYSA9IHByb2dyYW1hMQoJcmV0dXJuIHByb2dyYW1hCgoKZGVmIHByb2dyYW1hY2FvX2NhbmFsKGlkQ2FuYWwpOgoJX19FUEdfXyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJsaXN0YV9lcGciKQoJdXJsID0gdXJsbGliLnVybG9wZW4oX19FUEdfXykKCWNvZGlnbyA9IHVybC5yZWFkKCkKCXVybC5jbG9zZQoJCgl0cyA9IHRpbWUudGltZSgpCglzdCA9IGludChkYXRldGltZS5kYXRldGltZS5mcm9tdGltZXN0YW1wKHRzKS5zdHJmdGltZSgnJVklbSVkJykpCgoJZGlhaG9yYSA9IGludChzdHIoc3QpKycwNjAwMDAnKQoJZGlhYW1hbmhhID0gaW50KHN0cihzdCsxKSsnMDYwMDAwJykKCglzb3VyY2UgPSByZS5jb21waWxlKCc8cHJvZ3JhbW1lIHN0YXJ0PSIoLis/KSBcKzAxMDAiIHN0b3A9IiguKz8pIFwrMDEwMCIgY2hhbm5lbD0iJytpZENhbmFsKyciPlxzKzx0aXRsZSBsYW5nPSJwdCI+KC4rPyk8XC90aXRsZT4nKS5maW5kYWxsKGNvZGlnbykKCglwcm9ncmFtYSA9ICcnCgoJdGl0bGVzPVsnW0JdW0NPTE9SIHdoaXRlXVByb2dyYW1hw6fDo286Wy9DT0xPUl1bL0JdJ10KCgkKCWZvciBzdGFydCwgc3RvcCwgcHJvZ3JhbWExIGluIHNvdXJjZToKCgkJc3RhcnQxID0gcmUuY29tcGlsZSgnKFswLTldezR9WzAtMV1bMC05XVswLTNdWzAtOV0pKFswLTldezJ9KShbMC05XXsyfSkoWzAtOV17Mn0pJykuZmluZGFsbChzdGFydCkKCQlzdG9wMSA9IHJlLmNvbXBpbGUoJyhbMC05XXs0fVswLTFdWzAtOV1bMC0zXVswLTldKShbMC05XXsyfSkoWzAtOV17Mn0pKFswLTldezJ9KScpLmZpbmRhbGwoc3RvcCkKCgkJaWYoaW50KHN0YXJ0KSA+IGRpYWhvcmEgYW5kIGludChzdGFydCkgPCBkaWFhbWFuaGEgKToKCQkJdGl0bGVzLmFwcGVuZCgnXG5bQl0lczolcyAtPiAlczolc1svQl0gLSAlcycgJSAoc3RhcnQxWzBdWzFdLCBzdGFydDFbMF1bMl0sIHN0b3AxWzBdWzFdLCBzdG9wMVswXVsyXSwgcHJvZ3JhbWExKSkKCgoJcHJvZ3JhbWFjYW8gPSAnXG4nLmpvaW4odGl0bGVzKQoJdHJ5OgoJCXhibWMuZXhlY3V0ZWJ1aWx0aW4oIkFjdGl2YXRlV2luZG93KDEwMTQ3KSIpCgkJd2luZG93ID0geGJtY2d1aS5XaW5kb3coMTAxNDcpCgkJeGJtYy5zbGVlcCgxMDApCgkJd2luZG93LmdldENvbnRyb2woMSkuc2V0TGFiZWwoQWRkb25UaXRsZSkKCQl3aW5kb3cuZ2V0Q29udHJvbCg1KS5zZXRUZXh0KHByb2dyYW1hY2FvKQoJZXhjZXB0OgoJCXBhc3MKCmRlZiBhYnJpcl91cmwodXJsLCBwb3N0PU5vbmUsIGhlYWRlcj1Ob25lLCBjb2RlPUZhbHNlLCBlcnJvPUZhbHNlLCBjb29raWU9Tm9uZSk6CglpZiBoZWFkZXIgPT0gTm9uZToKCQloZWFkZXIgPSBoZWFkZXJzCglpZiBjb29raWU6CgkJaGVhZGVyWydDb29raWUnXSA9IGNvb2tpZQoJCglpZiBwb3N0OgoJCWhlYWRlclsnQ29udGVudC1UeXBlJ10gPSdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnCgkJcmVxID0gdXJsbGliMi5SZXF1ZXN0KHVybCwgZGF0YT1wb3N0LCBoZWFkZXJzPWhlYWRlcikKCWVsc2U6CgkJcmVxID0gdXJsbGliMi5SZXF1ZXN0KHVybCwgaGVhZGVycz1oZWFkZXIpCgl0cnk6CgkJcmVzcG9uc2UgPSB1cmxsaWIyLnVybG9wZW4ocmVxLGNvbnRleHQ9Y29udGV4dCkKCWV4Y2VwdDoKCQl0cnk6CgkJCXJlc3BvbnNlID0gdXJsbGliMi51cmxvcGVuKHJlcSkKCQlleGNlcHQgdXJsbGliMi5IVFRQRXJyb3IgYXMgcmVzcG9uc2U6CgkJCWlmIGVycm8gPT0gVHJ1ZToKCQkJCXJldHVybiBzdHIocmVzcG9uc2UuY29kZSksICJhc2QiCglsaW5rPXJlc3BvbnNlLnJlYWQoKQoJCglpZiAnanVkaWNpYWwgYmxibGJsYmxibCcgaW4gbGluazoKCQlyZXR1cm4gJ0ROUycKCWlmIGNvZGU6CgkJcmV0dXJuIHN0cihyZXNwb25zZS5jb2RlKSwgbGluawoKCXJlc3BvbnNlLmNsb3NlKCkKCXJldHVybiBsaW5rCgpkZWYgYWRkTGluazIobmFtZSx1cmwsaWNvbmltYWdlKToKCW9rPVRydWUKCWxpeiA9IHhibWNndWkuTGlzdEl0ZW0obmFtZSwgaWNvbkltYWdlPWljb25pbWFnZSwgdGh1bWJuYWlsSW1hZ2U9aWNvbmltYWdlKQoJbGl6LnNldFByb3BlcnR5KCdmYW5hcnRfaW1hZ2UnLCBpY29uaW1hZ2UpCglsaXouc2V0QXJ0KHsnZmFuYXJ0JzogaWNvbmltYWdlfSkKCWxpei5zZXRJbmZvKCB0eXBlPSJWaWRlbyIsIGluZm9MYWJlbHM9eyAiVGl0bGUiOiBuYW1lIH0pCglsaXouc2V0UHJvcGVydHkoJ0lzUGxheWFibGUnLCAndHJ1ZScpCgl1ID0gc3lzLmFyZ3ZbMF0gKyAiP3VybD0iICsgdXJsICsgIiZtb2RlPTEwNiZuYW1lPSIgKyBuYW1lICsgIiZpY29uaW1hZ2U9IiArIGljb25pbWFnZQoJb2s9eGJtY3BsdWdpbi5hZGREaXJlY3RvcnlJdGVtKGhhbmRsZT1pbnQoc3lzLmFyZ3ZbMV0pLCB1cmw9dSwgbGlzdGl0ZW09bGl6KQoJcmV0dXJuIG9rCgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwkJCQkJCQkgIERFRklOSU5DT0VTCQkJCQkJCQkJCSAgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwkKCmRlZiB2aXN0YV9HcnVwb3MoKToKCW9wY2FvID0gX19BRERPTl9fLmdldFNldHRpbmcoJ2NhbmFpc1ZpZXcnKQoJaWYgb3BjYW8gPT0gJzAnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTApIikKCWVsaWYgb3BjYW8gPT0gJzEnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTEpIikKCWVsaWYgb3BjYW8gPT0gJzInOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTAwKSIpCgllbGlmIG9wY2FvID09ICczJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwOSkiKQoJZWxpZiBvcGNhbyA9PSAnMyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDgpIikKCWVsaWYgb3BjYW8gPT0gJzQnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA0KSIpCgllbGlmIG9wY2FvID09ICc1JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwMykiKQoJZWxpZiBvcGNhbyA9PSAnNic6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MTUpIikKCWVsaWYgb3BjYW8gPT0gJzcnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTUpIikKCmRlZiB2aXN0YV9DYW5haXMoKToKCW9wY2FvID0gX19BRERPTl9fLmdldFNldHRpbmcoJ2NhbmFpc1ZpZXcyJykKCWlmIG9wY2FvID09ICcwJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwKSIpCgllbGlmIG9wY2FvID09ICcxJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUxKSIpCgllbGlmIG9wY2FvID09ICcyJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwMCkiKQoJZWxpZiBvcGNhbyA9PSAnMyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDkpIikKCWVsaWYgb3BjYW8gPT0gJzMnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA4KSIpCgllbGlmIG9wY2FvID09ICc0JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwNCkiKQoJZWxpZiBvcGNhbyA9PSAnNSc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDMpIikKCWVsaWYgb3BjYW8gPT0gJzYnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTE1KSIpCgllbGlmIG9wY2FvID09ICc3JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDU1KSIpCgpkZWYgdmlzdGFfbWVudSgpOgoJb3BjYW8gPSBfX0FERE9OX18uZ2V0U2V0dGluZygnbWVudVZpZXcnKQoJaWYgb3BjYW8gPT0gJzAnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTApIikKCWVsaWYgb3BjYW8gPT0gJzEnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTEpIikKCWVsaWYgb3BjYW8gPT0gJzInOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTAwKSIpCgllbGlmIG9wY2FvID09ICczJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwOSkiKQoJZWxpZiBvcGNhbyA9PSAnMyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDgpIikKCWVsaWYgb3BjYW8gPT0gJzQnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA0KSIpCgllbGlmIG9wY2FvID09ICc1JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwMykiKQoJZWxpZiBvcGNhbyA9PSAnNic6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MTUpIikKCWVsaWYgb3BjYW8gPT0gJzcnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTUpIikKCmRlZiB2aXN0YV9maWxtZXNTZXJpZXMoKToKCW9wY2FvID0gX19BRERPTl9fLmdldFNldHRpbmcoJ2ZpbG1lc1Nlcmllc1ZpZXcnKQoJaWYgb3BjYW8gPT0gJzAnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTApIikKCWVsaWYgb3BjYW8gPT0gJzEnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTEpIikKCWVsaWYgb3BjYW8gPT0gJzInOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTAwKSIpCgllbGlmIG9wY2FvID09ICczJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwOSkiKQoJZWxpZiBvcGNhbyA9PSAnMyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDgpIikKCWVsaWYgb3BjYW8gPT0gJzQnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA0KSIpCgllbGlmIG9wY2FvID09ICc1JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwMykiKQoJZWxpZiBvcGNhbyA9PSAnNic6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MTUpIikKCWVsaWYgb3BjYW8gPT0gJzcnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTUpIikKCgpkZWYgdmlzdGFfdGVtcG9yYWRhcygpOgoJb3BjYW8gPSBfX0FERE9OX18uZ2V0U2V0dGluZygndGVtcG9yYWRhc1ZpZXcnKQoJaWYgb3BjYW8gPT0gJzAnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTApIikKCWVsaWYgb3BjYW8gPT0gJzEnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTEpIikKCWVsaWYgb3BjYW8gPT0gJzInOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTAwKSIpCgllbGlmIG9wY2FvID09ICczJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwOSkiKQoJZWxpZiBvcGNhbyA9PSAnMyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDgpIikKCWVsaWYgb3BjYW8gPT0gJzQnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA0KSIpCgllbGlmIG9wY2FvID09ICc1JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwMykiKQoJZWxpZiBvcGNhbyA9PSAnNic6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MTUpIikKCWVsaWYgb3BjYW8gPT0gJzcnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTUpIikKCmRlZiB2aXN0YV9lcGlzb2Rpb3MoKToKCSN4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTApIikKCW9wY2FvID0gX19BRERPTl9fLmdldFNldHRpbmcoJ2VwaXNvZGlvc1ZpZXcnKQoJaWYgb3BjYW8gPT0gJzAnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTApIikKCWVsaWYgb3BjYW8gPT0gJzEnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTEpIikKCWVsaWYgb3BjYW8gPT0gJzInOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTAwKSIpCgllbGlmIG9wY2FvID09ICczJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwOSkiKQoJZWxpZiBvcGNhbyA9PSAnMyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDgpIikKCWVsaWYgb3BjYW8gPT0gJzQnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA0KSIpCgllbGlmIG9wY2FvID09ICc1JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwMykiKQoJZWxpZiBvcGNhbyA9PSAnNic6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MTUpIikKCWVsaWYgb3BjYW8gPT0gJzcnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTUpIikKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMJCQkJCQkJCQkJCQlHRVQgUEFSQU1TCQkJCQkJCQkJCQkJICMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCQkgIApkZWYgZ2V0X3BhcmFtcygpOgoJcGFyYW09W10KCXBhcmFtc3RyaW5nPXN5cy5hcmd2WzJdCglpZiBsZW4ocGFyYW1zdHJpbmcpPj0yOgoJCXBhcmFtcz1zeXMuYXJndlsyXQoJCWNsZWFuZWRwYXJhbXM9cGFyYW1zLnJlcGxhY2UoJz8nLCcnKQoJCWlmIChwYXJhbXNbbGVuKHBhcmFtcyktMV09PScvJyk6IHBhcmFtcz1wYXJhbXNbMDpsZW4ocGFyYW1zKS0yXQoJCXBhaXJzb2ZwYXJhbXM9Y2xlYW5lZHBhcmFtcy5zcGxpdCgnJicpCgkJcGFyYW09e30KCQlmb3IgaSBpbiByYW5nZShsZW4ocGFpcnNvZnBhcmFtcykpOgoJCQlzcGxpdHBhcmFtcz17fQoJCQlzcGxpdHBhcmFtcz1wYWlyc29mcGFyYW1zW2ldLnNwbGl0KCc9JykKCQkJaWYgKGxlbihzcGxpdHBhcmFtcykpPT0yOiBwYXJhbVtzcGxpdHBhcmFtc1swXV09c3BsaXRwYXJhbXNbMV0KCXJldHVybiBwYXJhbQoKCnBhcmFtcz1nZXRfcGFyYW1zKCkKdXJsPU5vbmUKYnVpbGR0aXBvPU5vbmUKbmFtZT1Ob25lCm1vZGU9Tm9uZQptb2RvPU5vbmUKaWNvbmltYWdlPU5vbmUKbGluaz1Ob25lCnNlbmhhPU5vbmUKZXN0aWxvPU5vbmUKc3J0ZmlsbT1Ob25lCmlkQ2FuYWw9Tm9uZQppZGZmQ2FuYWw9Tm9uZQp0aXBvbG9naWE9Tm9uZQpkZXNjcmljYW89Tm9uZQp0aXBvX3VzZXI9Tm9uZQpzZXJ2aWRvcl91c2VyPU5vbmUKZGF0YV91c2VyPU5vbmUKc19zZXJ2PU5vbmUKdGlwbz1Ob25lCnNfdXNlcj1Ob25lCnNfcGFzcz1Ob25lCmxlZ2VuZGE9Tm9uZQpwYWdpbmE9Tm9uZQp0ZW1wb3JhZGE9Tm9uZQplcGlzb2Rpbz1Ob25lCnNlcmllTm9tZT1Ob25lCmZhbmFydD1Ob25lCnRodW1ibmFpbD1Ob25lCnN0cmVhbV9pZD1Ob25lCmR1cmF0aW9uPU5vbmUKdGlwb3NlbGVjdD1Ob25lCmJhY2tncm91bmQ9Tm9uZQppbmZvPU5vbmUKbG9nb3M9Tm9uZQpjYWNoZT1Ob25lCmluZGV4PU5vbmUKbW92ZT1Ob25lCm1ldGFoPU5vbmUKcGxvdD1Ob25lCgp0cnk6IAoJbG9nb3M9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImxvZ29zIl0pCmV4Y2VwdDogCglwYXJhbXMgPSBkaWN0KHVybHBhcnNlLnBhcnNlX3FzbChzeXMuYXJndlsyXS5yZXBsYWNlKCc/JywnJykpKQoJbG9nb3MgPSBwYXJhbXMuZ2V0KCdsb2dvcycsICcnKQoKdHJ5OiAKCWNhY2hlPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJjYWNoZSJdKQpleGNlcHQ6IAoJcGFyYW1zID0gZGljdCh1cmxwYXJzZS5wYXJzZV9xc2woc3lzLmFyZ3ZbMl0ucmVwbGFjZSgnPycsJycpKSkKCWNhY2hlID0gcGFyYW1zLmdldCgnY2FjaGUnLCAnJykKCnRyeTogCglpbmRleD11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1siaW5kZXgiXSkKZXhjZXB0OiAKCXBhcmFtcyA9IGRpY3QodXJscGFyc2UucGFyc2VfcXNsKHN5cy5hcmd2WzJdLnJlcGxhY2UoJz8nLCcnKSkpCglpbmRleCA9IHBhcmFtcy5nZXQoJ2luZGV4JywgJycpCgp0cnk6IAoJbW92ZT11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sibW92ZSJdKQpleGNlcHQ6IAoJcGFyYW1zID0gZGljdCh1cmxwYXJzZS5wYXJzZV9xc2woc3lzLmFyZ3ZbMl0ucmVwbGFjZSgnPycsJycpKSkKCW1vdmUgPSBwYXJhbXMuZ2V0KCdtb3ZlJywgJycpCgp0cnk6IAoJbWV0YWg9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbIm1ldGFoIl0pCmV4Y2VwdDogCglwYXJhbXMgPSBkaWN0KHVybHBhcnNlLnBhcnNlX3FzbChzeXMuYXJndlsyXS5yZXBsYWNlKCc/JywnJykpKQoJbWV0YWggPSBwYXJhbXMuZ2V0KCdtZXRhaCcsICcnKQoKdHJ5OiAKCWJhY2tncm91bmQ9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImJhY2tncm91bmQiXSkKZXhjZXB0OiAKCXBhcmFtcyA9IGRpY3QodXJscGFyc2UucGFyc2VfcXNsKHN5cy5hcmd2WzJdLnJlcGxhY2UoJz8nLCcnKSkpCgliYWNrZ3JvdW5kID0gcGFyYW1zLmdldCgnYmFja2dyb3VuZCcsICcnKQoKdHJ5OiAKCWluZm89dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImluZm8iXSkKZXhjZXB0OiAKCXBhcmFtcyA9IGRpY3QodXJscGFyc2UucGFyc2VfcXNsKHN5cy5hcmd2WzJdLnJlcGxhY2UoJz8nLCcnKSkpCglpbmZvID0gcGFyYW1zLmdldCgnaW5mbycsICcnKQoKdHJ5OiB0aXBvPXBhcmFtc1sidGlwbyJdCmV4Y2VwdDogcGFzcwp0cnk6IGR1cmF0aW9uPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJkdXJhdGlvbiJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBzdHJlYW1faWQ9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbInN0cmVhbV9pZCJdKQpleGNlcHQ6IHBhc3MKdHJ5OiB1cmw9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbInVybCJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBuYW1lPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJuYW1lIl0pCmV4Y2VwdDogcGFzcwp0cnk6IGVzdGlsbz11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1siZXN0aWxvIl0pCmV4Y2VwdDogcGFzcwp0cnk6IG1vZGU9aW50KHBhcmFtc1sibW9kZSJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBtb2RvPXBhcmFtc1sibW9kbyJdCmV4Y2VwdDogcGFzcwp0cnk6IGljb25pbWFnZT11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1siaWNvbmltYWdlIl0pCmV4Y2VwdDogcGFzcwp0cnk6IHNlbmhhPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJzZW5oYSJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBpZENhbmFsPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJpZENhbmFsIl0pCmV4Y2VwdDogcGFzcwp0cnk6IGlkZmZDYW5hbD1wYXJhbXNbImlkZmZDYW5hbCJdCmV4Y2VwdDogcGFzcwp0cnk6IHNydGZpbG09dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbInNydGZpbG0iXSkKZXhjZXB0OiBwYXNzCnRyeTogdGlwb2xvZ2lhPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJ0aXBvbG9naWEiXSkKZXhjZXB0OiBwYXNzCnRyeTogZGVzY3JpY2FvPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJkZXNjcmljYW8iXSkKZXhjZXB0OiBwYXNzCnRyeTogdGlwb191c2VyPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJ0aXBvX3VzZXIiXSkKZXhjZXB0OiBwYXNzCnRyeTogc2Vydmlkb3JfdXNlcj11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sic2Vydmlkb3JfdXNlciJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBzX3NlcnY9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImxvbHNlcnYiXSkKZXhjZXB0OiBwYXNzCnRyeTogc191c2VyPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJsb2x1c2VyIl0pCmV4Y2VwdDogcGFzcwp0cnk6IHNfcGFzcz11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sibG9scGFzcyJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBsaW5rPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJsaW5rIl0pCmV4Y2VwdDogcGFzcwp0cnk6IGxlZ2VuZGE9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImxlZ2VuZGEiXSkKZXhjZXB0OiBwYXNzCnRyeTogbmFtZT11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sibmFtZSJdKQpleGNlcHQ6IHBhc3MKdHJ5OiB0ZW1wb3JhZGE9aW50KHBhcmFtc1sidGVtcG9yYWRhIl0pCmV4Y2VwdDogcGFzcwp0cnk6IGVwaXNvZGlvPWludChwYXJhbXNbImVwaXNvZGlvIl0pCmV4Y2VwdDogcGFzcwp0cnk6IG1vZGU9aW50KHBhcmFtc1sibW9kZSJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBwYWdpbmE9aW50KHBhcmFtc1sicGFnaW5hIl0pCmV4Y2VwdDogcGFzcwp0cnk6IGljb25pbWFnZT11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1siaWNvbmltYWdlIl0pCmV4Y2VwdDogcGFzcwp0cnkgOiBzZXJpZU5vbWU9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbInNlcmllTm9tZSJdKQpleGNlcHQ6IHBhc3MKdHJ5IDogYnVpbGR0aXBvPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJidWlsZHRpcG8iXSkKZXhjZXB0OiBwYXNzCnRyeSA6IGZhbmFydD11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1siZmFuYXJ0Il0pCmV4Y2VwdDogcGFzcwp0cnkgOiBwbG90PXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJwbG90Il0pCmV4Y2VwdDogcGFzcwp0cnkgOiB0aHVtYm5haWw9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbInRodW1ibmFpbCJdKQpleGNlcHQ6IHBhc3MKdHJ5IDogZGF0YV91c2VyPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJkYXRhX3VzZXIiXSkKZXhjZXB0OiBwYXNzCnRyeSA6IHRpcG9zZWxlY3Q9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbInRpcG9zZWxlY3QiXSkKZXhjZXB0OiBwYXNzCgoKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCQkJCQkJCQkJCQkJCU1PRE9TCQkJCQkJCQkJCQkJCSAjCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwppZiBtb2RlPT1Ob25lIG9yIHVybD09Tm9uZSBvciBsZW4odXJsKTwxOiBtZW51KCkKZWxpZiBtb2RlPT0xOiBhYnJpclZpZGVvQ2x1YmUoc3RyKHVybCkpCmVsaWYgbW9kZT09MTAxOiBsaXN0YXJfZ3J1cG9zMShtb2RlLHVybCxmYW5hcnQpCmVsaWYgbW9kZT09MTAyOiBsaXN0YXJfZ3J1cG9zMihtb2RlLHVybCxmYW5hcnQpCmVsaWYgbW9kZT09MTAzOiBsaXN0YXJfZ3J1cG9zMyhtb2RlLHVybCxmYW5hcnQpCmVsaWYgbW9kZT09MTA0OiBsaXN0YXJfZ3J1cG9zNChtb2RlLHVybCxpY29uaW1hZ2UsZmFuYXJ0KQplbGlmIG1vZGU9PTEwNjogYWJyaXJFeHRyYXMoKQplbGlmIG1vZGU9PTEwNzogbGlzdGFyX2dydXBvczUobW9kZSx1cmwsZmFuYXJ0KQplbGlmIG1vZGU9PTEwODogbGlzdGFyX2dydXBvczYobW9kZSx1cmwsaWNvbmltYWdlLGZhbmFydCkKZWxpZiBtb2RlPT0xMDk6IHBsYXlfbXVsdF9jYW5hbDIodXJsLGljb25pbWFnZSxzdHIobmFtZSkpCmVsaWYgbW9kZT09MjogQWJyaXJfQ29udGEoc3RyKHVybCkpCmVsaWYgbW9kZT09MzogYWJyaW0zdShzdHIodXJsKSkKZWxpZiBtb2RlPT00OiBkZXRlY3RfbW9kaWZpY2F0aW9uKHN0cih1cmwpKQplbGlmIG1vZGU9PTU6IGFicmlyRGVmaW5pbmNvZXMoKQplbGlmIG1vZGU9PTY6IGxpc3RhdHZhcmNoaXZlKHN0cih1cmwpKQplbGlmIG1vZGU9PTc6IGxpc3RhdHZhcmNoaXZlY2FuYWlzKHN0cihuYW1lKSxzdHJlYW1faWQsc3RyKHVybCksZHVyYXRpb24saWNvbmltYWdlLGZhbmFydCkKZWxpZiBtb2RlPT04OiBzdHJlYW1fdmlkZW8obmFtZSx1cmwsaWNvbmltYWdlKQplbGlmIG1vZGU9PTk6IGdldF9teWFjY291bnQobmFtZSx1cmwsaWNvbmltYWdlKQplbGlmIG1vZGU9PTEwOiBydW5fY3JvbmpvYihuYW1lLHN0cih1cmwpLGljb25pbWFnZSxwbG90LGZhbmFydCkKZWxpZiBtb2RlPT0xMTogUGxheVVybChuYW1lLHVybCxpY29uaW1hZ2UpCmVsaWYgbW9kZT09MTM6IENMRUFSQ0FDSEUoKQplbGlmIG1vZGU9PTE0OiBQVVJHRVBBQ0tBR0VTKCkKZWxpZiBtb2RlPT0yMDogbGlzdGFtZW51c3NlcmllcyhzdHIobmFtZSksc3RyKHVybCksZXN0aWxvLHRpcG9sb2dpYSx0aXBvX3VzZXIsc2Vydmlkb3JfdXNlcixpY29uaW1hZ2UsZmFuYXJ0KQplbGlmIG1vZGU9PTIxOiBsaXN0YW1lbnVzZmlsbWVzKHN0cihuYW1lKSxzdHIodXJsKSxlc3RpbG8sdGlwb2xvZ2lhLHRpcG9fdXNlcixzZXJ2aWRvcl91c2VyLGljb25pbWFnZSxmYW5hcnQpCmVsaWYgbW9kZT09MjQ6IGxpc3RhbWVudXNhbmltZXMoc3RyKG5hbWUpLHN0cih1cmwpLGVzdGlsbyx0aXBvbG9naWEsdGlwb191c2VyLHNlcnZpZG9yX3VzZXIsaWNvbmltYWdlLGZhbmFydCkKZWxpZiBtb2RlPT0xMTExMTogZmlsbWVzMih1cmwpCmVsaWYgbW9kZT09MTExMTI6IHNlcmllczIodXJsKQplbGlmIG1vZGU9PTExMTEzOiBwbGF5ZXIyKG5hbWUsIHVybCwgaWNvbmltYWdlLCBtb2RvLCB0ZW1wb3JhZGEsIGVwaXNvZGlvLCB0aXBvKQplbGlmIG1vZGU9PTExMTE0OiBnZXRTZWFzb25zMih1cmwsIG1vZG8pCmVsaWYgbW9kZT09MTExMTU6IGdldEVwaXNvZGVzMih1cmwpCmVsaWYgbW9kZT09MTExMTg6IGdldFllYXJzX2xpdmUodXJsLCBtb2RvKQplbGlmIG1vZGU9PTExMTE5OiBnZXRHZW5lcm9zX2xpdmUodXJsLCBtb2RvKQplbGlmIG1vZGU9PTExMTE5OTogZ2V0R2VuZXJvczJfbGl2ZSh1cmwsIG1vZG8pCmVsaWYgbW9kZT09MTExMjA6IHBlc3F1aXNhX2xpdmUodXJsLCBtb2RvKQplbGlmIG1vZGU9PTExMTIxOiBnZXRJbmZvX2xpdmUodXJsLCBtb2RvKQplbGlmIG1vZGU9PTIxMTExOiBsaXN0YW1lbnVzX2xpdmVpdDEoKQplbGlmIG1vZGU9PTIxMTEyOiBsaXN0YW1lbnVzX2xpdmVpdDIoKQplbGlmIG1vZGU9PTExMTogZmlsbWVzKHVybCwgcGFnaW5hKQplbGlmIG1vZGU9PTEyMzogc2VyaWVzKHVybCkKZWxpZiBtb2RlPT0xMTg6IGdldEdlbmVyb3ModXJsKQplbGlmIG1vZGU9PTExOTogZ2V0WWVhcnModXJsKQplbGlmIG1vZGU9PTEyMDogcGVzcXVpc2EodXJsKQplbGlmIG1vZGU9PTEyMTogYW5vcyh1cmwpCmVsaWYgbW9kZT09MTIyOiBjYXRlZ29yaWFzKHVybCkKZWxpZiBtb2RlPT0xMTM6IHBsYXllcihuYW1lLCB1cmwsIGljb25pbWFnZSwgdGVtcG9yYWRhLCBlcGlzb2Rpbywgc2VyaWVOb21lKQplbGlmIG1vZGU9PTExNDogZ2V0U2Vhc29ucyh1cmwpCmVsaWYgbW9kZT09MTE1OiBnZXRFcGlzb2Rlcyh1cmwpCmVsaWYgbW9kZT09MTE3OiBkb3dubG9hZCh1cmwsIG5hbWUsIHRlbXBvcmFkYSwgZXBpc29kaW8sIHNlcmllTm9tZSkKZWxpZiBtb2RlPT0zMTogcHJvZ3JhbWFjYW9fY2FuYWwoaWRDYW5hbCkKZWxpZiBtb2RlID09IDMyOgoJUGxheVVybDIobmFtZSwgdXJsLCBpY29uaW1hZ2UpCgppZiBtb2RlPT1Ob25lIG9yIHVybD09Tm9uZSBvciBsZW4odXJsKTwxOgoJeGJtY3BsdWdpbi5lbmRPZkRpcmVjdG9yeShpbnQoc3lzLmFyZ3ZbMV0pLGNhY2hlVG9EaXNjPUZhbHNlKQplbHNlOgoJaWYgbW9kZSAhPTMgYW5kIG1vZGUgIT02IGFuZCBtb2RlICE9NzogCgkJeGJtY3BsdWdpbi5lbmRPZkRpcmVjdG9yeShpbnQoc3lzLmFyZ3ZbMV0pLGNhY2hlVG9EaXNjPUZhbHNlKQoJZWxzZTogCgkJeGJtY3BsdWdpbi5lbmRPZkRpcmVjdG9yeShpbnQoc3lzLmFyZ3ZbMV0pLGNhY2hlVG9EaXNjPVRydWUp"))