exec("import re;import base64");exec(base64.b64decode("IyMjIyMjIyMjIyMjIyNCSUJMSU9URUNBUyBBIElNUE9SVEFSIEUgREVGSU5JQ09FUyMjIyMjIyMjIyMjIyMjIyMjIyMjCmltcG9ydCB1cmxsaWIsdXJsbGliMixzeXMscmUseGJtY3BsdWdpbix4Ym1jZ3VpLHhibWNhZGRvbix4Ym1jLG9zLGpzb24sZ2xvYix0aHJlYWRpbmcsZ3ppcCx4Ym1jdmZzLGNvb2tpZWxpYixwcHJpbnQsZGF0ZXRpbWUsdGhyZWFkLHRpbWUsdXJscGFyc2UsYmFzZTY0LHBsdWdpbnRvb2xzLGNhbGVuZGFyCmltcG9ydCB4bWwuZXRyZWUuRWxlbWVudFRyZWUgYXMgRVQKaW1wb3J0IGZpbGVVdGlscyBhcyBmdQppbXBvcnQgYXN0CmZyb20gcmVzb3VyY2VzLmxpYiBpbXBvcnQgY29tbW9uCmZyb20gdXJsbGliMiBpbXBvcnQgUmVxdWVzdCwgdXJsb3Blbgpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRlCmZyb20gYnM0IGltcG9ydCBCZWF1dGlmdWxTb3VwCmZyb20gcmVzb3VyY2VzLmxpYiBpbXBvcnQgRG93bmxvYWRlciAjRW5lbjkyIGNsYXNzCmZyb20gcmVzb3VyY2VzLmxpYiBpbXBvcnQgUGxheWVyCmZyb20gcmVzb3VyY2VzLmxpYiBpbXBvcnQgVFZBcmNoaXZlCmZyb20gdDBtbTAuY29tbW9uLm5ldCBpbXBvcnQgTmV0CmZyb20gdDBtbTAuY29tbW9uLmFkZG9uIGltcG9ydCBBZGRvbgpmcm9tIHQwbW0wLmNvbW1vbi5uZXQgaW1wb3J0IEh0dHBSZXNwb25zZQpmcm9tIHJlc291cmNlcy5saWIgaW1wb3J0IFVSTFJlc29sdmVyTWVkaWEKZnJvbSByZXNvdXJjZXMubGliIGltcG9ydCBUcmFrdApmcm9tIHJlc291cmNlcy5saWIgaW1wb3J0IERhdGFiYXNlCmZyb20gdW5pY29kZWRhdGEgaW1wb3J0IG5vcm1hbGl6ZQp0cnk6CiAgICBpbXBvcnQgc3NsCiAgICBjb250ZXh0ID0gc3NsLlNTTENvbnRleHQoc3NsLlBST1RPQ09MX1RMU3YxKQpleGNlcHQ6CiAgICBwYXNzCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMgQ09OU1RBTlRFUyAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZ2xvYmFsIGdfdGltZXIKZ2xvYmFsIHRlbGV2aXNpb29uaWxpbmsKZ2xvYmFsIGZpbG1pbGluawpnbG9iYWwgYW5kbWVsaW5rCmdsb2JhbCB1dWVuZHVzbGluawpnbG9iYWwgdXVlbmR1c2VkCmdsb2JhbCB2YW5lbWFsdWtrCmdsb2JhbCB2ZXJzaW9uCmdsb2JhbCBtb2RlCgpyZWxvYWQoc3lzKQpzeXMuc2V0ZGVmYXVsdGVuY29kaW5nKCd1dGY4JykKbW9kZSA9IDMzMzMKdmVyc2lvbiA9ICIiCmthc3V0YWphbmltaSA9ICIiCnNhbGFzb25hID0gIiIKbGVoZWt5bGcgPSAiIgp2YW5lbWFrb29kID0gIiIKdmFuZW1hbHVrayA9ICIiCnRlbGV2aXNpb29uaWxpbmsgPSAiIgpmaWxtaWxpbmsgPSAiIgphbmRtZWxpbmsgPSAiIgoKX0xJSUxMXyA9ICJhSFIwY0RvdkwyeHBkbVZwZEd0dlpHa3VZMjl0TDFCSVVDOTJZV3hwWkdGMFpVRlFVQzV3YUhBPSIKX19BRERPTl9JRF9fCT0geGJtY2FkZG9uLkFkZG9uKCkuZ2V0QWRkb25JbmZvKCJpZCIpCl9fQURET05fXwk9IHhibWNhZGRvbi5BZGRvbihfX0FERE9OX0lEX18pCl9fQURET05WRVJTSU9OX18gPSBfX0FERE9OX18uZ2V0QWRkb25JbmZvKCd2ZXJzaW9uJykKQWRkb25UaXRsZSA9IF9fQURET05fXy5nZXRBZGRvbkluZm8oJ25hbWUnKQpETlNfREVGSU5FID0gJycKX19BRERPTl9GT0xERVJfXwk9IF9fQURET05fXy5nZXRBZGRvbkluZm8oJ3BhdGgnKQpfX1NFVFRJTkdfXwk9IHhibWNhZGRvbi5BZGRvbigpLmdldFNldHRpbmcKX19BUlRfRk9MREVSX18JPSBfX0FERE9OX0ZPTERFUl9fICsgJy9yZXNvdXJjZXMvaW1nLycKX19TS0lOX18gPSAndjInCl9fUXVhbGlkYWRlX18gPSBfX0FERE9OX18uZ2V0U2V0dGluZygncXVhbGlkYWRlRmlsbWVzJykKX19GQU5BUlRfXyA9IG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kby5wbmcnKQpfX1BBU1RBX0RBRE9TX18gPSBBZGRvbihfX0FERE9OX0lEX18pLmdldF9wcm9maWxlKCkuZGVjb2RlKCJ1dGYtOCIpCl9fQVBJX18gPSBiYXNlNjQudXJsc2FmZV9iNjRkZWNvZGUoJ2FIUjBjRG92TDIxd1lYQnBMbTFzTHc9PScpCl9fQVBJX1NJVEVfXyA9IGJhc2U2NC51cmxzYWZlX2I2NGRlY29kZSgnYUhSMGNEb3ZMMjF3WVhCcExtMXNMMkZ3YVc1bGR5OD0nKQpfX1NJVEVfXyA9IGJhc2U2NC51cmxzYWZlX2I2NGRlY29kZSgnYUhSMGNEb3ZMMjF5Y0dseVlXTjVMbWR4THc9PScpCl9fRk9MREVSX0VQR19fID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnZXBnbGl2ZW5vdycpCl9fQ09PS0lFX0ZJTEVfXyA9IG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ2xpdmVub3cnKQpfX1NJVEVBZGRvbl9fID0gYmFzZTY0LnVybHNhZmVfYjY0ZGVjb2RlKCdhSFIwY0RvdkwzZDNkeTV3WTNSbFkydHpaWEoyTG1OdmJTOUhjblZ3YjB0dlpHa3ZRV1JrYjI0dicpCl9JQ09OXyA9IG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29uLnBuZycpCl9fSEVBREVSU19fID0geydVc2VyLUFnZW50JzogJ01vemlsbGEvNS4wIChNYWNpbnRvc2g7IEludGVsIE1hYyBPUyBYIDEwLjExOyBydjo0My4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzQzLjAnLCAnQWNjZXB0JzogJ3RleHQvaHRtbCxhcHBsaWNhdGlvbi94aHRtbCt4bWwsYXBwbGljYXRpb24veG1sO3E9MC45LCovKjtxPTAuOCd9CmhlYWRlcnMgPSB7J1VzZXItQWdlbnQnOiAnTW96aWxsYS81LjAgKE1hY2ludG9zaDsgSW50ZWwgTWFjIE9TIFggMTAuMTE7IHJ2OjQzLjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvNDMuMCcsICdBY2NlcHQtQ2hhcnNldCc6ICd1dGYtODtxPTAuNywqO3E9MC43JywgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ30KCkNhdCA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJDYXQiKQpjT3JkTkNGID0gX19BRERPTl9fLmdldFNldHRpbmcoImNPcmROQ0YiKQpjT3JkTkNTID0gX19BRERPTl9fLmdldFNldHRpbmcoImNPcmROQ1MiKQoKQ2xpc3RhPVsgInRvZG9zIiwgImFjYW8iLCAiYW5pbWFjYW8iLCAiYXZlbnR1cmEiLCAiY29tZWRpYSIsICJkcmFtYSIsICJmYW50YXNpYSIsICJmaWNjYW8tY2llbnRpZmljYSIsICJyb21hbmNlIiwgInN1c3BlbnNlIiwgInRlcnJvciJdCkNsaXN0YTM9WyJTZW0gZmlsdHJvIChNb3N0cmFyIFRvZG9zKSIsIkHDp8OjbyIsICJBbmltYcOnw6NvIiwgIkF2ZW50dXJhIiwgIkNvbcOpZGlhIiwgIkRyYW1hIiwgIkZhbnRhc2lhIiwgIkZpY8Onw6NvLUNpZW50w61maWNhIiwgIlJvbWFuY2UiLCAiU3VzcGVuc2UiLCAiVGVycm9yIl0KCmRlZiBzZXRWaWV3UygpOgoJeGJtY3BsdWdpbi5zZXRDb250ZW50KGludChzeXMuYXJndlsxXSksICd0dnNob3dzJykKZGVmIHNldFZpZXdNKCk6Cgl4Ym1jcGx1Z2luLnNldENvbnRlbnQoaW50KHN5cy5hcmd2WzFdKSwgJ21vdmllcycpCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCQkJCQkJCSAgSW5pY2lhciBBZGRvbgkJCQkJCQkJCQkgICMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCmRlZiBfX0FMRVJUQV9fKHRleHQxPSIiLHRleHQyPSIiLHRleHQzPSIiKToKCWlmIHRleHQzPT0iIjogeGJtY2d1aS5EaWFsb2coKS5vayh0ZXh0MSx0ZXh0MikKCWVsaWYgdGV4dDI9PSIiOiB4Ym1jZ3VpLkRpYWxvZygpLm9rKCIiLHRleHQxKQoJZWxzZTogeGJtY2d1aS5EaWFsb2coKS5vayh0ZXh0MSx0ZXh0Mix0ZXh0MykKCmRlZiBjcmlhck1lbnUocGFpLG5vbWUsbG9nbyx1cmwsdGlwbyxmYW5hcnQpOgoJbWVudXMgPSB7CgkJCSdub21lJzogJycsCgkJCSdsb2dvJzogJycsCgkJCSd1cmwnOiAnJywKCQkJJ3RpcG8nOiAnJywKCQkJJ2ZhbmFydCc6ICcnCgkJCX0KCW1lbnVzWydub21lJ10gPSBub21lCgltZW51c1snbG9nbyddID0gbG9nbwoJbWVudXNbJ3VybCddID0gdXJsCgltZW51c1sndGlwbyddID0gdGlwbwoJbWVudXNbJ2ZhbmFydCddID0gZmFuYXJ0CglwYWkuYXBwZW5kKG1lbnVzKQoJCmRlZiBtZW51KCk6CglpZiAobm90IF9fQURET05fXy5nZXRTZXR0aW5nKCdsb2dpbl9uYW1lJykgb3Igbm90IF9fQURET05fXy5nZXRTZXR0aW5nKCdsb2dpbl9wYXNzd29yZCcpKToKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdQcmVjaXNhIGRlIGRlZmluaXIgbyBzZXUgVXRpbGl6YWRvciBlIFNlbmhhJykKCQlhYnJpckRlZmluaW5jb2VzKCkKCQkKCWVsc2U6CQoJCWNoZWNrX2xvZ2luMiA9IGxvZ2lucGFpbmVsKCkKCQlpZiBjaGVja19sb2dpbjJbJ3VzZXInXVsnRXJybyddICE9ICcnOgoJCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsIGNoZWNrX2xvZ2luMlsndXNlciddWydFcnJvJ10pCgkJZWxzZToKCQkJX0xJSUxMXyA9IGNoZWNrX2xvZ2luMlsndXNlciddWydETlMnXQoJCQljaGVja19sb2dpbiA9IGxvZ2luKF9MSUlMTF8pCgkJCWlmIGNoZWNrX2xvZ2luWyd1c2VyJ11bJ3VzZXJuYW1lJ10gIT0gJyc6CgkJCQlpZiBjaGVja19sb2dpblsndXNlciddWydlc3RhZG8nXSA9PSAnRXhwaXJlZCc6CgkJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnQSBzdWEgY29udGEgZXN0w6EgRXhwaXJhZGEuIFBvciBmYXZvciBmYcOnYSBhIHN1YSBSZW5vdmHDp8OjbyBvdSBSZWFjdGl2YcOnw6NvLicpCQkKCQkJCWVsc2U6CgkJCQkJaWYgY2hlY2tfbG9naW5bJ3VzZXInXVsndHJpYWwnXSA9PSAnWWVzJyBhbmQgY2hlY2tfbG9naW5bJ3VzZXInXVsnZGF0YSddICE9ICdOZXZlcic6CgkJCQkJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0EgY29udGEgw6kgdW1hIGNvbnRhIGRlIFRlc3RlLiBBcMOzcyBvIHRlc3RlIGUgZ29zdGFyIGZhw6dhIGEgc3VhIEFxdWlzacOnw6NvLicpCgkJCQkJaWYgY2hlY2tfbG9naW5bJ3VzZXInXVsnZGF0YSddICE9ICdOZXZlcicgYW5kIGNoZWNrX2xvZ2luWyd1c2VyJ11bJ3RyaWFsJ10gPT0gJ05vJzoKCQkJCQkJaWYgY2hlY2tfbG9naW5bJ3VzZXInXVsnZGF0YSddID09ICcwJyBhbmQgY2hlY2tfbG9naW5bJ3VzZXInXVsndHJpYWwnXSAhPSAnWWVzJzoKCQkJCQkJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0Egc3VhIGNvbnRhIGV4cGlyYSBIb2plLiBGYcOnYSBqw6EgYSBzdWEgUmVub3Zhw6fDo28uJykKCQkJCQkJZWxzZToKCQkJCQkJCWlmIGludChjaGVja19sb2dpblsndXNlciddWydkYXRhJ10pIDwgNSBhbmQgY2hlY2tfbG9naW5bJ3VzZXInXVsnZGF0YSddID4gMDoKCQkJCQkJCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdBIHN1YSBjb250YSBleHBpcmEgZGFxdWkgYSAnK3N0cihjaGVja19sb2dpblsndXNlciddWydkYXRhJ10pKyAnIGRpYXMuIEZhw6dhIGrDoSBhIHN1YSBSZW5vdmHDp8Ojby4nKQoJCQkJCWNyaWFyTWVudShjaGVja19sb2dpblsnbWVudXMnXSwiTWluaGEgQ29udGEiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fY29uLnBuZycpLF9MSUlMTF8sImNvbnRhIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fY29uLnBuZycpKQoJCQkJCWNyaWFyTWVudShjaGVja19sb2dpblsnbWVudXMnXSwiVmVyIFRWIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX3R2LnBuZycpLF9MSUlMTF8sInR2Iixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fdHYucG5nJykpCgkJCQkJY3JpYXJNZW51KGNoZWNrX2xvZ2luWydtZW51cyddLCJWw61kZW8gQ2x1YmUiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fdmlkLnBuZycpLF9MSUlMTF8sImZpbG1lcyIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3ZpZC5wbmcnKSkKCQkJCQljcmlhck1lbnUoY2hlY2tfbG9naW5bJ21lbnVzJ10sIlRWIEFyY2hpdmUiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fdHZfYXJjLnBuZycpLF9MSUlMTF8sInR2YXJjaGl2ZSIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3R2X2FyYy5wbmcnKSkKCQkJCQkKCQkJCQlmaWxtZXNfYXBwID0gY2hlY2tfbG9naW4yWyd1c2VyJ11bJ0ZpbG1lc19hcHAnXTsKCQkJCQlpZiBmaWxtZXNfYXBwID09IDQgb3IgZmlsbWVzX2FwcCA9PSAnNCc6CgkJCQkJCWNyaWFyTWVudShjaGVja19sb2dpblsnbWVudXMnXSwiRXh0cmFzIixfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsiQWRkb24vSW1hZ2Vucy9ub3ZpZGFkZXN0di5wbmciLCJleHRyYXMiLCJleHRyYXMiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb190dl9hcmMucG5nJykpCgkJCQkJY3JpYXJNZW51KGNoZWNrX2xvZ2luWydtZW51cyddLCJDb25maWd1cmHDp8O1ZXMiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fZGVmLnBuZycpLCJjb25maWd1cmFyIiwiY29uZmlndXJhciIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2RlZi5wbmcnKSkKCQkJCQljcmlhck1lbnUoY2hlY2tfbG9naW5bJ21lbnVzJ10sIkxpbXBhciBDYWNoZSIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb19saW0ucG5nJyksImxpbXBhcmNhY2hlIiwibGltcGFyY2FjaGUiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19saW0ucG5nJykpCgkJCQkJY3JpYXJNZW51KGNoZWNrX2xvZ2luWydtZW51cyddLCJMaW1wYXIgVHVkbyBHcmF2YWRvIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX2xpbS5wbmcnKSwibGltcGFydHVkbyIsImxpbXBhcnR1ZG8iLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19saW0ucG5nJykpCgkJCQkJaWYoY2hlY2tfbG9naW4yWyd1c2VyJ11bJ0VtYWlsJ10gIT0gJycgYW5kIGNoZWNrX2xvZ2luMlsndXNlciddWydFbWFpbCddICE9ICdlbWFpbCcpOgoJCQkJCQlhZGRMaW5rQ2FuYWxMaXN0YSgiW0NPTE9SID0gd2hpdGVdRW1haWwgRMO6dmlkYXM6IFsvQ09MT1JdIitjaGVja19sb2dpbjJbJ3VzZXInXVsnRW1haWwnXSwiIiwiIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX2Nvbi5wbmcnKSxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fY29uLnBuZycpLCcnKQoJCQkJCWlmKGNoZWNrX2xvZ2luMlsndXNlciddWydXZWJTaXRlJ10gIT0gJycgYW5kIGNoZWNrX2xvZ2luMlsndXNlciddWydXZWJTaXRlJ10gIT0gJ2h0dHA6Ly8nKToKCQkJCQkJYWRkTGlua0NhbmFsTGlzdGEoIltDT0xPUiA9IHdoaXRlXUFxdWlzacOnw6NvOiBbL0NPTE9SXSIrY2hlY2tfbG9naW4yWyd1c2VyJ11bJ1dlYlNpdGUnXSwiIiwiIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX2Nvbi5wbmcnKSxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fY29uLnBuZycpLCcnKQoJCQkJCU1lbnVfaW5pY2lhbChjaGVja19sb2dpbixGYWxzZSwnJykKCQkJCV9fRVBHX18gPSBfTElJTExfKyd4bWx0di5waHA/dXNlcm5hbWU9JytfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fbmFtZScpKycmcGFzc3dvcmQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fcGFzc3dvcmQnKSsnJmVwZ19zaGlmdD0wJwoJCQkJX19BRERPTl9fLnNldFNldHRpbmcoJ2xpc3RhX2VwZycsIF9fRVBHX18pCgkJCQl0aHJlYWQuc3RhcnRfbmV3X3RocmVhZChvYnRlcl9maWNoZWlyb19lcGcsICgpICkKCQkJCXZpc3RhX21lbnUoKQoJCQllbHNlOgoJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVXRpbGl6YWRvciBvdSBzZW5oYSBJbmNvcnJlY3Rvcy4gQWx0ZXJlIGUgdGVudGUgbm92YW1lbnRlLicpCgkJCQlhZGREaXIoJ0FsdGVyYXIgRGVmaW5pw6fDtWVzJywgJ3VybCcsIDUsICdNaW5pYXR1cmEnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX2RlZi5wbmcnKSwnJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2RlZi5wbmcnKSkKCQkJCWFkZERpcignRW50cmFyIG5vdmFtZW50ZScsICd1cmwnLCBOb25lLCAnTWluaWF0dXJhJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb19saW0ucG5nJyksJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2xpbS5wbmcnKSkKCQkJCXZpc3RhX21lbnUoKQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwkJCQkJCQkgIExvZ2luIEFkZG9uCQkJCQkJCQkJCSAgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZGVmIGxvZ2lucGFpbmVsKCk6CglpbmZvcm1hY29lcyA9IHsKCQkndXNlcicgOiB7CgkJCSdOb21lJzogJycsCgkJCSdBY2Vzc19Ub2tlbic6ICcnLAoJCQknRE5TJzogJycsCgkJCSdFbWFpbCc6ICcnLAoJCQknV2ViU2l0ZSc6ICcnLAoJCQknVmVyQVBQJzogJycsCgkJCSdMaW5rQVBQJzogJycsCgkJCSdFcnJvJzogJycsCgkJCSdNZWxob3JhbWVudG9zJzogJycsCgkJCSdDbGllbnRfU2VjcmV0X1VzZXInOiAnJywKCQkJJ0ZpbG1lc19hcHAnOiAnJwoJCX0KCX0KCXRyeToKCQluZXQgPSBOZXQoKQoJCWRhZG9zID0geydub21lX2FwcCc6IEFkZG9uVGl0bGUsICd0aXBvX2FwcCc6ICdBZGRvbicsICd1c2VybmFtZSc6IF9fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9uYW1lIiksICdwYXNzd29yZCc6IF9fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9wYXNzd29yZCIpfQoJCWNvZGlnb19mb250ZSA9IG5ldC5odHRwX1BPU1QoYmFzZTY0LmI2NGRlY29kZShfTElJTExfKSxmb3JtX2RhdGE9ZGFkb3MsaGVhZGVycz1fX0hFQURFUlNfXykuY29udGVudAoJCWVsZW1zID0gRVQuZnJvbXN0cmluZyhjb2RpZ29fZm9udGUpCgkJZm9yIGNoaWxkIGluIGVsZW1zOgoJCQlpZihjaGlsZC50YWcgPT0gJ2Vycm8nKToKCQkJCSNpbmZvcm1hY29lc1sndXNlciddWydFcnJvJ10gPSBjaGlsZC50ZXh0CgkJCQlpbmZvcm1hY29lc1sndXNlciddWydOb21lJ10gPSBBZGRvblRpdGxlCgkJCQlpbmZvcm1hY29lc1sndXNlciddWydBY2Vzc19Ub2tlbiddID0gJycKCQkJCV9fQURET05fXy5zZXRTZXR0aW5nKCdhY2Vzc19Ub2tlbicsICcnKQoJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnRE5TJ10gPSBiYXNlNjQudXJsc2FmZV9iNjRkZWNvZGUoX19BRERPTl9fLmdldFNldHRpbmcoJ2Ruc19hZGRvbicpKQoJCQkJX19FUEdfXyA9IGluZm9ybWFjb2VzWyd1c2VyJ11bJ0ROUyddKyd4bWx0di5waHA/dXNlcm5hbWU9JytfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fbmFtZScpKycmcGFzc3dvcmQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fcGFzc3dvcmQnKSsnJmVwZ19zaGlmdD0wJwoJCQkJX19BRERPTl9fLnNldFNldHRpbmcoJ2xpc3RhX2VwZycsIF9fRVBHX18pCgkJCQlpbmZvcm1hY29lc1sndXNlciddWydFbWFpbCddID0gJycKCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ1dlYlNpdGUnXSA9ICcnCgkJCQlpbmZvcm1hY29lc1sndXNlciddWydWZXJBUFAnXSA9IF9fQURET05WRVJTSU9OX18KCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ0xpbmtBUFAnXSA9ICcnCgkJCQlpbmZvcm1hY29lc1sndXNlciddWydNZWxob3JhbWVudG9zJ10gPSAnJwoJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnRmlsbWVzX2FwcCddID0gJzUnCgkJCQlfX0FERE9OX18uc2V0U2V0dGluZygnZW1haWwnLCAnJykKCQkJCV9fQURET05fXy5zZXRTZXR0aW5nKCdwYXNzd29yZCcsICcnKQoJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnQ2xpZW50X1NlY3JldF9Vc2VyJ10gPSAnJwoJCQkJX19BRERPTl9fLnNldFNldHRpbmcoJ2NsaWVudF9zZWNyZXRfdXNlcicsICcnKQoJCQllbGlmKGNoaWxkLnRhZyA9PSAndmFsaWRhY2FvJyk6CgkJCQlmb3IgZCBpbiBjaGlsZDoKCQkJCQlpZihkLnRhZyA9PSAnTm9tZScpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydOb21lJ10gPSBkLnRleHQKCQkJCQllbGlmKGQudGFnID09ICdBY2Vzc19Ub2tlbicpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydBY2Vzc19Ub2tlbiddID0gZC50ZXh0CgkJCQkJCV9fQURET05fXy5zZXRTZXR0aW5nKCdhY2Vzc19Ub2tlbicsIGQudGV4dCkKCQkJCQllbGlmKGQudGFnID09ICdETlMnKToKCQkJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnRE5TJ10gPSBkLnRleHQKCQkJCQllbGlmKGQudGFnID09ICdFbWFpbCcpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydFbWFpbCddID0gZC50ZXh0CgkJCQkJZWxpZihkLnRhZyA9PSAnV2ViU2l0ZScpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydXZWJTaXRlJ10gPSBkLnRleHQKCQkJCQllbGlmKGQudGFnID09ICdWZXJBUFAnKToKCQkJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnVmVyQVBQJ10gPSBkLnRleHQKCQkJCQllbGlmKGQudGFnID09ICdMaW5rQVBQJyk6CgkJCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ0xpbmtBUFAnXSA9IGQudGV4dAoJCQkJCWVsaWYoZC50YWcgPT0gJ01lbGhvcmFtZW50b3MnKToKCQkJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnTWVsaG9yYW1lbnRvcyddID0gZC50ZXh0CgkJCQkJZWxpZihkLnRhZyA9PSAnZmlsbWVzX2FwcCcpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydGaWxtZXNfYXBwJ10gPSBkLnRleHQKCQkJCQllbGlmKGQudGFnID09ICd1c2VyX2tvZGknKToKCQkJCQkJX19BRERPTl9fLnNldFNldHRpbmcoJ2VtYWlsJywgZC50ZXh0KQoJCQkJCWVsaWYoZC50YWcgPT0gJ3NlbmhhX2tvZGknKToKCQkJCQkJX19BRERPTl9fLnNldFNldHRpbmcoJ3Bhc3N3b3JkJywgZC50ZXh0KQoJCQkJCWVsaWYoZC50YWcgPT0gJ0NsaWVudF9TZWNyZXRfVXNlcicpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydDbGllbnRfU2VjcmV0X1VzZXInXSA9IGQudGV4dAoJCQkJCQlfX0FERE9OX18uc2V0U2V0dGluZygnY2xpZW50X3NlY3JldF91c2VyJywgZC50ZXh0KQoJCQllbHNlOgoJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnTsOjbyBzZWkgbyBxdWUgZXN0b3UgYSBsZXIuJykKCWV4Y2VwdDoKCQlpbmZvcm1hY29lc1sndXNlciddWydOb21lJ10gPSBBZGRvblRpdGxlCgkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnQWNlc3NfVG9rZW4nXSA9ICcnCgkJX19BRERPTl9fLnNldFNldHRpbmcoJ2FjZXNzX1Rva2VuJywgJycpCgkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnRE5TJ10gPSBiYXNlNjQudXJsc2FmZV9iNjRkZWNvZGUoX19BRERPTl9fLmdldFNldHRpbmcoJ2Ruc19hZGRvbicpKQoJCV9fRVBHX18gPSBpbmZvcm1hY29lc1sndXNlciddWydETlMnXSsneG1sdHYucGhwP3VzZXJuYW1lPScrX19BRERPTl9fLmdldFNldHRpbmcoJ2xvZ2luX25hbWUnKSsnJnBhc3N3b3JkPScrX19BRERPTl9fLmdldFNldHRpbmcoJ2xvZ2luX3Bhc3N3b3JkJykrJyZlcGdfc2hpZnQ9MCcKCQlfX0FERE9OX18uc2V0U2V0dGluZygnbGlzdGFfZXBnJywgX19FUEdfXykKCQlpbmZvcm1hY29lc1sndXNlciddWydFbWFpbCddID0gJycKCQlpbmZvcm1hY29lc1sndXNlciddWydXZWJTaXRlJ10gPSAnJwoJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ1ZlckFQUCddID0gX19BRERPTlZFUlNJT05fXwoJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ0xpbmtBUFAnXSA9ICcnCgkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnTWVsaG9yYW1lbnRvcyddID0gJycKCQlpbmZvcm1hY29lc1sndXNlciddWydGaWxtZXNfYXBwJ10gPSAnNScKCQlfX0FERE9OX18uc2V0U2V0dGluZygnZW1haWwnLCAnJykKCQlfX0FERE9OX18uc2V0U2V0dGluZygncGFzc3dvcmQnLCAnJykKCQlpbmZvcm1hY29lc1sndXNlciddWydDbGllbnRfU2VjcmV0X1VzZXInXSA9ICcnCgkJX19BRERPTl9fLnNldFNldHRpbmcoJ2NsaWVudF9zZWNyZXRfdXNlcicsICcnKQoJCSNfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdOw6NvIGZvaSBwb3Nzw612ZWwgYWJyaXIgYSBww6FnaW5hLiBQb3IgZmF2b3IgdGVudGUgbm92YW1lbnRlLicpCgkJcmV0dXJuIGluZm9ybWFjb2VzCgoJcmV0dXJuIGluZm9ybWFjb2VzCgpkZWYgbG9naW4odXJsKToKCWluZm9ybWFjb2VzID0gewoJCSd1c2VyJyA6IHsKCQkJJ3VzZXJuYW1lJzogJycsCgkJCSdwYXNzd29yZCc6ICcnLAoJCQknZXN0YWRvJzogJycsCgkJCSdkYXRhJzogJycsCgkJCSd0cmlhbCc6ICcnLAoJCQknbGlzdGEnOiAnJywKCQkJJ2NvbmVjY29lcyc6ICcnCgkJCQoJCX0sCgkJJ21lbnVzJzogW10KCX0gIyAKCWFuZG1lbGluayA9IHVybCsncGFuZWxfYXBpLnBocD9tb2RlPXVzZXJfaW5mbyZ1c2VybmFtZT0nK19fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9uYW1lIikrJyZwYXNzd29yZD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9wYXNzd29yZCIpCglhbmRtZWQgPSBncmFiX2VwZyhhbmRtZWxpbmspCglpZiBhbmRtZWQgIT0gTm9uZToKCQlrYXN1dGFqYUFuZG1lZCA9IGFuZG1lZFtzeW5jX2RhdGEoImRYTmxjbDlwYm1adiIpXQoJCWthc3V0YWphQW5kbWVkMiA9IGFuZG1lZFtzeW5jX2RhdGEoImMyVnlkbVZ5WDJsdVptOD0iKV0KCQlzZWlzID0ga2FzdXRhamFBbmRtZWRbZ2V0X2xpdmUoImMzUmhkSFZ6IildCgkJYWVndWIgPSBrYXN1dGFqYUFuZG1lZFtzeW5jX2RhdGEoIlpYaHdYMlJoZEdVPSIpXQoJCWlmIGFlZ3ViOgoJCQlhZWd1YiA9IGRhdGUuZnJvbXRpbWVzdGFtcChpbnQoYWVndWIpKS5zdHJmdGltZSgiJVktJW0tJWQiKQoJCQkjI2VhZWFlbiA9IGthc3V0YWphQW5kbWVkMltzeW5jX2RhdGEoImRHbHRaVjl1YjNjPSIpXQoJCQkKCQkJdmlld1N0YXJ0RGF0ZSA9IGRhdGV0aW1lLmRhdGV0aW1lLm5vdygpLnN0cmZ0aW1lKCIlWS0lbS0lZCIpCgkJCQoJCQlmb3JtYXQgPSAiJVktJW0tJWQiCgkJCQoJCQl0cnk6CgkJCQlob2plMSA9IGRhdGV0aW1lLmRhdGV0aW1lLnN0cnB0aW1lKGFlZ3ViLCBmb3JtYXQpCgkJCWV4Y2VwdCBUeXBlRXJyb3I6CgkJCQlob2plMSA9IGRhdGV0aW1lLmRhdGV0aW1lKCoodGltZS5zdHJwdGltZShhZWd1YiwgZm9ybWF0KVswOjZdKSkKCQkJCgkJCXRyeToKCQkJCWhvamUyID0gZGF0ZXRpbWUuZGF0ZXRpbWUuc3RycHRpbWUodmlld1N0YXJ0RGF0ZSwgZm9ybWF0KQoJCQlleGNlcHQgVHlwZUVycm9yOgoJCQkJaG9qZTIgPSBkYXRldGltZS5kYXRldGltZSgqKHRpbWUuc3RycHRpbWUodmlld1N0YXJ0RGF0ZSwgZm9ybWF0KVswOjZdKSkKCQkJCgkJCWFlZ3ViID0gc3RyKGFicygoaG9qZTEtaG9qZTIpLmRheXMpKQoJCWVsc2U6CgkJCWFlZ3ViID0gdm9kX2NoYW5uZWxzKCJUbVYyWlhJPSIpIAoJCXJhYmJpdHMgPSBrYXN1dGFqYUFuZG1lZFt2b2RfY2hhbm5lbHMoImFYTmZkSEpwWVd3PSIpXQoJCWlmIHJhYmJpdHMgPT0gIjAiOgoJCQlyYWJiaXRzID0gc3luY19kYXRhKCJUbTg9IikKCQllbHNlOgoJCQlyYWJiaXRzID0gc3luY19kYXRhKCJXV1Z6IikKCQlsZWF2ZW1lYWxvbmUgPSBrYXN1dGFqYUFuZG1lZFtnZXRfbGl2ZSgiYldGNFgyTnZibTVsWTNScGIyNXoiKV0KCQlwb2xhcmJlYXJzID0ga2FzdXRhamFBbmRtZWRbc3luY19kYXRhKCJkWE5sY201aGJXVT0iKV0KCQkKCQlpZihwb2xhcmJlYXJzICE9ICcnKToKCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsndXNlcm5hbWUnXSA9ICJbQ09MT1IgPSB3aGl0ZV1VdGlsaXphZG9yOiBbL0NPTE9SXSIrcG9sYXJiZWFycwoJCQlpbmZvcm1hY29lc1sndXNlciddWydlc3RhZG8nXSA9IHNlaXMKCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnZGF0YSddID0gYWVndWIKCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsndHJpYWwnXSA9IHJhYmJpdHMKCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnY29uZWNjb2VzJ10gPSAiW0NPTE9SID0gd2hpdGVdTWF4aW1vIGRlIENvbm5lYzogWy9DT0xPUl0iK2xlYXZlbWVhbG9uZQoJCQlpbmZvcm1hY29lc1sndXNlciddWydsaXN0YSddID0gdXJsCgkKCXJldHVybiBpbmZvcm1hY29lcwoKZGVmIGxvZ2luMigpOgoJcmVzdWx0YWRvID0gRmFsc2UKCXRyeToKCQlwb3N0ID0gdXJsbGliLnVybGVuY29kZSh7J3VzZXJuYW1lJzogX19BRERPTl9fLmdldFNldHRpbmcoJ2VtYWlsJyksICdwYXNzd29yZCc6IF9fQURET05fXy5nZXRTZXR0aW5nKCdwYXNzd29yZCcpIH0pCgkJcmVzdWx0YWRvID0gYWJyaXJfdXJsKF9fQVBJX1NJVEVfXysnbG9naW4ucGhwJywgcG9zdD1wb3N0LCBoZWFkZXI9aGVhZGVycykKCQkKCQlpZiByZXN1bHRhZG8gPT0gJ0ROUyc6CgkJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1RlbSBkZSBhbHRlcmFyIG9zIEROUyBwYXJhIHBvZGVyIHVzdWZydWlyIGRvIF9fQURET05fXy4nKQoJCQlyZXR1cm4gRmFsc2UKCQkJCgkJdHJ5OgoJCQlyZXN1bHRhZG8gPSByZXN1bHRhZG8uZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OgoJCQlyZXN1bHRhZG8gPSByZXN1bHRhZG8uZW5jb2RlKCd1dGYtOCcpCgkJdHJ5OgoJCQlpZiByZXN1bHRhZG9bJ2NvZGlnbyddID09IDIwNDoKCQkJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgcmVzdWx0YWRvWydtZW5zYWdlbSddKQoJCQkJcmV0dXJuIEZhbHNlCgkJZXhjZXB0OgoJCQlwYXNzCgkJCgkJZXNjcmV2ZXJfZmljaGVpcm8ob3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnZGVmaW5pY29lcy5saXZlaXQnKSwgcmVzdWx0YWRvKQoJCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJCSNjb2xvY2FyIG8gbG9nZ2VkaW4KCQl0b2tlbiA9IHJlc3VsdGFkb1snY29va2llJ10KCQlyZWZyZXNoID0gcmVzdWx0YWRvWydleHBpcmEnXQoJCQoJCXRyeToKCQkJdXNlcm5hbWUgPSByZXN1bHRhZG9bJ3VzZXJuYW1lJ10uZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OgoJCQl1c2VybmFtZSA9IHJlc3VsdGFkb1sndXNlcm5hbWUnXS5lbmNvZGUoJ3V0Zi04JykKCQkKCQlfX0FERE9OX18uc2V0U2V0dGluZygndG9rZW5NcnBpcmFjeScsIHRva2VuKQoJCV9fQURET05fXy5zZXRTZXR0aW5nKCdyZWZyZXNoTXJwaXJhY3knLCByZWZyZXNoKQoJCV9fQURET05fXy5zZXRTZXR0aW5nKCdsb2dnZWRpbicsIHVzZXJuYW1lKQoJCQoJCWNhdGVnb3JpYXMgPSByZXN1bHRhZG9bJ2NhdGVnb3JpYXMnXQoJCWVzY3JldmVyX2ZpY2hlaXJvKG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ2NhdGVnb3JpYXMubGl2ZWl0JyksIHN0cihjYXRlZ29yaWFzKSkKCQlyZXR1cm4gVHJ1ZQoJZXhjZXB0OgoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ07Do28gZm9pIHBvc3PDrXZlbCBhYnJpciBhIHDDoWdpbmEuIFBvciBmYXZvciB0ZW50ZSBub3ZhbWVudGUuJykKCQlyZXR1cm4gRmFsc2UKCmRlZiBNZW51X2luaWNpYWwobWVuLGJ1aWxkLHRpcG8pOgoJX25vbWV1c2VyID0gbWVuWyd1c2VyJ11bJ3VzZXJuYW1lJ10KCWZvciBtZW51IGluIG1lblsnbWVudXMnXToKCQlub21lID0gbWVudVsnbm9tZSddCgkJbG9nbyA9IG1lbnVbJ2xvZ28nXQoJCWxpbmsgPSBtZW51Wyd1cmwnXQoJCXRpcG8gPSBtZW51Wyd0aXBvJ10KCQlmYW5hcnQgPSBtZW51WydmYW5hcnQnXQoJCQoJCWlmIHRpcG8gPT0gJ2NvbnRhJyA6CgkJCWFkZERpcihub21lLGxpbmssMiwnTGlzdGEnLGxvZ28sdGlwbyxmYW5hcnQpCgkJZWxpZih0aXBvID09ICd0dicpOgoJCQlhZGREaXIobm9tZSxsaW5rLDMsJ0xpc3RhJyxsb2dvLHRpcG8sZmFuYXJ0KQoJCWVsaWYodGlwbyA9PSAnZmlsbWVzJyk6CgkJCWFkZERpcihub21lLGxpbmssMSwnTGlzdGEnLGxvZ28sdGlwbyxmYW5hcnQpCgkJZWxpZih0aXBvID09ICdleHRyYXMnKToKCQkJYWRkRGlyKG5vbWUsbGluaywxMDYsJ0xpc3RhJyxsb2dvLHRpcG8sZmFuYXJ0KQoJCWVsaWYodGlwbyA9PSAnY29uZmlndXJhcicpOgoJCQlhZGREaXIobm9tZSxsaW5rLDUsJ0xpc3RhJyxsb2dvLHRpcG8sZmFuYXJ0KQoJCWVsaWYgdGlwbyA9PSAndHZhcmNoaXZlJzoKCQkJYWRkRGlyKG5vbWUsbGluayw2LCdMaXN0YScsbG9nbywnJyxmYW5hcnQpCgkJZWxpZih0aXBvID09ICdsaW1wYXJjYWNoZScpOgoJCQlhZGREaXIobm9tZSwgbGluaywgMTMsICdMaXN0YScsbG9nbyx0aXBvLGZhbmFydCkKCQllbGlmKHRpcG8gPT0gJ2xpbXBhcnR1ZG8nKToKCQkJYWRkRGlyKG5vbWUsIGxpbmssIDE0LCAnTGlzdGEnLGxvZ28sdGlwbyxmYW5hcnQpCgkJCgl4Ym1jLmV4ZWN1dGVidWlsdGluKCdOb3RpZmljYXRpb24oJXMsICVzLCAlaSwgJXMpJyUoQWRkb25UaXRsZSxfbm9tZXVzZXIsIDgwMDAsIF9JQ09OXykpCgl4Ym1jcGx1Z2luLmVuZE9mRGlyZWN0b3J5KGludChzeXMuYXJndlsxXSksY2FjaGVUb0Rpc2M9RmFsc2UpCgpkZWYgYWJyaXJFeHRyYXMoKToKCXVybG5vbzEgPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC9idXNjYXJyYWRpb3MucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZhZGRvbj0xJwoJYWRkRGlyKCJSw6FkaW9zIix1cmxub28xLDEwMiwnTGlzdGEnLF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJBZGRvbi9JbWFnZW5zL3JhZGlvcy5wbmciLCdwcmFpYXMnLF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJBZGRvbi9JbWFnZW5zL3JhZGlvc19mYW5hcnQucG5nIikKCXVybG5vbzEgPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC9idXNjYXJwcmFpYXMucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZhZGRvbj0xJwoJYWRkRGlyKCJQcmFpYXMiLHVybG5vbzEsMTAxLCdMaXN0YScsX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrIkFkZG9uL0ltYWdlbnMvbm92aWRhZGVzdHYucG5nIiwncHJhaWFzJyxfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsiQWRkb24vSW1hZ2Vucy9ub3ZpZGFkZXNfZmFuYXJ0LnBuZyIpCgl1cmxub28xID0gX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvYnVzY2FybmV3dGVsZW5vdmVsYXMucGhwP3RpcG89UHJvZ3JhbWFzJmNsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZhZGRvbj0xJwoJYWRkRGlyKCJQcm9ncmFtYXMgZSBUZWxlbm92ZWxhcyIsdXJsbm9vMSwxMDMsJ0xpc3RhJyxfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsiQWRkb24vSW1hZ2Vucy9ub3ZpZGFkZXN0di5wbmciLCdwcmFpYXMnLF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJBZGRvbi9JbWFnZW5zL25vdmlkYWRlc19mYW5hcnQucG5nIikKCXVybG5vbzEgPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC9idXNjYXJuZXd0ZWxlbm92ZWxhcy5waHA/dGlwbz1Kb3JuYWlzJmNsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZhZGRvbj0xJwoJYWRkRGlyKCJKb3JuYWlzIix1cmxub28xLDEwNywnTGlzdGEnLF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJBZGRvbi9JbWFnZW5zL25vdmlkYWRlc3R2LnBuZyIsJ2pvcm5haXMnLF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJBZGRvbi9JbWFnZW5zL25vdmlkYWRlc19mYW5hcnQucG5nIikKCQoJdmlzdGFfbWVudSgpCgpkZWYgbGlzdGFyX2dydXBvczEobW9kb24sdXJsLGZhbmFydCk6CglyZXN1bHRhZG8xID0gZGV2b2x2ZXJlc3VsdGFkbyh1cmwpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbzEpCglmb3IgaSBpbiByZXN1bHRhZG9bJ2NhbmFpcyddOgoJCWlkID0gaVsnSUQnXQoJCW5vbWUgPSAiIgoJCWltYWdlbSA9ICIiCgkJdXJsbiA9ICIiCgkJdHJ5OiBub21lID0gYmFzZTY0LmI2NGRlY29kZShpWydOb21lJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCXRyeTogCgkJCWltYWdlbSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnSW1hZ2VtJ10pLmRlY29kZSgndXRmLTgnKQoJCQlpbWFnZW0gPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsiTG9nb3MvIitpbWFnZW0KCQlleGNlcHQ6IHBhc3MKCQl0cnk6IHVybG4gPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ1VybCddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQlhZGRMaW5rQ2FuYWxMaXN0YShub21lLHVybG4saW1hZ2VtLCcnLGZhbmFydCwgJzAwMDEnKQoJCQpkZWYgbGlzdGFyX2dydXBvczIobW9kb24sdXJsLGZhbmFydCk6CglyZXN1bHRhZG8xID0gZGV2b2x2ZXJlc3VsdGFkbyh1cmwpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbzEpCglmb3IgaSBpbiByZXN1bHRhZG9bJ2NhbmFpcyddOgoJCWlkID0gaVsnSUQnXQoJCW5vbWUgPSAiIgoJCWltYWdlbSA9ICIiCgkJdXJsbiA9ICIiCgkJdHJ5OiBub21lID0gYmFzZTY0LmI2NGRlY29kZShpWydOb21lJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCXRyeTogCgkJCWltYWdlbSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnSW1hZ2VtJ10pLmRlY29kZSgndXRmLTgnKQoJCQlpbWFnZW0gPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsiTG9nb3MvIitpbWFnZW0KCQlleGNlcHQ6IHBhc3MKCQl0cnk6IHVybG4gPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ1VybCddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQlhZGRMaW5rQ2FuYWxMaXN0YShub21lLHVybG4saW1hZ2VtLCcnLGZhbmFydCwgJzAwMDEnKQoJCmRlZiBsaXN0YXJfZ3J1cG9zMyhtb2Rvbix1cmwsZmFuYXJ0KToKCXJlc3VsdGFkbzEgPSBkZXZvbHZlcmVzdWx0YWRvKHVybCkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvMSkKCWZvciBpIGluIHJlc3VsdGFkb1snY2FuYWlzJ106CgkJbm9tZSA9ICIiCgkJaW1hZ2VtID0gIiIKCQl1cmxuID0gIiIKCQl0aXBvID0gIiIKCQl3ZWJzaXRlID0gIiIKCQljYW5hbCA9ICIiCgkJdHJ5OiBub21lID0gYmFzZTY0LmI2NGRlY29kZShpWydOb21lJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCXRyeTogCgkJCWltYWdlbSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnSW1hZ2VtJ10pLmRlY29kZSgndXRmLTgnKQoJCQlpbWFnZW0gPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsiTG9nb3MvIitpbWFnZW0KCQlleGNlcHQ6IHBhc3MKCQl0cnk6IHVybG4gPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ1VybCddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQl0cnk6IHdlYnNpdGUgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ1dlYlNpdGUnXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OiBwYXNzCgkJdHJ5OiB0aXBvID0gaVsnVGlwbyddCgkJZXhjZXB0OiBwYXNzCgkJdHJ5OiBjYW5hbCA9IGlbJ0NhbmFsJ10KCQlleGNlcHQ6IHBhc3MKCQl1cmxub28zID0gX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvYnVzY2FyaW5mb3RlbGVub3ZlbGFzLnBocD90aXBvPScrdGlwbysnJndlYnNpdGU9Jyt3ZWJzaXRlKycmdXJsPScrdXJsbisnJmNsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZhZGRvbj0xJwoJCWFkZERpcihub21lLHVybG5vbzMsMTA0LCdMaXN0YScsaW1hZ2VtLCdQcm9ncmFtYXMnLF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJBZGRvbi9JbWFnZW5zL25vdmlkYWRlc19mYW5hcnQucG5nIikKCmRlZiBsaXN0YXJfZ3J1cG9zNChtb2Rvbix1cmwsaWNvbmltYWdlLGZhbmFydCk6CglyZXN1bHRhZG8xID0gZGV2b2x2ZXJlc3VsdGFkbyh1cmwpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbzEpCglmb3IgaSBpbiByZXN1bHRhZG9bJ2VwaXNvZGlvcyddOgoJCW5vbWUgPSAiIgoJCXVybG4gPSBpWyd1cmwnXQoJCXRyeTogbm9tZSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsndGl0dWxvJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCWFkZExpbmtDYW5hbExpc3RhKG5vbWUsdXJsbixpY29uaW1hZ2UsJ3Byb2dyYW1hcycsZmFuYXJ0LCAnMDAwMScpCgkJCmRlZiBsaXN0YXJfZ3J1cG9zNShtb2Rvbix1cmwsZmFuYXJ0KToKCXJlc3VsdGFkbzEgPSBkZXZvbHZlcmVzdWx0YWRvKHVybCkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvMSkKCWZvciBpIGluIHJlc3VsdGFkb1snY2FuYWlzJ106CgkJbm9tZSA9ICIiCgkJaW1hZ2VtID0gIiIKCQl1cmxuID0gIiIKCQl0aXBvID0gIiIKCQl3ZWJzaXRlID0gIiIKCQljYW5hbCA9ICIiCgkJdHJ5OiBub21lID0gYmFzZTY0LmI2NGRlY29kZShpWydOb21lJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCXRyeTogCgkJCWltYWdlbSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnSW1hZ2VtJ10pLmRlY29kZSgndXRmLTgnKQoJCQlpbWFnZW0gPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsiTG9nb3MvIitpbWFnZW0KCQlleGNlcHQ6IHBhc3MKCQl0cnk6IHVybG4gPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ1VybCddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQl0cnk6IHdlYnNpdGUgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ1dlYlNpdGUnXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OiBwYXNzCgkJdHJ5OiB0aXBvID0gaVsnVGlwbyddCgkJZXhjZXB0OiBwYXNzCgkJdHJ5OiBjYW5hbCA9IGlbJ0NhbmFsJ10KCQlleGNlcHQ6IHBhc3MKCQl1cmxub28zID0gX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvYnVzY2FyaW5mb3RlbGVub3ZlbGFzLnBocD90aXBvPWpvcm5haXMmdXJsPScrdXJsbisnJmNsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZhZGRvbj0xJwoJCWFkZERpcihub21lLHVybG5vbzMsMTA4LCdMaXN0YScsaW1hZ2VtLCdKb3JuYWlzJyxfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsiQWRkb24vSW1hZ2Vucy9ub3ZpZGFkZXNfZmFuYXJ0LnBuZyIpCgpkZWYgbGlzdGFyX2dydXBvczYobW9kb24sdXJsLGljb25pbWFnZSxmYW5hcnQpOgoJcmVzdWx0YWRvMSA9IGRldm9sdmVyZXN1bHRhZG8odXJsKQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8xKQoJZm9yIGkgaW4gcmVzdWx0YWRvWydlcGlzb2Rpb3MnXToKCQlub21lID0gIiIKCQl1cmxuID0gIiIKCQl0cnk6IG5vbWUgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ3RpdHVsbyddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQl0cnk6IHVybG4gPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ3VybCddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQkKCQlhZGREaXIobm9tZSx1cmxuLDEwOSwnTGlzdGEnLGljb25pbWFnZSwnUHJvZ3JhbWFzJyxmYW5hcnQpCgl4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTUpIikKCmRlZiBwbGF5X211bHRfY2FuYWwyKGFyZywgaWNvbiwgbm9tZSk6Cgl4Ym1jLmV4ZWN1dGVidWlsdGluKCdTaG93UGljdHVyZSgiezB9IiknLmZvcm1hdChhcmcpKQoKZGVmIGFicmlyVmlkZW9DbHViZSh1cmwpOgoJY2hlY2tfbG9naW4yID0gbG9naW5wYWluZWwoKQoJZmlsbWVzX2FwcCA9IGNoZWNrX2xvZ2luMlsndXNlciddWydGaWxtZXNfYXBwJ107CglmaWxtaWxpbmsgPSB1cmwrJ2VuaWdtYTIucGhwP3VzZXJuYW1lPScrX19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX25hbWUiKSsnJnBhc3N3b3JkPScrX19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX3Bhc3N3b3JkIikrJyZ0eXBlPWdldF92b2RfY2F0ZWdvcmllcycKCWlmIGZpbG1lc19hcHAgPT0gMCBvciBmaWxtZXNfYXBwID09ICcwJzoKCQlkYXRhYmFzZSA9IERhdGFiYXNlLmNyaWFyRmljaGVpcm9zKCkKCQlhZGREaXIoJ0ZpbG1lcyBkYSBMaXN0YScsZmlsbWlsaW5rLDQsJ01pbmlhdHVyYScsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ZpbG1lcy5wbmcnKSwnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fX19BRERPTl9fLnBuZycpKQoJCWFkZERpcignRmlsbWVzIGRvIEFkZG9uJyx1cmwsMjEsJ01pbmlhdHVyYScsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ZpbG1lcy5wbmcnKSwnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fX19BRERPTl9fLnBuZycpKQoJCWFkZERpcignU8OpcmllcyBkbyBBZGRvbicsdXJsLDIwLCdNaW5pYXR1cmEnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdzZXJpZXMucG5nJyksJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX19fQURET05fXy5wbmcnKSkKCQlhZGREaXIoJ0FuaW1lcyBkbyBBZGRvbicsdXJsLDI0LCdNaW5pYXR1cmEnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdhbmltZS5wbmcnKSwnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fX19BRERPTl9fLnBuZycpKQoJCWFkZERpcignW0NPTE9SIHBpbmtdW0JdUGVzcXVpc2FbL0JdWy9DT0xPUl0nLF9fQVBJX1NJVEVfXywxMjAsJ0xpc3RhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncGVzcXVpc2EucG5nJyksJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX19fQURET05fXy5wbmcnKSkKCWVsaWYgZmlsbWVzX2FwcCA9PSAxIG9yIGZpbG1lc19hcHAgPT0gJzEnOgoJCWFkZERpcignRmlsbWVzIGRhIExpc3RhJyxmaWxtaWxpbmssNCwnTWluaWF0dXJhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZmlsbWVzLnBuZycpLCcnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19fX0FERE9OX18ucG5nJykpCQkKCWVsaWYgZmlsbWVzX2FwcCA9PSAyIG9yIGZpbG1lc19hcHAgPT0gJzInOgoJCWFkZERpcignRmlsbWVzIGRhIExpc3RhJyxmaWxtaWxpbmssNCwnTWluaWF0dXJhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZmlsbWVzLnBuZycpLCcnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19fX0FERE9OX18ucG5nJykpCgkJYWRkRGlyKCdGaWxtZXMgZG8gQWRkb24nLHVybCw3MSwnTWluaWF0dXJhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZmlsbWVzLnBuZycpLCcnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19fX0FERE9OX18ucG5nJykpCgkJYWRkRGlyKCdTw6lyaWVzIGRvIEFkZG9uJyx1cmwsNjAsJ01pbmlhdHVyYScsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Nlcmllcy5wbmcnKSwnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fX19BRERPTl9fLnBuZycpKQoJCWFkZERpcignW0NPTE9SIHBpbmtdW0JdUGVzcXVpc2FbL0JdWy9DT0xPUl0nLHVybCwxNjAsJ0xpc3RhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncGVzcXVpc2EucG5nJyksJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX19fQURET05fXy5wbmcnKSkKCWVsaWYgZmlsbWVzX2FwcCA9PSA0IG9yIGZpbG1lc19hcHAgPT0gJzQnOgoJCWFkZERpcignRmlsbWVzIGRhIExpc3RhJyxmaWxtaWxpbmssNCwnTWluaWF0dXJhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZmlsbWVzLnBuZycpLCcnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19fX0FERE9OX18ucG5nJykpCgkJYWRkRGlyKCdGaWxtZXMgZG8gQWRkb24nLHVybCwyMTExMSwnTWluaWF0dXJhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZmlsbWVzLnBuZycpLCcnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19fX0FERE9OX18ucG5nJykpCgkJYWRkRGlyKCdTw6lyaWVzIGRvIEFkZG9uJyx1cmwsMjExMTIsJ01pbmlhdHVyYScsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Nlcmllcy5wbmcnKSwnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fX19BRERPTl9fLnBuZycpKQoJZWxzZToKCQlhZGREaXIoJ0ZpbG1lcyBkYSBMaXN0YScsZmlsbWlsaW5rLDQsJ01pbmlhdHVyYScsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ZpbG1lcy5wbmcnKSwnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fX19BRERPTl9fLnBuZycpKQkJCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCQkJCQkJCSAgQWJyaXIgSW5mbyBDb250YQkJCQkJCQkJCSAgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZGVmIEFicmlyX0NvbnRhKHVybCk6CglhbmRtZWxpbmsgPSB1cmwrJ3BhbmVsX2FwaS5waHA/dXNlcm5hbWU9JytfX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fbmFtZSIpKycmcGFzc3dvcmQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fcGFzc3dvcmQiKQoJZXhlY3V0ZV9haW5mbyhhbmRtZWxpbmspCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwkJCQkJCQkJCQkJCQlBYnJpciBJbmZvIFRWUwkJCQkJCQkJCQkJICMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpkZWYgYWJyaW0zdSh1cmwpOgoJdmVyc2lvbiA9IF9fQURET05WRVJTSU9OX18KCWthc3V0YWphbmltaT1fX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fbmFtZSIpCglzYWxhc29uYT1fX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fcGFzc3dvcmQiKQoJbGVoZWt5bGc9dXJsCgl2YW5lbWFrb29kPV9fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9hZHVsdG9zIikKCXZhbmVtYWx1a2s9X19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX2FkdWx0b3Nfc2ltIikKCQoJdGVsZXZpc2lvb25pbGluayA9IHVybCsnL2VuaWdtYTIucGhwP3VzZXJuYW1lPScrX19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX25hbWUiKSsnJnBhc3N3b3JkPScrX19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX3Bhc3N3b3JkIikrJyZ0eXBlPWdldF9saXZlX2NhdGVnb3JpZXMnCglzZWN1cml0eV9jaGVjayh0ZWxldmlzaW9vbmlsaW5rKQoKZGVmIHNlY3VyaXR5X2NoZWNrKHVybCk6Cgl1ID0gdXJsbGliMi5SZXF1ZXN0KHVybCwnJykKCXUuYWRkX2hlYWRlcignQWNjZXB0JywgJ2FwcGxpY2F0aW9uL3htbCcpCgl1LmFkZF9oZWFkZXIoJ1VzZXItYWdlbnQnLCAnTW96aWxsYS81LjAgKFdpbmRvd3M7IFU7IFdpbmRvd3MgTlQgNS4xOyBlbi1HQjsgcnY6MS45LjAuMykgR2Vja28vMjAwODA5MjQxNyBGaXJlZm94LzMuMC4zJykKCXJlc3BvbnNlID0gdXJsbGliMi51cmxvcGVuKHUpCgl0cmVlID0gRVQucGFyc2UocmVzcG9uc2UpCglyb290RWxlbSA9IHRyZWUuZ2V0cm9vdCgpCglmb3IgY2hhbm5lbCBpbiB0cmVlLmZpbmRhbGwoImNoYW5uZWwiKToKCQlrYW5hbGluaW1pID0gY2hhbm5lbC5maW5kKCJ0aXRsZSIpLnRleHQKCQlrYW5hbGluaW1pID0gYmFzZTY0LmI2NGRlY29kZShrYW5hbGluaW1pKQoJCWthdGVnb29yaWFsaW5rID0gY2hhbm5lbC5maW5kKCJwbGF5bGlzdF91cmwiKS50ZXh0CgkJCgkJYWRkRGlyKGthbmFsaW5pbWksa2F0ZWdvb3JpYWxpbmssOCwnTWluaWF0dXJhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX3R2LnBuZycpLCcnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb190di5wbmcnKSkKCQoJdmlzdGFfR3J1cG9zKCkKCmRlZiBkZXRlY3RfbW9kaWZpY2F0aW9uKHVybCk6CglmaWxtaWxpbmsgPSB1cmwrJy9lbmlnbWEyLnBocD91c2VybmFtZT0nK19fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9uYW1lIikrJyZwYXNzd29yZD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9wYXNzd29yZCIpKycmdHlwZT1nZXRfdm9kX2NhdGVnb3JpZXMnCgl1ID0gdXJsbGliMi5SZXF1ZXN0KGZpbG1pbGluaywnJykKCXUuYWRkX2hlYWRlcignQWNjZXB0JywgJ2FwcGxpY2F0aW9uL3htbCcpCgl1LmFkZF9oZWFkZXIoJ1VzZXItYWdlbnQnLCAnTW96aWxsYS81LjAgKFdpbmRvd3M7IFU7IFdpbmRvd3MgTlQgNS4xOyBlbi1HQjsgcnY6MS45LjAuMykgR2Vja28vMjAwODA5MjQxNyBGaXJlZm94LzMuMC4zJykKCXJlc3BvbnNlID0gdXJsbGliMi51cmxvcGVuKHUpCgl0cmVlID0gRVQucGFyc2UocmVzcG9uc2UpCglyb290RWxlbSA9IHRyZWUuZ2V0cm9vdCgpCglmb3IgY2hhbm5lbCBpbiB0cmVlLmZpbmRhbGwoImNoYW5uZWwiKToKCQlmaWxtaW5pbWkgPSBjaGFubmVsLmZpbmQoInRpdGxlIikudGV4dAoJCWZpbG1pbmltaSA9IGJhc2U2NC5iNjRkZWNvZGUoZmlsbWluaW1pKQoJCWthdGVnb29yaWFsaW5rID0gY2hhbm5lbC5maW5kKCJwbGF5bGlzdF91cmwiKS50ZXh0CgkJCgkJYWRkRGlyKGZpbG1pbmltaSxrYXRlZ29vcmlhbGluayw5LCdNaW5pYXR1cmEnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fdmlkLnBuZycpLCcnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb192aWQucG5nJykpCgkKCXZpc3RhX0dydXBvcygpCgpkZWYgc3RyZWFtX3ZpZGVvKG5hbWUsdXJsLGltYWdlKToKCXZhbmVtYWx1a2s9X19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX2FkdWx0b3Nfc2ltIikKCWlmIHZhbmVtYWx1a2sgPT0gInRydWUiOgoJCXZhbmVtYV9sdWtrKG5hbWUpCgl1ID0gdXJsbGliMi5SZXF1ZXN0KHVybCwnJykKCXUuYWRkX2hlYWRlcignQWNjZXB0JywgJ2FwcGxpY2F0aW9uL3htbCcpCgl1LmFkZF9oZWFkZXIoJ1VzZXItYWdlbnQnLCAnTW96aWxsYS81LjAgKFdpbmRvd3M7IFU7IFdpbmRvd3MgTlQgNS4xOyBlbi1HQjsgcnY6MS45LjAuMykgR2Vja28vMjAwODA5MjQxNyBGaXJlZm94LzMuMC4zJykKCXJlc3BvbnNlID0gdXJsbGliMi51cmxvcGVuKHUpCgl0cmVlID0gRVQucGFyc2UocmVzcG9uc2UpCglyb290RWxlbSA9IHRyZWUuZ2V0cm9vdCgpCglmb3IgY2hhbm5lbCBpbiB0cmVlLmZpbmRhbGwoc3luY19kYXRhKCJZMmhoYm01bGJBPT0iKSk6CgkJa2FuYWxpbmltaSA9IGNoYW5uZWwuZmluZChnZXRfbGl2ZSgiZEdsMGJHVT0iKSkudGV4dAoJCWthbmFsaW5pbWkgPSBiYXNlNjQuYjY0ZGVjb2RlKGthbmFsaW5pbWkpCgkJa2FuYWxpbmltaSA9IGthbmFsaW5pbWkucGFydGl0aW9uKCJbIikKCQlzdHJpaW1pbGluayA9IGNoYW5uZWwuZmluZChnZXRfbGl2ZSgiYzNSeVpXRnRYM1Z5YkE9PSIpKS50ZXh0CgkJCgkJdXJsY2hhbWEgPSBzdHJpaW1pbGluay5zcGxpdCgnLycpCgkJdXJsbm9vID0gJycKCQl0cnk6CgkJCXVybG5vbyA9IHVybGNoYW1hWzVdCgkJCXVybG5vbyA9IHVybG5vby5yZXBsYWNlKCd0cycsJycpCgkJCXVybG5vbyA9IHVybG5vby5yZXBsYWNlKCdtM3U4JywnJykKCQlleGNlcHQ6CgkJCXBhc3MKCQkKCQlwaWx0ID0gY2hhbm5lbC5maW5kKCJkZXNjX2ltYWdlIikudGV4dAoJCWthdmEgPSBrYW5hbGluaW1pWzFdK2thbmFsaW5pbWlbMl0KCQlrYXZhID0ga2F2YS5wYXJ0aXRpb24oIl0iKQoJCWthdmEgPSBrYXZhWzJdCgkJa2F2YSA9IGthdmEucGFydGl0aW9uKCIJIikKCQlrYXZhID0ga2F2YVsyXQoJCXNob3UgPSBnZXRfbGl2ZSgiVzBOUFRFOVNJSGRvYVhSbFhTVnpJRnN2UTA5TVQxSmQiKSUoa2FuYWxpbmltaVswXSkra2F2YQoJCWtpcmplbGR1cyA9IGNoYW5uZWwuZmluZCgiZGVzY3JpcHRpb24iKS50ZXh0CgkJaWYga2lyamVsZHVzOgoJCQlraXJqZWxkdXMgPSBiYXNlNjQuYjY0ZGVjb2RlKGtpcmplbGR1cykKCQkJbnl5ZCA9IGtpcmplbGR1cy5wYXJ0aXRpb24oIigiKQoJCQlueXlkID0gIkFnb3JhOiAiK255eWRbMF0KCQkJamFyZ21pbmUgPSBraXJqZWxkdXMucGFydGl0aW9uKCIpXG4iKQoJCQlqYXJnbWluZSA9IGphcmdtaW5lWzJdLnBhcnRpdGlvbigiKCIpCgkJCWphcmdtaW5lID0gIkEgc2VndWlyOiAiK2phcmdtaW5lWzBdCgkJCWtva2t1ID0gbnl5ZCtqYXJnbWluZQoJCWVsc2U6CgkJCWtva2t1ID0gIiIKCQlpZiBwaWx0OgoJCQlhZGRMaW5rQ2FuYWxMaXN0YShzaG91LHN0cmlpbWlsaW5rLHBpbHQsa29ra3Usb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3R2LnBuZycpLCB1cmxub28pCgkJZWxzZToKCQkJYWRkTGlua0NhbmFsTGlzdGEoc2hvdSxzdHJpaW1pbGluayxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX3R2LnBuZycpLGtva2t1LG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb190di5wbmcnKSwgdXJsbm9vKQoJCgl4Ym1jcGx1Z2luLnNldENvbnRlbnQoaW50KHN5cy5hcmd2WzFdKSAsImVwaXNvZGVzIikKCXZpc3RhX0NhbmFpcygpCgpkZWYgZ2V0X215YWNjb3VudChuYW1lLHVybCxpbWFnZSk6Cgl2YW5lbWFsdWtrPV9fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9hZHVsdG9zX3NpbSIpCglpZiB2YW5lbWFsdWtrID09ICJ0cnVlIjoKCQl2YW5lbWFfbHVrayhuYW1lKQoJdSA9IHVybGxpYjIuUmVxdWVzdCh1cmwsJycpCgl1LmFkZF9oZWFkZXIoJ0FjY2VwdCcsICdhcHBsaWNhdGlvbi94bWwnKQoJdS5hZGRfaGVhZGVyKCdVc2VyLWFnZW50JywgJ01vemlsbGEvNS4wIChXaW5kb3dzOyBVOyBXaW5kb3dzIE5UIDUuMTsgZW4tR0I7IHJ2OjEuOS4wLjMpIEdlY2tvLzIwMDgwOTI0MTcgRmlyZWZveC8zLjAuMycpCglyZXNwb25zZSA9IHVybGxpYjIudXJsb3Blbih1KQoJdHJlZSA9IEVULnBhcnNlKHJlc3BvbnNlKQoJcm9vdEVsZW0gPSB0cmVlLmdldHJvb3QoKQoJZm9yIGNoYW5uZWwgaW4gdHJlZS5maW5kYWxsKCJjaGFubmVsIik6CgkJcGVhbGtpcmkgPSBjaGFubmVsLmZpbmQoInRpdGxlIikudGV4dAoJCXBlYWxraXJpID0gYmFzZTY0LmI2NGRlY29kZShwZWFsa2lyaSkKCQlwZWFsa2lyaSA9IHBlYWxraXJpLmVuY29kZSgidXRmLTgiKQoJCXN0cmlpbWlsaW5rID0gY2hhbm5lbC5maW5kKCJzdHJlYW1fdXJsIikudGV4dAoJCQoJCXVybGNoYW1hID0gc3RyaWltaWxpbmsuc3BsaXQoJy8nKQoJCXVybG5vbyA9ICcnCgkJdHJ5OgoJCQl1cmxub28gPSB1cmxjaGFtYVs1XQoJCQl1cmxub28gPSB1cmxub28ucmVwbGFjZSgndHMnLCcnKQoJCQl1cmxub28gPSB1cmxub28ucmVwbGFjZSgnbTN1OCcsJycpCgkJZXhjZXB0OgoJCQlwYXNzCgkJCgkJcGlsdCA9IGNoYW5uZWwuZmluZCgiZGVzY19pbWFnZSIpLnRleHQgCgkJZGVzY3JpcHQgPSBjaGFubmVsLmZpbmQoImRlc2NyaXB0aW9uIikudGV4dAoJCWlmIGRlc2NyaXB0OgoJCQlkZXNjcmlwdCA9IGJhc2U2NC5iNjRkZWNvZGUoZGVzY3JpcHQpCgkJaWYgcGlsdDoKCQkJYWRkTGlua0NhbmFsTGlzdGEocGVhbGtpcmksc3RyaWltaWxpbmsscGlsdCxkZXNjcmlwdCxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fdmlkLnBuZycpLCB1cmxub28pCgkJZWxzZToKCQkJYWRkTGlua0NhbmFsTGlzdGEocGVhbGtpcmksc3RyaWltaWxpbmssb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb190di5wbmcnKSxkZXNjcmlwdCxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fdmlkLnBuZycpLCB1cmxub28pCgkKCXhibWNwbHVnaW4uc2V0Q29udGVudChpbnQoc3lzLmFyZ3ZbMV0pICwibW92aWVzIikKCXZpc3RhX0NhbmFpcygpCgpkZWYgYWRkTGlua0NhbmFsTGlzdGEodGl0bGUsIHVybCwgdGh1bWJuYWlsLCBwbG90LCBmYW5hcnQsIGlkY2FuYWwsIGlzUGxheWFibGU9VHJ1ZSwgZm9sZGVyPUZhbHNlKToKCW9rPVRydWUKCWNtPVtdCglpZihpZGNhbmFsICE9ICcwMDAxJyk6CgkJY20uYXBwZW5kKCgnVmVyIHByb2dyYW1hw6fDo28nLCAnWEJNQy5SdW5QbHVnaW4oJXM/bW9kZT0zMSZuYW1lPSVzJnVybD0lcyZpY29uaW1hZ2U9JXMmaWRDYW5hbD0lcyZpZGZmQ2FuYWw9JXMpJyUoc3lzLmFyZ3ZbMF0sdXJsbGliLnF1b3RlX3BsdXModGl0bGUpLCB1cmxsaWIucXVvdGVfcGx1cyh1cmwpLCB1cmxsaWIucXVvdGVfcGx1cyh0aHVtYm5haWwpLCBpZGNhbmFsLCAnJykpKQoJCglsaXN0aXRlbT14Ym1jZ3VpLkxpc3RJdGVtKHRpdGxlLGljb25JbWFnZT10aHVtYm5haWwsdGh1bWJuYWlsSW1hZ2U9dGh1bWJuYWlsKQoJbGlzdGl0ZW0uYWRkQ29udGV4dE1lbnVJdGVtcyhjbSwgcmVwbGFjZUl0ZW1zPUZhbHNlKQoJaW5mb19sYWJlbHM9eyJUaXRsZSI6dGl0bGUsIkZpbGVOYW1lIjp0aXRsZSwiUGxvdCI6cGxvdH0KCWxpc3RpdGVtLnNldEluZm8oICJ2aWRlbyIsIGluZm9fbGFiZWxzICkKCWxpc3RpdGVtLnNldFByb3BlcnR5KCdmYW5hcnRfaW1hZ2UnLCBmYW5hcnQpCglsaXN0aXRlbS5zZXRBcnQoeydmYW5hcnQnOiBmYW5hcnR9KQoJbGlzdGl0ZW0uc2V0UHJvcGVydHkoIlZpZGVvIiwidHJ1ZSIpCgl1ID0gc3lzLmFyZ3ZbMF0gKyAiP3VybD0iICsgc3RyKHVybCkgKyAiJm1vZGU9MTAmbmFtZT0iICsgc3RyKG5hbWUpICsgIiZpY29uaW1hZ2U9IitzdHIoaWNvbmltYWdlKSsiJmZhbmFydD0iK3N0cihmYW5hcnQpKyImcGxvdD0iK3N0cihwbG90KQoJb2s9eGJtY3BsdWdpbi5hZGREaXJlY3RvcnlJdGVtKGhhbmRsZT1pbnQoc3lzLmFyZ3ZbMV0pLHVybD11LGxpc3RpdGVtPWxpc3RpdGVtLGlzRm9sZGVyPWZvbGRlcikKCXJldHVybiBvawoKZGVmIHJ1bl9jcm9uam9iKHRpdGxlLHVybCxpbWFnZSxwbG90LGZhbmFydCk6Cgl2YW5lbWFsdWtrPV9fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9hZHVsdG9zX3NpbSIpCglpZiB2YW5lbWFsdWtrID09ICJ0cnVlIjoKCQl2YW5lbWFfbHVrayhuYW1lKQoJCglpZiBwbG90ID09ICdwcm9ncmFtYXMnOgoJCXVybG4gPSAiIgoJCXRyeTogdXJsbiA9IGJhc2U2NC5iNjRkZWNvZGUodXJsKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQl1cmxjaGFtYSA9IHVybG4uc3BsaXQoJzs7OycpCgkJdXJsbm9vID0gX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvc2VhcmNodXJsLnBocD9jYW5hbD0nK3VybGNoYW1hWzBdKycmdXJsPScrdXJsY2hhbWFbMV0rJyZjbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmYWRkb249MScKCQkKCQltZW5zYWdlbXByb2dyZXNzbyA9IHhibWNndWkuRGlhbG9nUHJvZ3Jlc3MoKQoJCW1lbnNhZ2VtcHJvZ3Jlc3NvLmNyZWF0ZShBZGRvblRpdGxlLCB1J0FicmlyIGVtaXNzw6NvJywnUG9yIGZhdm9yIGFndWFyZGUuLi4nKQoJCW1lbnNhZ2VtcHJvZ3Jlc3NvLnVwZGF0ZSgyNSwgIiIsIHUnT2J0ZXIgdmlkZW8nLCAiIikKCQlyZXN1bHRhZG8xID0gZGV2b2x2ZXJlc3VsdGFkbyh1cmxub28pCgkJbWVuc2FnZW1wcm9ncmVzc28udXBkYXRlKDUwLCAiIiwgdSdQcmVwYXJhLXRlLCB2YWkgY29tZcOnYXIhJywgIiIpCgkJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8xKQoJCW1lbnNhZ2VtcHJvZ3Jlc3NvLnVwZGF0ZSg3NSwgIiIsIHUnQm9hIFNlc3PDo28hISEnLCAiIikKCQl1cmxuID0gIiIKCQlmb3IgaSBpbiByZXN1bHRhZG9bJ2luZm9ybWFjYW8nXToKCQkJdHJ5OiB1cmxuID0gYmFzZTY0LmI2NGRlY29kZShpWyd1cmwnXSkuZGVjb2RlKCd1dGYtOCcpCgkJCWV4Y2VwdDogcGFzcwoJCQkKCQltZW5zYWdlbXByb2dyZXNzby5jbG9zZSgpCgkJeGJtYy5zbGVlcCg1MDAwKQoJCXBsYXlsaXN0ID0geGJtYy5QbGF5TGlzdCh4Ym1jLlBMQVlMSVNUX1ZJREVPKQoJCXBsYXlsaXN0LmNsZWFyKCkKCQlpbmZvX2xhYmVscz17IlRpdGxlIjp0aXRsZSwiRmlsZU5hbWUiOnRpdGxlLCJQbG90IjpwbG90fQoJCWxpc3RpdGVtPXhibWNndWkuTGlzdEl0ZW0odGl0bGUsaWNvbkltYWdlPWltYWdlLHRodW1ibmFpbEltYWdlPWltYWdlKQoJCWxpc3RpdGVtLnNldEluZm8oICJ2aWRlbyIsIGluZm9fbGFiZWxzICkKCQlwbGF5bGlzdC5hZGQodXJsPXVybG4sIGxpc3RpdGVtPWxpc3RpdGVtLCBpbmRleD0xKQoJCXhibWMuUGxheWVyKCkucGxheShwbGF5bGlzdCkKCWVsc2U6CgkJcGxheWxpc3QgPSB4Ym1jLlBsYXlMaXN0KHhibWMuUExBWUxJU1RfVklERU8pCgkJcGxheWxpc3QuY2xlYXIoKQoJCWluZm9fbGFiZWxzPXsiVGl0bGUiOnRpdGxlLCJGaWxlTmFtZSI6dGl0bGUsIlBsb3QiOnBsb3R9CgkJbGlzdGl0ZW09eGJtY2d1aS5MaXN0SXRlbSh0aXRsZSxpY29uSW1hZ2U9aW1hZ2UsdGh1bWJuYWlsSW1hZ2U9aW1hZ2UpCgkJbGlzdGl0ZW0uc2V0SW5mbyggInZpZGVvIiwgaW5mb19sYWJlbHMgKQoJCXBsYXlsaXN0LmFkZCh1cmw9dXJsLCBsaXN0aXRlbT1saXN0aXRlbSwgaW5kZXg9MSkKCQl4Ym1jLlBsYXllcigpLnBsYXkocGxheWxpc3QpCgkKCmRlZiBzeW5jX2RhdGEoY2hhbm5lbCk6Cgl2aWRlbyA9IGJhc2U2NC5iNjRkZWNvZGUoY2hhbm5lbCkKCXJldHVybiB2aWRlbwoKZGVmIHJlc3RhcnRfc2VydmljZShwYXJhbXMpOgoJdmFuZW1hbHVraz1fX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fYWR1bHRvc19zaW0iKQoJaWYgdmFuZW1hbHVrayA9PSAidHJ1ZSI6CgkJcGVhbGtpcmkgPSBwYXJhbXMuZ2V0KHN5bmNfZGF0YSgiZEdsMGJHVT0iKSkKCQl2YW5lbWFfbHVrayhwZWFsa2lyaSkKCWxvcHBsaW5rID0gcGFyYW1zLmdldCh2b2RfY2hhbm5lbHMoImRYSnMiKSkKCQoJeGJtY3BsdWdpbi5zZXRSZXNvbHZlZFVybChpbnQoc3lzLmFyZ3ZbMV0pLCBUcnVlLCBsaXN0aXRlbSkKCmRlZiBncmFiX2VwZyh1cmwpOgoJcmVxID0gdXJsbGliMi5SZXF1ZXN0KHVybCkKCXJlcS5hZGRfaGVhZGVyKHN5bmNfZGF0YSgiVlhObGNpMUJaMlZ1ZEE9PSIpICwgdm9kX2NoYW5uZWxzKCJTMjlrYVNCd2JIVm5hVzRnWW5rZ1RHbDJaU0YwIikpCglyZXNwb25zZSA9IHVybGxpYjIudXJsb3BlbihyZXEpCglsaW5rPXJlc3BvbnNlLnJlYWQoKQoJamRhdGEgPSBqc29uLmxvYWRzKGxpbmsuZGVjb2RlKCd1dGY4JykpCglyZXNwb25zZS5jbG9zZSgpCglpZiBqZGF0YToKCQlyZXR1cm4gamRhdGEKCmRlZiBncmFiX2VwZzIodXJsKToKCXJlcSA9IHVybGxpYjIuUmVxdWVzdCh1cmwpCglyZXEuYWRkX2hlYWRlcignVXNlci1hZ2VudCcsICdNb3ppbGxhLzUuMCAoV2luZG93czsgVTsgV2luZG93cyBOVCA1LjE7IGVuLUdCOyBydjoxLjkuMC4zKSBHZWNrby8yMDA4MDkyNDE3IEZpcmVmb3gvMy4wLjMnKQoJcmVxLmFkZF9oZWFkZXIoc3luY19kYXRhKCJWWE5sY2kxQloyVnVkQT09IikgLCB2b2RfY2hhbm5lbHMoIlMyOWthU0J3YkhWbmFXNGdZbmtnVEdsMlpTRjAiKSkKCXJlc3BvbnNlID0gdXJsbGliMi51cmxvcGVuKHJlcSkKCWxpbms9cmVzcG9uc2UucmVhZCgpCglpZiBsaW5rICE9ICd7InVzZXJfaW5mbyI6eyJhdXRoIjowfX0nOgoJCWpkYXRhID0ganNvbi5sb2FkcyhsaW5rLmRlY29kZSgndXRmOCcpKQoJCXJlc3BvbnNlLmNsb3NlKCkKCQlpZiBqZGF0YToKCQkJcmV0dXJuIGpkYXRhCgllbHNlOgoJCXJldHVybiBOb25lCgkKZGVmIGtvbnRyb2xsKHVybCk6CglyYW5kb21zdHJpbmcgPSBncmFiX2VwZyh1cmwpCglrYXN1dGFqYWluZm8gPSByYW5kb21zdHJpbmdbc3luY19kYXRhKCJkWE5sY2w5cGJtWnYiKV0KCWtvbnRyb2xsID0ga2FzdXRhamFpbmZvW2dldF9saXZlKCJZWFYwYUE9PSIpXQoJcmV0dXJuIGtvbnRyb2xsCmRlZiBnZXRfbGl2ZShjaGFubmVsKToKCXZpZGVvID0gYmFzZTY0LmI2NGRlY29kZShjaGFubmVsKQoJcmV0dXJuIHZpZGVvCmRlZiBleGVjdXRlX2FpbmZvKHVybCk6CglhbmRtZWQgPSBncmFiX2VwZyh1cmwpCglrYXN1dGFqYUFuZG1lZCA9IGFuZG1lZFtzeW5jX2RhdGEoImRYTmxjbDlwYm1adiIpXQoJc2VpcyA9IGthc3V0YWphQW5kbWVkW2dldF9saXZlKCJjM1JoZEhWeiIpXQoJYWVndWIgPSBrYXN1dGFqYUFuZG1lZFtzeW5jX2RhdGEoIlpYaHdYMlJoZEdVPSIpXQoJaWYgYWVndWI6CgkJYWVndWIgPSBkYXRldGltZS5kYXRldGltZS5mcm9tdGltZXN0YW1wKGludChhZWd1YikpLnN0cmZ0aW1lKCclSDolTSAlZC4lbS4lWScpCgllbHNlOgoJCWFlZ3ViID0gdm9kX2NoYW5uZWxzKCJUbVYyWlhJPSIpIAoJcmFiYml0cyA9IGthc3V0YWphQW5kbWVkW3ZvZF9jaGFubmVscygiYVhOZmRISnBZV3c9IildCglpZiByYWJiaXRzID09ICIwIjoKCQlyYWJiaXRzID0gc3luY19kYXRhKCJUbTg9IikKCWVsc2U6CgkJcmFiYml0cyA9IHN5bmNfZGF0YSgiV1dWeiIpCglsZWF2ZW1lYWxvbmUgPSBrYXN1dGFqYUFuZG1lZFtnZXRfbGl2ZSgiYldGNFgyTnZibTVsWTNScGIyNXoiKV0KCXBvbGFyYmVhcnMgPSBrYXN1dGFqYUFuZG1lZFtzeW5jX2RhdGEoImRYTmxjbTVoYldVPSIpXQoJCglhZGRMaW5rQ2FuYWxMaXN0YSgiW0NPTE9SID0gd2hpdGVdVXRpbGl6YWRvcjogWy9DT0xPUl0iK3BvbGFyYmVhcnMsIiIsIiIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb19jb24ucG5nJyksb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2Nvbi5wbmcnKSwnJykKCQoJYWRkTGlua0NhbmFsTGlzdGEoIltDT0xPUiA9IHdoaXRlXUVzdGFkbzogWy9DT0xPUl0iK3NlaXMsIiIsIiIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb19jb24ucG5nJyksb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2Nvbi5wbmcnKSwnJykKCQoJYWRkTGlua0NhbmFsTGlzdGEoIltDT0xPUiA9IHdoaXRlXUV4cGlyYTogWy9DT0xPUl0iK2FlZ3ViLCIiLCIiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fY29uLnBuZycpLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19jb24ucG5nJyksJycpCgkKCWFkZExpbmtDYW5hbExpc3RhKCJbQ09MT1IgPSB3aGl0ZV1Db250YSBkZSBUZXN0ZTogWy9DT0xPUl0iK3JhYmJpdHMsIiIsIiIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb19jb24ucG5nJyksb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2Nvbi5wbmcnKSwnJykKCQoJYWRkTGlua0NhbmFsTGlzdGEoIltDT0xPUiA9IHdoaXRlXU1heGltbyBkZSBDb25uZWM6IFsvQ09MT1JdIitsZWF2ZW1lYWxvbmUsIiIsIiIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb19jb24ucG5nJyksb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2Nvbi5wbmcnKSwnJykKCQoJdmlzdGFfR3J1cG9zKCkKCmRlZiB2YW5lbWFfbHVrayhuYW1lKToKCWEgPSAnWFhYJywgJ0FkdWx0JywgJ0FkdWx0cycsJ0FEVUxUJywnQURVTFRTJywnYWR1bHQnLCdhZHVsdHMnLCdQb3JuJywnUE9STicsJ3Bvcm4nLCdQb3JuJywneHh4JwoJaWYgYW55KHMgaW4gbmFtZSBmb3IgcyBpbiBhKToKCQl4Ym1jLmV4ZWN1dGVidWlsdGluKCh1J1hCTUMuTm90aWZpY2F0aW9uKCJDb250cm9sbyBQYXJlbnRhbCIsICJPIGNhbmFsIGNvbnRlbSBjb250ZXVkbyBhZHVsdG8iLCAyMDAwKScpKQoJCXRleHQgPSBwbHVnaW50b29scy5rZXlib2FyZF9pbnB1dChkZWZhdWx0X3RleHQ9IiIsIHRpdGxlPSJDb2RpZ28gcGFyYSBjb250cm9sbyBwYXJlbnRhbCIpCgkJaWYgdGV4dD09cGx1Z2ludG9vbHMuZ2V0X3NldHRpbmcoc3luY19kYXRhKCJiRzluYVc1ZllXUjFiSFJ2Y3c9PSIpKToKCQkgIHJldHVybgoJCWVsc2U6CgkJICBleGl0KCkKCWVsc2U6CgkJbmFtZSA9ICIiCgpkZWYgRG93bmxvYWRlckNsYXNzKHVybCxkZXN0KToKCWRwID0geGJtY2d1aS5EaWFsb2dQcm9ncmVzcygpCglkcC5jcmVhdGUoc3luY19kYXRhKCJSMlYwZEdsdVp5QjFjR1JoZEdVPSIpLGdldF9saXZlKCJSRzkzYm14dllXUnBibWM9IikpCgl1cmxsaWIudXJscmV0cmlldmUodXJsLGRlc3QsbGFtYmRhIG5iLCBicywgZnMsIHVybD11cmw6IF9wYmhvb2sobmIsYnMsZnMsdXJsLGRwKSkKCmRlZiBfcGJob29rKG51bWJsb2NrcywgYmxvY2tzaXplLCBmaWxlc2l6ZSwgdXJsPU5vbmUsZHA9Tm9uZSk6Cgl0cnk6CgkJcGVyY2VudCA9IG1pbigobnVtYmxvY2tzKmJsb2Nrc2l6ZSoxMDApL2ZpbGVzaXplLCAxMDApCgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnJytwZXJjZW50KQoJCWRwLnVwZGF0ZShwZXJjZW50KQoJZXhjZXB0OgoJCXBlcmNlbnQgPSAxMDAKCQlkcC51cGRhdGUocGVyY2VudCkKCWlmIGRwLmlzY2FuY2VsZWQoKToKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdPIGRvd25sb2FkIGZvaSBjYW5jZWxhZG8uJykKCQlkcC5jbG9zZSgpCgpkZWYgdm9kX2NoYW5uZWxzKGNoYW5uZWwpOgoJdmlkZW8gPSBiYXNlNjQuYjY0ZGVjb2RlKGNoYW5uZWwpCglyZXR1cm4gdmlkZW8KCmRlZiBQbGF5VXJsKG5hbWUsIHVybCwgaWNvbmltYWdlPU5vbmUpOgoJbGlzdGl0ZW0gPSB4Ym1jZ3VpLkxpc3RJdGVtKHBhdGg9dXJsLCB0aHVtYm5haWxJbWFnZT1pY29uaW1hZ2UpCglsaXN0aXRlbS5zZXRJbmZvKHR5cGU9IlZpZGVvIiwgaW5mb0xhYmVscz17ICJUaXRsZSI6IG5hbWUgfSkKCXhibWNwbHVnaW4uc2V0UmVzb2x2ZWRVcmwoaW50KHN5cy5hcmd2WzFdKSwgVHJ1ZSwgbGlzdGl0ZW0pCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwkJCQkJCQkJCQkJCQlNZW51IFRWIEFycXVpdm8JCQkJCQkJCQkJCSAjCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZGVmIGxpc3RhdHZhcmNoaXZlKHVybCk6CgllbmRlcmVjbyA9IHVybCsicGFuZWxfYXBpLnBocD91c2VybmFtZT0iK19fQURET05fXy5nZXRTZXR0aW5nKCdsb2dpbl9uYW1lJykrIiZwYXNzd29yZD0iK19fQURET05fXy5nZXRTZXR0aW5nKCdsb2dpbl9wYXNzd29yZCcpKyImYWN0aW9uPWdldF9saXZlX3N0cmVhbXMiCgkjaUlpSUlJaSA9IHVybGxpYjIudXJsb3BlbihlbmRlcmVjbykKCSNvb28wME9PT29vTwk9IGpzb24ubG9hZChpSWlJSUlpKQoJcmVxID0gdXJsbGliMi5SZXF1ZXN0KGVuZGVyZWNvKQoJcmVxLmFkZF9oZWFkZXIoc3luY19kYXRhKCJWWE5sY2kxQloyVnVkQT09IikgLCB2b2RfY2hhbm5lbHMoIlMyOWthU0J3YkhWbmFXNGdZbmtnVEdsMlpTRjAiKSkKCXJlc3BvbnNlID0gdXJsbGliMi51cmxvcGVuKHJlcSkKCWxpbms9cmVzcG9uc2UucmVhZCgpCglvb28wME9PT29vTwk9IGpzb24ubG9hZHMobGluay5kZWNvZGUoJ3V0ZjgnKSkKCXJlc3BvbnNlLmNsb3NlKCkKCU8wME9PT29Pb28wTyA9IG9vbzAwT09Pb29PWydhdmFpbGFibGVfY2hhbm5lbHMnXQoJZm9yCU8wMDBPT28wMG9vCWluCU8wME9PT29Pb28wTy52YWx1ZXMoKToKCQlvbzBPT28gPSBPMDAwT09vMDBvb1sndHZfYXJjaGl2ZSddCgkJaWYob28wT09vID09IDEpOgoJCQluYW1ldHY9TzAwME9PbzAwb29bJ25hbWUnXQoJCQlzdHJlYW1faWQ9TzAwME9PbzAwb29bJ3N0cmVhbV9pZCddCgkJCWxvZ29fdHY9TzAwME9PbzAwb29bJ3N0cmVhbV9pY29uJ10KCQkJZHVyYXRpb24gPSBPMDAwT09vMDBvb1sndHZfYXJjaGl2ZV9kdXJhdGlvbiddCgkJCQoJCQlhZGRMaW5rR3J1cG8obmFtZXR2LGxvZ29fdHYsc3RyZWFtX2lkLHVybCxkdXJhdGlvbixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fdHZfYXJjLnBuZycpLDEpCgkKCXZpc3RhX0dydXBvcygpCgpkZWYgbGlzdGF0dmFyY2hpdmVjYW5haXMobmFtZSxzdHJlYW1faWQsdXJsLGR1cmF0aW9uLGljb25pbWFnZSxmYW5hcnQpOgoJZW5kZXJlY28gPSB1cmwrInBhbmVsX2FwaS5waHA/dXNlcm5hbWU9IitfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fbmFtZScpKyImcGFzc3dvcmQ9IitfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fcGFzc3dvcmQnKSsiJmFjdGlvbj1nZXRfZXBnJnN0cmVhbV9pZD0iK3N0cmVhbV9pZAoJI2lJaUlJSWkgPSB1cmxsaWIyLnVybG9wZW4oZW5kZXJlY28pCgkjaWlpSTExCT0ganNvbi5sb2FkKGlJaUlJSWkpCglyZXEgPSB1cmxsaWIyLlJlcXVlc3QoZW5kZXJlY28pCglyZXEuYWRkX2hlYWRlcihzeW5jX2RhdGEoIlZYTmxjaTFCWjJWdWRBPT0iKSAsIHZvZF9jaGFubmVscygiUzI5a2FTQndiSFZuYVc0Z1lua2dUR2wyWlNGMCIpKQoJcmVzcG9uc2UgPSB1cmxsaWIyLnVybG9wZW4ocmVxKQoJbGluaz1yZXNwb25zZS5yZWFkKCkKCWlpaUkxMQk9IGpzb24ubG9hZHMobGluay5kZWNvZGUoJ3V0ZjgnKSkKCXJlc3BvbnNlLmNsb3NlKCkKCQoJaWlJaUkgPSBkYXRldGltZS5kYXRldGltZS51dGNub3coKSAtIGRhdGV0aW1lLnRpbWVkZWx0YShkYXlzPWludChkdXJhdGlvbikpCglvMDBvb29PME9vCT1jYWxlbmRhci50aW1lZ20oaWlJaUkudGltZXR1cGxlKCkpCglvMDBvb29PME9vCT1pbnQobzAwb29vTzBPbykKCW8wTzBPT08wT29vCT10aW1lLnRpbWUoKQoJbzBPME9PTzBPb28JPWludChvME8wT09PME9vbykKCQoJZm9yCWlpSWlJSTEJaW4JaWlpSTExCToKCQl0aXRsZV90diA9IGlpSWlJSTFbJ3RpdGxlJ10KCQl0aXRsZV90dj1iYXNlNjQuYjY0ZGVjb2RlKHRpdGxlX3R2KQoJCXN0YXJ0CT0gaW50KGlpSWlJSTFbJ3N0YXJ0J10pCgkJZW5kCT0gaW50KGlpSWlJSTFbJ2VuZCddKQoJCXNlZ3VuZG8gPSAwLjAxNjY2NjY2NjcKCQkKCQlkdXJhY2FvID0gaW50KChlbmQtc3RhcnQpKnNlZ3VuZG8pCgkJCgkJaWYoc3RhcnQgPiBvMDBvb29PME9vIGFuZCBzdGFydCA8IG8wTzBPT08wT29vKToKCQkJaWYgOTAgLSA5MDoJT29vMAklCU9vMG9vTzBvbzBvTwkvCU9vMG9PMG9vbwoJCQlJSWkgPSBkYXRldGltZS5kYXRldGltZS5mcm9tdGltZXN0YW1wKGludChzdGFydCkpLnN0cmZ0aW1lKCclZC4lbSAlSDolTScpCgkJCWkxSWlpMWkxSSA9IGRhdGV0aW1lLmRhdGV0aW1lLmZyb210aW1lc3RhbXAoaW50KHN0YXJ0KSkuc3RyZnRpbWUoJyVZLSVtLSVkOiVIOiVNJykKCQkJdGl0bGVfdHYgPSBJSWkgKyAiICIgKyB0aXRsZV90dgoJCQllbmRlcmVjbyA9IHVybCsic3RyZWFtaW5nL3RpbWVzaGlmdC5waHA/dXNlcm5hbWU9IitfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fbmFtZScpKyImcGFzc3dvcmQ9IitfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fcGFzc3dvcmQnKSsiJnN0cmVhbT0iK3N0cmVhbV9pZCsiJnN0YXJ0PSIraTFJaWkxaTFJKyImZHVyYXRpb249IitzdHIoZHVyYWNhbykKCQkJCgkJCWFkZExpbmtDYW5hbCh0aXRsZV90dixlbmRlcmVjbyxpY29uaW1hZ2UsJzAwMDEnLCcnKQoJCgl2aXN0YV9DYW5haXMoKQoKZGVmIGFkZExpbmtHcnVwbyh0aXRsZSx0aHVtYm5haWwsc3RyZWFtX2lkLHVybCxkdXJhdGlvbixmYW5hcnQsdHlwZSk6Cglvaz1UcnVlCgkKCWxpc3RpdGVtPXhibWNndWkuTGlzdEl0ZW0odGl0bGUsaWNvbkltYWdlPXRodW1ibmFpbCx0aHVtYm5haWxJbWFnZT10aHVtYm5haWwpCglpbmZvX2xhYmVscz17IlRpdGxlIjp0aXRsZSwiRmlsZU5hbWUiOnRpdGxlfQoJbGlzdGl0ZW0uc2V0SW5mbyggInZpZGVvIiwgaW5mb19sYWJlbHMgKQoJbGlzdGl0ZW0uc2V0UHJvcGVydHkoJ2ZhbmFydF9pbWFnZScsZmFuYXJ0KQoJeGJtY3BsdWdpbi5zZXRQbHVnaW5GYW5hcnQoaW50KHN5cy5hcmd2WzFdKSxmYW5hcnQpCgkKCXUgPSBzeXMuYXJndlswXSArICI/dXJsPSIgKyBzdHIodXJsKSArICImbW9kZT03Jm5hbWU9IiArIHN0cih0aXRsZSkgKyAiJmljb25pbWFnZT0iK3N0cih0aHVtYm5haWwpKyImZmFuYXJ0PSIrc3RyKGZhbmFydCkrIiZzdHJlYW1faWQ9IitzdHIoc3RyZWFtX2lkKSsiJmR1cmF0aW9uPSIrZHVyYXRpb24KCQoJb2s9eGJtY3BsdWdpbi5hZGREaXJlY3RvcnlJdGVtKGhhbmRsZT1pbnQoc3lzLmFyZ3ZbMV0pLHVybD11LGxpc3RpdGVtPWxpc3RpdGVtLGlzRm9sZGVyPVRydWUpCgkKCXJldHVybiBvawoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMJCQkJCQkJCQkJCQkJQWJyaXIgU2V0dGluZwkJCQkJCQkJCQkgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCmRlZiBhYnJpckRlZmluaW5jb2VzKCk6CglfX0FERE9OX18ub3BlblNldHRpbmdzKCkKCXZpc3RhX21lbnUoKQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyMjCQlDbGVhciBDYWNoZQkJIyMjCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpkZWYgQ0xFQVJDQUNIRSgpOgoJeGJtY19jYWNoZV9wYXRoID0gb3MucGF0aC5qb2luKHhibWMudHJhbnNsYXRlUGF0aCgnc3BlY2lhbDovL2hvbWUnKSwgJ2NhY2hlJykKCWlmIG9zLnBhdGguZXhpc3RzKHhibWNfY2FjaGVfcGF0aCk9PVRydWU6CQoJCWZvciByb290LCBkaXJzLCBmaWxlcyBpbiBvcy53YWxrKHhibWNfY2FjaGVfcGF0aCk6CgkJCWZpbGVfY291bnQgPSAwCgkJCWZpbGVfY291bnQgKz0gbGVuKGZpbGVzKQoJCQlpZiBmaWxlX2NvdW50ID4gMDoKCQoJCQkJZGlhbG9nID0geGJtY2d1aS5EaWFsb2coKQoJCQkJaWYgZGlhbG9nLnllc25vKCJBcGFnYXIgQ2FjaGUgbm8gWEJNQy4iLCBzdHIoZmlsZV9jb3VudCkgKyAiIGZpY2hlaXJvcyBlbmNvbnRyYWRvcy4iLCAiUXVlciBhcGFnYXIgdG9kb3Mgb3MgZmljaGVpcm9zIGVtIGNhY2hlPyIpOgoJCQkJCgkJCQkJZm9yIGYgaW4gZmlsZXM6CgkJCQkJCXRyeToKCQkJCQkJCW9zLnVubGluayhvcy5wYXRoLmpvaW4ocm9vdCwgZikpCgkJCQkJCWV4Y2VwdDoKCQkJCQkJCXBhc3MKCQkJCQlmb3IgZCBpbiBkaXJzOgoJCQkJCQl0cnk6CgkJCQkJCQlzaHV0aWwucm10cmVlKG9zLnBhdGguam9pbihyb290LCBkKSkKCQkJCQkJZXhjZXB0OgoJCQkJCQkJcGFzcwoJCQkJCQkKCQkJZWxzZToKCQkJCXBhc3MKCWlmIHhibWMuZ2V0Q29uZFZpc2liaWxpdHkoJ3N5c3RlbS5wbGF0Zm9ybS5BVFYyJyk6CgkJYXR2Ml9jYWNoZV9hID0gb3MucGF0aC5qb2luKCcvcHJpdmF0ZS92YXIvbW9iaWxlL0xpYnJhcnkvQ2FjaGVzL0FwcGxlVFYvVmlkZW8vJywgJ090aGVyJykKCQkKCQlmb3Igcm9vdCwgZGlycywgZmlsZXMgaW4gb3Mud2FsayhhdHYyX2NhY2hlX2EpOgoJCQlmaWxlX2NvdW50ID0gMAoJCQlmaWxlX2NvdW50ICs9IGxlbihmaWxlcykKCQkKCQkJaWYgZmlsZV9jb3VudCA+IDA6CgoJCQkJZGlhbG9nID0geGJtY2d1aS5EaWFsb2coKQoJCQkJaWYgZGlhbG9nLnllc25vKCJBcGFnYXIgZmljaGVpcm9zIEFUVjIuIiwgc3RyKGZpbGVfY291bnQpICsgIiBmaWNoZWlyb3MgZW5jb250cmFkb3MgZW0gJ091dHJvcyciLCAiUXVlciBhcGFnYXIgdG9kb3Mgb3MgZmljaGVpcm9zIGVtIGNhY2hlPyIpOgoJCQkJCgkJCQkJZm9yIGYgaW4gZmlsZXM6CgkJCQkJCW9zLnVubGluayhvcy5wYXRoLmpvaW4ocm9vdCwgZikpCgkJCQkJZm9yIGQgaW4gZGlyczoKCQkJCQkJc2h1dGlsLnJtdHJlZShvcy5wYXRoLmpvaW4ocm9vdCwgZCkpCgkJCQkJCQoJCQllbHNlOgoJCQkJcGFzcwoJCWF0djJfY2FjaGVfYiA9IG9zLnBhdGguam9pbignL3ByaXZhdGUvdmFyL21vYmlsZS9MaWJyYXJ5L0NhY2hlcy9BcHBsZVRWL1ZpZGVvLycsICdMb2NhbEFuZFJlbnRhbCcpCgkJCgkJZm9yIHJvb3QsIGRpcnMsIGZpbGVzIGluIG9zLndhbGsoYXR2Ml9jYWNoZV9iKToKCQkJZmlsZV9jb3VudCA9IDAKCQkJZmlsZV9jb3VudCArPSBsZW4oZmlsZXMpCgkJCgkJCWlmIGZpbGVfY291bnQgPiAwOgoKCQkJCWRpYWxvZyA9IHhibWNndWkuRGlhbG9nKCkKCQkJCWlmIGRpYWxvZy55ZXNubygiQXBhZ2FyIGZpY2hlaXJvcyBBVFYyLiIsIHN0cihmaWxlX2NvdW50KSArICIgZmljaGVpcm9zIGVuY29udHJhZG9zIGVtICdMb2NhbCciLCAiUXVlciBhcGFnYXIgdG9kb3Mgb3MgZmljaGVpcm9zIGVtIGNhY2hlPyIpOgoJCQkJCgkJCQkJZm9yIGYgaW4gZmlsZXM6CgkJCQkJCW9zLnVubGluayhvcy5wYXRoLmpvaW4ocm9vdCwgZikpCgkJCQkJZm9yIGQgaW4gZGlyczoKCQkJCQkJc2h1dGlsLnJtdHJlZShvcy5wYXRoLmpvaW4ocm9vdCwgZCkpCgkJCQkJCQoJCQllbHNlOgoJCQkJcGFzcwoJCQkgICMgU2V0IHBhdGggdG8gQ3lkaWEgQXJjaGl2ZXMgY2FjaGUgZmlsZXMKCQkJCQkJCSAKCgkjIFNldCBwYXRoIHRvIFdoYXQgdGggRnVyayBjYWNoZSBmaWxlcwoJd3RmX2NhY2hlX3BhdGggPSBvcy5wYXRoLmpvaW4oeGJtYy50cmFuc2xhdGVQYXRoKCdzcGVjaWFsOi8vcHJvZmlsZS9hZGRvbl9kYXRhL3BsdWdpbi52aWRlby53aGF0dGhlZnVyay9jYWNoZScpLCAnJykKCWlmIG9zLnBhdGguZXhpc3RzKHd0Zl9jYWNoZV9wYXRoKT09VHJ1ZToJCgkJZm9yIHJvb3QsIGRpcnMsIGZpbGVzIGluIG9zLndhbGsod3RmX2NhY2hlX3BhdGgpOgoJCQlmaWxlX2NvdW50ID0gMAoJCQlmaWxlX2NvdW50ICs9IGxlbihmaWxlcykKCQkKCQkjIENvdW50IGZpbGVzIGFuZCBnaXZlIG9wdGlvbiB0byBkZWxldGUKCQkJaWYgZmlsZV9jb3VudCA+IDA6CgkKCQkJCWRpYWxvZyA9IHhibWNndWkuRGlhbG9nKCkKCQkJCWlmIGRpYWxvZy55ZXNubygiQXBhZ2FyIGEgY2FjaGUgV1RGLiIsIHN0cihmaWxlX2NvdW50KSArICIgZmljaGVpcm9zIGVuY29udHJhZG9zLiIsICJRdWVyIGFwYWdhciB0b2RvcyBvcyBmaWNoZWlyb3MgZW0gY2FjaGU/Iik6CgkJCQkKCQkJCQlmb3IgZiBpbiBmaWxlczoKCQkJCQkJb3MudW5saW5rKG9zLnBhdGguam9pbihyb290LCBmKSkKCQkJCQlmb3IgZCBpbiBkaXJzOgoJCQkJCQlzaHV0aWwucm10cmVlKG9zLnBhdGguam9pbihyb290LCBkKSkKCQkJCQkJCgkJCWVsc2U6CgkJCQlwYXNzCgkJCQkKCQkJCSMgU2V0IHBhdGggdG8gNG9EIGNhY2hlIGZpbGVzCgljaGFubmVsNF9jYWNoZV9wYXRoPSBvcy5wYXRoLmpvaW4oeGJtYy50cmFuc2xhdGVQYXRoKCdzcGVjaWFsOi8vcHJvZmlsZS9hZGRvbl9kYXRhL3BsdWdpbi52aWRlby40b2QvY2FjaGUnKSwgJycpCglpZiBvcy5wYXRoLmV4aXN0cyhjaGFubmVsNF9jYWNoZV9wYXRoKT09VHJ1ZToJCgkJZm9yIHJvb3QsIGRpcnMsIGZpbGVzIGluIG9zLndhbGsoY2hhbm5lbDRfY2FjaGVfcGF0aCk6CgkJCWZpbGVfY291bnQgPSAwCgkJCWZpbGVfY291bnQgKz0gbGVuKGZpbGVzKQoJCQoJCSMgQ291bnQgZmlsZXMgYW5kIGdpdmUgb3B0aW9uIHRvIGRlbGV0ZQoJCQlpZiBmaWxlX2NvdW50ID4gMDoKCQoJCQkJZGlhbG9nID0geGJtY2d1aS5EaWFsb2coKQoJCQkJaWYgZGlhbG9nLnllc25vKCJBcGFnYXIgZmljaGVpcm9zIDRvRCBlbSBjYWNoZS4iLCBzdHIoZmlsZV9jb3VudCkgKyAiIGZpY2hlaXJvcyBlbmNvbnRyYWRvcy4iLCAiUXVlciBhcGFnYXIgdG9kb3Mgb3MgZmljaGVpcm9zIGVtIGNhY2hlPyIpOgoJCQkJCgkJCQkJZm9yIGYgaW4gZmlsZXM6CgkJCQkJCW9zLnVubGluayhvcy5wYXRoLmpvaW4ocm9vdCwgZikpCgkJCQkJZm9yIGQgaW4gZGlyczoKCQkJCQkJc2h1dGlsLnJtdHJlZShvcy5wYXRoLmpvaW4ocm9vdCwgZCkpCgkJCQkJCQoJCQllbHNlOgoJCQkJcGFzcwoJCQkJCgkJCQkjIFNldCBwYXRoIHRvIEJCQyBpUGxheWVyIGNhY2hlIGZpbGVzCglpcGxheWVyX2NhY2hlX3BhdGg9IG9zLnBhdGguam9pbih4Ym1jLnRyYW5zbGF0ZVBhdGgoJ3NwZWNpYWw6Ly9wcm9maWxlL2FkZG9uX2RhdGEvcGx1Z2luLnZpZGVvLmlwbGF5ZXIvaXBsYXllcl9odHRwX2NhY2hlJyksICcnKQoJaWYgb3MucGF0aC5leGlzdHMoaXBsYXllcl9jYWNoZV9wYXRoKT09VHJ1ZToJCgkJZm9yIHJvb3QsIGRpcnMsIGZpbGVzIGluIG9zLndhbGsoaXBsYXllcl9jYWNoZV9wYXRoKToKCQkJZmlsZV9jb3VudCA9IDAKCQkJZmlsZV9jb3VudCArPSBsZW4oZmlsZXMpCgkJCgkJIyBDb3VudCBmaWxlcyBhbmQgZ2l2ZSBvcHRpb24gdG8gZGVsZXRlCgkJCWlmIGZpbGVfY291bnQgPiAwOgoJCgkJCQlkaWFsb2cgPSB4Ym1jZ3VpLkRpYWxvZygpCgkJCQlpZiBkaWFsb2cueWVzbm8oIkFwYWdhciBmaWNoZWlyb3MgQkJDIGlQbGF5ZXIgZW0gY2FjaGUuIiwgc3RyKGZpbGVfY291bnQpICsgIiBmaWNoZWlyb3MgZW5jb250cmFkb3MuIiwgIlF1ZXIgYXBhZ2FyIHRvZG9zIG9zIGZpY2hlaXJvcyBlbSBjYWNoZT8iKToKCQkJCQoJCQkJCWZvciBmIGluIGZpbGVzOgoJCQkJCQlvcy51bmxpbmsob3MucGF0aC5qb2luKHJvb3QsIGYpKQoJCQkJCWZvciBkIGluIGRpcnM6CgkJCQkJCXNodXRpbC5ybXRyZWUob3MucGF0aC5qb2luKHJvb3QsIGQpKQoJCQkJCQkKCQkJZWxzZToKCQkJCXBhc3MKCQkJCQoJCQkJCgkJCQkjIFNldCBwYXRoIHRvIFNpbXBsZSBEb3dubG9hZGVyIGNhY2hlIGZpbGVzCglkb3dubG9hZGVyX2NhY2hlX3BhdGggPSBvcy5wYXRoLmpvaW4oeGJtYy50cmFuc2xhdGVQYXRoKCdzcGVjaWFsOi8vcHJvZmlsZS9hZGRvbl9kYXRhL3NjcmlwdC5tb2R1bGUuc2ltcGxlLmRvd25sb2FkZXInKSwgJycpCglpZiBvcy5wYXRoLmV4aXN0cyhkb3dubG9hZGVyX2NhY2hlX3BhdGgpPT1UcnVlOgkKCQlmb3Igcm9vdCwgZGlycywgZmlsZXMgaW4gb3Mud2Fsayhkb3dubG9hZGVyX2NhY2hlX3BhdGgpOgoJCQlmaWxlX2NvdW50ID0gMAoJCQlmaWxlX2NvdW50ICs9IGxlbihmaWxlcykKCQkKCQkjIENvdW50IGZpbGVzIGFuZCBnaXZlIG9wdGlvbiB0byBkZWxldGUKCQkJaWYgZmlsZV9jb3VudCA+IDA6CgkKCQkJCWRpYWxvZyA9IHhibWNndWkuRGlhbG9nKCkKCQkJCWlmIGRpYWxvZy55ZXNubygiQXBhZ2FyIGZpY2hlaXJvcyBTaW1wbGUgRG93bmxvYWRlciBlbSBjYWNoZS4iLCBzdHIoZmlsZV9jb3VudCkgKyAiIGZpY2hlaXJvcyBlbmNvbnRyYWRvcy4iLCAiUXVlciBhcGFnYXIgdG9kb3Mgb3MgZmljaGVpcm9zIGVtIGNhY2hlPyIpOgoJCQkJCgkJCQkJZm9yIGYgaW4gZmlsZXM6CgkJCQkJCW9zLnVubGluayhvcy5wYXRoLmpvaW4ocm9vdCwgZikpCgkJCQkJZm9yIGQgaW4gZGlyczoKCQkJCQkJc2h1dGlsLnJtdHJlZShvcy5wYXRoLmpvaW4ocm9vdCwgZCkpCgkJCQkJCQoJCQllbHNlOgoJCQkJcGFzcwoJCglpdHZfY2FjaGVfcGF0aCA9IG9zLnBhdGguam9pbih4Ym1jLnRyYW5zbGF0ZVBhdGgoJ3NwZWNpYWw6Ly9wcm9maWxlL2FkZG9uX2RhdGEvcGx1Z2luLnZpZGVvLml0di9JbWFnZXMnKSwgJycpCglpZiBvcy5wYXRoLmV4aXN0cyhpdHZfY2FjaGVfcGF0aCk9PVRydWU6CQoJCWZvciByb290LCBkaXJzLCBmaWxlcyBpbiBvcy53YWxrKGl0dl9jYWNoZV9wYXRoKToKCQkJZmlsZV9jb3VudCA9IDAKCQkJZmlsZV9jb3VudCArPSBsZW4oZmlsZXMpCgkJCQoJCQlpZiBmaWxlX2NvdW50ID4gMDoKCQoJCQkJZGlhbG9nID0geGJtY2d1aS5EaWFsb2coKQoJCQkJaWYgZGlhbG9nLnllc25vKCJBcGFnYXIgaXRlbXMgZW0gY2FjaGUiLCBzdHIoZmlsZV9jb3VudCkgKyAiIGZpY2hlaXJvcyBlbmNvbnRyYWRvcy4iLCAiUXVlciBhcGFnYXIgdG9kb3Mgb3MgZmljaGVpcm9zIGVtIGNhY2hlPyIpOgoJCQkJCgkJCQkJZm9yIGYgaW4gZmlsZXM6CgkJCQkJCW9zLnVubGluayhvcy5wYXRoLmpvaW4ocm9vdCwgZikpCgkJCQkJZm9yIGQgaW4gZGlyczoKCQkJCQkJc2h1dGlsLnJtdHJlZShvcy5wYXRoLmpvaW4ocm9vdCwgZCkpCgkJCQkJCQoJCQllbHNlOgoJCQkJcGFzcwoJZGlhbG9nID0geGJtY2d1aS5EaWFsb2coKQoJZGlhbG9nLm9rKEFkZG9uVGl0bGUsICIJCUNhY2hlIGFwYWdhZGEgY29tIHN1Y2Vzc28hIikKCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIyMJIFB1cmdlIFBhY2thZ2VzCQkjIyMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCmRlZiBQVVJHRVBBQ0tBR0VTKCk6CglwYWNrYWdlc19jYWNoZV9wYXRoID0geGJtYy50cmFuc2xhdGVQYXRoKG9zLnBhdGguam9pbignc3BlY2lhbDovL2hvbWUvYWRkb25zL3BhY2thZ2VzJywgJycpKQoJdHJ5OgkKCQlmb3Igcm9vdCwgZGlycywgZmlsZXMgaW4gb3Mud2FsayhwYWNrYWdlc19jYWNoZV9wYXRoKToKCQkJZmlsZV9jb3VudCA9IDAKCQkJZmlsZV9jb3VudCArPSBsZW4oZmlsZXMpCgkJCQoJCQlpZiBmaWxlX2NvdW50ID4gMDoKCQoJCQkJZGlhbG9nID0geGJtY2d1aS5EaWFsb2coKQoJCQkJaWYgZGlhbG9nLnllc25vKCJFeGNsdWlyIGluZm9ybWHDp8OjbyBlbSBDYWNoZS4iLCBzdHIoZmlsZV9jb3VudCkgKyAiIGZpY2hlaXJvcyBlbmNvbnRyYWRvcy4iLCAiUXVlciBhcGFnYXIgdG9kb3Mgb3MgZmljaGVpcm9zPyIpOgoJCQkJCQkJCgkJCQkJZm9yIGYgaW4gZmlsZXM6CgkJCQkJCW9zLnVubGluayhvcy5wYXRoLmpvaW4ocm9vdCwgZikpCgkJCQkJZm9yIGQgaW4gZGlyczoKCQkJCQkJc2h1dGlsLnJtdHJlZShvcy5wYXRoLmpvaW4ocm9vdCwgZCkpCgkJCQkJZGlhbG9nID0geGJtY2d1aS5EaWFsb2coKQoJCQkJCWRpYWxvZy5vayhBZGRvblRpdGxlLCAiCQlLb2RpIGxpbXBvIGNvbSBzdWNlc3NvLiIpCgkJCQllbHNlOgoJCQkJCQlwYXNzCgkJCWVsc2U6CgkJCQlkaWFsb2cgPSB4Ym1jZ3VpLkRpYWxvZygpCgkJCQlkaWFsb2cub2soQWRkb25UaXRsZSwgIgkJTsOjbyBmb3JhbSBlbmNvbnRyYWRvcyBmaWNoZWlyb3MgYSBhcGFnYXIuIikKCWV4Y2VwdDogCgkJZGlhbG9nID0geGJtY2d1aS5EaWFsb2coKQoJCWRpYWxvZy5vayhBZGRvblRpdGxlLCAiRXJybyBhbyB0ZW50YXIgYXBhZ2FyIGZpY2hlaXJvcyBlbSBjYWNoZS4iKQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMJCQkJCQkJCQkJCQlBZGRvbiBMSVZFSVQgRmlsbWVzIGUgU2VyaWVzCQkJCQkJCSAjCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwpkZWYgZGV2b2x2ZXJlc3VsdGFkbyh1cmxub28pOgoJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybG5vbywgaGVhZGVyPWhlYWRlcnMpCgl0cnk6CgkJcmVzdWx0YWRvID0gcmVzdWx0YWRvLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OgoJCXJlc3VsdGFkbyA9IHJlc3VsdGFkby5lbmNvZGUoJ3V0Zi04JykKCXJldHVybiByZXN1bHRhZG8KCmRlZiBnZXRDYXRlZ29yaWFsaXZlKGlkLGluaWNpbyk6CgljYXQgPSBsZXJfZmljaGVpcm8ob3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnY2F0ZWdvcmlhc19saXZlLmxpdmVpdCcpKS5yZXBsYWNlKCciJywgIiciKQoJcmV0dXJuIGNhdAoJCmRlZiBnZXRTYWdhc2xpdmUoaWQsaW5pY2lvKToKCWNhdCA9IGxlcl9maWNoZWlybyhvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdzYWdhc19saXZlLmxpdmVpdCcpKS5yZXBsYWNlKCciJywgIiciKQoJcmV0dXJuIGNhdAoKZGVmIGdldEFub3NsaXZlKGlkLGluaWNpbyk6CgljYXQgPSBsZXJfZmljaGVpcm8ob3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnYW5vc19saXZlLmxpdmVpdCcpKS5yZXBsYWNlKCciJywgIiciKQoJcmV0dXJuIGNhdAoKZGVmIGxvZ2lubGlsaShpbmljaW8pOgoJcmVzdWx0YWRvID0gRmFsc2UKCWVycm9zID0gIiIKCXRyeToKCQl1cmxub28gPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmYWRkb249MSZ0aXBvPScraW5pY2lvCgkJcmVzdWx0YWRvID0gZGV2b2x2ZXJlc3VsdGFkbyh1cmxub28pCgkJZXNjcmV2ZXJfZmljaGVpcm8ob3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnZGVmaW5pY29lc19saXZlLmxpdmVpdCcpLCByZXN1bHRhZG8pCgkJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pCgkJY2F0ZWdvcmlhcyA9IHJlc3VsdGFkb1snZ3J1cG9zJ10KCQllc2NyZXZlcl9maWNoZWlybyhvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdjYXRlZ29yaWFzX2xpdmUubGl2ZWl0JyksIHN0cihjYXRlZ29yaWFzKSkKCQlhbm9zID0gcmVzdWx0YWRvWydhbm9zJ10KCQllc2NyZXZlcl9maWNoZWlybyhvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdhbm9zX2xpdmUubGl2ZWl0JyksIHN0cihhbm9zKSkKCQkKCQlpZiBpbmljaW8gPT0gJ2luaWNpb19maWxtZXMnOgoJCQlzYWdhcyA9IHJlc3VsdGFkb1snc2FnYXMnXQoJCQllc2NyZXZlcl9maWNoZWlybyhvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdzYWdhc19saXZlLmxpdmVpdCcpLCBzdHIoc2FnYXMpKQoJCXJldHVybiBUcnVlCglleGNlcHQ6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnTsOjbyBmb2kgcG9zc8OtdmVsIGFicmlyIGEgcMOhZ2luYS4gUG9yIGZhdm9yIHRlbnRlIG5vdmFtZW50ZS4nKQoJCXJldHVybiBGYWxzZQoKZGVmIGxpc3RhbWVudXNfbGl2ZWl0MSgpOgoJY2hlY2tfbG9naW4gPSBsb2dpbmxpbGkoJ2luaWNpb19maWxtZXMnKQoJaWYgY2hlY2tfbG9naW4gPT0gVHJ1ZToKCQltZW51RmlsbWVzMihvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZmlsbWVzLnBuZycpLF9fU0lURUFkZG9uX18rJ0ltYWdlbnMvZmlsbWVzX2ZhbmFydC5wbmcnKQoJZWxzZToKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdFcnJvIGEgZmF6ZXIgbG9naW4gbmVzdGEgcGFydGUuIFRlbnRlIG5vdmFtZW50ZSBtYWlzIHRhcmRlLicpCgpkZWYgbGlzdGFtZW51c19saXZlaXQyKCk6CgljaGVja19sb2dpbiA9IGxvZ2lubGlsaSgnaW5pY2lvX3NlcmllcycpCglpZiBjaGVja19sb2dpbiA9PSBUcnVlOgoJCW1lbnVTZXJpZXMyKG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdzZXJpZXMucG5nJyksX19TSVRFQWRkb25fXysnSW1hZ2Vucy9zZXJpZXNfZmFuYXJ0LnBuZycpCgllbHNlOgoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0Vycm8gYSBmYXplciBsb2dpbiBuZXN0YSBwYXJ0ZS4gVGVudGUgbm92YW1lbnRlIG1haXMgdGFyZGUuJykKCmRlZiBtZW51RmlsbWVzMihpY29uaW1hZ2UsZmFuYXJ0KToKCWFkZERpcjIoJ1RvZG9zIG9zIEZpbG1lcycsIF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPWZpbG1lcyZnZW5lcm89dG9kb3MmYWRkb249MScsIDExMTExLCAnZmlsbWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdUb2RvcyBvcyBEZXN0YXF1ZXMnLCBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1maWxtZXMmZ2VuZXJvPWRlc3RhcXVlcyZhZGRvbj0xJywgMTExMTEsICdmaWxtZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ1RvZGFzIGFzIFNhZ2FzJywgX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89ZmlsbWVzJmdlbmVybz1zYWdhcyZhZGRvbj0xJywgMTExMTk5LCAnZmlsbWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdQb3IgQW5vJywgX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89ZmlsbWVzJmdlbmVybz1hbm9zJmFkZG9uPTEnLCAxMTExOCwgJ2ZpbG1lcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignUG9yIENhdGVnb3JpYScsIF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPWZpbG1lcyZnZW5lcm89Y2F0ZWdvcmlhJmFkZG9uPTEnLCAxMTExOSwgJ2ZpbG1lcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignUG9yIFJhdGluZycsIF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPWZpbG1lcyZnZW5lcm89cmF0aW5nJmFkZG9uPTEnLCAxMTExMSwgJ2ZpbG1lcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignUGFyYSBDcmlhbsOnYXMnLCBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1maWxtZXMmZ2VuZXJvPWtpZHMmYWRkb249MScsIDExMTExLCAnZmlsbWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdbQ09MT1IgcGlua11bQl1QZXNxdWlzYVsvQl1bL0NPTE9SXScsIF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPWZpbG1lcyZhZGRvbj0xJywgMTExMjAsICdmaWxtZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCXZpc3RhX21lbnUoKQoKZGVmIG1lbnVTZXJpZXMyKGljb25pbWFnZSxmYW5hcnQpOgoJYWRkRGlyMignVG9kYXMgU2VyaWVzJywgX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89c2VyaWVzJmdlbmVybz10b2RvcyZhZGRvbj0xJywgMTExMTIsICdzZXJpZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ1RvZG9zIG9zIERlc3RhcXVlcycsIF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPXNlcmllcyZnZW5lcm89ZGVzdGFxdWVzJmFkZG9uPTEnLCAxMTExMiwgJ3NlcmllcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignUG9yIEFubycsIF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPXNlcmllcyZnZW5lcm89YW5vcyZhZGRvbj0xJywgMTExMTgsICdzZXJpZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ1BvciBDYXRlZ29yaWEnLCBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1zZXJpZXMmZ2VuZXJvPWNhdGVnb3JpYSZhZGRvbj0xJywgMTExMTksICdzZXJpZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ1BvciBSYXRpbmcnLCBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1zZXJpZXMmZ2VuZXJvPXJhdGluZyZhZGRvbj0xJywgMTExMTIsICdzZXJpZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ1BhcmEgQ3JpYW7Dp2FzJywgX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89c2VyaWVzJmdlbmVybz1raWRzJmFkZG9uPTEnLCAxMTExMiwgJ3NlcmllcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignW0NPTE9SIHBpbmtdW0JdUGVzcXVpc2FbL0JdWy9DT0xPUl0nLCBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1zZXJpZXMmYWRkb249MScsIDExMTIwLCAnc2VyaWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCgl2aXN0YV9tZW51KCkKCQpkZWYgZmlsbWVzMih1cmwpOgoJcmVzdWx0YWRvID0gZGV2b2x2ZXJlc3VsdGFkbyh1cmwpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCWZvciBpIGluIHJlc3VsdGFkb1snaXRlbSddOgoJCXNldEZpbG1lMihpKQoJCgljdXJyZW50ID0gcmVzdWx0YWRvWydwYWdpbmFjYW8nXVsnYXR1YWwnXQoJdG90YWwgPSAwCgl0cnk6IHRvdGFsID0gcmVzdWx0YWRvWydwYWdpbmFjYW8nXVsndG90YWwnXQoJZXhjZXB0OiBwYXNzCgl0cnk6IHByb3hpbW8gPSBiYXNlNjQuYjY0ZGVjb2RlKHJlc3VsdGFkb1sncGFnaW5hY2FvJ11bJ3NlZ3VpbnRlJ10pCglleGNlcHQ6IHBhc3MKCWlmIGludChjdXJyZW50KSA8IGludCh0b3RhbCk6CgkJYWRkRGlyMignUHLDs3hpbWEgcMOhZ2luYSAoJytzdHIoY3VycmVudCkrJy8nK3N0cih0b3RhbCkrJyknLCBwcm94aW1vLCAxMTExMSwgJ2ZpbG1lcycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdwcm94aW1vLnBuZycpLDEpCgl2aXN0YV9maWxtZXNTZXJpZXMoKQoJCQpkZWYgc2VyaWVzMih1cmwpOgoJcmVzdWx0YWRvID0gZGV2b2x2ZXJlc3VsdGFkbyh1cmwpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCQoJZm9yIGkgaW4gcmVzdWx0YWRvWydpdGVtJ106CgkJc2V0U2VyaWVzMihpKQoJCgljdXJyZW50ID0gcmVzdWx0YWRvWydwYWdpbmFjYW8nXVsnYXR1YWwnXQoJdG90YWwgPSAwCgl0cnk6IHRvdGFsID0gcmVzdWx0YWRvWydwYWdpbmFjYW8nXVsndG90YWwnXQoJZXhjZXB0OiBwYXNzCgl0cnk6IHByb3hpbW8gPSBiYXNlNjQuYjY0ZGVjb2RlKHJlc3VsdGFkb1sncGFnaW5hY2FvJ11bJ3NlZ3VpbnRlJ10pCglleGNlcHQ6IHBhc3MKCWlmIGludChjdXJyZW50KSA8IGludCh0b3RhbCk6CgkJYWRkRGlyMignUHJveGltYSBwYWdpbmEgKCcrc3RyKGN1cnJlbnQpKycvJytzdHIodG90YWwpKycpJywgcHJveGltbywgMTExMTIsICdzZXJpZXMnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncHJveGltby5wbmcnKSkKCXZpc3RhX2ZpbG1lc1NlcmllcygpCgkKCQpkZWYgc2V0RmlsbWUyKGkpOgoJY2F0ZWdvcmlhID0gIiIKCXRyeTogY2F0ZWdvcmlhID0gYmFzZTY0LmI2NGRlY29kZShpWydHcnVwbyddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglncnVwbzIgPSAiIgoJdHJ5OiBncnVwbzIgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0dydXBvMiddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcyAKCQoJZ3J1cG8zID0gIiIKCXRyeTogZ3J1cG8zID0gYmFzZTY0LmI2NGRlY29kZShpWydHcnVwbzMnXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJaWYgZ3J1cG8yICE9ICIiOgoJCWNhdGVnb3JpYSArPSAnLCcrZ3J1cG8yCglpZiBncnVwbzMgIT0gIiI6CgkJY2F0ZWdvcmlhICs9ICcsJytncnVwbzMKCQoJcHQgPSAnJwoJYnIgPSAnJwoJc2VtTGVnZW5kYSA9ICcnCglpZF92aWRlbyA9IGlbJ0lEJ10KCQoJbm9tZSA9ICcnCgl0cnk6IG5vbWUgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ05vbWUnXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJbm9tZWVuID0gJycKCXRyeTogbm9tZWVuID0gYmFzZTY0LmI2NGRlY29kZShpWydOb21lRU4nXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJZGVzY3JpY2FvID0gJycKCXRyeTogZGVzY3JpY2FvID0gYmFzZTY0LmI2NGRlY29kZShpWydEZXNjcmljYW8nXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJcmVhbGl6YWRvciA9ICcnCgl0cnk6IHJlYWxpemFkb3IgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ1JlYWxpemFkb3InXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJYWN0b3JlcyA9ICcnCgl0cnk6IGFjdG9yZXMgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0FjdG9yZXMnXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJeW91dHViZSA9ICcnCgl0cnk6IHlvdXR1YmUgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ1lvdXR1YmUnXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJdXJsMSA9ICcnCgl0cnk6IHVybDEgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ1VybCddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCgl1cmwyID0gJycKCXRyeTogdXJsMiA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnVXJsMSddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCgl1cmwzID0gJycKCXRyeTogdXJsMyA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnVXJsMiddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCgl1cmw0ID0gJycKCXRyeTogdXJsNCA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnVXJsMyddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglpbWRiID0gJycKCXRyeTogaW1kYiA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnSW1kYiddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglpbWFnZW0gPSAnJwoJdHJ5OiBpbWFnZW0gPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0ltYWdlbSddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglsZWdlbmRhcyA9ICcnCgl0cnk6IGxlZ2VuZGFzID0gYmFzZTY0LmI2NGRlY29kZShpWydMZWdlbmRhcyddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglhbm9zID0gaVsnQW5vTm92byddCgkKCWlmICdodHRwJyBub3QgaW4gaW1hZ2VtOgoJCWltYWdlbSA9IF9fQVBJX18raW1hZ2VtCgkKCWlmIGxlZ2VuZGFzID09ICJzZW1sZWdlbmRhIiBvciBpWydMZWdlbmRhcyddID09ICIiOgoJCXNlbUxlZ2VuZGEgPSAnW0NPTE9SIHJlZF1bQl1TLyBMRUdFTkRBIFsvQl1bL0NPTE9SXScKCWlmICdCcmFzaWxlaXJvJyBpbiBjYXRlZ29yaWE6CgkJYnIgPSAnW0JdW0NPTE9SIGdyZWVuXUJbL0NPTE9SXVtDT0xPUiB5ZWxsb3ddUlsvQ09MT1JdOiBbL0JdJwoJaWYgJ1BvcnR1JyBpbiBjYXRlZ29yaWE6CgkJcHQgPSAnW0JdW0NPTE9SIGdyZWVuXVBbL0NPTE9SXVtDT0xPUiByZWRdVFsvQ09MT1JdOiBbL0JdJwoJCgl2aXN0byA9IEZhbHNlCgljb3IgPSAnd2hpdGUnCglpZiAnUFQnIGluIGltZGI6CgkJaW1kYiA9IHJlLmNvbXBpbGUoJyguKz8pUFQnKS5maW5kYWxsKGltZGIpWzBdCgkJcHQgPSAnW0JdW0NPTE9SIGdyZWVuXVBbL0NPTE9SXVtDT0xPUiByZWRdVFsvQ09MT1JdOiBbL0JdJwoJCglpbmZvTGFiZWxzID0geydUaXRsZSc6IG5vbWVlbiwgJ1llYXInOiBhbm9zLCAnR2VucmUnOiBjYXRlZ29yaWEsICdQbG90JzogZGVzY3JpY2FvLCAnQ2FzdCc6IGFjdG9yZXMuc3BsaXQoJywnKSwgJ1RyYWlsZXInOiB5b3V0dWJlLCAnRGlyZWN0b3InOiByZWFsaXphZG9yLCAnUmF0aW5nJzogaVsnUmF0aW5nJ10sICdJTURCTnVtYmVyJzogaW1kYiB9CgoJbm9tZWVlID0gJ1tDT0xPUiAnK2NvcisnXScrcHQrYnIrc2VtTGVnZW5kYStyZW1vdmVyQWNlbnRvcyhub21lKSsnICgnK2Fub3MrJylbL0NPTE9SXScKCXVybG5vbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPWZpbG1lcyZnZW5lcm89Z2V0X3ZpZGVvJmFkZG9uPTEmcGVzcXVpc2E9JytzdHIoaWRfdmlkZW8pCglmb3Rvb28gPSBpbWFnZW0KCWZhbmFydHR0ID0gJ2ltYWdlcy9iYWNrZ3JvdW5kLycraW1kYisnLmpwZycKCQoJYWRkVmlkZW8obm9tZWVlLCB1cmxub28sIDExMTEzLCBmb3Rvb28sIHZpc3RvLCAnZmlsbWUnLCAwLCAwLCBpbmZvTGFiZWxzLCBmYW5hcnR0dCwgdHJhaWxlcj15b3V0dWJlKQoKZGVmIGdldEdlbmVyb3MyX2xpdmUodXJsLCBtb2RvKToKCWxpc3RhID0gW10KCWxpc3RhID0gZ2V0U2FnYXNsaXZlKCdpbmljaW9fc2FnYXMnLCBtb2RvKQoJCglmb3IgYyBpbiBhc3QubGl0ZXJhbF9ldmFsKGxpc3RhKToKCQlpZiBjWydJRCddID09ICIwIjoKCQkJY29udGludWUKCQl0cnk6CgkJCWNhdCA9IGJhc2U2NC5iNjRkZWNvZGUoY1snTm9tZSddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6CgkJCXBhc3MKCQkKCQl1cmxub3ZvID0gdXJsKycmcGVzcXVpc2E9JytzdHIoY1snSUQnXSk7CgkJYWRkRGlyMihjYXQsIHVybG5vdm8sIDExMTIxLCBtb2RvLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZ2VuZXJvLnBuZycpKQoJCgl2aXN0YV9tZW51KCkKCmRlZiBnZXRHZW5lcm9zX2xpdmUodXJsLCBtb2RvKToKCWxpc3RhID0gW10KCWlmIG1vZG8gPT0gJ2ZpbG1lcyc6CgkJbGlzdGEgPSBnZXRDYXRlZ29yaWFsaXZlKCdpbmljaW9fZmlsbWVzJywgbW9kbykKCWVsc2U6CgkJbGlzdGEgPSBnZXRDYXRlZ29yaWFsaXZlKCdpbmljaW9fc2VyaWVzJywgbW9kbykKCQoJZm9yIGMgaW4gYXN0LmxpdGVyYWxfZXZhbChsaXN0YSk6CgkJaWYgY1snSUQnXSA9PSAiMCI6CgkJCWNvbnRpbnVlCgkJdHJ5OgoJCQljYXQgPSBiYXNlNjQuYjY0ZGVjb2RlKGNbJ05vbWUnXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OgoJCQlwYXNzCgkJCgkJdXJsbm92byA9IHVybCsnJnBlc3F1aXNhPScrc3RyKGNbJ0lEJ10pOwoJCWFkZERpcjIoY2F0LCB1cmxub3ZvLCAxMTEyMSwgbW9kbywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2dlbmVyby5wbmcnKSkKCQoJdmlzdGFfbWVudSgpCgpkZWYgZ2V0WWVhcnNfbGl2ZSh1cmwsIG1vZG8pOgoJbGlzdGEgPSBbXQoJaWYgbW9kbyA9PSAnZmlsbWVzJzoKCQlsaXN0YSA9IGdldEFub3NsaXZlKCdpbmljaW9fZmlsbWVzJywgbW9kbykKCWVsc2U6CgkJbGlzdGEgPSBnZXRBbm9zbGl2ZSgnaW5pY2lvX3NlcmllcycsIG1vZG8pCgkKCWZvciBjIGluIGFzdC5saXRlcmFsX2V2YWwobGlzdGEpOgoJCWlmIGNbJ0lEJ10gPT0gIjAiOgoJCQljb250aW51ZQoJCXRyeToKCQkJY2F0ID0gYmFzZTY0LmI2NGRlY29kZShjWydOb21lJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDoKCQkJcGFzcwoJCQoJCXVybG5vdm8gPSB1cmwrJyZwZXNxdWlzYT0nK3N0cihjWydJRCddKTsKCQlhZGREaXIyKGNhdCwgdXJsbm92bywgMTExMjEsIG1vZG8sIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdnZW5lcm8ucG5nJykpCgkKCXZpc3RhX21lbnUoKQoJCmRlZiBnZXRJbmZvX2xpdmUodXJsLCB0aXBvKToKCXJlc3VsdGFkbyA9IGRldm9sdmVyZXN1bHRhZG8odXJsKQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pCglmb3IgaSBpbiByZXN1bHRhZG9bIml0ZW0iXToKCQlpZiB0aXBvID09ICdmaWxtZXMnOgoJCQlzZXRGaWxtZTIoaSkKCQllbHNlOgoJCQlzZXRTZXJpZXMyKGkpCgkKCWN1cnJlbnQgPSByZXN1bHRhZG9bJ3BhZ2luYWNhbyddWydhdHVhbCddCgl0b3RhbCA9IDAKCXRyeTogdG90YWwgPSByZXN1bHRhZG9bJ3BhZ2luYWNhbyddWyd0b3RhbCddCglleGNlcHQ6IHBhc3MKCXRyeTogcHJveGltbyA9IGJhc2U2NC5iNjRkZWNvZGUocmVzdWx0YWRvWydwYWdpbmFjYW8nXVsnc2VndWludGUnXSkKCWV4Y2VwdDogcGFzcwoJaWYgaW50KGN1cnJlbnQpIDwgaW50KHRvdGFsKToKCQlhZGREaXIyKCdQcm94aW1hIHBhZ2luYSAoJytzdHIoY3VycmVudCkrJy8nK3N0cih0b3RhbCkrJyknLCBwcm94aW1vLCAxMTEyMSwgdGlwbywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Byb3hpbW8ucG5nJykpCgl2aXN0YV9maWxtZXNTZXJpZXMoKQoJCmRlZiBwZXNxdWlzYV9saXZlKHVybCwgdGlwb2xvKToKCWNvZGlnb19mb250ZSA9ICcnCglkYWRvcyA9ICcnCgl0YWJlbGEgPSAnJwoJc3RyUGVzcXVpc2EgPSAnJwoJZmljaGVpcm8gPSAnJwoJc2l0ZSA9ICcnCglxdWFsaWRhZGUgPSAnJwoJdG9rZW5QZXNxdWlzYT0gJycKCXJlc3VsdGFkbyA9ICcnCgl0aXBvbG9wZXNxdWlzYU5vdm8gPSAnMCcKCWlmIHRpcG9sbyA9PSAnZmlsbWVzJzoKCQlmaWNoZWlybyA9IG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ2ZpbG1lc19wZXNxdWlzYS5saXZlaXQnKQoJCXRpcG8gPSAwCgkJcXVhbGlkYWRlID0gX19RdWFsaWRhZGVfXwoJZWxzZToKCQlmaWNoZWlybyA9IG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ3Nlcmllc19wZXNxdWlzYS5saXZlaXQnKQoJCXRpcG8gPSAxCgkJc2l0ZSA9ICdzZXJpZXMnCgkKCWlmICdwYWdlJyBub3QgaW4gdXJsOgoJCXRyeToKCQkJdGlwb2xvcGVzcXVpc2EgPSB4Ym1jZ3VpLkRpYWxvZygpLnNlbGVjdCh1J08gcXVlIHByZXRlbmRlIHBlc3F1aXNhcj8nLCBbJ1BvcjogTm9tZVBUIG91IE5vbWUgRU4nLCAnUG9yOiBSZWFsaXphZG9yJywnUG9yOiBBY3RvciddKQoJCWV4Y2VwdDoKCQkJcmV0dXJuIEZhbHNlCgkJCgkJaWYgdGlwb2xvcGVzcXVpc2EgPT0gMDoKCQkJdGlwb2xvcGVzcXVpc2FOb3ZvID0gJzAnCgkJZWxpZiB0aXBvID09IDE6CgkJCXRpcG9sb3Blc3F1aXNhTm92byA9ICcxJwoJCWVsaWYgdGlwbyA9PSAyOgoJCQl0aXBvbG9wZXNxdWlzYU5vdm8gPSAnMicKCQkJCgkJX19BRERPTl9fLnNldFNldHRpbmcoJ3Rva2VuUGVzcXVpc2EnLCB0aXBvbG9wZXNxdWlzYU5vdm8pCgkJdGVjbGFkbyA9IHhibWMuS2V5Ym9hcmQoJycsICdPIHF1ZSBxdWVyIHBlc3F1aXNhcj8nKQoJCXRlY2xhZG8uZG9Nb2RhbCgpCgkJCgkJaWYgdGVjbGFkby5pc0NvbmZpcm1lZCgpOgoJCQlzdHJQZXNxdWlzYSA9IHRlY2xhZG8uZ2V0VGV4dCgpCgkJCWlmIHN0clBlc3F1aXNhID09ICcnOgoJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnSW5zaXJhIGFsZ28gbmEgcGVzcXVpc2EuJykKCQkJCWFkZERpcjIoJ0FsdGVyYXIgUGVzcXVpc2EnLCB1cmwsIDExMTIwLCB0aXBvbG8sIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdwZXNxdWlzYS5wbmcnKSwgMCkKCQkJCXJldHVybiBGYWxzZQoJCQllbHNlOgoJCQkJdG9rZW5QZXNxdWlzYSA9IHN0clBlc3F1aXNhLnJlcGxhY2UoIiAiLCAiJTIwIikKCQkJCV9fQURET05fXy5zZXRTZXR0aW5nKCd0b2tlblBlc3F1aXNhVGV4dG8nLCB0b2tlblBlc3F1aXNhKQoJCglyZXN1bHRhZG8gPSBkZXZvbHZlcmVzdWx0YWRvKHVybCsnJnBlc3F1aXNhPScrX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuUGVzcXVpc2FUZXh0bycpKycmZ2VuZXJvPXBlc3F1aXNhJytfX0FERE9OX18uZ2V0U2V0dGluZygndG9rZW5QZXNxdWlzYScpKQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pCglmb3IgaSBpbiByZXN1bHRhZG9bIml0ZW0iXToKCQlpZiB0aXBvbG8gPT0gJ2ZpbG1lcyc6CgkJCXNldEZpbG1lMihpKQoJCWVsc2U6CgkJCXNldFNlcmllczIoaSkKCQoJY3VycmVudCA9IHJlc3VsdGFkb1sncGFnaW5hY2FvJ11bJ2F0dWFsJ10KCXRvdGFsID0gMAoJdHJ5OiB0b3RhbCA9IHJlc3VsdGFkb1sncGFnaW5hY2FvJ11bJ3RvdGFsJ10KCWV4Y2VwdDogcGFzcwoJdHJ5OiBwcm94aW1vID0gYmFzZTY0LmI2NGRlY29kZShyZXN1bHRhZG9bJ3BhZ2luYWNhbyddWydzZWd1aW50ZSddKQoJZXhjZXB0OiBwYXNzCglpZiBpbnQoY3VycmVudCkgPCBpbnQodG90YWwpOgoJCWFkZERpcjIoJ1Byb3hpbWEgcGFnaW5hICgnK3N0cihjdXJyZW50KSsnLycrc3RyKHRvdGFsKSsnKScsIHByb3hpbW8sIDExMTIwLCB0aXBvbG8sIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdwcm94aW1vLnBuZycpKQoJZWxzZToKCQl4Ym1jcGx1Z2luLmVuZE9mRGlyZWN0b3J5KGludChzeXMuYXJndlsxXSksY2FjaGVUb0Rpc2M9RmFsc2UpCgkKCXZpc3RhX2ZpbG1lc1NlcmllcygpCgpkZWYgc2V0U2VyaWVzMihpKToKCWNhdGVnb3JpYSA9ICIiCgl0cnk6IGNhdGVnb3JpYSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnR3J1cG8nXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJZ3J1cG8yID0gIiIKCXRyeTogZ3J1cG8yID0gYmFzZTY0LmI2NGRlY29kZShpWydHcnVwbzInXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MgCgkKCWdydXBvMyA9ICIiCgl0cnk6IGdydXBvMyA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnR3J1cG8zJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCWlmIGdydXBvMiAhPSAiIjoKCQljYXRlZ29yaWEgKz0gJywnK2dydXBvMgoJaWYgZ3J1cG8zICE9ICIiOgoJCWNhdGVnb3JpYSArPSAnLCcrZ3J1cG8zCgkKCWlkX3ZpZGVvID0gaVsnSUQnXQoJCglub21lID0gJycKCXRyeTogbm9tZSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnTm9tZSddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglub21lZW4gPSAnJwoJdHJ5OiBub21lZW4gPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ05vbWVFTiddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglkZXNjcmljYW8gPSAnJwoJdHJ5OiBkZXNjcmljYW8gPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0Rlc2NyaWNhbyddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglyZWFsaXphZG9yID0gJycKCXRyeTogcmVhbGl6YWRvciA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnUmVhbGl6YWRvciddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglhY3RvcmVzID0gJycKCXRyeTogYWN0b3JlcyA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnQWN0b3JlcyddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCgl5b3V0dWJlID0gJycKCXRyeTogeW91dHViZSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnWW91dHViZSddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglpbWRiID0gJycKCXRyeTogaW1kYiA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnSW1kYiddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglhbm9zID0gaVsnQW5vTm92byddCgl0ZW1wb3JhZGFzID0gaVsnVGVtcG9yYWRhcyddCgkKCWltYWdlbSA9ICcnCgl0cnk6IGltYWdlbSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnSW1hZ2VtJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCXZpc3RvID0gRmFsc2UKCXB0ID0gJycKCWJyID0gJycKCXNlbUxlZ2VuZGEgPSAnJwoJaWYgJ0JyYXNpbGVpcm8nIGluIGNhdGVnb3JpYToKCQliciA9ICdbQl1bQ09MT1IgZ3JlZW5dQlsvQ09MT1JdW0NPTE9SIHllbGxvd11SWy9DT0xPUl06IFsvQl0nCglpZiAnUG9ydHUnIGluIGNhdGVnb3JpYToKCQlwdCA9ICdbQl1bQ09MT1IgZ3JlZW5dUFsvQ09MT1JdW0NPTE9SIHJlZF1UWy9DT0xPUl06IFsvQl0nCglpZiAnUFQnIGluIGltZGI6CgkJcHQgPSAnW0JdW0NPTE9SIGdyZWVuXVBbL0NPTE9SXVtDT0xPUiByZWRdVFsvQ09MT1JdOiBbL0JdJwoJCglpZiAnaHR0cCcgbm90IGluIGltYWdlbToKCQlpbWFnZW0gPSBfX0FQSV9fK2ltYWdlbQoJCgl1cmxub28gPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1zZXJpZXMmZ2VuZXJvPXRlbXBvcmFkYSZhZGRvbj0xJnNlcmllPScraWRfdmlkZW8rJyZ0ZW1wb3JhZGE9JwoJCglpbmZvTGFiZWxzID0geydUaXRsZSc6IG5vbWVlbiwgJ1llYXInOiBhbm9zLCAnR2VucmUnOiBjYXRlZ29yaWEsICdQbG90JzogZGVzY3JpY2FvLCAnQ2FzdCc6IGFjdG9yZXMuc3BsaXQoJywnKSwgJ1RyYWlsZXInOiB5b3V0dWJlLCAnRGlyZWN0b3InOiByZWFsaXphZG9yLCAnUmF0aW5nJzogaVsnUmF0aW5nJ10sICdJTURCTnVtYmVyJzogaW1kYiB9CgkKCW5vbWVlZSA9IHB0K2JyK3NlbUxlZ2VuZGErcmVtb3ZlckFjZW50b3Mobm9tZSkrJyAoJythbm9zKycpJwoJZm90b29vID0gaW1hZ2VtCglmYW5hcnR0dCA9IF9fQVBJX18rJ2ltYWdlcy9iYWNrZ3JvdW5kLycraW1kYisnLmpwZycKCWFkZERpcjIobm9tZWVlLCB1cmxub28sIDExMTE0LCB0ZW1wb3JhZGFzLCBmb3Rvb28sIHRpcG89J3NlcmllJywgaW5mb0xhYmVscz1pbmZvTGFiZWxzLHBvc3Rlcj1mYW5hcnR0dCx2aXN0bz12aXN0bykKCQoJCmRlZiBnZXRTZWFzb25zMih1cmwsIG1vZG8pOgoJaj1pbnQobW9kbykKCWZvciBpIGluIHJhbmdlKGopOgoJCWFkZERpcjIoIltCXVRlbXBvcmFkYVsvQl0gIitzdHIoaSsxKSwgdXJsK3N0cihpKzEpLCAxMTExNSwgJ2VwaXNvZGlvcycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sJ3RlbXBvcmFkYXMnLCAndGVtcG9yYWRhJytzdHIoaSsxKSsnLnBuZycpKQoJCgl2aXN0YV90ZW1wb3JhZGFzKCkKCmRlZiBnZXRFcGlzb2RlczIodXJsKToKCXJlc3VsdGFkbyA9IGRldm9sdmVyZXN1bHRhZG8odXJsKQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pCglmb3IgaSBpbiByZXN1bHRhZG9bJ2l0ZW0nXToKCQlwdCA9ICcnCgkJYnIgPSAnJwoJCWZpbmFsID0gJycKCQlzZW1MZWdlbmRhID0gJycKCQkKCQl2aXN0byA9IEZhbHNlCgkJY29yID0gJ3doaXRlJwoJCQoJCW5vbWUgPSAnJwoJCXRyeTogbm9tZSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnTm9tZSddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQoJCWltZGIgPSAnJwoJCXRyeTogaW1kYiA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnSW1kYiddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQkKCQlpbWFnZW0gPSAnJwoJCXRyeTogaW1hZ2VtID0gYmFzZTY0LmI2NGRlY29kZShpWydJbWFnZW0nXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OiBwYXNzCgkJCgkJbGVnZW5kYXMgPSAnJwoJCXRyeTogbGVnZW5kYXMgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0xlZ2VuZGFzJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCQoJCWFub3MgPSBpWydBbm9Ob3ZvJ10KCQoJCWlmICdodHRwJyBub3QgaW4gaW1hZ2VtOgoJCQlpbWFnZW0gPSBfX0FQSV9fK2ltYWdlbQoJCgkJaWYgbGVnZW5kYXMgPT0gInNlbWxlZ2VuZGEiIG9yIGlbJ0xlZ2VuZGFzJ10gPT0gIiI6CgkJCXNlbUxlZ2VuZGEgPSAnW0NPTE9SIHJlZF1bQl1TLyBMRUdFTkRBIFsvQl1bL0NPTE9SXScKCQkKCQllcGlzb2RpbyA9IGlbJ0VwaXNvZGlvJ10KCQl0ZW1wb3JhZGEgPSBpWydUZW1wb3JhZGEnXQoJCWlkX3ZpZGVvID0gaVsnSUQnXQoJCQoJCWluZm9MYWJlbHMgPSB7J1RpdGxlJzogbm9tZSwgJ0NvZGUnOiBpbWRiLCAnRXBpc29kZSc6IGVwaXNvZGlvLCAnU2Vhc29uJzogdGVtcG9yYWRhIH0KCQlub21lZWUgPSBwdCticitmaW5hbCtzZW1MZWdlbmRhKydbQ09MT1IgJytjb3IrJ11bQl1FcGlzb2RpbyAnK3N0cihlcGlzb2RpbykrJ1svQl1bL0NPTE9SXSAnK3JlbW92ZXJBY2VudG9zKG5vbWUpCgkJCgkJdXJsbm9vID0gX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89c2VyaWVzJmdlbmVybz1nZXRfdmlkZW8mYWRkb249MSZwZXNxdWlzYT0nK3N0cihpZF92aWRlbykKCQlmb3Rvb28gPSBpbWFnZW0KCQlmYW5hcnR0dCA9IF9fQVBJX18rJ2ltYWdlcy9iYWNrZ3JvdW5kLycraW1kYisnLmpwZycKCQlhZGRWaWRlbyhub21lZWUsIHVybG5vbywgMTExMTMsIGltYWdlbSwgdmlzdG8sICdlcGlzb2RpbycsIHRlbXBvcmFkYSwgZXBpc29kaW8sIGluZm9MYWJlbHMsIGZhbmFydHR0KQoJCgl2aXN0YV9lcGlzb2Rpb3MoKQoKZGVmIHBsYXllcjIobmFtZSwgdXJsLCBpY29uaW1hZ2UsIG1vZG8sIHRlbXBvcmFkYSwgZXBpc29kaW8sIHRpcG9sb2dpKToKCXJlc3VsdGFkbyA9IGRldm9sdmVyZXN1bHRhZG8odXJsKQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pCglpbmZvbGFiZWxzID0gZGljdCgpCglwYXN0YURhdGEgPSAnJwoJbm9tZSA9ICcnCglpZFZpZGVvID0gJzAnCgltZW5zYWdlbXByb2dyZXNzbyA9IHhibWNndWkuRGlhbG9nUHJvZ3Jlc3MoKQoJbWVuc2FnZW1wcm9ncmVzc28uY3JlYXRlKEFkZG9uVGl0bGUsIHUnQWJyaXIgZW1pc3PDo28nLCdQb3IgZmF2b3IgYWd1YXJkZS4uLicpCgltZW5zYWdlbXByb2dyZXNzby51cGRhdGUoMjUsICIiLCB1J09idGVyIHZpZGVvIGUgbGVnZW5kYScsICIiKQoKCXN0cmVhbSwgbGVnZW5kYSwgZXh0X2cgPSBnZXRTdHJlYW1MZWdlbmRhMihyZXN1bHRhZG9bMF0sdGlwb2xvZ2kpCglpZiBzdHJlYW0gPT0gRmFsc2UgYW5kIGxlZ2VuZGEgPT0gMjA0OgoJCW1lbnNhZ2VtcHJvZ3Jlc3NvLmNsb3NlKCkKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdBbGd1bSBlcnJvLiBUZW50ZSBtYWlzIHRhcmRlJykKCQlyZXR1cm4gRmFsc2UKCWVsc2U6CgkJbWVuc2FnZW1wcm9ncmVzc28udXBkYXRlKDUwLCAiIiwgdSdQcmVwYXJhLXRlLCB2YWkgY29tZcOnYXIhJywgIiIpCgkJcGxheWxpc3QgPSB4Ym1jLlBsYXlMaXN0KDEpCgkJcGxheWxpc3QuY2xlYXIoKQoJCWxpc3RpdGVtID0geGJtY2d1aS5MaXN0SXRlbShuYW1lLCBpY29uSW1hZ2U9IkRlZmF1bHRWaWRlby5wbmciLCB0aHVtYm5haWxJbWFnZT1pY29uaW1hZ2UpCgoJCWxpc3RpdGVtLnNldEluZm8odHlwZT0iVmlkZW8iLCBpbmZvTGFiZWxzPWluZm9sYWJlbHMpCgkJbGlzdGl0ZW0uc2V0UHJvcGVydHkoJ21pbWV0eXBlJywgJ3ZpZGVvL3gtbXN2aWRlbycpCgkJbGlzdGl0ZW0uc2V0UHJvcGVydHkoJ0lzUGxheWFibGUnLCAndHJ1ZScpCgkJCgkJbGlzdGl0ZW0uc2V0UGF0aChwYXRoPXN0cmVhbSkKCQlwbGF5bGlzdC5hZGQoc3RyZWFtLCBsaXN0aXRlbSkKCQl4Ym1jcGx1Z2luLnNldFJlc29sdmVkVXJsKGludChzeXMuYXJndlsxXSksIFRydWUsIGxpc3RpdGVtKQoJCW1lbnNhZ2VtcHJvZ3Jlc3NvLnVwZGF0ZSg3NSwgIiIsIHUnQm9hIFNlc3PDo28hISEnLCAiIikKCgkJaWYgc3RyZWFtID09IEZhbHNlOgoJCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdPIHNlcnZpZG9yIGVzY29saGlkbyBuw6NvIGRpc3BvbsOtdmVsLCBlc2NvbGhhIG91dHJvIG91IHRlbnRlIG5vdmFtZW50ZSBtYWlzIHRhcmRlLicpCgkJZWxzZToKCQkJcGxheWVyX21yID0gUGxheWVyLlBsYXllcih1cmw9dXJsLCBpZEZpbG1lPWlkVmlkZW8sIHBhc3RhRGF0YT1fX1BBU1RBX0RBRE9TX18sIHRlbXBvcmFkYT10ZW1wb3JhZGEsIGVwaXNvZGlvPWVwaXNvZGlvLCBub21lPW5hbWUsIGxvZ289b3MucGF0aC5qb2luKF9fQURET05fRk9MREVSX18sJ2ljb24ucG5nJykpCgkJCW1lbnNhZ2VtcHJvZ3Jlc3NvLmNsb3NlKCkKCQkJcGxheWVyX21yLnBsYXkocGxheWxpc3QpCgkJCXBsYXllcl9tci5zZXRTdWJ0aXRsZXMobGVnZW5kYSkKCQkJd2hpbGUgcGxheWVyX21yLnBsYXlpbmc6CgkJCQl4Ym1jLnNsZWVwKDUwMDApCgkJCQkjcGxheWVyX21yLnRyYWNrZXJUZW1wbygpCgpkZWYgZ2V0U3RyZWFtTGVnZW5kYTIodHVkb2luZm8sdGlwb29vKToKCXJlc3VsdGFkbyA9IHR1ZG9pbmZvCglpID0gMAoJc2Vydmlkb3JlcyA9IFtdCgl0aXR1bG9zID0gW10KCW5vbWUgPSAnJwoJdXJsMSA9ICcnCgl0cnk6IHVybDEgPSBiYXNlNjQuYjY0ZGVjb2RlKHJlc3VsdGFkb1snVXJsJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgl1cmwyID0gJycKCXRyeTogdXJsMiA9IGJhc2U2NC5iNjRkZWNvZGUocmVzdWx0YWRvWydVcmwxJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgl1cmwzID0gJycKCXRyeTogdXJsMyA9IGJhc2U2NC5iNjRkZWNvZGUocmVzdWx0YWRvWydVcmwyJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgl1cmw0ID0gJycKCXRyeTogdXJsNCA9IGJhc2U2NC5iNjRkZWNvZGUocmVzdWx0YWRvWydVcmwzJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgl1cmw1ID0gJycKCXRyeTogdXJsNSA9IGJhc2U2NC5iNjRkZWNvZGUocmVzdWx0YWRvWydVcmw0J10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCWlmIHVybDEgIT0gJyc6CgkJaSs9MQoJCWlmICdvbG9hZCcgaW4gdXJsMSBvciAnb3BlbmxvYWQnIGluIHVybDE6CgkJCW5vbWUgPSAiT3BlbkxvYWQiCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDEpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICd2aWR6aScgaW4gdXJsMToKCQkJbm9tZSA9ICdWaWR6aScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ2dvb2dsZScgaW4gdXJsMSBvciAnY2xvdWQubWFpbC5ydScgaW4gdXJsMSBvciAnLm1wNCcgaW4gdXJsMSBvciAnLmF2aScgaW4gdXJsMToKCQkJbm9tZSA9IEFkZG9uVGl0bGUKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3VwdG9zdHJlYW0uY29tJyBpbiB1cmwxOgoJCQlub21lID0gJ1VwVG9TdHJlYW0nCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDEpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICdyYXBpZHZpZGVvLmNvbScgaW4gdXJsMSBvciAncmFwdHUnIGluIHVybDE6CgkJCW5vbWUgPSAnUmFwdHUnCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDEpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICd2aWRvemEubmV0JyBpbiB1cmwxOgoJCQlub21lID0gJ1ZpZG96YScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3N0cmVhbWFuZ28uJyBpbiB1cmwxOgoJCQlub21lID0gJ1N0cmVhbWFuZ28nCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDEpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICd2ZXJ5c3RyZWFtLicgaW4gdXJsMToKCQkJbm9tZSA9ICdWZXJ5U3RyZWFtJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwxKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCglpZiB1cmwyICE9ICcnOgoJCWkrPTEKCQlpZiAnb2xvYWQnIGluIHVybDIgb3IgJ29wZW5sb2FkJyBpbiB1cmwyOgoJCQlub21lID0gIk9wZW5Mb2FkIgoJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwyKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAndmlkemknIGluIHVybDI6CgkJCW5vbWUgPSAnVmlkemknCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDIpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICdnb29nbGUnIGluIHVybDIgb3IgJ2Nsb3VkLm1haWwucnUnIGluIHVybDIgb3IgJy5tcDQnIGluIHVybDIgb3IgJy5hdmknIGluIHVybDI6CgkJCW5vbWUgPSBBZGRvblRpdGxlCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDIpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICd1cHRvc3RyZWFtLmNvbScgaW4gdXJsMjoKCQkJbm9tZSA9ICdVcFRvU3RyZWFtJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwyKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAncmFwaWR2aWRlby5jb20nIGluIHVybDIgb3IgJ3JhcHR1JyBpbiB1cmwyOgoJCQlub21lID0gJ1JhcHR1JwoJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwyKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAndmlkb3phLm5ldCcgaW4gdXJsMjoKCQkJbm9tZSA9ICdWaWRvemEnCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDIpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICdzdHJlYW1hbmdvLicgaW4gdXJsMjoKCQkJbm9tZSA9ICdTdHJlYW1hbmdvJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwyKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAndmVyeXN0cmVhbS4nIGluIHVybDI6CgkJCW5vbWUgPSAnVmVyeVN0cmVhbScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMikKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQkKCXRyeToKCQlpZiB1cmwzICE9ICcnOgoJCQlpKz0xCgkJCWlmICdvbG9hZCcgaW4gdXJsMyBvciAnb3BlbmxvYWQnIGluIHVybDM6CgkJCQlub21lID0gIk9wZW5Mb2FkIgoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMykKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndmlkemknIGluIHVybDM6CgkJCQlub21lID0gJ1ZpZHppJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMykKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAnZ29vZ2xlJyBpbiB1cmwzIG9yICdjbG91ZC5tYWlsLnJ1JyBpbiB1cmwzIG9yICcubXA0JyBpbiB1cmwzIG9yICcuYXZpJyBpbiB1cmwzOgoJCQkJbm9tZSA9IEFkZG9uVGl0bGUKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDMpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3VwdG9zdHJlYW0uY29tJyBpbiB1cmwzOgoJCQkJbm9tZSA9ICdVcFRvU3RyZWFtJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMykKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAncmFwaWR2aWRlby5jb20nIGluIHVybDMgb3IgJ3JhcHR1JyBpbiB1cmwzOgoJCQkJbm9tZSA9ICdSYXB0dScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDMpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3ZpZG96YS5uZXQnIGluIHVybDM6CgkJCQlub21lID0gJ1ZpZG96YScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDMpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3N0cmVhbWFuZ28uJyBpbiB1cmwzOgoJCQkJbm9tZSA9ICdTdHJlYW1hbmdvJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMykKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndmVyeXN0cmVhbS4nIGluIHVybDM6CgkJCQlub21lID0gJ1ZlcnlTdHJlYW0nCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwzKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJZXhjZXB0OgoJCXBhc3MKCXRyeToKCQlpZiB1cmw0ICE9ICcnOgoJCQlpKz0xCgkJCWlmICdvbG9hZCcgaW4gdXJsNCBvciAnb3BlbmxvYWQnIGluIHVybDQ6CgkJCQlub21lID0gIk9wZW5Mb2FkIgoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsNCkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndmlkemknIGluIHVybDQ6CgkJCQlub21lID0gJ1ZpZHppJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsNCkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAnZ29vZ2xlJyBpbiB1cmw0IG9yICdjbG91ZC5tYWlsLnJ1JyBpbiB1cmw0IG9yICcubXA0JyBpbiB1cmw0IG9yICcuYXZpJyBpbiB1cmw0OgoJCQkJbm9tZSA9IEFkZG9uVGl0bGUKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDQpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3VwdG9zdHJlYW0uY29tJyBpbiB1cmw0OgoJCQkJbm9tZSA9ICdVcFRvU3RyZWFtJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsNCkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAncmFwaWR2aWRlby5jb20nIGluIHVybDQgb3IgJ3JhcHR1JyBpbiB1cmw0OgoJCQkJbm9tZSA9ICdSYXB0dScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDQpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3ZpZG96YS5uZXQnIGluIHVybDQ6CgkJCQlub21lID0gJ1ZpZG96YScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDQpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3N0cmVhbWFuZ28uJyBpbiB1cmw0OgoJCQkJbm9tZSA9ICdTdHJlYW1hbmdvJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsNCkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndmVyeXN0cmVhbS4nIGluIHVybDQ6CgkJCQlub21lID0gJ1ZlcnlTdHJlYW0nCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw0KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJZXhjZXB0OgoJCXBhc3MKCQoJdHJ5OgoJCWlmIHVybDUgIT0gJyc6CgkJCWkrPTEKCQkJaWYgJ29sb2FkJyBpbiB1cmw1IG9yICdvcGVubG9hZCcgaW4gdXJsNToKCQkJCW5vbWUgPSAiT3BlbkxvYWQiCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw1KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd2aWR6aScgaW4gdXJsNToKCQkJCW5vbWUgPSAnVmlkemknCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw1KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdnb29nbGUnIGluIHVybDUgb3IgJ2Nsb3VkLm1haWwucnUnIGluIHVybDUgb3IgJy5tcDQnIGluIHVybDUgb3IgJy5hdmknIGluIHVybDU6CgkJCQlub21lID0gQWRkb25UaXRsZQoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsNSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndXB0b3N0cmVhbS5jb20nIGluIHVybDU6CgkJCQlub21lID0gJ1VwVG9TdHJlYW0nCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw1KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdyYXBpZHZpZGVvLmNvbScgaW4gdXJsNSBvciAncmFwdHUnIGluIHVybDU6CgkJCQlub21lID0gJ1JhcHR1JwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsNSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndmlkb3phLm5ldCcgaW4gdXJsNToKCQkJCW5vbWUgPSAnVmlkb3phJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsNSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAnc3RyZWFtYW5nby4nIGluIHVybDU6CgkJCQlub21lID0gJ1N0cmVhbWFuZ28nCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw1KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd2ZXJ5c3RyZWFtLicgaW4gdXJsNToKCQkJCW5vbWUgPSAnVmVyeVN0cmVhbScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDUpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCglleGNlcHQ6CgkJcGFzcwoJCglzdHJlYW0gPSAnJwoJbGVnZW5kYSA9ICcnCglsZWdlbmRhbm92YSA9ICcnCgl0cnk6CgkJbGVnZW5kYW5vdmEgPSBiYXNlNjQuYjY0ZGVjb2RlKHJlc3VsdGFkb1snTGVnZW5kYXMnXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6CgkJcGFzcwoJCglpZiAnbGl2ZWl0JyBpbiBsZWdlbmRhbm92YToKCQlsZWdlbmRhID0gJycKCWVsaWYgJ2h0dHAnIGluIGxlZ2VuZGFub3ZhOgoJCWxlZ2VuZGEgPSBsZWdlbmRhbm92YQoJZWxpZiAnc3Vicy8nIGluIGxlZ2VuZGFub3ZhOgoJCWxlZ2VuZGEgPSBfX0FQSV9fK2xlZ2VuZGFub3ZhCgllbHNlOgoJCWxlZ2VuZGEgPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsgImxlZ2VuZGFzLyIgK2xlZ2VuZGFub3ZhCgkKCWV4dF9nID0gJ2NvaXNvJwoJbGVnZW5kYUF1eCA9IGxlZ2VuZGEKCXNlcnZpZG9yID0gMAoJaWYgbGVuKHRpdHVsb3MpID4gMToKCQlzZXJ2aWRvciA9IHhibWNndWkuRGlhbG9nKCkuc2VsZWN0KCdFc2NvbGhhIG8gc2Vydmlkb3InLCB0aXR1bG9zKQoJZWxzZToKCQlzZXJ2aWRvciA9IDAKCQoJaWYgJ3ZpZHppJyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQl2aWR6aSA9IFVSTFJlc29sdmVyTWVkaWEuVmlkemkoc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pCgkJc3RyZWFtID0gdmlkemkuZ2V0TWVkaWFVcmwoKQoJCWxlZ2VuZGEgPSB2aWR6aS5nZXRTdWJ0aXRsZSgpCgllbGlmICd1cHRvc3RyZWFtLmNvbScgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJc3RyZWFtID0gVVJMUmVzb2x2ZXJNZWRpYS5VcFRvU3RyZWFtKHNlcnZpZG9yZXNbc2Vydmlkb3JdKS5nZXRNZWRpYVVybCgpCgllbGlmICdzZXJ2ZXIubXJwaXJhY3kud2luJyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQlzdHJlYW0gPSBzZXJ2aWRvcmVzW3NlcnZpZG9yXQoJZWxpZiAnb2xvYWQnIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXN0cmVhbSA9IFVSTFJlc29sdmVyTWVkaWEuT3BlbkxvYWQoc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pLmdldE1lZGlhVXJsKCkKCQlsZWdlbmRhID0gVVJMUmVzb2x2ZXJNZWRpYS5PcGVuTG9hZChzZXJ2aWRvcmVzW3NlcnZpZG9yXSkuZ2V0U3VidGl0bGUoKQoJCWlmIG5vdCAnLnZ0dCcgaW4gbGVnZW5kYSBvciBsZWdlbmRhID09ICcnOgoJCQlsZWdlbmRhID0gbGVnZW5kYUF1eAoJZWxpZiAnZHJpdmUuZ29vZ2xlLmNvbS8nIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXN0cmVhbSwgZXh0X2cgPSBVUkxSZXNvbHZlck1lZGlhLkdvb2dsZVZpZGVvKHNlcnZpZG9yZXNbc2Vydmlkb3JdKS5nZXRNZWRpYVVybCgpCgllbGlmICdjbG91ZC5tYWlsLnJ1JyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQlzdHJlYW0sIGV4dF9nID0gVVJMUmVzb2x2ZXJNZWRpYS5DbG91ZE1haWxSdShzZXJ2aWRvcmVzW3NlcnZpZG9yXSkuZ2V0TWVkaWFVcmwoKQoJZWxpZiAncmFwaWR2aWRlby5jb20nIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdIG9yICdyYXB0dScgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJcmFwaWQgPSBVUkxSZXNvbHZlck1lZGlhLlJhcGlkVmlkZW8oc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pCgkJc3RyZWFtID0gcmFwaWQuZ2V0TWVkaWFVcmwoKQoJCWxlZ2VuZGEgPSByYXBpZC5nZXRMZWdlbmRhKCkKCWVsaWYgJ3ZpZG96YS5uZXQnIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXZpZG96ID0gVVJMUmVzb2x2ZXJNZWRpYS5WaWRvemEoc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pCgkJc3RyZWFtID0gdmlkb3ouZ2V0TWVkaWFVcmwoKQoJCWxlZ2VuZGEgPSB2aWRvei5nZXRMZWdlbmRhKCkKCWVsaWYgJ3N0cmVhbWFuZ28uJyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQlzdHJlYW1hbiA9IFVSTFJlc29sdmVyTWVkaWEuU3RyZWFtYW5nbyhzZXJ2aWRvcmVzW3NlcnZpZG9yXSkKCQlzdHJlYW0gPSBzdHJlYW1hbi5nZXRNZWRpYVVybCgpCgkJbGVnZW5kYSA9IHN0cmVhbWFuLmdldExlZ2VuZGEoKQoJZWxpZiAndmVyeXN0cmVhbS4nIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXN0cmVhbWFuID0gVVJMUmVzb2x2ZXJNZWRpYS5WZXJ5U3RyZWFtKHNlcnZpZG9yZXNbc2Vydmlkb3JdKQoJCXN0cmVhbSA9IHN0cmVhbWFuLmdldE1lZGlhVXJsKCkKCQlsZWdlbmRhID0gc3RyZWFtYW4uZ2V0TGVnZW5kYSgpCgllbHNlOgoJCXN0cmVhbSA9IHNlcnZpZG9yZXNbc2Vydmlkb3JdCglyZXR1cm4gc3RyZWFtLCBsZWdlbmRhLCBleHRfZwoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMJCQkJCQkJCQkJCQlBZGRvbiBGaWxtZXMgZSBTZXJpZXMJCQkJCQkJCQkgICMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpkZWYgbGlzdGFtZW51c3Nlcmllcyhub21lX25vdix1cmwsZXN0aWxvLHRpcG8sdGlwb191c2VyLHNlcnZpZG9yX3VzZXIsaWNvbmltYWdlLGZhbmFydCk6CgljaGVja19sb2dpbiA9IGxvZ2luMigpCglpZiBjaGVja19sb2dpbiA9PSBUcnVlOgoJCWRhdGFiYXNlID0gRGF0YWJhc2UuaXNFeGlzdHMoKQoJCW1lbnVTZXJpZXMob3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Nlcmllcy5wbmcnKSxfX1NJVEVBZGRvbl9fKydJbWFnZW5zL3Nlcmllc19mYW5hcnQucG5nJykKCWVsc2U6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnRXJybyBhIGZhemVyIGxvZ2luIG5lc3RhIHBhcnRlLiBUZW50ZSBub3ZhbWVudGUgbWFpcyB0YXJkZS4nKQoKZGVmIGxpc3RhbWVudXNmaWxtZXMobm9tZV9ub3YsdXJsLGVzdGlsbyx0aXBvLHRpcG9fdXNlcixzZXJ2aWRvcl91c2VyLGljb25pbWFnZSxmYW5hcnQpOgoJY2hlY2tfbG9naW4gPSBsb2dpbjIoKQoJaWYgY2hlY2tfbG9naW4gPT0gVHJ1ZToKCQlkYXRhYmFzZSA9IERhdGFiYXNlLmlzRXhpc3RzKCkKCQltZW51RmlsbWVzKG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmaWxtZXMucG5nJyksX19TSVRFQWRkb25fXysnSW1hZ2Vucy9maWxtZXNfZmFuYXJ0LnBuZycpCgllbHNlOgoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0Vycm8gYSBmYXplciBsb2dpbiBuZXN0YSBwYXJ0ZS4gVGVudGUgbm92YW1lbnRlIG1haXMgdGFyZGUuJykKCmRlZiBsaXN0YW1lbnVzYW5pbWVzKG5vbWVfbm92LHVybCxlc3RpbG8sdGlwbyx0aXBvX3VzZXIsc2Vydmlkb3JfdXNlcixpY29uaW1hZ2UsZmFuYXJ0KToKCWNoZWNrX2xvZ2luID0gbG9naW4yKCkKCWlmIGNoZWNrX2xvZ2luID09IFRydWU6CgkJZGF0YWJhc2UgPSBEYXRhYmFzZS5pc0V4aXN0cygpCgkJbWVudUFuaW1lcyhvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnYW5pbWVzLnBuZycpLF9fU0lURUFkZG9uX18rJ0ltYWdlbnMvc2VyaWVzX2ZhbmFydC5wbmcnKQoJZWxzZToKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdFcnJvIGEgZmF6ZXIgbG9naW4gbmVzdGEgcGFydGUuIFRlbnRlIG5vdmFtZW50ZSBtYWlzIHRhcmRlLicpCgpkZWYgbWVudUZpbG1lcyhpY29uaW1hZ2UsZmFuYXJ0KToKCWFkZERpcjIoJ1RvZG9zIG9zIEZpbG1lcycsIF9fQVBJX1NJVEVfXysnZmlsbWVzLnBocD9xdWFsaWRhZGU9JytfX1F1YWxpZGFkZV9fLCAxMTEsICdmaWxtZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ0ZpbG1lcyBlbSBEZXN0YXF1ZScsICBfX0FQSV9TSVRFX18rJ2ZpbG1lcy5waHA/YWN0aW9uPWRlc3RhcXVlJnF1YWxpZGFkZT0nK19fUXVhbGlkYWRlX18sIDExMSwgJ2ZpbG1lcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignRmlsbWVzIHBvciBBbm8nLCBfX0FQSV9TSVRFX18rJ2ZpbG1lcy5waHA/YWN0aW9uPWFubycsIDExOSwgJ2xpc3RhZ2VtQW5vcycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdhbm8ucG5nJyksIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ0ZpbG1lcyBwb3IgR2VuZXJvJywgX19BUElfU0lURV9fKydmaWxtZXMucGhwP2FjdGlvbj1jYXRlZ29yaWEnLCAxMTgsICdsaXN0YWdlbUdlbmVyb3MnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZ2VuZXJvLnBuZycpLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdGaWxtZXMgcG9yIElNREIgUmFraW5nJywgIF9fQVBJX1NJVEVfXysnZmlsbWVzLnBocD9hY3Rpb249aW1kYlJhbmsmcXVhbGlkYWRlPScrX19RdWFsaWRhZGVfXywgMTExLCAnZmlsbWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdGaWxtZXMgUGFyYSBDcmlhbsOnYXMnLCAgX19BUElfU0lURV9fKydmaWxtZXMucGhwP2FjdGlvbj1wdCZxdWFsaWRhZGU9JytfX1F1YWxpZGFkZV9fLCAxMTEsICdmaWxtZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCQoJdmlzdGFfbWVudSgpCgpkZWYgbWVudVNlcmllcyhpY29uaW1hZ2UsZmFuYXJ0KToKCWFkZERpcjIoJ1RvZGFzIGFzIFNlcmllcycsIF9fQVBJX1NJVEVfXysnc2VyaWVzLnBocCcsIDEyMywgJ3NlcmllcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignU2VyaWVzIGVtIERlc3RhcXVlJywgIF9fQVBJX1NJVEVfXysnc2VyaWVzLnBocD9hY3Rpb249ZGVzdGFxdWUnLCAxMjMsICdzZXJpZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ1NlcmllcyBwb3IgQW5vJywgX19BUElfU0lURV9fKydzZXJpZXMucGhwP2FjdGlvbj1hbm8nLCAxMTksICdsaXN0YWdlbUFub3MnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnYW5vLnBuZycpLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdTZXJpZXMgcG9yIEdlbmVybycsIF9fQVBJX1NJVEVfXysnc2VyaWVzLnBocD9hY3Rpb249Y2F0ZWdvcmlhJywgMTE4LCAnbGlzdGFnZW1HZW5lcm9zJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2dlbmVyby5wbmcnKSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoKCXZpc3RhX21lbnUoKQoKZGVmIG1lbnVBbmltZXMoaWNvbmltYWdlLGZhbmFydCk6CglhZGREaXIyKCdUb2RvcyBvcyBBbmltZXMnLCBfX0FQSV9TSVRFX18rJ2FuaW1lcy5waHAnLCAxMjMsICdhbmltZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ0FuaW1lcyBlbSBEZXN0YXF1ZScsICBfX0FQSV9TSVRFX18rJ2FuaW1lcy5waHA/YWN0aW9uPWRlc3RhcXVlJywgMTIzLCAnYW5pbWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdBbmltZXMgcG9yIEFubycsIF9fQVBJX1NJVEVfXysnYW5pbWVzLnBocD9hY3Rpb249YW5vJywgMTE5LCAnbGlzdGFnZW1Bbm9zJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Fuby5wbmcnKSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignQW5pbWVzIHBvciBHZW5lcm8nLCBfX0FQSV9TSVRFX18rJ2FuaW1lcy5waHA/YWN0aW9uPWNhdGVnb3JpYScsIDExOCwgJ2xpc3RhZ2VtR2VuZXJvcycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdnZW5lcm8ucG5nJyksIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCgl2aXN0YV9tZW51KCkKCmRlZiBnZXRMaXN0Q2F0ZWdvcmlhKCk6CgljYXQgPSBsZXJfZmljaGVpcm8ob3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnY2F0ZWdvcmlhcy5saXZlaXQnKSkucmVwbGFjZSgnIicsICInIikKCXJldHVybiBjYXQKCmRlZiByZW1vdmVyQWNlbnRvcyh0eHQsIGVuY29kaW5nPSd1dGYtOCcpOgoJcmV0dXJuIG5vcm1hbGl6ZSgnTkZLRCcsIHR4dC5kZWNvZGUoZW5jb2RpbmcpKS5lbmNvZGUoJ0FTQ0lJJywnaWdub3JlJykKCmRlZiBlc2NyZXZlcl9maWNoZWlybyhmaWNoZWlybywgY29udGV1ZG8pOgogICAgZiA9IG9wZW4oZmljaGVpcm8sIG1vZGU9InciKQogICAgZi53cml0ZShjb250ZXVkbykKICAgIGYuY2xvc2UoKQoKZGVmIGxlcl9maWNoZWlybyhmaWNoZWlybyk6CiAgICBmID0gb3BlbihmaWNoZWlybywgInIiKQogICAgY29udGV1ZG8gPSAgZi5yZWFkKCkKICAgIGYuY2xvc2UoKQogICAgcmV0dXJuIGNvbnRldWRvCgpkZWYgZ2V0Q2F0ZWdvcmlhKGlkKToKCWNhdCA9IGxlcl9maWNoZWlybyhvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdjYXRlZ29yaWFzLmxpdmVpdCcpKS5yZXBsYWNlKCciJywgIiciKQoJZm9yIGMgaW4gYXN0LmxpdGVyYWxfZXZhbChjYXQpOgoJCWlmIGludChpZCkgPT0gMDoKCQkJcmV0dXJuICcnCgkJaWYgaW50KGNbJ2lkX2NhdGVnb3JpYSddKSA9PSBpbnQoaWQpOgoJCQl0cnk6CgkJCQljYXQgPSBjWydjYXRlZ29yaWFzJ10uZGVjb2RlKCd1dGYtOCcpCgkJCWV4Y2VwdDoKCQkJCWNhdCA9IGNbJ2NhdGVnb3JpYXMnXS5lbmNvZGUoJ3V0Zi04JykKCQkJcmV0dXJuIGNhdAoJCgkiIiJpZiBpbnQoaWQpID09IDA6CgkJcmV0dXJuICcnCgkKCWZvciBjLCBpIGluIGNhdHM6CgkJaWYgaW50KGkpID09IGludChpZCk6CgkJCXJldHVybiBjIiIiCgoJcmV0dXJuICcnCgkKZGVmIGdldENvb2tpZSgpOgoJcmV0dXJuICd1c2VybmFtZT0nK19fQURET05fXy5nZXRTZXR0aW5nKCd0b2tlbk1ycGlyYWN5JykKCmRlZiB2ZXJpZmljYXJWaXN0b0xvY2FsKGlkVmlkZW8sIHRlbXBvcmFkYT1Ob25lLCBlcGlzb2Rpbz1Ob25lKToKCXBhc3RhVmlzdG89b3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywndmlzdG9zJykKCglpZiB0ZW1wb3JhZGEgYW5kIGVwaXNvZGlvOgoJCWZpY2hlaXJvVmlzdG8gPSBvcy5wYXRoLmpvaW4ocGFzdGFWaXN0byxzdHIoaWRWaWRlbykrJ19TJytzdHIodGVtcG9yYWRhKSsneCcrc3RyKGVwaXNvZGlvKSsnLmxpdmVpdCcpCgllbHNlOgoJCWZpY2hlaXJvVmlzdG8gPSBvcy5wYXRoLmpvaW4ocGFzdGFWaXN0byxzdHIoaWRWaWRlbykrJy5saXZlaXQnKQoKCWlmIG9zLnBhdGguZXhpc3RzKGZpY2hlaXJvVmlzdG8pOgoJCXJldHVybiBUcnVlCgllbHNlOgoJCXJldHVybiBGYWxzZQoKZGVmIGZpbG1lcyh1cmwsIHBhZ2luYSk6CgkjaGVhZGVyc1snQXV0aG9yaXphdGlvbiddID0gJ0JlYXJlciAlcycgJSBfX0FERE9OX18uZ2V0U2V0dGluZygndG9rZW5NcnBpcmFjeScpCgkjaWYgcmVzdWx0YWRvID09ICdETlMnOgoJIwlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdUZW0gZGUgYWx0ZXJhciBvcyBETlMgcGFyYSBwb2RlciB1c3VmcnVpciBkbyBfX0FERE9OX18uJykKCSMJcmV0dXJuIEZhbHNlCglyZXN1bHRhZG8gPSBhYnJpcl91cmwodXJsLCBoZWFkZXI9aGVhZGVycywgY29va2llPWdldENvb2tpZSgpKQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pCgl2aXN0b3MgPSBEYXRhYmFzZS5zZWxlY3RGaWxtZXMoKQoJb3BjYW8gPSBfX0FERE9OX18uZ2V0U2V0dGluZygnbWFyY2FyVmlzdG8nKQoJZm9yIGkgaW4gcmVzdWx0YWRvWydkYXRhJ106CgkJc2V0RmlsbWUoaSwgdmlzdG9zLCBvcGNhbykKCXRyeTogCgkJY3VycmVudCA9IHJlc3VsdGFkb1snbWV0YSddWydjdXJyZW50J10KCWV4Y2VwdDogCgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnQWd1YXJkZSBwZWxhIHByw7N4aW1hIGF0dWFsaXphw6fDo28uIE91IHRlbnRlIG1haXMgdGFyZGUuJykKCQlyZXR1cm4gRmFsc2UKCWN1cnJlbnQgPSByZXN1bHRhZG9bJ21ldGEnXVsnY3VycmVudCddCgl0b3RhbCA9IHJlc3VsdGFkb1snbWV0YSddWyd0b3RhbCddCgl0cnk6IHByb3hpbW8gPSByZXN1bHRhZG9bJ21ldGEnXVsncGFnaW5hY2FvJ11bJ25leHQnXQoJZXhjZXB0OiBwYXNzIAoJaWYgaW50KGN1cnJlbnQpIDwgaW50KHRvdGFsKToKCQlhZGREaXIyKCdQcsOzeGltYSBww6FnaW5hICgnK3N0cihjdXJyZW50KSsnLycrc3RyKHRvdGFsKSsnKScsIHByb3hpbW8sIDExMSwgJ2ZpbG1lcycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdwcm94aW1vLnBuZycpLDEpCgl2aXN0YV9maWxtZXNTZXJpZXMoKQoJCQpkZWYgc2VyaWVzKHVybCk6CgkjaGVhZGVyc1snQXV0aG9yaXphdGlvbiddID0gJ0JlYXJlciAlcycgJSBfX0FERE9OX18uZ2V0U2V0dGluZygndG9rZW5NcnBpcmFjeScpCgkjaWYgcmVzdWx0YWRvID09ICdETlMnOgoJIwlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdUZW0gZGUgYWx0ZXJhciBvcyBETlMgcGFyYSBwb2RlciB1c3VmcnVpciBkbyBfX0FERE9OX18uJykKCSMJcmV0dXJuIEZhbHNlCglyZXN1bHRhZG8gPSBhYnJpcl91cmwodXJsLCBoZWFkZXI9aGVhZGVycywgY29va2llPWdldENvb2tpZSgpKQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pCglpZiAnc2VyaWUnIGluIHVybDoKCQl0aXBvID0gJ3NlcmllJwoJZWxpZiAnYW5pbWUnIGluIHVybDoKCQl0aXBvID0gJ2FuaW1lJwoJCQoJaWYgJ3NlcmllJyBpbiB1cmw6CgkJdGlwbyA9ICdzZXJpZXMnCgllbGlmICdhbmltZScgaW4gdXJsOgoJCXRpcG8gPSAnYW5pbWVzJwoJdmlzdG9zID0gRGF0YWJhc2Uuc2VsZWN0RmlsbWVzKCkKCW9wY2FvID0gX19BRERPTl9fLmdldFNldHRpbmcoJ21hcmNhclZpc3RvJykKCWZvciBpIGluIHJlc3VsdGFkb1snZGF0YSddOgoJCXNldFNlcmllcyhpLCB2aXN0b3MsIG9wY2FvLCB0aXBvKQoJdHJ5OiAKCQljdXJyZW50ID0gcmVzdWx0YWRvWydtZXRhJ11bJ2N1cnJlbnQnXQoJZXhjZXB0OiAKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdBZ3VhcmRlIHBlbGEgcHLDs3hpbWEgYXR1YWxpemHDp8Ojby4gT3UgdGVudGUgbWFpcyB0YXJkZS4nKQoJCXJldHVybiBGYWxzZQoJY3VycmVudCA9IHJlc3VsdGFkb1snbWV0YSddWydjdXJyZW50J10KCXRvdGFsID0gcmVzdWx0YWRvWydtZXRhJ11bJ3RvdGFsJ10KCXRyeTogcHJveGltbyA9IHJlc3VsdGFkb1snbWV0YSddWydwYWdpbmFjYW8nXVsnbmV4dCddCglleGNlcHQ6IHBhc3MgCglpZiBpbnQoY3VycmVudCkgPCBpbnQodG90YWwpOgoJCWFkZERpcjIoJ1Byb3hpbWEgcGFnaW5hICgnK3N0cihjdXJyZW50KSsnLycrc3RyKHRvdGFsKSsnKScsIHByb3hpbW8sIDEyMywgJ3NlcmllcycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdwcm94aW1vLnBuZycpKQoJdmlzdGFfZmlsbWVzU2VyaWVzKCkKCmRlZiBnZXRTZWFzb25zKHVybCk6CgkjaGVhZGVyc1snQXV0aG9yaXphdGlvbiddID0gJ0JlYXJlciAlcycgJSBfX0FERE9OX18uZ2V0U2V0dGluZygndG9rZW5NcnBpcmFjeScpCglyZXN1bHRhZG8gPSBhYnJpcl91cmwodXJsLCBoZWFkZXI9aGVhZGVycywgY29va2llPWdldENvb2tpZSgpKQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pWydkYXRhJ11bMF0KCWlkID0gdXJsLnNwbGl0KCc9JylbLTFdCglpZiAnc2VyaWUnIGluIHVybDoKCQl1cmwgPSBfX0FQSV9TSVRFX18rJ3Nlcmllcy5waHA/YWN0aW9uPXRlbXBvcmFkYSZpZFNlcmllPScraWQrJyZuPSVzJwoJZWxpZiAnYW5pbWUnIGluIHVybDoKCQl1cmwgPSBfX0FQSV9TSVRFX18rJ2FuaW1lcy5waHA/YWN0aW9uPXRlbXBvcmFkYSZpZFNlcmllPScraWQrJyZuPSVzJwoJCgl0cnk6CgkJcmVzdWx0YWRvWyd0ZW1wb3JhZGFzJ10gPSByZXN1bHRhZG9bJ3RlbXBvcmFkYXMnXS5yZXBsYWNlKCdlc3BlY2lhbCcsICc5OTknKQoJZXhjZXB0OgoJCXBhc3MKCWlmIHJlc3VsdGFkbyA9PSAnRE5TJzoKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdUZW0gZGUgYWx0ZXJhciBvcyBETlMgcGFyYSBwb2RlciB1c3VmcnVpciBkbyBfX0FERE9OX18uJykKCQlyZXR1cm4gRmFsc2UKCQoJaj0xCgkKCWlmIHJlc3VsdGFkb1sndGVtcG9yYWRhcyddID09ICIiOgoJCXJldHVybiBGYWxzZQoJZm9yIGMsIGkgaW4gc29ydGVkKGpzb24ubG9hZHMocmVzdWx0YWRvWyd0ZW1wb3JhZGFzJ10pLml0ZXJpdGVtcygpLCBrZXk9bGFtYmRhIGk6IGludChpWzBdKSk6CgkJaWYgYyAhPSAnOTk5JzoKCQkJYWRkRGlyMigiW0JdVGVtcG9yYWRhWy9CXSAiK3N0cihjKSwgKHVybCAlIHN0cihjKSksIDExNSwgJ2VwaXNvZGlvcycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sJ3RlbXBvcmFkYXMnLCAndGVtcG9yYWRhJytzdHIoYykrJy5wbmcnKSxwb3N0ZXI9X19BUElfXytyZXN1bHRhZG9bJ2JhY2tncm91bmQnXSkKCQllbHNlOgoJCQlhZGREaXIyKCJbQl1UZW1wb3JhZGFbL0JdICIrc3RyKGMpLCAodXJsICUgJzk5OScpLCAxMTUsICdlcGlzb2Rpb3MnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCd0ZW1wb3JhZGFzJywgJ3RlbXBvcmFkYScrc3RyKGMpKycucG5nJykscG9zdGVyPV9fQVBJX18rcmVzdWx0YWRvWydiYWNrZ3JvdW5kJ10pCgkKCXZpc3RhX3RlbXBvcmFkYXMoKQoKZGVmIGdldEVwaXNvZGVzKHVybCk6CgkjaGVhZGVyc1snQXV0aG9yaXphdGlvbiddID0gJ0JlYXJlciAlcycgJSBfX0FERE9OX18uZ2V0U2V0dGluZygndG9rZW5NcnBpcmFjeScpCglyZXN1bHRhZG8gPSBhYnJpcl91cmwodXJsLCBoZWFkZXI9aGVhZGVycywgY29va2llPWdldENvb2tpZSgpKQoJaWYgcmVzdWx0YWRvID09ICdETlMnOgoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1RlbSBkZSBhbHRlcmFyIG9zIEROUyBwYXJhIHBvZGVyIHVzdWZydWlyIGRvIF9fQURET05fXy4nKQoJCXJldHVybiBGYWxzZQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pCglpZiAnc2VyaWUnIGluIHVybDoKCQl0aXBvID0gJ3NlcmllcycKCWVsaWYgJ2FuaW1lJyBpbiB1cmw6CgkJdGlwbyA9ICdhbmltZXMnCglmb3IgaSBpbiByZXN1bHRhZG9bJ2RhdGEnXToKCQlwdCA9ICcnCgkJaW5mb0xhYmVscyA9IHsnVGl0bGUnOiBpWydub21lX2VwaXNvZGlvJ10sICdDb2RlJzogaVsnSU1CRCddLCAnRXBpc29kZSc6IGlbJ2VwaXNvZGlvJ10sICdTZWFzb24nOiBpWyd0ZW1wb3JhZGEnXSB9CgkJCgkJdHJ5OgoJCQlub21lID0gaVsnbm9tZV9lcGlzb2RpbyddLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDoKCQkJbm9tZSA9IGlbJ25vbWVfZXBpc29kaW8nXS5lbmNvZGUoJ3V0Zi04JykKCQliciA9ICcnCgkJZmluYWwgPSAnJwoJCXNlbUxlZ2VuZGEgPSAnJwoJCWlmIGlbJ2ZpbXRlbXBvcmFkYSddID09IDE6CgkJCWZpbmFsID0gJ1tCXUZpbmFsIGRhIFRlbXBvcmFkYSBbL0JdJwoJCWlmIGlbJ3NlbWxlZ2VuZGEnXSA9PSAxOgoJCQlzZW1MZWdlbmRhID0gJ1tDT0xPUiByZWRdW0JdUy8gTEVHRU5EQSBbL0JdWy9DT0xPUl0nCgkJI2lmICdCcmFzaWxlaXJvJyBpbiBjYXRlZ29yaWE6CgkJIwliciA9ICdbQl1bQ09MT1IgZ3JlZW5dQlsvQ09MT1JdW0NPTE9SIHllbGxvd11SWy9DT0xPUl06IFsvQl0nCgkJI2lmICdQb3J0dScgaW4gY2F0ZWdvcmlhOgoJCSMJcHQgPSAnW0JdW0NPTE9SIGdyZWVuXVBbL0NPTE9SXVtDT0xPUiByZWRdVFsvQ09MT1JdOiBbL0JdJwoJCWlmICdQVCcgaW4gaVsnSU1CRCddOgoJCQlpWydJTUJEJ10gPSByZS5jb21waWxlKCcoLis/KVBUJykuZmluZGFsbChpWydJTUJEJ10pWzBdCgkJCXB0ID0gJ1tCXVtDT0xPUiBncmVlbl1QWy9DT0xPUl1bQ09MT1IgcmVkXVRbL0NPTE9SXTogWy9CXScKCQl2aXN0byA9IEZhbHNlCgkJY29yID0gJ3doaXRlJwoJCSNpZiBpWyd2aXN0byddID09IDE6CgkJIwl2aXN0byA9IFRydWUJCgkJCgkJaW1hZ2VtID0gJycKCQlpZiBpWydpbWFnZW0nXSA9PSAxOgoJCQlpbWFnZW0gPSBfX0FQSV9fKydpbWFnZXMvc2VyaWVzLycraVsnSU1CRCddKycuanBnJwoJCWVsaWYgaVsnaW1hZ2VtJ10gPT0gMDoKCQkJaW1hZ2VtID0gX19BUElfXysnaW1hZ2VzL2NhcGFzLycraVsnaW1kYlNlcmllJ10rJy5qcGcnCgkJCgkJI2ltYWdlbSA9IGltYWdlbS5yZXBsYWNlKCdQVCcsJycpCgkJI2lbJ2JhY2tncm91bmQnXSA9IGlbJ2JhY2tncm91bmQnXS5yZXBsYWNlKCdQVCcsJycpCgkJaVsnYmFja2dyb3VuZCddID0gJ2ltYWdlcy9iYWNrZ3JvdW5kLycraVsnSU1CRCddKycuanBnJwoJCWZhbmFydHR0ID0gX19BUElfXytpWydiYWNrZ3JvdW5kJ10KCQkKCQlub21lZWUgPSBwdCticitmaW5hbCtzZW1MZWdlbmRhKydbQ09MT1IgJytjb3IrJ11bQl1FcGlzb2RpbyAnK3N0cihpWydlcGlzb2RpbyddKSsnWy9CXVsvQ09MT1JdICcrcmVtb3ZlckFjZW50b3Mobm9tZSkKCQl1cmxub3ZvID0gX19BUElfU0lURV9fK3RpcG8rJy5waHA/YWN0aW9uPWVwaXNvZGlvJmlkU2VyaWU9JytzdHIoaVsnaWRfc2VyaWUnXSkrJyZpZEVwaXNvZGlvPScrc3RyKGlbJ2lkX2VwaXNvZGlvJ10pCgkJYWRkVmlkZW8obm9tZWVlLCB1cmxub3ZvLCAxMTMsIGltYWdlbSwgdmlzdG8sICdlcGlzb2RpbycsIGlbJ3RlbXBvcmFkYSddLCBpWydlcGlzb2RpbyddLCBpbmZvTGFiZWxzLCBmYW5hcnR0dCkKCQoJdmlzdGFfZXBpc29kaW9zKCkKCmRlZiBnZXRHZW5lcm9zKHVybCk6CglsaXN0YSA9IGdldExpc3RDYXRlZ29yaWEoKQoJaWYgJ2ZpbG1lcycgaW4gdXJsOgoJCXRpcG8gPSAwCgkJcXVhbGlkYWRlID0gJyZxdWFsaWRhZGU9JytfX1F1YWxpZGFkZV9fCgllbGlmICdzZXJpZXMnIGluIHVybDoKCQl0aXBvID0gMQoJCXF1YWxpZGFkZSA9ICcnCgllbGlmICdhbmltZXMnIGluIHVybDoKCQl0aXBvID0gMgoJCXF1YWxpZGFkZSA9ICcnCgkKCWZvciBjIGluIGFzdC5saXRlcmFsX2V2YWwobGlzdGEpOgoJCWlmIGNbJ2lkX2NhdGVnb3JpYSddID09ICIwIjoKCQkJY29udGludWUKCQl0cnk6CgkJCWNhdCA9IGNbJ2NhdGVnb3JpYXMnXS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6CgkJCWNhdCA9IGNbJ2NhdGVnb3JpYXMnXS5lbmNvZGUoJ3V0Zi04JykKCQkKCQl1cmxub3ZvID0gdXJsKycmY2F0ZWdvcmlhPScrc3RyKGNbJ2lkX2NhdGVnb3JpYSddKStxdWFsaWRhZGU7CgkJYWRkRGlyMihjYXQsIHVybG5vdm8sIDEyMiwgJ2NhdGVnb3JpYXMnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZ2VuZXJvLnBuZycpKQoJCgl2aXN0YV9tZW51KCkKCmRlZiBzZXRGaWxtZShpLCB2aXN0b3MsIG9wY2FvKToKCWNhdGVnb3JpYSA9IGdldENhdGVnb3JpYShpWydjYXRlZ29yaWExJ10pCglpZiBpbnQoaVsnY2F0ZWdvcmlhMiddKSAhPSAwOgoJCWNhdGVnb3JpYSArPSAnLCcrZ2V0Q2F0ZWdvcmlhKGlbJ2NhdGVnb3JpYTInXSkKCWlmIGludChpWydjYXRlZ29yaWEzJ10pICE9IDA6CgkJY2F0ZWdvcmlhICs9ICcsJytnZXRDYXRlZ29yaWEoaVsnY2F0ZWdvcmlhMyddKQoJCglwdCA9ICcnCgliciA9ICcnCglzZW1MZWdlbmRhID0gJycKCXZpc3RvID0gRmFsc2UKCXZpc3RvYSA9IEZhbHNlCgl2ZXJpZmljYXJWaXN0b0xvY2FsKGlbJ2lkX3ZpZGVvJ10pCgkKCXRyeToKCQlub21lID0gaVsnbm9tZV9pbmdsZXMnXS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDoKCQlub21lID0gaVsnbm9tZV9pbmdsZXMnXS5lbmNvZGUoJ3V0Zi04JykKCWlmICdodHRwJyBub3QgaW4gaVsnZm90byddOgoJCWlbJ2ZvdG8nXSA9IF9fQVBJX18rJ2ltYWdlcy9jYXBhcy8nK2lbJ2ZvdG8nXS5zcGxpdCgnLycpWy0xXQoJCglpZiBpWydsZWdlbmRhJ10gPT0gInNlbWxlZ2VuZGEiOgoJCXNlbUxlZ2VuZGEgPSAnW0NPTE9SIHJlZF1bQl1TLyBMRUdFTkRBIFsvQl1bL0NPTE9SXScKCWlmICdCcmFzaWxlaXJvJyBpbiBjYXRlZ29yaWE6CgkJYnIgPSAnW0JdW0NPTE9SIGdyZWVuXUJbL0NPTE9SXVtDT0xPUiB5ZWxsb3ddUlsvQ09MT1JdOiBbL0JdJwoJaWYgJ1BvcnR1JyBpbiBjYXRlZ29yaWE6CgkJcHQgPSAnW0JdW0NPTE9SIGdyZWVuXVBbL0NPTE9SXVtDT0xPUiByZWRdVFsvQ09MT1JdOiBbL0JdJwoJY29yID0gIndoaXRlIgoJaWYgJ1BUJyBpbiBpWydJTUJEJ106CgkJaVsnSU1CRCddID0gcmUuY29tcGlsZSgnKC4rPylQVCcpLmZpbmRhbGwoaVsnSU1CRCddKVswXQoJCXB0ID0gJ1tCXVtDT0xPUiBncmVlbl1QWy9DT0xPUl1bQ09MT1IgcmVkXVRbL0NPTE9SXTogWy9CXScKCQoJaW1kYlIgPSBqc29uLmxvYWRzKGlbJ2ltZGJSYXRpbmcnXSkKCQoJaW5mb0xhYmVscyA9IHsnVGl0bGUnOiBpWydub21lX2luZ2xlcyddLCAnWWVhcic6IGlbJ2FubyddLCAnR2VucmUnOiBjYXRlZ29yaWEsICdQbG90JzppWydkZXNjcmljYW9fdmlkZW8nXSwgJ0Nhc3QnOmlbJ2F0b3JlcyddLnNwbGl0KCcsJyksICdUcmFpbGVyJzogaW1kYlJbJ3RyYWlsZXInXSwgJ0RpcmVjdG9yJzogaVsnZGlyZXRvciddLCAnUmF0aW5nJzogaW1kYlJbJ3JhbmtpbmcnXSwgJ0lNREJOdW1iZXInOiBpWydJTUJEJ10gfQoKCW5vbWVlZSA9ICdbQ09MT1IgJytjb3IrJ10nK3B0K2JyK3NlbUxlZ2VuZGErcmVtb3ZlckFjZW50b3Mobm9tZSkrJyAoJytpWydhbm8nXSsnKVsvQ09MT1JdJwoJdXJsbm9vID0gX19BUElfU0lURV9fKydmaWxtZXMucGhwP2FjdGlvbj1pZCZpZEZpbG1lPScrc3RyKGlbJ2lkX3ZpZGVvJ10pCglmb3Rvb28gPSBpWydmb3RvJ10KCWlbJ2JhY2tncm91bmQnXSA9ICdpbWFnZXMvYmFja2dyb3VuZC8nK2lbJ0lNQkQnXSsnLmpwZycKCWZhbmFydHR0ID0gX19BUElfXytpWydiYWNrZ3JvdW5kJ10KCQoJYWRkVmlkZW8obm9tZWVlLCB1cmxub28sIDExMywgZm90b29vLHZpc3RvLCAncGxheWVyJywgMCwgMCwgaW5mb0xhYmVscywgZmFuYXJ0dHQsIHRyYWlsZXI9aW1kYlJbJ3RyYWlsZXInXSkKCmRlZiBzZXRTZXJpZXMoaSwgdmlzdG9zLCBvcGNhbywgdGlwbyk6CgljYXRlZ29yaWEgPSBnZXRDYXRlZ29yaWEoaVsnY2F0ZWdvcmlhMSddKQoJaWYgaW50KGlbJ2NhdGVnb3JpYTInXSkgIT0gMDoKCQljYXRlZ29yaWEgKz0gJywnK2dldENhdGVnb3JpYShpWydjYXRlZ29yaWEyJ10pCglpZiBpbnQoaVsnY2F0ZWdvcmlhMyddKSAhPSAwOgoJCWNhdGVnb3JpYSArPSAnLCcrZ2V0Q2F0ZWdvcmlhKGlbJ2NhdGVnb3JpYTMnXSkKCQoJcHQgPSAnJwoJYnIgPSAnJwoJc2VtTGVnZW5kYSA9ICcnCgkjaWYgaVsnbGVnZW5kYSddID09ICJzZW1sZWdlbmRhIjoKCSMJc2VtTGVnZW5kYSA9ICdbQ09MT1IgcmVkXVtCXVMvIExFR0VOREEgWy9CXVsvQ09MT1JdJwoJaWYgJ0JyYXNpbGVpcm8nIGluIGNhdGVnb3JpYToKCQliciA9ICdbQl1bQ09MT1IgZ3JlZW5dQlsvQ09MT1JdW0NPTE9SIHllbGxvd11SWy9DT0xPUl06IFsvQl0nCglpZiAnUG9ydHUnIGluIGNhdGVnb3JpYToKCQlwdCA9ICdbQl1bQ09MT1IgZ3JlZW5dUFsvQ09MT1JdW0NPTE9SIHJlZF1UWy9DT0xPUl06IFsvQl0nCglpZiAnUFQnIGluIGlbJ0lNQkQnXToKCQlwdCA9ICdbQl1bQ09MT1IgZ3JlZW5dUFsvQ09MT1JdW0NPTE9SIHJlZF1UWy9DT0xPUl06IFsvQl0nCgl2aXN0byA9IEZhbHNlCgl2aXN0b2EgPSBGYWxzZQoJdmVyaWZpY2FyVmlzdG9Mb2NhbChpWydpZF92aWRlbyddKQoJdHJ5OgoJCW5vbWUgPSBpWydub21lX2luZ2xlcyddLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OgoJCW5vbWUgPSBpWydub21lX2luZ2xlcyddLmVuY29kZSgndXRmLTgnKQoJaWYgJ2h0dHAnIG5vdCBpbiBpWydmb3RvJ106CgkJaVsnZm90byddID0gX19BUElfXysnaW1hZ2VzL2NhcGFzLycraVsnZm90byddLnNwbGl0KCcvJylbLTFdCgkJI2lbJ2ZvdG8nXSA9IGlbJ2ZvdG8nXS5yZXBsYWNlKCdQVCcsJycpCgkKCWltZGJSID0ganNvbi5sb2FkcyhpWydpbWRiUmF0aW5nJ10pCgl1cmxub28gPSBfX0FQSV9TSVRFX18rdGlwbysnLnBocD9hY3Rpb249aWQmaWRTZXJpZT0nK3N0cihpWydpZF92aWRlbyddKQoJaW5mb0xhYmVscyA9IHsnVGl0bGUnOiBpWydub21lX2luZ2xlcyddLCAnWWVhcic6IGlbJ2FubyddLCAnR2VucmUnOiBjYXRlZ29yaWEsICdQbG90JzogaVsnZGVzY3JpY2FvX3ZpZGVvJ10sICdDYXN0JzppWydhdG9yZXMnXS5zcGxpdCgnLCcpLCAnVHJhaWxlcic6IGltZGJSWyd0cmFpbGVyJ10sICdEaXJlY3Rvcic6IGlbJ2RpcmV0b3InXSwgJ1JhdGluZyc6IGltZGJSWydyYW5raW5nJ10sICdDb2RlJzogaVsnSU1CRCddIH0KCQoJbm9tZWVlID0gcHQrYnIrc2VtTGVnZW5kYStyZW1vdmVyQWNlbnRvcyhub21lKSsnICgnK2lbJ2FubyddKycpJwoJZm90b29vID0gaVsnZm90byddCgkjaVsnYmFja2dyb3VuZCddID0gaVsnYmFja2dyb3VuZCddLnJlcGxhY2UoJ1BUJywnJykKCWlbJ2JhY2tncm91bmQnXSA9ICdpbWFnZXMvYmFja2dyb3VuZC8nK2lbJ0lNQkQnXSsnLmpwZycKCWZhbmFydHR0ID0gX19BUElfXytpWydiYWNrZ3JvdW5kJ10KCWFkZERpcjIobm9tZWVlLCB1cmxub28sIDExNCwgJ3RlbXBvcmFkYXMnLCBmb3Rvb28sIHRpcG89J3NlcmllJywgaW5mb0xhYmVscz1pbmZvTGFiZWxzLHBvc3Rlcj1mYW5hcnR0dCx2aXN0bz12aXN0bykKCmRlZiBjYXRlZ29yaWFzKHVybCk6CgkjaGVhZGVyc1snQXV0aG9yaXphdGlvbiddID0gJ0JlYXJlciAlcycgJSBfX0FERE9OX18uZ2V0U2V0dGluZygndG9rZW5NcnBpcmFjeScpCglyZXN1bHRhZG8gPSBhYnJpcl91cmwodXJsLCBoZWFkZXI9aGVhZGVycywgY29va2llPWdldENvb2tpZSgpKQoJI2lmIHJlc3VsdGFkbyA9PSAnRE5TJzoKCSMJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVGVtIGRlIGFsdGVyYXIgb3MgRE5TIHBhcmEgcG9kZXIgdXN1ZnJ1aXIgZG8gX19BRERPTl9fLicpCgkjCXJldHVybiBGYWxzZQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pCgl2aXN0b3MgPSBEYXRhYmFzZS5zZWxlY3RGaWxtZXMoKQoJb3BjYW8gPSBfX0FERE9OX18uZ2V0U2V0dGluZygnbWFyY2FyVmlzdG8nKQoJaWYgJ3NlcmllJyBpbiB1cmw6CgkJdGlwbyA9ICdzZXJpZXMnCgllbGlmICdhbmltZScgaW4gdXJsOgoJCXRpcG8gPSAnYW5pbWVzJwoJZm9yIGkgaW4gcmVzdWx0YWRvWyJkYXRhIl06CgkJaWYgJ2ZpbG1lJyBpbiB1cmw6CgkJCXNldEZpbG1lKGksIHZpc3Rvcywgb3BjYW8pCgkJZWxpZiAnc2VyaWUnIGluIHVybCBvciAnYW5pbWUnIGluIHVybDoKCQkJc2V0U2VyaWVzKGksIHZpc3Rvcywgb3BjYW8sIHRpcG8pCgljdXJyZW50ID0gcmVzdWx0YWRvWydtZXRhJ11bJ2N1cnJlbnQnXQoJdG90YWwgPSByZXN1bHRhZG9bJ21ldGEnXVsndG90YWwnXQoJdHJ5OiBwcm94aW1vID0gcmVzdWx0YWRvWydtZXRhJ11bJ3BhZ2luYWNhbyddWyduZXh0J10KCWV4Y2VwdDogcGFzcyAKCWlmIGludChjdXJyZW50KSA8IGludCh0b3RhbCk6CgkJYWRkRGlyMignUHLDs3hpbWEgcMOhZ2luYSAoJytzdHIoY3VycmVudCkrJy8nK3N0cih0b3RhbCkrJyknLCBwcm94aW1vLCAxMjEsICdhbm9zJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Byb3hpbW8ucG5nJyksMSkKCQoJdmlzdGFfZmlsbWVzU2VyaWVzKCkKCmRlZiBnZXRZZWFycyh1cmwpOgoJYW5vcyA9IFsKCQkJJzIwMTknLAoJCQknMjAxOCcsCgkJCScyMDE3JywKCQkJJzIwMTYnLAoJCQknMjAxNScsCgkJCScyMDE0JywKCQkJJzIwMTMnLAoJCQknMjAxMicsCgkJCScyMDExJywKCQkJJzIwMTAnLAoJCQknMjAwOScsCgkJCScyMDA4JywKCQkJJzIwMDcnLAoJCQknMjAwNicsCgkJCScyMDAwLTIwMDUnLAoJCQknMTk5MC0xOTk5JywKCQkJJzE5ODAtMTk4OScsCgkJCScxOTcwLTE5NzknLAoJCQknMTk2MC0xOTY5JywKCQkJJzE5NTAtMTk1OScsCgkJCScxOTAwLTE5NDknCgkJXQoJaWYgJ2ZpbG1lcycgaW4gdXJsOgoJCXRpcG8gPSAwCgkJcXVhbGlkYWRlID0gJyZxdWFsaWRhZGU9JytfX1F1YWxpZGFkZV9fCgllbGlmICdzZXJpZXMnIGluIHVybDoKCQl0aXBvID0gMQoJCXF1YWxpZGFkZSA9ICcnCgllbGlmICdhbmltZXMnIGluIHVybDoKCQl0aXBvID0gMgoJCXF1YWxpZGFkZSA9ICcnCglmb3IgaSBpbiBhbm9zOgoJCXVybG5vdm8gPSB1cmwrJyZhbm89JytpK3F1YWxpZGFkZTsKCQlhZGREaXIyKGksIHVybG5vdm8sIDEyMSwgJ2Fub3MnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnYW5vLnBuZycpKQoJCQoJdmlzdGFfbWVudSgpCgpkZWYgYW5vcyh1cmwpOgoJI2hlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICdCZWFyZXIgJXMnICUgX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuTXJwaXJhY3knKQoJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCwgaGVhZGVyPWhlYWRlcnMsIGNvb2tpZT1nZXRDb29raWUoKSkKCWlmIHJlc3VsdGFkbyA9PSAnRE5TJzoKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdUZW0gZGUgYWx0ZXJhciBvcyBETlMgcGFyYSBwb2RlciB1c3VmcnVpciBkbyBfX0FERE9OX18uJykKCQlyZXR1cm4gRmFsc2UKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJdmlzdG9zID0gRGF0YWJhc2Uuc2VsZWN0RmlsbWVzKCkKCW9wY2FvID0gX19BRERPTl9fLmdldFNldHRpbmcoJ21hcmNhclZpc3RvJykKCWlmICdzZXJpZScgaW4gdXJsOgoJCXRpcG8gPSAnc2VyaWVzJwoJZWxpZiAnYW5pbWUnIGluIHVybDoKCQl0aXBvID0gJ2FuaW1lcycKCWZvciBpIGluIHJlc3VsdGFkb1siZGF0YSJdOgoJCWlmICdmaWxtZScgaW4gdXJsOgoJCQlzZXRGaWxtZShpLCB2aXN0b3MsIG9wY2FvKQoJCWVsaWYgJ3NlcmllJyBpbiB1cmwgb3IgJ2FuaW1lJyBpbiB1cmw6CgkJCXNldFNlcmllcyhpLCB2aXN0b3MsIG9wY2FvLCB0aXBvKQoJCgl0cnk6IAoJCWN1cnJlbnQgPSByZXN1bHRhZG9bJ21ldGEnXVsnY3VycmVudCddCglleGNlcHQ6IAoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0FndWFyZGUgcGVsYSBwcsOzeGltYSBhdHVhbGl6YcOnw6NvLiBPdSB0ZW50ZSBtYWlzIHRhcmRlLicpCgkJcmV0dXJuIEZhbHNlCgljdXJyZW50ID0gcmVzdWx0YWRvWydtZXRhJ11bJ2N1cnJlbnQnXQoJdG90YWwgPSByZXN1bHRhZG9bJ21ldGEnXVsndG90YWwnXQoJdHJ5OiBwcm94aW1vID0gcmVzdWx0YWRvWydtZXRhJ11bJ3BhZ2luYWNhbyddWyduZXh0J10KCWV4Y2VwdDogcGFzcyAKCWlmIGludChjdXJyZW50KSA8IGludCh0b3RhbCk6CgkJYWRkRGlyMignUHLDs3hpbWEgcMOhZ2luYSAoJytzdHIoY3VycmVudCkrJy8nK3N0cih0b3RhbCkrJyknLCBwcm94aW1vLCAxMjEsICdhbm9zJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Byb3hpbW8ucG5nJyksMSkKCQoJdmlzdGFfZmlsbWVzU2VyaWVzKCkKCmRlZiBnZXRFdmVudG9zKCk6CgkjaGVhZGVyc1snQXV0aG9yaXphdGlvbiddID0gJ0JlYXJlciAlcycgJSBfX0FERE9OX18uZ2V0U2V0dGluZygndG9rZW5NcnBpcmFjeScpCglyZXN1bHRhZG8gPSBhYnJpcl91cmwoX19BUElfU0lURV9fKydldmVudG9zJywgaGVhZGVyPWhlYWRlcnMsIGNvb2tpZT1nZXRDb29raWUoKSkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJdHJ5OgoJCWlmIHJlc3VsdGFkb1snY29kaWdvJ10gPT0gMjA0OgoJCQlyZXR1cm4gRmFsc2UKCWV4Y2VwdDoKCQlwYXNzCglyZXR1cm4gcmVzdWx0YWRvWydkYXRhJ11bJ25vbWUnXQoJCQoJCQpkZWYgcGxheWVyKG5hbWUsdXJsLGljb25pbWFnZSx0ZW1wb3JhZGEsZXBpc29kaW8sc2VyaWVOb21lKToKCSNoZWFkZXJzWydBdXRob3JpemF0aW9uJ10gPSAnQmVhcmVyICVzJyAlIF9fQURET05fXy5nZXRTZXR0aW5nKCd0b2tlbk1ycGlyYWN5JykKCXJlc3VsdGFkbyA9IGFicmlyX3VybCh1cmwsIGhlYWRlcj1oZWFkZXJzLCBjb29raWU9Z2V0Q29va2llKCkpCglpZiByZXN1bHRhZG8gPT0gJ0ROUyc6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVGVtIGRlIGFsdGVyYXIgb3MgRE5TIHBhcmEgcG9kZXIgdXN1ZnJ1aXIgZG8gX19BRERPTl9fLicpCgkJcmV0dXJuIEZhbHNlCgkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKVswXQoJI3Jlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJaW5mb2xhYmVscyA9IGRpY3QoKQoJY29pc28gPSAnJwoJcGFzdGFEYXRhID0gJycKCXRpcG8gPSAnJwoJaWRWaWRlbyA9ICcnCglpZiAnZmlsbWUnIGluIHVybDoKCQl0aXBvID0gJ2ZpbG1lJwoJCWluZm9sYWJlbHNbJ0NvZGUnXSA9IHJlc3VsdGFkb1snSU1CRCddCgkJaW5mb2xhYmVsc1snWWVhciddID0gcmVzdWx0YWRvWydhbm8nXQoJCWlkVmlkZW8gPSByZXN1bHRhZG9bJ2lkX3ZpZGVvJ10KCQlub21lID0gcmVzdWx0YWRvWydub21lX2luZ2xlcyddCgkJdGVtcG9yYWRhID0gMAoJCWVwaXNvZGlvID0gMAoJCWNvaXNvID0gJ2ZpbG1lJwoJZWxzZToKCQlpZiAnc2VyaWUnIGluIHVybDoKCQkJdGlwbyA9ICdzZXJpZScKCQllbHNlOgoJCQl0aXBvID0gJ2FuaW1lJwoJCWlkVmlkZW8gPSByZXN1bHRhZG9bJ2lkX3NlcmllJ10KCQlub21lID0gcmVzdWx0YWRvWydub21lX2VwaXNvZGlvJ10KCQl0ZW1wb3JhZGEgPSByZXN1bHRhZG9bJ3RlbXBvcmFkYSddCgkJZXBpc29kaW8gPSByZXN1bHRhZG9bJ2VwaXNvZGlvJ10KCQljb2lzbyA9ICdvdXRybycKCgltZW5zYWdlbXByb2dyZXNzbyA9IHhibWNndWkuRGlhbG9nUHJvZ3Jlc3MoKQoJbWVuc2FnZW1wcm9ncmVzc28uY3JlYXRlKEFkZG9uVGl0bGUsIHUnQWJyaXIgZW1pc3PDo28nLCdQb3IgZmF2b3IgYWd1YXJkZS4uLicpCgltZW5zYWdlbXByb2dyZXNzby51cGRhdGUoMjUsICIiLCB1J09idGVyIHZpZGVvIGUgbGVnZW5kYScsICIiKQoKCXN0cmVhbSwgbGVnZW5kYSwgZXh0X2cgPSBnZXRTdHJlYW1MZWdlbmRhKGlkVmlkZW8sIHRpcG8sIGNvaXNvPWNvaXNvKQoJaWYgc3RyZWFtID09IEZhbHNlIGFuZCBsZWdlbmRhID09IDIwNDoKCQltZW5zYWdlbXByb2dyZXNzby5jbG9zZSgpCgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVGVtIGRlIGVzcGVyYXIgOCBob3JhcyBhdMOpIGNvbnNlZ3VpciB2aXN1YWxpemFyIGFsZ3VtIHZpZGVvLicpCgkJcmV0dXJuIEZhbHNlCgkKCW1lbnNhZ2VtcHJvZ3Jlc3NvLnVwZGF0ZSg1MCwgIiIsIHUnUHJlcGFyYS10ZSwgdmFpIGNvbWXDp2FyIScsICIiKQoJcGxheWxpc3QgPSB4Ym1jLlBsYXlMaXN0KDEpCglwbGF5bGlzdC5jbGVhcigpCglsaXN0aXRlbSA9IHhibWNndWkuTGlzdEl0ZW0obmFtZSwgaWNvbkltYWdlPSJEZWZhdWx0VmlkZW8ucG5nIiwgdGh1bWJuYWlsSW1hZ2U9aWNvbmltYWdlKQoKCWxpc3RpdGVtLnNldEluZm8odHlwZT0iVmlkZW8iLCBpbmZvTGFiZWxzPWluZm9sYWJlbHMpCglsaXN0aXRlbS5zZXRQcm9wZXJ0eSgnbWltZXR5cGUnLCAndmlkZW8veC1tc3ZpZGVvJykKCWxpc3RpdGVtLnNldFByb3BlcnR5KCdJc1BsYXlhYmxlJywgJ3RydWUnKQoJCglsaXN0aXRlbS5zZXRQYXRoKHBhdGg9c3RyZWFtKQoJcGxheWxpc3QuYWRkKHN0cmVhbSwgbGlzdGl0ZW0pCgl4Ym1jcGx1Z2luLnNldFJlc29sdmVkVXJsKGludChzeXMuYXJndlsxXSksIFRydWUsIGxpc3RpdGVtKQoJbWVuc2FnZW1wcm9ncmVzc28udXBkYXRlKDc1LCAiIiwgdSdCb2EgU2Vzc8OjbyEhIScsICIiKQoKCWlmIHN0cmVhbSA9PSBGYWxzZToKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdPIHNlcnZpZG9yIGVzY29saGlkbyBuw6NvIGRpc3BvbsOtdmVsLCBlc2NvbGhhIG91dHJvIG91IHRlbnRlIG5vdmFtZW50ZSBtYWlzIHRhcmRlLicpCgllbHNlOgoJCSNfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdTdHJlYW06ICcrc3RyZWFtKQoJCXBsYXllcl9tciA9IFBsYXllci5QbGF5ZXIodXJsPXVybCwgaWRGaWxtZT1pZFZpZGVvLCBwYXN0YURhdGE9X19QQVNUQV9EQURPU19fLCB0ZW1wb3JhZGE9dGVtcG9yYWRhLCBlcGlzb2Rpbz1lcGlzb2Rpbywgbm9tZT1uYW1lLCBsb2dvPW9zLnBhdGguam9pbihfX0FERE9OX0ZPTERFUl9fLCdpY29uLnBuZycpKQoJCQoJCW1lbnNhZ2VtcHJvZ3Jlc3NvLmNsb3NlKCkKCQlwbGF5ZXJfbXIucGxheShwbGF5bGlzdCkKCQlwbGF5ZXJfbXIuc2V0U3VidGl0bGVzKGxlZ2VuZGEpCgoJCXdoaWxlIHBsYXllcl9tci5wbGF5aW5nOgoJCQl4Ym1jLnNsZWVwKDUwMDApCgkJCSNwbGF5ZXJfbXIudHJhY2tlclRlbXBvKCkKCmRlZiBtYXJjYXJWaXN0byh1cmwpOgoJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCwgaGVhZGVyPWhlYWRlcnMsIGNvb2tpZT1nZXRDb29raWUoKSkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKVswXQoJbGlua3MgPSB1cmwuc3BsaXQoJy8nKQoJb3BjYW8gPSBfX0FERE9OX18uZ2V0U2V0dGluZygnbWFyY2FyVmlzdG8nKQoJaWYgJ2ZpbG1lJyBpbiB1cmw6CgkJaWRfdmlkZW8gPSByZXN1bHRhZG9bJ2lkX3ZpZGVvJ10KCQlpbWRiID0gcmVzdWx0YWRvWydJTUJEJ10KCQlwb3N0ID0geydpZF9maWxtZSc6IGlkX3ZpZGVvfQoJCXRpcG8gPSAwCgllbGlmICdzZXJpZScgaW4gdXJsOgoJCWltZGIgID0gcmVzdWx0YWRvWydmb3RvU2VyaWUnXS5zcGxpdCgnLycpWy0xXS5zcGxpdCgnLicpWzBdCgkJaWRfdmlkZW8gPSByZXN1bHRhZG9bJ2lkX3NlcmllJ10KCQl0ZW1wb3JhZGEgPSByZXN1bHRhZG9bJ3RlbXBvcmFkYSddCgkJZXBpc29kaW8gPSByZXN1bHRhZG9bJ2VwaXNvZGlvJ10KCQlwb3N0ID0geydpZF9zZXJpZSc6IGlkX3ZpZGVvLCAndGVtcG9yYWRhJzogdGVtcG9yYWRhLCAnZXBpc29kaW8nOmVwaXNvZGlvfQoJCXRpcG8gPSAxCgllbGlmICdhbmltZScgaW4gdXJsOgoJCWltZGIgID0gcmVzdWx0YWRvWydmb3RvU2VyaWUnXS5zcGxpdCgnLycpWy0xXS5zcGxpdCgnLicpWzBdCgkJaWRfdmlkZW8gPSByZXN1bHRhZG9bJ2lkX3NlcmllJ10KCQl0ZW1wb3JhZGEgPSByZXN1bHRhZG9bJ3RlbXBvcmFkYSddCgkJZXBpc29kaW8gPSByZXN1bHRhZG9bJ2VwaXNvZGlvJ10KCQlwb3N0ID0geydpZF9hbmltZSc6IGlkX3ZpZGVvLCAndGVtcG9yYWRhJzogdGVtcG9yYWRhLCAnZXBpc29kaW8nOmVwaXNvZGlvfQoJCXRpcG8gPSAyCglwYXN0YVZpc3RvPW9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ3Zpc3RvcycpCgl0cnk6CgkJb3MubWFrZWRpcnMocGFzdGFWaXN0bykKCWV4Y2VwdDoKCQlwYXNzCglpZiB0aXBvID09IDEgb3IgdGlwbyA9PSAyOgoJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKHBhc3RhVmlzdG8sIHN0cihpZF92aWRlbykrJ19TJytzdHIodGVtcG9yYWRhKSsneCcrc3RyKGVwaXNvZGlvKSsnLmxpdmVpdCcpCgllbGlmIHRpcG8gPT0gMDoKCQlmaWNoZWlybyA9IG9zLnBhdGguam9pbihwYXN0YVZpc3RvLCBzdHIoaWRfdmlkZW8pKycubGl2ZWl0JykKCWlmIG5vdCBvcy5wYXRoLmV4aXN0cyhmaWNoZWlybyk6CgkJZiA9IG9wZW4oZmljaGVpcm8sICd3JykKCQlmLndyaXRlKCcnKQoJCWYuY2xvc2UoKQoJZXNjcmV2ZXJfZmljaGVpcm8ob3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywndmlzdG9zX2ZpbG1lcy5saXZlaXQnKSwgdmlzdG9zX2ZpbG1lcykKCXhibWMuZXhlY3V0ZWJ1aWx0aW4oIlhCTUMuTm90aWZpY2F0aW9uKCIrQWRkb25UaXRsZSsiLCIrIk1hcmNhZG8gY29tbyB2aXN0byIrIiwiKyI2MDAxIisiLCIrIG9zLnBhdGguam9pbihjb250cm9sby5hZGRvbkZvbGRlciwnaWNvbi5wbmcnKSsiKSIpCgl4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuUmVmcmVzaCIpCgpkZWYgbWFyY2FyTmFvVmlzdG8odXJsKToKCXJlc3VsdGFkbyA9IGFicmlyX3VybCh1cmwsIGhlYWRlcj1oZWFkZXJzLCBjb29raWU9Z2V0Q29va2llKCkpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbylbMF0KCWxpbmtzID0gdXJsLnNwbGl0KCcvJykKCW9wY2FvID0gX19BRERPTl9fLmdldFNldHRpbmcoJ21hcmNhclZpc3RvJykKCWlmICdmaWxtZScgaW4gdXJsOgoJCWlkX3ZpZGVvID0gcmVzdWx0YWRvWydpZF92aWRlbyddCgkJaW1kYiA9IHJlc3VsdGFkb1snSU1CRCddCgkJcG9zdCA9IHsnaWRfZmlsbWUnOiBpZF92aWRlb30KCQl0aXBvID0gMAoJZWxpZiAnc2VyaWUnIGluIHVybDoKCQlpbWRiICA9IHJlc3VsdGFkb1snZm90b1NlcmllJ10uc3BsaXQoJy8nKVstMV0uc3BsaXQoJy4nKVswXQoJCWlkX3ZpZGVvID0gcmVzdWx0YWRvWydpZF9zZXJpZSddCgkJdGVtcG9yYWRhID0gcmVzdWx0YWRvWyd0ZW1wb3JhZGEnXQoJCWVwaXNvZGlvID0gcmVzdWx0YWRvWydlcGlzb2RpbyddCgkJcG9zdCA9IHsnaWRfc2VyaWUnOiBpZF92aWRlbywgJ3RlbXBvcmFkYSc6IHRlbXBvcmFkYSwgJ2VwaXNvZGlvJzplcGlzb2Rpb30KCQl0aXBvID0gMQoJZWxpZiAnYW5pbWUnIGluIHVybDoKCQlpbWRiICA9IHJlc3VsdGFkb1snZm90b1NlcmllJ10uc3BsaXQoJy8nKVstMV0uc3BsaXQoJy4nKVswXQoJCWlkX3ZpZGVvID0gcmVzdWx0YWRvWydpZF9zZXJpZSddCgkJdGVtcG9yYWRhID0gcmVzdWx0YWRvWyd0ZW1wb3JhZGEnXQoJCWVwaXNvZGlvID0gcmVzdWx0YWRvWydlcGlzb2RpbyddCgkJcG9zdCA9IHsnaWRfYW5pbWUnOiBpZF92aWRlbywgJ3RlbXBvcmFkYSc6IHRlbXBvcmFkYSwgJ2VwaXNvZGlvJzplcGlzb2Rpb30KCQl0aXBvID0gMgoJCglwYXN0YVZpc3RvPW9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ3Zpc3RvcycpCgl0cnk6CgkJb3MubWFrZWRpcnMocGFzdGFWaXN0bykKCWV4Y2VwdDoKCQlwYXNzCgoJaWYgdGlwbyA9PSAxIG9yIHRpcG8gPT0gMjoKCQlmaWNoZWlybyA9IG9zLnBhdGguam9pbihwYXN0YVZpc3RvLCBzdHIoaWRfdmlkZW8pKydfUycrc3RyKHRlbXBvcmFkYSkrJ3gnK3N0cihlcGlzb2RpbykrJy5tcnBpcmFjeScpCgllbGlmIHRpcG8gPT0gMDoKCQlmaWNoZWlybyA9IG9zLnBhdGguam9pbihwYXN0YVZpc3RvLCBzdHIoaWRfdmlkZW8pKycubXJwaXJhY3knKQoKCWlmIG9zLnBhdGguZXhpc3RzKGZpY2hlaXJvKToKCQlvcy5yZW1vdmUoZmljaGVpcm8pCgllc2NyZXZlcl9maWNoZWlybyhvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCd2aXN0b3NfZmlsbWVzLmxpdmVpdCcpLCB2aXN0b3MpCgl4Ym1jLmV4ZWN1dGVidWlsdGluKCJYQk1DLk5vdGlmaWNhdGlvbigiK0FkZG9uVGl0bGUrIiwiKyJNYXJjYWRvIGNvbW8gdmlzdG8iKyIsIisiNjAwMSIrIiwiKyBvcy5wYXRoLmpvaW4oY29udHJvbG8uYWRkb25Gb2xkZXIsJ2ljb24ucG5nJykrIikiKQoJeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlJlZnJlc2giKQoKZGVmIGdldFN0cmVhbUxlZ2VuZGEoaWQsIHRpcG8sIGNvaXNvPU5vbmUpOgoJaWYgdGlwbyA9PSAnZmlsbWUnOgoJCXVybCA9IF9fQVBJX1NJVEVfXyt0aXBvKydzLnBocD9hY3Rpb249bGlua3MmaWRGaWxtZT0nK2lkCglpZiB0aXBvID09ICdzZXJpZSc6CgkJdXJsID0gX19BUElfU0lURV9fK3RpcG8rJ3MucGhwP2FjdGlvbj1saW5rcyZpZEVwaXNvZGlvPScraWQKCWlmIHRpcG8gPT0gJ2FuaW1lJzoKCQl1cmwgPSBfX0FQSV9TSVRFX18rdGlwbysncy5waHA/YWN0aW9uPWxpbmtzJmlkRXBpc29kaW89JytpZAoKCXJlc3VsdGFkbyA9IGFicmlyX3VybCh1cmwsIGhlYWRlcj1oZWFkZXJzLCBjb29raWU9Z2V0Q29va2llKCkpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCXRyeToKCQlpZiByZXN1bHRhZG9bJ2NvZGlnbyddID09IDIwNDoKCQkJcmV0dXJuIEZhbHNlLCAyMDQsIDIwNAoJZXhjZXB0OiAKCQlyZXN1bHRhZG8gPSByZXN1bHRhZG9bMF0KCQoJaSA9IDAKCXNlcnZpZG9yZXMgPSBbXQoJdGl0dWxvcyA9IFtdCglub21lID0gJycKCQoJaWYgcmVzdWx0YWRvWydVUkwnXSAhPSAnJzoKCQlpKz0xCgkJaWYgJ29wZW5sb2FkJyBpbiByZXN1bHRhZG9bJ1VSTCddOgoJCQlub21lID0gIk9wZW5Mb2FkIgoJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTCddKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAndmlkemknIGluIHJlc3VsdGFkb1snVVJMJ106CgkJCW5vbWUgPSAnVmlkemknCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMJ10pCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICdnb29nbGUnIGluIHJlc3VsdGFkb1snVVJMJ10gb3IgJ2Nsb3VkLm1haWwucnUnIGluIHJlc3VsdGFkb1snVVJMJ106CgkJCW5vbWUgPSBBZGRvblRpdGxlCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMJ10pCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICd1cHRvc3RyZWFtLmNvbScgaW4gcmVzdWx0YWRvWydVUkwnXToKCQkJbm9tZSA9ICdVcFRvU3RyZWFtJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTCddKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAncmFwaWR2aWRlby5jb20nIGluIHJlc3VsdGFkb1snVVJMJ10gb3IgJ3JhcHR1JyBpbiByZXN1bHRhZG9bJ1VSTCddOgoJCQlub21lID0gJ1JhcHR1JwoJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTCddKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAndmlkb3phLm5ldCcgaW4gcmVzdWx0YWRvWydVUkwnXToKCQkJbm9tZSA9ICdWaWRvemEnCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMJ10pCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICdzdHJlYW1hbmdvLicgaW4gcmVzdWx0YWRvWydVUkwnXToKCQkJbm9tZSA9ICdTdHJlYW1hbmdvJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTCddKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCglpZiByZXN1bHRhZG9bJ1VSTDInXSAhPSAnJzoKCQlpKz0xCgkJaWYgJ29wZW5sb2FkJyBpbiByZXN1bHRhZG9bJ1VSTDInXToKCQkJbm9tZSA9ICJPcGVuTG9hZCIKCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwyJ10pCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICd2aWR6aScgaW4gcmVzdWx0YWRvWydVUkwyJ106CgkJCW5vbWUgPSAnVmlkemknCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMMiddKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAnZ29vZ2xlJyBpbiByZXN1bHRhZG9bJ1VSTDInXSBvciAnY2xvdWQubWFpbC5ydScgaW4gcmVzdWx0YWRvWydVUkwyJ106CgkJCW5vbWUgPSBBZGRvblRpdGxlCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMMiddKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAndXB0b3N0cmVhbS5jb20nIGluIHJlc3VsdGFkb1snVVJMMiddOgoJCQlub21lID0gJ1VwVG9TdHJlYW0nCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMMiddKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAncmFwaWR2aWRlby5jb20nIGluIHJlc3VsdGFkb1snVVJMMiddIG9yICdyYXB0dScgaW4gcmVzdWx0YWRvWydVUkwyJ106CgkJCW5vbWUgPSAnUmFwdHUnCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMMiddKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAndmlkb3phLm5ldCcgaW4gcmVzdWx0YWRvWydVUkwyJ106CgkJCW5vbWUgPSAnVmlkb3phJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDInXSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3N0cmVhbWFuZ28uJyBpbiByZXN1bHRhZG9bJ1VSTDInXToKCQkJbm9tZSA9ICdTdHJlYW1hbmdvJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDInXSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJdHJ5OgoJCWlmIHJlc3VsdGFkb1snVVJMMyddICE9ICcnOgoJCQlpKz0xCgkJCWlmICdvcGVubG9hZCcgaW4gcmVzdWx0YWRvWydVUkwzJ106CgkJCQlub21lID0gIk9wZW5Mb2FkIgoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwzJ10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3ZpZHppJyBpbiByZXN1bHRhZG9bJ1VSTDMnXToKCQkJCW5vbWUgPSAnVmlkemknCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDMnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAnZ29vZ2xlJyBpbiByZXN1bHRhZG9bJ1VSTDMnXSBvciAnY2xvdWQubWFpbC5ydScgaW4gcmVzdWx0YWRvWydVUkwzJ106CgkJCQlub21lID0gQWRkb25UaXRsZQoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwzJ10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3VwdG9zdHJlYW0uY29tJyBpbiByZXN1bHRhZG9bJ1VSTDMnXToKCQkJCW5vbWUgPSAnVXBUb1N0cmVhbScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMMyddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdyYXBpZHZpZGVvLmNvbScgaW4gcmVzdWx0YWRvWydVUkwzJ10gb3IgJ3JhcHR1JyBpbiByZXN1bHRhZG9bJ1VSTDMnXToKCQkJCW5vbWUgPSAnUmFwdHUnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDMnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndmlkb3phLm5ldCcgaW4gcmVzdWx0YWRvWydVUkwzJ106CgkJCQlub21lID0gJ1ZpZG96YScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMMyddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdzdHJlYW1hbmdvLicgaW4gcmVzdWx0YWRvWydVUkwzJ106CgkJCQlub21lID0gJ1N0cmVhbWFuZ28nCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDMnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCWV4Y2VwdDoKCQlwYXNzCgl0cnk6CgkJaWYgcmVzdWx0YWRvWydVUkw0J10gIT0gJyc6CgkJCWkrPTEKCQkJaWYgJ29wZW5sb2FkJyBpbiByZXN1bHRhZG9bJ1VSTDQnXToKCQkJCW5vbWUgPSAiT3BlbkxvYWQiCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDQnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndmlkemknIGluIHJlc3VsdGFkb1snVVJMNCddOgoJCQkJbm9tZSA9ICdWaWR6aScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMNCddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdnb29nbGUnIGluIHJlc3VsdGFkb1snVVJMNCddIG9yICdjbG91ZC5tYWlsLnJ1JyBpbiByZXN1bHRhZG9bJ1VSTDQnXToKCQkJCW5vbWUgPSBBZGRvblRpdGxlCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDQnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndXB0b3N0cmVhbS5jb20nIGluIHJlc3VsdGFkb1snVVJMNCddOgoJCQkJbm9tZSA9ICdVcFRvU3RyZWFtJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkw0J10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3JhcGlkdmlkZW8uY29tJyBpbiByZXN1bHRhZG9bJ1VSTDQnXSBvciAncmFwdHUnIGluIHJlc3VsdGFkb1snVVJMNCddOgoJCQkJbm9tZSA9ICdSYXB0dScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMNCddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd2aWRvemEubmV0JyBpbiByZXN1bHRhZG9bJ1VSTDQnXToKCQkJCW5vbWUgPSAnVmlkb3phJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkw0J10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3N0cmVhbWFuZ28uJyBpbiByZXN1bHRhZG9bJ1VSTDQnXToKCQkJCW5vbWUgPSAnU3RyZWFtYW5nbycKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMNCddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJZXhjZXB0OgoJCXBhc3MKCWxlZ2VuZGEgPSAnJwoJc3RyZWFtID0gJycKCWlmICc6Ly8nIGluIHJlc3VsdGFkb1snbGVnZW5kYSddIG9yIHJlc3VsdGFkb1snbGVnZW5kYSddID09ICcnOgoJCWxlZ2VuZGEgPSBfX0FQSV9fKydzdWJzLyVzLnNydCcgJSByZXN1bHRhZG9bJ0lNQkQnXQoJZWxpZiByZXN1bHRhZG9bJ2xlZ2VuZGEnXSAhPSAnJzoKCQlpZiBub3QgJy5zcnQnIGluIHJlc3VsdGFkb1snbGVnZW5kYSddOgoJCQlyZXN1bHRhZG9bJ2xlZ2VuZGEnXSA9IHJlc3VsdGFkb1snbGVnZW5kYSddKycuc3J0JwoJCWxlZ2VuZGEgPSBfX0FQSV9fKydzdWJzLyVzJyAlIHJlc3VsdGFkb1snbGVnZW5kYSddCgl0cnk6CgkJaWYgcmVzdWx0YWRvWydzZW1sZWdlbmRhJ10gPT0gMToKCQkJbGVnZW5kYSA9ICcnCglleGNlcHQ6CgkJcGFzcwoJZXh0X2cgPSAnY29pc28nCglsZWdlbmRhQXV4ID0gbGVnZW5kYQoJc2Vydmlkb3IgPSAwCglpZiBsZW4odGl0dWxvcykgPiAxOgoJCXNlcnZpZG9yID0geGJtY2d1aS5EaWFsb2coKS5zZWxlY3QoJ0VzY29saGEgbyBzZXJ2aWRvcicsIHRpdHVsb3MpCgllbHNlOgoJCXNlcnZpZG9yID0gMAoJCglpZiAndmlkemknIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCQl2aWR6aSA9IFVSTFJlc29sdmVyTWVkaWEuVmlkemkoc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pCgkJCXN0cmVhbSA9IHZpZHppLmdldE1lZGlhVXJsKCkKCQkJbGVnZW5kYSA9IHZpZHppLmdldFN1YnRpdGxlKCkKCWVsaWYgJ3VwdG9zdHJlYW0uY29tJyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQlzdHJlYW0gPSBVUkxSZXNvbHZlck1lZGlhLlVwVG9TdHJlYW0oc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pLmdldE1lZGlhVXJsKCkKCWVsaWYgJ3NlcnZlci5tcnBpcmFjeS53aW4nIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXN0cmVhbSA9IHNlcnZpZG9yZXNbc2Vydmlkb3JdCgllbGlmICdvcGVubG9hZCcgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJc3RyZWFtID0gVVJMUmVzb2x2ZXJNZWRpYS5PcGVuTG9hZChzZXJ2aWRvcmVzW3NlcnZpZG9yXSkuZ2V0TWVkaWFVcmwoKQoJCWxlZ2VuZGEgPSBVUkxSZXNvbHZlck1lZGlhLk9wZW5Mb2FkKHNlcnZpZG9yZXNbc2Vydmlkb3JdKS5nZXRTdWJ0aXRsZSgpCgkJaWYgbm90ICcudnR0JyBpbiBsZWdlbmRhIG9yIGxlZ2VuZGEgPT0gJyc6CgkJCWxlZ2VuZGEgPSBsZWdlbmRhQXV4CgllbGlmICdkcml2ZS5nb29nbGUuY29tLycgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJc3RyZWFtLCBleHRfZyA9IFVSTFJlc29sdmVyTWVkaWEuR29vZ2xlVmlkZW8oc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pLmdldE1lZGlhVXJsKCkKCWVsaWYgJ2Nsb3VkLm1haWwucnUnIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXN0cmVhbSwgZXh0X2cgPSBVUkxSZXNvbHZlck1lZGlhLkNsb3VkTWFpbFJ1KHNlcnZpZG9yZXNbc2Vydmlkb3JdKS5nZXRNZWRpYVVybCgpCgllbGlmICdyYXBpZHZpZGVvLmNvbScgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl0gb3IgJ3JhcHR1JyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQlyYXBpZCA9IFVSTFJlc29sdmVyTWVkaWEuUmFwaWRWaWRlbyhzZXJ2aWRvcmVzW3NlcnZpZG9yXSkKCQlzdHJlYW0gPSByYXBpZC5nZXRNZWRpYVVybCgpCgkJbGVnZW5kYSA9IHJhcGlkLmdldExlZ2VuZGEoKQoJZWxpZiAndmlkb3phLm5ldCcgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJdmlkb3ogPSBVUkxSZXNvbHZlck1lZGlhLlZpZG96YShzZXJ2aWRvcmVzW3NlcnZpZG9yXSkKCQlzdHJlYW0gPSB2aWRvei5nZXRNZWRpYVVybCgpCgkJbGVnZW5kYSA9IHZpZG96LmdldExlZ2VuZGEoKQoJZWxpZiAnc3RyZWFtYW5nby4nIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXN0cmVhbWFuID0gVVJMUmVzb2x2ZXJNZWRpYS5TdHJlYW1hbmdvKHNlcnZpZG9yZXNbc2Vydmlkb3JdKQoJCXN0cmVhbSA9IHN0cmVhbWFuLmdldE1lZGlhVXJsKCkKCQlsZWdlbmRhID0gc3RyZWFtYW4uZ2V0TGVnZW5kYSgpCgkKCWlmIGNvaXNvID09ICdmaWxtZSc6CgkJbGVnZW5kYSA9IGxlZ2VuZGFBdXgKCQlpZiByZXN1bHRhZG9bJ0lNQkQnXSBub3QgaW4gbGVnZW5kYToKCQkJbGVnZW5kYSA9IF9fQVBJX18rJ3N1YnMvJXMuc3J0JyAlIHJlc3VsdGFkb1snSU1CRCddCgkKCWlmIGxlZ2VuZGEgPT0gJyc6CgkJbGVnZW5kYSA9IGxlZ2VuZGFBdXgKCXJldHVybiBzdHJlYW0sIGxlZ2VuZGEsIGV4dF9nCgoKZGVmIHBlc3F1aXNhTW92KHVybCk6Cgljb2RpZ29fZm9udGUgPSAnJwoJZGFkb3MgPSAnJwoJdGFiZWxhID0gJycKCXN0clBlc3F1aXNhID0gJycKCWZpY2hlaXJvID0gJycKCXNpdGUgPSAnJwoJcXVhbGlkYWRlID0gJycKCWlmICdmaWxtZXMnIGluIHVybDoKCQlmaWNoZWlybyA9IG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ2ZpbG1lc19wZXNxdWlzYS5saXZlaXQnKQoJCXRpcG8gPSAwCgkJcXVhbGlkYWRlID0gX19RdWFsaWRhZGVfXwoJZWxpZiAnc2VyaWVzJyBpbiB1cmw6CgkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdzZXJpZXNfcGVzcXVpc2EubGl2ZWl0JykKCQl0aXBvID0gMQoJCXNpdGUgPSAnc2VyaWVzJwoJCXF1YWxpZGFkZSA9ICcyJwoJZWxpZiAnYW5pbWVzJyBpbiB1cmw6CgkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdhbmltZXNfcGVzcXVpc2EubGl2ZWl0JykKCQl0aXBvID0gMgoJCXNpdGUgPSAnYW5pbWVzJwoJCXF1YWxpZGFkZSA9ICcyJwoJaWYgJ3BhZ2UnIG5vdCBpbiB1cmw6CgkJdHJ5OgoJCQl0aXBvID0geGJtY2d1aS5EaWFsb2coKS5zZWxlY3QodSdPbmRlIHF1ZXIgcGVzcXVpc2FyPycsIFsnRmlsbWVzJywgJ1NlcmllcycsICdBbmltZXMnXSkKCQlleGNlcHQ6CgkJCXJldHVybiBGYWxzZQoJCXRlY2xhZG8gPSB4Ym1jLktleWJvYXJkKCcnLCAnTyBxdWUgcXVlciBwZXNxdWlzYXI/JykKCQlpZiB0aXBvID09IDA6CgkJCXVybCA9IF9fQVBJX1NJVEVfXysnZmlsbWVzLnBocD9hY3Rpb249cGVzcXVpc2EnCgkJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnZmlsbWVzX3Blc3F1aXNhLmxpdmVpdCcpCgkJCXF1YWxpZGFkZSA9IF9fUXVhbGlkYWRlX18KCQllbGlmIHRpcG8gPT0gMToKCQkJdXJsID0gX19BUElfU0lURV9fKydzZXJpZXMucGhwP2FjdGlvbj1wZXNxdWlzYScKCQkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdzZXJpZXNfcGVzcXVpc2EubGl2ZWl0JykKCQkJcXVhbGlkYWRlID0gJzInCgkJCXNpdGUgPSAnc2VyaWVzJwoJCWVsaWYgdGlwbyA9PSAyOgoJCQl1cmwgPSBfX0FQSV9TSVRFX18rJ2FuaW1lcy5waHA/YWN0aW9uPXBlc3F1aXNhJwoJCQlmaWNoZWlybyA9IG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ2FuaW1lc19wZXNxdWlzYS5saXZlaXQnKQoJCQlxdWFsaWRhZGUgPSAnMicKCQkJc2l0ZSA9ICdhbmltZXMnCgkJaWYgeGJtY3Zmcy5leGlzdHMoZmljaGVpcm8pOgoJCQlmID0gb3BlbihmaWNoZWlybywgInIiKQoJCQl0ZXh0byA9IGYucmVhZCgpCgkJCWYuY2xvc2UoKQoJCQl0ZWNsYWRvLnNldERlZmF1bHQodGV4dG8pCgkJdGVjbGFkby5kb01vZGFsKCkJCgoJCWlmIHRlY2xhZG8uaXNDb25maXJtZWQoKToKCQkJc3RyUGVzcXVpc2EgPSB0ZWNsYWRvLmdldFRleHQoKQoJCQlpZiBzdHJQZXNxdWlzYSA9PSAnJzoKCQkJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0luc2lyYSBhbGdvIG5hIHBlc3F1aXNhLicpCgkJCQlhZGREaXIyKCdBbHRlcmFyIFBlc3F1aXNhJywgdXJsLCAxMjQsICcnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncGVzcXVpc2EucG5nJyksIDApCgkJCQlyZXR1cm4gRmFsc2UKCQkJZGFkb3MgPSB1cmxsaWIudXJsZW5jb2RlKHsndGV4dG8nOiBzdHJQZXNxdWlzYSwgJ3F1YWxpZGFkZSc6IHF1YWxpZGFkZX0pCgkJCXRyeToKCQkJCWYgPSBvcGVuKGZpY2hlaXJvLCBtb2RlPSJ3IikKCQkJCWYud3JpdGUoc3RyUGVzcXVpc2EpCgkJCQlmLmNsb3NlKCkKCQkJZXhjZXB0OgoJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnTsOjbyBncmF2b3UgbyBjb250ZXVkbyBlbSAnK2ZpY2hlaXJvKQoJCQlyZXN1bHRhZG8gPSBhYnJpcl91cmwodXJsLHBvc3Q9ZGFkb3MsIGhlYWRlcj1oZWFkZXJzLCBjb29raWU9Z2V0Q29va2llKCkpCgllbHNlOgoJCWlmIHhibWN2ZnMuZXhpc3RzKGZpY2hlaXJvKToKCQkJZiA9IG9wZW4oZmljaGVpcm8sICJyIikKCQkJdGV4dG8gPSBmLnJlYWQoKQoJCQlmLmNsb3NlKCkKCQlkYWRvcyA9IHVybGxpYi51cmxlbmNvZGUoeyd0ZXh0byc6IHRleHRvLCAncXVhbGlkYWRlJzpxdWFsaWRhZGV9KQoJCXJlc3VsdGFkbyA9IGFicmlyX3VybCh1cmwscG9zdD1kYWRvcywgaGVhZGVyPWhlYWRlcnMsIGNvb2tpZT1nZXRDb29raWUoKSkKCQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pCgl0cnk6CgkJaWYgcmVzdWx0YWRvWydjb2RpZ28nXSA9PSAyMDQ6CgkJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0RldmUgSW5kaWNhciB1bSB2YWxvciBwYXJhIHBlc3F1aXNhLicpCgkJCXJldHVybiBGYWxzZQoJZXhjZXB0OgoJCXJlc3VsdGFkbyA9IHJlc3VsdGFkbwoJdmlzdG9zID0gRGF0YWJhc2Uuc2VsZWN0RmlsbWVzKCkKCW9wY2FvID0gX19BRERPTl9fLmdldFNldHRpbmcoJ21hcmNhclZpc3RvJykKCglpZiByZXN1bHRhZG9bJ2RhdGEnXSAhPSAnJzoKCQlpZiB0aXBvID09IDA6CgkJCWZvciBpIGluIHJlc3VsdGFkb1snZGF0YSddOgoJCQkJc2V0RmlsbWUoaSwgdmlzdG9zLCBvcGNhbykKCQllbGlmIHRpcG8gPT0gMSBvciB0aXBvID09IDI6CgkJCWZvciBpIGluIHJlc3VsdGFkb1snZGF0YSddOgoJCQkJc2V0U2VyaWVzKGksIHZpc3Rvcywgb3BjYW8sIHNpdGUpCgkJCgkJY3VycmVudCA9IHJlc3VsdGFkb1snbWV0YSddWydjdXJyZW50J10KCQl0b3RhbCA9IHJlc3VsdGFkb1snbWV0YSddWyd0b3RhbCddCgkJdHJ5OiBwcm94aW1vID0gcmVzdWx0YWRvWydtZXRhJ11bJ3BhZ2luYWNhbyddWyduZXh0J10KCQlleGNlcHQ6IHBhc3MgCgkJaWYgaW50KGN1cnJlbnQpIDwgaW50KHRvdGFsKToKCQkJYWRkRGlyMignUHJveGltYSBwYWdpbmEgKCcrc3RyKGN1cnJlbnQpKycvJytzdHIodG90YWwpKycpJywgcHJveGltbywgMTI0LCAncGVzcXVpc2EnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncHJveGltby5wbmcnKSkKCQllbHNlOgoJCQl4Ym1jcGx1Z2luLmVuZE9mRGlyZWN0b3J5KGludChzeXMuYXJndlsxXSksY2FjaGVUb0Rpc2M9RmFsc2UpCgl2aXN0YV9maWxtZXNTZXJpZXMoKQoKZGVmIHBlc3F1aXNhKHNlcnZ1c3MpOgoJY29kaWdvX2ZvbnRlID0gJycKCWRhZG9zID0gJycKCW5ldCA9IE5ldCgpCgkjbmV0LnNldF9jb29raWVzKF9fQ09PS0lFX0ZJTEVfXykKCXRhYmVsYSA9ICcnCglzdHJQZXNxdWlzYSA9ICcnCglmaWNoZWlybyA9ICcnCgl1cmwgPSAnJwoJaWYgJ3BhZ2UnIG5vdCBpbiB1cmw6CgkJdXJsID0gX19TSVRFQkRfXysnc2VhcmNoLnBocCcKCQlpZiB0aXBvID09IDM6CgkJCXRhYmVsYSA9ICdjYW5haXNfa29kaScKCQkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdjYW5haXMubGl2ZWl0JykKCQllbGlmIHRpcG8gPT0gNDoKCQkJdGFiZWxhID0gJ3ByYWlhc19rb2RpJwoJCQlmaWNoZWlybyA9IG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ3ByYWlhcy5saXZlaXQnKQoJCWVsaWYgdGlwbyA9PSA1OgoJCQl0YWJlbGEgPSAncmFkaW9zX2tvZGknCgkJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywncmFkaW9zLmxpdmVpdCcpCgkJZWxzZToKCQkJdGFiZWxhID0gJ3Byb2dyYW1hc19rb2RpJwoJCQlmaWNoZWlybyA9IG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ3Byb2dyYW1hcy5saXZlaXQnKQoJCQoJCWlmIHhibWN2ZnMuZXhpc3RzKGZpY2hlaXJvKToKCQkJZiA9IG9wZW4oZmljaGVpcm8sICJyIikKCQkJdGV4dG8gPSBmLnJlYWQoKQoJCQlmLmNsb3NlKCkKCQkJdGVjbGFkby5zZXREZWZhdWx0KHRleHRvKQoJCXRlY2xhZG8uZG9Nb2RhbCgpCQoKCQlpZiB0ZWNsYWRvLmlzQ29uZmlybWVkKCk6CgkJCXN0clBlc3F1aXNhID0gdGVjbGFkby5nZXRUZXh0KCkKCQkJZGFkb3MgPSB1cmxsaWIudXJsZW5jb2RlKHsndGV4dG8nOiBzdHJQZXNxdWlzYSwgJ3F1YWxpZGFkZSc6IHF1YWxpZGFkZX0pCgkJCXRyeToKCQkJCWYgPSBvcGVuKGZpY2hlaXJvLCBtb2RlPSJ3IikKCQkJCWYud3JpdGUoc3RyUGVzcXVpc2EpCgkJCQlmLmNsb3NlKCkKCQkJZXhjZXB0OgoJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnTsOjbyBncmF2b3UgbyBjb250ZXVkbyBlbSAnK2ZpY2hlaXJvKQoJCQlyZXN1bHRhZG8gPSBhYnJpcl91cmwodXJsLHBvc3Q9ZGFkb3MsIGhlYWRlcj1oZWFkZXJzLCBjb29raWU9Z2V0Q29va2llKCkpCgllbHNlOgoJCWlmIHhibWN2ZnMuZXhpc3RzKGZpY2hlaXJvKToKCQkJZiA9IG9wZW4oZmljaGVpcm8sICJyIikKCQkJdGV4dG8gPSBmLnJlYWQoKQoJCQlmLmNsb3NlKCkKCQlkYWRvcyA9IHVybGxpYi51cmxlbmNvZGUoeyd0ZXh0byc6IHRleHRvLCAncXVhbGlkYWRlJzpxdWFsaWRhZGV9KQoJCXJlc3VsdGFkbyA9IGFicmlyX3VybCh1cmwscG9zdD1kYWRvcywgaGVhZGVyPWhlYWRlcnMsIGNvb2tpZT1nZXRDb29raWUoKSkKCQoJaWYgc3RyUGVzcXVpc2EgIT0gJyc6CgkJaWYgcmVzdWx0YWRvID09ICdETlMnOgoJCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdUZW0gZGUgYWx0ZXJhciBvcyBETlMgcGFyYSBwb2RlciB1c3VmcnVpciBkbyBfX0FERE9OX18uJykKCQkJcmV0dXJuIEZhbHNlCgkJCgkJeGJtY3BsdWdpbi5lbmRPZkRpcmVjdG9yeShpbnQoc3lzLmFyZ3ZbMV0pLGNhY2hlVG9EaXNjPUZhbHNlKQoJCWRhZG9zID0geydzZWFyY2hCb3gnOiBzdHJQZXNxdWlzYSwgJ3RhYmVsYSc6IHRhYmVsYX0KCQljb2RpZ29fZm9udGUgPSBuZXQuaHR0cF9QT1NUKHVybCwgZm9ybV9kYXRhPWRhZG9zLCBoZWFkZXJzPV9fSEVBREVSU19fKS5jb250ZW50LmRlY29kZSgnbGF0aW4tMScpLmVuY29kZSgidXRmLTgiKQoJCWluZm9ybWEgPSB7CgkJCQknc2Vydmlkb3InIDogewoJCQkJCSdub21lJzogJycsCgkJCQkJJ3NlcnYnOiAnJwoJCQkJfSwKCQkJCSdzZXJ2aWRvcmVzJzogW10sCgkJCQknY2FuYWlzJzogW10KCQkJfQoJCXN1Y2Vzc28gPSAnbm8nCgkJZWxlbXMgPSBFVC5mcm9tc3RyaW5nKGNvZGlnb19mb250ZSkKCQkKCQlmb3IgY2hpbGRlZSBpbiBlbGVtczoKCQkJaWYoY2hpbGRlZS50YWcgPT0gJ3NlcnZpZG9yZXMnKToKCQkJCXNlcnZpZG9yID0gewoJCQkJCSdub21lJzogJycsCgkJCQkJJ2xpbmsnOiAnJwoJCQkJfQoJCQkJZm9yIGdnIGluIGNoaWxkZWU6CQoJCQkJCWlmKGdnLnRhZyA9PSAnTm9tZScpOgoJCQkJCQlzZXJ2aWRvclsnbm9tZSddID0gZ2cudGV4dAkKCQkJCQllbGlmKGdnLnRhZyA9PSAnU2Vydmlkb3InKToKCQkJCQkJc2Vydmlkb3JbJ2xpbmsnXSA9IGdnLnRleHQJCQoJCQkJCWluZm9ybWFbJ3NlcnZpZG9yZXMnXS5hcHBlbmQoc2Vydmlkb3IpCgkJCQoJCWZvciBzZXJ2dnZ2IGluIGluZm9ybWFbJ3NlcnZpZG9yZXMnXToKCQkJaWYoc2VydnZ2dlsnbm9tZSddID09IHNlcnZ1c3MpOgoJCQkJaW5mb3JtYVsnc2Vydmlkb3InXVsnbm9tZSddID0gc2VydnZ2dlsnbm9tZSddCgkJCQlpbmZvcm1hWydzZXJ2aWRvciddWydzZXJ2J10gPSBzZXJ2dnZ2WydsaW5rJ10JCQkKCQkKCQlmb3IgY2hpbGQgaW4gZWxlbXM6CgkJCWlmKGNoaWxkLnRhZyA9PSAnc3VjZXNzbycpOgoJCQkJc3VjZXNzbyA9IGNoaWxkLnRleHQKCQkJZWxpZihjaGlsZC50YWcgPT0gJ2NhbmFpcycpOgoJCQkJY2FuYWwgPSB7CgkJCQkJJ25vbWUnOiAnJywKCQkJCQknbG9nbyc6ICcnLAoJCQkJCSdsaW5rJzogJycsCgkJCQkJJ2dydXBvJzogJycsCgkJCQkJJ25vbWVpZCc6ICcnLAoJCQkJCSdpZG5vdm8nOiAnJwoJCQkJfQoJCQkJYWRpY2lvbmEgPSBUcnVlCgkJCQlwYWdhbnRlID0gRmFsc2UKCQkJCWZvciBnIGluIGNoaWxkOgoJCQkJCWFkaWNpb25hID0gVHJ1ZQoJCQkJCWlmKGcudGFnID09ICdOb21lJyk6CgkJCQkJCWNhbmFsWydub21lJ10gPSBnLnRleHQKCQkJCQllbGlmKGcudGFnID09ICdJbWFnZW0nKToKCQkJCQkJY2FuYWxbJ2xvZ28nXSA9IGcudGV4dAoJCQkJCWVsaWYoZy50YWcgPT0gJ1BhZ2FudGUnKToKCQkJCQkJaWYoZy50ZXh0ID09ICd0cnVlJyk6CgkJCQkJCQlwYWdhbnRlID0gVHJ1ZQoJCQkJCWVsaWYoZy50YWcgPT0gJ1VybCcpOgoJCQkJCQl1cmxjaGFtYSA9IGcudGV4dC5zcGxpdCgnOycpCgkJCQkJCXVybG5vbyA9IGcudGV4dAoJCQkJCQl0cnk6CgkJCQkJCQlpZihzZXJ2dXNzID09ICdTZXJ2aWRvcjEnKToKCQkJCQkJCQl1cmxub28gPSB1cmxjaGFtYVswXQoJCQkJCQkJZWxpZihzZXJ2dXNzID09ICdTZXJ2aWRvcjInKToKCQkJCQkJCQl1cmxub28gPSB1cmxjaGFtYVsxXQoJCQkJCQkJZWxpZihzZXJ2dXNzID09ICdTZXJ2aWRvcjMnKToKCQkJCQkJCQl1cmxub28gPSB1cmxjaGFtYVsyXQoJCQkJCQkJZWxpZihzZXJ2dXNzID09ICdTZXJ2aWRvcjQnKToKCQkJCQkJCQl1cmxub28gPSB1cmxjaGFtYVszXQoJCQkJCQkJZWxpZihzZXJ2dXNzID09ICdTZXJ2aWRvcjUnKToKCQkJCQkJCQl1cmxub28gPSB1cmxjaGFtYVs0XQoJCQkJCQkJZWxpZihzZXJ2dXNzID09ICdTZXJ2aWRvcjYnKToKCQkJCQkJCQl1cmxub28gPSB1cmxjaGFtYVs1XQoJCQkJCQkJZWxpZihzZXJ2dXNzID09ICdTZXJ2aWRvcjcnKToKCQkJCQkJCQl1cmxub28gPSB1cmxjaGFtYVs2XQoJCQkJCQkJZWxpZihzZXJ2dXNzID09ICdTZXJ2aWRvcjgnKToKCQkJCQkJCQl1cmxub28gPSB1cmxjaGFtYVs3XQoJCQkJCQkJCgkJCQkJCQlpZih1cmxub28gPT0gJ25hZGEnKToKCQkJCQkJCQlhZGljaW9uYSA9IEZhbHNlCgkJCQkJCQllbHNlOgoJCQkJCQkJCWlmIHBhZ2FudGU6CgkJCQkJCQkJCWNhbmFsWydsaW5rJ10gPSBpbmZvcm1hWydzZXJ2aWRvciddWydzZXJ2J10rJ2xpdmUvdXRpbGl6YWRvcmxpdmVpdC9zZW5oYWxpdmVpdC8nK3VybG5vbwoJCQkJCQkJCWVsc2U6CgkJCQkJCQkJCWNhbmFsWydsaW5rJ10gPSB1cmxub28KCQkJCQkJZXhjZXB0OgoJCQkJCQkJY2FuYWxbJ2xpbmsnXSA9IGcudGV4dAoJCQkJCWVsaWYoZy50YWcgPT0gJ0dydXBvJyk6CgkJCQkJCWNhbmFsWydncnVwbyddID0gZy50ZXh0CgkJCQkJZWxpZihnLnRhZyA9PSAnTm9tZUlEJyk6CgkJCQkJCWNhbmFsWydub21laWQnXSA9IGcudGV4dAoJCQkJCWVsaWYoZy50YWcgPT0gJ0lEJyk6CgkJCQkJCWNhbmFsWydpZG5vdm8nXSA9IGcudGV4dAoJCQkJaWYgYWRpY2lvbmE6CgkJCQkJaW5mb3JtYVsnY2FuYWlzJ10uYXBwZW5kKGNhbmFsKQoKCQlpZiBzdWNlc3NvID09ICd5ZXMnOgoJCQlhZGREaXIyKCdBbHRlcmFyIFBlc3F1aXNhJywgc2VydnVzcywgMTIwLCAnJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Blc3F1aXNhLnBuZycpLCAwKQoJCQlmb3IgY2FubiBpbiBpbmZvcm1hWydjYW5haXMnXToKCQkJCW5vbWVlID0gY2Fublsnbm9tZSddCgkJCQlpbWcgPSBjYW5uWydsb2dvJ10KCQkJCXJ0bXAgPSBjYW5uWydsaW5rJ10ucmVwbGFjZSgnIHJ0bXAnLCdydG1wJykucmVwbGFjZSgnIHJ0c3AnLCdydHNwJykucmVwbGFjZSgnIGh0dHAnLCdodHRwJykucmVwbGFjZSgndXRpbGl6YWRvcmxpdmVpdCcsX19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX25hbWUiKSkucmVwbGFjZSgnc2VuaGFsaXZlaXQnLF9fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9wYXNzd29yZCIpKQoJCQkJZ3J1cCA9IGNhbm5bJ2dydXBvJ10KCQkJCWlkX2l0ID0gY2Fublsnbm9tZWlkJ10KCQkJCWlkX3AgPSBjYW5uWydpZG5vdm8nXQoJCQkJc3J0X2YgPSAnJwoJCQkJZGVzY3JpID0gJycKCQkJCQoJCQkJYWRkTGluazIobm9tZWUscnRtcCwnaHR0cDovL2xpdmVpdGtvZGkuY29tL0xvZ29zLycraW1nKQoJCQkKCQkJdmlzdGFfQ2FuYWlzKCkKCWVsc2U6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnSW5zaXJhIGFsZ28gbmEgcGVzcXVpc2EuJykKCQlhZGREaXIyKCdBbHRlcmFyIFBlc3F1aXNhJywgc2VydnVzcywgMTIwLCAnJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Blc3F1aXNhLnBuZycpLCAwKQoKZGVmIGRvd25sb2FkKHVybCxuYW1lLCB0ZW1wb3JhZGEsZXBpc29kaW8sc2VyaWVOb21lKToKCSNoZWFkZXJzWydBdXRob3JpemF0aW9uJ10gPSAnQmVhcmVyICVzJyAlIF9fQURET05fXy5nZXRTZXR0aW5nKCd0b2tlbk1ycGlyYWN5JykKCWxpbmtzID0gdXJsLnNwbGl0KCcvJykKCWlmICdmaWxtZScgaW4gdXJsOgoJCWlkX3ZpZGVvID0gbGlua3NbLTFdCgkJdGlwbyA9IDAKCWVsaWYgJ3NlcmllJyBpbiB1cmw6CgkJaWRfdmlkZW8gPSBsaW5rc1s1XQoJCXRlbXBvcmFkYSA9IGxpbmtzWzddCgkJZXBpc29kaW8gPSBsaW5rc1stMV0KCQl0aXBvID0gMQoJZWxpZiAnYW5pbWUnIGluIHVybDoKCQlpZF92aWRlbyA9IGxpbmtzWzVdCgkJdGVtcG9yYWRhID0gbGlua3NbN10KCQllcGlzb2RpbyA9IGxpbmtzWy0xXQoJCXRpcG8gPSAyCgoJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCwgaGVhZGVyPWhlYWRlcnMpCglpZiByZXN1bHRhZG8gPT0gJ0ROUyc6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVGVtIGRlIGFsdGVyYXIgb3MgRE5TIHBhcmEgcG9kZXIgdXN1ZnJ1aXIgZG8gX19BRERPTl9fLicpCgkJcmV0dXJuIEZhbHNlCgkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoKCXN0cmVhbSwgbGVnZW5kYSwgZXh0X2cgPSBnZXRTdHJlYW1MZWdlbmRhKHJlc3VsdGFkbykKCglmb2xkZXIgPSB4Ym1jLnRyYW5zbGF0ZVBhdGgoX19BRERPTl9fLmdldFNldHRpbmcoJ3Bhc3RhRG93bmxvYWRzJykpCglpZihmb2xkZXIgPT0gJ0VzY29saGEgYSBwYXN0YSBwYXJhIERvd25sb2FkJyk6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnU2VsZWNjaW9uZSB1bWEgcGFzdGEgcHJpbWVpcm8gbm8gc3VibWVudSBDcmVkw6puY2lhaXMgb3UgbmFzIENvbmZpZ3VyYcOnw7VlcyBkbyBfX0FERE9OX18uJykKCWVsc2U6CgkJaWYgdGlwbyA+IDA6CgkJCWlmIHRpcG8gPT0gMToKCQkJCXJlc3VsdGFkb2EgPSBhYnJpcl91cmwoX19BUElfU0lURV9fKydzZXJpZS8nK2lkX3ZpZGVvLCBoZWFkZXI9aGVhZGVycykKCQkJZWxpZiB0aXBvID09IDI6CgkJCQlyZXN1bHRhZG9hID0gYWJyaXJfdXJsKF9fQVBJX1NJVEVfXysnYW5pbWUvJytpZF92aWRlbywgaGVhZGVyPWhlYWRlcnMpCgkJCXJlc3VsdGFkb2EgPSBqc29uLmxvYWRzKHJlc3VsdGFkb2EpCgkJCWlmIG5vdCB4Ym1jdmZzLmV4aXN0cyhvcy5wYXRoLmpvaW4oZm9sZGVyLCdzZXJpZXMnKSk6CgkJCQl4Ym1jdmZzLm1rZGlycyhvcy5wYXRoLmpvaW4oZm9sZGVyLCdzZXJpZXMnKSkKCQkJaWYgbm90IHhibWN2ZnMuZXhpc3RzKG9zLnBhdGguam9pbihmb2xkZXIsJ3NlcmllcycscmVzdWx0YWRvYVsnbm9tZV9pbmdsZXMnXSkpOgoJCQkJeGJtY3Zmcy5ta2RpcnMob3MucGF0aC5qb2luKGZvbGRlciwnc2VyaWVzJyxyZXN1bHRhZG9hWydub21lX2luZ2xlcyddKSkKCQkJaWYgbm90IHhibWN2ZnMuZXhpc3RzKG9zLnBhdGguam9pbihmb2xkZXIsJ3NlcmllcycscmVzdWx0YWRvYVsnbm9tZV9pbmdsZXMnXSwiVGVtcG9yYWRhICIrc3RyKHRlbXBvcmFkYSkpKToKCQkJCXhibWN2ZnMubWtkaXJzKG9zLnBhdGguam9pbihmb2xkZXIsJ3NlcmllcycscmVzdWx0YWRvYVsnbm9tZV9pbmdsZXMnXSwiVGVtcG9yYWRhICIrc3RyKHRlbXBvcmFkYSkpKQoJCQlmb2xkZXIgPSBvcy5wYXRoLmpvaW4oZm9sZGVyLCAnc2VyaWVzJywgcmVzdWx0YWRvYVsnbm9tZV9pbmdsZXMnXSwgIlRlbXBvcmFkYSIsIHN0cih0ZW1wb3JhZGEpKQoJCQluYW1lID0gImUiK3N0cihlcGlzb2RpbykrIiAtICIrY2xlYW4ocmVzdWx0YWRvWydub21lX2VwaXNvZGlvJ10pCgkJZWxzZToKCQkJaWYgbm90IHhibWN2ZnMuZXhpc3RzKG9zLnBhdGguam9pbihmb2xkZXIsJ2ZpbG1lcycpKToKCQkJCXhibWN2ZnMubWtkaXJzKG9zLnBhdGguam9pbihmb2xkZXIsJ2ZpbG1lcycpKQoJCQlmb2xkZXIgPSBvcy5wYXRoLmpvaW4oZm9sZGVyLCdmaWxtZXMnKQoJCQluYW1lID0gcmVzdWx0YWRvWydub21lX2luZ2xlcyddCgoJCXN0cmVhbUF1eCA9IGNsZWFuKHN0cmVhbS5zcGxpdCgnLycpWy0xXSkKCQlleHRlbnNhb1N0cmVhbSA9IGNsZWFuKHN0cmVhbUF1eC5zcGxpdCgnLicpWy0xXSkKCgkJaWYgJz9taW0nIGluIGV4dGVuc2FvU3RyZWFtOgoJCQlleHRlbnNhb1N0cmVhbSA9IHJlLmNvbXBpbGUoJyguKz8pXD9taW1lPScpLmZpbmRhbGwoZXh0ZW5zYW9TdHJlYW0pWzBdCgoJCWlmIGV4dF9nICE9ICdjb2lzbyc6CgkJCWV4dGVuc2FvU3RyZWFtID0gZXh0X2cKCgkJbm9tZVN0cmVhbSA9IG5hbWUrJy4nK2V4dGVuc2FvU3RyZWFtCgkJbm9tZWxlZ2VuZGEgPSAnJwoJCURvd25sb2FkZXIuRG93bmxvYWRlcigpLmRvd25sb2FkKG9zLnBhdGguam9pbihmb2xkZXIuZGVjb2RlKCJ1dGYtOCIpLCBub21lU3RyZWFtKSwgc3RyZWFtLCBuYW1lKQoJCQoJCWlmIGxlZ2VuZGFzT246CgkJCWxlZ2VuZGFBdXggPSBjbGVhbihsZWdlbmRhLnNwbGl0KCcvJylbLTFdKQoJCQlleHRlbnNhb0xlZ2VuZGEgPSBjbGVhbihsZWdlbmRhQXV4LnNwbGl0KCcuJylbMV0pCgkJCW5vbWVMZWdlbmRhID0gbmFtZSsnLicrZXh0ZW5zYW9MZWdlbmRhCgkJCWRvd25sb2FkX2xlZ2VuZGFzKGxlZ2VuZGEsIG9zLnBhdGguam9pbihmb2xkZXIsIG5vbWVMZWdlbmRhKSkKCmRlZiBkb3dubG9hZF9sZWdlbmRhcyh1cmwscGF0aCk6Cgljb250ZW50cyA9IGFicmlyX3VybCh1cmwpCglpZiBjb250ZW50czoKCQlmaCA9IG9wZW4ocGF0aCwgJ3cnKQoJCWZoLndyaXRlKGNvbnRlbnRzKQoJCWZoLmNsb3NlKCkKCXJldHVybgoKZGVmIGNsZWFuKHRleHQpOgoJY29tbWFuZD17JyYjODIyMDsnOiciJywnJiM4MjIxOyc6JyInLCAnJiM4MjExOyc6Jy0nLCcmYW1wOyc6JyYnLCcmIzgyMTc7JzoiJyIsJyYjODIxNjsnOiInIn0KCXJlZ2V4ID0gcmUuY29tcGlsZSgifCIuam9pbihtYXAocmUuZXNjYXBlLCBjb21tYW5kLmtleXMoKSkpKQoJcmV0dXJuIHJlZ2V4LnN1YihsYW1iZGEgbW86IGNvbW1hbmRbbW8uZ3JvdXAoMCldLCB0ZXh0KQoKZGVmIGFkZFZpZGVvKG5hbWUsdXJsLG1vZGUsaWNvbmltYWdlLHZpc3RvLHRpcG8sdGVtcG9yYWRhLGVwaXNvZGlvLGluZm9MYWJlbHMscG9zdGVyLHRyYWlsZXI9RmFsc2Usc2VyaWVOb21lPUZhbHNlKToKCW1lbnUgPSBbXQoJCglpZiBpbmZvTGFiZWxzOiBpbmZvTGFiZWxzQXV4ID0gaW5mb0xhYmVscwoJZWxzZTogaW5mb0xhYmVsc0F1eCA9IHsnVGl0bGUnOiBuYW1lfQoKCWlmIHBvc3RlcjogcG9zdGVyQXV4ID0gcG9zdGVyCgllbHNlOiBwb3N0ZXJBdXggPSBpY29uaW1hZ2UKCQoJdHJ5OgoJCW5hbWUgPSBuYW1lLmVuY29kZSgndXRmLTgnKQoJZXhjZXB0OgoJCW5hbWUgPSBuYW1lCgkKCXRyeToKCQlzZXJpZU5vbWUgPSBzZXJpZU5vbWUuZW5jb2RlKCd1dGYtOCcpCglleGNlcHQ6CgkJc2VyaWVOb21lID0gc2VyaWVOb21lCgllbHNlOgoJCXBhc3MKCglmYW5hcnQgPSBfX0ZBTkFSVF9fCgkKCWlmIHRpcG8gPT0gJ2ZpbG1lJzoKCQl4Ym1jcGx1Z2luLnNldENvbnRlbnQoaW50KHN5cy5hcmd2WzFdKSwgJ01vdmllcycpCgkJaWYgX19BRERPTl9fLmdldFNldHRpbmcoJ3RyYWlsZXItZmlsbWVzJykgPT0gJ3RydWUnOgoJCQl0cnk6CgkJCQlpZFlvdXR1YmUgPSB0cmFpbGVyLnNwbGl0KCc/dj0nKVstMV0uc3BsaXQoJy8nKVstMV0uc3BsaXQoJz8nKVswXS5zcGxpdCgnJicpWzBdCgkJCQlsaW5rVHJhaWxlciA9ICdwbHVnaW46Ly9wbHVnaW4udmlkZW8ueW91dHViZS9wbGF5Lz92aWRlb19pZD0nK2lkWW91dHViZQoJCQkJI2lkWW91dHViZT10cmFpbGVyLnNwbGl0KCc9JykKCQkJCSNfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdJRDogJytpZFlvdXR1YmVbMV0pCgkJCQkjbGlua1RyYWlsZXIgPSAncGx1Z2luOi8vcGx1Z2luLnZpZGVvLnlvdXR1YmUvP3BhdGg9L3Jvb3QvdmlkZW8mYWN0aW9uPXBsYXlfdmlkZW8mdmlkZW9pZD0nK2lkWW91dHViZVsxXQoJCQkJI2xpbmtUcmFpbGVyID0gdHJhaWxlcgoJCQlleGNlcHQ6CgkJCQlsaW5rVHJhaWxlciA9ICcnCgkJZWxzZToKCQkJbGlua1RyYWlsZXIgPSAnJwoJZWxpZiB0aXBvID09ICdzZXJpZSc6CgkJeGJtY3BsdWdpbi5zZXRDb250ZW50KGludChzeXMuYXJndlsxXSksICd0dnNob3dzJykKCQlpZElNRGIgPSByZS5jb21waWxlKCdpbWRiPSguKz8pJicpLmZpbmRhbGwodXJsKVswXQoJCWxpbmtUcmFpbGVyID0gIiIKCWVsaWYgdGlwbyA9PSAnZXBpc29kaW8nOgoJCXhibWNwbHVnaW4uc2V0Q29udGVudChpbnQoc3lzLmFyZ3ZbMV0pLCAnZXBpc29kZXMnKQoJCWxpbmtUcmFpbGVyID0gIiIKCWVsc2U6CgkJeGJtY3BsdWdpbi5zZXRDb250ZW50KGludChzeXMuYXJndlsxXSksICdNb3ZpZXMnKQoJCWxpbmtUcmFpbGVyID0gIiIKCQoJb3ZlcmxheSA9IDYKCXBsYXljb3VudCA9IDAKCglpbmZvTGFiZWxzQXV4WyJvdmVybGF5Il0gPSBvdmVybGF5CglpbmZvTGFiZWxzQXV4WyJwbGF5Y291bnQiXSA9IHBsYXljb3VudAoJCglsaXo9eGJtY2d1aS5MaXN0SXRlbShuYW1lLCBpY29uSW1hZ2U9aWNvbmltYWdlLCB0aHVtYm5haWxJbWFnZT1pY29uaW1hZ2UpCglsaXouc2V0SW5mbyggdHlwZT0iVmlkZW8iLCBpbmZvTGFiZWxzPWluZm9MYWJlbHNBdXgpCglsaXouc2V0UHJvcGVydHkoJ2ZhbmFydF9pbWFnZScsIHBvc3RlcikKCWxpei5zZXRBcnQoeydmYW5hcnQnOiBwb3N0ZXJ9KQoJCgkKCWlmIG5vdCBzZXJpZU5vbWU6CgkJc2VyaWVOb21lID0gJycKCgl1PXN5cy5hcmd2WzBdKyI/dXJsPSIrdXJsbGliLnF1b3RlX3BsdXModXJsKSsiJm1vZGU9IitzdHIobW9kZSkrIiZ0ZW1wb3JhZGE9IitzdHIodGVtcG9yYWRhKSsiJmVwaXNvZGlvPSIrc3RyKGVwaXNvZGlvKSsiJm5hbWU9Iit1cmxsaWIucXVvdGVfcGx1cyhuYW1lKSsiJmljb25pbWFnZT0iK3VybGxpYi5xdW90ZV9wbHVzKGljb25pbWFnZSkrIiZzZXJpZU5vbWU9Iit1cmxsaWIucXVvdGVfcGx1cyhzZXJpZU5vbWUpCglvaz1UcnVlCgkKCWlmIGxpbmtUcmFpbGVyICE9ICIiOgoJCW1lbnUuYXBwZW5kKCgnVmVyIFRyYWlsZXInLCAnWEJNQy5QbGF5TWVkaWEoJXMpJyAlIChsaW5rVHJhaWxlcikpKQoJCSNtZW51LmFwcGVuZCgoJ1ZlciBUcmFpbGVyJywgJ1hCTUMuUnVuUGx1Z2luKCVzP21vZGU9MTA1Jm5hbWU9JXMmdXJsPSVzJmljb25pbWFnZT0lcyknJShzeXMuYXJndlswXSx1cmxsaWIucXVvdGVfcGx1cyhuYW1lKSwgbGlua1RyYWlsZXIsIHVybGxpYi5xdW90ZV9wbHVzKGljb25pbWFnZSkpKSkKCQoJbWVudS5hcHBlbmQoKCdEb3dubG9hZCcsICdYQk1DLlJ1blBsdWdpbiglcz9tb2RlPTExNyZuYW1lPSVzJnVybD0lcyZpY29uaW1hZ2U9JXMmc2VyaWVOb21lPSVzJnRlbXBvcmFkYT0lcyZlcGlzb2Rpbz0lcyknJShzeXMuYXJndlswXSx1cmxsaWIucXVvdGVfcGx1cyhuYW1lKSwgdXJsbGliLnF1b3RlX3BsdXModXJsKSwgdXJsbGliLnF1b3RlX3BsdXMoaWNvbmltYWdlKSwgdXJsbGliLnF1b3RlX3BsdXMoc2VyaWVOb21lKSwgc3RyKHRlbXBvcmFkYSksIHN0cihlcGlzb2RpbykpKSkKCWxpei5hZGRDb250ZXh0TWVudUl0ZW1zKG1lbnUsIHJlcGxhY2VJdGVtcz1UcnVlKQoJb2s9eGJtY3BsdWdpbi5hZGREaXJlY3RvcnlJdGVtKGhhbmRsZT1pbnQoc3lzLmFyZ3ZbMV0pLHVybD11LGxpc3RpdGVtPWxpeixpc0ZvbGRlcj1GYWxzZSkKCXJldHVybiBvawoKZGVmIEFkZERpcihuYW1lLCB1cmwsIG1vZGUsIGljb25pbWFnZT0nJywgbG9nb3M9JycsIGluZGV4PS0xLCBtb3ZlPTAsIGlzRm9sZGVyPVRydWUsIElzUGxheWFibGU9RmFsc2UsIGJhY2tncm91bmQ9Tm9uZSwgY2FjaGVNaW49JzAnLCBpbmZvPScnLCBtZXRhaD0nJyk6Cgl1cmxQYXJhbXMgPSB7J25hbWUnOiBuYW1lLCAndXJsJzogdXJsLCAnbW9kZSc6IG1vZGUsICdpY29uaW1hZ2UnOiBpY29uaW1hZ2UsICdsb2dvcyc6IGxvZ29zLCAnY2FjaGUnOiBjYWNoZU1pbiwgJ2luZm8nOiBpbmZvLCAnYmFja2dyb3VuZCc6IGJhY2tncm91bmQsICdtZXRhaCc6IG1ldGFofQoJbGl6ID0geGJtY2d1aS5MaXN0SXRlbShuYW1lLCBpY29uSW1hZ2U9aWNvbmltYWdlLCB0aHVtYm5haWxJbWFnZT1pY29uaW1hZ2UgKQoJaWYgbWV0YWg6CgkJbGl6LnNldEluZm8odHlwZT0iVmlkZW8iLCBpbmZvTGFiZWxzPW1ldGFoKQoJCWxpei5zZXRBcnQoeyJ0aHVtYiI6IG1ldGFoWydjb3Zlcl91cmwnXSwgInBvc3RlciI6IG1ldGFoWydjb3Zlcl91cmwnXSwgImJhbm5lciI6IG1ldGFoWydjb3Zlcl91cmwnXSwgImZhbmFydCI6IG1ldGFoWydiYWNrZHJvcF91cmwnXSB9KQoJZWxzZToKCQlsaXouc2V0SW5mbyh0eXBlPSJWaWRlbyIsIGluZm9MYWJlbHM9eyAiVGl0bGUiOiBuYW1lLCAiUGxvdCI6IGluZm8gfSkKCQkjbGl6LnNldFByb3BlcnR5KCJGYW5hcnRfSW1hZ2UiLCBsb2dvcykKCQlsaXouc2V0QXJ0KHsicG9zdGVyIjogaWNvbmltYWdlLCAiYmFubmVyIjogbG9nb3MsICJmYW5hcnQiOiBsb2dvcyB9KQoJI2xpc3RNb2RlID0gMjEgIyBMaXN0cwoJaWYgSXNQbGF5YWJsZToKCQlsaXouc2V0UHJvcGVydHkoJ0lzUGxheWFibGUnLCAndHJ1ZScpCglpdGVtcyA9IFtdCglpZiBtb2RlID09IDEgb3IgbW9kZSA9PSAyOgoJCWl0ZW1zID0gW10KCWlmIG1vZGUgPT0gMTA6CgkJdXJsUGFyYW1zWydpbmRleCddID0gaW5kZXgKCQoJI3U9c3lzLmFyZ3ZbMF0rIj91cmw9Iit1cmxsaWIucXVvdGVfcGx1cyh1cmwpKyImbmFtZT0iK3VybGxpYi5xdW90ZV9wbHVzKG5hbWUpKyImbW9kZT0iK2ludChtb2RlKSsiJm1vdmU9IitpbnQobW92ZSkrIiZpbmRleD0iK2ludChpbmRleCkrIiZpY29uaW1hZ2U9IitzdHIoaWNvbmltYWdlKSsiJmxvZ29zPSIrc3RyKGxvZ29zKSsiJmNhY2hlPSIrc3RyKGNhY2hlTWluKSsiJmluZm89IitzdHIoaW5mbykrIiZiYWNrZ3JvdW5kPSIrYmFja2dyb3VuZCsiJm1ldGFoPSIrc3RyKG1ldGFoKQoJI3U9c3lzLmFyZ3ZbMF0rIj91cmw9Iit1cmxsaWIucXVvdGVfcGx1cyh1cmwpKyImbW9kZT0iK3N0cihtb2RlKSsiJm5hbWU9Iit1cmxsaWIucXVvdGVfcGx1cyhuYW1lKSsiJnNlbmhhPSIrc3RyKHNlbmhhKSsiJmVzdGlsbz0iK3VybGxpYi5xdW90ZV9wbHVzKGVzdGlsbykrIiZ0aXBvbG9naWE9IitzdHIodGlwbykrIiZ0aXBvX3VzZXI9IitzdHIodGlwb191c2VyKSsiJnNlcnZpZG9yX3VzZXI9IitzdHIoc2Vydmlkb3JfdXNlcikrIiZkYXRhX3VzZXI9IitzdHIoZGF0YV91c2VyKSsiJmZhbmFydD0iK3N0cihmYW5hcnQpCgl1ID0gJ3swfT97MX0nLmZvcm1hdChzeXMuYXJndlswXSwgdXJsbGliLnVybGVuY29kZSh1cmxQYXJhbXMpKQoJb2s9eGJtY3BsdWdpbi5hZGREaXJlY3RvcnlJdGVtKGhhbmRsZT1pbnQoc3lzLmFyZ3ZbMV0pLHVybD11LCBsaXN0aXRlbT1saXosaXNGb2xkZXI9aXNGb2xkZXIpCglyZXR1cm4gb2sKCmRlZiBHZXRLZXlib2FyZFRleHQodGl0bGUgPSAiIiwgZGVmYXVsdFRleHQgPSAiIik6CglrZXlib2FyZCA9IHhibWMuS2V5Ym9hcmQoZGVmYXVsdFRleHQsIHRpdGxlKQoJa2V5Ym9hcmQuZG9Nb2RhbCgpCgl0ZXh0ID0gIiIgaWYgbm90IGtleWJvYXJkLmlzQ29uZmlybWVkKCkgZWxzZSBrZXlib2FyZC5nZXRUZXh0KCkKCXJldHVybiB0ZXh0CgpkZWYgUmVmcmVzaCgpOgoJeGJtYy5leGVjdXRlYnVpbHRpbigiWEJNQy5Db250YWluZXIuUmVmcmVzaCgpIikKCmRlZiBQbGF5VXJsKG5hbWUsIHVybCwgaWNvbmltYWdlPU5vbmUsIGluZm89JycsIHN1Yj0nJywgbWV0YWg9JycpOgoJaWYgIjs7OyIgaW4gYmFja2dyb3VuZDoKCQliID0gYmFja2dyb3VuZC5zcGxpdCgiOzs7IikKCXVybCA9IHJlLnN1YignXC5tcDQkJywgJy5tcDQ/cGxheScsIHVybCkKCXVybCA9IGNvbW1vbi5nZXRGaW5hbFVybCh1cmwpCgkjeGJtYy5sb2coJy0tLSBQbGF5aW5nICJ7MH0iLiB7MX0nLmZvcm1hdChuYW1lLCB1cmwpLCAyKQoJbGlzdGl0ZW0gPSB4Ym1jZ3VpLkxpc3RJdGVtKHBhdGg9dXJsKQoJaWYgbWV0YWg6CgkJbGlzdGl0ZW0uc2V0SW5mbyh0eXBlPSJWaWRlbyIsIGluZm9MYWJlbHM9bWV0YWgpCgllbHNlOgoJCWxpc3RpdGVtLnNldEluZm8odHlwZT0iVmlkZW8iLCBpbmZvTGFiZWxzPXsibWVkaWF0eXBlIjogInZpZGVvIiwgIlRpdGxlIjogbmFtZSwgIlBsb3QiOiBpbmZvIH0pCglpZiBzdWIhPScnOgoJCWxpc3RpdGVtLnNldFN1YnRpdGxlcyhbJ3NwZWNpYWw6Ly90ZW1wL2V4YW1wbGUuc3J0Jywgc3ViIF0pCglpZiBpY29uaW1hZ2UgaXMgbm90IE5vbmU6CgkJdHJ5OgoJCQlsaXN0aXRlbS5zZXRBcnQoeyd0aHVtYicgOiBpY29uaW1hZ2V9KQoJCWV4Y2VwdDoKCQkJbGlzdGl0ZW0uc2V0VGh1bWJuYWlsSW1hZ2UoaWNvbmltYWdlKQoJeGJtY3BsdWdpbi5zZXRSZXNvbHZlZFVybChpbnQoc3lzLmFyZ3ZbMV0pLCBUcnVlLCBsaXN0aXRlbSkKIyAtLS0tLS0tLS0tLS0tLSAgRklNIE5FVENJTkUKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwkJCQkJCQkJRlVOQ09FUyBKQSBGRUlUQVMJCQkJCQkJCSAjCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCmRlZiBhZGREaXIobmFtZSx1cmwsbW9kZSxlc3RpbG8saWNvbmltYWdlLHRpcG8sZmFuYXJ0LHBhc3RhPVRydWUsdG90YWw9MSk6Cgl0cnk6CgkJbmFtZSA9IG5hbWUuZW5jb2RlKCd1dGYtOCcpCglleGNlcHQ6CgkJbmFtZSA9IG5hbWUKCWlmKHRpcG8gPT0gJ2xpbXBhcmNhY2hlJyBhbmQgdGlwbyA9PSAnbGltcGFydHVkbycpOgkJCQkKCQl1PXN5cy5hcmd2WzBdKyI/dXJsPSIrdXJsbGliLnF1b3RlX3BsdXModXJsKSsiJm1vZGU9IitzdHIobW9kZSkKCWVsc2U6CgkJdT1zeXMuYXJndlswXSsiP3VybD0iK3VybGxpYi5xdW90ZV9wbHVzKHVybCkrIiZtb2RlPSIrc3RyKG1vZGUpKyImbmFtZT0iK3VybGxpYi5xdW90ZV9wbHVzKG5hbWUpKyImZXN0aWxvPSIrdXJsbGliLnF1b3RlX3BsdXMoZXN0aWxvKSsiJmZhbmFydD0iK3N0cihmYW5hcnQpCglvaz1UcnVlCglsaXo9eGJtY2d1aS5MaXN0SXRlbShuYW1lLCBpY29uSW1hZ2U9aWNvbmltYWdlLCB0aHVtYm5haWxJbWFnZT1pY29uaW1hZ2UpCglsaXouc2V0UHJvcGVydHkoJ2ZhbmFydF9pbWFnZScsIGZhbmFydCkKCWxpei5zZXRBcnQoeydmYW5hcnQnOiBmYW5hcnR9KQoJb2s9eGJtY3BsdWdpbi5hZGREaXJlY3RvcnlJdGVtKGhhbmRsZT1pbnQoc3lzLmFyZ3ZbMV0pLHVybD11LGxpc3RpdGVtPWxpeixpc0ZvbGRlcj1wYXN0YSx0b3RhbEl0ZW1zPXRvdGFsKQoJcmV0dXJuIG9rCgpkZWYgYWRkRGlyMihuYW1lLHVybCxtb2RlLG1vZGUyLGljb25pbWFnZSxwYWdpbmE9MSx0aXBvPU5vbmUsaW5mb0xhYmVscz1Ob25lLHBvc3Rlcj1Ob25lLHZpc3RvPUZhbHNlKToKCWlmIGluZm9MYWJlbHM6IGluZm9MYWJlbHNBdXggPSBpbmZvTGFiZWxzCgllbHNlOiBpbmZvTGFiZWxzQXV4ID0geydUaXRsZSc6IG5hbWV9CglmYW5hcnQgPSAnJwoJaWYgcG9zdGVyOiBmYW5hcnQgPSBwb3N0ZXIKCWVsc2U6IGZhbmFydCA9IGljb25pbWFnZQoJCgl0cnk6CgkJbmFtZSA9IG5hbWUuZW5jb2RlKCd1dGYtOCcpCglleGNlcHQ6CgkJbmFtZSA9IG5hbWUKCgl1PXN5cy5hcmd2WzBdKyI/dXJsPSIrdXJsbGliLnF1b3RlX3BsdXModXJsKSsiJm1vZG89Iittb2RlMisiJm1vZGU9IitzdHIobW9kZSkrIiZuYW1lPSIrdXJsbGliLnF1b3RlX3BsdXMobmFtZSkKCQoJb2s9VHJ1ZQoKCSNmYW5hcnQgPSBfX0ZBTkFSVF9fCgoJaWYgdGlwbyA9PSAnZmlsbWUnOgoJCSNmYW5hcnQgPSBwb3N0ZXJBdXgKCQl4Ym1jcGx1Z2luLnNldENvbnRlbnQoaW50KHN5cy5hcmd2WzFdKSwgJ01vdmllcycpCgllbGlmIHRpcG8gPT0gJ3NlcmllJzoKCQkjZmFuYXJ0ID0gcG9zdGVyQXV4CgkJeGJtY3BsdWdpbi5zZXRDb250ZW50KGludChzeXMuYXJndlsxXSksICd0dnNob3dzJykKCWVsaWYgdGlwbyA9PSAnZXBpc29kaW8nOgoJCSNmYW5hcnQgPSBwb3N0ZXJBdXgKCQl4Ym1jcGx1Z2luLnNldENvbnRlbnQoaW50KHN5cy5hcmd2WzFdKSwgJ2VwaXNvZGVzJykKCWVsc2U6CgkJaWYgbmFtZSAhPSAnUmVmcmVzaCc6CgkJCXhibWNwbHVnaW4uc2V0Q29udGVudChpbnQoc3lzLmFyZ3ZbMV0pLCAnTW92aWVzJykKCQoJb3ZlcmxheSA9IDYKCXBsYXljb3VudCA9IDAKCQoJaW5mb0xhYmVsc0F1eFsib3ZlcmxheSJdID0gb3ZlcmxheQoJaW5mb0xhYmVsc0F1eFsicGxheWNvdW50Il0gPSBwbGF5Y291bnQKCQoJbGl6PXhibWNndWkuTGlzdEl0ZW0obmFtZSwgaWNvbkltYWdlPWljb25pbWFnZSwgdGh1bWJuYWlsSW1hZ2U9aWNvbmltYWdlKQoJbGl6LnNldFByb3BlcnR5KCdmYW5hcnRfaW1hZ2UnLCBmYW5hcnQpCglsaXouc2V0QXJ0KHsnZmFuYXJ0JzogZmFuYXJ0fSkKCWxpei5zZXRJbmZvKCB0eXBlPSJWaWRlbyIsIGluZm9MYWJlbHM9aW5mb0xhYmVsc0F1eCApCgoJb2s9eGJtY3BsdWdpbi5hZGREaXJlY3RvcnlJdGVtKGhhbmRsZT1pbnQoc3lzLmFyZ3ZbMV0pLHVybD11LGxpc3RpdGVtPWxpeixpc0ZvbGRlcj1UcnVlKQoJcmV0dXJuIG9rCgpkZWYgYWRkTGlua0NhbmFsKG5hbWUsdXJsLGljb25pbWFnZSxpZGNhbmFsLGlkX3ApOgoJaW5mb0xhYmVsc3NzcyA9IHsidGl0bGUiOiBuYW1lLCAiZ2VucmUiOiAnQWxsJ30KCW9rPVRydWUKCWNtPVtdCgkKCWlmKGlkY2FuYWwgIT0gJzAwMDEnKToKCQljbS5hcHBlbmQoKCdWZXIgcHJvZ3JhbWHDp8OjbycsICdYQk1DLlJ1blBsdWdpbiglcz9tb2RlPTMxJm5hbWU9JXMmdXJsPSVzJmljb25pbWFnZT0lcyZpZENhbmFsPSVzJmlkZmZDYW5hbD0lcyknJShzeXMuYXJndlswXSx1cmxsaWIucXVvdGVfcGx1cyhuYW1lKSwgdXJsbGliLnF1b3RlX3BsdXModXJsKSwgdXJsbGliLnF1b3RlX3BsdXMoaWNvbmltYWdlKSwgaWRDYW5hbCwgaWRfcCkpKQoJCglsaXogPSB4Ym1jZ3VpLkxpc3RJdGVtKG5hbWUsIGljb25JbWFnZT1pY29uaW1hZ2UsIHRodW1ibmFpbEltYWdlPWljb25pbWFnZSkKCWxpei5zZXRJbmZvKCB0eXBlPSJWaWRlbyIsIGluZm9MYWJlbHM9aW5mb0xhYmVsc3NzcykKCWxpei5hZGRDb250ZXh0TWVudUl0ZW1zKGNtLCByZXBsYWNlSXRlbXM9RmFsc2UpCglsaXouc2V0UHJvcGVydHkoJ0lzUGxheWFibGUnLCAndHJ1ZScpCglsaXouc2V0UHJvcGVydHkoJ2ZhbmFydF9pbWFnZScsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb190di5wbmcnKSkKCWxpei5zZXRBcnQoeydmYW5hcnQnOiBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fdHYucG5nJyl9KQoJdSA9IHN5cy5hcmd2WzBdICsgIj91cmw9IiArIHVybGxpYi5xdW90ZV9wbHVzKHVybCkgKyAiJm1vZGU9MTEmbmFtZT0iICsgdXJsbGliLnF1b3RlX3BsdXMobmFtZSkgKyAiJmljb25pbWFnZT0iICsgdXJsbGliLnF1b3RlX3BsdXMoaWNvbmltYWdlKSsiJnN0cmVhbV9pZD0iK3N0cihpZGNhbmFsKQoJb2s9eGJtY3BsdWdpbi5hZGREaXJlY3RvcnlJdGVtKGhhbmRsZT1pbnQoc3lzLmFyZ3ZbMV0pLCB1cmw9dSwgbGlzdGl0ZW09bGl6KQoJcmV0dXJuIG9rCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwkJCQkJCQkJCQkJCQlFUEcJCQkJCQkJCQkJCQkJICMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCmRlZiBvYnRlcl9maWNoZWlyb19lcGcoKToKCV9fRVBHX18gPSBfX0FERE9OX18uZ2V0U2V0dGluZygibGlzdGFfZXBnIikKCWlmIG5vdCB4Ym1jdmZzLmV4aXN0cyhfX0ZPTERFUl9FUEdfXyk6CgkJeGJtY3Zmcy5ta2RpcnMoX19GT0xERVJfRVBHX18pCgoJdW5jb21wcmVzc2VkX3BhdGggPSBvcy5wYXRoLmpvaW4oX19GT0xERVJfRVBHX18sICdlcGcueG1sJykKCXVybCA9IHVybGxpYi51cmxvcGVuKF9fRVBHX18pCgljb2RpZ28gPSB1cmwucmVhZCgpCgl1cmwuY2xvc2UKCQoJb3Blbih1bmNvbXByZXNzZWRfcGF0aCwgJ3cnKS53cml0ZShjb2RpZ28pCgpkZWYgZ2V0UHJvZ3JhbWFjYW9EaWFyaWEoaWRDYW5hbCwgZGlhaG9yYSwgY29kaWdvKToKCXNvdXJjZSA9IHJlLmNvbXBpbGUoJzxwcm9ncmFtbWUgc3RhcnQ9IiguKz8pIFwrMDEwMCIgc3RvcD0iKC4rPykgXCswMTAwIiBjaGFubmVsPSInK2lkQ2FuYWwrJyI+XHMrPHRpdGxlIGxhbmc9InB0Ij4oLis/KTxcL3RpdGxlPicpLmZpbmRhbGwoY29kaWdvKQoKCXByb2dyYW1hID0gJycKCglmb3Igc3RhcnQsIHN0b3AsIHByb2dyYW1hMSAgaW4gc291cmNlOgoKCQlpZihpbnQoc3RhcnQpIDwgZGlhaG9yYSBhbmQgaW50KHN0b3ApID4gZGlhaG9yYSk6CgkJCXByb2dyYW1hID0gcHJvZ3JhbWExCglyZXR1cm4gcHJvZ3JhbWEKCgpkZWYgcHJvZ3JhbWFjYW9fY2FuYWwoaWRDYW5hbCk6CglfX0VQR19fID0gX19BRERPTl9fLmdldFNldHRpbmcoImxpc3RhX2VwZyIpCgl1cmwgPSB1cmxsaWIudXJsb3BlbihfX0VQR19fKQoJY29kaWdvID0gdXJsLnJlYWQoKQoJdXJsLmNsb3NlCgkKCXRzID0gdGltZS50aW1lKCkKCXN0ID0gaW50KGRhdGV0aW1lLmRhdGV0aW1lLmZyb210aW1lc3RhbXAodHMpLnN0cmZ0aW1lKCclWSVtJWQnKSkKCglkaWFob3JhID0gaW50KHN0cihzdCkrJzA2MDAwMCcpCglkaWFhbWFuaGEgPSBpbnQoc3RyKHN0KzEpKycwNjAwMDAnKQoKCXNvdXJjZSA9IHJlLmNvbXBpbGUoJzxwcm9ncmFtbWUgc3RhcnQ9IiguKz8pIFwrMDEwMCIgc3RvcD0iKC4rPykgXCswMTAwIiBjaGFubmVsPSInK2lkQ2FuYWwrJyI+XHMrPHRpdGxlIGxhbmc9InB0Ij4oLis/KTxcL3RpdGxlPicpLmZpbmRhbGwoY29kaWdvKQoKCXByb2dyYW1hID0gJycKCgl0aXRsZXM9WydbQl1bQ09MT1Igd2hpdGVdUHJvZ3JhbWHDp8OjbzpbL0NPTE9SXVsvQl0nXQoKCQoJZm9yIHN0YXJ0LCBzdG9wLCBwcm9ncmFtYTEgaW4gc291cmNlOgoKCQlzdGFydDEgPSByZS5jb21waWxlKCcoWzAtOV17NH1bMC0xXVswLTldWzAtM11bMC05XSkoWzAtOV17Mn0pKFswLTldezJ9KShbMC05XXsyfSknKS5maW5kYWxsKHN0YXJ0KQoJCXN0b3AxID0gcmUuY29tcGlsZSgnKFswLTldezR9WzAtMV1bMC05XVswLTNdWzAtOV0pKFswLTldezJ9KShbMC05XXsyfSkoWzAtOV17Mn0pJykuZmluZGFsbChzdG9wKQoKCQlpZihpbnQoc3RhcnQpID4gZGlhaG9yYSBhbmQgaW50KHN0YXJ0KSA8IGRpYWFtYW5oYSApOgoJCQl0aXRsZXMuYXBwZW5kKCdcbltCXSVzOiVzIC0+ICVzOiVzWy9CXSAtICVzJyAlIChzdGFydDFbMF1bMV0sIHN0YXJ0MVswXVsyXSwgc3RvcDFbMF1bMV0sIHN0b3AxWzBdWzJdLCBwcm9ncmFtYTEpKQoKCglwcm9ncmFtYWNhbyA9ICdcbicuam9pbih0aXRsZXMpCgl0cnk6CgkJeGJtYy5leGVjdXRlYnVpbHRpbigiQWN0aXZhdGVXaW5kb3coMTAxNDcpIikKCQl3aW5kb3cgPSB4Ym1jZ3VpLldpbmRvdygxMDE0NykKCQl4Ym1jLnNsZWVwKDEwMCkKCQl3aW5kb3cuZ2V0Q29udHJvbCgxKS5zZXRMYWJlbChBZGRvblRpdGxlKQoJCXdpbmRvdy5nZXRDb250cm9sKDUpLnNldFRleHQocHJvZ3JhbWFjYW8pCglleGNlcHQ6CgkJcGFzcwoKZGVmIGFicmlyX3VybCh1cmwsIHBvc3Q9Tm9uZSwgaGVhZGVyPU5vbmUsIGNvZGU9RmFsc2UsIGVycm89RmFsc2UsIGNvb2tpZT1Ob25lKToKCWlmIGhlYWRlciA9PSBOb25lOgoJCWhlYWRlciA9IGhlYWRlcnMKCWlmIGNvb2tpZToKCQloZWFkZXJbJ0Nvb2tpZSddID0gY29va2llCgkKCWlmIHBvc3Q6CgkJaGVhZGVyWydDb250ZW50LVR5cGUnXSA9J2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcKCQlyZXEgPSB1cmxsaWIyLlJlcXVlc3QodXJsLCBkYXRhPXBvc3QsIGhlYWRlcnM9aGVhZGVyKQoJZWxzZToKCQlyZXEgPSB1cmxsaWIyLlJlcXVlc3QodXJsLCBoZWFkZXJzPWhlYWRlcikKCXRyeToKCQlyZXNwb25zZSA9IHVybGxpYjIudXJsb3BlbihyZXEsY29udGV4dD1jb250ZXh0KQoJZXhjZXB0OgoJCXRyeToKCQkJcmVzcG9uc2UgPSB1cmxsaWIyLnVybG9wZW4ocmVxKQoJCWV4Y2VwdCB1cmxsaWIyLkhUVFBFcnJvciBhcyByZXNwb25zZToKCQkJaWYgZXJybyA9PSBUcnVlOgoJCQkJcmV0dXJuIHN0cihyZXNwb25zZS5jb2RlKSwgImFzZCIKCWxpbms9cmVzcG9uc2UucmVhZCgpCgkKCWlmICdqdWRpY2lhbCBibGJsYmxibGJsJyBpbiBsaW5rOgoJCXJldHVybiAnRE5TJwoJaWYgY29kZToKCQlyZXR1cm4gc3RyKHJlc3BvbnNlLmNvZGUpLCBsaW5rCgoJcmVzcG9uc2UuY2xvc2UoKQoJcmV0dXJuIGxpbmsKCmRlZiBhZGRMaW5rMihuYW1lLHVybCxpY29uaW1hZ2UpOgoJb2s9VHJ1ZQoJbGl6ID0geGJtY2d1aS5MaXN0SXRlbShuYW1lLCBpY29uSW1hZ2U9aWNvbmltYWdlLCB0aHVtYm5haWxJbWFnZT1pY29uaW1hZ2UpCglsaXouc2V0UHJvcGVydHkoJ2ZhbmFydF9pbWFnZScsIGljb25pbWFnZSkKCWxpei5zZXRBcnQoeydmYW5hcnQnOiBpY29uaW1hZ2V9KQoJbGl6LnNldEluZm8oIHR5cGU9IlZpZGVvIiwgaW5mb0xhYmVscz17ICJUaXRsZSI6IG5hbWUgfSkKCWxpei5zZXRQcm9wZXJ0eSgnSXNQbGF5YWJsZScsICd0cnVlJykKCXUgPSBzeXMuYXJndlswXSArICI/dXJsPSIgKyB1cmwgKyAiJm1vZGU9MTA2Jm5hbWU9IiArIG5hbWUgKyAiJmljb25pbWFnZT0iICsgaWNvbmltYWdlCglvaz14Ym1jcGx1Z2luLmFkZERpcmVjdG9yeUl0ZW0oaGFuZGxlPWludChzeXMuYXJndlsxXSksIHVybD11LCBsaXN0aXRlbT1saXopCglyZXR1cm4gb2sKCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCQkJCQkJCSAgREVGSU5JTkNPRVMJCQkJCQkJCQkJICAjCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCQoKZGVmIHZpc3RhX0dydXBvcygpOgoJb3BjYW8gPSBfX0FERE9OX18uZ2V0U2V0dGluZygnY2FuYWlzVmlldycpCglpZiBvcGNhbyA9PSAnMCc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MCkiKQoJZWxpZiBvcGNhbyA9PSAnMSc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MSkiKQoJZWxpZiBvcGNhbyA9PSAnMic6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDApIikKCWVsaWYgb3BjYW8gPT0gJzMnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA5KSIpCgllbGlmIG9wY2FvID09ICczJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwOCkiKQoJZWxpZiBvcGNhbyA9PSAnNCc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDQpIikKCWVsaWYgb3BjYW8gPT0gJzUnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTAzKSIpCgllbGlmIG9wY2FvID09ICc2JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUxNSkiKQoJZWxpZiBvcGNhbyA9PSAnNyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1NSkiKQoKZGVmIHZpc3RhX0NhbmFpcygpOgoJb3BjYW8gPSBfX0FERE9OX18uZ2V0U2V0dGluZygnY2FuYWlzVmlldzInKQoJaWYgb3BjYW8gPT0gJzAnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTApIikKCWVsaWYgb3BjYW8gPT0gJzEnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTEpIikKCWVsaWYgb3BjYW8gPT0gJzInOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTAwKSIpCgllbGlmIG9wY2FvID09ICczJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwOSkiKQoJZWxpZiBvcGNhbyA9PSAnMyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDgpIikKCWVsaWYgb3BjYW8gPT0gJzQnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA0KSIpCgllbGlmIG9wY2FvID09ICc1JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwMykiKQoJZWxpZiBvcGNhbyA9PSAnNic6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MTUpIikKCWVsaWYgb3BjYW8gPT0gJzcnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTUpIikKCmRlZiB2aXN0YV9tZW51KCk6CglvcGNhbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCdtZW51VmlldycpCglpZiBvcGNhbyA9PSAnMCc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MCkiKQoJZWxpZiBvcGNhbyA9PSAnMSc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MSkiKQoJZWxpZiBvcGNhbyA9PSAnMic6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDApIikKCWVsaWYgb3BjYW8gPT0gJzMnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA5KSIpCgllbGlmIG9wY2FvID09ICczJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwOCkiKQoJZWxpZiBvcGNhbyA9PSAnNCc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDQpIikKCWVsaWYgb3BjYW8gPT0gJzUnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTAzKSIpCgllbGlmIG9wY2FvID09ICc2JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUxNSkiKQoJZWxpZiBvcGNhbyA9PSAnNyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1NSkiKQoKZGVmIHZpc3RhX2ZpbG1lc1NlcmllcygpOgoJb3BjYW8gPSBfX0FERE9OX18uZ2V0U2V0dGluZygnZmlsbWVzU2VyaWVzVmlldycpCglpZiBvcGNhbyA9PSAnMCc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MCkiKQoJZWxpZiBvcGNhbyA9PSAnMSc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MSkiKQoJZWxpZiBvcGNhbyA9PSAnMic6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDApIikKCWVsaWYgb3BjYW8gPT0gJzMnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA5KSIpCgllbGlmIG9wY2FvID09ICczJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwOCkiKQoJZWxpZiBvcGNhbyA9PSAnNCc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDQpIikKCWVsaWYgb3BjYW8gPT0gJzUnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTAzKSIpCgllbGlmIG9wY2FvID09ICc2JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUxNSkiKQoJZWxpZiBvcGNhbyA9PSAnNyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1NSkiKQoKCmRlZiB2aXN0YV90ZW1wb3JhZGFzKCk6CglvcGNhbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCd0ZW1wb3JhZGFzVmlldycpCglpZiBvcGNhbyA9PSAnMCc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MCkiKQoJZWxpZiBvcGNhbyA9PSAnMSc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MSkiKQoJZWxpZiBvcGNhbyA9PSAnMic6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDApIikKCWVsaWYgb3BjYW8gPT0gJzMnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA5KSIpCgllbGlmIG9wY2FvID09ICczJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwOCkiKQoJZWxpZiBvcGNhbyA9PSAnNCc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDQpIikKCWVsaWYgb3BjYW8gPT0gJzUnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTAzKSIpCgllbGlmIG9wY2FvID09ICc2JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUxNSkiKQoJZWxpZiBvcGNhbyA9PSAnNyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1NSkiKQoKZGVmIHZpc3RhX2VwaXNvZGlvcygpOgoJI3hibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MCkiKQoJb3BjYW8gPSBfX0FERE9OX18uZ2V0U2V0dGluZygnZXBpc29kaW9zVmlldycpCglpZiBvcGNhbyA9PSAnMCc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MCkiKQoJZWxpZiBvcGNhbyA9PSAnMSc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MSkiKQoJZWxpZiBvcGNhbyA9PSAnMic6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDApIikKCWVsaWYgb3BjYW8gPT0gJzMnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA5KSIpCgllbGlmIG9wY2FvID09ICczJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwOCkiKQoJZWxpZiBvcGNhbyA9PSAnNCc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDQpIikKCWVsaWYgb3BjYW8gPT0gJzUnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTAzKSIpCgllbGlmIG9wY2FvID09ICc2JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUxNSkiKQoJZWxpZiBvcGNhbyA9PSAnNyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1NSkiKQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwkJCQkJCQkJCQkJCUdFVCBQQVJBTVMJCQkJCQkJCQkJCQkgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMJCSAgCmRlZiBnZXRfcGFyYW1zKCk6CglwYXJhbT1bXQoJcGFyYW1zdHJpbmc9c3lzLmFyZ3ZbMl0KCWlmIGxlbihwYXJhbXN0cmluZyk+PTI6CgkJcGFyYW1zPXN5cy5hcmd2WzJdCgkJY2xlYW5lZHBhcmFtcz1wYXJhbXMucmVwbGFjZSgnPycsJycpCgkJaWYgKHBhcmFtc1tsZW4ocGFyYW1zKS0xXT09Jy8nKTogcGFyYW1zPXBhcmFtc1swOmxlbihwYXJhbXMpLTJdCgkJcGFpcnNvZnBhcmFtcz1jbGVhbmVkcGFyYW1zLnNwbGl0KCcmJykKCQlwYXJhbT17fQoJCWZvciBpIGluIHJhbmdlKGxlbihwYWlyc29mcGFyYW1zKSk6CgkJCXNwbGl0cGFyYW1zPXt9CgkJCXNwbGl0cGFyYW1zPXBhaXJzb2ZwYXJhbXNbaV0uc3BsaXQoJz0nKQoJCQlpZiAobGVuKHNwbGl0cGFyYW1zKSk9PTI6IHBhcmFtW3NwbGl0cGFyYW1zWzBdXT1zcGxpdHBhcmFtc1sxXQoJcmV0dXJuIHBhcmFtCgoKcGFyYW1zPWdldF9wYXJhbXMoKQp1cmw9Tm9uZQpidWlsZHRpcG89Tm9uZQpuYW1lPU5vbmUKbW9kZT1Ob25lCm1vZG89Tm9uZQppY29uaW1hZ2U9Tm9uZQpsaW5rPU5vbmUKc2VuaGE9Tm9uZQplc3RpbG89Tm9uZQpzcnRmaWxtPU5vbmUKaWRDYW5hbD1Ob25lCmlkZmZDYW5hbD1Ob25lCnRpcG9sb2dpYT1Ob25lCmRlc2NyaWNhbz1Ob25lCnRpcG9fdXNlcj1Ob25lCnNlcnZpZG9yX3VzZXI9Tm9uZQpkYXRhX3VzZXI9Tm9uZQpzX3NlcnY9Tm9uZQp0aXBvPU5vbmUKc191c2VyPU5vbmUKc19wYXNzPU5vbmUKbGVnZW5kYT1Ob25lCnBhZ2luYT1Ob25lCnRlbXBvcmFkYT1Ob25lCmVwaXNvZGlvPU5vbmUKc2VyaWVOb21lPU5vbmUKZmFuYXJ0PU5vbmUKdGh1bWJuYWlsPU5vbmUKc3RyZWFtX2lkPU5vbmUKZHVyYXRpb249Tm9uZQp0aXBvc2VsZWN0PU5vbmUKYmFja2dyb3VuZD1Ob25lCmluZm89Tm9uZQpsb2dvcz1Ob25lCmNhY2hlPU5vbmUKaW5kZXg9Tm9uZQptb3ZlPU5vbmUKbWV0YWg9Tm9uZQpwbG90PU5vbmUKCnRyeTogCglsb2dvcz11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sibG9nb3MiXSkKZXhjZXB0OiAKCXBhcmFtcyA9IGRpY3QodXJscGFyc2UucGFyc2VfcXNsKHN5cy5hcmd2WzJdLnJlcGxhY2UoJz8nLCcnKSkpCglsb2dvcyA9IHBhcmFtcy5nZXQoJ2xvZ29zJywgJycpCgp0cnk6IAoJY2FjaGU9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImNhY2hlIl0pCmV4Y2VwdDogCglwYXJhbXMgPSBkaWN0KHVybHBhcnNlLnBhcnNlX3FzbChzeXMuYXJndlsyXS5yZXBsYWNlKCc/JywnJykpKQoJY2FjaGUgPSBwYXJhbXMuZ2V0KCdjYWNoZScsICcnKQoKdHJ5OiAKCWluZGV4PXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJpbmRleCJdKQpleGNlcHQ6IAoJcGFyYW1zID0gZGljdCh1cmxwYXJzZS5wYXJzZV9xc2woc3lzLmFyZ3ZbMl0ucmVwbGFjZSgnPycsJycpKSkKCWluZGV4ID0gcGFyYW1zLmdldCgnaW5kZXgnLCAnJykKCnRyeTogCgltb3ZlPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJtb3ZlIl0pCmV4Y2VwdDogCglwYXJhbXMgPSBkaWN0KHVybHBhcnNlLnBhcnNlX3FzbChzeXMuYXJndlsyXS5yZXBsYWNlKCc/JywnJykpKQoJbW92ZSA9IHBhcmFtcy5nZXQoJ21vdmUnLCAnJykKCnRyeTogCgltZXRhaD11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sibWV0YWgiXSkKZXhjZXB0OiAKCXBhcmFtcyA9IGRpY3QodXJscGFyc2UucGFyc2VfcXNsKHN5cy5hcmd2WzJdLnJlcGxhY2UoJz8nLCcnKSkpCgltZXRhaCA9IHBhcmFtcy5nZXQoJ21ldGFoJywgJycpCgp0cnk6IAoJYmFja2dyb3VuZD11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1siYmFja2dyb3VuZCJdKQpleGNlcHQ6IAoJcGFyYW1zID0gZGljdCh1cmxwYXJzZS5wYXJzZV9xc2woc3lzLmFyZ3ZbMl0ucmVwbGFjZSgnPycsJycpKSkKCWJhY2tncm91bmQgPSBwYXJhbXMuZ2V0KCdiYWNrZ3JvdW5kJywgJycpCgp0cnk6IAoJaW5mbz11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1siaW5mbyJdKQpleGNlcHQ6IAoJcGFyYW1zID0gZGljdCh1cmxwYXJzZS5wYXJzZV9xc2woc3lzLmFyZ3ZbMl0ucmVwbGFjZSgnPycsJycpKSkKCWluZm8gPSBwYXJhbXMuZ2V0KCdpbmZvJywgJycpCgp0cnk6IHRpcG89cGFyYW1zWyJ0aXBvIl0KZXhjZXB0OiBwYXNzCnRyeTogZHVyYXRpb249dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImR1cmF0aW9uIl0pCmV4Y2VwdDogcGFzcwp0cnk6IHN0cmVhbV9pZD11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sic3RyZWFtX2lkIl0pCmV4Y2VwdDogcGFzcwp0cnk6IHVybD11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sidXJsIl0pCmV4Y2VwdDogcGFzcwp0cnk6IG5hbWU9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbIm5hbWUiXSkKZXhjZXB0OiBwYXNzCnRyeTogZXN0aWxvPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJlc3RpbG8iXSkKZXhjZXB0OiBwYXNzCnRyeTogbW9kZT1pbnQocGFyYW1zWyJtb2RlIl0pCmV4Y2VwdDogcGFzcwp0cnk6IG1vZG89cGFyYW1zWyJtb2RvIl0KZXhjZXB0OiBwYXNzCnRyeTogaWNvbmltYWdlPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJpY29uaW1hZ2UiXSkKZXhjZXB0OiBwYXNzCnRyeTogc2VuaGE9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbInNlbmhhIl0pCmV4Y2VwdDogcGFzcwp0cnk6IGlkQ2FuYWw9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImlkQ2FuYWwiXSkKZXhjZXB0OiBwYXNzCnRyeTogaWRmZkNhbmFsPXBhcmFtc1siaWRmZkNhbmFsIl0KZXhjZXB0OiBwYXNzCnRyeTogc3J0ZmlsbT11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sic3J0ZmlsbSJdKQpleGNlcHQ6IHBhc3MKdHJ5OiB0aXBvbG9naWE9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbInRpcG9sb2dpYSJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBkZXNjcmljYW89dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImRlc2NyaWNhbyJdKQpleGNlcHQ6IHBhc3MKdHJ5OiB0aXBvX3VzZXI9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbInRpcG9fdXNlciJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBzZXJ2aWRvcl91c2VyPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJzZXJ2aWRvcl91c2VyIl0pCmV4Y2VwdDogcGFzcwp0cnk6IHNfc2Vydj11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sibG9sc2VydiJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBzX3VzZXI9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImxvbHVzZXIiXSkKZXhjZXB0OiBwYXNzCnRyeTogc19wYXNzPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJsb2xwYXNzIl0pCmV4Y2VwdDogcGFzcwp0cnk6IGxpbms9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImxpbmsiXSkKZXhjZXB0OiBwYXNzCnRyeTogbGVnZW5kYT11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sibGVnZW5kYSJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBuYW1lPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJuYW1lIl0pCmV4Y2VwdDogcGFzcwp0cnk6IHRlbXBvcmFkYT1pbnQocGFyYW1zWyJ0ZW1wb3JhZGEiXSkKZXhjZXB0OiBwYXNzCnRyeTogZXBpc29kaW89aW50KHBhcmFtc1siZXBpc29kaW8iXSkKZXhjZXB0OiBwYXNzCnRyeTogbW9kZT1pbnQocGFyYW1zWyJtb2RlIl0pCmV4Y2VwdDogcGFzcwp0cnk6IHBhZ2luYT1pbnQocGFyYW1zWyJwYWdpbmEiXSkKZXhjZXB0OiBwYXNzCnRyeTogaWNvbmltYWdlPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJpY29uaW1hZ2UiXSkKZXhjZXB0OiBwYXNzCnRyeSA6IHNlcmllTm9tZT11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sic2VyaWVOb21lIl0pCmV4Y2VwdDogcGFzcwp0cnkgOiBidWlsZHRpcG89dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImJ1aWxkdGlwbyJdKQpleGNlcHQ6IHBhc3MKdHJ5IDogZmFuYXJ0PXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJmYW5hcnQiXSkKZXhjZXB0OiBwYXNzCnRyeSA6IHBsb3Q9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbInBsb3QiXSkKZXhjZXB0OiBwYXNzCnRyeSA6IHRodW1ibmFpbD11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sidGh1bWJuYWlsIl0pCmV4Y2VwdDogcGFzcwp0cnkgOiBkYXRhX3VzZXI9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImRhdGFfdXNlciJdKQpleGNlcHQ6IHBhc3MKdHJ5IDogdGlwb3NlbGVjdD11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sidGlwb3NlbGVjdCJdKQpleGNlcHQ6IHBhc3MKCgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMJCQkJCQkJCQkJCQkJTU9ET1MJCQkJCQkJCQkJCQkJICMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCmlmIG1vZGU9PU5vbmUgb3IgdXJsPT1Ob25lIG9yIGxlbih1cmwpPDE6IG1lbnUoKQplbGlmIG1vZGU9PTE6IGFicmlyVmlkZW9DbHViZShzdHIodXJsKSkKZWxpZiBtb2RlPT0xMDE6IGxpc3Rhcl9ncnVwb3MxKG1vZGUsdXJsLGZhbmFydCkKZWxpZiBtb2RlPT0xMDI6IGxpc3Rhcl9ncnVwb3MyKG1vZGUsdXJsLGZhbmFydCkKZWxpZiBtb2RlPT0xMDM6IGxpc3Rhcl9ncnVwb3MzKG1vZGUsdXJsLGZhbmFydCkKZWxpZiBtb2RlPT0xMDQ6IGxpc3Rhcl9ncnVwb3M0KG1vZGUsdXJsLGljb25pbWFnZSxmYW5hcnQpCmVsaWYgbW9kZT09MTA2OiBhYnJpckV4dHJhcygpCmVsaWYgbW9kZT09MTA3OiBsaXN0YXJfZ3J1cG9zNShtb2RlLHVybCxmYW5hcnQpCmVsaWYgbW9kZT09MTA4OiBsaXN0YXJfZ3J1cG9zNihtb2RlLHVybCxpY29uaW1hZ2UsZmFuYXJ0KQplbGlmIG1vZGU9PTEwOTogcGxheV9tdWx0X2NhbmFsMih1cmwsaWNvbmltYWdlLHN0cihuYW1lKSkKZWxpZiBtb2RlPT0yOiBBYnJpcl9Db250YShzdHIodXJsKSkKZWxpZiBtb2RlPT0zOiBhYnJpbTN1KHN0cih1cmwpKQplbGlmIG1vZGU9PTQ6IGRldGVjdF9tb2RpZmljYXRpb24oc3RyKHVybCkpCmVsaWYgbW9kZT09NTogYWJyaXJEZWZpbmluY29lcygpCmVsaWYgbW9kZT09NjogbGlzdGF0dmFyY2hpdmUoc3RyKHVybCkpCmVsaWYgbW9kZT09NzogbGlzdGF0dmFyY2hpdmVjYW5haXMoc3RyKG5hbWUpLHN0cmVhbV9pZCxzdHIodXJsKSxkdXJhdGlvbixpY29uaW1hZ2UsZmFuYXJ0KQplbGlmIG1vZGU9PTg6IHN0cmVhbV92aWRlbyhuYW1lLHVybCxpY29uaW1hZ2UpCmVsaWYgbW9kZT09OTogZ2V0X215YWNjb3VudChuYW1lLHVybCxpY29uaW1hZ2UpCmVsaWYgbW9kZT09MTA6IHJ1bl9jcm9uam9iKG5hbWUsc3RyKHVybCksaWNvbmltYWdlLHBsb3QsZmFuYXJ0KQplbGlmIG1vZGU9PTExOiBQbGF5VXJsKG5hbWUsdXJsLGljb25pbWFnZSkKZWxpZiBtb2RlPT0xMzogQ0xFQVJDQUNIRSgpCmVsaWYgbW9kZT09MTQ6IFBVUkdFUEFDS0FHRVMoKQplbGlmIG1vZGU9PTIwOiBsaXN0YW1lbnVzc2VyaWVzKHN0cihuYW1lKSxzdHIodXJsKSxlc3RpbG8sdGlwb2xvZ2lhLHRpcG9fdXNlcixzZXJ2aWRvcl91c2VyLGljb25pbWFnZSxmYW5hcnQpCmVsaWYgbW9kZT09MjE6IGxpc3RhbWVudXNmaWxtZXMoc3RyKG5hbWUpLHN0cih1cmwpLGVzdGlsbyx0aXBvbG9naWEsdGlwb191c2VyLHNlcnZpZG9yX3VzZXIsaWNvbmltYWdlLGZhbmFydCkKZWxpZiBtb2RlPT0yNDogbGlzdGFtZW51c2FuaW1lcyhzdHIobmFtZSksc3RyKHVybCksZXN0aWxvLHRpcG9sb2dpYSx0aXBvX3VzZXIsc2Vydmlkb3JfdXNlcixpY29uaW1hZ2UsZmFuYXJ0KQplbGlmIG1vZGU9PTExMTExOiBmaWxtZXMyKHVybCkKZWxpZiBtb2RlPT0xMTExMjogc2VyaWVzMih1cmwpCmVsaWYgbW9kZT09MTExMTM6IHBsYXllcjIobmFtZSwgdXJsLCBpY29uaW1hZ2UsIG1vZG8sIHRlbXBvcmFkYSwgZXBpc29kaW8sIHRpcG8pCmVsaWYgbW9kZT09MTExMTQ6IGdldFNlYXNvbnMyKHVybCwgbW9kbykKZWxpZiBtb2RlPT0xMTExNTogZ2V0RXBpc29kZXMyKHVybCkKZWxpZiBtb2RlPT0xMTExODogZ2V0WWVhcnNfbGl2ZSh1cmwsIG1vZG8pCmVsaWYgbW9kZT09MTExMTk6IGdldEdlbmVyb3NfbGl2ZSh1cmwsIG1vZG8pCmVsaWYgbW9kZT09MTExMTk5OiBnZXRHZW5lcm9zMl9saXZlKHVybCwgbW9kbykKZWxpZiBtb2RlPT0xMTEyMDogcGVzcXVpc2FfbGl2ZSh1cmwsIG1vZG8pCmVsaWYgbW9kZT09MTExMjE6IGdldEluZm9fbGl2ZSh1cmwsIG1vZG8pCmVsaWYgbW9kZT09MjExMTE6IGxpc3RhbWVudXNfbGl2ZWl0MSgpCmVsaWYgbW9kZT09MjExMTI6IGxpc3RhbWVudXNfbGl2ZWl0MigpCmVsaWYgbW9kZT09MTExOiBmaWxtZXModXJsLCBwYWdpbmEpCmVsaWYgbW9kZT09MTIzOiBzZXJpZXModXJsKQplbGlmIG1vZGU9PTExODogZ2V0R2VuZXJvcyh1cmwpCmVsaWYgbW9kZT09MTE5OiBnZXRZZWFycyh1cmwpCmVsaWYgbW9kZT09MTIwOiBwZXNxdWlzYSh1cmwpCmVsaWYgbW9kZT09MTIxOiBhbm9zKHVybCkKZWxpZiBtb2RlPT0xMjI6IGNhdGVnb3JpYXModXJsKQplbGlmIG1vZGU9PTExMzogcGxheWVyKG5hbWUsIHVybCwgaWNvbmltYWdlLCB0ZW1wb3JhZGEsIGVwaXNvZGlvLCBzZXJpZU5vbWUpCmVsaWYgbW9kZT09MTE0OiBnZXRTZWFzb25zKHVybCkKZWxpZiBtb2RlPT0xMTU6IGdldEVwaXNvZGVzKHVybCkKZWxpZiBtb2RlPT0xMTc6IGRvd25sb2FkKHVybCwgbmFtZSwgdGVtcG9yYWRhLCBlcGlzb2Rpbywgc2VyaWVOb21lKQplbGlmIG1vZGU9PTMxOiBwcm9ncmFtYWNhb19jYW5hbChpZENhbmFsKQplbGlmIG1vZGUgPT0gMzI6CglQbGF5VXJsMihuYW1lLCB1cmwsIGljb25pbWFnZSkKCmlmIG1vZGU9PU5vbmUgb3IgdXJsPT1Ob25lIG9yIGxlbih1cmwpPDE6Cgl4Ym1jcGx1Z2luLmVuZE9mRGlyZWN0b3J5KGludChzeXMuYXJndlsxXSksY2FjaGVUb0Rpc2M9RmFsc2UpCmVsc2U6CglpZiBtb2RlICE9MyBhbmQgbW9kZSAhPTYgYW5kIG1vZGUgIT03OiAKCQl4Ym1jcGx1Z2luLmVuZE9mRGlyZWN0b3J5KGludChzeXMuYXJndlsxXSksY2FjaGVUb0Rpc2M9RmFsc2UpCgllbHNlOiAKCQl4Ym1jcGx1Z2luLmVuZE9mRGlyZWN0b3J5KGludChzeXMuYXJndlsxXSksY2FjaGVUb0Rpc2M9VHJ1ZSk="))