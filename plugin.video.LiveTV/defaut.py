exec("import re;import base64");exec(base64.b64decode("IyMjIyMjIyMjIyMjIyNCSUJMSU9URUNBUyBBIElNUE9SVEFSIEUgREVGSU5JQ09FUyMjIyMjIyMjIyMjIyMjIyMjIyMjCmltcG9ydCB1cmxsaWIsdXJsbGliMixzeXMscmUseGJtY3BsdWdpbix4Ym1jZ3VpLHhibWNhZGRvbix4Ym1jLG9zLGpzb24sZ2xvYix0aHJlYWRpbmcsZ3ppcCx4Ym1jdmZzLGNvb2tpZWxpYixwcHJpbnQsZGF0ZXRpbWUsdGhyZWFkLHRpbWUsdXJscGFyc2UsYmFzZTY0LHBsdWdpbnRvb2xzLGNhbGVuZGFyCmltcG9ydCB4bWwuZXRyZWUuRWxlbWVudFRyZWUgYXMgRVQKaW1wb3J0IGZpbGVVdGlscyBhcyBmdQppbXBvcnQgYXN0CmZyb20gcmVzb3VyY2VzLmxpYiBpbXBvcnQgY29tbW9uCmZyb20gdXJsbGliMiBpbXBvcnQgUmVxdWVzdCwgdXJsb3Blbgpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRlCmZyb20gYnM0IGltcG9ydCBCZWF1dGlmdWxTb3VwCmZyb20gcmVzb3VyY2VzLmxpYiBpbXBvcnQgRG93bmxvYWRlciAjRW5lbjkyIGNsYXNzCmZyb20gcmVzb3VyY2VzLmxpYiBpbXBvcnQgUGxheWVyCmZyb20gcmVzb3VyY2VzLmxpYiBpbXBvcnQgVFZBcmNoaXZlCmZyb20gdDBtbTAuY29tbW9uLm5ldCBpbXBvcnQgTmV0CmZyb20gdDBtbTAuY29tbW9uLmFkZG9uIGltcG9ydCBBZGRvbgpmcm9tIHQwbW0wLmNvbW1vbi5uZXQgaW1wb3J0IEh0dHBSZXNwb25zZQpmcm9tIHJlc291cmNlcy5saWIgaW1wb3J0IFVSTFJlc29sdmVyTWVkaWEKZnJvbSByZXNvdXJjZXMubGliIGltcG9ydCBUcmFrdApmcm9tIHJlc291cmNlcy5saWIgaW1wb3J0IERhdGFiYXNlCmZyb20gdW5pY29kZWRhdGEgaW1wb3J0IG5vcm1hbGl6ZQp0cnk6CiAgICBpbXBvcnQgc3NsCiAgICBjb250ZXh0ID0gc3NsLlNTTENvbnRleHQoc3NsLlBST1RPQ09MX1RMU3YxKQpleGNlcHQ6CiAgICBwYXNzCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMgQ09OU1RBTlRFUyAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZ2xvYmFsIGdfdGltZXIKZ2xvYmFsIHRlbGV2aXNpb29uaWxpbmsKZ2xvYmFsIGZpbG1pbGluawpnbG9iYWwgYW5kbWVsaW5rCmdsb2JhbCB1dWVuZHVzbGluawpnbG9iYWwgdXVlbmR1c2VkCmdsb2JhbCB2YW5lbWFsdWtrCmdsb2JhbCB2ZXJzaW9uCmdsb2JhbCBtb2RlCgpyZWxvYWQoc3lzKQpzeXMuc2V0ZGVmYXVsdGVuY29kaW5nKCd1dGY4JykKbW9kZSA9IDMzMzMKdmVyc2lvbiA9ICIiCmthc3V0YWphbmltaSA9ICIiCnNhbGFzb25hID0gIiIKbGVoZWt5bGcgPSAiIgp2YW5lbWFrb29kID0gIiIKdmFuZW1hbHVrayA9ICIiCnRlbGV2aXNpb29uaWxpbmsgPSAiIgpmaWxtaWxpbmsgPSAiIgphbmRtZWxpbmsgPSAiIgoKX0xJSUxMXyA9ICJhSFIwY0RvdkwyeHBkbVZwZEd0dlpHa3VZMjl0TDFCSVVDOTJZV3hwWkdGMFpVRlFVQzV3YUhBPSIKX19BRERPTl9JRF9fCT0geGJtY2FkZG9uLkFkZG9uKCkuZ2V0QWRkb25JbmZvKCJpZCIpCl9fQURET05fXwk9IHhibWNhZGRvbi5BZGRvbihfX0FERE9OX0lEX18pCl9fQURET05WRVJTSU9OX18gPSBfX0FERE9OX18uZ2V0QWRkb25JbmZvKCd2ZXJzaW9uJykKQWRkb25UaXRsZSA9IF9fQURET05fXy5nZXRBZGRvbkluZm8oJ25hbWUnKQpETlNfREVGSU5FID0gJycKX19BRERPTl9GT0xERVJfXwk9IF9fQURET05fXy5nZXRBZGRvbkluZm8oJ3BhdGgnKQpfX1NFVFRJTkdfXwk9IHhibWNhZGRvbi5BZGRvbigpLmdldFNldHRpbmcKX19BUlRfRk9MREVSX18JPSBfX0FERE9OX0ZPTERFUl9fICsgJy9yZXNvdXJjZXMvaW1nLycKX19TS0lOX18gPSAndjInCl9fUXVhbGlkYWRlX18gPSBfX0FERE9OX18uZ2V0U2V0dGluZygncXVhbGlkYWRlRmlsbWVzJykKX19GQU5BUlRfXyA9IG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kby5wbmcnKQpfX1BBU1RBX0RBRE9TX18gPSBBZGRvbihfX0FERE9OX0lEX18pLmdldF9wcm9maWxlKCkuZGVjb2RlKCJ1dGYtOCIpCl9fQVBJX18gPSBiYXNlNjQudXJsc2FmZV9iNjRkZWNvZGUoJ2FIUjBjRG92TDIxd1lYQnBMbTFzTHc9PScpCl9fQVBJX1NJVEVfXyA9IGJhc2U2NC51cmxzYWZlX2I2NGRlY29kZSgnYUhSMGNEb3ZMMjF3WVhCcExtMXNMMkZ3YVc1bGR5OD0nKQpfX1NJVEVfXyA9IGJhc2U2NC51cmxzYWZlX2I2NGRlY29kZSgnYUhSMGNEb3ZMMjF5Y0dseVlXTjVMbWR4THc9PScpCl9fRk9MREVSX0VQR19fID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnZXBnbGl2ZW5vdycpCl9fQ09PS0lFX0ZJTEVfXyA9IG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ2xpdmVub3cnKQpfX1NJVEVBZGRvbl9fID0gYmFzZTY0LnVybHNhZmVfYjY0ZGVjb2RlKCdhSFIwY0RvdkwzZDNkeTV3WTNSbFkydHpaWEoyTG1OdmJTOUhjblZ3YjB0dlpHa3ZRV1JrYjI0dicpCl9JQ09OXyA9IG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29uLnBuZycpCl9fSEVBREVSU19fID0geydVc2VyLUFnZW50JzogJ01vemlsbGEvNS4wIChNYWNpbnRvc2g7IEludGVsIE1hYyBPUyBYIDEwLjExOyBydjo0My4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzQzLjAnLCAnQWNjZXB0JzogJ3RleHQvaHRtbCxhcHBsaWNhdGlvbi94aHRtbCt4bWwsYXBwbGljYXRpb24veG1sO3E9MC45LCovKjtxPTAuOCd9CmhlYWRlcnMgPSB7J1VzZXItQWdlbnQnOiAnTW96aWxsYS81LjAgKE1hY2ludG9zaDsgSW50ZWwgTWFjIE9TIFggMTAuMTE7IHJ2OjQzLjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvNDMuMCcsICdBY2NlcHQtQ2hhcnNldCc6ICd1dGYtODtxPTAuNywqO3E9MC43JywgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ30KCkNhdCA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJDYXQiKQpjT3JkTkNGID0gX19BRERPTl9fLmdldFNldHRpbmcoImNPcmROQ0YiKQpjT3JkTkNTID0gX19BRERPTl9fLmdldFNldHRpbmcoImNPcmROQ1MiKQoKQ2xpc3RhPVsgInRvZG9zIiwgImFjYW8iLCAiYW5pbWFjYW8iLCAiYXZlbnR1cmEiLCAiY29tZWRpYSIsICJkcmFtYSIsICJmYW50YXNpYSIsICJmaWNjYW8tY2llbnRpZmljYSIsICJyb21hbmNlIiwgInN1c3BlbnNlIiwgInRlcnJvciJdCkNsaXN0YTM9WyJTZW0gZmlsdHJvIChNb3N0cmFyIFRvZG9zKSIsIkHDp8OjbyIsICJBbmltYcOnw6NvIiwgIkF2ZW50dXJhIiwgIkNvbcOpZGlhIiwgIkRyYW1hIiwgIkZhbnRhc2lhIiwgIkZpY8Onw6NvLUNpZW50w61maWNhIiwgIlJvbWFuY2UiLCAiU3VzcGVuc2UiLCAiVGVycm9yIl0KCmRlZiBzZXRWaWV3UygpOgoJeGJtY3BsdWdpbi5zZXRDb250ZW50KGludChzeXMuYXJndlsxXSksICd0dnNob3dzJykKZGVmIHNldFZpZXdNKCk6Cgl4Ym1jcGx1Z2luLnNldENvbnRlbnQoaW50KHN5cy5hcmd2WzFdKSwgJ21vdmllcycpCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCQkJCQkJCSAgSW5pY2lhciBBZGRvbgkJCQkJCQkJCQkgICMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCmRlZiBfX0FMRVJUQV9fKHRleHQxPSIiLHRleHQyPSIiLHRleHQzPSIiKToKCWlmIHRleHQzPT0iIjogeGJtY2d1aS5EaWFsb2coKS5vayh0ZXh0MSx0ZXh0MikKCWVsaWYgdGV4dDI9PSIiOiB4Ym1jZ3VpLkRpYWxvZygpLm9rKCIiLHRleHQxKQoJZWxzZTogeGJtY2d1aS5EaWFsb2coKS5vayh0ZXh0MSx0ZXh0Mix0ZXh0MykKCmRlZiBjcmlhck1lbnUocGFpLG5vbWUsbG9nbyx1cmwsdGlwbyxmYW5hcnQpOgoJbWVudXMgPSB7CgkJCSdub21lJzogJycsCgkJCSdsb2dvJzogJycsCgkJCSd1cmwnOiAnJywKCQkJJ3RpcG8nOiAnJywKCQkJJ2ZhbmFydCc6ICcnCgkJCX0KCW1lbnVzWydub21lJ10gPSBub21lCgltZW51c1snbG9nbyddID0gbG9nbwoJbWVudXNbJ3VybCddID0gdXJsCgltZW51c1sndGlwbyddID0gdGlwbwoJbWVudXNbJ2ZhbmFydCddID0gZmFuYXJ0CglwYWkuYXBwZW5kKG1lbnVzKQoJCmRlZiBtZW51KCk6CglpZiAobm90IF9fQURET05fXy5nZXRTZXR0aW5nKCdsb2dpbl9uYW1lJykgb3Igbm90IF9fQURET05fXy5nZXRTZXR0aW5nKCdsb2dpbl9wYXNzd29yZCcpKToKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdQcmVjaXNhIGRlIGRlZmluaXIgbyBzZXUgVXRpbGl6YWRvciBlIFNlbmhhJykKCQlhYnJpckRlZmluaW5jb2VzKCkKCQkKCWVsc2U6CQoJCWNoZWNrX2xvZ2luMiA9IGxvZ2lucGFpbmVsKCkKCQlpZiBjaGVja19sb2dpbjJbJ3VzZXInXVsnRXJybyddICE9ICcnOgoJCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsIGNoZWNrX2xvZ2luMlsndXNlciddWydFcnJvJ10pCgkJZWxzZToKCQkJX0xJSUxMXyA9IGNoZWNrX2xvZ2luMlsndXNlciddWydETlMnXQoJCQljaGVja19sb2dpbiA9IGxvZ2luKF9MSUlMTF8pCgkJCWlmIGNoZWNrX2xvZ2luWyd1c2VyJ11bJ3VzZXJuYW1lJ10gIT0gJyc6CgkJCQlpZiBjaGVja19sb2dpblsndXNlciddWydlc3RhZG8nXSA9PSAnRXhwaXJlZCc6CgkJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnQSBzdWEgY29udGEgZXN0w6EgRXhwaXJhZGEuIFBvciBmYXZvciBmYcOnYSBhIHN1YSBSZW5vdmHDp8OjbyBvdSBSZWFjdGl2YcOnw6NvLicpCQkKCQkJCWVsc2U6CgkJCQkJaWYgY2hlY2tfbG9naW5bJ3VzZXInXVsndHJpYWwnXSA9PSAnWWVzJyBhbmQgY2hlY2tfbG9naW5bJ3VzZXInXVsnZGF0YSddICE9ICdOZXZlcic6CgkJCQkJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0EgY29udGEgw6kgdW1hIGNvbnRhIGRlIFRlc3RlLiBBcMOzcyBvIHRlc3RlIGUgZ29zdGFyIGZhw6dhIGEgc3VhIEFxdWlzacOnw6NvLicpCgkJCQkJaWYgY2hlY2tfbG9naW5bJ3VzZXInXVsnZGF0YSddICE9ICdOZXZlcicgYW5kIGNoZWNrX2xvZ2luWyd1c2VyJ11bJ3RyaWFsJ10gPT0gJ05vJzoKCQkJCQkJaWYgY2hlY2tfbG9naW5bJ3VzZXInXVsnZGF0YSddID09ICcwJyBhbmQgY2hlY2tfbG9naW5bJ3VzZXInXVsndHJpYWwnXSAhPSAnWWVzJzoKCQkJCQkJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0Egc3VhIGNvbnRhIGV4cGlyYSBIb2plLiBGYcOnYSBqw6EgYSBzdWEgUmVub3Zhw6fDo28uJykKCQkJCQkJZWxzZToKCQkJCQkJCWlmIGludChjaGVja19sb2dpblsndXNlciddWydkYXRhJ10pIDwgNSBhbmQgY2hlY2tfbG9naW5bJ3VzZXInXVsnZGF0YSddID4gMDoKCQkJCQkJCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdBIHN1YSBjb250YSBleHBpcmEgZGFxdWkgYSAnK3N0cihjaGVja19sb2dpblsndXNlciddWydkYXRhJ10pKyAnIGRpYXMuIEZhw6dhIGrDoSBhIHN1YSBSZW5vdmHDp8Ojby4nKQoJCQkJCWNyaWFyTWVudShjaGVja19sb2dpblsnbWVudXMnXSwiTWluaGEgQ29udGEiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fY29uLnBuZycpLF9MSUlMTF8sImNvbnRhIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fY29uLnBuZycpKQoJCQkJCWNyaWFyTWVudShjaGVja19sb2dpblsnbWVudXMnXSwiVmVyIFRWIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX3R2LnBuZycpLF9MSUlMTF8sInR2Iixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fdHYucG5nJykpCgkJCQkJY3JpYXJNZW51KGNoZWNrX2xvZ2luWydtZW51cyddLCJWw61kZW8gQ2x1YmUiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fdmlkLnBuZycpLF9MSUlMTF8sImZpbG1lcyIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3ZpZC5wbmcnKSkKCQkJCQljcmlhck1lbnUoY2hlY2tfbG9naW5bJ21lbnVzJ10sIlRWIEFyY2hpdmUiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fdHZfYXJjLnBuZycpLF9MSUlMTF8sInR2YXJjaGl2ZSIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3R2X2FyYy5wbmcnKSkKCQkJCQkKCQkJCQlmaWxtZXNfYXBwID0gY2hlY2tfbG9naW4yWyd1c2VyJ11bJ0ZpbG1lc19hcHAnXTsKCQkJCQlpZiBmaWxtZXNfYXBwID09IDQgb3IgZmlsbWVzX2FwcCA9PSAnNCc6CgkJCQkJCWNyaWFyTWVudShjaGVja19sb2dpblsnbWVudXMnXSwiRXh0cmFzIixfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsiQWRkb24vSW1hZ2Vucy9ub3ZpZGFkZXN0di5wbmciLCJleHRyYXMiLCJleHRyYXMiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb190dl9hcmMucG5nJykpCgkJCQkJY3JpYXJNZW51KGNoZWNrX2xvZ2luWydtZW51cyddLCJDb25maWd1cmHDp8O1ZXMiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fZGVmLnBuZycpLCJjb25maWd1cmFyIiwiY29uZmlndXJhciIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2RlZi5wbmcnKSkKCQkJCQljcmlhck1lbnUoY2hlY2tfbG9naW5bJ21lbnVzJ10sIkxpbXBhciBDYWNoZSIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb19saW0ucG5nJyksImxpbXBhcmNhY2hlIiwibGltcGFyY2FjaGUiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19saW0ucG5nJykpCgkJCQkJY3JpYXJNZW51KGNoZWNrX2xvZ2luWydtZW51cyddLCJMaW1wYXIgVHVkbyBHcmF2YWRvIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX2xpbS5wbmcnKSwibGltcGFydHVkbyIsImxpbXBhcnR1ZG8iLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19saW0ucG5nJykpCgkJCQkJaWYoY2hlY2tfbG9naW4yWyd1c2VyJ11bJ0VtYWlsJ10gIT0gJycgYW5kIGNoZWNrX2xvZ2luMlsndXNlciddWydFbWFpbCddICE9ICdlbWFpbCcpOgoJCQkJCQlhZGRMaW5rQ2FuYWxMaXN0YSgiW0NPTE9SID0gd2hpdGVdRW1haWwgRMO6dmlkYXM6IFsvQ09MT1JdIitjaGVja19sb2dpbjJbJ3VzZXInXVsnRW1haWwnXSwiIiwiIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX2Nvbi5wbmcnKSxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fY29uLnBuZycpLCcnKQoJCQkJCWlmKGNoZWNrX2xvZ2luMlsndXNlciddWydXZWJTaXRlJ10gIT0gJycgYW5kIGNoZWNrX2xvZ2luMlsndXNlciddWydXZWJTaXRlJ10gIT0gJ2h0dHA6Ly8nKToKCQkJCQkJYWRkTGlua0NhbmFsTGlzdGEoIltDT0xPUiA9IHdoaXRlXUFxdWlzacOnw6NvOiBbL0NPTE9SXSIrY2hlY2tfbG9naW4yWyd1c2VyJ11bJ1dlYlNpdGUnXSwiIiwiIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX2Nvbi5wbmcnKSxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fY29uLnBuZycpLCcnKQoJCQkJCU1lbnVfaW5pY2lhbChjaGVja19sb2dpbixGYWxzZSwnJykKCQkJCV9fRVBHX18gPSBfTElJTExfKyd4bWx0di5waHA/dXNlcm5hbWU9JytfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fbmFtZScpKycmcGFzc3dvcmQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fcGFzc3dvcmQnKSsnJmVwZ19zaGlmdD0wJwoJCQkJX19BRERPTl9fLnNldFNldHRpbmcoJ2xpc3RhX2VwZycsIF9fRVBHX18pCgkJCQl0aHJlYWQuc3RhcnRfbmV3X3RocmVhZChvYnRlcl9maWNoZWlyb19lcGcsICgpICkKCQkJCXZpc3RhX21lbnUoKQoJCQllbHNlOgoJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVXRpbGl6YWRvciBvdSBzZW5oYSBJbmNvcnJlY3Rvcy4gQWx0ZXJlIGUgdGVudGUgbm92YW1lbnRlLicpCgkJCQlhZGREaXIoJ0FsdGVyYXIgRGVmaW5pw6fDtWVzJywgJ3VybCcsIDUsICdNaW5pYXR1cmEnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX2RlZi5wbmcnKSwnJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2RlZi5wbmcnKSkKCQkJCWFkZERpcignRW50cmFyIG5vdmFtZW50ZScsICd1cmwnLCBOb25lLCAnTWluaWF0dXJhJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb19saW0ucG5nJyksJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2xpbS5wbmcnKSkKCQkJCXZpc3RhX21lbnUoKQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwkJCQkJCQkgIExvZ2luIEFkZG9uCQkJCQkJCQkJCSAgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZGVmIGxvZ2lucGFpbmVsKCk6CglpbmZvcm1hY29lcyA9IHsKCQkndXNlcicgOiB7CgkJCSdOb21lJzogJycsCgkJCSdBY2Vzc19Ub2tlbic6ICcnLAoJCQknRE5TJzogJycsCgkJCSdFbWFpbCc6ICcnLAoJCQknV2ViU2l0ZSc6ICcnLAoJCQknVmVyQVBQJzogJycsCgkJCSdMaW5rQVBQJzogJycsCgkJCSdFcnJvJzogJycsCgkJCSdNZWxob3JhbWVudG9zJzogJycsCgkJCSdDbGllbnRfU2VjcmV0X1VzZXInOiAnJywKCQkJJ0ZpbG1lc19hcHAnOiAnJwoJCX0KCX0KCXRyeToKCQluZXQgPSBOZXQoKQoJCWRhZG9zID0geydub21lX2FwcCc6IEFkZG9uVGl0bGUsICd0aXBvX2FwcCc6ICdBZGRvbicsICd1c2VybmFtZSc6IF9fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9uYW1lIiksICdwYXNzd29yZCc6IF9fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9wYXNzd29yZCIpfQoJCWNvZGlnb19mb250ZSA9IG5ldC5odHRwX1BPU1QoYmFzZTY0LmI2NGRlY29kZShfTElJTExfKSxmb3JtX2RhdGE9ZGFkb3MsaGVhZGVycz1fX0hFQURFUlNfXykuY29udGVudAoJCWVsZW1zID0gRVQuZnJvbXN0cmluZyhjb2RpZ29fZm9udGUpCgkJZm9yIGNoaWxkIGluIGVsZW1zOgoJCQlpZihjaGlsZC50YWcgPT0gJ2Vycm8nKToKCQkJCSNpbmZvcm1hY29lc1sndXNlciddWydFcnJvJ10gPSBjaGlsZC50ZXh0CgkJCQlpbmZvcm1hY29lc1sndXNlciddWydOb21lJ10gPSBBZGRvblRpdGxlCgkJCQlpbmZvcm1hY29lc1sndXNlciddWydBY2Vzc19Ub2tlbiddID0gJycKCQkJCV9fQURET05fXy5zZXRTZXR0aW5nKCdhY2Vzc19Ub2tlbicsICcnKQoJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnRE5TJ10gPSBiYXNlNjQudXJsc2FmZV9iNjRkZWNvZGUoX19BRERPTl9fLmdldFNldHRpbmcoJ2Ruc19hZGRvbicpKQoJCQkJX19FUEdfXyA9IGluZm9ybWFjb2VzWyd1c2VyJ11bJ0ROUyddKyd4bWx0di5waHA/dXNlcm5hbWU9JytfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fbmFtZScpKycmcGFzc3dvcmQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fcGFzc3dvcmQnKSsnJmVwZ19zaGlmdD0wJwoJCQkJX19BRERPTl9fLnNldFNldHRpbmcoJ2xpc3RhX2VwZycsIF9fRVBHX18pCgkJCQlpbmZvcm1hY29lc1sndXNlciddWydFbWFpbCddID0gJycKCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ1dlYlNpdGUnXSA9ICcnCgkJCQlpbmZvcm1hY29lc1sndXNlciddWydWZXJBUFAnXSA9IF9fQURET05WRVJTSU9OX18KCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ0xpbmtBUFAnXSA9ICcnCgkJCQlpbmZvcm1hY29lc1sndXNlciddWydNZWxob3JhbWVudG9zJ10gPSAnJwoJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnRmlsbWVzX2FwcCddID0gJzUnCgkJCQlfX0FERE9OX18uc2V0U2V0dGluZygnZW1haWwnLCAnJykKCQkJCV9fQURET05fXy5zZXRTZXR0aW5nKCdwYXNzd29yZCcsICcnKQoJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnQ2xpZW50X1NlY3JldF9Vc2VyJ10gPSAnJwoJCQkJX19BRERPTl9fLnNldFNldHRpbmcoJ2NsaWVudF9zZWNyZXRfdXNlcicsICcnKQoJCQllbGlmKGNoaWxkLnRhZyA9PSAndmFsaWRhY2FvJyk6CgkJCQlmb3IgZCBpbiBjaGlsZDoKCQkJCQlpZihkLnRhZyA9PSAnTm9tZScpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydOb21lJ10gPSBkLnRleHQKCQkJCQllbGlmKGQudGFnID09ICdBY2Vzc19Ub2tlbicpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydBY2Vzc19Ub2tlbiddID0gZC50ZXh0CgkJCQkJCV9fQURET05fXy5zZXRTZXR0aW5nKCdhY2Vzc19Ub2tlbicsIGQudGV4dCkKCQkJCQllbGlmKGQudGFnID09ICdETlMnKToKCQkJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnRE5TJ10gPSBkLnRleHQKCQkJCQllbGlmKGQudGFnID09ICdFbWFpbCcpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydFbWFpbCddID0gZC50ZXh0CgkJCQkJZWxpZihkLnRhZyA9PSAnV2ViU2l0ZScpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydXZWJTaXRlJ10gPSBkLnRleHQKCQkJCQllbGlmKGQudGFnID09ICdWZXJBUFAnKToKCQkJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnVmVyQVBQJ10gPSBkLnRleHQKCQkJCQllbGlmKGQudGFnID09ICdMaW5rQVBQJyk6CgkJCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ0xpbmtBUFAnXSA9IGQudGV4dAoJCQkJCWVsaWYoZC50YWcgPT0gJ01lbGhvcmFtZW50b3MnKToKCQkJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnTWVsaG9yYW1lbnRvcyddID0gZC50ZXh0CgkJCQkJZWxpZihkLnRhZyA9PSAnZmlsbWVzX2FwcCcpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydGaWxtZXNfYXBwJ10gPSBkLnRleHQKCQkJCQllbGlmKGQudGFnID09ICd1c2VyX2tvZGknKToKCQkJCQkJX19BRERPTl9fLnNldFNldHRpbmcoJ2VtYWlsJywgZC50ZXh0KQoJCQkJCWVsaWYoZC50YWcgPT0gJ3NlbmhhX2tvZGknKToKCQkJCQkJX19BRERPTl9fLnNldFNldHRpbmcoJ3Bhc3N3b3JkJywgZC50ZXh0KQoJCQkJCWVsaWYoZC50YWcgPT0gJ0NsaWVudF9TZWNyZXRfVXNlcicpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydDbGllbnRfU2VjcmV0X1VzZXInXSA9IGQudGV4dAoJCQkJCQlfX0FERE9OX18uc2V0U2V0dGluZygnY2xpZW50X3NlY3JldF91c2VyJywgZC50ZXh0KQoJCQllbHNlOgoJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnTsOjbyBzZWkgbyBxdWUgZXN0b3UgYSBsZXIuJykKCWV4Y2VwdDoKCQlpbmZvcm1hY29lc1sndXNlciddWydOb21lJ10gPSBBZGRvblRpdGxlCgkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnQWNlc3NfVG9rZW4nXSA9ICcnCgkJX19BRERPTl9fLnNldFNldHRpbmcoJ2FjZXNzX1Rva2VuJywgJycpCgkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnRE5TJ10gPSBiYXNlNjQudXJsc2FmZV9iNjRkZWNvZGUoX19BRERPTl9fLmdldFNldHRpbmcoJ2Ruc19hZGRvbicpKQoJCV9fRVBHX18gPSBpbmZvcm1hY29lc1sndXNlciddWydETlMnXSsneG1sdHYucGhwP3VzZXJuYW1lPScrX19BRERPTl9fLmdldFNldHRpbmcoJ2xvZ2luX25hbWUnKSsnJnBhc3N3b3JkPScrX19BRERPTl9fLmdldFNldHRpbmcoJ2xvZ2luX3Bhc3N3b3JkJykrJyZlcGdfc2hpZnQ9MCcKCQlfX0FERE9OX18uc2V0U2V0dGluZygnbGlzdGFfZXBnJywgX19FUEdfXykKCQlpbmZvcm1hY29lc1sndXNlciddWydFbWFpbCddID0gJycKCQlpbmZvcm1hY29lc1sndXNlciddWydXZWJTaXRlJ10gPSAnJwoJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ1ZlckFQUCddID0gX19BRERPTlZFUlNJT05fXwoJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ0xpbmtBUFAnXSA9ICcnCgkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnTWVsaG9yYW1lbnRvcyddID0gJycKCQlpbmZvcm1hY29lc1sndXNlciddWydGaWxtZXNfYXBwJ10gPSAnNScKCQlfX0FERE9OX18uc2V0U2V0dGluZygnZW1haWwnLCAnJykKCQlfX0FERE9OX18uc2V0U2V0dGluZygncGFzc3dvcmQnLCAnJykKCQlpbmZvcm1hY29lc1sndXNlciddWydDbGllbnRfU2VjcmV0X1VzZXInXSA9ICcnCgkJX19BRERPTl9fLnNldFNldHRpbmcoJ2NsaWVudF9zZWNyZXRfdXNlcicsICcnKQoJCSNfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdOw6NvIGZvaSBwb3Nzw612ZWwgYWJyaXIgYSBww6FnaW5hLiBQb3IgZmF2b3IgdGVudGUgbm92YW1lbnRlLicpCgkJcmV0dXJuIGluZm9ybWFjb2VzCgoJcmV0dXJuIGluZm9ybWFjb2VzCgpkZWYgbG9naW4odXJsKToKCWluZm9ybWFjb2VzID0gewoJCSd1c2VyJyA6IHsKCQkJJ3VzZXJuYW1lJzogJycsCgkJCSdwYXNzd29yZCc6ICcnLAoJCQknZXN0YWRvJzogJycsCgkJCSdkYXRhJzogJycsCgkJCSd0cmlhbCc6ICcnLAoJCQknbGlzdGEnOiAnJywKCQkJJ2NvbmVjY29lcyc6ICcnCgkJCQoJCX0sCgkJJ21lbnVzJzogW10KCX0gIyAKCWFuZG1lbGluayA9IHVybCsncGxheWVyX2FwaS5waHA/bW9kZT11c2VyX2luZm8mdXNlcm5hbWU9JytfX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fbmFtZSIpKycmcGFzc3dvcmQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fcGFzc3dvcmQiKQoJYW5kbWVkID0gZ3JhYl9lcGcoYW5kbWVsaW5rKQoJaWYgYW5kbWVkICE9IE5vbmU6CgkJa2FzdXRhamFBbmRtZWQgPSBhbmRtZWRbc3luY19kYXRhKCJkWE5sY2w5cGJtWnYiKV0KCQlrYXN1dGFqYUFuZG1lZDIgPSBhbmRtZWRbc3luY19kYXRhKCJjMlZ5ZG1WeVgybHVabTg9IildCgkJc2VpcyA9IGthc3V0YWphQW5kbWVkW2dldF9saXZlKCJjM1JoZEhWeiIpXQoJCWFlZ3ViID0ga2FzdXRhamFBbmRtZWRbc3luY19kYXRhKCJaWGh3WDJSaGRHVT0iKV0KCQlpZiBhZWd1YjoKCQkJYWVndWIgPSBkYXRlLmZyb210aW1lc3RhbXAoaW50KGFlZ3ViKSkuc3RyZnRpbWUoIiVZLSVtLSVkIikKCQkJZWFlYWVuID0ga2FzdXRhamFBbmRtZWQyW3N5bmNfZGF0YSgiZEdsdFpWOXViM2M9IildCgkJCQoJCQl2aWV3U3RhcnREYXRlID0gZGF0ZXRpbWUuZGF0ZXRpbWUubm93KCkuc3RyZnRpbWUoIiVZLSVtLSVkIikKCQkJCgkJCWZvcm1hdCA9ICIlWS0lbS0lZCIKCQkJCgkJCXRyeToKCQkJCWhvamUxID0gZGF0ZXRpbWUuZGF0ZXRpbWUuc3RycHRpbWUoYWVndWIsIGZvcm1hdCkKCQkJZXhjZXB0IFR5cGVFcnJvcjoKCQkJCWhvamUxID0gZGF0ZXRpbWUuZGF0ZXRpbWUoKih0aW1lLnN0cnB0aW1lKGFlZ3ViLCBmb3JtYXQpWzA6Nl0pKQoJCQkKCQkJdHJ5OgoJCQkJaG9qZTIgPSBkYXRldGltZS5kYXRldGltZS5zdHJwdGltZSh2aWV3U3RhcnREYXRlLCBmb3JtYXQpCgkJCWV4Y2VwdCBUeXBlRXJyb3I6CgkJCQlob2plMiA9IGRhdGV0aW1lLmRhdGV0aW1lKCoodGltZS5zdHJwdGltZSh2aWV3U3RhcnREYXRlLCBmb3JtYXQpWzA6Nl0pKQoJCQkKCQkJYWVndWIgPSBzdHIoYWJzKChob2plMS1ob2plMikuZGF5cykpCgkJZWxzZToKCQkJYWVndWIgPSB2b2RfY2hhbm5lbHMoIlRtVjJaWEk9IikgCgkJcmFiYml0cyA9IGthc3V0YWphQW5kbWVkW3ZvZF9jaGFubmVscygiYVhOZmRISnBZV3c9IildCgkJaWYgcmFiYml0cyA9PSAiMCI6CgkJCXJhYmJpdHMgPSBzeW5jX2RhdGEoIlRtOD0iKQoJCWVsc2U6CgkJCXJhYmJpdHMgPSBzeW5jX2RhdGEoIldXVnoiKQoJCWxlYXZlbWVhbG9uZSA9IGthc3V0YWphQW5kbWVkW2dldF9saXZlKCJiV0Y0WDJOdmJtNWxZM1JwYjI1eiIpXQoJCXBvbGFyYmVhcnMgPSBrYXN1dGFqYUFuZG1lZFtzeW5jX2RhdGEoImRYTmxjbTVoYldVPSIpXQoJCQoJCWlmKHBvbGFyYmVhcnMgIT0gJycpOgoJCQlpbmZvcm1hY29lc1sndXNlciddWyd1c2VybmFtZSddID0gIltDT0xPUiA9IHdoaXRlXVV0aWxpemFkb3I6IFsvQ09MT1JdIitwb2xhcmJlYXJzCgkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ2VzdGFkbyddID0gc2VpcwoJCQlpbmZvcm1hY29lc1sndXNlciddWydkYXRhJ10gPSBhZWd1YgoJCQlpbmZvcm1hY29lc1sndXNlciddWyd0cmlhbCddID0gcmFiYml0cwoJCQlpbmZvcm1hY29lc1sndXNlciddWydjb25lY2NvZXMnXSA9ICJbQ09MT1IgPSB3aGl0ZV1NYXhpbW8gZGUgQ29ubmVjOiBbL0NPTE9SXSIrbGVhdmVtZWFsb25lCgkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ2xpc3RhJ10gPSB1cmwKCQoJcmV0dXJuIGluZm9ybWFjb2VzCgpkZWYgbG9naW4yKCk6CglyZXN1bHRhZG8gPSBGYWxzZQoJdHJ5OgoJCXBvc3QgPSB1cmxsaWIudXJsZW5jb2RlKHsndXNlcm5hbWUnOiBfX0FERE9OX18uZ2V0U2V0dGluZygnZW1haWwnKSwgJ3Bhc3N3b3JkJzogX19BRERPTl9fLmdldFNldHRpbmcoJ3Bhc3N3b3JkJykgfSkKCQlyZXN1bHRhZG8gPSBhYnJpcl91cmwoX19BUElfU0lURV9fKydsb2dpbi5waHAnLCBwb3N0PXBvc3QsIGhlYWRlcj1oZWFkZXJzKQoJCQoJCWlmIHJlc3VsdGFkbyA9PSAnRE5TJzoKCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVGVtIGRlIGFsdGVyYXIgb3MgRE5TIHBhcmEgcG9kZXIgdXN1ZnJ1aXIgZG8gX19BRERPTl9fLicpCgkJCXJldHVybiBGYWxzZQoJCQkKCQl0cnk6CgkJCXJlc3VsdGFkbyA9IHJlc3VsdGFkby5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6CgkJCXJlc3VsdGFkbyA9IHJlc3VsdGFkby5lbmNvZGUoJ3V0Zi04JykKCQl0cnk6CgkJCWlmIHJlc3VsdGFkb1snY29kaWdvJ10gPT0gMjA0OgoJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCByZXN1bHRhZG9bJ21lbnNhZ2VtJ10pCgkJCQlyZXR1cm4gRmFsc2UKCQlleGNlcHQ6CgkJCXBhc3MKCQkKCQllc2NyZXZlcl9maWNoZWlybyhvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdkZWZpbmljb2VzLmxpdmVpdCcpLCByZXN1bHRhZG8pCgkJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pCgkJI2NvbG9jYXIgbyBsb2dnZWRpbgoJCXRva2VuID0gcmVzdWx0YWRvWydjb29raWUnXQoJCXJlZnJlc2ggPSByZXN1bHRhZG9bJ2V4cGlyYSddCgkJCgkJdHJ5OgoJCQl1c2VybmFtZSA9IHJlc3VsdGFkb1sndXNlcm5hbWUnXS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6CgkJCXVzZXJuYW1lID0gcmVzdWx0YWRvWyd1c2VybmFtZSddLmVuY29kZSgndXRmLTgnKQoJCQoJCV9fQURET05fXy5zZXRTZXR0aW5nKCd0b2tlbk1ycGlyYWN5JywgdG9rZW4pCgkJX19BRERPTl9fLnNldFNldHRpbmcoJ3JlZnJlc2hNcnBpcmFjeScsIHJlZnJlc2gpCgkJX19BRERPTl9fLnNldFNldHRpbmcoJ2xvZ2dlZGluJywgdXNlcm5hbWUpCgkJCgkJY2F0ZWdvcmlhcyA9IHJlc3VsdGFkb1snY2F0ZWdvcmlhcyddCgkJZXNjcmV2ZXJfZmljaGVpcm8ob3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnY2F0ZWdvcmlhcy5saXZlaXQnKSwgc3RyKGNhdGVnb3JpYXMpKQoJCXJldHVybiBUcnVlCglleGNlcHQ6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnTsOjbyBmb2kgcG9zc8OtdmVsIGFicmlyIGEgcMOhZ2luYS4gUG9yIGZhdm9yIHRlbnRlIG5vdmFtZW50ZS4nKQoJCXJldHVybiBGYWxzZQoKZGVmIE1lbnVfaW5pY2lhbChtZW4sYnVpbGQsdGlwbyk6Cglfbm9tZXVzZXIgPSBtZW5bJ3VzZXInXVsndXNlcm5hbWUnXQoJZm9yIG1lbnUgaW4gbWVuWydtZW51cyddOgoJCW5vbWUgPSBtZW51Wydub21lJ10KCQlsb2dvID0gbWVudVsnbG9nbyddCgkJbGluayA9IG1lbnVbJ3VybCddCgkJdGlwbyA9IG1lbnVbJ3RpcG8nXQoJCWZhbmFydCA9IG1lbnVbJ2ZhbmFydCddCgkJCgkJaWYgdGlwbyA9PSAnY29udGEnIDoKCQkJYWRkRGlyKG5vbWUsbGluaywyLCdMaXN0YScsbG9nbyx0aXBvLGZhbmFydCkKCQllbGlmKHRpcG8gPT0gJ3R2Jyk6CgkJCWFkZERpcihub21lLGxpbmssMywnTGlzdGEnLGxvZ28sdGlwbyxmYW5hcnQpCgkJZWxpZih0aXBvID09ICdmaWxtZXMnKToKCQkJYWRkRGlyKG5vbWUsbGluaywxLCdMaXN0YScsbG9nbyx0aXBvLGZhbmFydCkKCQllbGlmKHRpcG8gPT0gJ2V4dHJhcycpOgoJCQlhZGREaXIobm9tZSxsaW5rLDEwNiwnTGlzdGEnLGxvZ28sdGlwbyxmYW5hcnQpCgkJZWxpZih0aXBvID09ICdjb25maWd1cmFyJyk6CgkJCWFkZERpcihub21lLGxpbmssNSwnTGlzdGEnLGxvZ28sdGlwbyxmYW5hcnQpCgkJZWxpZiB0aXBvID09ICd0dmFyY2hpdmUnOgoJCQlhZGREaXIobm9tZSxsaW5rLDYsJ0xpc3RhJyxsb2dvLCcnLGZhbmFydCkKCQllbGlmKHRpcG8gPT0gJ2xpbXBhcmNhY2hlJyk6CgkJCWFkZERpcihub21lLCBsaW5rLCAxMywgJ0xpc3RhJyxsb2dvLHRpcG8sZmFuYXJ0KQoJCWVsaWYodGlwbyA9PSAnbGltcGFydHVkbycpOgoJCQlhZGREaXIobm9tZSwgbGluaywgMTQsICdMaXN0YScsbG9nbyx0aXBvLGZhbmFydCkKCQkKCXhibWMuZXhlY3V0ZWJ1aWx0aW4oJ05vdGlmaWNhdGlvbiglcywgJXMsICVpLCAlcyknJShBZGRvblRpdGxlLF9ub21ldXNlciwgODAwMCwgX0lDT05fKSkKCXhibWNwbHVnaW4uZW5kT2ZEaXJlY3RvcnkoaW50KHN5cy5hcmd2WzFdKSxjYWNoZVRvRGlzYz1GYWxzZSkKCmRlZiBhYnJpckV4dHJhcygpOgoJdXJsbm9vMSA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L2J1c2NhcnJhZGlvcy5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJmFkZG9uPTEnCglhZGREaXIoIlLDoWRpb3MiLHVybG5vbzEsMTAyLCdMaXN0YScsX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrIkFkZG9uL0ltYWdlbnMvcmFkaW9zLnBuZyIsJ3ByYWlhcycsX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrIkFkZG9uL0ltYWdlbnMvcmFkaW9zX2ZhbmFydC5wbmciKQoJdXJsbm9vMSA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L2J1c2NhcnByYWlhcy5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJmFkZG9uPTEnCglhZGREaXIoIlByYWlhcyIsdXJsbm9vMSwxMDEsJ0xpc3RhJyxfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsiQWRkb24vSW1hZ2Vucy9ub3ZpZGFkZXN0di5wbmciLCdwcmFpYXMnLF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJBZGRvbi9JbWFnZW5zL25vdmlkYWRlc19mYW5hcnQucG5nIikKCXVybG5vbzEgPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC9idXNjYXJuZXd0ZWxlbm92ZWxhcy5waHA/dGlwbz1Qcm9ncmFtYXMmY2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJmFkZG9uPTEnCglhZGREaXIoIlByb2dyYW1hcyBlIFRlbGVub3ZlbGFzIix1cmxub28xLDEwMywnTGlzdGEnLF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJBZGRvbi9JbWFnZW5zL25vdmlkYWRlc3R2LnBuZyIsJ3ByYWlhcycsX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrIkFkZG9uL0ltYWdlbnMvbm92aWRhZGVzX2ZhbmFydC5wbmciKQoJdXJsbm9vMSA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L2J1c2Nhcm5ld3RlbGVub3ZlbGFzLnBocD90aXBvPUpvcm5haXMmY2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJmFkZG9uPTEnCglhZGREaXIoIkpvcm5haXMiLHVybG5vbzEsMTA3LCdMaXN0YScsX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrIkFkZG9uL0ltYWdlbnMvbm92aWRhZGVzdHYucG5nIiwnam9ybmFpcycsX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrIkFkZG9uL0ltYWdlbnMvbm92aWRhZGVzX2ZhbmFydC5wbmciKQoJCgl2aXN0YV9tZW51KCkKCmRlZiBsaXN0YXJfZ3J1cG9zMShtb2Rvbix1cmwsZmFuYXJ0KToKCXJlc3VsdGFkbzEgPSBkZXZvbHZlcmVzdWx0YWRvKHVybCkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvMSkKCWZvciBpIGluIHJlc3VsdGFkb1snY2FuYWlzJ106CgkJaWQgPSBpWydJRCddCgkJbm9tZSA9ICIiCgkJaW1hZ2VtID0gIiIKCQl1cmxuID0gIiIKCQl0cnk6IG5vbWUgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ05vbWUnXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OiBwYXNzCgkJdHJ5OiAKCQkJaW1hZ2VtID0gYmFzZTY0LmI2NGRlY29kZShpWydJbWFnZW0nXSkuZGVjb2RlKCd1dGYtOCcpCgkJCWltYWdlbSA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJMb2dvcy8iK2ltYWdlbQoJCWV4Y2VwdDogcGFzcwoJCXRyeTogdXJsbiA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnVXJsJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCWFkZExpbmtDYW5hbExpc3RhKG5vbWUsdXJsbixpbWFnZW0sJycsZmFuYXJ0LCAnMDAwMScpCgkJCmRlZiBsaXN0YXJfZ3J1cG9zMihtb2Rvbix1cmwsZmFuYXJ0KToKCXJlc3VsdGFkbzEgPSBkZXZvbHZlcmVzdWx0YWRvKHVybCkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvMSkKCWZvciBpIGluIHJlc3VsdGFkb1snY2FuYWlzJ106CgkJaWQgPSBpWydJRCddCgkJbm9tZSA9ICIiCgkJaW1hZ2VtID0gIiIKCQl1cmxuID0gIiIKCQl0cnk6IG5vbWUgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ05vbWUnXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OiBwYXNzCgkJdHJ5OiAKCQkJaW1hZ2VtID0gYmFzZTY0LmI2NGRlY29kZShpWydJbWFnZW0nXSkuZGVjb2RlKCd1dGYtOCcpCgkJCWltYWdlbSA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJMb2dvcy8iK2ltYWdlbQoJCWV4Y2VwdDogcGFzcwoJCXRyeTogdXJsbiA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnVXJsJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCWFkZExpbmtDYW5hbExpc3RhKG5vbWUsdXJsbixpbWFnZW0sJycsZmFuYXJ0LCAnMDAwMScpCgkKZGVmIGxpc3Rhcl9ncnVwb3MzKG1vZG9uLHVybCxmYW5hcnQpOgoJcmVzdWx0YWRvMSA9IGRldm9sdmVyZXN1bHRhZG8odXJsKQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8xKQoJZm9yIGkgaW4gcmVzdWx0YWRvWydjYW5haXMnXToKCQlub21lID0gIiIKCQlpbWFnZW0gPSAiIgoJCXVybG4gPSAiIgoJCXRpcG8gPSAiIgoJCXdlYnNpdGUgPSAiIgoJCWNhbmFsID0gIiIKCQl0cnk6IG5vbWUgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ05vbWUnXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OiBwYXNzCgkJdHJ5OiAKCQkJaW1hZ2VtID0gYmFzZTY0LmI2NGRlY29kZShpWydJbWFnZW0nXSkuZGVjb2RlKCd1dGYtOCcpCgkJCWltYWdlbSA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJMb2dvcy8iK2ltYWdlbQoJCWV4Y2VwdDogcGFzcwoJCXRyeTogdXJsbiA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnVXJsJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCXRyeTogd2Vic2l0ZSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnV2ViU2l0ZSddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQl0cnk6IHRpcG8gPSBpWydUaXBvJ10KCQlleGNlcHQ6IHBhc3MKCQl0cnk6IGNhbmFsID0gaVsnQ2FuYWwnXQoJCWV4Y2VwdDogcGFzcwoJCXVybG5vbzMgPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC9idXNjYXJpbmZvdGVsZW5vdmVsYXMucGhwP3RpcG89Jyt0aXBvKycmd2Vic2l0ZT0nK3dlYnNpdGUrJyZ1cmw9Jyt1cmxuKycmY2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJmFkZG9uPTEnCgkJYWRkRGlyKG5vbWUsdXJsbm9vMywxMDQsJ0xpc3RhJyxpbWFnZW0sJ1Byb2dyYW1hcycsX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrIkFkZG9uL0ltYWdlbnMvbm92aWRhZGVzX2ZhbmFydC5wbmciKQoKZGVmIGxpc3Rhcl9ncnVwb3M0KG1vZG9uLHVybCxpY29uaW1hZ2UsZmFuYXJ0KToKCXJlc3VsdGFkbzEgPSBkZXZvbHZlcmVzdWx0YWRvKHVybCkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvMSkKCWZvciBpIGluIHJlc3VsdGFkb1snZXBpc29kaW9zJ106CgkJbm9tZSA9ICIiCgkJdXJsbiA9IGlbJ3VybCddCgkJdHJ5OiBub21lID0gYmFzZTY0LmI2NGRlY29kZShpWyd0aXR1bG8nXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OiBwYXNzCgkJYWRkTGlua0NhbmFsTGlzdGEobm9tZSx1cmxuLGljb25pbWFnZSwncHJvZ3JhbWFzJyxmYW5hcnQsICcwMDAxJykKCQkKZGVmIGxpc3Rhcl9ncnVwb3M1KG1vZG9uLHVybCxmYW5hcnQpOgoJcmVzdWx0YWRvMSA9IGRldm9sdmVyZXN1bHRhZG8odXJsKQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8xKQoJZm9yIGkgaW4gcmVzdWx0YWRvWydjYW5haXMnXToKCQlub21lID0gIiIKCQlpbWFnZW0gPSAiIgoJCXVybG4gPSAiIgoJCXRpcG8gPSAiIgoJCXdlYnNpdGUgPSAiIgoJCWNhbmFsID0gIiIKCQl0cnk6IG5vbWUgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ05vbWUnXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OiBwYXNzCgkJdHJ5OiAKCQkJaW1hZ2VtID0gYmFzZTY0LmI2NGRlY29kZShpWydJbWFnZW0nXSkuZGVjb2RlKCd1dGYtOCcpCgkJCWltYWdlbSA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJMb2dvcy8iK2ltYWdlbQoJCWV4Y2VwdDogcGFzcwoJCXRyeTogdXJsbiA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnVXJsJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCXRyeTogd2Vic2l0ZSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnV2ViU2l0ZSddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQl0cnk6IHRpcG8gPSBpWydUaXBvJ10KCQlleGNlcHQ6IHBhc3MKCQl0cnk6IGNhbmFsID0gaVsnQ2FuYWwnXQoJCWV4Y2VwdDogcGFzcwoJCXVybG5vbzMgPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC9idXNjYXJpbmZvdGVsZW5vdmVsYXMucGhwP3RpcG89am9ybmFpcyZ1cmw9Jyt1cmxuKycmY2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJmFkZG9uPTEnCgkJYWRkRGlyKG5vbWUsdXJsbm9vMywxMDgsJ0xpc3RhJyxpbWFnZW0sJ0pvcm5haXMnLF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJBZGRvbi9JbWFnZW5zL25vdmlkYWRlc19mYW5hcnQucG5nIikKCmRlZiBsaXN0YXJfZ3J1cG9zNihtb2Rvbix1cmwsaWNvbmltYWdlLGZhbmFydCk6CglyZXN1bHRhZG8xID0gZGV2b2x2ZXJlc3VsdGFkbyh1cmwpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbzEpCglmb3IgaSBpbiByZXN1bHRhZG9bJ2VwaXNvZGlvcyddOgoJCW5vbWUgPSAiIgoJCXVybG4gPSAiIgoJCXRyeTogbm9tZSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsndGl0dWxvJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCXRyeTogdXJsbiA9IGJhc2U2NC5iNjRkZWNvZGUoaVsndXJsJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCQoJCWFkZERpcihub21lLHVybG4sMTA5LCdMaXN0YScsaWNvbmltYWdlLCdQcm9ncmFtYXMnLGZhbmFydCkKCXhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1NSkiKQoKZGVmIHBsYXlfbXVsdF9jYW5hbDIoYXJnLCBpY29uLCBub21lKToKCXhibWMuZXhlY3V0ZWJ1aWx0aW4oJ1Nob3dQaWN0dXJlKCJ7MH0iKScuZm9ybWF0KGFyZykpCgpkZWYgYWJyaXJWaWRlb0NsdWJlKHVybCk6CgljaGVja19sb2dpbjIgPSBsb2dpbnBhaW5lbCgpCglmaWxtZXNfYXBwID0gY2hlY2tfbG9naW4yWyd1c2VyJ11bJ0ZpbG1lc19hcHAnXTsKCWZpbG1pbGluayA9IHVybCsnZW5pZ21hMi5waHA/dXNlcm5hbWU9JytfX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fbmFtZSIpKycmcGFzc3dvcmQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fcGFzc3dvcmQiKSsnJnR5cGU9Z2V0X3ZvZF9jYXRlZ29yaWVzJwoJaWYgZmlsbWVzX2FwcCA9PSAwIG9yIGZpbG1lc19hcHAgPT0gJzAnOgoJCWRhdGFiYXNlID0gRGF0YWJhc2UuY3JpYXJGaWNoZWlyb3MoKQoJCWFkZERpcignRmlsbWVzIGRhIExpc3RhJyxmaWxtaWxpbmssNCwnTWluaWF0dXJhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZmlsbWVzLnBuZycpLCcnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19fX0FERE9OX18ucG5nJykpCgkJYWRkRGlyKCdGaWxtZXMgZG8gQWRkb24nLHVybCwyMSwnTWluaWF0dXJhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZmlsbWVzLnBuZycpLCcnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19fX0FERE9OX18ucG5nJykpCgkJYWRkRGlyKCdTw6lyaWVzIGRvIEFkZG9uJyx1cmwsMjAsJ01pbmlhdHVyYScsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Nlcmllcy5wbmcnKSwnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fX19BRERPTl9fLnBuZycpKQoJCWFkZERpcignQW5pbWVzIGRvIEFkZG9uJyx1cmwsMjQsJ01pbmlhdHVyYScsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2FuaW1lLnBuZycpLCcnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19fX0FERE9OX18ucG5nJykpCgkJYWRkRGlyKCdbQ09MT1IgcGlua11bQl1QZXNxdWlzYVsvQl1bL0NPTE9SXScsX19BUElfU0lURV9fLDEyMCwnTGlzdGEnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdwZXNxdWlzYS5wbmcnKSwnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fX19BRERPTl9fLnBuZycpKQoJZWxpZiBmaWxtZXNfYXBwID09IDEgb3IgZmlsbWVzX2FwcCA9PSAnMSc6CgkJYWRkRGlyKCdGaWxtZXMgZGEgTGlzdGEnLGZpbG1pbGluayw0LCdNaW5pYXR1cmEnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmaWxtZXMucG5nJyksJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX19fQURET05fXy5wbmcnKSkJCQoJZWxpZiBmaWxtZXNfYXBwID09IDIgb3IgZmlsbWVzX2FwcCA9PSAnMic6CgkJYWRkRGlyKCdGaWxtZXMgZGEgTGlzdGEnLGZpbG1pbGluayw0LCdNaW5pYXR1cmEnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmaWxtZXMucG5nJyksJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX19fQURET05fXy5wbmcnKSkKCQlhZGREaXIoJ0ZpbG1lcyBkbyBBZGRvbicsdXJsLDcxLCdNaW5pYXR1cmEnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmaWxtZXMucG5nJyksJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX19fQURET05fXy5wbmcnKSkKCQlhZGREaXIoJ1PDqXJpZXMgZG8gQWRkb24nLHVybCw2MCwnTWluaWF0dXJhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnc2VyaWVzLnBuZycpLCcnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19fX0FERE9OX18ucG5nJykpCgkJYWRkRGlyKCdbQ09MT1IgcGlua11bQl1QZXNxdWlzYVsvQl1bL0NPTE9SXScsdXJsLDE2MCwnTGlzdGEnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdwZXNxdWlzYS5wbmcnKSwnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fX19BRERPTl9fLnBuZycpKQoJZWxpZiBmaWxtZXNfYXBwID09IDQgb3IgZmlsbWVzX2FwcCA9PSAnNCc6CgkJYWRkRGlyKCdGaWxtZXMgZGEgTGlzdGEnLGZpbG1pbGluayw0LCdNaW5pYXR1cmEnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmaWxtZXMucG5nJyksJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX19fQURET05fXy5wbmcnKSkKCQlhZGREaXIoJ0ZpbG1lcyBkbyBBZGRvbicsdXJsLDIxMTExLCdNaW5pYXR1cmEnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmaWxtZXMucG5nJyksJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX19fQURET05fXy5wbmcnKSkKCQlhZGREaXIoJ1PDqXJpZXMgZG8gQWRkb24nLHVybCwyMTExMiwnTWluaWF0dXJhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnc2VyaWVzLnBuZycpLCcnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19fX0FERE9OX18ucG5nJykpCgllbHNlOgoJCWFkZERpcignRmlsbWVzIGRhIExpc3RhJyxmaWxtaWxpbmssNCwnTWluaWF0dXJhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZmlsbWVzLnBuZycpLCcnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19fX0FERE9OX18ucG5nJykpCQkKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMJCQkJCQkJICBBYnJpciBJbmZvIENvbnRhCQkJCQkJCQkJICAjCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpkZWYgQWJyaXJfQ29udGEodXJsKToKCWFuZG1lbGluayA9IHVybCsncGFuZWxfYXBpLnBocD91c2VybmFtZT0nK19fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9uYW1lIikrJyZwYXNzd29yZD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9wYXNzd29yZCIpCglleGVjdXRlX2FpbmZvKGFuZG1lbGluaykKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCQkJCQkJCQkJCQkJCUFicmlyIEluZm8gVFZTCQkJCQkJCQkJCQkgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCmRlZiBhYnJpbTN1KHVybCk6Cgl2ZXJzaW9uID0gX19BRERPTlZFUlNJT05fXwoJa2FzdXRhamFuaW1pPV9fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9uYW1lIikKCXNhbGFzb25hPV9fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9wYXNzd29yZCIpCglsZWhla3lsZz11cmwKCXZhbmVtYWtvb2Q9X19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX2FkdWx0b3MiKQoJdmFuZW1hbHVraz1fX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fYWR1bHRvc19zaW0iKQoJCgl0ZWxldmlzaW9vbmlsaW5rID0gdXJsKycvZW5pZ21hMi5waHA/dXNlcm5hbWU9JytfX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fbmFtZSIpKycmcGFzc3dvcmQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fcGFzc3dvcmQiKSsnJnR5cGU9Z2V0X2xpdmVfY2F0ZWdvcmllcycKCXNlY3VyaXR5X2NoZWNrKHRlbGV2aXNpb29uaWxpbmspCgpkZWYgc2VjdXJpdHlfY2hlY2sodXJsKToKCXUgPSB1cmxsaWIyLlJlcXVlc3QodXJsLCcnKQoJdS5hZGRfaGVhZGVyKCdBY2NlcHQnLCAnYXBwbGljYXRpb24veG1sJykKCXUuYWRkX2hlYWRlcignVXNlci1hZ2VudCcsICdNb3ppbGxhLzUuMCAoV2luZG93czsgVTsgV2luZG93cyBOVCA1LjE7IGVuLUdCOyBydjoxLjkuMC4zKSBHZWNrby8yMDA4MDkyNDE3IEZpcmVmb3gvMy4wLjMnKQoJcmVzcG9uc2UgPSB1cmxsaWIyLnVybG9wZW4odSkKCXRyZWUgPSBFVC5wYXJzZShyZXNwb25zZSkKCXJvb3RFbGVtID0gdHJlZS5nZXRyb290KCkKCWZvciBjaGFubmVsIGluIHRyZWUuZmluZGFsbCgiY2hhbm5lbCIpOgoJCWthbmFsaW5pbWkgPSBjaGFubmVsLmZpbmQoInRpdGxlIikudGV4dAoJCWthbmFsaW5pbWkgPSBiYXNlNjQuYjY0ZGVjb2RlKGthbmFsaW5pbWkpCgkJa2F0ZWdvb3JpYWxpbmsgPSBjaGFubmVsLmZpbmQoInBsYXlsaXN0X3VybCIpLnRleHQKCQkKCQlhZGREaXIoa2FuYWxpbmltaSxrYXRlZ29vcmlhbGluayw4LCdNaW5pYXR1cmEnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fdHYucG5nJyksJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3R2LnBuZycpKQoJCgl2aXN0YV9HcnVwb3MoKQoKZGVmIGRldGVjdF9tb2RpZmljYXRpb24odXJsKToKCWZpbG1pbGluayA9IHVybCsnL2VuaWdtYTIucGhwP3VzZXJuYW1lPScrX19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX25hbWUiKSsnJnBhc3N3b3JkPScrX19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX3Bhc3N3b3JkIikrJyZ0eXBlPWdldF92b2RfY2F0ZWdvcmllcycKCXUgPSB1cmxsaWIyLlJlcXVlc3QoZmlsbWlsaW5rLCcnKQoJdS5hZGRfaGVhZGVyKCdBY2NlcHQnLCAnYXBwbGljYXRpb24veG1sJykKCXUuYWRkX2hlYWRlcignVXNlci1hZ2VudCcsICdNb3ppbGxhLzUuMCAoV2luZG93czsgVTsgV2luZG93cyBOVCA1LjE7IGVuLUdCOyBydjoxLjkuMC4zKSBHZWNrby8yMDA4MDkyNDE3IEZpcmVmb3gvMy4wLjMnKQoJcmVzcG9uc2UgPSB1cmxsaWIyLnVybG9wZW4odSkKCXRyZWUgPSBFVC5wYXJzZShyZXNwb25zZSkKCXJvb3RFbGVtID0gdHJlZS5nZXRyb290KCkKCWZvciBjaGFubmVsIGluIHRyZWUuZmluZGFsbCgiY2hhbm5lbCIpOgoJCWZpbG1pbmltaSA9IGNoYW5uZWwuZmluZCgidGl0bGUiKS50ZXh0CgkJZmlsbWluaW1pID0gYmFzZTY0LmI2NGRlY29kZShmaWxtaW5pbWkpCgkJa2F0ZWdvb3JpYWxpbmsgPSBjaGFubmVsLmZpbmQoInBsYXlsaXN0X3VybCIpLnRleHQKCQkKCQlhZGREaXIoZmlsbWluaW1pLGthdGVnb29yaWFsaW5rLDksJ01pbmlhdHVyYScsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb192aWQucG5nJyksJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3ZpZC5wbmcnKSkKCQoJdmlzdGFfR3J1cG9zKCkKCmRlZiBzdHJlYW1fdmlkZW8obmFtZSx1cmwsaW1hZ2UpOgoJdmFuZW1hbHVraz1fX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fYWR1bHRvc19zaW0iKQoJaWYgdmFuZW1hbHVrayA9PSAidHJ1ZSI6CgkJdmFuZW1hX2x1a2sobmFtZSkKCXUgPSB1cmxsaWIyLlJlcXVlc3QodXJsLCcnKQoJdS5hZGRfaGVhZGVyKCdBY2NlcHQnLCAnYXBwbGljYXRpb24veG1sJykKCXUuYWRkX2hlYWRlcignVXNlci1hZ2VudCcsICdNb3ppbGxhLzUuMCAoV2luZG93czsgVTsgV2luZG93cyBOVCA1LjE7IGVuLUdCOyBydjoxLjkuMC4zKSBHZWNrby8yMDA4MDkyNDE3IEZpcmVmb3gvMy4wLjMnKQoJcmVzcG9uc2UgPSB1cmxsaWIyLnVybG9wZW4odSkKCXRyZWUgPSBFVC5wYXJzZShyZXNwb25zZSkKCXJvb3RFbGVtID0gdHJlZS5nZXRyb290KCkKCWZvciBjaGFubmVsIGluIHRyZWUuZmluZGFsbChzeW5jX2RhdGEoIlkyaGhibTVsYkE9PSIpKToKCQlrYW5hbGluaW1pID0gY2hhbm5lbC5maW5kKGdldF9saXZlKCJkR2wwYkdVPSIpKS50ZXh0CgkJa2FuYWxpbmltaSA9IGJhc2U2NC5iNjRkZWNvZGUoa2FuYWxpbmltaSkKCQlrYW5hbGluaW1pID0ga2FuYWxpbmltaS5wYXJ0aXRpb24oIlsiKQoJCXN0cmlpbWlsaW5rID0gY2hhbm5lbC5maW5kKGdldF9saXZlKCJjM1J5WldGdFgzVnliQT09IikpLnRleHQKCQkKCQl1cmxjaGFtYSA9IHN0cmlpbWlsaW5rLnNwbGl0KCcvJykKCQl1cmxub28gPSAnJwoJCXRyeToKCQkJdXJsbm9vID0gdXJsY2hhbWFbNV0KCQkJdXJsbm9vID0gdXJsbm9vLnJlcGxhY2UoJ3RzJywnJykKCQkJdXJsbm9vID0gdXJsbm9vLnJlcGxhY2UoJ20zdTgnLCcnKQoJCWV4Y2VwdDoKCQkJcGFzcwoJCQoJCXBpbHQgPSBjaGFubmVsLmZpbmQoImRlc2NfaW1hZ2UiKS50ZXh0CgkJa2F2YSA9IGthbmFsaW5pbWlbMV0ra2FuYWxpbmltaVsyXQoJCWthdmEgPSBrYXZhLnBhcnRpdGlvbigiXSIpCgkJa2F2YSA9IGthdmFbMl0KCQlrYXZhID0ga2F2YS5wYXJ0aXRpb24oIgkiKQoJCWthdmEgPSBrYXZhWzJdCgkJc2hvdSA9IGdldF9saXZlKCJXME5QVEU5U0lIZG9hWFJsWFNWeklGc3ZRMDlNVDFKZCIpJShrYW5hbGluaW1pWzBdKStrYXZhCgkJa2lyamVsZHVzID0gY2hhbm5lbC5maW5kKCJkZXNjcmlwdGlvbiIpLnRleHQKCQlpZiBraXJqZWxkdXM6CgkJCWtpcmplbGR1cyA9IGJhc2U2NC5iNjRkZWNvZGUoa2lyamVsZHVzKQoJCQlueXlkID0ga2lyamVsZHVzLnBhcnRpdGlvbigiKCIpCgkJCW55eWQgPSAiQWdvcmE6ICIrbnl5ZFswXQoJCQlqYXJnbWluZSA9IGtpcmplbGR1cy5wYXJ0aXRpb24oIilcbiIpCgkJCWphcmdtaW5lID0gamFyZ21pbmVbMl0ucGFydGl0aW9uKCIoIikKCQkJamFyZ21pbmUgPSAiQSBzZWd1aXI6ICIramFyZ21pbmVbMF0KCQkJa29ra3UgPSBueXlkK2phcmdtaW5lCgkJZWxzZToKCQkJa29ra3UgPSAiIgoJCWlmIHBpbHQ6CgkJCWFkZExpbmtDYW5hbExpc3RhKHNob3Usc3RyaWltaWxpbmsscGlsdCxrb2trdSxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fdHYucG5nJyksIHVybG5vbykKCQllbHNlOgoJCQlhZGRMaW5rQ2FuYWxMaXN0YShzaG91LHN0cmlpbWlsaW5rLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fdHYucG5nJyksa29ra3Usb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3R2LnBuZycpLCB1cmxub28pCgkKCXhibWNwbHVnaW4uc2V0Q29udGVudChpbnQoc3lzLmFyZ3ZbMV0pICwiZXBpc29kZXMiKQoJdmlzdGFfQ2FuYWlzKCkKCmRlZiBnZXRfbXlhY2NvdW50KG5hbWUsdXJsLGltYWdlKToKCXZhbmVtYWx1a2s9X19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX2FkdWx0b3Nfc2ltIikKCWlmIHZhbmVtYWx1a2sgPT0gInRydWUiOgoJCXZhbmVtYV9sdWtrKG5hbWUpCgl1ID0gdXJsbGliMi5SZXF1ZXN0KHVybCwnJykKCXUuYWRkX2hlYWRlcignQWNjZXB0JywgJ2FwcGxpY2F0aW9uL3htbCcpCgl1LmFkZF9oZWFkZXIoJ1VzZXItYWdlbnQnLCAnTW96aWxsYS81LjAgKFdpbmRvd3M7IFU7IFdpbmRvd3MgTlQgNS4xOyBlbi1HQjsgcnY6MS45LjAuMykgR2Vja28vMjAwODA5MjQxNyBGaXJlZm94LzMuMC4zJykKCXJlc3BvbnNlID0gdXJsbGliMi51cmxvcGVuKHUpCgl0cmVlID0gRVQucGFyc2UocmVzcG9uc2UpCglyb290RWxlbSA9IHRyZWUuZ2V0cm9vdCgpCglmb3IgY2hhbm5lbCBpbiB0cmVlLmZpbmRhbGwoImNoYW5uZWwiKToKCQlwZWFsa2lyaSA9IGNoYW5uZWwuZmluZCgidGl0bGUiKS50ZXh0CgkJcGVhbGtpcmkgPSBiYXNlNjQuYjY0ZGVjb2RlKHBlYWxraXJpKQoJCXBlYWxraXJpID0gcGVhbGtpcmkuZW5jb2RlKCJ1dGYtOCIpCgkJc3RyaWltaWxpbmsgPSBjaGFubmVsLmZpbmQoInN0cmVhbV91cmwiKS50ZXh0CgkJCgkJdXJsY2hhbWEgPSBzdHJpaW1pbGluay5zcGxpdCgnLycpCgkJdXJsbm9vID0gJycKCQl0cnk6CgkJCXVybG5vbyA9IHVybGNoYW1hWzVdCgkJCXVybG5vbyA9IHVybG5vby5yZXBsYWNlKCd0cycsJycpCgkJCXVybG5vbyA9IHVybG5vby5yZXBsYWNlKCdtM3U4JywnJykKCQlleGNlcHQ6CgkJCXBhc3MKCQkKCQlwaWx0ID0gY2hhbm5lbC5maW5kKCJkZXNjX2ltYWdlIikudGV4dCAKCQlkZXNjcmlwdCA9IGNoYW5uZWwuZmluZCgiZGVzY3JpcHRpb24iKS50ZXh0CgkJaWYgZGVzY3JpcHQ6CgkJCWRlc2NyaXB0ID0gYmFzZTY0LmI2NGRlY29kZShkZXNjcmlwdCkKCQlpZiBwaWx0OgoJCQlhZGRMaW5rQ2FuYWxMaXN0YShwZWFsa2lyaSxzdHJpaW1pbGluayxwaWx0LGRlc2NyaXB0LG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb192aWQucG5nJyksIHVybG5vbykKCQllbHNlOgoJCQlhZGRMaW5rQ2FuYWxMaXN0YShwZWFsa2lyaSxzdHJpaW1pbGluayxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX3R2LnBuZycpLGRlc2NyaXB0LG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb192aWQucG5nJyksIHVybG5vbykKCQoJeGJtY3BsdWdpbi5zZXRDb250ZW50KGludChzeXMuYXJndlsxXSkgLCJtb3ZpZXMiKQoJdmlzdGFfQ2FuYWlzKCkKCmRlZiBhZGRMaW5rQ2FuYWxMaXN0YSh0aXRsZSwgdXJsLCB0aHVtYm5haWwsIHBsb3QsIGZhbmFydCwgaWRjYW5hbCwgaXNQbGF5YWJsZT1UcnVlLCBmb2xkZXI9RmFsc2UpOgoJb2s9VHJ1ZQoJY209W10KCWlmKGlkY2FuYWwgIT0gJzAwMDEnKToKCQljbS5hcHBlbmQoKCdWZXIgcHJvZ3JhbWHDp8OjbycsICdYQk1DLlJ1blBsdWdpbiglcz9tb2RlPTMxJm5hbWU9JXMmdXJsPSVzJmljb25pbWFnZT0lcyZpZENhbmFsPSVzJmlkZmZDYW5hbD0lcyknJShzeXMuYXJndlswXSx1cmxsaWIucXVvdGVfcGx1cyh0aXRsZSksIHVybGxpYi5xdW90ZV9wbHVzKHVybCksIHVybGxpYi5xdW90ZV9wbHVzKHRodW1ibmFpbCksIGlkY2FuYWwsICcnKSkpCgkKCWxpc3RpdGVtPXhibWNndWkuTGlzdEl0ZW0odGl0bGUsaWNvbkltYWdlPXRodW1ibmFpbCx0aHVtYm5haWxJbWFnZT10aHVtYm5haWwpCglsaXN0aXRlbS5hZGRDb250ZXh0TWVudUl0ZW1zKGNtLCByZXBsYWNlSXRlbXM9RmFsc2UpCglpbmZvX2xhYmVscz17IlRpdGxlIjp0aXRsZSwiRmlsZU5hbWUiOnRpdGxlLCJQbG90IjpwbG90fQoJbGlzdGl0ZW0uc2V0SW5mbyggInZpZGVvIiwgaW5mb19sYWJlbHMgKQoJbGlzdGl0ZW0uc2V0UHJvcGVydHkoJ2ZhbmFydF9pbWFnZScsIGZhbmFydCkKCWxpc3RpdGVtLnNldEFydCh7J2ZhbmFydCc6IGZhbmFydH0pCglsaXN0aXRlbS5zZXRQcm9wZXJ0eSgiVmlkZW8iLCJ0cnVlIikKCXUgPSBzeXMuYXJndlswXSArICI/dXJsPSIgKyBzdHIodXJsKSArICImbW9kZT0xMCZuYW1lPSIgKyBzdHIobmFtZSkgKyAiJmljb25pbWFnZT0iK3N0cihpY29uaW1hZ2UpKyImZmFuYXJ0PSIrc3RyKGZhbmFydCkrIiZwbG90PSIrc3RyKHBsb3QpCglvaz14Ym1jcGx1Z2luLmFkZERpcmVjdG9yeUl0ZW0oaGFuZGxlPWludChzeXMuYXJndlsxXSksdXJsPXUsbGlzdGl0ZW09bGlzdGl0ZW0saXNGb2xkZXI9Zm9sZGVyKQoJcmV0dXJuIG9rCgpkZWYgcnVuX2Nyb25qb2IodGl0bGUsdXJsLGltYWdlLHBsb3QsZmFuYXJ0KToKCXZhbmVtYWx1a2s9X19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX2FkdWx0b3Nfc2ltIikKCWlmIHZhbmVtYWx1a2sgPT0gInRydWUiOgoJCXZhbmVtYV9sdWtrKG5hbWUpCgkKCWlmIHBsb3QgPT0gJ3Byb2dyYW1hcyc6CgkJdXJsbiA9ICIiCgkJdHJ5OiB1cmxuID0gYmFzZTY0LmI2NGRlY29kZSh1cmwpLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCXVybGNoYW1hID0gdXJsbi5zcGxpdCgnOzs7JykKCQl1cmxub28gPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC9zZWFyY2h1cmwucGhwP2NhbmFsPScrdXJsY2hhbWFbMF0rJyZ1cmw9Jyt1cmxjaGFtYVsxXSsnJmNsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZhZGRvbj0xJwoJCQoJCW1lbnNhZ2VtcHJvZ3Jlc3NvID0geGJtY2d1aS5EaWFsb2dQcm9ncmVzcygpCgkJbWVuc2FnZW1wcm9ncmVzc28uY3JlYXRlKEFkZG9uVGl0bGUsIHUnQWJyaXIgZW1pc3PDo28nLCdQb3IgZmF2b3IgYWd1YXJkZS4uLicpCgkJbWVuc2FnZW1wcm9ncmVzc28udXBkYXRlKDI1LCAiIiwgdSdPYnRlciB2aWRlbycsICIiKQoJCXJlc3VsdGFkbzEgPSBkZXZvbHZlcmVzdWx0YWRvKHVybG5vbykKCQltZW5zYWdlbXByb2dyZXNzby51cGRhdGUoNTAsICIiLCB1J1ByZXBhcmEtdGUsIHZhaSBjb21lw6dhciEnLCAiIikKCQlyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbzEpCgkJbWVuc2FnZW1wcm9ncmVzc28udXBkYXRlKDc1LCAiIiwgdSdCb2EgU2Vzc8OjbyEhIScsICIiKQoJCXVybG4gPSAiIgoJCWZvciBpIGluIHJlc3VsdGFkb1snaW5mb3JtYWNhbyddOgoJCQl0cnk6IHVybG4gPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ3VybCddKS5kZWNvZGUoJ3V0Zi04JykKCQkJZXhjZXB0OiBwYXNzCgkJCQoJCW1lbnNhZ2VtcHJvZ3Jlc3NvLmNsb3NlKCkKCQl4Ym1jLnNsZWVwKDUwMDApCgkJcGxheWxpc3QgPSB4Ym1jLlBsYXlMaXN0KHhibWMuUExBWUxJU1RfVklERU8pCgkJcGxheWxpc3QuY2xlYXIoKQoJCWluZm9fbGFiZWxzPXsiVGl0bGUiOnRpdGxlLCJGaWxlTmFtZSI6dGl0bGUsIlBsb3QiOnBsb3R9CgkJbGlzdGl0ZW09eGJtY2d1aS5MaXN0SXRlbSh0aXRsZSxpY29uSW1hZ2U9aW1hZ2UsdGh1bWJuYWlsSW1hZ2U9aW1hZ2UpCgkJbGlzdGl0ZW0uc2V0SW5mbyggInZpZGVvIiwgaW5mb19sYWJlbHMgKQoJCXBsYXlsaXN0LmFkZCh1cmw9dXJsbiwgbGlzdGl0ZW09bGlzdGl0ZW0sIGluZGV4PTEpCgkJeGJtYy5QbGF5ZXIoKS5wbGF5KHBsYXlsaXN0KQoJZWxzZToKCQlwbGF5bGlzdCA9IHhibWMuUGxheUxpc3QoeGJtYy5QTEFZTElTVF9WSURFTykKCQlwbGF5bGlzdC5jbGVhcigpCgkJaW5mb19sYWJlbHM9eyJUaXRsZSI6dGl0bGUsIkZpbGVOYW1lIjp0aXRsZSwiUGxvdCI6cGxvdH0KCQlsaXN0aXRlbT14Ym1jZ3VpLkxpc3RJdGVtKHRpdGxlLGljb25JbWFnZT1pbWFnZSx0aHVtYm5haWxJbWFnZT1pbWFnZSkKCQlsaXN0aXRlbS5zZXRJbmZvKCAidmlkZW8iLCBpbmZvX2xhYmVscyApCgkJcGxheWxpc3QuYWRkKHVybD11cmwsIGxpc3RpdGVtPWxpc3RpdGVtLCBpbmRleD0xKQoJCXhibWMuUGxheWVyKCkucGxheShwbGF5bGlzdCkKCQoKZGVmIHN5bmNfZGF0YShjaGFubmVsKToKCXZpZGVvID0gYmFzZTY0LmI2NGRlY29kZShjaGFubmVsKQoJcmV0dXJuIHZpZGVvCgpkZWYgcmVzdGFydF9zZXJ2aWNlKHBhcmFtcyk6Cgl2YW5lbWFsdWtrPV9fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9hZHVsdG9zX3NpbSIpCglpZiB2YW5lbWFsdWtrID09ICJ0cnVlIjoKCQlwZWFsa2lyaSA9IHBhcmFtcy5nZXQoc3luY19kYXRhKCJkR2wwYkdVPSIpKQoJCXZhbmVtYV9sdWtrKHBlYWxraXJpKQoJbG9wcGxpbmsgPSBwYXJhbXMuZ2V0KHZvZF9jaGFubmVscygiZFhKcyIpKQoJCgl4Ym1jcGx1Z2luLnNldFJlc29sdmVkVXJsKGludChzeXMuYXJndlsxXSksIFRydWUsIGxpc3RpdGVtKQoKZGVmIGdyYWJfZXBnKHVybCk6CglyZXEgPSB1cmxsaWIyLlJlcXVlc3QodXJsKQoJcmVxLmFkZF9oZWFkZXIoJ1VzZXItYWdlbnQnLCAnTW96aWxsYS81LjAgKFdpbmRvd3M7IFU7IFdpbmRvd3MgTlQgNS4xOyBlbi1HQjsgcnY6MS45LjAuMykgR2Vja28vMjAwODA5MjQxNyBGaXJlZm94LzMuMC4zJykKCXJlcS5hZGRfaGVhZGVyKHN5bmNfZGF0YSgiVlhObGNpMUJaMlZ1ZEE9PSIpICwgdm9kX2NoYW5uZWxzKCJTMjlrYVNCd2JIVm5hVzRnWW5rZ1RHbDJaU0YwIikpCglyZXNwb25zZSA9IHVybGxpYjIudXJsb3BlbihyZXEpCglsaW5rPXJlc3BvbnNlLnJlYWQoKQoJaWYgbGluayAhPSAneyJ1c2VyX2luZm8iOnsiYXV0aCI6MH19JzoKCQlqZGF0YSA9IGpzb24ubG9hZHMobGluay5kZWNvZGUoJ3V0ZjgnKSkKCQlyZXNwb25zZS5jbG9zZSgpCgkJaWYgamRhdGE6CgkJCXJldHVybiBqZGF0YQoJZWxzZToKCQlyZXR1cm4gTm9uZQoJCmRlZiBrb250cm9sbCh1cmwpOgoJcmFuZG9tc3RyaW5nID0gZ3JhYl9lcGcodXJsKQoJa2FzdXRhamFpbmZvID0gcmFuZG9tc3RyaW5nW3N5bmNfZGF0YSgiZFhObGNsOXBibVp2IildCglrb250cm9sbCA9IGthc3V0YWphaW5mb1tnZXRfbGl2ZSgiWVhWMGFBPT0iKV0KCXJldHVybiBrb250cm9sbApkZWYgZ2V0X2xpdmUoY2hhbm5lbCk6Cgl2aWRlbyA9IGJhc2U2NC5iNjRkZWNvZGUoY2hhbm5lbCkKCXJldHVybiB2aWRlbwpkZWYgZXhlY3V0ZV9haW5mbyh1cmwpOgoJYW5kbWVkID0gZ3JhYl9lcGcodXJsKQoJa2FzdXRhamFBbmRtZWQgPSBhbmRtZWRbc3luY19kYXRhKCJkWE5sY2w5cGJtWnYiKV0KCXNlaXMgPSBrYXN1dGFqYUFuZG1lZFtnZXRfbGl2ZSgiYzNSaGRIVnoiKV0KCWFlZ3ViID0ga2FzdXRhamFBbmRtZWRbc3luY19kYXRhKCJaWGh3WDJSaGRHVT0iKV0KCWlmIGFlZ3ViOgoJCWFlZ3ViID0gZGF0ZXRpbWUuZGF0ZXRpbWUuZnJvbXRpbWVzdGFtcChpbnQoYWVndWIpKS5zdHJmdGltZSgnJUg6JU0gJWQuJW0uJVknKQoJZWxzZToKCQlhZWd1YiA9IHZvZF9jaGFubmVscygiVG1WMlpYST0iKSAKCXJhYmJpdHMgPSBrYXN1dGFqYUFuZG1lZFt2b2RfY2hhbm5lbHMoImFYTmZkSEpwWVd3PSIpXQoJaWYgcmFiYml0cyA9PSAiMCI6CgkJcmFiYml0cyA9IHN5bmNfZGF0YSgiVG04PSIpCgllbHNlOgoJCXJhYmJpdHMgPSBzeW5jX2RhdGEoIldXVnoiKQoJbGVhdmVtZWFsb25lID0ga2FzdXRhamFBbmRtZWRbZ2V0X2xpdmUoImJXRjRYMk52Ym01bFkzUnBiMjV6IildCglwb2xhcmJlYXJzID0ga2FzdXRhamFBbmRtZWRbc3luY19kYXRhKCJkWE5sY201aGJXVT0iKV0KCQoJYWRkTGlua0NhbmFsTGlzdGEoIltDT0xPUiA9IHdoaXRlXVV0aWxpemFkb3I6IFsvQ09MT1JdIitwb2xhcmJlYXJzLCIiLCIiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fY29uLnBuZycpLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19jb24ucG5nJyksJycpCgkKCWFkZExpbmtDYW5hbExpc3RhKCJbQ09MT1IgPSB3aGl0ZV1Fc3RhZG86IFsvQ09MT1JdIitzZWlzLCIiLCIiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fY29uLnBuZycpLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19jb24ucG5nJyksJycpCgkKCWFkZExpbmtDYW5hbExpc3RhKCJbQ09MT1IgPSB3aGl0ZV1FeHBpcmE6IFsvQ09MT1JdIithZWd1YiwiIiwiIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX2Nvbi5wbmcnKSxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fY29uLnBuZycpLCcnKQoJCglhZGRMaW5rQ2FuYWxMaXN0YSgiW0NPTE9SID0gd2hpdGVdQ29udGEgZGUgVGVzdGU6IFsvQ09MT1JdIityYWJiaXRzLCIiLCIiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fY29uLnBuZycpLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19jb24ucG5nJyksJycpCgkKCWFkZExpbmtDYW5hbExpc3RhKCJbQ09MT1IgPSB3aGl0ZV1NYXhpbW8gZGUgQ29ubmVjOiBbL0NPTE9SXSIrbGVhdmVtZWFsb25lLCIiLCIiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fY29uLnBuZycpLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19jb24ucG5nJyksJycpCgkKCXZpc3RhX0dydXBvcygpCgpkZWYgdmFuZW1hX2x1a2sobmFtZSk6CglhID0gJ1hYWCcsICdBZHVsdCcsICdBZHVsdHMnLCdBRFVMVCcsJ0FEVUxUUycsJ2FkdWx0JywnYWR1bHRzJywnUG9ybicsJ1BPUk4nLCdwb3JuJywnUG9ybicsJ3h4eCcKCWlmIGFueShzIGluIG5hbWUgZm9yIHMgaW4gYSk6CgkJeGJtYy5leGVjdXRlYnVpbHRpbigodSdYQk1DLk5vdGlmaWNhdGlvbigiQ29udHJvbG8gUGFyZW50YWwiLCAiTyBjYW5hbCBjb250ZW0gY29udGV1ZG8gYWR1bHRvIiwgMjAwMCknKSkKCQl0ZXh0ID0gcGx1Z2ludG9vbHMua2V5Ym9hcmRfaW5wdXQoZGVmYXVsdF90ZXh0PSIiLCB0aXRsZT0iQ29kaWdvIHBhcmEgY29udHJvbG8gcGFyZW50YWwiKQoJCWlmIHRleHQ9PXBsdWdpbnRvb2xzLmdldF9zZXR0aW5nKHN5bmNfZGF0YSgiYkc5bmFXNWZZV1IxYkhSdmN3PT0iKSk6CgkJICByZXR1cm4KCQllbHNlOgoJCSAgZXhpdCgpCgllbHNlOgoJCW5hbWUgPSAiIgoKZGVmIERvd25sb2FkZXJDbGFzcyh1cmwsZGVzdCk6CglkcCA9IHhibWNndWkuRGlhbG9nUHJvZ3Jlc3MoKQoJZHAuY3JlYXRlKHN5bmNfZGF0YSgiUjJWMGRHbHVaeUIxY0dSaGRHVT0iKSxnZXRfbGl2ZSgiUkc5M2JteHZZV1JwYm1jPSIpKQoJdXJsbGliLnVybHJldHJpZXZlKHVybCxkZXN0LGxhbWJkYSBuYiwgYnMsIGZzLCB1cmw9dXJsOiBfcGJob29rKG5iLGJzLGZzLHVybCxkcCkpCgpkZWYgX3BiaG9vayhudW1ibG9ja3MsIGJsb2Nrc2l6ZSwgZmlsZXNpemUsIHVybD1Ob25lLGRwPU5vbmUpOgoJdHJ5OgoJCXBlcmNlbnQgPSBtaW4oKG51bWJsb2NrcypibG9ja3NpemUqMTAwKS9maWxlc2l6ZSwgMTAwKQoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJycrcGVyY2VudCkKCQlkcC51cGRhdGUocGVyY2VudCkKCWV4Y2VwdDoKCQlwZXJjZW50ID0gMTAwCgkJZHAudXBkYXRlKHBlcmNlbnQpCglpZiBkcC5pc2NhbmNlbGVkKCk6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnTyBkb3dubG9hZCBmb2kgY2FuY2VsYWRvLicpCgkJZHAuY2xvc2UoKQoKZGVmIHZvZF9jaGFubmVscyhjaGFubmVsKToKCXZpZGVvID0gYmFzZTY0LmI2NGRlY29kZShjaGFubmVsKQoJcmV0dXJuIHZpZGVvCgpkZWYgUGxheVVybChuYW1lLCB1cmwsIGljb25pbWFnZT1Ob25lKToKCWxpc3RpdGVtID0geGJtY2d1aS5MaXN0SXRlbShwYXRoPXVybCwgdGh1bWJuYWlsSW1hZ2U9aWNvbmltYWdlKQoJbGlzdGl0ZW0uc2V0SW5mbyh0eXBlPSJWaWRlbyIsIGluZm9MYWJlbHM9eyAiVGl0bGUiOiBuYW1lIH0pCgl4Ym1jcGx1Z2luLnNldFJlc29sdmVkVXJsKGludChzeXMuYXJndlsxXSksIFRydWUsIGxpc3RpdGVtKQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMJCQkJCQkJCQkJCQkJTWVudSBUViBBcnF1aXZvCQkJCQkJCQkJCQkgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCmRlZiBsaXN0YXR2YXJjaGl2ZSh1cmwpOgoJZW5kZXJlY28gPSB1cmwrInBhbmVsX2FwaS5waHA/dXNlcm5hbWU9IitfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fbmFtZScpKyImcGFzc3dvcmQ9IitfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fcGFzc3dvcmQnKSsiJmFjdGlvbj1nZXRfbGl2ZV9zdHJlYW1zIgoJI2lJaUlJSWkgPSB1cmxsaWIyLnVybG9wZW4oZW5kZXJlY28pCgkjb29vMDBPT09vb08JPSBqc29uLmxvYWQoaUlpSUlJaSkKCXJlcSA9IHVybGxpYjIuUmVxdWVzdChlbmRlcmVjbykKCXJlcS5hZGRfaGVhZGVyKHN5bmNfZGF0YSgiVlhObGNpMUJaMlZ1ZEE9PSIpICwgdm9kX2NoYW5uZWxzKCJTMjlrYVNCd2JIVm5hVzRnWW5rZ1RHbDJaU0YwIikpCglyZXNwb25zZSA9IHVybGxpYjIudXJsb3BlbihyZXEpCglsaW5rPXJlc3BvbnNlLnJlYWQoKQoJb29vMDBPT09vb08JPSBqc29uLmxvYWRzKGxpbmsuZGVjb2RlKCd1dGY4JykpCglyZXNwb25zZS5jbG9zZSgpCglPMDBPT09vT29vME8gPSBvb28wME9PT29vT1snYXZhaWxhYmxlX2NoYW5uZWxzJ10KCWZvcglPMDAwT09vMDBvbwlpbglPMDBPT09vT29vME8udmFsdWVzKCk6CgkJb28wT09vID0gTzAwME9PbzAwb29bJ3R2X2FyY2hpdmUnXQoJCWlmKG9vME9PbyA9PSAxKToKCQkJbmFtZXR2PU8wMDBPT28wMG9vWyduYW1lJ10KCQkJc3RyZWFtX2lkPU8wMDBPT28wMG9vWydzdHJlYW1faWQnXQoJCQlsb2dvX3R2PU8wMDBPT28wMG9vWydzdHJlYW1faWNvbiddCgkJCWR1cmF0aW9uID0gTzAwME9PbzAwb29bJ3R2X2FyY2hpdmVfZHVyYXRpb24nXQoJCQkKCQkJYWRkTGlua0dydXBvKG5hbWV0dixsb2dvX3R2LHN0cmVhbV9pZCx1cmwsZHVyYXRpb24sb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3R2X2FyYy5wbmcnKSwxKQoJCgl2aXN0YV9HcnVwb3MoKQoKZGVmIGxpc3RhdHZhcmNoaXZlY2FuYWlzKG5hbWUsc3RyZWFtX2lkLHVybCxkdXJhdGlvbixpY29uaW1hZ2UsZmFuYXJ0KToKCWVuZGVyZWNvID0gdXJsKyJwYW5lbF9hcGkucGhwP3VzZXJuYW1lPSIrX19BRERPTl9fLmdldFNldHRpbmcoJ2xvZ2luX25hbWUnKSsiJnBhc3N3b3JkPSIrX19BRERPTl9fLmdldFNldHRpbmcoJ2xvZ2luX3Bhc3N3b3JkJykrIiZhY3Rpb249Z2V0X2VwZyZzdHJlYW1faWQ9IitzdHJlYW1faWQKCSNpSWlJSUlpID0gdXJsbGliMi51cmxvcGVuKGVuZGVyZWNvKQoJI2lpaUkxMQk9IGpzb24ubG9hZChpSWlJSUlpKQoJcmVxID0gdXJsbGliMi5SZXF1ZXN0KGVuZGVyZWNvKQoJcmVxLmFkZF9oZWFkZXIoc3luY19kYXRhKCJWWE5sY2kxQloyVnVkQT09IikgLCB2b2RfY2hhbm5lbHMoIlMyOWthU0J3YkhWbmFXNGdZbmtnVEdsMlpTRjAiKSkKCXJlc3BvbnNlID0gdXJsbGliMi51cmxvcGVuKHJlcSkKCWxpbms9cmVzcG9uc2UucmVhZCgpCglpaWlJMTEJPSBqc29uLmxvYWRzKGxpbmsuZGVjb2RlKCd1dGY4JykpCglyZXNwb25zZS5jbG9zZSgpCgkKCWlpSWlJID0gZGF0ZXRpbWUuZGF0ZXRpbWUudXRjbm93KCkgLSBkYXRldGltZS50aW1lZGVsdGEoZGF5cz1pbnQoZHVyYXRpb24pKQoJbzAwb29vTzBPbwk9Y2FsZW5kYXIudGltZWdtKGlpSWlJLnRpbWV0dXBsZSgpKQoJbzAwb29vTzBPbwk9aW50KG8wMG9vb08wT28pCglvME8wT09PME9vbwk9dGltZS50aW1lKCkKCW8wTzBPT08wT29vCT1pbnQobzBPME9PTzBPb28pCgkKCWZvcglpaUlpSUkxCWluCWlpaUkxMQk6CgkJdGl0bGVfdHYgPSBpaUlpSUkxWyd0aXRsZSddCgkJdGl0bGVfdHY9YmFzZTY0LmI2NGRlY29kZSh0aXRsZV90dikKCQlzdGFydAk9IGludChpaUlpSUkxWydzdGFydCddKQoJCWVuZAk9IGludChpaUlpSUkxWydlbmQnXSkKCQlzZWd1bmRvID0gMC4wMTY2NjY2NjY3CgkJCgkJZHVyYWNhbyA9IGludCgoZW5kLXN0YXJ0KSpzZWd1bmRvKQoJCQoJCWlmKHN0YXJ0ID4gbzAwb29vTzBPbyBhbmQgc3RhcnQgPCBvME8wT09PME9vbyk6CgkJCWlmIDkwIC0gOTA6CU9vbzAJJQlPbzBvb08wb28wb08JLwlPbzBvTzBvb28KCQkJSUlpID0gZGF0ZXRpbWUuZGF0ZXRpbWUuZnJvbXRpbWVzdGFtcChpbnQoc3RhcnQpKS5zdHJmdGltZSgnJWQuJW0gJUg6JU0nKQoJCQlpMUlpaTFpMUkgPSBkYXRldGltZS5kYXRldGltZS5mcm9tdGltZXN0YW1wKGludChzdGFydCkpLnN0cmZ0aW1lKCclWS0lbS0lZDolSDolTScpCgkJCXRpdGxlX3R2ID0gSUlpICsgIiAiICsgdGl0bGVfdHYKCQkJZW5kZXJlY28gPSB1cmwrInN0cmVhbWluZy90aW1lc2hpZnQucGhwP3VzZXJuYW1lPSIrX19BRERPTl9fLmdldFNldHRpbmcoJ2xvZ2luX25hbWUnKSsiJnBhc3N3b3JkPSIrX19BRERPTl9fLmdldFNldHRpbmcoJ2xvZ2luX3Bhc3N3b3JkJykrIiZzdHJlYW09IitzdHJlYW1faWQrIiZzdGFydD0iK2kxSWlpMWkxSSsiJmR1cmF0aW9uPSIrc3RyKGR1cmFjYW8pCgkJCQoJCQlhZGRMaW5rQ2FuYWwodGl0bGVfdHYsZW5kZXJlY28saWNvbmltYWdlLCcwMDAxJywnJykKCQoJdmlzdGFfQ2FuYWlzKCkKCmRlZiBhZGRMaW5rR3J1cG8odGl0bGUsdGh1bWJuYWlsLHN0cmVhbV9pZCx1cmwsZHVyYXRpb24sZmFuYXJ0LHR5cGUpOgoJb2s9VHJ1ZQoJCglsaXN0aXRlbT14Ym1jZ3VpLkxpc3RJdGVtKHRpdGxlLGljb25JbWFnZT10aHVtYm5haWwsdGh1bWJuYWlsSW1hZ2U9dGh1bWJuYWlsKQoJaW5mb19sYWJlbHM9eyJUaXRsZSI6dGl0bGUsIkZpbGVOYW1lIjp0aXRsZX0KCWxpc3RpdGVtLnNldEluZm8oICJ2aWRlbyIsIGluZm9fbGFiZWxzICkKCWxpc3RpdGVtLnNldFByb3BlcnR5KCdmYW5hcnRfaW1hZ2UnLGZhbmFydCkKCXhibWNwbHVnaW4uc2V0UGx1Z2luRmFuYXJ0KGludChzeXMuYXJndlsxXSksZmFuYXJ0KQoJCgl1ID0gc3lzLmFyZ3ZbMF0gKyAiP3VybD0iICsgc3RyKHVybCkgKyAiJm1vZGU9NyZuYW1lPSIgKyBzdHIodGl0bGUpICsgIiZpY29uaW1hZ2U9IitzdHIodGh1bWJuYWlsKSsiJmZhbmFydD0iK3N0cihmYW5hcnQpKyImc3RyZWFtX2lkPSIrc3RyKHN0cmVhbV9pZCkrIiZkdXJhdGlvbj0iK2R1cmF0aW9uCgkKCW9rPXhibWNwbHVnaW4uYWRkRGlyZWN0b3J5SXRlbShoYW5kbGU9aW50KHN5cy5hcmd2WzFdKSx1cmw9dSxsaXN0aXRlbT1saXN0aXRlbSxpc0ZvbGRlcj1UcnVlKQoJCglyZXR1cm4gb2sKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCQkJCQkJCQkJCQkJCUFicmlyIFNldHRpbmcJCQkJCQkJCQkJICMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpkZWYgYWJyaXJEZWZpbmluY29lcygpOgoJX19BRERPTl9fLm9wZW5TZXR0aW5ncygpCgl2aXN0YV9tZW51KCkKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMjIwkJQ2xlYXIgQ2FjaGUJCSMjIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZGVmIENMRUFSQ0FDSEUoKToKCXhibWNfY2FjaGVfcGF0aCA9IG9zLnBhdGguam9pbih4Ym1jLnRyYW5zbGF0ZVBhdGgoJ3NwZWNpYWw6Ly9ob21lJyksICdjYWNoZScpCglpZiBvcy5wYXRoLmV4aXN0cyh4Ym1jX2NhY2hlX3BhdGgpPT1UcnVlOgkKCQlmb3Igcm9vdCwgZGlycywgZmlsZXMgaW4gb3Mud2Fsayh4Ym1jX2NhY2hlX3BhdGgpOgoJCQlmaWxlX2NvdW50ID0gMAoJCQlmaWxlX2NvdW50ICs9IGxlbihmaWxlcykKCQkJaWYgZmlsZV9jb3VudCA+IDA6CgkKCQkJCWRpYWxvZyA9IHhibWNndWkuRGlhbG9nKCkKCQkJCWlmIGRpYWxvZy55ZXNubygiQXBhZ2FyIENhY2hlIG5vIFhCTUMuIiwgc3RyKGZpbGVfY291bnQpICsgIiBmaWNoZWlyb3MgZW5jb250cmFkb3MuIiwgIlF1ZXIgYXBhZ2FyIHRvZG9zIG9zIGZpY2hlaXJvcyBlbSBjYWNoZT8iKToKCQkJCQoJCQkJCWZvciBmIGluIGZpbGVzOgoJCQkJCQl0cnk6CgkJCQkJCQlvcy51bmxpbmsob3MucGF0aC5qb2luKHJvb3QsIGYpKQoJCQkJCQlleGNlcHQ6CgkJCQkJCQlwYXNzCgkJCQkJZm9yIGQgaW4gZGlyczoKCQkJCQkJdHJ5OgoJCQkJCQkJc2h1dGlsLnJtdHJlZShvcy5wYXRoLmpvaW4ocm9vdCwgZCkpCgkJCQkJCWV4Y2VwdDoKCQkJCQkJCXBhc3MKCQkJCQkJCgkJCWVsc2U6CgkJCQlwYXNzCglpZiB4Ym1jLmdldENvbmRWaXNpYmlsaXR5KCdzeXN0ZW0ucGxhdGZvcm0uQVRWMicpOgoJCWF0djJfY2FjaGVfYSA9IG9zLnBhdGguam9pbignL3ByaXZhdGUvdmFyL21vYmlsZS9MaWJyYXJ5L0NhY2hlcy9BcHBsZVRWL1ZpZGVvLycsICdPdGhlcicpCgkJCgkJZm9yIHJvb3QsIGRpcnMsIGZpbGVzIGluIG9zLndhbGsoYXR2Ml9jYWNoZV9hKToKCQkJZmlsZV9jb3VudCA9IDAKCQkJZmlsZV9jb3VudCArPSBsZW4oZmlsZXMpCgkJCgkJCWlmIGZpbGVfY291bnQgPiAwOgoKCQkJCWRpYWxvZyA9IHhibWNndWkuRGlhbG9nKCkKCQkJCWlmIGRpYWxvZy55ZXNubygiQXBhZ2FyIGZpY2hlaXJvcyBBVFYyLiIsIHN0cihmaWxlX2NvdW50KSArICIgZmljaGVpcm9zIGVuY29udHJhZG9zIGVtICdPdXRyb3MnIiwgIlF1ZXIgYXBhZ2FyIHRvZG9zIG9zIGZpY2hlaXJvcyBlbSBjYWNoZT8iKToKCQkJCQoJCQkJCWZvciBmIGluIGZpbGVzOgoJCQkJCQlvcy51bmxpbmsob3MucGF0aC5qb2luKHJvb3QsIGYpKQoJCQkJCWZvciBkIGluIGRpcnM6CgkJCQkJCXNodXRpbC5ybXRyZWUob3MucGF0aC5qb2luKHJvb3QsIGQpKQoJCQkJCQkKCQkJZWxzZToKCQkJCXBhc3MKCQlhdHYyX2NhY2hlX2IgPSBvcy5wYXRoLmpvaW4oJy9wcml2YXRlL3Zhci9tb2JpbGUvTGlicmFyeS9DYWNoZXMvQXBwbGVUVi9WaWRlby8nLCAnTG9jYWxBbmRSZW50YWwnKQoJCQoJCWZvciByb290LCBkaXJzLCBmaWxlcyBpbiBvcy53YWxrKGF0djJfY2FjaGVfYik6CgkJCWZpbGVfY291bnQgPSAwCgkJCWZpbGVfY291bnQgKz0gbGVuKGZpbGVzKQoJCQoJCQlpZiBmaWxlX2NvdW50ID4gMDoKCgkJCQlkaWFsb2cgPSB4Ym1jZ3VpLkRpYWxvZygpCgkJCQlpZiBkaWFsb2cueWVzbm8oIkFwYWdhciBmaWNoZWlyb3MgQVRWMi4iLCBzdHIoZmlsZV9jb3VudCkgKyAiIGZpY2hlaXJvcyBlbmNvbnRyYWRvcyBlbSAnTG9jYWwnIiwgIlF1ZXIgYXBhZ2FyIHRvZG9zIG9zIGZpY2hlaXJvcyBlbSBjYWNoZT8iKToKCQkJCQoJCQkJCWZvciBmIGluIGZpbGVzOgoJCQkJCQlvcy51bmxpbmsob3MucGF0aC5qb2luKHJvb3QsIGYpKQoJCQkJCWZvciBkIGluIGRpcnM6CgkJCQkJCXNodXRpbC5ybXRyZWUob3MucGF0aC5qb2luKHJvb3QsIGQpKQoJCQkJCQkKCQkJZWxzZToKCQkJCXBhc3MKCQkJICAjIFNldCBwYXRoIHRvIEN5ZGlhIEFyY2hpdmVzIGNhY2hlIGZpbGVzCgkJCQkJCQkgCgoJIyBTZXQgcGF0aCB0byBXaGF0IHRoIEZ1cmsgY2FjaGUgZmlsZXMKCXd0Zl9jYWNoZV9wYXRoID0gb3MucGF0aC5qb2luKHhibWMudHJhbnNsYXRlUGF0aCgnc3BlY2lhbDovL3Byb2ZpbGUvYWRkb25fZGF0YS9wbHVnaW4udmlkZW8ud2hhdHRoZWZ1cmsvY2FjaGUnKSwgJycpCglpZiBvcy5wYXRoLmV4aXN0cyh3dGZfY2FjaGVfcGF0aCk9PVRydWU6CQoJCWZvciByb290LCBkaXJzLCBmaWxlcyBpbiBvcy53YWxrKHd0Zl9jYWNoZV9wYXRoKToKCQkJZmlsZV9jb3VudCA9IDAKCQkJZmlsZV9jb3VudCArPSBsZW4oZmlsZXMpCgkJCgkJIyBDb3VudCBmaWxlcyBhbmQgZ2l2ZSBvcHRpb24gdG8gZGVsZXRlCgkJCWlmIGZpbGVfY291bnQgPiAwOgoJCgkJCQlkaWFsb2cgPSB4Ym1jZ3VpLkRpYWxvZygpCgkJCQlpZiBkaWFsb2cueWVzbm8oIkFwYWdhciBhIGNhY2hlIFdURi4iLCBzdHIoZmlsZV9jb3VudCkgKyAiIGZpY2hlaXJvcyBlbmNvbnRyYWRvcy4iLCAiUXVlciBhcGFnYXIgdG9kb3Mgb3MgZmljaGVpcm9zIGVtIGNhY2hlPyIpOgoJCQkJCgkJCQkJZm9yIGYgaW4gZmlsZXM6CgkJCQkJCW9zLnVubGluayhvcy5wYXRoLmpvaW4ocm9vdCwgZikpCgkJCQkJZm9yIGQgaW4gZGlyczoKCQkJCQkJc2h1dGlsLnJtdHJlZShvcy5wYXRoLmpvaW4ocm9vdCwgZCkpCgkJCQkJCQoJCQllbHNlOgoJCQkJcGFzcwoJCQkJCgkJCQkjIFNldCBwYXRoIHRvIDRvRCBjYWNoZSBmaWxlcwoJY2hhbm5lbDRfY2FjaGVfcGF0aD0gb3MucGF0aC5qb2luKHhibWMudHJhbnNsYXRlUGF0aCgnc3BlY2lhbDovL3Byb2ZpbGUvYWRkb25fZGF0YS9wbHVnaW4udmlkZW8uNG9kL2NhY2hlJyksICcnKQoJaWYgb3MucGF0aC5leGlzdHMoY2hhbm5lbDRfY2FjaGVfcGF0aCk9PVRydWU6CQoJCWZvciByb290LCBkaXJzLCBmaWxlcyBpbiBvcy53YWxrKGNoYW5uZWw0X2NhY2hlX3BhdGgpOgoJCQlmaWxlX2NvdW50ID0gMAoJCQlmaWxlX2NvdW50ICs9IGxlbihmaWxlcykKCQkKCQkjIENvdW50IGZpbGVzIGFuZCBnaXZlIG9wdGlvbiB0byBkZWxldGUKCQkJaWYgZmlsZV9jb3VudCA+IDA6CgkKCQkJCWRpYWxvZyA9IHhibWNndWkuRGlhbG9nKCkKCQkJCWlmIGRpYWxvZy55ZXNubygiQXBhZ2FyIGZpY2hlaXJvcyA0b0QgZW0gY2FjaGUuIiwgc3RyKGZpbGVfY291bnQpICsgIiBmaWNoZWlyb3MgZW5jb250cmFkb3MuIiwgIlF1ZXIgYXBhZ2FyIHRvZG9zIG9zIGZpY2hlaXJvcyBlbSBjYWNoZT8iKToKCQkJCQoJCQkJCWZvciBmIGluIGZpbGVzOgoJCQkJCQlvcy51bmxpbmsob3MucGF0aC5qb2luKHJvb3QsIGYpKQoJCQkJCWZvciBkIGluIGRpcnM6CgkJCQkJCXNodXRpbC5ybXRyZWUob3MucGF0aC5qb2luKHJvb3QsIGQpKQoJCQkJCQkKCQkJZWxzZToKCQkJCXBhc3MKCQkJCQoJCQkJIyBTZXQgcGF0aCB0byBCQkMgaVBsYXllciBjYWNoZSBmaWxlcwoJaXBsYXllcl9jYWNoZV9wYXRoPSBvcy5wYXRoLmpvaW4oeGJtYy50cmFuc2xhdGVQYXRoKCdzcGVjaWFsOi8vcHJvZmlsZS9hZGRvbl9kYXRhL3BsdWdpbi52aWRlby5pcGxheWVyL2lwbGF5ZXJfaHR0cF9jYWNoZScpLCAnJykKCWlmIG9zLnBhdGguZXhpc3RzKGlwbGF5ZXJfY2FjaGVfcGF0aCk9PVRydWU6CQoJCWZvciByb290LCBkaXJzLCBmaWxlcyBpbiBvcy53YWxrKGlwbGF5ZXJfY2FjaGVfcGF0aCk6CgkJCWZpbGVfY291bnQgPSAwCgkJCWZpbGVfY291bnQgKz0gbGVuKGZpbGVzKQoJCQoJCSMgQ291bnQgZmlsZXMgYW5kIGdpdmUgb3B0aW9uIHRvIGRlbGV0ZQoJCQlpZiBmaWxlX2NvdW50ID4gMDoKCQoJCQkJZGlhbG9nID0geGJtY2d1aS5EaWFsb2coKQoJCQkJaWYgZGlhbG9nLnllc25vKCJBcGFnYXIgZmljaGVpcm9zIEJCQyBpUGxheWVyIGVtIGNhY2hlLiIsIHN0cihmaWxlX2NvdW50KSArICIgZmljaGVpcm9zIGVuY29udHJhZG9zLiIsICJRdWVyIGFwYWdhciB0b2RvcyBvcyBmaWNoZWlyb3MgZW0gY2FjaGU/Iik6CgkJCQkKCQkJCQlmb3IgZiBpbiBmaWxlczoKCQkJCQkJb3MudW5saW5rKG9zLnBhdGguam9pbihyb290LCBmKSkKCQkJCQlmb3IgZCBpbiBkaXJzOgoJCQkJCQlzaHV0aWwucm10cmVlKG9zLnBhdGguam9pbihyb290LCBkKSkKCQkJCQkJCgkJCWVsc2U6CgkJCQlwYXNzCgkJCQkKCQkJCQoJCQkJIyBTZXQgcGF0aCB0byBTaW1wbGUgRG93bmxvYWRlciBjYWNoZSBmaWxlcwoJZG93bmxvYWRlcl9jYWNoZV9wYXRoID0gb3MucGF0aC5qb2luKHhibWMudHJhbnNsYXRlUGF0aCgnc3BlY2lhbDovL3Byb2ZpbGUvYWRkb25fZGF0YS9zY3JpcHQubW9kdWxlLnNpbXBsZS5kb3dubG9hZGVyJyksICcnKQoJaWYgb3MucGF0aC5leGlzdHMoZG93bmxvYWRlcl9jYWNoZV9wYXRoKT09VHJ1ZToJCgkJZm9yIHJvb3QsIGRpcnMsIGZpbGVzIGluIG9zLndhbGsoZG93bmxvYWRlcl9jYWNoZV9wYXRoKToKCQkJZmlsZV9jb3VudCA9IDAKCQkJZmlsZV9jb3VudCArPSBsZW4oZmlsZXMpCgkJCgkJIyBDb3VudCBmaWxlcyBhbmQgZ2l2ZSBvcHRpb24gdG8gZGVsZXRlCgkJCWlmIGZpbGVfY291bnQgPiAwOgoJCgkJCQlkaWFsb2cgPSB4Ym1jZ3VpLkRpYWxvZygpCgkJCQlpZiBkaWFsb2cueWVzbm8oIkFwYWdhciBmaWNoZWlyb3MgU2ltcGxlIERvd25sb2FkZXIgZW0gY2FjaGUuIiwgc3RyKGZpbGVfY291bnQpICsgIiBmaWNoZWlyb3MgZW5jb250cmFkb3MuIiwgIlF1ZXIgYXBhZ2FyIHRvZG9zIG9zIGZpY2hlaXJvcyBlbSBjYWNoZT8iKToKCQkJCQoJCQkJCWZvciBmIGluIGZpbGVzOgoJCQkJCQlvcy51bmxpbmsob3MucGF0aC5qb2luKHJvb3QsIGYpKQoJCQkJCWZvciBkIGluIGRpcnM6CgkJCQkJCXNodXRpbC5ybXRyZWUob3MucGF0aC5qb2luKHJvb3QsIGQpKQoJCQkJCQkKCQkJZWxzZToKCQkJCXBhc3MKCQoJaXR2X2NhY2hlX3BhdGggPSBvcy5wYXRoLmpvaW4oeGJtYy50cmFuc2xhdGVQYXRoKCdzcGVjaWFsOi8vcHJvZmlsZS9hZGRvbl9kYXRhL3BsdWdpbi52aWRlby5pdHYvSW1hZ2VzJyksICcnKQoJaWYgb3MucGF0aC5leGlzdHMoaXR2X2NhY2hlX3BhdGgpPT1UcnVlOgkKCQlmb3Igcm9vdCwgZGlycywgZmlsZXMgaW4gb3Mud2FsayhpdHZfY2FjaGVfcGF0aCk6CgkJCWZpbGVfY291bnQgPSAwCgkJCWZpbGVfY291bnQgKz0gbGVuKGZpbGVzKQoJCQkKCQkJaWYgZmlsZV9jb3VudCA+IDA6CgkKCQkJCWRpYWxvZyA9IHhibWNndWkuRGlhbG9nKCkKCQkJCWlmIGRpYWxvZy55ZXNubygiQXBhZ2FyIGl0ZW1zIGVtIGNhY2hlIiwgc3RyKGZpbGVfY291bnQpICsgIiBmaWNoZWlyb3MgZW5jb250cmFkb3MuIiwgIlF1ZXIgYXBhZ2FyIHRvZG9zIG9zIGZpY2hlaXJvcyBlbSBjYWNoZT8iKToKCQkJCQoJCQkJCWZvciBmIGluIGZpbGVzOgoJCQkJCQlvcy51bmxpbmsob3MucGF0aC5qb2luKHJvb3QsIGYpKQoJCQkJCWZvciBkIGluIGRpcnM6CgkJCQkJCXNodXRpbC5ybXRyZWUob3MucGF0aC5qb2luKHJvb3QsIGQpKQoJCQkJCQkKCQkJZWxzZToKCQkJCXBhc3MKCWRpYWxvZyA9IHhibWNndWkuRGlhbG9nKCkKCWRpYWxvZy5vayhBZGRvblRpdGxlLCAiCQlDYWNoZSBhcGFnYWRhIGNvbSBzdWNlc3NvISIpCgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyMjCSBQdXJnZSBQYWNrYWdlcwkJIyMjCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpkZWYgUFVSR0VQQUNLQUdFUygpOgoJcGFja2FnZXNfY2FjaGVfcGF0aCA9IHhibWMudHJhbnNsYXRlUGF0aChvcy5wYXRoLmpvaW4oJ3NwZWNpYWw6Ly9ob21lL2FkZG9ucy9wYWNrYWdlcycsICcnKSkKCXRyeToJCgkJZm9yIHJvb3QsIGRpcnMsIGZpbGVzIGluIG9zLndhbGsocGFja2FnZXNfY2FjaGVfcGF0aCk6CgkJCWZpbGVfY291bnQgPSAwCgkJCWZpbGVfY291bnQgKz0gbGVuKGZpbGVzKQoJCQkKCQkJaWYgZmlsZV9jb3VudCA+IDA6CgkKCQkJCWRpYWxvZyA9IHhibWNndWkuRGlhbG9nKCkKCQkJCWlmIGRpYWxvZy55ZXNubygiRXhjbHVpciBpbmZvcm1hw6fDo28gZW0gQ2FjaGUuIiwgc3RyKGZpbGVfY291bnQpICsgIiBmaWNoZWlyb3MgZW5jb250cmFkb3MuIiwgIlF1ZXIgYXBhZ2FyIHRvZG9zIG9zIGZpY2hlaXJvcz8iKToKCQkJCQkJCQoJCQkJCWZvciBmIGluIGZpbGVzOgoJCQkJCQlvcy51bmxpbmsob3MucGF0aC5qb2luKHJvb3QsIGYpKQoJCQkJCWZvciBkIGluIGRpcnM6CgkJCQkJCXNodXRpbC5ybXRyZWUob3MucGF0aC5qb2luKHJvb3QsIGQpKQoJCQkJCWRpYWxvZyA9IHhibWNndWkuRGlhbG9nKCkKCQkJCQlkaWFsb2cub2soQWRkb25UaXRsZSwgIgkJS29kaSBsaW1wbyBjb20gc3VjZXNzby4iKQoJCQkJZWxzZToKCQkJCQkJcGFzcwoJCQllbHNlOgoJCQkJZGlhbG9nID0geGJtY2d1aS5EaWFsb2coKQoJCQkJZGlhbG9nLm9rKEFkZG9uVGl0bGUsICIJCU7Do28gZm9yYW0gZW5jb250cmFkb3MgZmljaGVpcm9zIGEgYXBhZ2FyLiIpCglleGNlcHQ6IAoJCWRpYWxvZyA9IHhibWNndWkuRGlhbG9nKCkKCQlkaWFsb2cub2soQWRkb25UaXRsZSwgIkVycm8gYW8gdGVudGFyIGFwYWdhciBmaWNoZWlyb3MgZW0gY2FjaGUuIikKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCQkJCQkJCQkJCQkJQWRkb24gTElWRUlUIEZpbG1lcyBlIFNlcmllcwkJCQkJCQkgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKZGVmIGRldm9sdmVyZXN1bHRhZG8odXJsbm9vKToKCXJlc3VsdGFkbyA9IGFicmlyX3VybCh1cmxub28sIGhlYWRlcj1oZWFkZXJzKQoJdHJ5OgoJCXJlc3VsdGFkbyA9IHJlc3VsdGFkby5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDoKCQlyZXN1bHRhZG8gPSByZXN1bHRhZG8uZW5jb2RlKCd1dGYtOCcpCglyZXR1cm4gcmVzdWx0YWRvCgpkZWYgZ2V0Q2F0ZWdvcmlhbGl2ZShpZCxpbmljaW8pOgoJY2F0ID0gbGVyX2ZpY2hlaXJvKG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ2NhdGVnb3JpYXNfbGl2ZS5saXZlaXQnKSkucmVwbGFjZSgnIicsICInIikKCXJldHVybiBjYXQKCQpkZWYgZ2V0U2FnYXNsaXZlKGlkLGluaWNpbyk6CgljYXQgPSBsZXJfZmljaGVpcm8ob3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnc2FnYXNfbGl2ZS5saXZlaXQnKSkucmVwbGFjZSgnIicsICInIikKCXJldHVybiBjYXQKCmRlZiBnZXRBbm9zbGl2ZShpZCxpbmljaW8pOgoJY2F0ID0gbGVyX2ZpY2hlaXJvKG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ2Fub3NfbGl2ZS5saXZlaXQnKSkucmVwbGFjZSgnIicsICInIikKCXJldHVybiBjYXQKCmRlZiBsb2dpbmxpbGkoaW5pY2lvKToKCXJlc3VsdGFkbyA9IEZhbHNlCgllcnJvcyA9ICIiCgl0cnk6CgkJdXJsbm9vID0gX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJmFkZG9uPTEmdGlwbz0nK2luaWNpbwoJCXJlc3VsdGFkbyA9IGRldm9sdmVyZXN1bHRhZG8odXJsbm9vKQoJCWVzY3JldmVyX2ZpY2hlaXJvKG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ2RlZmluaWNvZXNfbGl2ZS5saXZlaXQnKSwgcmVzdWx0YWRvKQoJCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJCWNhdGVnb3JpYXMgPSByZXN1bHRhZG9bJ2dydXBvcyddCgkJZXNjcmV2ZXJfZmljaGVpcm8ob3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnY2F0ZWdvcmlhc19saXZlLmxpdmVpdCcpLCBzdHIoY2F0ZWdvcmlhcykpCgkJYW5vcyA9IHJlc3VsdGFkb1snYW5vcyddCgkJZXNjcmV2ZXJfZmljaGVpcm8ob3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnYW5vc19saXZlLmxpdmVpdCcpLCBzdHIoYW5vcykpCgkJCgkJaWYgaW5pY2lvID09ICdpbmljaW9fZmlsbWVzJzoKCQkJc2FnYXMgPSByZXN1bHRhZG9bJ3NhZ2FzJ10KCQkJZXNjcmV2ZXJfZmljaGVpcm8ob3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnc2FnYXNfbGl2ZS5saXZlaXQnKSwgc3RyKHNhZ2FzKSkKCQlyZXR1cm4gVHJ1ZQoJZXhjZXB0OgoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ07Do28gZm9pIHBvc3PDrXZlbCBhYnJpciBhIHDDoWdpbmEuIFBvciBmYXZvciB0ZW50ZSBub3ZhbWVudGUuJykKCQlyZXR1cm4gRmFsc2UKCmRlZiBsaXN0YW1lbnVzX2xpdmVpdDEoKToKCWNoZWNrX2xvZ2luID0gbG9naW5saWxpKCdpbmljaW9fZmlsbWVzJykKCWlmIGNoZWNrX2xvZ2luID09IFRydWU6CgkJbWVudUZpbG1lczIob3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ZpbG1lcy5wbmcnKSxfX1NJVEVBZGRvbl9fKydJbWFnZW5zL2ZpbG1lc19mYW5hcnQucG5nJykKCWVsc2U6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnRXJybyBhIGZhemVyIGxvZ2luIG5lc3RhIHBhcnRlLiBUZW50ZSBub3ZhbWVudGUgbWFpcyB0YXJkZS4nKQoKZGVmIGxpc3RhbWVudXNfbGl2ZWl0MigpOgoJY2hlY2tfbG9naW4gPSBsb2dpbmxpbGkoJ2luaWNpb19zZXJpZXMnKQoJaWYgY2hlY2tfbG9naW4gPT0gVHJ1ZToKCQltZW51U2VyaWVzMihvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnc2VyaWVzLnBuZycpLF9fU0lURUFkZG9uX18rJ0ltYWdlbnMvc2VyaWVzX2ZhbmFydC5wbmcnKQoJZWxzZToKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdFcnJvIGEgZmF6ZXIgbG9naW4gbmVzdGEgcGFydGUuIFRlbnRlIG5vdmFtZW50ZSBtYWlzIHRhcmRlLicpCgpkZWYgbWVudUZpbG1lczIoaWNvbmltYWdlLGZhbmFydCk6CglhZGREaXIyKCdUb2RvcyBvcyBGaWxtZXMnLCBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1maWxtZXMmZ2VuZXJvPXRvZG9zJmFkZG9uPTEnLCAxMTExMSwgJ2ZpbG1lcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignVG9kb3Mgb3MgRGVzdGFxdWVzJywgX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89ZmlsbWVzJmdlbmVybz1kZXN0YXF1ZXMmYWRkb249MScsIDExMTExLCAnZmlsbWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdUb2RhcyBhcyBTYWdhcycsIF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPWZpbG1lcyZnZW5lcm89c2FnYXMmYWRkb249MScsIDExMTE5OSwgJ2ZpbG1lcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignUG9yIEFubycsIF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPWZpbG1lcyZnZW5lcm89YW5vcyZhZGRvbj0xJywgMTExMTgsICdmaWxtZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ1BvciBDYXRlZ29yaWEnLCBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1maWxtZXMmZ2VuZXJvPWNhdGVnb3JpYSZhZGRvbj0xJywgMTExMTksICdmaWxtZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ1BvciBSYXRpbmcnLCBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1maWxtZXMmZ2VuZXJvPXJhdGluZyZhZGRvbj0xJywgMTExMTEsICdmaWxtZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ1BhcmEgQ3JpYW7Dp2FzJywgX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89ZmlsbWVzJmdlbmVybz1raWRzJmFkZG9uPTEnLCAxMTExMSwgJ2ZpbG1lcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignW0NPTE9SIHBpbmtdW0JdUGVzcXVpc2FbL0JdWy9DT0xPUl0nLCBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1maWxtZXMmYWRkb249MScsIDExMTIwLCAnZmlsbWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCgl2aXN0YV9tZW51KCkKCmRlZiBtZW51U2VyaWVzMihpY29uaW1hZ2UsZmFuYXJ0KToKCWFkZERpcjIoJ1RvZGFzIFNlcmllcycsIF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPXNlcmllcyZnZW5lcm89dG9kb3MmYWRkb249MScsIDExMTEyLCAnc2VyaWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdUb2RvcyBvcyBEZXN0YXF1ZXMnLCBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1zZXJpZXMmZ2VuZXJvPWRlc3RhcXVlcyZhZGRvbj0xJywgMTExMTIsICdzZXJpZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ1BvciBBbm8nLCBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1zZXJpZXMmZ2VuZXJvPWFub3MmYWRkb249MScsIDExMTE4LCAnc2VyaWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdQb3IgQ2F0ZWdvcmlhJywgX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89c2VyaWVzJmdlbmVybz1jYXRlZ29yaWEmYWRkb249MScsIDExMTE5LCAnc2VyaWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdQb3IgUmF0aW5nJywgX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89c2VyaWVzJmdlbmVybz1yYXRpbmcmYWRkb249MScsIDExMTEyLCAnc2VyaWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdQYXJhIENyaWFuw6dhcycsIF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPXNlcmllcyZnZW5lcm89a2lkcyZhZGRvbj0xJywgMTExMTIsICdzZXJpZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ1tDT0xPUiBwaW5rXVtCXVBlc3F1aXNhWy9CXVsvQ09MT1JdJywgX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89c2VyaWVzJmFkZG9uPTEnLCAxMTEyMCwgJ3NlcmllcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJdmlzdGFfbWVudSgpCgkKZGVmIGZpbG1lczIodXJsKToKCXJlc3VsdGFkbyA9IGRldm9sdmVyZXN1bHRhZG8odXJsKQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pCglmb3IgaSBpbiByZXN1bHRhZG9bJ2l0ZW0nXToKCQlzZXRGaWxtZTIoaSkKCQoJY3VycmVudCA9IHJlc3VsdGFkb1sncGFnaW5hY2FvJ11bJ2F0dWFsJ10KCXRvdGFsID0gMAoJdHJ5OiB0b3RhbCA9IHJlc3VsdGFkb1sncGFnaW5hY2FvJ11bJ3RvdGFsJ10KCWV4Y2VwdDogcGFzcwoJdHJ5OiBwcm94aW1vID0gYmFzZTY0LmI2NGRlY29kZShyZXN1bHRhZG9bJ3BhZ2luYWNhbyddWydzZWd1aW50ZSddKQoJZXhjZXB0OiBwYXNzCglpZiBpbnQoY3VycmVudCkgPCBpbnQodG90YWwpOgoJCWFkZERpcjIoJ1Byw7N4aW1hIHDDoWdpbmEgKCcrc3RyKGN1cnJlbnQpKycvJytzdHIodG90YWwpKycpJywgcHJveGltbywgMTExMTEsICdmaWxtZXMnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncHJveGltby5wbmcnKSwxKQoJdmlzdGFfZmlsbWVzU2VyaWVzKCkKCQkKZGVmIHNlcmllczIodXJsKToKCXJlc3VsdGFkbyA9IGRldm9sdmVyZXN1bHRhZG8odXJsKQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pCgkKCWZvciBpIGluIHJlc3VsdGFkb1snaXRlbSddOgoJCXNldFNlcmllczIoaSkKCQoJY3VycmVudCA9IHJlc3VsdGFkb1sncGFnaW5hY2FvJ11bJ2F0dWFsJ10KCXRvdGFsID0gMAoJdHJ5OiB0b3RhbCA9IHJlc3VsdGFkb1sncGFnaW5hY2FvJ11bJ3RvdGFsJ10KCWV4Y2VwdDogcGFzcwoJdHJ5OiBwcm94aW1vID0gYmFzZTY0LmI2NGRlY29kZShyZXN1bHRhZG9bJ3BhZ2luYWNhbyddWydzZWd1aW50ZSddKQoJZXhjZXB0OiBwYXNzCglpZiBpbnQoY3VycmVudCkgPCBpbnQodG90YWwpOgoJCWFkZERpcjIoJ1Byb3hpbWEgcGFnaW5hICgnK3N0cihjdXJyZW50KSsnLycrc3RyKHRvdGFsKSsnKScsIHByb3hpbW8sIDExMTEyLCAnc2VyaWVzJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Byb3hpbW8ucG5nJykpCgl2aXN0YV9maWxtZXNTZXJpZXMoKQoJCgkKZGVmIHNldEZpbG1lMihpKToKCWNhdGVnb3JpYSA9ICIiCgl0cnk6IGNhdGVnb3JpYSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnR3J1cG8nXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJZ3J1cG8yID0gIiIKCXRyeTogZ3J1cG8yID0gYmFzZTY0LmI2NGRlY29kZShpWydHcnVwbzInXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MgCgkKCWdydXBvMyA9ICIiCgl0cnk6IGdydXBvMyA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnR3J1cG8zJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCWlmIGdydXBvMiAhPSAiIjoKCQljYXRlZ29yaWEgKz0gJywnK2dydXBvMgoJaWYgZ3J1cG8zICE9ICIiOgoJCWNhdGVnb3JpYSArPSAnLCcrZ3J1cG8zCgkKCXB0ID0gJycKCWJyID0gJycKCXNlbUxlZ2VuZGEgPSAnJwoJaWRfdmlkZW8gPSBpWydJRCddCgkKCW5vbWUgPSAnJwoJdHJ5OiBub21lID0gYmFzZTY0LmI2NGRlY29kZShpWydOb21lJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCW5vbWVlbiA9ICcnCgl0cnk6IG5vbWVlbiA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnTm9tZUVOJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCWRlc2NyaWNhbyA9ICcnCgl0cnk6IGRlc2NyaWNhbyA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnRGVzY3JpY2FvJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCXJlYWxpemFkb3IgPSAnJwoJdHJ5OiByZWFsaXphZG9yID0gYmFzZTY0LmI2NGRlY29kZShpWydSZWFsaXphZG9yJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCWFjdG9yZXMgPSAnJwoJdHJ5OiBhY3RvcmVzID0gYmFzZTY0LmI2NGRlY29kZShpWydBY3RvcmVzJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCXlvdXR1YmUgPSAnJwoJdHJ5OiB5b3V0dWJlID0gYmFzZTY0LmI2NGRlY29kZShpWydZb3V0dWJlJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCXVybDEgPSAnJwoJdHJ5OiB1cmwxID0gYmFzZTY0LmI2NGRlY29kZShpWydVcmwnXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJdXJsMiA9ICcnCgl0cnk6IHVybDIgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ1VybDEnXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJdXJsMyA9ICcnCgl0cnk6IHVybDMgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ1VybDInXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJdXJsNCA9ICcnCgl0cnk6IHVybDQgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ1VybDMnXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJaW1kYiA9ICcnCgl0cnk6IGltZGIgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0ltZGInXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJaW1hZ2VtID0gJycKCXRyeTogaW1hZ2VtID0gYmFzZTY0LmI2NGRlY29kZShpWydJbWFnZW0nXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJbGVnZW5kYXMgPSAnJwoJdHJ5OiBsZWdlbmRhcyA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnTGVnZW5kYXMnXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJYW5vcyA9IGlbJ0Fub05vdm8nXQoJCglpZiAnaHR0cCcgbm90IGluIGltYWdlbToKCQlpbWFnZW0gPSBfX0FQSV9fK2ltYWdlbQoJCglpZiBsZWdlbmRhcyA9PSAic2VtbGVnZW5kYSIgb3IgaVsnTGVnZW5kYXMnXSA9PSAiIjoKCQlzZW1MZWdlbmRhID0gJ1tDT0xPUiByZWRdW0JdUy8gTEVHRU5EQSBbL0JdWy9DT0xPUl0nCglpZiAnQnJhc2lsZWlybycgaW4gY2F0ZWdvcmlhOgoJCWJyID0gJ1tCXVtDT0xPUiBncmVlbl1CWy9DT0xPUl1bQ09MT1IgeWVsbG93XVJbL0NPTE9SXTogWy9CXScKCWlmICdQb3J0dScgaW4gY2F0ZWdvcmlhOgoJCXB0ID0gJ1tCXVtDT0xPUiBncmVlbl1QWy9DT0xPUl1bQ09MT1IgcmVkXVRbL0NPTE9SXTogWy9CXScKCQoJdmlzdG8gPSBGYWxzZQoJY29yID0gJ3doaXRlJwoJaWYgJ1BUJyBpbiBpbWRiOgoJCWltZGIgPSByZS5jb21waWxlKCcoLis/KVBUJykuZmluZGFsbChpbWRiKVswXQoJCXB0ID0gJ1tCXVtDT0xPUiBncmVlbl1QWy9DT0xPUl1bQ09MT1IgcmVkXVRbL0NPTE9SXTogWy9CXScKCQoJaW5mb0xhYmVscyA9IHsnVGl0bGUnOiBub21lZW4sICdZZWFyJzogYW5vcywgJ0dlbnJlJzogY2F0ZWdvcmlhLCAnUGxvdCc6IGRlc2NyaWNhbywgJ0Nhc3QnOiBhY3RvcmVzLnNwbGl0KCcsJyksICdUcmFpbGVyJzogeW91dHViZSwgJ0RpcmVjdG9yJzogcmVhbGl6YWRvciwgJ1JhdGluZyc6IGlbJ1JhdGluZyddLCAnSU1EQk51bWJlcic6IGltZGIgfQoKCW5vbWVlZSA9ICdbQ09MT1IgJytjb3IrJ10nK3B0K2JyK3NlbUxlZ2VuZGErcmVtb3ZlckFjZW50b3Mobm9tZSkrJyAoJythbm9zKycpWy9DT0xPUl0nCgl1cmxub28gPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1maWxtZXMmZ2VuZXJvPWdldF92aWRlbyZhZGRvbj0xJnBlc3F1aXNhPScrc3RyKGlkX3ZpZGVvKQoJZm90b29vID0gaW1hZ2VtCglmYW5hcnR0dCA9ICdpbWFnZXMvYmFja2dyb3VuZC8nK2ltZGIrJy5qcGcnCgkKCWFkZFZpZGVvKG5vbWVlZSwgdXJsbm9vLCAxMTExMywgZm90b29vLCB2aXN0bywgJ2ZpbG1lJywgMCwgMCwgaW5mb0xhYmVscywgZmFuYXJ0dHQsIHRyYWlsZXI9eW91dHViZSkKCmRlZiBnZXRHZW5lcm9zMl9saXZlKHVybCwgbW9kbyk6CglsaXN0YSA9IFtdCglsaXN0YSA9IGdldFNhZ2FzbGl2ZSgnaW5pY2lvX3NhZ2FzJywgbW9kbykKCQoJZm9yIGMgaW4gYXN0LmxpdGVyYWxfZXZhbChsaXN0YSk6CgkJaWYgY1snSUQnXSA9PSAiMCI6CgkJCWNvbnRpbnVlCgkJdHJ5OgoJCQljYXQgPSBiYXNlNjQuYjY0ZGVjb2RlKGNbJ05vbWUnXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OgoJCQlwYXNzCgkJCgkJdXJsbm92byA9IHVybCsnJnBlc3F1aXNhPScrc3RyKGNbJ0lEJ10pOwoJCWFkZERpcjIoY2F0LCB1cmxub3ZvLCAxMTEyMSwgbW9kbywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2dlbmVyby5wbmcnKSkKCQoJdmlzdGFfbWVudSgpCgpkZWYgZ2V0R2VuZXJvc19saXZlKHVybCwgbW9kbyk6CglsaXN0YSA9IFtdCglpZiBtb2RvID09ICdmaWxtZXMnOgoJCWxpc3RhID0gZ2V0Q2F0ZWdvcmlhbGl2ZSgnaW5pY2lvX2ZpbG1lcycsIG1vZG8pCgllbHNlOgoJCWxpc3RhID0gZ2V0Q2F0ZWdvcmlhbGl2ZSgnaW5pY2lvX3NlcmllcycsIG1vZG8pCgkKCWZvciBjIGluIGFzdC5saXRlcmFsX2V2YWwobGlzdGEpOgoJCWlmIGNbJ0lEJ10gPT0gIjAiOgoJCQljb250aW51ZQoJCXRyeToKCQkJY2F0ID0gYmFzZTY0LmI2NGRlY29kZShjWydOb21lJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDoKCQkJcGFzcwoJCQoJCXVybG5vdm8gPSB1cmwrJyZwZXNxdWlzYT0nK3N0cihjWydJRCddKTsKCQlhZGREaXIyKGNhdCwgdXJsbm92bywgMTExMjEsIG1vZG8sIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdnZW5lcm8ucG5nJykpCgkKCXZpc3RhX21lbnUoKQoKZGVmIGdldFllYXJzX2xpdmUodXJsLCBtb2RvKToKCWxpc3RhID0gW10KCWlmIG1vZG8gPT0gJ2ZpbG1lcyc6CgkJbGlzdGEgPSBnZXRBbm9zbGl2ZSgnaW5pY2lvX2ZpbG1lcycsIG1vZG8pCgllbHNlOgoJCWxpc3RhID0gZ2V0QW5vc2xpdmUoJ2luaWNpb19zZXJpZXMnLCBtb2RvKQoJCglmb3IgYyBpbiBhc3QubGl0ZXJhbF9ldmFsKGxpc3RhKToKCQlpZiBjWydJRCddID09ICIwIjoKCQkJY29udGludWUKCQl0cnk6CgkJCWNhdCA9IGJhc2U2NC5iNjRkZWNvZGUoY1snTm9tZSddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6CgkJCXBhc3MKCQkKCQl1cmxub3ZvID0gdXJsKycmcGVzcXVpc2E9JytzdHIoY1snSUQnXSk7CgkJYWRkRGlyMihjYXQsIHVybG5vdm8sIDExMTIxLCBtb2RvLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZ2VuZXJvLnBuZycpKQoJCgl2aXN0YV9tZW51KCkKCQpkZWYgZ2V0SW5mb19saXZlKHVybCwgdGlwbyk6CglyZXN1bHRhZG8gPSBkZXZvbHZlcmVzdWx0YWRvKHVybCkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJZm9yIGkgaW4gcmVzdWx0YWRvWyJpdGVtIl06CgkJaWYgdGlwbyA9PSAnZmlsbWVzJzoKCQkJc2V0RmlsbWUyKGkpCgkJZWxzZToKCQkJc2V0U2VyaWVzMihpKQoJCgljdXJyZW50ID0gcmVzdWx0YWRvWydwYWdpbmFjYW8nXVsnYXR1YWwnXQoJdG90YWwgPSAwCgl0cnk6IHRvdGFsID0gcmVzdWx0YWRvWydwYWdpbmFjYW8nXVsndG90YWwnXQoJZXhjZXB0OiBwYXNzCgl0cnk6IHByb3hpbW8gPSBiYXNlNjQuYjY0ZGVjb2RlKHJlc3VsdGFkb1sncGFnaW5hY2FvJ11bJ3NlZ3VpbnRlJ10pCglleGNlcHQ6IHBhc3MKCWlmIGludChjdXJyZW50KSA8IGludCh0b3RhbCk6CgkJYWRkRGlyMignUHJveGltYSBwYWdpbmEgKCcrc3RyKGN1cnJlbnQpKycvJytzdHIodG90YWwpKycpJywgcHJveGltbywgMTExMjEsIHRpcG8sIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdwcm94aW1vLnBuZycpKQoJdmlzdGFfZmlsbWVzU2VyaWVzKCkKCQpkZWYgcGVzcXVpc2FfbGl2ZSh1cmwsIHRpcG9sbyk6Cgljb2RpZ29fZm9udGUgPSAnJwoJZGFkb3MgPSAnJwoJdGFiZWxhID0gJycKCXN0clBlc3F1aXNhID0gJycKCWZpY2hlaXJvID0gJycKCXNpdGUgPSAnJwoJcXVhbGlkYWRlID0gJycKCXRva2VuUGVzcXVpc2E9ICcnCglyZXN1bHRhZG8gPSAnJwoJdGlwb2xvcGVzcXVpc2FOb3ZvID0gJzAnCglpZiB0aXBvbG8gPT0gJ2ZpbG1lcyc6CgkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdmaWxtZXNfcGVzcXVpc2EubGl2ZWl0JykKCQl0aXBvID0gMAoJCXF1YWxpZGFkZSA9IF9fUXVhbGlkYWRlX18KCWVsc2U6CgkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdzZXJpZXNfcGVzcXVpc2EubGl2ZWl0JykKCQl0aXBvID0gMQoJCXNpdGUgPSAnc2VyaWVzJwoJCglpZiAncGFnZScgbm90IGluIHVybDoKCQl0cnk6CgkJCXRpcG9sb3Blc3F1aXNhID0geGJtY2d1aS5EaWFsb2coKS5zZWxlY3QodSdPIHF1ZSBwcmV0ZW5kZSBwZXNxdWlzYXI/JywgWydQb3I6IE5vbWVQVCBvdSBOb21lIEVOJywgJ1BvcjogUmVhbGl6YWRvcicsJ1BvcjogQWN0b3InXSkKCQlleGNlcHQ6CgkJCXJldHVybiBGYWxzZQoJCQoJCWlmIHRpcG9sb3Blc3F1aXNhID09IDA6CgkJCXRpcG9sb3Blc3F1aXNhTm92byA9ICcwJwoJCWVsaWYgdGlwbyA9PSAxOgoJCQl0aXBvbG9wZXNxdWlzYU5vdm8gPSAnMScKCQllbGlmIHRpcG8gPT0gMjoKCQkJdGlwb2xvcGVzcXVpc2FOb3ZvID0gJzInCgkJCQoJCV9fQURET05fXy5zZXRTZXR0aW5nKCd0b2tlblBlc3F1aXNhJywgdGlwb2xvcGVzcXVpc2FOb3ZvKQoJCXRlY2xhZG8gPSB4Ym1jLktleWJvYXJkKCcnLCAnTyBxdWUgcXVlciBwZXNxdWlzYXI/JykKCQl0ZWNsYWRvLmRvTW9kYWwoKQoJCQoJCWlmIHRlY2xhZG8uaXNDb25maXJtZWQoKToKCQkJc3RyUGVzcXVpc2EgPSB0ZWNsYWRvLmdldFRleHQoKQoJCQlpZiBzdHJQZXNxdWlzYSA9PSAnJzoKCQkJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0luc2lyYSBhbGdvIG5hIHBlc3F1aXNhLicpCgkJCQlhZGREaXIyKCdBbHRlcmFyIFBlc3F1aXNhJywgdXJsLCAxMTEyMCwgdGlwb2xvLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncGVzcXVpc2EucG5nJyksIDApCgkJCQlyZXR1cm4gRmFsc2UKCQkJZWxzZToKCQkJCXRva2VuUGVzcXVpc2EgPSBzdHJQZXNxdWlzYS5yZXBsYWNlKCIgIiwgIiUyMCIpCgkJCQlfX0FERE9OX18uc2V0U2V0dGluZygndG9rZW5QZXNxdWlzYVRleHRvJywgdG9rZW5QZXNxdWlzYSkKCQoJcmVzdWx0YWRvID0gZGV2b2x2ZXJlc3VsdGFkbyh1cmwrJyZwZXNxdWlzYT0nK19fQURET05fXy5nZXRTZXR0aW5nKCd0b2tlblBlc3F1aXNhVGV4dG8nKSsnJmdlbmVybz1wZXNxdWlzYScrX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuUGVzcXVpc2EnKSkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJZm9yIGkgaW4gcmVzdWx0YWRvWyJpdGVtIl06CgkJaWYgdGlwb2xvID09ICdmaWxtZXMnOgoJCQlzZXRGaWxtZTIoaSkKCQllbHNlOgoJCQlzZXRTZXJpZXMyKGkpCgkKCWN1cnJlbnQgPSByZXN1bHRhZG9bJ3BhZ2luYWNhbyddWydhdHVhbCddCgl0b3RhbCA9IDAKCXRyeTogdG90YWwgPSByZXN1bHRhZG9bJ3BhZ2luYWNhbyddWyd0b3RhbCddCglleGNlcHQ6IHBhc3MKCXRyeTogcHJveGltbyA9IGJhc2U2NC5iNjRkZWNvZGUocmVzdWx0YWRvWydwYWdpbmFjYW8nXVsnc2VndWludGUnXSkKCWV4Y2VwdDogcGFzcwoJaWYgaW50KGN1cnJlbnQpIDwgaW50KHRvdGFsKToKCQlhZGREaXIyKCdQcm94aW1hIHBhZ2luYSAoJytzdHIoY3VycmVudCkrJy8nK3N0cih0b3RhbCkrJyknLCBwcm94aW1vLCAxMTEyMCwgdGlwb2xvLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncHJveGltby5wbmcnKSkKCWVsc2U6CgkJeGJtY3BsdWdpbi5lbmRPZkRpcmVjdG9yeShpbnQoc3lzLmFyZ3ZbMV0pLGNhY2hlVG9EaXNjPUZhbHNlKQoJCgl2aXN0YV9maWxtZXNTZXJpZXMoKQoKZGVmIHNldFNlcmllczIoaSk6CgljYXRlZ29yaWEgPSAiIgoJdHJ5OiBjYXRlZ29yaWEgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0dydXBvJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCWdydXBvMiA9ICIiCgl0cnk6IGdydXBvMiA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnR3J1cG8yJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzIAoJCglncnVwbzMgPSAiIgoJdHJ5OiBncnVwbzMgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0dydXBvMyddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglpZiBncnVwbzIgIT0gIiI6CgkJY2F0ZWdvcmlhICs9ICcsJytncnVwbzIKCWlmIGdydXBvMyAhPSAiIjoKCQljYXRlZ29yaWEgKz0gJywnK2dydXBvMwoJCglpZF92aWRlbyA9IGlbJ0lEJ10KCQoJbm9tZSA9ICcnCgl0cnk6IG5vbWUgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ05vbWUnXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJbm9tZWVuID0gJycKCXRyeTogbm9tZWVuID0gYmFzZTY0LmI2NGRlY29kZShpWydOb21lRU4nXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJZGVzY3JpY2FvID0gJycKCXRyeTogZGVzY3JpY2FvID0gYmFzZTY0LmI2NGRlY29kZShpWydEZXNjcmljYW8nXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJcmVhbGl6YWRvciA9ICcnCgl0cnk6IHJlYWxpemFkb3IgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ1JlYWxpemFkb3InXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJYWN0b3JlcyA9ICcnCgl0cnk6IGFjdG9yZXMgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0FjdG9yZXMnXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJeW91dHViZSA9ICcnCgl0cnk6IHlvdXR1YmUgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ1lvdXR1YmUnXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJaW1kYiA9ICcnCgl0cnk6IGltZGIgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0ltZGInXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJYW5vcyA9IGlbJ0Fub05vdm8nXQoJdGVtcG9yYWRhcyA9IGlbJ1RlbXBvcmFkYXMnXQoJCglpbWFnZW0gPSAnJwoJdHJ5OiBpbWFnZW0gPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0ltYWdlbSddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCgl2aXN0byA9IEZhbHNlCglwdCA9ICcnCgliciA9ICcnCglzZW1MZWdlbmRhID0gJycKCWlmICdCcmFzaWxlaXJvJyBpbiBjYXRlZ29yaWE6CgkJYnIgPSAnW0JdW0NPTE9SIGdyZWVuXUJbL0NPTE9SXVtDT0xPUiB5ZWxsb3ddUlsvQ09MT1JdOiBbL0JdJwoJaWYgJ1BvcnR1JyBpbiBjYXRlZ29yaWE6CgkJcHQgPSAnW0JdW0NPTE9SIGdyZWVuXVBbL0NPTE9SXVtDT0xPUiByZWRdVFsvQ09MT1JdOiBbL0JdJwoJaWYgJ1BUJyBpbiBpbWRiOgoJCXB0ID0gJ1tCXVtDT0xPUiBncmVlbl1QWy9DT0xPUl1bQ09MT1IgcmVkXVRbL0NPTE9SXTogWy9CXScKCQoJaWYgJ2h0dHAnIG5vdCBpbiBpbWFnZW06CgkJaW1hZ2VtID0gX19BUElfXytpbWFnZW0KCQoJdXJsbm9vID0gX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89c2VyaWVzJmdlbmVybz10ZW1wb3JhZGEmYWRkb249MSZzZXJpZT0nK2lkX3ZpZGVvKycmdGVtcG9yYWRhPScKCQoJaW5mb0xhYmVscyA9IHsnVGl0bGUnOiBub21lZW4sICdZZWFyJzogYW5vcywgJ0dlbnJlJzogY2F0ZWdvcmlhLCAnUGxvdCc6IGRlc2NyaWNhbywgJ0Nhc3QnOiBhY3RvcmVzLnNwbGl0KCcsJyksICdUcmFpbGVyJzogeW91dHViZSwgJ0RpcmVjdG9yJzogcmVhbGl6YWRvciwgJ1JhdGluZyc6IGlbJ1JhdGluZyddLCAnSU1EQk51bWJlcic6IGltZGIgfQoJCglub21lZWUgPSBwdCticitzZW1MZWdlbmRhK3JlbW92ZXJBY2VudG9zKG5vbWUpKycgKCcrYW5vcysnKScKCWZvdG9vbyA9IGltYWdlbQoJZmFuYXJ0dHQgPSBfX0FQSV9fKydpbWFnZXMvYmFja2dyb3VuZC8nK2ltZGIrJy5qcGcnCglhZGREaXIyKG5vbWVlZSwgdXJsbm9vLCAxMTExNCwgdGVtcG9yYWRhcywgZm90b29vLCB0aXBvPSdzZXJpZScsIGluZm9MYWJlbHM9aW5mb0xhYmVscyxwb3N0ZXI9ZmFuYXJ0dHQsdmlzdG89dmlzdG8pCgkKCQpkZWYgZ2V0U2Vhc29uczIodXJsLCBtb2RvKToKCWo9aW50KG1vZG8pCglmb3IgaSBpbiByYW5nZShqKToKCQlhZGREaXIyKCJbQl1UZW1wb3JhZGFbL0JdICIrc3RyKGkrMSksIHVybCtzdHIoaSsxKSwgMTExMTUsICdlcGlzb2Rpb3MnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCd0ZW1wb3JhZGFzJywgJ3RlbXBvcmFkYScrc3RyKGkrMSkrJy5wbmcnKSkKCQoJdmlzdGFfdGVtcG9yYWRhcygpCgpkZWYgZ2V0RXBpc29kZXMyKHVybCk6CglyZXN1bHRhZG8gPSBkZXZvbHZlcmVzdWx0YWRvKHVybCkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJZm9yIGkgaW4gcmVzdWx0YWRvWydpdGVtJ106CgkJcHQgPSAnJwoJCWJyID0gJycKCQlmaW5hbCA9ICcnCgkJc2VtTGVnZW5kYSA9ICcnCgkJCgkJdmlzdG8gPSBGYWxzZQoJCWNvciA9ICd3aGl0ZScKCQkKCQlub21lID0gJycKCQl0cnk6IG5vbWUgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ05vbWUnXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OiBwYXNzCgkKCQlpbWRiID0gJycKCQl0cnk6IGltZGIgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0ltZGInXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OiBwYXNzCgkJCgkJaW1hZ2VtID0gJycKCQl0cnk6IGltYWdlbSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnSW1hZ2VtJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCQoJCWxlZ2VuZGFzID0gJycKCQl0cnk6IGxlZ2VuZGFzID0gYmFzZTY0LmI2NGRlY29kZShpWydMZWdlbmRhcyddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQkKCQlhbm9zID0gaVsnQW5vTm92byddCgkKCQlpZiAnaHR0cCcgbm90IGluIGltYWdlbToKCQkJaW1hZ2VtID0gX19BUElfXytpbWFnZW0KCQoJCWlmIGxlZ2VuZGFzID09ICJzZW1sZWdlbmRhIiBvciBpWydMZWdlbmRhcyddID09ICIiOgoJCQlzZW1MZWdlbmRhID0gJ1tDT0xPUiByZWRdW0JdUy8gTEVHRU5EQSBbL0JdWy9DT0xPUl0nCgkJCgkJZXBpc29kaW8gPSBpWydFcGlzb2RpbyddCgkJdGVtcG9yYWRhID0gaVsnVGVtcG9yYWRhJ10KCQlpZF92aWRlbyA9IGlbJ0lEJ10KCQkKCQlpbmZvTGFiZWxzID0geydUaXRsZSc6IG5vbWUsICdDb2RlJzogaW1kYiwgJ0VwaXNvZGUnOiBlcGlzb2RpbywgJ1NlYXNvbic6IHRlbXBvcmFkYSB9CgkJbm9tZWVlID0gcHQrYnIrZmluYWwrc2VtTGVnZW5kYSsnW0NPTE9SICcrY29yKyddW0JdRXBpc29kaW8gJytzdHIoZXBpc29kaW8pKydbL0JdWy9DT0xPUl0gJytyZW1vdmVyQWNlbnRvcyhub21lKQoJCQoJCXVybG5vbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPXNlcmllcyZnZW5lcm89Z2V0X3ZpZGVvJmFkZG9uPTEmcGVzcXVpc2E9JytzdHIoaWRfdmlkZW8pCgkJZm90b29vID0gaW1hZ2VtCgkJZmFuYXJ0dHQgPSBfX0FQSV9fKydpbWFnZXMvYmFja2dyb3VuZC8nK2ltZGIrJy5qcGcnCgkJYWRkVmlkZW8obm9tZWVlLCB1cmxub28sIDExMTEzLCBpbWFnZW0sIHZpc3RvLCAnZXBpc29kaW8nLCB0ZW1wb3JhZGEsIGVwaXNvZGlvLCBpbmZvTGFiZWxzLCBmYW5hcnR0dCkKCQoJdmlzdGFfZXBpc29kaW9zKCkKCmRlZiBwbGF5ZXIyKG5hbWUsIHVybCwgaWNvbmltYWdlLCBtb2RvLCB0ZW1wb3JhZGEsIGVwaXNvZGlvLCB0aXBvbG9naSk6CglyZXN1bHRhZG8gPSBkZXZvbHZlcmVzdWx0YWRvKHVybCkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJaW5mb2xhYmVscyA9IGRpY3QoKQoJcGFzdGFEYXRhID0gJycKCW5vbWUgPSAnJwoJaWRWaWRlbyA9ICcwJwoJbWVuc2FnZW1wcm9ncmVzc28gPSB4Ym1jZ3VpLkRpYWxvZ1Byb2dyZXNzKCkKCW1lbnNhZ2VtcHJvZ3Jlc3NvLmNyZWF0ZShBZGRvblRpdGxlLCB1J0FicmlyIGVtaXNzw6NvJywnUG9yIGZhdm9yIGFndWFyZGUuLi4nKQoJbWVuc2FnZW1wcm9ncmVzc28udXBkYXRlKDI1LCAiIiwgdSdPYnRlciB2aWRlbyBlIGxlZ2VuZGEnLCAiIikKCglzdHJlYW0sIGxlZ2VuZGEsIGV4dF9nID0gZ2V0U3RyZWFtTGVnZW5kYTIocmVzdWx0YWRvWzBdLHRpcG9sb2dpKQoJaWYgc3RyZWFtID09IEZhbHNlIGFuZCBsZWdlbmRhID09IDIwNDoKCQltZW5zYWdlbXByb2dyZXNzby5jbG9zZSgpCgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnQWxndW0gZXJyby4gVGVudGUgbWFpcyB0YXJkZScpCgkJcmV0dXJuIEZhbHNlCgllbHNlOgoJCW1lbnNhZ2VtcHJvZ3Jlc3NvLnVwZGF0ZSg1MCwgIiIsIHUnUHJlcGFyYS10ZSwgdmFpIGNvbWXDp2FyIScsICIiKQoJCXBsYXlsaXN0ID0geGJtYy5QbGF5TGlzdCgxKQoJCXBsYXlsaXN0LmNsZWFyKCkKCQlsaXN0aXRlbSA9IHhibWNndWkuTGlzdEl0ZW0obmFtZSwgaWNvbkltYWdlPSJEZWZhdWx0VmlkZW8ucG5nIiwgdGh1bWJuYWlsSW1hZ2U9aWNvbmltYWdlKQoKCQlsaXN0aXRlbS5zZXRJbmZvKHR5cGU9IlZpZGVvIiwgaW5mb0xhYmVscz1pbmZvbGFiZWxzKQoJCWxpc3RpdGVtLnNldFByb3BlcnR5KCdtaW1ldHlwZScsICd2aWRlby94LW1zdmlkZW8nKQoJCWxpc3RpdGVtLnNldFByb3BlcnR5KCdJc1BsYXlhYmxlJywgJ3RydWUnKQoJCQoJCWxpc3RpdGVtLnNldFBhdGgocGF0aD1zdHJlYW0pCgkJcGxheWxpc3QuYWRkKHN0cmVhbSwgbGlzdGl0ZW0pCgkJeGJtY3BsdWdpbi5zZXRSZXNvbHZlZFVybChpbnQoc3lzLmFyZ3ZbMV0pLCBUcnVlLCBsaXN0aXRlbSkKCQltZW5zYWdlbXByb2dyZXNzby51cGRhdGUoNzUsICIiLCB1J0JvYSBTZXNzw6NvISEhJywgIiIpCgoJCWlmIHN0cmVhbSA9PSBGYWxzZToKCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnTyBzZXJ2aWRvciBlc2NvbGhpZG8gbsOjbyBkaXNwb27DrXZlbCwgZXNjb2xoYSBvdXRybyBvdSB0ZW50ZSBub3ZhbWVudGUgbWFpcyB0YXJkZS4nKQoJCWVsc2U6CgkJCXBsYXllcl9tciA9IFBsYXllci5QbGF5ZXIodXJsPXVybCwgaWRGaWxtZT1pZFZpZGVvLCBwYXN0YURhdGE9X19QQVNUQV9EQURPU19fLCB0ZW1wb3JhZGE9dGVtcG9yYWRhLCBlcGlzb2Rpbz1lcGlzb2Rpbywgbm9tZT1uYW1lLCBsb2dvPW9zLnBhdGguam9pbihfX0FERE9OX0ZPTERFUl9fLCdpY29uLnBuZycpKQoJCQltZW5zYWdlbXByb2dyZXNzby5jbG9zZSgpCgkJCXBsYXllcl9tci5wbGF5KHBsYXlsaXN0KQoJCQlwbGF5ZXJfbXIuc2V0U3VidGl0bGVzKGxlZ2VuZGEpCgkJCXdoaWxlIHBsYXllcl9tci5wbGF5aW5nOgoJCQkJeGJtYy5zbGVlcCg1MDAwKQoJCQkJI3BsYXllcl9tci50cmFja2VyVGVtcG8oKQoKZGVmIGdldFN0cmVhbUxlZ2VuZGEyKHR1ZG9pbmZvLHRpcG9vbyk6CglyZXN1bHRhZG8gPSB0dWRvaW5mbwoJaSA9IDAKCXNlcnZpZG9yZXMgPSBbXQoJdGl0dWxvcyA9IFtdCglub21lID0gJycKCXVybDEgPSAnJwoJdHJ5OiB1cmwxID0gYmFzZTY0LmI2NGRlY29kZShyZXN1bHRhZG9bJ1VybCddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJdXJsMiA9ICcnCgl0cnk6IHVybDIgPSBiYXNlNjQuYjY0ZGVjb2RlKHJlc3VsdGFkb1snVXJsMSddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJdXJsMyA9ICcnCgl0cnk6IHVybDMgPSBiYXNlNjQuYjY0ZGVjb2RlKHJlc3VsdGFkb1snVXJsMiddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJdXJsNCA9ICcnCgl0cnk6IHVybDQgPSBiYXNlNjQuYjY0ZGVjb2RlKHJlc3VsdGFkb1snVXJsMyddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJdXJsNSA9ICcnCgl0cnk6IHVybDUgPSBiYXNlNjQuYjY0ZGVjb2RlKHJlc3VsdGFkb1snVXJsNCddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglpZiB1cmwxICE9ICcnOgoJCWkrPTEKCQlpZiAnb2xvYWQnIGluIHVybDEgb3IgJ29wZW5sb2FkJyBpbiB1cmwxOgoJCQlub21lID0gIk9wZW5Mb2FkIgoJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwxKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAndmlkemknIGluIHVybDE6CgkJCW5vbWUgPSAnVmlkemknCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDEpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICdnb29nbGUnIGluIHVybDEgb3IgJ2Nsb3VkLm1haWwucnUnIGluIHVybDEgb3IgJy5tcDQnIGluIHVybDEgb3IgJy5hdmknIGluIHVybDE6CgkJCW5vbWUgPSBBZGRvblRpdGxlCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDEpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICd1cHRvc3RyZWFtLmNvbScgaW4gdXJsMToKCQkJbm9tZSA9ICdVcFRvU3RyZWFtJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwxKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAncmFwaWR2aWRlby5jb20nIGluIHVybDEgb3IgJ3JhcHR1JyBpbiB1cmwxOgoJCQlub21lID0gJ1JhcHR1JwoJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwxKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAndmlkb3phLm5ldCcgaW4gdXJsMToKCQkJbm9tZSA9ICdWaWRvemEnCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDEpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICdzdHJlYW1hbmdvLicgaW4gdXJsMToKCQkJbm9tZSA9ICdTdHJlYW1hbmdvJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwxKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAndmVyeXN0cmVhbS4nIGluIHVybDE6CgkJCW5vbWUgPSAnVmVyeVN0cmVhbScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJaWYgdXJsMiAhPSAnJzoKCQlpKz0xCgkJaWYgJ29sb2FkJyBpbiB1cmwyIG9yICdvcGVubG9hZCcgaW4gdXJsMjoKCQkJbm9tZSA9ICJPcGVuTG9hZCIKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMikKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3ZpZHppJyBpbiB1cmwyOgoJCQlub21lID0gJ1ZpZHppJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwyKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAnZ29vZ2xlJyBpbiB1cmwyIG9yICdjbG91ZC5tYWlsLnJ1JyBpbiB1cmwyIG9yICcubXA0JyBpbiB1cmwyIG9yICcuYXZpJyBpbiB1cmwyOgoJCQlub21lID0gQWRkb25UaXRsZQoJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwyKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAndXB0b3N0cmVhbS5jb20nIGluIHVybDI6CgkJCW5vbWUgPSAnVXBUb1N0cmVhbScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMikKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3JhcGlkdmlkZW8uY29tJyBpbiB1cmwyIG9yICdyYXB0dScgaW4gdXJsMjoKCQkJbm9tZSA9ICdSYXB0dScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMikKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3ZpZG96YS5uZXQnIGluIHVybDI6CgkJCW5vbWUgPSAnVmlkb3phJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwyKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAnc3RyZWFtYW5nby4nIGluIHVybDI6CgkJCW5vbWUgPSAnU3RyZWFtYW5nbycKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMikKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3ZlcnlzdHJlYW0uJyBpbiB1cmwyOgoJCQlub21lID0gJ1ZlcnlTdHJlYW0nCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDIpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJCgl0cnk6CgkJaWYgdXJsMyAhPSAnJzoKCQkJaSs9MQoJCQlpZiAnb2xvYWQnIGluIHVybDMgb3IgJ29wZW5sb2FkJyBpbiB1cmwzOgoJCQkJbm9tZSA9ICJPcGVuTG9hZCIKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDMpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3ZpZHppJyBpbiB1cmwzOgoJCQkJbm9tZSA9ICdWaWR6aScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDMpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ2dvb2dsZScgaW4gdXJsMyBvciAnY2xvdWQubWFpbC5ydScgaW4gdXJsMyBvciAnLm1wNCcgaW4gdXJsMyBvciAnLmF2aScgaW4gdXJsMzoKCQkJCW5vbWUgPSBBZGRvblRpdGxlCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwzKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd1cHRvc3RyZWFtLmNvbScgaW4gdXJsMzoKCQkJCW5vbWUgPSAnVXBUb1N0cmVhbScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDMpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3JhcGlkdmlkZW8uY29tJyBpbiB1cmwzIG9yICdyYXB0dScgaW4gdXJsMzoKCQkJCW5vbWUgPSAnUmFwdHUnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwzKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd2aWRvemEubmV0JyBpbiB1cmwzOgoJCQkJbm9tZSA9ICdWaWRvemEnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwzKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdzdHJlYW1hbmdvLicgaW4gdXJsMzoKCQkJCW5vbWUgPSAnU3RyZWFtYW5nbycKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDMpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3ZlcnlzdHJlYW0uJyBpbiB1cmwzOgoJCQkJbm9tZSA9ICdWZXJ5U3RyZWFtJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMykKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCWV4Y2VwdDoKCQlwYXNzCgl0cnk6CgkJaWYgdXJsNCAhPSAnJzoKCQkJaSs9MQoJCQlpZiAnb2xvYWQnIGluIHVybDQgb3IgJ29wZW5sb2FkJyBpbiB1cmw0OgoJCQkJbm9tZSA9ICJPcGVuTG9hZCIKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDQpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3ZpZHppJyBpbiB1cmw0OgoJCQkJbm9tZSA9ICdWaWR6aScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDQpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ2dvb2dsZScgaW4gdXJsNCBvciAnY2xvdWQubWFpbC5ydScgaW4gdXJsNCBvciAnLm1wNCcgaW4gdXJsNCBvciAnLmF2aScgaW4gdXJsNDoKCQkJCW5vbWUgPSBBZGRvblRpdGxlCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw0KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd1cHRvc3RyZWFtLmNvbScgaW4gdXJsNDoKCQkJCW5vbWUgPSAnVXBUb1N0cmVhbScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDQpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3JhcGlkdmlkZW8uY29tJyBpbiB1cmw0IG9yICdyYXB0dScgaW4gdXJsNDoKCQkJCW5vbWUgPSAnUmFwdHUnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw0KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd2aWRvemEubmV0JyBpbiB1cmw0OgoJCQkJbm9tZSA9ICdWaWRvemEnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw0KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdzdHJlYW1hbmdvLicgaW4gdXJsNDoKCQkJCW5vbWUgPSAnU3RyZWFtYW5nbycKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDQpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3ZlcnlzdHJlYW0uJyBpbiB1cmw0OgoJCQkJbm9tZSA9ICdWZXJ5U3RyZWFtJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsNCkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCWV4Y2VwdDoKCQlwYXNzCgkKCXRyeToKCQlpZiB1cmw1ICE9ICcnOgoJCQlpKz0xCgkJCWlmICdvbG9hZCcgaW4gdXJsNSBvciAnb3BlbmxvYWQnIGluIHVybDU6CgkJCQlub21lID0gIk9wZW5Mb2FkIgoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsNSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndmlkemknIGluIHVybDU6CgkJCQlub21lID0gJ1ZpZHppJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsNSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAnZ29vZ2xlJyBpbiB1cmw1IG9yICdjbG91ZC5tYWlsLnJ1JyBpbiB1cmw1IG9yICcubXA0JyBpbiB1cmw1IG9yICcuYXZpJyBpbiB1cmw1OgoJCQkJbm9tZSA9IEFkZG9uVGl0bGUKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDUpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3VwdG9zdHJlYW0uY29tJyBpbiB1cmw1OgoJCQkJbm9tZSA9ICdVcFRvU3RyZWFtJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsNSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAncmFwaWR2aWRlby5jb20nIGluIHVybDUgb3IgJ3JhcHR1JyBpbiB1cmw1OgoJCQkJbm9tZSA9ICdSYXB0dScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDUpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3ZpZG96YS5uZXQnIGluIHVybDU6CgkJCQlub21lID0gJ1ZpZG96YScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDUpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3N0cmVhbWFuZ28uJyBpbiB1cmw1OgoJCQkJbm9tZSA9ICdTdHJlYW1hbmdvJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsNSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndmVyeXN0cmVhbS4nIGluIHVybDU6CgkJCQlub21lID0gJ1ZlcnlTdHJlYW0nCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw1KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJZXhjZXB0OgoJCXBhc3MKCQoJc3RyZWFtID0gJycKCWxlZ2VuZGEgPSAnJwoJbGVnZW5kYW5vdmEgPSAnJwoJdHJ5OgoJCWxlZ2VuZGFub3ZhID0gYmFzZTY0LmI2NGRlY29kZShyZXN1bHRhZG9bJ0xlZ2VuZGFzJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OgoJCXBhc3MKCQoJaWYgJ2xpdmVpdCcgaW4gbGVnZW5kYW5vdmE6CgkJbGVnZW5kYSA9ICcnCgllbGlmICdodHRwJyBpbiBsZWdlbmRhbm92YToKCQlsZWdlbmRhID0gbGVnZW5kYW5vdmEKCWVsaWYgJ3N1YnMvJyBpbiBsZWdlbmRhbm92YToKCQlsZWdlbmRhID0gX19BUElfXytsZWdlbmRhbm92YQoJZWxzZToKCQlsZWdlbmRhID0gX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrICJsZWdlbmRhcy8iICtsZWdlbmRhbm92YQoJCglleHRfZyA9ICdjb2lzbycKCWxlZ2VuZGFBdXggPSBsZWdlbmRhCglzZXJ2aWRvciA9IDAKCWlmIGxlbih0aXR1bG9zKSA+IDE6CgkJc2Vydmlkb3IgPSB4Ym1jZ3VpLkRpYWxvZygpLnNlbGVjdCgnRXNjb2xoYSBvIHNlcnZpZG9yJywgdGl0dWxvcykKCWVsc2U6CgkJc2Vydmlkb3IgPSAwCgkKCWlmICd2aWR6aScgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJdmlkemkgPSBVUkxSZXNvbHZlck1lZGlhLlZpZHppKHNlcnZpZG9yZXNbc2Vydmlkb3JdKQoJCXN0cmVhbSA9IHZpZHppLmdldE1lZGlhVXJsKCkKCQlsZWdlbmRhID0gdmlkemkuZ2V0U3VidGl0bGUoKQoJZWxpZiAndXB0b3N0cmVhbS5jb20nIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXN0cmVhbSA9IFVSTFJlc29sdmVyTWVkaWEuVXBUb1N0cmVhbShzZXJ2aWRvcmVzW3NlcnZpZG9yXSkuZ2V0TWVkaWFVcmwoKQoJZWxpZiAnc2VydmVyLm1ycGlyYWN5LndpbicgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJc3RyZWFtID0gc2Vydmlkb3Jlc1tzZXJ2aWRvcl0KCWVsaWYgJ29sb2FkJyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQlzdHJlYW0gPSBVUkxSZXNvbHZlck1lZGlhLk9wZW5Mb2FkKHNlcnZpZG9yZXNbc2Vydmlkb3JdKS5nZXRNZWRpYVVybCgpCgkJbGVnZW5kYSA9IFVSTFJlc29sdmVyTWVkaWEuT3BlbkxvYWQoc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pLmdldFN1YnRpdGxlKCkKCQlpZiBub3QgJy52dHQnIGluIGxlZ2VuZGEgb3IgbGVnZW5kYSA9PSAnJzoKCQkJbGVnZW5kYSA9IGxlZ2VuZGFBdXgKCWVsaWYgJ2RyaXZlLmdvb2dsZS5jb20vJyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQlzdHJlYW0sIGV4dF9nID0gVVJMUmVzb2x2ZXJNZWRpYS5Hb29nbGVWaWRlbyhzZXJ2aWRvcmVzW3NlcnZpZG9yXSkuZ2V0TWVkaWFVcmwoKQoJZWxpZiAnY2xvdWQubWFpbC5ydScgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJc3RyZWFtLCBleHRfZyA9IFVSTFJlc29sdmVyTWVkaWEuQ2xvdWRNYWlsUnUoc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pLmdldE1lZGlhVXJsKCkKCWVsaWYgJ3JhcGlkdmlkZW8uY29tJyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXSBvciAncmFwdHUnIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXJhcGlkID0gVVJMUmVzb2x2ZXJNZWRpYS5SYXBpZFZpZGVvKHNlcnZpZG9yZXNbc2Vydmlkb3JdKQoJCXN0cmVhbSA9IHJhcGlkLmdldE1lZGlhVXJsKCkKCQlsZWdlbmRhID0gcmFwaWQuZ2V0TGVnZW5kYSgpCgllbGlmICd2aWRvemEubmV0JyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQl2aWRveiA9IFVSTFJlc29sdmVyTWVkaWEuVmlkb3phKHNlcnZpZG9yZXNbc2Vydmlkb3JdKQoJCXN0cmVhbSA9IHZpZG96LmdldE1lZGlhVXJsKCkKCQlsZWdlbmRhID0gdmlkb3ouZ2V0TGVnZW5kYSgpCgllbGlmICdzdHJlYW1hbmdvLicgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJc3RyZWFtYW4gPSBVUkxSZXNvbHZlck1lZGlhLlN0cmVhbWFuZ28oc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pCgkJc3RyZWFtID0gc3RyZWFtYW4uZ2V0TWVkaWFVcmwoKQoJCWxlZ2VuZGEgPSBzdHJlYW1hbi5nZXRMZWdlbmRhKCkKCWVsaWYgJ3ZlcnlzdHJlYW0uJyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQlzdHJlYW1hbiA9IFVSTFJlc29sdmVyTWVkaWEuVmVyeVN0cmVhbShzZXJ2aWRvcmVzW3NlcnZpZG9yXSkKCQlzdHJlYW0gPSBzdHJlYW1hbi5nZXRNZWRpYVVybCgpCgkJbGVnZW5kYSA9IHN0cmVhbWFuLmdldExlZ2VuZGEoKQoJZWxzZToKCQlzdHJlYW0gPSBzZXJ2aWRvcmVzW3NlcnZpZG9yXQoJcmV0dXJuIHN0cmVhbSwgbGVnZW5kYSwgZXh0X2cKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCQkJCQkJCQkJCQkJQWRkb24gRmlsbWVzIGUgU2VyaWVzCQkJCQkJCQkJICAjCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZGVmIGxpc3RhbWVudXNzZXJpZXMobm9tZV9ub3YsdXJsLGVzdGlsbyx0aXBvLHRpcG9fdXNlcixzZXJ2aWRvcl91c2VyLGljb25pbWFnZSxmYW5hcnQpOgoJY2hlY2tfbG9naW4gPSBsb2dpbjIoKQoJaWYgY2hlY2tfbG9naW4gPT0gVHJ1ZToKCQlkYXRhYmFzZSA9IERhdGFiYXNlLmlzRXhpc3RzKCkKCQltZW51U2VyaWVzKG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdzZXJpZXMucG5nJyksX19TSVRFQWRkb25fXysnSW1hZ2Vucy9zZXJpZXNfZmFuYXJ0LnBuZycpCgllbHNlOgoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0Vycm8gYSBmYXplciBsb2dpbiBuZXN0YSBwYXJ0ZS4gVGVudGUgbm92YW1lbnRlIG1haXMgdGFyZGUuJykKCmRlZiBsaXN0YW1lbnVzZmlsbWVzKG5vbWVfbm92LHVybCxlc3RpbG8sdGlwbyx0aXBvX3VzZXIsc2Vydmlkb3JfdXNlcixpY29uaW1hZ2UsZmFuYXJ0KToKCWNoZWNrX2xvZ2luID0gbG9naW4yKCkKCWlmIGNoZWNrX2xvZ2luID09IFRydWU6CgkJZGF0YWJhc2UgPSBEYXRhYmFzZS5pc0V4aXN0cygpCgkJbWVudUZpbG1lcyhvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZmlsbWVzLnBuZycpLF9fU0lURUFkZG9uX18rJ0ltYWdlbnMvZmlsbWVzX2ZhbmFydC5wbmcnKQoJZWxzZToKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdFcnJvIGEgZmF6ZXIgbG9naW4gbmVzdGEgcGFydGUuIFRlbnRlIG5vdmFtZW50ZSBtYWlzIHRhcmRlLicpCgpkZWYgbGlzdGFtZW51c2FuaW1lcyhub21lX25vdix1cmwsZXN0aWxvLHRpcG8sdGlwb191c2VyLHNlcnZpZG9yX3VzZXIsaWNvbmltYWdlLGZhbmFydCk6CgljaGVja19sb2dpbiA9IGxvZ2luMigpCglpZiBjaGVja19sb2dpbiA9PSBUcnVlOgoJCWRhdGFiYXNlID0gRGF0YWJhc2UuaXNFeGlzdHMoKQoJCW1lbnVBbmltZXMob3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2FuaW1lcy5wbmcnKSxfX1NJVEVBZGRvbl9fKydJbWFnZW5zL3Nlcmllc19mYW5hcnQucG5nJykKCWVsc2U6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnRXJybyBhIGZhemVyIGxvZ2luIG5lc3RhIHBhcnRlLiBUZW50ZSBub3ZhbWVudGUgbWFpcyB0YXJkZS4nKQoKZGVmIG1lbnVGaWxtZXMoaWNvbmltYWdlLGZhbmFydCk6CglhZGREaXIyKCdUb2RvcyBvcyBGaWxtZXMnLCBfX0FQSV9TSVRFX18rJ2ZpbG1lcy5waHA/cXVhbGlkYWRlPScrX19RdWFsaWRhZGVfXywgMTExLCAnZmlsbWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdGaWxtZXMgZW0gRGVzdGFxdWUnLCAgX19BUElfU0lURV9fKydmaWxtZXMucGhwP2FjdGlvbj1kZXN0YXF1ZSZxdWFsaWRhZGU9JytfX1F1YWxpZGFkZV9fLCAxMTEsICdmaWxtZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ0ZpbG1lcyBwb3IgQW5vJywgX19BUElfU0lURV9fKydmaWxtZXMucGhwP2FjdGlvbj1hbm8nLCAxMTksICdsaXN0YWdlbUFub3MnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnYW5vLnBuZycpLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdGaWxtZXMgcG9yIEdlbmVybycsIF9fQVBJX1NJVEVfXysnZmlsbWVzLnBocD9hY3Rpb249Y2F0ZWdvcmlhJywgMTE4LCAnbGlzdGFnZW1HZW5lcm9zJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2dlbmVyby5wbmcnKSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignRmlsbWVzIHBvciBJTURCIFJha2luZycsICBfX0FQSV9TSVRFX18rJ2ZpbG1lcy5waHA/YWN0aW9uPWltZGJSYW5rJnF1YWxpZGFkZT0nK19fUXVhbGlkYWRlX18sIDExMSwgJ2ZpbG1lcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignRmlsbWVzIFBhcmEgQ3JpYW7Dp2FzJywgIF9fQVBJX1NJVEVfXysnZmlsbWVzLnBocD9hY3Rpb249cHQmcXVhbGlkYWRlPScrX19RdWFsaWRhZGVfXywgMTExLCAnZmlsbWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCgkKCXZpc3RhX21lbnUoKQoKZGVmIG1lbnVTZXJpZXMoaWNvbmltYWdlLGZhbmFydCk6CglhZGREaXIyKCdUb2RhcyBhcyBTZXJpZXMnLCBfX0FQSV9TSVRFX18rJ3Nlcmllcy5waHAnLCAxMjMsICdzZXJpZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ1NlcmllcyBlbSBEZXN0YXF1ZScsICBfX0FQSV9TSVRFX18rJ3Nlcmllcy5waHA/YWN0aW9uPWRlc3RhcXVlJywgMTIzLCAnc2VyaWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdTZXJpZXMgcG9yIEFubycsIF9fQVBJX1NJVEVfXysnc2VyaWVzLnBocD9hY3Rpb249YW5vJywgMTE5LCAnbGlzdGFnZW1Bbm9zJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Fuby5wbmcnKSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignU2VyaWVzIHBvciBHZW5lcm8nLCBfX0FQSV9TSVRFX18rJ3Nlcmllcy5waHA/YWN0aW9uPWNhdGVnb3JpYScsIDExOCwgJ2xpc3RhZ2VtR2VuZXJvcycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdnZW5lcm8ucG5nJyksIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCgl2aXN0YV9tZW51KCkKCmRlZiBtZW51QW5pbWVzKGljb25pbWFnZSxmYW5hcnQpOgoJYWRkRGlyMignVG9kb3Mgb3MgQW5pbWVzJywgX19BUElfU0lURV9fKydhbmltZXMucGhwJywgMTIzLCAnYW5pbWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdBbmltZXMgZW0gRGVzdGFxdWUnLCAgX19BUElfU0lURV9fKydhbmltZXMucGhwP2FjdGlvbj1kZXN0YXF1ZScsIDEyMywgJ2FuaW1lcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignQW5pbWVzIHBvciBBbm8nLCBfX0FQSV9TSVRFX18rJ2FuaW1lcy5waHA/YWN0aW9uPWFubycsIDExOSwgJ2xpc3RhZ2VtQW5vcycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdhbm8ucG5nJyksIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ0FuaW1lcyBwb3IgR2VuZXJvJywgX19BUElfU0lURV9fKydhbmltZXMucGhwP2FjdGlvbj1jYXRlZ29yaWEnLCAxMTgsICdsaXN0YWdlbUdlbmVyb3MnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZ2VuZXJvLnBuZycpLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCgoJdmlzdGFfbWVudSgpCgpkZWYgZ2V0TGlzdENhdGVnb3JpYSgpOgoJY2F0ID0gbGVyX2ZpY2hlaXJvKG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ2NhdGVnb3JpYXMubGl2ZWl0JykpLnJlcGxhY2UoJyInLCAiJyIpCglyZXR1cm4gY2F0CgpkZWYgcmVtb3ZlckFjZW50b3ModHh0LCBlbmNvZGluZz0ndXRmLTgnKToKCXJldHVybiBub3JtYWxpemUoJ05GS0QnLCB0eHQuZGVjb2RlKGVuY29kaW5nKSkuZW5jb2RlKCdBU0NJSScsJ2lnbm9yZScpCgpkZWYgZXNjcmV2ZXJfZmljaGVpcm8oZmljaGVpcm8sIGNvbnRldWRvKToKICAgIGYgPSBvcGVuKGZpY2hlaXJvLCBtb2RlPSJ3IikKICAgIGYud3JpdGUoY29udGV1ZG8pCiAgICBmLmNsb3NlKCkKCmRlZiBsZXJfZmljaGVpcm8oZmljaGVpcm8pOgogICAgZiA9IG9wZW4oZmljaGVpcm8sICJyIikKICAgIGNvbnRldWRvID0gIGYucmVhZCgpCiAgICBmLmNsb3NlKCkKICAgIHJldHVybiBjb250ZXVkbwoKZGVmIGdldENhdGVnb3JpYShpZCk6CgljYXQgPSBsZXJfZmljaGVpcm8ob3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnY2F0ZWdvcmlhcy5saXZlaXQnKSkucmVwbGFjZSgnIicsICInIikKCWZvciBjIGluIGFzdC5saXRlcmFsX2V2YWwoY2F0KToKCQlpZiBpbnQoaWQpID09IDA6CgkJCXJldHVybiAnJwoJCWlmIGludChjWydpZF9jYXRlZ29yaWEnXSkgPT0gaW50KGlkKToKCQkJdHJ5OgoJCQkJY2F0ID0gY1snY2F0ZWdvcmlhcyddLmRlY29kZSgndXRmLTgnKQoJCQlleGNlcHQ6CgkJCQljYXQgPSBjWydjYXRlZ29yaWFzJ10uZW5jb2RlKCd1dGYtOCcpCgkJCXJldHVybiBjYXQKCQoJIiIiaWYgaW50KGlkKSA9PSAwOgoJCXJldHVybiAnJwoJCglmb3IgYywgaSBpbiBjYXRzOgoJCWlmIGludChpKSA9PSBpbnQoaWQpOgoJCQlyZXR1cm4gYyIiIgoKCXJldHVybiAnJwoJCmRlZiBnZXRDb29raWUoKToKCXJldHVybiAndXNlcm5hbWU9JytfX0FERE9OX18uZ2V0U2V0dGluZygndG9rZW5NcnBpcmFjeScpCgpkZWYgdmVyaWZpY2FyVmlzdG9Mb2NhbChpZFZpZGVvLCB0ZW1wb3JhZGE9Tm9uZSwgZXBpc29kaW89Tm9uZSk6CglwYXN0YVZpc3RvPW9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ3Zpc3RvcycpCgoJaWYgdGVtcG9yYWRhIGFuZCBlcGlzb2RpbzoKCQlmaWNoZWlyb1Zpc3RvID0gb3MucGF0aC5qb2luKHBhc3RhVmlzdG8sc3RyKGlkVmlkZW8pKydfUycrc3RyKHRlbXBvcmFkYSkrJ3gnK3N0cihlcGlzb2RpbykrJy5saXZlaXQnKQoJZWxzZToKCQlmaWNoZWlyb1Zpc3RvID0gb3MucGF0aC5qb2luKHBhc3RhVmlzdG8sc3RyKGlkVmlkZW8pKycubGl2ZWl0JykKCglpZiBvcy5wYXRoLmV4aXN0cyhmaWNoZWlyb1Zpc3RvKToKCQlyZXR1cm4gVHJ1ZQoJZWxzZToKCQlyZXR1cm4gRmFsc2UKCmRlZiBmaWxtZXModXJsLCBwYWdpbmEpOgoJI2hlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICdCZWFyZXIgJXMnICUgX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuTXJwaXJhY3knKQoJI2lmIHJlc3VsdGFkbyA9PSAnRE5TJzoKCSMJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVGVtIGRlIGFsdGVyYXIgb3MgRE5TIHBhcmEgcG9kZXIgdXN1ZnJ1aXIgZG8gX19BRERPTl9fLicpCgkjCXJldHVybiBGYWxzZQoJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCwgaGVhZGVyPWhlYWRlcnMsIGNvb2tpZT1nZXRDb29raWUoKSkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJdmlzdG9zID0gRGF0YWJhc2Uuc2VsZWN0RmlsbWVzKCkKCW9wY2FvID0gX19BRERPTl9fLmdldFNldHRpbmcoJ21hcmNhclZpc3RvJykKCWZvciBpIGluIHJlc3VsdGFkb1snZGF0YSddOgoJCXNldEZpbG1lKGksIHZpc3Rvcywgb3BjYW8pCgl0cnk6IAoJCWN1cnJlbnQgPSByZXN1bHRhZG9bJ21ldGEnXVsnY3VycmVudCddCglleGNlcHQ6IAoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0FndWFyZGUgcGVsYSBwcsOzeGltYSBhdHVhbGl6YcOnw6NvLiBPdSB0ZW50ZSBtYWlzIHRhcmRlLicpCgkJcmV0dXJuIEZhbHNlCgljdXJyZW50ID0gcmVzdWx0YWRvWydtZXRhJ11bJ2N1cnJlbnQnXQoJdG90YWwgPSByZXN1bHRhZG9bJ21ldGEnXVsndG90YWwnXQoJdHJ5OiBwcm94aW1vID0gcmVzdWx0YWRvWydtZXRhJ11bJ3BhZ2luYWNhbyddWyduZXh0J10KCWV4Y2VwdDogcGFzcyAKCWlmIGludChjdXJyZW50KSA8IGludCh0b3RhbCk6CgkJYWRkRGlyMignUHLDs3hpbWEgcMOhZ2luYSAoJytzdHIoY3VycmVudCkrJy8nK3N0cih0b3RhbCkrJyknLCBwcm94aW1vLCAxMTEsICdmaWxtZXMnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncHJveGltby5wbmcnKSwxKQoJdmlzdGFfZmlsbWVzU2VyaWVzKCkKCQkKZGVmIHNlcmllcyh1cmwpOgoJI2hlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICdCZWFyZXIgJXMnICUgX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuTXJwaXJhY3knKQoJI2lmIHJlc3VsdGFkbyA9PSAnRE5TJzoKCSMJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVGVtIGRlIGFsdGVyYXIgb3MgRE5TIHBhcmEgcG9kZXIgdXN1ZnJ1aXIgZG8gX19BRERPTl9fLicpCgkjCXJldHVybiBGYWxzZQoJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCwgaGVhZGVyPWhlYWRlcnMsIGNvb2tpZT1nZXRDb29raWUoKSkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJaWYgJ3NlcmllJyBpbiB1cmw6CgkJdGlwbyA9ICdzZXJpZScKCWVsaWYgJ2FuaW1lJyBpbiB1cmw6CgkJdGlwbyA9ICdhbmltZScKCQkKCWlmICdzZXJpZScgaW4gdXJsOgoJCXRpcG8gPSAnc2VyaWVzJwoJZWxpZiAnYW5pbWUnIGluIHVybDoKCQl0aXBvID0gJ2FuaW1lcycKCXZpc3RvcyA9IERhdGFiYXNlLnNlbGVjdEZpbG1lcygpCglvcGNhbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCdtYXJjYXJWaXN0bycpCglmb3IgaSBpbiByZXN1bHRhZG9bJ2RhdGEnXToKCQlzZXRTZXJpZXMoaSwgdmlzdG9zLCBvcGNhbywgdGlwbykKCXRyeTogCgkJY3VycmVudCA9IHJlc3VsdGFkb1snbWV0YSddWydjdXJyZW50J10KCWV4Y2VwdDogCgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnQWd1YXJkZSBwZWxhIHByw7N4aW1hIGF0dWFsaXphw6fDo28uIE91IHRlbnRlIG1haXMgdGFyZGUuJykKCQlyZXR1cm4gRmFsc2UKCWN1cnJlbnQgPSByZXN1bHRhZG9bJ21ldGEnXVsnY3VycmVudCddCgl0b3RhbCA9IHJlc3VsdGFkb1snbWV0YSddWyd0b3RhbCddCgl0cnk6IHByb3hpbW8gPSByZXN1bHRhZG9bJ21ldGEnXVsncGFnaW5hY2FvJ11bJ25leHQnXQoJZXhjZXB0OiBwYXNzIAoJaWYgaW50KGN1cnJlbnQpIDwgaW50KHRvdGFsKToKCQlhZGREaXIyKCdQcm94aW1hIHBhZ2luYSAoJytzdHIoY3VycmVudCkrJy8nK3N0cih0b3RhbCkrJyknLCBwcm94aW1vLCAxMjMsICdzZXJpZXMnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncHJveGltby5wbmcnKSkKCXZpc3RhX2ZpbG1lc1NlcmllcygpCgpkZWYgZ2V0U2Vhc29ucyh1cmwpOgoJI2hlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICdCZWFyZXIgJXMnICUgX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuTXJwaXJhY3knKQoJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCwgaGVhZGVyPWhlYWRlcnMsIGNvb2tpZT1nZXRDb29raWUoKSkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKVsnZGF0YSddWzBdCglpZCA9IHVybC5zcGxpdCgnPScpWy0xXQoJaWYgJ3NlcmllJyBpbiB1cmw6CgkJdXJsID0gX19BUElfU0lURV9fKydzZXJpZXMucGhwP2FjdGlvbj10ZW1wb3JhZGEmaWRTZXJpZT0nK2lkKycmbj0lcycKCWVsaWYgJ2FuaW1lJyBpbiB1cmw6CgkJdXJsID0gX19BUElfU0lURV9fKydhbmltZXMucGhwP2FjdGlvbj10ZW1wb3JhZGEmaWRTZXJpZT0nK2lkKycmbj0lcycKCQoJdHJ5OgoJCXJlc3VsdGFkb1sndGVtcG9yYWRhcyddID0gcmVzdWx0YWRvWyd0ZW1wb3JhZGFzJ10ucmVwbGFjZSgnZXNwZWNpYWwnLCAnOTk5JykKCWV4Y2VwdDoKCQlwYXNzCglpZiByZXN1bHRhZG8gPT0gJ0ROUyc6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVGVtIGRlIGFsdGVyYXIgb3MgRE5TIHBhcmEgcG9kZXIgdXN1ZnJ1aXIgZG8gX19BRERPTl9fLicpCgkJcmV0dXJuIEZhbHNlCgkKCWo9MQoJCglpZiByZXN1bHRhZG9bJ3RlbXBvcmFkYXMnXSA9PSAiIjoKCQlyZXR1cm4gRmFsc2UKCWZvciBjLCBpIGluIHNvcnRlZChqc29uLmxvYWRzKHJlc3VsdGFkb1sndGVtcG9yYWRhcyddKS5pdGVyaXRlbXMoKSwga2V5PWxhbWJkYSBpOiBpbnQoaVswXSkpOgoJCWlmIGMgIT0gJzk5OSc6CgkJCWFkZERpcjIoIltCXVRlbXBvcmFkYVsvQl0gIitzdHIoYyksICh1cmwgJSBzdHIoYykpLCAxMTUsICdlcGlzb2Rpb3MnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCd0ZW1wb3JhZGFzJywgJ3RlbXBvcmFkYScrc3RyKGMpKycucG5nJykscG9zdGVyPV9fQVBJX18rcmVzdWx0YWRvWydiYWNrZ3JvdW5kJ10pCgkJZWxzZToKCQkJYWRkRGlyMigiW0JdVGVtcG9yYWRhWy9CXSAiK3N0cihjKSwgKHVybCAlICc5OTknKSwgMTE1LCAnZXBpc29kaW9zJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywndGVtcG9yYWRhcycsICd0ZW1wb3JhZGEnK3N0cihjKSsnLnBuZycpLHBvc3Rlcj1fX0FQSV9fK3Jlc3VsdGFkb1snYmFja2dyb3VuZCddKQoJCgl2aXN0YV90ZW1wb3JhZGFzKCkKCmRlZiBnZXRFcGlzb2Rlcyh1cmwpOgoJI2hlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICdCZWFyZXIgJXMnICUgX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuTXJwaXJhY3knKQoJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCwgaGVhZGVyPWhlYWRlcnMsIGNvb2tpZT1nZXRDb29raWUoKSkKCWlmIHJlc3VsdGFkbyA9PSAnRE5TJzoKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdUZW0gZGUgYWx0ZXJhciBvcyBETlMgcGFyYSBwb2RlciB1c3VmcnVpciBkbyBfX0FERE9OX18uJykKCQlyZXR1cm4gRmFsc2UKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJaWYgJ3NlcmllJyBpbiB1cmw6CgkJdGlwbyA9ICdzZXJpZXMnCgllbGlmICdhbmltZScgaW4gdXJsOgoJCXRpcG8gPSAnYW5pbWVzJwoJZm9yIGkgaW4gcmVzdWx0YWRvWydkYXRhJ106CgkJcHQgPSAnJwoJCWluZm9MYWJlbHMgPSB7J1RpdGxlJzogaVsnbm9tZV9lcGlzb2RpbyddLCAnQ29kZSc6IGlbJ0lNQkQnXSwgJ0VwaXNvZGUnOiBpWydlcGlzb2RpbyddLCAnU2Vhc29uJzogaVsndGVtcG9yYWRhJ10gfQoJCQoJCXRyeToKCQkJbm9tZSA9IGlbJ25vbWVfZXBpc29kaW8nXS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6CgkJCW5vbWUgPSBpWydub21lX2VwaXNvZGlvJ10uZW5jb2RlKCd1dGYtOCcpCgkJYnIgPSAnJwoJCWZpbmFsID0gJycKCQlzZW1MZWdlbmRhID0gJycKCQlpZiBpWydmaW10ZW1wb3JhZGEnXSA9PSAxOgoJCQlmaW5hbCA9ICdbQl1GaW5hbCBkYSBUZW1wb3JhZGEgWy9CXScKCQlpZiBpWydzZW1sZWdlbmRhJ10gPT0gMToKCQkJc2VtTGVnZW5kYSA9ICdbQ09MT1IgcmVkXVtCXVMvIExFR0VOREEgWy9CXVsvQ09MT1JdJwoJCSNpZiAnQnJhc2lsZWlybycgaW4gY2F0ZWdvcmlhOgoJCSMJYnIgPSAnW0JdW0NPTE9SIGdyZWVuXUJbL0NPTE9SXVtDT0xPUiB5ZWxsb3ddUlsvQ09MT1JdOiBbL0JdJwoJCSNpZiAnUG9ydHUnIGluIGNhdGVnb3JpYToKCQkjCXB0ID0gJ1tCXVtDT0xPUiBncmVlbl1QWy9DT0xPUl1bQ09MT1IgcmVkXVRbL0NPTE9SXTogWy9CXScKCQlpZiAnUFQnIGluIGlbJ0lNQkQnXToKCQkJaVsnSU1CRCddID0gcmUuY29tcGlsZSgnKC4rPylQVCcpLmZpbmRhbGwoaVsnSU1CRCddKVswXQoJCQlwdCA9ICdbQl1bQ09MT1IgZ3JlZW5dUFsvQ09MT1JdW0NPTE9SIHJlZF1UWy9DT0xPUl06IFsvQl0nCgkJdmlzdG8gPSBGYWxzZQoJCWNvciA9ICd3aGl0ZScKCQkjaWYgaVsndmlzdG8nXSA9PSAxOgoJCSMJdmlzdG8gPSBUcnVlCQoJCQoJCWltYWdlbSA9ICcnCgkJaWYgaVsnaW1hZ2VtJ10gPT0gMToKCQkJaW1hZ2VtID0gX19BUElfXysnaW1hZ2VzL3Nlcmllcy8nK2lbJ0lNQkQnXSsnLmpwZycKCQllbGlmIGlbJ2ltYWdlbSddID09IDA6CgkJCWltYWdlbSA9IF9fQVBJX18rJ2ltYWdlcy9jYXBhcy8nK2lbJ2ltZGJTZXJpZSddKycuanBnJwoJCQoJCSNpbWFnZW0gPSBpbWFnZW0ucmVwbGFjZSgnUFQnLCcnKQoJCSNpWydiYWNrZ3JvdW5kJ10gPSBpWydiYWNrZ3JvdW5kJ10ucmVwbGFjZSgnUFQnLCcnKQoJCWlbJ2JhY2tncm91bmQnXSA9ICdpbWFnZXMvYmFja2dyb3VuZC8nK2lbJ0lNQkQnXSsnLmpwZycKCQlmYW5hcnR0dCA9IF9fQVBJX18raVsnYmFja2dyb3VuZCddCgkJCgkJbm9tZWVlID0gcHQrYnIrZmluYWwrc2VtTGVnZW5kYSsnW0NPTE9SICcrY29yKyddW0JdRXBpc29kaW8gJytzdHIoaVsnZXBpc29kaW8nXSkrJ1svQl1bL0NPTE9SXSAnK3JlbW92ZXJBY2VudG9zKG5vbWUpCgkJdXJsbm92byA9IF9fQVBJX1NJVEVfXyt0aXBvKycucGhwP2FjdGlvbj1lcGlzb2RpbyZpZFNlcmllPScrc3RyKGlbJ2lkX3NlcmllJ10pKycmaWRFcGlzb2Rpbz0nK3N0cihpWydpZF9lcGlzb2RpbyddKQoJCWFkZFZpZGVvKG5vbWVlZSwgdXJsbm92bywgMTEzLCBpbWFnZW0sIHZpc3RvLCAnZXBpc29kaW8nLCBpWyd0ZW1wb3JhZGEnXSwgaVsnZXBpc29kaW8nXSwgaW5mb0xhYmVscywgZmFuYXJ0dHQpCgkKCXZpc3RhX2VwaXNvZGlvcygpCgpkZWYgZ2V0R2VuZXJvcyh1cmwpOgoJbGlzdGEgPSBnZXRMaXN0Q2F0ZWdvcmlhKCkKCWlmICdmaWxtZXMnIGluIHVybDoKCQl0aXBvID0gMAoJCXF1YWxpZGFkZSA9ICcmcXVhbGlkYWRlPScrX19RdWFsaWRhZGVfXwoJZWxpZiAnc2VyaWVzJyBpbiB1cmw6CgkJdGlwbyA9IDEKCQlxdWFsaWRhZGUgPSAnJwoJZWxpZiAnYW5pbWVzJyBpbiB1cmw6CgkJdGlwbyA9IDIKCQlxdWFsaWRhZGUgPSAnJwoJCglmb3IgYyBpbiBhc3QubGl0ZXJhbF9ldmFsKGxpc3RhKToKCQlpZiBjWydpZF9jYXRlZ29yaWEnXSA9PSAiMCI6CgkJCWNvbnRpbnVlCgkJdHJ5OgoJCQljYXQgPSBjWydjYXRlZ29yaWFzJ10uZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OgoJCQljYXQgPSBjWydjYXRlZ29yaWFzJ10uZW5jb2RlKCd1dGYtOCcpCgkJCgkJdXJsbm92byA9IHVybCsnJmNhdGVnb3JpYT0nK3N0cihjWydpZF9jYXRlZ29yaWEnXSkrcXVhbGlkYWRlOwoJCWFkZERpcjIoY2F0LCB1cmxub3ZvLCAxMjIsICdjYXRlZ29yaWFzJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2dlbmVyby5wbmcnKSkKCQoJdmlzdGFfbWVudSgpCgpkZWYgc2V0RmlsbWUoaSwgdmlzdG9zLCBvcGNhbyk6CgljYXRlZ29yaWEgPSBnZXRDYXRlZ29yaWEoaVsnY2F0ZWdvcmlhMSddKQoJaWYgaW50KGlbJ2NhdGVnb3JpYTInXSkgIT0gMDoKCQljYXRlZ29yaWEgKz0gJywnK2dldENhdGVnb3JpYShpWydjYXRlZ29yaWEyJ10pCglpZiBpbnQoaVsnY2F0ZWdvcmlhMyddKSAhPSAwOgoJCWNhdGVnb3JpYSArPSAnLCcrZ2V0Q2F0ZWdvcmlhKGlbJ2NhdGVnb3JpYTMnXSkKCQoJcHQgPSAnJwoJYnIgPSAnJwoJc2VtTGVnZW5kYSA9ICcnCgl2aXN0byA9IEZhbHNlCgl2aXN0b2EgPSBGYWxzZQoJdmVyaWZpY2FyVmlzdG9Mb2NhbChpWydpZF92aWRlbyddKQoJCgl0cnk6CgkJbm9tZSA9IGlbJ25vbWVfaW5nbGVzJ10uZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6CgkJbm9tZSA9IGlbJ25vbWVfaW5nbGVzJ10uZW5jb2RlKCd1dGYtOCcpCglpZiAnaHR0cCcgbm90IGluIGlbJ2ZvdG8nXToKCQlpWydmb3RvJ10gPSBfX0FQSV9fKydpbWFnZXMvY2FwYXMvJytpWydmb3RvJ10uc3BsaXQoJy8nKVstMV0KCQoJaWYgaVsnbGVnZW5kYSddID09ICJzZW1sZWdlbmRhIjoKCQlzZW1MZWdlbmRhID0gJ1tDT0xPUiByZWRdW0JdUy8gTEVHRU5EQSBbL0JdWy9DT0xPUl0nCglpZiAnQnJhc2lsZWlybycgaW4gY2F0ZWdvcmlhOgoJCWJyID0gJ1tCXVtDT0xPUiBncmVlbl1CWy9DT0xPUl1bQ09MT1IgeWVsbG93XVJbL0NPTE9SXTogWy9CXScKCWlmICdQb3J0dScgaW4gY2F0ZWdvcmlhOgoJCXB0ID0gJ1tCXVtDT0xPUiBncmVlbl1QWy9DT0xPUl1bQ09MT1IgcmVkXVRbL0NPTE9SXTogWy9CXScKCWNvciA9ICJ3aGl0ZSIKCWlmICdQVCcgaW4gaVsnSU1CRCddOgoJCWlbJ0lNQkQnXSA9IHJlLmNvbXBpbGUoJyguKz8pUFQnKS5maW5kYWxsKGlbJ0lNQkQnXSlbMF0KCQlwdCA9ICdbQl1bQ09MT1IgZ3JlZW5dUFsvQ09MT1JdW0NPTE9SIHJlZF1UWy9DT0xPUl06IFsvQl0nCgkKCWltZGJSID0ganNvbi5sb2FkcyhpWydpbWRiUmF0aW5nJ10pCgkKCWluZm9MYWJlbHMgPSB7J1RpdGxlJzogaVsnbm9tZV9pbmdsZXMnXSwgJ1llYXInOiBpWydhbm8nXSwgJ0dlbnJlJzogY2F0ZWdvcmlhLCAnUGxvdCc6aVsnZGVzY3JpY2FvX3ZpZGVvJ10sICdDYXN0JzppWydhdG9yZXMnXS5zcGxpdCgnLCcpLCAnVHJhaWxlcic6IGltZGJSWyd0cmFpbGVyJ10sICdEaXJlY3Rvcic6IGlbJ2RpcmV0b3InXSwgJ1JhdGluZyc6IGltZGJSWydyYW5raW5nJ10sICdJTURCTnVtYmVyJzogaVsnSU1CRCddIH0KCglub21lZWUgPSAnW0NPTE9SICcrY29yKyddJytwdCticitzZW1MZWdlbmRhK3JlbW92ZXJBY2VudG9zKG5vbWUpKycgKCcraVsnYW5vJ10rJylbL0NPTE9SXScKCXVybG5vbyA9IF9fQVBJX1NJVEVfXysnZmlsbWVzLnBocD9hY3Rpb249aWQmaWRGaWxtZT0nK3N0cihpWydpZF92aWRlbyddKQoJZm90b29vID0gaVsnZm90byddCglpWydiYWNrZ3JvdW5kJ10gPSAnaW1hZ2VzL2JhY2tncm91bmQvJytpWydJTUJEJ10rJy5qcGcnCglmYW5hcnR0dCA9IF9fQVBJX18raVsnYmFja2dyb3VuZCddCgkKCWFkZFZpZGVvKG5vbWVlZSwgdXJsbm9vLCAxMTMsIGZvdG9vbyx2aXN0bywgJ3BsYXllcicsIDAsIDAsIGluZm9MYWJlbHMsIGZhbmFydHR0LCB0cmFpbGVyPWltZGJSWyd0cmFpbGVyJ10pCgpkZWYgc2V0U2VyaWVzKGksIHZpc3Rvcywgb3BjYW8sIHRpcG8pOgoJY2F0ZWdvcmlhID0gZ2V0Q2F0ZWdvcmlhKGlbJ2NhdGVnb3JpYTEnXSkKCWlmIGludChpWydjYXRlZ29yaWEyJ10pICE9IDA6CgkJY2F0ZWdvcmlhICs9ICcsJytnZXRDYXRlZ29yaWEoaVsnY2F0ZWdvcmlhMiddKQoJaWYgaW50KGlbJ2NhdGVnb3JpYTMnXSkgIT0gMDoKCQljYXRlZ29yaWEgKz0gJywnK2dldENhdGVnb3JpYShpWydjYXRlZ29yaWEzJ10pCgkKCXB0ID0gJycKCWJyID0gJycKCXNlbUxlZ2VuZGEgPSAnJwoJI2lmIGlbJ2xlZ2VuZGEnXSA9PSAic2VtbGVnZW5kYSI6CgkjCXNlbUxlZ2VuZGEgPSAnW0NPTE9SIHJlZF1bQl1TLyBMRUdFTkRBIFsvQl1bL0NPTE9SXScKCWlmICdCcmFzaWxlaXJvJyBpbiBjYXRlZ29yaWE6CgkJYnIgPSAnW0JdW0NPTE9SIGdyZWVuXUJbL0NPTE9SXVtDT0xPUiB5ZWxsb3ddUlsvQ09MT1JdOiBbL0JdJwoJaWYgJ1BvcnR1JyBpbiBjYXRlZ29yaWE6CgkJcHQgPSAnW0JdW0NPTE9SIGdyZWVuXVBbL0NPTE9SXVtDT0xPUiByZWRdVFsvQ09MT1JdOiBbL0JdJwoJaWYgJ1BUJyBpbiBpWydJTUJEJ106CgkJcHQgPSAnW0JdW0NPTE9SIGdyZWVuXVBbL0NPTE9SXVtDT0xPUiByZWRdVFsvQ09MT1JdOiBbL0JdJwoJdmlzdG8gPSBGYWxzZQoJdmlzdG9hID0gRmFsc2UKCXZlcmlmaWNhclZpc3RvTG9jYWwoaVsnaWRfdmlkZW8nXSkKCXRyeToKCQlub21lID0gaVsnbm9tZV9pbmdsZXMnXS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDoKCQlub21lID0gaVsnbm9tZV9pbmdsZXMnXS5lbmNvZGUoJ3V0Zi04JykKCWlmICdodHRwJyBub3QgaW4gaVsnZm90byddOgoJCWlbJ2ZvdG8nXSA9IF9fQVBJX18rJ2ltYWdlcy9jYXBhcy8nK2lbJ2ZvdG8nXS5zcGxpdCgnLycpWy0xXQoJCSNpWydmb3RvJ10gPSBpWydmb3RvJ10ucmVwbGFjZSgnUFQnLCcnKQoJCglpbWRiUiA9IGpzb24ubG9hZHMoaVsnaW1kYlJhdGluZyddKQoJdXJsbm9vID0gX19BUElfU0lURV9fK3RpcG8rJy5waHA/YWN0aW9uPWlkJmlkU2VyaWU9JytzdHIoaVsnaWRfdmlkZW8nXSkKCWluZm9MYWJlbHMgPSB7J1RpdGxlJzogaVsnbm9tZV9pbmdsZXMnXSwgJ1llYXInOiBpWydhbm8nXSwgJ0dlbnJlJzogY2F0ZWdvcmlhLCAnUGxvdCc6IGlbJ2Rlc2NyaWNhb192aWRlbyddLCAnQ2FzdCc6aVsnYXRvcmVzJ10uc3BsaXQoJywnKSwgJ1RyYWlsZXInOiBpbWRiUlsndHJhaWxlciddLCAnRGlyZWN0b3InOiBpWydkaXJldG9yJ10sICdSYXRpbmcnOiBpbWRiUlsncmFua2luZyddLCAnQ29kZSc6IGlbJ0lNQkQnXSB9CgkKCW5vbWVlZSA9IHB0K2JyK3NlbUxlZ2VuZGErcmVtb3ZlckFjZW50b3Mobm9tZSkrJyAoJytpWydhbm8nXSsnKScKCWZvdG9vbyA9IGlbJ2ZvdG8nXQoJI2lbJ2JhY2tncm91bmQnXSA9IGlbJ2JhY2tncm91bmQnXS5yZXBsYWNlKCdQVCcsJycpCglpWydiYWNrZ3JvdW5kJ10gPSAnaW1hZ2VzL2JhY2tncm91bmQvJytpWydJTUJEJ10rJy5qcGcnCglmYW5hcnR0dCA9IF9fQVBJX18raVsnYmFja2dyb3VuZCddCglhZGREaXIyKG5vbWVlZSwgdXJsbm9vLCAxMTQsICd0ZW1wb3JhZGFzJywgZm90b29vLCB0aXBvPSdzZXJpZScsIGluZm9MYWJlbHM9aW5mb0xhYmVscyxwb3N0ZXI9ZmFuYXJ0dHQsdmlzdG89dmlzdG8pCgpkZWYgY2F0ZWdvcmlhcyh1cmwpOgoJI2hlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICdCZWFyZXIgJXMnICUgX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuTXJwaXJhY3knKQoJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCwgaGVhZGVyPWhlYWRlcnMsIGNvb2tpZT1nZXRDb29raWUoKSkKCSNpZiByZXN1bHRhZG8gPT0gJ0ROUyc6CgkjCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1RlbSBkZSBhbHRlcmFyIG9zIEROUyBwYXJhIHBvZGVyIHVzdWZydWlyIGRvIF9fQURET05fXy4nKQoJIwlyZXR1cm4gRmFsc2UKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJdmlzdG9zID0gRGF0YWJhc2Uuc2VsZWN0RmlsbWVzKCkKCW9wY2FvID0gX19BRERPTl9fLmdldFNldHRpbmcoJ21hcmNhclZpc3RvJykKCWlmICdzZXJpZScgaW4gdXJsOgoJCXRpcG8gPSAnc2VyaWVzJwoJZWxpZiAnYW5pbWUnIGluIHVybDoKCQl0aXBvID0gJ2FuaW1lcycKCWZvciBpIGluIHJlc3VsdGFkb1siZGF0YSJdOgoJCWlmICdmaWxtZScgaW4gdXJsOgoJCQlzZXRGaWxtZShpLCB2aXN0b3MsIG9wY2FvKQoJCWVsaWYgJ3NlcmllJyBpbiB1cmwgb3IgJ2FuaW1lJyBpbiB1cmw6CgkJCXNldFNlcmllcyhpLCB2aXN0b3MsIG9wY2FvLCB0aXBvKQoJY3VycmVudCA9IHJlc3VsdGFkb1snbWV0YSddWydjdXJyZW50J10KCXRvdGFsID0gcmVzdWx0YWRvWydtZXRhJ11bJ3RvdGFsJ10KCXRyeTogcHJveGltbyA9IHJlc3VsdGFkb1snbWV0YSddWydwYWdpbmFjYW8nXVsnbmV4dCddCglleGNlcHQ6IHBhc3MgCglpZiBpbnQoY3VycmVudCkgPCBpbnQodG90YWwpOgoJCWFkZERpcjIoJ1Byw7N4aW1hIHDDoWdpbmEgKCcrc3RyKGN1cnJlbnQpKycvJytzdHIodG90YWwpKycpJywgcHJveGltbywgMTIxLCAnYW5vcycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdwcm94aW1vLnBuZycpLDEpCgkKCXZpc3RhX2ZpbG1lc1NlcmllcygpCgpkZWYgZ2V0WWVhcnModXJsKToKCWFub3MgPSBbCgkJCScyMDE5JywKCQkJJzIwMTgnLAoJCQknMjAxNycsCgkJCScyMDE2JywKCQkJJzIwMTUnLAoJCQknMjAxNCcsCgkJCScyMDEzJywKCQkJJzIwMTInLAoJCQknMjAxMScsCgkJCScyMDEwJywKCQkJJzIwMDknLAoJCQknMjAwOCcsCgkJCScyMDA3JywKCQkJJzIwMDYnLAoJCQknMjAwMC0yMDA1JywKCQkJJzE5OTAtMTk5OScsCgkJCScxOTgwLTE5ODknLAoJCQknMTk3MC0xOTc5JywKCQkJJzE5NjAtMTk2OScsCgkJCScxOTUwLTE5NTknLAoJCQknMTkwMC0xOTQ5JwoJCV0KCWlmICdmaWxtZXMnIGluIHVybDoKCQl0aXBvID0gMAoJCXF1YWxpZGFkZSA9ICcmcXVhbGlkYWRlPScrX19RdWFsaWRhZGVfXwoJZWxpZiAnc2VyaWVzJyBpbiB1cmw6CgkJdGlwbyA9IDEKCQlxdWFsaWRhZGUgPSAnJwoJZWxpZiAnYW5pbWVzJyBpbiB1cmw6CgkJdGlwbyA9IDIKCQlxdWFsaWRhZGUgPSAnJwoJZm9yIGkgaW4gYW5vczoKCQl1cmxub3ZvID0gdXJsKycmYW5vPScraStxdWFsaWRhZGU7CgkJYWRkRGlyMihpLCB1cmxub3ZvLCAxMjEsICdhbm9zJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Fuby5wbmcnKSkKCQkKCXZpc3RhX21lbnUoKQoKZGVmIGFub3ModXJsKToKCSNoZWFkZXJzWydBdXRob3JpemF0aW9uJ10gPSAnQmVhcmVyICVzJyAlIF9fQURET05fXy5nZXRTZXR0aW5nKCd0b2tlbk1ycGlyYWN5JykKCXJlc3VsdGFkbyA9IGFicmlyX3VybCh1cmwsIGhlYWRlcj1oZWFkZXJzLCBjb29raWU9Z2V0Q29va2llKCkpCglpZiByZXN1bHRhZG8gPT0gJ0ROUyc6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVGVtIGRlIGFsdGVyYXIgb3MgRE5TIHBhcmEgcG9kZXIgdXN1ZnJ1aXIgZG8gX19BRERPTl9fLicpCgkJcmV0dXJuIEZhbHNlCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCXZpc3RvcyA9IERhdGFiYXNlLnNlbGVjdEZpbG1lcygpCglvcGNhbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCdtYXJjYXJWaXN0bycpCglpZiAnc2VyaWUnIGluIHVybDoKCQl0aXBvID0gJ3NlcmllcycKCWVsaWYgJ2FuaW1lJyBpbiB1cmw6CgkJdGlwbyA9ICdhbmltZXMnCglmb3IgaSBpbiByZXN1bHRhZG9bImRhdGEiXToKCQlpZiAnZmlsbWUnIGluIHVybDoKCQkJc2V0RmlsbWUoaSwgdmlzdG9zLCBvcGNhbykKCQllbGlmICdzZXJpZScgaW4gdXJsIG9yICdhbmltZScgaW4gdXJsOgoJCQlzZXRTZXJpZXMoaSwgdmlzdG9zLCBvcGNhbywgdGlwbykKCQoJdHJ5OiAKCQljdXJyZW50ID0gcmVzdWx0YWRvWydtZXRhJ11bJ2N1cnJlbnQnXQoJZXhjZXB0OiAKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdBZ3VhcmRlIHBlbGEgcHLDs3hpbWEgYXR1YWxpemHDp8Ojby4gT3UgdGVudGUgbWFpcyB0YXJkZS4nKQoJCXJldHVybiBGYWxzZQoJY3VycmVudCA9IHJlc3VsdGFkb1snbWV0YSddWydjdXJyZW50J10KCXRvdGFsID0gcmVzdWx0YWRvWydtZXRhJ11bJ3RvdGFsJ10KCXRyeTogcHJveGltbyA9IHJlc3VsdGFkb1snbWV0YSddWydwYWdpbmFjYW8nXVsnbmV4dCddCglleGNlcHQ6IHBhc3MgCglpZiBpbnQoY3VycmVudCkgPCBpbnQodG90YWwpOgoJCWFkZERpcjIoJ1Byw7N4aW1hIHDDoWdpbmEgKCcrc3RyKGN1cnJlbnQpKycvJytzdHIodG90YWwpKycpJywgcHJveGltbywgMTIxLCAnYW5vcycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdwcm94aW1vLnBuZycpLDEpCgkKCXZpc3RhX2ZpbG1lc1NlcmllcygpCgpkZWYgZ2V0RXZlbnRvcygpOgoJI2hlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICdCZWFyZXIgJXMnICUgX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuTXJwaXJhY3knKQoJcmVzdWx0YWRvID0gYWJyaXJfdXJsKF9fQVBJX1NJVEVfXysnZXZlbnRvcycsIGhlYWRlcj1oZWFkZXJzLCBjb29raWU9Z2V0Q29va2llKCkpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCXRyeToKCQlpZiByZXN1bHRhZG9bJ2NvZGlnbyddID09IDIwNDoKCQkJcmV0dXJuIEZhbHNlCglleGNlcHQ6CgkJcGFzcwoJcmV0dXJuIHJlc3VsdGFkb1snZGF0YSddWydub21lJ10KCQkKCQkKZGVmIHBsYXllcihuYW1lLHVybCxpY29uaW1hZ2UsdGVtcG9yYWRhLGVwaXNvZGlvLHNlcmllTm9tZSk6CgkjaGVhZGVyc1snQXV0aG9yaXphdGlvbiddID0gJ0JlYXJlciAlcycgJSBfX0FERE9OX18uZ2V0U2V0dGluZygndG9rZW5NcnBpcmFjeScpCglyZXN1bHRhZG8gPSBhYnJpcl91cmwodXJsLCBoZWFkZXI9aGVhZGVycywgY29va2llPWdldENvb2tpZSgpKQoJaWYgcmVzdWx0YWRvID09ICdETlMnOgoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1RlbSBkZSBhbHRlcmFyIG9zIEROUyBwYXJhIHBvZGVyIHVzdWZydWlyIGRvIF9fQURET05fXy4nKQoJCXJldHVybiBGYWxzZQoJCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbylbMF0KCSNyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCWluZm9sYWJlbHMgPSBkaWN0KCkKCWNvaXNvID0gJycKCXBhc3RhRGF0YSA9ICcnCgl0aXBvID0gJycKCWlkVmlkZW8gPSAnJwoJaWYgJ2ZpbG1lJyBpbiB1cmw6CgkJdGlwbyA9ICdmaWxtZScKCQlpbmZvbGFiZWxzWydDb2RlJ10gPSByZXN1bHRhZG9bJ0lNQkQnXQoJCWluZm9sYWJlbHNbJ1llYXInXSA9IHJlc3VsdGFkb1snYW5vJ10KCQlpZFZpZGVvID0gcmVzdWx0YWRvWydpZF92aWRlbyddCgkJbm9tZSA9IHJlc3VsdGFkb1snbm9tZV9pbmdsZXMnXQoJCXRlbXBvcmFkYSA9IDAKCQllcGlzb2RpbyA9IDAKCQljb2lzbyA9ICdmaWxtZScKCWVsc2U6CgkJaWYgJ3NlcmllJyBpbiB1cmw6CgkJCXRpcG8gPSAnc2VyaWUnCgkJZWxzZToKCQkJdGlwbyA9ICdhbmltZScKCQlpZFZpZGVvID0gcmVzdWx0YWRvWydpZF9zZXJpZSddCgkJbm9tZSA9IHJlc3VsdGFkb1snbm9tZV9lcGlzb2RpbyddCgkJdGVtcG9yYWRhID0gcmVzdWx0YWRvWyd0ZW1wb3JhZGEnXQoJCWVwaXNvZGlvID0gcmVzdWx0YWRvWydlcGlzb2RpbyddCgkJY29pc28gPSAnb3V0cm8nCgoJbWVuc2FnZW1wcm9ncmVzc28gPSB4Ym1jZ3VpLkRpYWxvZ1Byb2dyZXNzKCkKCW1lbnNhZ2VtcHJvZ3Jlc3NvLmNyZWF0ZShBZGRvblRpdGxlLCB1J0FicmlyIGVtaXNzw6NvJywnUG9yIGZhdm9yIGFndWFyZGUuLi4nKQoJbWVuc2FnZW1wcm9ncmVzc28udXBkYXRlKDI1LCAiIiwgdSdPYnRlciB2aWRlbyBlIGxlZ2VuZGEnLCAiIikKCglzdHJlYW0sIGxlZ2VuZGEsIGV4dF9nID0gZ2V0U3RyZWFtTGVnZW5kYShpZFZpZGVvLCB0aXBvLCBjb2lzbz1jb2lzbykKCWlmIHN0cmVhbSA9PSBGYWxzZSBhbmQgbGVnZW5kYSA9PSAyMDQ6CgkJbWVuc2FnZW1wcm9ncmVzc28uY2xvc2UoKQoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1RlbSBkZSBlc3BlcmFyIDggaG9yYXMgYXTDqSBjb25zZWd1aXIgdmlzdWFsaXphciBhbGd1bSB2aWRlby4nKQoJCXJldHVybiBGYWxzZQoJCgltZW5zYWdlbXByb2dyZXNzby51cGRhdGUoNTAsICIiLCB1J1ByZXBhcmEtdGUsIHZhaSBjb21lw6dhciEnLCAiIikKCXBsYXlsaXN0ID0geGJtYy5QbGF5TGlzdCgxKQoJcGxheWxpc3QuY2xlYXIoKQoJbGlzdGl0ZW0gPSB4Ym1jZ3VpLkxpc3RJdGVtKG5hbWUsIGljb25JbWFnZT0iRGVmYXVsdFZpZGVvLnBuZyIsIHRodW1ibmFpbEltYWdlPWljb25pbWFnZSkKCglsaXN0aXRlbS5zZXRJbmZvKHR5cGU9IlZpZGVvIiwgaW5mb0xhYmVscz1pbmZvbGFiZWxzKQoJbGlzdGl0ZW0uc2V0UHJvcGVydHkoJ21pbWV0eXBlJywgJ3ZpZGVvL3gtbXN2aWRlbycpCglsaXN0aXRlbS5zZXRQcm9wZXJ0eSgnSXNQbGF5YWJsZScsICd0cnVlJykKCQoJbGlzdGl0ZW0uc2V0UGF0aChwYXRoPXN0cmVhbSkKCXBsYXlsaXN0LmFkZChzdHJlYW0sIGxpc3RpdGVtKQoJeGJtY3BsdWdpbi5zZXRSZXNvbHZlZFVybChpbnQoc3lzLmFyZ3ZbMV0pLCBUcnVlLCBsaXN0aXRlbSkKCW1lbnNhZ2VtcHJvZ3Jlc3NvLnVwZGF0ZSg3NSwgIiIsIHUnQm9hIFNlc3PDo28hISEnLCAiIikKCglpZiBzdHJlYW0gPT0gRmFsc2U6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnTyBzZXJ2aWRvciBlc2NvbGhpZG8gbsOjbyBkaXNwb27DrXZlbCwgZXNjb2xoYSBvdXRybyBvdSB0ZW50ZSBub3ZhbWVudGUgbWFpcyB0YXJkZS4nKQoJZWxzZToKCQkjX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnU3RyZWFtOiAnK3N0cmVhbSkKCQlwbGF5ZXJfbXIgPSBQbGF5ZXIuUGxheWVyKHVybD11cmwsIGlkRmlsbWU9aWRWaWRlbywgcGFzdGFEYXRhPV9fUEFTVEFfREFET1NfXywgdGVtcG9yYWRhPXRlbXBvcmFkYSwgZXBpc29kaW89ZXBpc29kaW8sIG5vbWU9bmFtZSwgbG9nbz1vcy5wYXRoLmpvaW4oX19BRERPTl9GT0xERVJfXywnaWNvbi5wbmcnKSkKCQkKCQltZW5zYWdlbXByb2dyZXNzby5jbG9zZSgpCgkJcGxheWVyX21yLnBsYXkocGxheWxpc3QpCgkJcGxheWVyX21yLnNldFN1YnRpdGxlcyhsZWdlbmRhKQoKCQl3aGlsZSBwbGF5ZXJfbXIucGxheWluZzoKCQkJeGJtYy5zbGVlcCg1MDAwKQoJCQkjcGxheWVyX21yLnRyYWNrZXJUZW1wbygpCgpkZWYgbWFyY2FyVmlzdG8odXJsKToKCXJlc3VsdGFkbyA9IGFicmlyX3VybCh1cmwsIGhlYWRlcj1oZWFkZXJzLCBjb29raWU9Z2V0Q29va2llKCkpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbylbMF0KCWxpbmtzID0gdXJsLnNwbGl0KCcvJykKCW9wY2FvID0gX19BRERPTl9fLmdldFNldHRpbmcoJ21hcmNhclZpc3RvJykKCWlmICdmaWxtZScgaW4gdXJsOgoJCWlkX3ZpZGVvID0gcmVzdWx0YWRvWydpZF92aWRlbyddCgkJaW1kYiA9IHJlc3VsdGFkb1snSU1CRCddCgkJcG9zdCA9IHsnaWRfZmlsbWUnOiBpZF92aWRlb30KCQl0aXBvID0gMAoJZWxpZiAnc2VyaWUnIGluIHVybDoKCQlpbWRiICA9IHJlc3VsdGFkb1snZm90b1NlcmllJ10uc3BsaXQoJy8nKVstMV0uc3BsaXQoJy4nKVswXQoJCWlkX3ZpZGVvID0gcmVzdWx0YWRvWydpZF9zZXJpZSddCgkJdGVtcG9yYWRhID0gcmVzdWx0YWRvWyd0ZW1wb3JhZGEnXQoJCWVwaXNvZGlvID0gcmVzdWx0YWRvWydlcGlzb2RpbyddCgkJcG9zdCA9IHsnaWRfc2VyaWUnOiBpZF92aWRlbywgJ3RlbXBvcmFkYSc6IHRlbXBvcmFkYSwgJ2VwaXNvZGlvJzplcGlzb2Rpb30KCQl0aXBvID0gMQoJZWxpZiAnYW5pbWUnIGluIHVybDoKCQlpbWRiICA9IHJlc3VsdGFkb1snZm90b1NlcmllJ10uc3BsaXQoJy8nKVstMV0uc3BsaXQoJy4nKVswXQoJCWlkX3ZpZGVvID0gcmVzdWx0YWRvWydpZF9zZXJpZSddCgkJdGVtcG9yYWRhID0gcmVzdWx0YWRvWyd0ZW1wb3JhZGEnXQoJCWVwaXNvZGlvID0gcmVzdWx0YWRvWydlcGlzb2RpbyddCgkJcG9zdCA9IHsnaWRfYW5pbWUnOiBpZF92aWRlbywgJ3RlbXBvcmFkYSc6IHRlbXBvcmFkYSwgJ2VwaXNvZGlvJzplcGlzb2Rpb30KCQl0aXBvID0gMgoJcGFzdGFWaXN0bz1vcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCd2aXN0b3MnKQoJdHJ5OgoJCW9zLm1ha2VkaXJzKHBhc3RhVmlzdG8pCglleGNlcHQ6CgkJcGFzcwoJaWYgdGlwbyA9PSAxIG9yIHRpcG8gPT0gMjoKCQlmaWNoZWlybyA9IG9zLnBhdGguam9pbihwYXN0YVZpc3RvLCBzdHIoaWRfdmlkZW8pKydfUycrc3RyKHRlbXBvcmFkYSkrJ3gnK3N0cihlcGlzb2RpbykrJy5saXZlaXQnKQoJZWxpZiB0aXBvID09IDA6CgkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4ocGFzdGFWaXN0bywgc3RyKGlkX3ZpZGVvKSsnLmxpdmVpdCcpCglpZiBub3Qgb3MucGF0aC5leGlzdHMoZmljaGVpcm8pOgoJCWYgPSBvcGVuKGZpY2hlaXJvLCAndycpCgkJZi53cml0ZSgnJykKCQlmLmNsb3NlKCkKCWVzY3JldmVyX2ZpY2hlaXJvKG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ3Zpc3Rvc19maWxtZXMubGl2ZWl0JyksIHZpc3Rvc19maWxtZXMpCgl4Ym1jLmV4ZWN1dGVidWlsdGluKCJYQk1DLk5vdGlmaWNhdGlvbigiK0FkZG9uVGl0bGUrIiwiKyJNYXJjYWRvIGNvbW8gdmlzdG8iKyIsIisiNjAwMSIrIiwiKyBvcy5wYXRoLmpvaW4oY29udHJvbG8uYWRkb25Gb2xkZXIsJ2ljb24ucG5nJykrIikiKQoJeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlJlZnJlc2giKQoKZGVmIG1hcmNhck5hb1Zpc3RvKHVybCk6CglyZXN1bHRhZG8gPSBhYnJpcl91cmwodXJsLCBoZWFkZXI9aGVhZGVycywgY29va2llPWdldENvb2tpZSgpKQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pWzBdCglsaW5rcyA9IHVybC5zcGxpdCgnLycpCglvcGNhbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCdtYXJjYXJWaXN0bycpCglpZiAnZmlsbWUnIGluIHVybDoKCQlpZF92aWRlbyA9IHJlc3VsdGFkb1snaWRfdmlkZW8nXQoJCWltZGIgPSByZXN1bHRhZG9bJ0lNQkQnXQoJCXBvc3QgPSB7J2lkX2ZpbG1lJzogaWRfdmlkZW99CgkJdGlwbyA9IDAKCWVsaWYgJ3NlcmllJyBpbiB1cmw6CgkJaW1kYiAgPSByZXN1bHRhZG9bJ2ZvdG9TZXJpZSddLnNwbGl0KCcvJylbLTFdLnNwbGl0KCcuJylbMF0KCQlpZF92aWRlbyA9IHJlc3VsdGFkb1snaWRfc2VyaWUnXQoJCXRlbXBvcmFkYSA9IHJlc3VsdGFkb1sndGVtcG9yYWRhJ10KCQllcGlzb2RpbyA9IHJlc3VsdGFkb1snZXBpc29kaW8nXQoJCXBvc3QgPSB7J2lkX3NlcmllJzogaWRfdmlkZW8sICd0ZW1wb3JhZGEnOiB0ZW1wb3JhZGEsICdlcGlzb2Rpbyc6ZXBpc29kaW99CgkJdGlwbyA9IDEKCWVsaWYgJ2FuaW1lJyBpbiB1cmw6CgkJaW1kYiAgPSByZXN1bHRhZG9bJ2ZvdG9TZXJpZSddLnNwbGl0KCcvJylbLTFdLnNwbGl0KCcuJylbMF0KCQlpZF92aWRlbyA9IHJlc3VsdGFkb1snaWRfc2VyaWUnXQoJCXRlbXBvcmFkYSA9IHJlc3VsdGFkb1sndGVtcG9yYWRhJ10KCQllcGlzb2RpbyA9IHJlc3VsdGFkb1snZXBpc29kaW8nXQoJCXBvc3QgPSB7J2lkX2FuaW1lJzogaWRfdmlkZW8sICd0ZW1wb3JhZGEnOiB0ZW1wb3JhZGEsICdlcGlzb2Rpbyc6ZXBpc29kaW99CgkJdGlwbyA9IDIKCQoJcGFzdGFWaXN0bz1vcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCd2aXN0b3MnKQoJdHJ5OgoJCW9zLm1ha2VkaXJzKHBhc3RhVmlzdG8pCglleGNlcHQ6CgkJcGFzcwoKCWlmIHRpcG8gPT0gMSBvciB0aXBvID09IDI6CgkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4ocGFzdGFWaXN0bywgc3RyKGlkX3ZpZGVvKSsnX1MnK3N0cih0ZW1wb3JhZGEpKyd4JytzdHIoZXBpc29kaW8pKycubXJwaXJhY3knKQoJZWxpZiB0aXBvID09IDA6CgkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4ocGFzdGFWaXN0bywgc3RyKGlkX3ZpZGVvKSsnLm1ycGlyYWN5JykKCglpZiBvcy5wYXRoLmV4aXN0cyhmaWNoZWlybyk6CgkJb3MucmVtb3ZlKGZpY2hlaXJvKQoJZXNjcmV2ZXJfZmljaGVpcm8ob3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywndmlzdG9zX2ZpbG1lcy5saXZlaXQnKSwgdmlzdG9zKQoJeGJtYy5leGVjdXRlYnVpbHRpbigiWEJNQy5Ob3RpZmljYXRpb24oIitBZGRvblRpdGxlKyIsIisiTWFyY2FkbyBjb21vIHZpc3RvIisiLCIrIjYwMDEiKyIsIisgb3MucGF0aC5qb2luKGNvbnRyb2xvLmFkZG9uRm9sZGVyLCdpY29uLnBuZycpKyIpIikKCXhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5SZWZyZXNoIikKCmRlZiBnZXRTdHJlYW1MZWdlbmRhKGlkLCB0aXBvLCBjb2lzbz1Ob25lKToKCWlmIHRpcG8gPT0gJ2ZpbG1lJzoKCQl1cmwgPSBfX0FQSV9TSVRFX18rdGlwbysncy5waHA/YWN0aW9uPWxpbmtzJmlkRmlsbWU9JytpZAoJaWYgdGlwbyA9PSAnc2VyaWUnOgoJCXVybCA9IF9fQVBJX1NJVEVfXyt0aXBvKydzLnBocD9hY3Rpb249bGlua3MmaWRFcGlzb2Rpbz0nK2lkCglpZiB0aXBvID09ICdhbmltZSc6CgkJdXJsID0gX19BUElfU0lURV9fK3RpcG8rJ3MucGhwP2FjdGlvbj1saW5rcyZpZEVwaXNvZGlvPScraWQKCglyZXN1bHRhZG8gPSBhYnJpcl91cmwodXJsLCBoZWFkZXI9aGVhZGVycywgY29va2llPWdldENvb2tpZSgpKQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pCgl0cnk6CgkJaWYgcmVzdWx0YWRvWydjb2RpZ28nXSA9PSAyMDQ6CgkJCXJldHVybiBGYWxzZSwgMjA0LCAyMDQKCWV4Y2VwdDogCgkJcmVzdWx0YWRvID0gcmVzdWx0YWRvWzBdCgkKCWkgPSAwCglzZXJ2aWRvcmVzID0gW10KCXRpdHVsb3MgPSBbXQoJbm9tZSA9ICcnCgkKCWlmIHJlc3VsdGFkb1snVVJMJ10gIT0gJyc6CgkJaSs9MQoJCWlmICdvcGVubG9hZCcgaW4gcmVzdWx0YWRvWydVUkwnXToKCQkJbm9tZSA9ICJPcGVuTG9hZCIKCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwnXSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3ZpZHppJyBpbiByZXN1bHRhZG9bJ1VSTCddOgoJCQlub21lID0gJ1ZpZHppJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTCddKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAnZ29vZ2xlJyBpbiByZXN1bHRhZG9bJ1VSTCddIG9yICdjbG91ZC5tYWlsLnJ1JyBpbiByZXN1bHRhZG9bJ1VSTCddOgoJCQlub21lID0gQWRkb25UaXRsZQoJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTCddKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAndXB0b3N0cmVhbS5jb20nIGluIHJlc3VsdGFkb1snVVJMJ106CgkJCW5vbWUgPSAnVXBUb1N0cmVhbScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwnXSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3JhcGlkdmlkZW8uY29tJyBpbiByZXN1bHRhZG9bJ1VSTCddIG9yICdyYXB0dScgaW4gcmVzdWx0YWRvWydVUkwnXToKCQkJbm9tZSA9ICdSYXB0dScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwnXSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3ZpZG96YS5uZXQnIGluIHJlc3VsdGFkb1snVVJMJ106CgkJCW5vbWUgPSAnVmlkb3phJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTCddKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAnc3RyZWFtYW5nby4nIGluIHJlc3VsdGFkb1snVVJMJ106CgkJCW5vbWUgPSAnU3RyZWFtYW5nbycKCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwnXSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJaWYgcmVzdWx0YWRvWydVUkwyJ10gIT0gJyc6CgkJaSs9MQoJCWlmICdvcGVubG9hZCcgaW4gcmVzdWx0YWRvWydVUkwyJ106CgkJCW5vbWUgPSAiT3BlbkxvYWQiCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMMiddKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAndmlkemknIGluIHJlc3VsdGFkb1snVVJMMiddOgoJCQlub21lID0gJ1ZpZHppJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDInXSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ2dvb2dsZScgaW4gcmVzdWx0YWRvWydVUkwyJ10gb3IgJ2Nsb3VkLm1haWwucnUnIGluIHJlc3VsdGFkb1snVVJMMiddOgoJCQlub21lID0gQWRkb25UaXRsZQoJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDInXSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3VwdG9zdHJlYW0uY29tJyBpbiByZXN1bHRhZG9bJ1VSTDInXToKCQkJbm9tZSA9ICdVcFRvU3RyZWFtJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDInXSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3JhcGlkdmlkZW8uY29tJyBpbiByZXN1bHRhZG9bJ1VSTDInXSBvciAncmFwdHUnIGluIHJlc3VsdGFkb1snVVJMMiddOgoJCQlub21lID0gJ1JhcHR1JwoJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDInXSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3ZpZG96YS5uZXQnIGluIHJlc3VsdGFkb1snVVJMMiddOgoJCQlub21lID0gJ1ZpZG96YScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwyJ10pCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICdzdHJlYW1hbmdvLicgaW4gcmVzdWx0YWRvWydVUkwyJ106CgkJCW5vbWUgPSAnU3RyZWFtYW5nbycKCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwyJ10pCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCXRyeToKCQlpZiByZXN1bHRhZG9bJ1VSTDMnXSAhPSAnJzoKCQkJaSs9MQoJCQlpZiAnb3BlbmxvYWQnIGluIHJlc3VsdGFkb1snVVJMMyddOgoJCQkJbm9tZSA9ICJPcGVuTG9hZCIKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMMyddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd2aWR6aScgaW4gcmVzdWx0YWRvWydVUkwzJ106CgkJCQlub21lID0gJ1ZpZHppJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwzJ10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ2dvb2dsZScgaW4gcmVzdWx0YWRvWydVUkwzJ10gb3IgJ2Nsb3VkLm1haWwucnUnIGluIHJlc3VsdGFkb1snVVJMMyddOgoJCQkJbm9tZSA9IEFkZG9uVGl0bGUKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMMyddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd1cHRvc3RyZWFtLmNvbScgaW4gcmVzdWx0YWRvWydVUkwzJ106CgkJCQlub21lID0gJ1VwVG9TdHJlYW0nCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDMnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAncmFwaWR2aWRlby5jb20nIGluIHJlc3VsdGFkb1snVVJMMyddIG9yICdyYXB0dScgaW4gcmVzdWx0YWRvWydVUkwzJ106CgkJCQlub21lID0gJ1JhcHR1JwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwzJ10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3ZpZG96YS5uZXQnIGluIHJlc3VsdGFkb1snVVJMMyddOgoJCQkJbm9tZSA9ICdWaWRvemEnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDMnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAnc3RyZWFtYW5nby4nIGluIHJlc3VsdGFkb1snVVJMMyddOgoJCQkJbm9tZSA9ICdTdHJlYW1hbmdvJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwzJ10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCglleGNlcHQ6CgkJcGFzcwoJdHJ5OgoJCWlmIHJlc3VsdGFkb1snVVJMNCddICE9ICcnOgoJCQlpKz0xCgkJCWlmICdvcGVubG9hZCcgaW4gcmVzdWx0YWRvWydVUkw0J106CgkJCQlub21lID0gIk9wZW5Mb2FkIgoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkw0J10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3ZpZHppJyBpbiByZXN1bHRhZG9bJ1VSTDQnXToKCQkJCW5vbWUgPSAnVmlkemknCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDQnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAnZ29vZ2xlJyBpbiByZXN1bHRhZG9bJ1VSTDQnXSBvciAnY2xvdWQubWFpbC5ydScgaW4gcmVzdWx0YWRvWydVUkw0J106CgkJCQlub21lID0gQWRkb25UaXRsZQoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkw0J10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3VwdG9zdHJlYW0uY29tJyBpbiByZXN1bHRhZG9bJ1VSTDQnXToKCQkJCW5vbWUgPSAnVXBUb1N0cmVhbScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMNCddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdyYXBpZHZpZGVvLmNvbScgaW4gcmVzdWx0YWRvWydVUkw0J10gb3IgJ3JhcHR1JyBpbiByZXN1bHRhZG9bJ1VSTDQnXToKCQkJCW5vbWUgPSAnUmFwdHUnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDQnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndmlkb3phLm5ldCcgaW4gcmVzdWx0YWRvWydVUkw0J106CgkJCQlub21lID0gJ1ZpZG96YScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMNCddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdzdHJlYW1hbmdvLicgaW4gcmVzdWx0YWRvWydVUkw0J106CgkJCQlub21lID0gJ1N0cmVhbWFuZ28nCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDQnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCWV4Y2VwdDoKCQlwYXNzCglsZWdlbmRhID0gJycKCXN0cmVhbSA9ICcnCglpZiAnOi8vJyBpbiByZXN1bHRhZG9bJ2xlZ2VuZGEnXSBvciByZXN1bHRhZG9bJ2xlZ2VuZGEnXSA9PSAnJzoKCQlsZWdlbmRhID0gX19BUElfXysnc3Vicy8lcy5zcnQnICUgcmVzdWx0YWRvWydJTUJEJ10KCWVsaWYgcmVzdWx0YWRvWydsZWdlbmRhJ10gIT0gJyc6CgkJaWYgbm90ICcuc3J0JyBpbiByZXN1bHRhZG9bJ2xlZ2VuZGEnXToKCQkJcmVzdWx0YWRvWydsZWdlbmRhJ10gPSByZXN1bHRhZG9bJ2xlZ2VuZGEnXSsnLnNydCcKCQlsZWdlbmRhID0gX19BUElfXysnc3Vicy8lcycgJSByZXN1bHRhZG9bJ2xlZ2VuZGEnXQoJdHJ5OgoJCWlmIHJlc3VsdGFkb1snc2VtbGVnZW5kYSddID09IDE6CgkJCWxlZ2VuZGEgPSAnJwoJZXhjZXB0OgoJCXBhc3MKCWV4dF9nID0gJ2NvaXNvJwoJbGVnZW5kYUF1eCA9IGxlZ2VuZGEKCXNlcnZpZG9yID0gMAoJaWYgbGVuKHRpdHVsb3MpID4gMToKCQlzZXJ2aWRvciA9IHhibWNndWkuRGlhbG9nKCkuc2VsZWN0KCdFc2NvbGhhIG8gc2Vydmlkb3InLCB0aXR1bG9zKQoJZWxzZToKCQlzZXJ2aWRvciA9IDAKCQoJaWYgJ3ZpZHppJyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQkJdmlkemkgPSBVUkxSZXNvbHZlck1lZGlhLlZpZHppKHNlcnZpZG9yZXNbc2Vydmlkb3JdKQoJCQlzdHJlYW0gPSB2aWR6aS5nZXRNZWRpYVVybCgpCgkJCWxlZ2VuZGEgPSB2aWR6aS5nZXRTdWJ0aXRsZSgpCgllbGlmICd1cHRvc3RyZWFtLmNvbScgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJc3RyZWFtID0gVVJMUmVzb2x2ZXJNZWRpYS5VcFRvU3RyZWFtKHNlcnZpZG9yZXNbc2Vydmlkb3JdKS5nZXRNZWRpYVVybCgpCgllbGlmICdzZXJ2ZXIubXJwaXJhY3kud2luJyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQlzdHJlYW0gPSBzZXJ2aWRvcmVzW3NlcnZpZG9yXQoJZWxpZiAnb3BlbmxvYWQnIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXN0cmVhbSA9IFVSTFJlc29sdmVyTWVkaWEuT3BlbkxvYWQoc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pLmdldE1lZGlhVXJsKCkKCQlsZWdlbmRhID0gVVJMUmVzb2x2ZXJNZWRpYS5PcGVuTG9hZChzZXJ2aWRvcmVzW3NlcnZpZG9yXSkuZ2V0U3VidGl0bGUoKQoJCWlmIG5vdCAnLnZ0dCcgaW4gbGVnZW5kYSBvciBsZWdlbmRhID09ICcnOgoJCQlsZWdlbmRhID0gbGVnZW5kYUF1eAoJZWxpZiAnZHJpdmUuZ29vZ2xlLmNvbS8nIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXN0cmVhbSwgZXh0X2cgPSBVUkxSZXNvbHZlck1lZGlhLkdvb2dsZVZpZGVvKHNlcnZpZG9yZXNbc2Vydmlkb3JdKS5nZXRNZWRpYVVybCgpCgllbGlmICdjbG91ZC5tYWlsLnJ1JyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQlzdHJlYW0sIGV4dF9nID0gVVJMUmVzb2x2ZXJNZWRpYS5DbG91ZE1haWxSdShzZXJ2aWRvcmVzW3NlcnZpZG9yXSkuZ2V0TWVkaWFVcmwoKQoJZWxpZiAncmFwaWR2aWRlby5jb20nIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdIG9yICdyYXB0dScgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJcmFwaWQgPSBVUkxSZXNvbHZlck1lZGlhLlJhcGlkVmlkZW8oc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pCgkJc3RyZWFtID0gcmFwaWQuZ2V0TWVkaWFVcmwoKQoJCWxlZ2VuZGEgPSByYXBpZC5nZXRMZWdlbmRhKCkKCWVsaWYgJ3ZpZG96YS5uZXQnIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXZpZG96ID0gVVJMUmVzb2x2ZXJNZWRpYS5WaWRvemEoc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pCgkJc3RyZWFtID0gdmlkb3ouZ2V0TWVkaWFVcmwoKQoJCWxlZ2VuZGEgPSB2aWRvei5nZXRMZWdlbmRhKCkKCWVsaWYgJ3N0cmVhbWFuZ28uJyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQlzdHJlYW1hbiA9IFVSTFJlc29sdmVyTWVkaWEuU3RyZWFtYW5nbyhzZXJ2aWRvcmVzW3NlcnZpZG9yXSkKCQlzdHJlYW0gPSBzdHJlYW1hbi5nZXRNZWRpYVVybCgpCgkJbGVnZW5kYSA9IHN0cmVhbWFuLmdldExlZ2VuZGEoKQoJCglpZiBjb2lzbyA9PSAnZmlsbWUnOgoJCWxlZ2VuZGEgPSBsZWdlbmRhQXV4CgkJaWYgcmVzdWx0YWRvWydJTUJEJ10gbm90IGluIGxlZ2VuZGE6CgkJCWxlZ2VuZGEgPSBfX0FQSV9fKydzdWJzLyVzLnNydCcgJSByZXN1bHRhZG9bJ0lNQkQnXQoJCglpZiBsZWdlbmRhID09ICcnOgoJCWxlZ2VuZGEgPSBsZWdlbmRhQXV4CglyZXR1cm4gc3RyZWFtLCBsZWdlbmRhLCBleHRfZwoKCmRlZiBwZXNxdWlzYU1vdih1cmwpOgoJY29kaWdvX2ZvbnRlID0gJycKCWRhZG9zID0gJycKCXRhYmVsYSA9ICcnCglzdHJQZXNxdWlzYSA9ICcnCglmaWNoZWlybyA9ICcnCglzaXRlID0gJycKCXF1YWxpZGFkZSA9ICcnCglpZiAnZmlsbWVzJyBpbiB1cmw6CgkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdmaWxtZXNfcGVzcXVpc2EubGl2ZWl0JykKCQl0aXBvID0gMAoJCXF1YWxpZGFkZSA9IF9fUXVhbGlkYWRlX18KCWVsaWYgJ3NlcmllcycgaW4gdXJsOgoJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnc2VyaWVzX3Blc3F1aXNhLmxpdmVpdCcpCgkJdGlwbyA9IDEKCQlzaXRlID0gJ3NlcmllcycKCQlxdWFsaWRhZGUgPSAnMicKCWVsaWYgJ2FuaW1lcycgaW4gdXJsOgoJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnYW5pbWVzX3Blc3F1aXNhLmxpdmVpdCcpCgkJdGlwbyA9IDIKCQlzaXRlID0gJ2FuaW1lcycKCQlxdWFsaWRhZGUgPSAnMicKCWlmICdwYWdlJyBub3QgaW4gdXJsOgoJCXRyeToKCQkJdGlwbyA9IHhibWNndWkuRGlhbG9nKCkuc2VsZWN0KHUnT25kZSBxdWVyIHBlc3F1aXNhcj8nLCBbJ0ZpbG1lcycsICdTZXJpZXMnLCAnQW5pbWVzJ10pCgkJZXhjZXB0OgoJCQlyZXR1cm4gRmFsc2UKCQl0ZWNsYWRvID0geGJtYy5LZXlib2FyZCgnJywgJ08gcXVlIHF1ZXIgcGVzcXVpc2FyPycpCgkJaWYgdGlwbyA9PSAwOgoJCQl1cmwgPSBfX0FQSV9TSVRFX18rJ2ZpbG1lcy5waHA/YWN0aW9uPXBlc3F1aXNhJwoJCQlmaWNoZWlybyA9IG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ2ZpbG1lc19wZXNxdWlzYS5saXZlaXQnKQoJCQlxdWFsaWRhZGUgPSBfX1F1YWxpZGFkZV9fCgkJZWxpZiB0aXBvID09IDE6CgkJCXVybCA9IF9fQVBJX1NJVEVfXysnc2VyaWVzLnBocD9hY3Rpb249cGVzcXVpc2EnCgkJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnc2VyaWVzX3Blc3F1aXNhLmxpdmVpdCcpCgkJCXF1YWxpZGFkZSA9ICcyJwoJCQlzaXRlID0gJ3NlcmllcycKCQllbGlmIHRpcG8gPT0gMjoKCQkJdXJsID0gX19BUElfU0lURV9fKydhbmltZXMucGhwP2FjdGlvbj1wZXNxdWlzYScKCQkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdhbmltZXNfcGVzcXVpc2EubGl2ZWl0JykKCQkJcXVhbGlkYWRlID0gJzInCgkJCXNpdGUgPSAnYW5pbWVzJwoJCWlmIHhibWN2ZnMuZXhpc3RzKGZpY2hlaXJvKToKCQkJZiA9IG9wZW4oZmljaGVpcm8sICJyIikKCQkJdGV4dG8gPSBmLnJlYWQoKQoJCQlmLmNsb3NlKCkKCQkJdGVjbGFkby5zZXREZWZhdWx0KHRleHRvKQoJCXRlY2xhZG8uZG9Nb2RhbCgpCQoKCQlpZiB0ZWNsYWRvLmlzQ29uZmlybWVkKCk6CgkJCXN0clBlc3F1aXNhID0gdGVjbGFkby5nZXRUZXh0KCkKCQkJaWYgc3RyUGVzcXVpc2EgPT0gJyc6CgkJCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdJbnNpcmEgYWxnbyBuYSBwZXNxdWlzYS4nKQoJCQkJYWRkRGlyMignQWx0ZXJhciBQZXNxdWlzYScsIHVybCwgMTI0LCAnJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Blc3F1aXNhLnBuZycpLCAwKQoJCQkJcmV0dXJuIEZhbHNlCgkJCWRhZG9zID0gdXJsbGliLnVybGVuY29kZSh7J3RleHRvJzogc3RyUGVzcXVpc2EsICdxdWFsaWRhZGUnOiBxdWFsaWRhZGV9KQoJCQl0cnk6CgkJCQlmID0gb3BlbihmaWNoZWlybywgbW9kZT0idyIpCgkJCQlmLndyaXRlKHN0clBlc3F1aXNhKQoJCQkJZi5jbG9zZSgpCgkJCWV4Y2VwdDoKCQkJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ07Do28gZ3Jhdm91IG8gY29udGV1ZG8gZW0gJytmaWNoZWlybykKCQkJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCxwb3N0PWRhZG9zLCBoZWFkZXI9aGVhZGVycywgY29va2llPWdldENvb2tpZSgpKQoJZWxzZToKCQlpZiB4Ym1jdmZzLmV4aXN0cyhmaWNoZWlybyk6CgkJCWYgPSBvcGVuKGZpY2hlaXJvLCAiciIpCgkJCXRleHRvID0gZi5yZWFkKCkKCQkJZi5jbG9zZSgpCgkJZGFkb3MgPSB1cmxsaWIudXJsZW5jb2RlKHsndGV4dG8nOiB0ZXh0bywgJ3F1YWxpZGFkZSc6cXVhbGlkYWRlfSkKCQlyZXN1bHRhZG8gPSBhYnJpcl91cmwodXJsLHBvc3Q9ZGFkb3MsIGhlYWRlcj1oZWFkZXJzLCBjb29raWU9Z2V0Q29va2llKCkpCgkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJdHJ5OgoJCWlmIHJlc3VsdGFkb1snY29kaWdvJ10gPT0gMjA0OgoJCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdEZXZlIEluZGljYXIgdW0gdmFsb3IgcGFyYSBwZXNxdWlzYS4nKQoJCQlyZXR1cm4gRmFsc2UKCWV4Y2VwdDoKCQlyZXN1bHRhZG8gPSByZXN1bHRhZG8KCXZpc3RvcyA9IERhdGFiYXNlLnNlbGVjdEZpbG1lcygpCglvcGNhbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCdtYXJjYXJWaXN0bycpCgoJaWYgcmVzdWx0YWRvWydkYXRhJ10gIT0gJyc6CgkJaWYgdGlwbyA9PSAwOgoJCQlmb3IgaSBpbiByZXN1bHRhZG9bJ2RhdGEnXToKCQkJCXNldEZpbG1lKGksIHZpc3Rvcywgb3BjYW8pCgkJZWxpZiB0aXBvID09IDEgb3IgdGlwbyA9PSAyOgoJCQlmb3IgaSBpbiByZXN1bHRhZG9bJ2RhdGEnXToKCQkJCXNldFNlcmllcyhpLCB2aXN0b3MsIG9wY2FvLCBzaXRlKQoJCQoJCWN1cnJlbnQgPSByZXN1bHRhZG9bJ21ldGEnXVsnY3VycmVudCddCgkJdG90YWwgPSByZXN1bHRhZG9bJ21ldGEnXVsndG90YWwnXQoJCXRyeTogcHJveGltbyA9IHJlc3VsdGFkb1snbWV0YSddWydwYWdpbmFjYW8nXVsnbmV4dCddCgkJZXhjZXB0OiBwYXNzIAoJCWlmIGludChjdXJyZW50KSA8IGludCh0b3RhbCk6CgkJCWFkZERpcjIoJ1Byb3hpbWEgcGFnaW5hICgnK3N0cihjdXJyZW50KSsnLycrc3RyKHRvdGFsKSsnKScsIHByb3hpbW8sIDEyNCwgJ3Blc3F1aXNhJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Byb3hpbW8ucG5nJykpCgkJZWxzZToKCQkJeGJtY3BsdWdpbi5lbmRPZkRpcmVjdG9yeShpbnQoc3lzLmFyZ3ZbMV0pLGNhY2hlVG9EaXNjPUZhbHNlKQoJdmlzdGFfZmlsbWVzU2VyaWVzKCkKCmRlZiBwZXNxdWlzYShzZXJ2dXNzKToKCWNvZGlnb19mb250ZSA9ICcnCglkYWRvcyA9ICcnCgluZXQgPSBOZXQoKQoJI25ldC5zZXRfY29va2llcyhfX0NPT0tJRV9GSUxFX18pCgl0YWJlbGEgPSAnJwoJc3RyUGVzcXVpc2EgPSAnJwoJZmljaGVpcm8gPSAnJwoJdXJsID0gJycKCWlmICdwYWdlJyBub3QgaW4gdXJsOgoJCXVybCA9IF9fU0lURUJEX18rJ3NlYXJjaC5waHAnCgkJaWYgdGlwbyA9PSAzOgoJCQl0YWJlbGEgPSAnY2FuYWlzX2tvZGknCgkJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnY2FuYWlzLmxpdmVpdCcpCgkJZWxpZiB0aXBvID09IDQ6CgkJCXRhYmVsYSA9ICdwcmFpYXNfa29kaScKCQkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdwcmFpYXMubGl2ZWl0JykKCQllbGlmIHRpcG8gPT0gNToKCQkJdGFiZWxhID0gJ3JhZGlvc19rb2RpJwoJCQlmaWNoZWlybyA9IG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ3JhZGlvcy5saXZlaXQnKQoJCWVsc2U6CgkJCXRhYmVsYSA9ICdwcm9ncmFtYXNfa29kaScKCQkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdwcm9ncmFtYXMubGl2ZWl0JykKCQkKCQlpZiB4Ym1jdmZzLmV4aXN0cyhmaWNoZWlybyk6CgkJCWYgPSBvcGVuKGZpY2hlaXJvLCAiciIpCgkJCXRleHRvID0gZi5yZWFkKCkKCQkJZi5jbG9zZSgpCgkJCXRlY2xhZG8uc2V0RGVmYXVsdCh0ZXh0bykKCQl0ZWNsYWRvLmRvTW9kYWwoKQkKCgkJaWYgdGVjbGFkby5pc0NvbmZpcm1lZCgpOgoJCQlzdHJQZXNxdWlzYSA9IHRlY2xhZG8uZ2V0VGV4dCgpCgkJCWRhZG9zID0gdXJsbGliLnVybGVuY29kZSh7J3RleHRvJzogc3RyUGVzcXVpc2EsICdxdWFsaWRhZGUnOiBxdWFsaWRhZGV9KQoJCQl0cnk6CgkJCQlmID0gb3BlbihmaWNoZWlybywgbW9kZT0idyIpCgkJCQlmLndyaXRlKHN0clBlc3F1aXNhKQoJCQkJZi5jbG9zZSgpCgkJCWV4Y2VwdDoKCQkJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ07Do28gZ3Jhdm91IG8gY29udGV1ZG8gZW0gJytmaWNoZWlybykKCQkJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCxwb3N0PWRhZG9zLCBoZWFkZXI9aGVhZGVycywgY29va2llPWdldENvb2tpZSgpKQoJZWxzZToKCQlpZiB4Ym1jdmZzLmV4aXN0cyhmaWNoZWlybyk6CgkJCWYgPSBvcGVuKGZpY2hlaXJvLCAiciIpCgkJCXRleHRvID0gZi5yZWFkKCkKCQkJZi5jbG9zZSgpCgkJZGFkb3MgPSB1cmxsaWIudXJsZW5jb2RlKHsndGV4dG8nOiB0ZXh0bywgJ3F1YWxpZGFkZSc6cXVhbGlkYWRlfSkKCQlyZXN1bHRhZG8gPSBhYnJpcl91cmwodXJsLHBvc3Q9ZGFkb3MsIGhlYWRlcj1oZWFkZXJzLCBjb29raWU9Z2V0Q29va2llKCkpCgkKCWlmIHN0clBlc3F1aXNhICE9ICcnOgoJCWlmIHJlc3VsdGFkbyA9PSAnRE5TJzoKCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVGVtIGRlIGFsdGVyYXIgb3MgRE5TIHBhcmEgcG9kZXIgdXN1ZnJ1aXIgZG8gX19BRERPTl9fLicpCgkJCXJldHVybiBGYWxzZQoJCQoJCXhibWNwbHVnaW4uZW5kT2ZEaXJlY3RvcnkoaW50KHN5cy5hcmd2WzFdKSxjYWNoZVRvRGlzYz1GYWxzZSkKCQlkYWRvcyA9IHsnc2VhcmNoQm94Jzogc3RyUGVzcXVpc2EsICd0YWJlbGEnOiB0YWJlbGF9CgkJY29kaWdvX2ZvbnRlID0gbmV0Lmh0dHBfUE9TVCh1cmwsIGZvcm1fZGF0YT1kYWRvcywgaGVhZGVycz1fX0hFQURFUlNfXykuY29udGVudC5kZWNvZGUoJ2xhdGluLTEnKS5lbmNvZGUoInV0Zi04IikKCQlpbmZvcm1hID0gewoJCQkJJ3NlcnZpZG9yJyA6IHsKCQkJCQknbm9tZSc6ICcnLAoJCQkJCSdzZXJ2JzogJycKCQkJCX0sCgkJCQknc2Vydmlkb3Jlcyc6IFtdLAoJCQkJJ2NhbmFpcyc6IFtdCgkJCX0KCQlzdWNlc3NvID0gJ25vJwoJCWVsZW1zID0gRVQuZnJvbXN0cmluZyhjb2RpZ29fZm9udGUpCgkJCgkJZm9yIGNoaWxkZWUgaW4gZWxlbXM6CgkJCWlmKGNoaWxkZWUudGFnID09ICdzZXJ2aWRvcmVzJyk6CgkJCQlzZXJ2aWRvciA9IHsKCQkJCQknbm9tZSc6ICcnLAoJCQkJCSdsaW5rJzogJycKCQkJCX0KCQkJCWZvciBnZyBpbiBjaGlsZGVlOgkKCQkJCQlpZihnZy50YWcgPT0gJ05vbWUnKToKCQkJCQkJc2Vydmlkb3JbJ25vbWUnXSA9IGdnLnRleHQJCgkJCQkJZWxpZihnZy50YWcgPT0gJ1NlcnZpZG9yJyk6CgkJCQkJCXNlcnZpZG9yWydsaW5rJ10gPSBnZy50ZXh0CQkKCQkJCQlpbmZvcm1hWydzZXJ2aWRvcmVzJ10uYXBwZW5kKHNlcnZpZG9yKQoJCQkKCQlmb3Igc2VydnZ2diBpbiBpbmZvcm1hWydzZXJ2aWRvcmVzJ106CgkJCWlmKHNlcnZ2dnZbJ25vbWUnXSA9PSBzZXJ2dXNzKToKCQkJCWluZm9ybWFbJ3NlcnZpZG9yJ11bJ25vbWUnXSA9IHNlcnZ2dnZbJ25vbWUnXQoJCQkJaW5mb3JtYVsnc2Vydmlkb3InXVsnc2VydiddID0gc2VydnZ2dlsnbGluayddCQkJCgkJCgkJZm9yIGNoaWxkIGluIGVsZW1zOgoJCQlpZihjaGlsZC50YWcgPT0gJ3N1Y2Vzc28nKToKCQkJCXN1Y2Vzc28gPSBjaGlsZC50ZXh0CgkJCWVsaWYoY2hpbGQudGFnID09ICdjYW5haXMnKToKCQkJCWNhbmFsID0gewoJCQkJCSdub21lJzogJycsCgkJCQkJJ2xvZ28nOiAnJywKCQkJCQknbGluayc6ICcnLAoJCQkJCSdncnVwbyc6ICcnLAoJCQkJCSdub21laWQnOiAnJywKCQkJCQknaWRub3ZvJzogJycKCQkJCX0KCQkJCWFkaWNpb25hID0gVHJ1ZQoJCQkJcGFnYW50ZSA9IEZhbHNlCgkJCQlmb3IgZyBpbiBjaGlsZDoKCQkJCQlhZGljaW9uYSA9IFRydWUKCQkJCQlpZihnLnRhZyA9PSAnTm9tZScpOgoJCQkJCQljYW5hbFsnbm9tZSddID0gZy50ZXh0CgkJCQkJZWxpZihnLnRhZyA9PSAnSW1hZ2VtJyk6CgkJCQkJCWNhbmFsWydsb2dvJ10gPSBnLnRleHQKCQkJCQllbGlmKGcudGFnID09ICdQYWdhbnRlJyk6CgkJCQkJCWlmKGcudGV4dCA9PSAndHJ1ZScpOgoJCQkJCQkJcGFnYW50ZSA9IFRydWUKCQkJCQllbGlmKGcudGFnID09ICdVcmwnKToKCQkJCQkJdXJsY2hhbWEgPSBnLnRleHQuc3BsaXQoJzsnKQoJCQkJCQl1cmxub28gPSBnLnRleHQKCQkJCQkJdHJ5OgoJCQkJCQkJaWYoc2VydnVzcyA9PSAnU2Vydmlkb3IxJyk6CgkJCQkJCQkJdXJsbm9vID0gdXJsY2hhbWFbMF0KCQkJCQkJCWVsaWYoc2VydnVzcyA9PSAnU2Vydmlkb3IyJyk6CgkJCQkJCQkJdXJsbm9vID0gdXJsY2hhbWFbMV0KCQkJCQkJCWVsaWYoc2VydnVzcyA9PSAnU2Vydmlkb3IzJyk6CgkJCQkJCQkJdXJsbm9vID0gdXJsY2hhbWFbMl0KCQkJCQkJCWVsaWYoc2VydnVzcyA9PSAnU2Vydmlkb3I0Jyk6CgkJCQkJCQkJdXJsbm9vID0gdXJsY2hhbWFbM10KCQkJCQkJCWVsaWYoc2VydnVzcyA9PSAnU2Vydmlkb3I1Jyk6CgkJCQkJCQkJdXJsbm9vID0gdXJsY2hhbWFbNF0KCQkJCQkJCWVsaWYoc2VydnVzcyA9PSAnU2Vydmlkb3I2Jyk6CgkJCQkJCQkJdXJsbm9vID0gdXJsY2hhbWFbNV0KCQkJCQkJCWVsaWYoc2VydnVzcyA9PSAnU2Vydmlkb3I3Jyk6CgkJCQkJCQkJdXJsbm9vID0gdXJsY2hhbWFbNl0KCQkJCQkJCWVsaWYoc2VydnVzcyA9PSAnU2Vydmlkb3I4Jyk6CgkJCQkJCQkJdXJsbm9vID0gdXJsY2hhbWFbN10KCQkJCQkJCQoJCQkJCQkJaWYodXJsbm9vID09ICduYWRhJyk6CgkJCQkJCQkJYWRpY2lvbmEgPSBGYWxzZQoJCQkJCQkJZWxzZToKCQkJCQkJCQlpZiBwYWdhbnRlOgoJCQkJCQkJCQljYW5hbFsnbGluayddID0gaW5mb3JtYVsnc2Vydmlkb3InXVsnc2VydiddKydsaXZlL3V0aWxpemFkb3JsaXZlaXQvc2VuaGFsaXZlaXQvJyt1cmxub28KCQkJCQkJCQllbHNlOgoJCQkJCQkJCQljYW5hbFsnbGluayddID0gdXJsbm9vCgkJCQkJCWV4Y2VwdDoKCQkJCQkJCWNhbmFsWydsaW5rJ10gPSBnLnRleHQKCQkJCQllbGlmKGcudGFnID09ICdHcnVwbycpOgoJCQkJCQljYW5hbFsnZ3J1cG8nXSA9IGcudGV4dAoJCQkJCWVsaWYoZy50YWcgPT0gJ05vbWVJRCcpOgoJCQkJCQljYW5hbFsnbm9tZWlkJ10gPSBnLnRleHQKCQkJCQllbGlmKGcudGFnID09ICdJRCcpOgoJCQkJCQljYW5hbFsnaWRub3ZvJ10gPSBnLnRleHQKCQkJCWlmIGFkaWNpb25hOgoJCQkJCWluZm9ybWFbJ2NhbmFpcyddLmFwcGVuZChjYW5hbCkKCgkJaWYgc3VjZXNzbyA9PSAneWVzJzoKCQkJYWRkRGlyMignQWx0ZXJhciBQZXNxdWlzYScsIHNlcnZ1c3MsIDEyMCwgJycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdwZXNxdWlzYS5wbmcnKSwgMCkKCQkJZm9yIGNhbm4gaW4gaW5mb3JtYVsnY2FuYWlzJ106CgkJCQlub21lZSA9IGNhbm5bJ25vbWUnXQoJCQkJaW1nID0gY2FublsnbG9nbyddCgkJCQlydG1wID0gY2FublsnbGluayddLnJlcGxhY2UoJyBydG1wJywncnRtcCcpLnJlcGxhY2UoJyBydHNwJywncnRzcCcpLnJlcGxhY2UoJyBodHRwJywnaHR0cCcpLnJlcGxhY2UoJ3V0aWxpemFkb3JsaXZlaXQnLF9fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9uYW1lIikpLnJlcGxhY2UoJ3NlbmhhbGl2ZWl0JyxfX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fcGFzc3dvcmQiKSkKCQkJCWdydXAgPSBjYW5uWydncnVwbyddCgkJCQlpZF9pdCA9IGNhbm5bJ25vbWVpZCddCgkJCQlpZF9wID0gY2FublsnaWRub3ZvJ10KCQkJCXNydF9mID0gJycKCQkJCWRlc2NyaSA9ICcnCgkJCQkKCQkJCWFkZExpbmsyKG5vbWVlLHJ0bXAsJ2h0dHA6Ly9saXZlaXRrb2RpLmNvbS9Mb2dvcy8nK2ltZykKCQkJCgkJCXZpc3RhX0NhbmFpcygpCgllbHNlOgoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0luc2lyYSBhbGdvIG5hIHBlc3F1aXNhLicpCgkJYWRkRGlyMignQWx0ZXJhciBQZXNxdWlzYScsIHNlcnZ1c3MsIDEyMCwgJycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdwZXNxdWlzYS5wbmcnKSwgMCkKCmRlZiBkb3dubG9hZCh1cmwsbmFtZSwgdGVtcG9yYWRhLGVwaXNvZGlvLHNlcmllTm9tZSk6CgkjaGVhZGVyc1snQXV0aG9yaXphdGlvbiddID0gJ0JlYXJlciAlcycgJSBfX0FERE9OX18uZ2V0U2V0dGluZygndG9rZW5NcnBpcmFjeScpCglsaW5rcyA9IHVybC5zcGxpdCgnLycpCglpZiAnZmlsbWUnIGluIHVybDoKCQlpZF92aWRlbyA9IGxpbmtzWy0xXQoJCXRpcG8gPSAwCgllbGlmICdzZXJpZScgaW4gdXJsOgoJCWlkX3ZpZGVvID0gbGlua3NbNV0KCQl0ZW1wb3JhZGEgPSBsaW5rc1s3XQoJCWVwaXNvZGlvID0gbGlua3NbLTFdCgkJdGlwbyA9IDEKCWVsaWYgJ2FuaW1lJyBpbiB1cmw6CgkJaWRfdmlkZW8gPSBsaW5rc1s1XQoJCXRlbXBvcmFkYSA9IGxpbmtzWzddCgkJZXBpc29kaW8gPSBsaW5rc1stMV0KCQl0aXBvID0gMgoKCXJlc3VsdGFkbyA9IGFicmlyX3VybCh1cmwsIGhlYWRlcj1oZWFkZXJzKQoJaWYgcmVzdWx0YWRvID09ICdETlMnOgoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1RlbSBkZSBhbHRlcmFyIG9zIEROUyBwYXJhIHBvZGVyIHVzdWZydWlyIGRvIF9fQURET05fXy4nKQoJCXJldHVybiBGYWxzZQoJCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCglzdHJlYW0sIGxlZ2VuZGEsIGV4dF9nID0gZ2V0U3RyZWFtTGVnZW5kYShyZXN1bHRhZG8pCgoJZm9sZGVyID0geGJtYy50cmFuc2xhdGVQYXRoKF9fQURET05fXy5nZXRTZXR0aW5nKCdwYXN0YURvd25sb2FkcycpKQoJaWYoZm9sZGVyID09ICdFc2NvbGhhIGEgcGFzdGEgcGFyYSBEb3dubG9hZCcpOgoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1NlbGVjY2lvbmUgdW1hIHBhc3RhIHByaW1laXJvIG5vIHN1Ym1lbnUgQ3JlZMOqbmNpYWlzIG91IG5hcyBDb25maWd1cmHDp8O1ZXMgZG8gX19BRERPTl9fLicpCgllbHNlOgoJCWlmIHRpcG8gPiAwOgoJCQlpZiB0aXBvID09IDE6CgkJCQlyZXN1bHRhZG9hID0gYWJyaXJfdXJsKF9fQVBJX1NJVEVfXysnc2VyaWUvJytpZF92aWRlbywgaGVhZGVyPWhlYWRlcnMpCgkJCWVsaWYgdGlwbyA9PSAyOgoJCQkJcmVzdWx0YWRvYSA9IGFicmlyX3VybChfX0FQSV9TSVRFX18rJ2FuaW1lLycraWRfdmlkZW8sIGhlYWRlcj1oZWFkZXJzKQoJCQlyZXN1bHRhZG9hID0ganNvbi5sb2FkcyhyZXN1bHRhZG9hKQoJCQlpZiBub3QgeGJtY3Zmcy5leGlzdHMob3MucGF0aC5qb2luKGZvbGRlciwnc2VyaWVzJykpOgoJCQkJeGJtY3Zmcy5ta2RpcnMob3MucGF0aC5qb2luKGZvbGRlciwnc2VyaWVzJykpCgkJCWlmIG5vdCB4Ym1jdmZzLmV4aXN0cyhvcy5wYXRoLmpvaW4oZm9sZGVyLCdzZXJpZXMnLHJlc3VsdGFkb2FbJ25vbWVfaW5nbGVzJ10pKToKCQkJCXhibWN2ZnMubWtkaXJzKG9zLnBhdGguam9pbihmb2xkZXIsJ3NlcmllcycscmVzdWx0YWRvYVsnbm9tZV9pbmdsZXMnXSkpCgkJCWlmIG5vdCB4Ym1jdmZzLmV4aXN0cyhvcy5wYXRoLmpvaW4oZm9sZGVyLCdzZXJpZXMnLHJlc3VsdGFkb2FbJ25vbWVfaW5nbGVzJ10sIlRlbXBvcmFkYSAiK3N0cih0ZW1wb3JhZGEpKSk6CgkJCQl4Ym1jdmZzLm1rZGlycyhvcy5wYXRoLmpvaW4oZm9sZGVyLCdzZXJpZXMnLHJlc3VsdGFkb2FbJ25vbWVfaW5nbGVzJ10sIlRlbXBvcmFkYSAiK3N0cih0ZW1wb3JhZGEpKSkKCQkJZm9sZGVyID0gb3MucGF0aC5qb2luKGZvbGRlciwgJ3NlcmllcycsIHJlc3VsdGFkb2FbJ25vbWVfaW5nbGVzJ10sICJUZW1wb3JhZGEiLCBzdHIodGVtcG9yYWRhKSkKCQkJbmFtZSA9ICJlIitzdHIoZXBpc29kaW8pKyIgLSAiK2NsZWFuKHJlc3VsdGFkb1snbm9tZV9lcGlzb2RpbyddKQoJCWVsc2U6CgkJCWlmIG5vdCB4Ym1jdmZzLmV4aXN0cyhvcy5wYXRoLmpvaW4oZm9sZGVyLCdmaWxtZXMnKSk6CgkJCQl4Ym1jdmZzLm1rZGlycyhvcy5wYXRoLmpvaW4oZm9sZGVyLCdmaWxtZXMnKSkKCQkJZm9sZGVyID0gb3MucGF0aC5qb2luKGZvbGRlciwnZmlsbWVzJykKCQkJbmFtZSA9IHJlc3VsdGFkb1snbm9tZV9pbmdsZXMnXQoKCQlzdHJlYW1BdXggPSBjbGVhbihzdHJlYW0uc3BsaXQoJy8nKVstMV0pCgkJZXh0ZW5zYW9TdHJlYW0gPSBjbGVhbihzdHJlYW1BdXguc3BsaXQoJy4nKVstMV0pCgoJCWlmICc/bWltJyBpbiBleHRlbnNhb1N0cmVhbToKCQkJZXh0ZW5zYW9TdHJlYW0gPSByZS5jb21waWxlKCcoLis/KVw/bWltZT0nKS5maW5kYWxsKGV4dGVuc2FvU3RyZWFtKVswXQoKCQlpZiBleHRfZyAhPSAnY29pc28nOgoJCQlleHRlbnNhb1N0cmVhbSA9IGV4dF9nCgoJCW5vbWVTdHJlYW0gPSBuYW1lKycuJytleHRlbnNhb1N0cmVhbQoJCW5vbWVsZWdlbmRhID0gJycKCQlEb3dubG9hZGVyLkRvd25sb2FkZXIoKS5kb3dubG9hZChvcy5wYXRoLmpvaW4oZm9sZGVyLmRlY29kZSgidXRmLTgiKSwgbm9tZVN0cmVhbSksIHN0cmVhbSwgbmFtZSkKCQkKCQlpZiBsZWdlbmRhc09uOgoJCQlsZWdlbmRhQXV4ID0gY2xlYW4obGVnZW5kYS5zcGxpdCgnLycpWy0xXSkKCQkJZXh0ZW5zYW9MZWdlbmRhID0gY2xlYW4obGVnZW5kYUF1eC5zcGxpdCgnLicpWzFdKQoJCQlub21lTGVnZW5kYSA9IG5hbWUrJy4nK2V4dGVuc2FvTGVnZW5kYQoJCQlkb3dubG9hZF9sZWdlbmRhcyhsZWdlbmRhLCBvcy5wYXRoLmpvaW4oZm9sZGVyLCBub21lTGVnZW5kYSkpCgpkZWYgZG93bmxvYWRfbGVnZW5kYXModXJsLHBhdGgpOgoJY29udGVudHMgPSBhYnJpcl91cmwodXJsKQoJaWYgY29udGVudHM6CgkJZmggPSBvcGVuKHBhdGgsICd3JykKCQlmaC53cml0ZShjb250ZW50cykKCQlmaC5jbG9zZSgpCglyZXR1cm4KCmRlZiBjbGVhbih0ZXh0KToKCWNvbW1hbmQ9eycmIzgyMjA7JzonIicsJyYjODIyMTsnOiciJywgJyYjODIxMTsnOictJywnJmFtcDsnOicmJywnJiM4MjE3Oyc6IiciLCcmIzgyMTY7JzoiJyJ9CglyZWdleCA9IHJlLmNvbXBpbGUoInwiLmpvaW4obWFwKHJlLmVzY2FwZSwgY29tbWFuZC5rZXlzKCkpKSkKCXJldHVybiByZWdleC5zdWIobGFtYmRhIG1vOiBjb21tYW5kW21vLmdyb3VwKDApXSwgdGV4dCkKCmRlZiBhZGRWaWRlbyhuYW1lLHVybCxtb2RlLGljb25pbWFnZSx2aXN0byx0aXBvLHRlbXBvcmFkYSxlcGlzb2RpbyxpbmZvTGFiZWxzLHBvc3Rlcix0cmFpbGVyPUZhbHNlLHNlcmllTm9tZT1GYWxzZSk6CgltZW51ID0gW10KCQoJaWYgaW5mb0xhYmVsczogaW5mb0xhYmVsc0F1eCA9IGluZm9MYWJlbHMKCWVsc2U6IGluZm9MYWJlbHNBdXggPSB7J1RpdGxlJzogbmFtZX0KCglpZiBwb3N0ZXI6IHBvc3RlckF1eCA9IHBvc3RlcgoJZWxzZTogcG9zdGVyQXV4ID0gaWNvbmltYWdlCgkKCXRyeToKCQluYW1lID0gbmFtZS5lbmNvZGUoJ3V0Zi04JykKCWV4Y2VwdDoKCQluYW1lID0gbmFtZQoJCgl0cnk6CgkJc2VyaWVOb21lID0gc2VyaWVOb21lLmVuY29kZSgndXRmLTgnKQoJZXhjZXB0OgoJCXNlcmllTm9tZSA9IHNlcmllTm9tZQoJZWxzZToKCQlwYXNzCgoJZmFuYXJ0ID0gX19GQU5BUlRfXwoJCglpZiB0aXBvID09ICdmaWxtZSc6CgkJeGJtY3BsdWdpbi5zZXRDb250ZW50KGludChzeXMuYXJndlsxXSksICdNb3ZpZXMnKQoJCWlmIF9fQURET05fXy5nZXRTZXR0aW5nKCd0cmFpbGVyLWZpbG1lcycpID09ICd0cnVlJzoKCQkJdHJ5OgoJCQkJaWRZb3V0dWJlID0gdHJhaWxlci5zcGxpdCgnP3Y9JylbLTFdLnNwbGl0KCcvJylbLTFdLnNwbGl0KCc/JylbMF0uc3BsaXQoJyYnKVswXQoJCQkJbGlua1RyYWlsZXIgPSAncGx1Z2luOi8vcGx1Z2luLnZpZGVvLnlvdXR1YmUvcGxheS8/dmlkZW9faWQ9JytpZFlvdXR1YmUKCQkJCSNpZFlvdXR1YmU9dHJhaWxlci5zcGxpdCgnPScpCgkJCQkjX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnSUQ6ICcraWRZb3V0dWJlWzFdKQoJCQkJI2xpbmtUcmFpbGVyID0gJ3BsdWdpbjovL3BsdWdpbi52aWRlby55b3V0dWJlLz9wYXRoPS9yb290L3ZpZGVvJmFjdGlvbj1wbGF5X3ZpZGVvJnZpZGVvaWQ9JytpZFlvdXR1YmVbMV0KCQkJCSNsaW5rVHJhaWxlciA9IHRyYWlsZXIKCQkJZXhjZXB0OgoJCQkJbGlua1RyYWlsZXIgPSAnJwoJCWVsc2U6CgkJCWxpbmtUcmFpbGVyID0gJycKCWVsaWYgdGlwbyA9PSAnc2VyaWUnOgoJCXhibWNwbHVnaW4uc2V0Q29udGVudChpbnQoc3lzLmFyZ3ZbMV0pLCAndHZzaG93cycpCgkJaWRJTURiID0gcmUuY29tcGlsZSgnaW1kYj0oLis/KSYnKS5maW5kYWxsKHVybClbMF0KCQlsaW5rVHJhaWxlciA9ICIiCgllbGlmIHRpcG8gPT0gJ2VwaXNvZGlvJzoKCQl4Ym1jcGx1Z2luLnNldENvbnRlbnQoaW50KHN5cy5hcmd2WzFdKSwgJ2VwaXNvZGVzJykKCQlsaW5rVHJhaWxlciA9ICIiCgllbHNlOgoJCXhibWNwbHVnaW4uc2V0Q29udGVudChpbnQoc3lzLmFyZ3ZbMV0pLCAnTW92aWVzJykKCQlsaW5rVHJhaWxlciA9ICIiCgkKCW92ZXJsYXkgPSA2CglwbGF5Y291bnQgPSAwCgoJaW5mb0xhYmVsc0F1eFsib3ZlcmxheSJdID0gb3ZlcmxheQoJaW5mb0xhYmVsc0F1eFsicGxheWNvdW50Il0gPSBwbGF5Y291bnQKCQoJbGl6PXhibWNndWkuTGlzdEl0ZW0obmFtZSwgaWNvbkltYWdlPWljb25pbWFnZSwgdGh1bWJuYWlsSW1hZ2U9aWNvbmltYWdlKQoJbGl6LnNldEluZm8oIHR5cGU9IlZpZGVvIiwgaW5mb0xhYmVscz1pbmZvTGFiZWxzQXV4KQoJbGl6LnNldFByb3BlcnR5KCdmYW5hcnRfaW1hZ2UnLCBwb3N0ZXIpCglsaXouc2V0QXJ0KHsnZmFuYXJ0JzogcG9zdGVyfSkKCQoJCglpZiBub3Qgc2VyaWVOb21lOgoJCXNlcmllTm9tZSA9ICcnCgoJdT1zeXMuYXJndlswXSsiP3VybD0iK3VybGxpYi5xdW90ZV9wbHVzKHVybCkrIiZtb2RlPSIrc3RyKG1vZGUpKyImdGVtcG9yYWRhPSIrc3RyKHRlbXBvcmFkYSkrIiZlcGlzb2Rpbz0iK3N0cihlcGlzb2RpbykrIiZuYW1lPSIrdXJsbGliLnF1b3RlX3BsdXMobmFtZSkrIiZpY29uaW1hZ2U9Iit1cmxsaWIucXVvdGVfcGx1cyhpY29uaW1hZ2UpKyImc2VyaWVOb21lPSIrdXJsbGliLnF1b3RlX3BsdXMoc2VyaWVOb21lKQoJb2s9VHJ1ZQoJCglpZiBsaW5rVHJhaWxlciAhPSAiIjoKCQltZW51LmFwcGVuZCgoJ1ZlciBUcmFpbGVyJywgJ1hCTUMuUGxheU1lZGlhKCVzKScgJSAobGlua1RyYWlsZXIpKSkKCQkjbWVudS5hcHBlbmQoKCdWZXIgVHJhaWxlcicsICdYQk1DLlJ1blBsdWdpbiglcz9tb2RlPTEwNSZuYW1lPSVzJnVybD0lcyZpY29uaW1hZ2U9JXMpJyUoc3lzLmFyZ3ZbMF0sdXJsbGliLnF1b3RlX3BsdXMobmFtZSksIGxpbmtUcmFpbGVyLCB1cmxsaWIucXVvdGVfcGx1cyhpY29uaW1hZ2UpKSkpCgkKCW1lbnUuYXBwZW5kKCgnRG93bmxvYWQnLCAnWEJNQy5SdW5QbHVnaW4oJXM/bW9kZT0xMTcmbmFtZT0lcyZ1cmw9JXMmaWNvbmltYWdlPSVzJnNlcmllTm9tZT0lcyZ0ZW1wb3JhZGE9JXMmZXBpc29kaW89JXMpJyUoc3lzLmFyZ3ZbMF0sdXJsbGliLnF1b3RlX3BsdXMobmFtZSksIHVybGxpYi5xdW90ZV9wbHVzKHVybCksIHVybGxpYi5xdW90ZV9wbHVzKGljb25pbWFnZSksIHVybGxpYi5xdW90ZV9wbHVzKHNlcmllTm9tZSksIHN0cih0ZW1wb3JhZGEpLCBzdHIoZXBpc29kaW8pKSkpCglsaXouYWRkQ29udGV4dE1lbnVJdGVtcyhtZW51LCByZXBsYWNlSXRlbXM9VHJ1ZSkKCW9rPXhibWNwbHVnaW4uYWRkRGlyZWN0b3J5SXRlbShoYW5kbGU9aW50KHN5cy5hcmd2WzFdKSx1cmw9dSxsaXN0aXRlbT1saXosaXNGb2xkZXI9RmFsc2UpCglyZXR1cm4gb2sKCmRlZiBBZGREaXIobmFtZSwgdXJsLCBtb2RlLCBpY29uaW1hZ2U9JycsIGxvZ29zPScnLCBpbmRleD0tMSwgbW92ZT0wLCBpc0ZvbGRlcj1UcnVlLCBJc1BsYXlhYmxlPUZhbHNlLCBiYWNrZ3JvdW5kPU5vbmUsIGNhY2hlTWluPScwJywgaW5mbz0nJywgbWV0YWg9JycpOgoJdXJsUGFyYW1zID0geyduYW1lJzogbmFtZSwgJ3VybCc6IHVybCwgJ21vZGUnOiBtb2RlLCAnaWNvbmltYWdlJzogaWNvbmltYWdlLCAnbG9nb3MnOiBsb2dvcywgJ2NhY2hlJzogY2FjaGVNaW4sICdpbmZvJzogaW5mbywgJ2JhY2tncm91bmQnOiBiYWNrZ3JvdW5kLCAnbWV0YWgnOiBtZXRhaH0KCWxpeiA9IHhibWNndWkuTGlzdEl0ZW0obmFtZSwgaWNvbkltYWdlPWljb25pbWFnZSwgdGh1bWJuYWlsSW1hZ2U9aWNvbmltYWdlICkKCWlmIG1ldGFoOgoJCWxpei5zZXRJbmZvKHR5cGU9IlZpZGVvIiwgaW5mb0xhYmVscz1tZXRhaCkKCQlsaXouc2V0QXJ0KHsidGh1bWIiOiBtZXRhaFsnY292ZXJfdXJsJ10sICJwb3N0ZXIiOiBtZXRhaFsnY292ZXJfdXJsJ10sICJiYW5uZXIiOiBtZXRhaFsnY292ZXJfdXJsJ10sICJmYW5hcnQiOiBtZXRhaFsnYmFja2Ryb3BfdXJsJ10gfSkKCWVsc2U6CgkJbGl6LnNldEluZm8odHlwZT0iVmlkZW8iLCBpbmZvTGFiZWxzPXsgIlRpdGxlIjogbmFtZSwgIlBsb3QiOiBpbmZvIH0pCgkJI2xpei5zZXRQcm9wZXJ0eSgiRmFuYXJ0X0ltYWdlIiwgbG9nb3MpCgkJbGl6LnNldEFydCh7InBvc3RlciI6IGljb25pbWFnZSwgImJhbm5lciI6IGxvZ29zLCAiZmFuYXJ0IjogbG9nb3MgfSkKCSNsaXN0TW9kZSA9IDIxICMgTGlzdHMKCWlmIElzUGxheWFibGU6CgkJbGl6LnNldFByb3BlcnR5KCdJc1BsYXlhYmxlJywgJ3RydWUnKQoJaXRlbXMgPSBbXQoJaWYgbW9kZSA9PSAxIG9yIG1vZGUgPT0gMjoKCQlpdGVtcyA9IFtdCglpZiBtb2RlID09IDEwOgoJCXVybFBhcmFtc1snaW5kZXgnXSA9IGluZGV4CgkKCSN1PXN5cy5hcmd2WzBdKyI/dXJsPSIrdXJsbGliLnF1b3RlX3BsdXModXJsKSsiJm5hbWU9Iit1cmxsaWIucXVvdGVfcGx1cyhuYW1lKSsiJm1vZGU9IitpbnQobW9kZSkrIiZtb3ZlPSIraW50KG1vdmUpKyImaW5kZXg9IitpbnQoaW5kZXgpKyImaWNvbmltYWdlPSIrc3RyKGljb25pbWFnZSkrIiZsb2dvcz0iK3N0cihsb2dvcykrIiZjYWNoZT0iK3N0cihjYWNoZU1pbikrIiZpbmZvPSIrc3RyKGluZm8pKyImYmFja2dyb3VuZD0iK2JhY2tncm91bmQrIiZtZXRhaD0iK3N0cihtZXRhaCkKCSN1PXN5cy5hcmd2WzBdKyI/dXJsPSIrdXJsbGliLnF1b3RlX3BsdXModXJsKSsiJm1vZGU9IitzdHIobW9kZSkrIiZuYW1lPSIrdXJsbGliLnF1b3RlX3BsdXMobmFtZSkrIiZzZW5oYT0iK3N0cihzZW5oYSkrIiZlc3RpbG89Iit1cmxsaWIucXVvdGVfcGx1cyhlc3RpbG8pKyImdGlwb2xvZ2lhPSIrc3RyKHRpcG8pKyImdGlwb191c2VyPSIrc3RyKHRpcG9fdXNlcikrIiZzZXJ2aWRvcl91c2VyPSIrc3RyKHNlcnZpZG9yX3VzZXIpKyImZGF0YV91c2VyPSIrc3RyKGRhdGFfdXNlcikrIiZmYW5hcnQ9IitzdHIoZmFuYXJ0KQoJdSA9ICd7MH0/ezF9Jy5mb3JtYXQoc3lzLmFyZ3ZbMF0sIHVybGxpYi51cmxlbmNvZGUodXJsUGFyYW1zKSkKCW9rPXhibWNwbHVnaW4uYWRkRGlyZWN0b3J5SXRlbShoYW5kbGU9aW50KHN5cy5hcmd2WzFdKSx1cmw9dSwgbGlzdGl0ZW09bGl6LGlzRm9sZGVyPWlzRm9sZGVyKQoJcmV0dXJuIG9rCgpkZWYgR2V0S2V5Ym9hcmRUZXh0KHRpdGxlID0gIiIsIGRlZmF1bHRUZXh0ID0gIiIpOgoJa2V5Ym9hcmQgPSB4Ym1jLktleWJvYXJkKGRlZmF1bHRUZXh0LCB0aXRsZSkKCWtleWJvYXJkLmRvTW9kYWwoKQoJdGV4dCA9ICIiIGlmIG5vdCBrZXlib2FyZC5pc0NvbmZpcm1lZCgpIGVsc2Uga2V5Ym9hcmQuZ2V0VGV4dCgpCglyZXR1cm4gdGV4dAoKZGVmIFJlZnJlc2goKToKCXhibWMuZXhlY3V0ZWJ1aWx0aW4oIlhCTUMuQ29udGFpbmVyLlJlZnJlc2goKSIpCgpkZWYgUGxheVVybChuYW1lLCB1cmwsIGljb25pbWFnZT1Ob25lLCBpbmZvPScnLCBzdWI9JycsIG1ldGFoPScnKToKCWlmICI7OzsiIGluIGJhY2tncm91bmQ6CgkJYiA9IGJhY2tncm91bmQuc3BsaXQoIjs7OyIpCgl1cmwgPSByZS5zdWIoJ1wubXA0JCcsICcubXA0P3BsYXknLCB1cmwpCgl1cmwgPSBjb21tb24uZ2V0RmluYWxVcmwodXJsKQoJI3hibWMubG9nKCctLS0gUGxheWluZyAiezB9Ii4gezF9Jy5mb3JtYXQobmFtZSwgdXJsKSwgMikKCWxpc3RpdGVtID0geGJtY2d1aS5MaXN0SXRlbShwYXRoPXVybCkKCWlmIG1ldGFoOgoJCWxpc3RpdGVtLnNldEluZm8odHlwZT0iVmlkZW8iLCBpbmZvTGFiZWxzPW1ldGFoKQoJZWxzZToKCQlsaXN0aXRlbS5zZXRJbmZvKHR5cGU9IlZpZGVvIiwgaW5mb0xhYmVscz17Im1lZGlhdHlwZSI6ICJ2aWRlbyIsICJUaXRsZSI6IG5hbWUsICJQbG90IjogaW5mbyB9KQoJaWYgc3ViIT0nJzoKCQlsaXN0aXRlbS5zZXRTdWJ0aXRsZXMoWydzcGVjaWFsOi8vdGVtcC9leGFtcGxlLnNydCcsIHN1YiBdKQoJaWYgaWNvbmltYWdlIGlzIG5vdCBOb25lOgoJCXRyeToKCQkJbGlzdGl0ZW0uc2V0QXJ0KHsndGh1bWInIDogaWNvbmltYWdlfSkKCQlleGNlcHQ6CgkJCWxpc3RpdGVtLnNldFRodW1ibmFpbEltYWdlKGljb25pbWFnZSkKCXhibWNwbHVnaW4uc2V0UmVzb2x2ZWRVcmwoaW50KHN5cy5hcmd2WzFdKSwgVHJ1ZSwgbGlzdGl0ZW0pCiMgLS0tLS0tLS0tLS0tLS0gIEZJTSBORVRDSU5FCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMJCQkJCQkJCUZVTkNPRVMgSkEgRkVJVEFTCQkJCQkJCQkgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwpkZWYgYWRkRGlyKG5hbWUsdXJsLG1vZGUsZXN0aWxvLGljb25pbWFnZSx0aXBvLGZhbmFydCxwYXN0YT1UcnVlLHRvdGFsPTEpOgoJdHJ5OgoJCW5hbWUgPSBuYW1lLmVuY29kZSgndXRmLTgnKQoJZXhjZXB0OgoJCW5hbWUgPSBuYW1lCglpZih0aXBvID09ICdsaW1wYXJjYWNoZScgYW5kIHRpcG8gPT0gJ2xpbXBhcnR1ZG8nKToJCQkJCgkJdT1zeXMuYXJndlswXSsiP3VybD0iK3VybGxpYi5xdW90ZV9wbHVzKHVybCkrIiZtb2RlPSIrc3RyKG1vZGUpCgllbHNlOgoJCXU9c3lzLmFyZ3ZbMF0rIj91cmw9Iit1cmxsaWIucXVvdGVfcGx1cyh1cmwpKyImbW9kZT0iK3N0cihtb2RlKSsiJm5hbWU9Iit1cmxsaWIucXVvdGVfcGx1cyhuYW1lKSsiJmVzdGlsbz0iK3VybGxpYi5xdW90ZV9wbHVzKGVzdGlsbykrIiZmYW5hcnQ9IitzdHIoZmFuYXJ0KQoJb2s9VHJ1ZQoJbGl6PXhibWNndWkuTGlzdEl0ZW0obmFtZSwgaWNvbkltYWdlPWljb25pbWFnZSwgdGh1bWJuYWlsSW1hZ2U9aWNvbmltYWdlKQoJbGl6LnNldFByb3BlcnR5KCdmYW5hcnRfaW1hZ2UnLCBmYW5hcnQpCglsaXouc2V0QXJ0KHsnZmFuYXJ0JzogZmFuYXJ0fSkKCW9rPXhibWNwbHVnaW4uYWRkRGlyZWN0b3J5SXRlbShoYW5kbGU9aW50KHN5cy5hcmd2WzFdKSx1cmw9dSxsaXN0aXRlbT1saXosaXNGb2xkZXI9cGFzdGEsdG90YWxJdGVtcz10b3RhbCkKCXJldHVybiBvawoKZGVmIGFkZERpcjIobmFtZSx1cmwsbW9kZSxtb2RlMixpY29uaW1hZ2UscGFnaW5hPTEsdGlwbz1Ob25lLGluZm9MYWJlbHM9Tm9uZSxwb3N0ZXI9Tm9uZSx2aXN0bz1GYWxzZSk6CglpZiBpbmZvTGFiZWxzOiBpbmZvTGFiZWxzQXV4ID0gaW5mb0xhYmVscwoJZWxzZTogaW5mb0xhYmVsc0F1eCA9IHsnVGl0bGUnOiBuYW1lfQoJZmFuYXJ0ID0gJycKCWlmIHBvc3RlcjogZmFuYXJ0ID0gcG9zdGVyCgllbHNlOiBmYW5hcnQgPSBpY29uaW1hZ2UKCQoJdHJ5OgoJCW5hbWUgPSBuYW1lLmVuY29kZSgndXRmLTgnKQoJZXhjZXB0OgoJCW5hbWUgPSBuYW1lCgoJdT1zeXMuYXJndlswXSsiP3VybD0iK3VybGxpYi5xdW90ZV9wbHVzKHVybCkrIiZtb2RvPSIrbW9kZTIrIiZtb2RlPSIrc3RyKG1vZGUpKyImbmFtZT0iK3VybGxpYi5xdW90ZV9wbHVzKG5hbWUpCgkKCW9rPVRydWUKCgkjZmFuYXJ0ID0gX19GQU5BUlRfXwoKCWlmIHRpcG8gPT0gJ2ZpbG1lJzoKCQkjZmFuYXJ0ID0gcG9zdGVyQXV4CgkJeGJtY3BsdWdpbi5zZXRDb250ZW50KGludChzeXMuYXJndlsxXSksICdNb3ZpZXMnKQoJZWxpZiB0aXBvID09ICdzZXJpZSc6CgkJI2ZhbmFydCA9IHBvc3RlckF1eAoJCXhibWNwbHVnaW4uc2V0Q29udGVudChpbnQoc3lzLmFyZ3ZbMV0pLCAndHZzaG93cycpCgllbGlmIHRpcG8gPT0gJ2VwaXNvZGlvJzoKCQkjZmFuYXJ0ID0gcG9zdGVyQXV4CgkJeGJtY3BsdWdpbi5zZXRDb250ZW50KGludChzeXMuYXJndlsxXSksICdlcGlzb2RlcycpCgllbHNlOgoJCWlmIG5hbWUgIT0gJ1JlZnJlc2gnOgoJCQl4Ym1jcGx1Z2luLnNldENvbnRlbnQoaW50KHN5cy5hcmd2WzFdKSwgJ01vdmllcycpCgkKCW92ZXJsYXkgPSA2CglwbGF5Y291bnQgPSAwCgkKCWluZm9MYWJlbHNBdXhbIm92ZXJsYXkiXSA9IG92ZXJsYXkKCWluZm9MYWJlbHNBdXhbInBsYXljb3VudCJdID0gcGxheWNvdW50CgkKCWxpej14Ym1jZ3VpLkxpc3RJdGVtKG5hbWUsIGljb25JbWFnZT1pY29uaW1hZ2UsIHRodW1ibmFpbEltYWdlPWljb25pbWFnZSkKCWxpei5zZXRQcm9wZXJ0eSgnZmFuYXJ0X2ltYWdlJywgZmFuYXJ0KQoJbGl6LnNldEFydCh7J2ZhbmFydCc6IGZhbmFydH0pCglsaXouc2V0SW5mbyggdHlwZT0iVmlkZW8iLCBpbmZvTGFiZWxzPWluZm9MYWJlbHNBdXggKQoKCW9rPXhibWNwbHVnaW4uYWRkRGlyZWN0b3J5SXRlbShoYW5kbGU9aW50KHN5cy5hcmd2WzFdKSx1cmw9dSxsaXN0aXRlbT1saXosaXNGb2xkZXI9VHJ1ZSkKCXJldHVybiBvawoKZGVmIGFkZExpbmtDYW5hbChuYW1lLHVybCxpY29uaW1hZ2UsaWRjYW5hbCxpZF9wKToKCWluZm9MYWJlbHNzc3MgPSB7InRpdGxlIjogbmFtZSwgImdlbnJlIjogJ0FsbCd9Cglvaz1UcnVlCgljbT1bXQoJCglpZihpZGNhbmFsICE9ICcwMDAxJyk6CgkJY20uYXBwZW5kKCgnVmVyIHByb2dyYW1hw6fDo28nLCAnWEJNQy5SdW5QbHVnaW4oJXM/bW9kZT0zMSZuYW1lPSVzJnVybD0lcyZpY29uaW1hZ2U9JXMmaWRDYW5hbD0lcyZpZGZmQ2FuYWw9JXMpJyUoc3lzLmFyZ3ZbMF0sdXJsbGliLnF1b3RlX3BsdXMobmFtZSksIHVybGxpYi5xdW90ZV9wbHVzKHVybCksIHVybGxpYi5xdW90ZV9wbHVzKGljb25pbWFnZSksIGlkQ2FuYWwsIGlkX3ApKSkKCQoJbGl6ID0geGJtY2d1aS5MaXN0SXRlbShuYW1lLCBpY29uSW1hZ2U9aWNvbmltYWdlLCB0aHVtYm5haWxJbWFnZT1pY29uaW1hZ2UpCglsaXouc2V0SW5mbyggdHlwZT0iVmlkZW8iLCBpbmZvTGFiZWxzPWluZm9MYWJlbHNzc3MpCglsaXouYWRkQ29udGV4dE1lbnVJdGVtcyhjbSwgcmVwbGFjZUl0ZW1zPUZhbHNlKQoJbGl6LnNldFByb3BlcnR5KCdJc1BsYXlhYmxlJywgJ3RydWUnKQoJbGl6LnNldFByb3BlcnR5KCdmYW5hcnRfaW1hZ2UnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fdHYucG5nJykpCglsaXouc2V0QXJ0KHsnZmFuYXJ0Jzogb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3R2LnBuZycpfSkKCXUgPSBzeXMuYXJndlswXSArICI/dXJsPSIgKyB1cmxsaWIucXVvdGVfcGx1cyh1cmwpICsgIiZtb2RlPTExJm5hbWU9IiArIHVybGxpYi5xdW90ZV9wbHVzKG5hbWUpICsgIiZpY29uaW1hZ2U9IiArIHVybGxpYi5xdW90ZV9wbHVzKGljb25pbWFnZSkrIiZzdHJlYW1faWQ9IitzdHIoaWRjYW5hbCkKCW9rPXhibWNwbHVnaW4uYWRkRGlyZWN0b3J5SXRlbShoYW5kbGU9aW50KHN5cy5hcmd2WzFdKSwgdXJsPXUsIGxpc3RpdGVtPWxpeikKCXJldHVybiBvawoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMJCQkJCQkJCQkJCQkJRVBHCQkJCQkJCQkJCQkJCSAjCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwpkZWYgb2J0ZXJfZmljaGVpcm9fZXBnKCk6CglfX0VQR19fID0gX19BRERPTl9fLmdldFNldHRpbmcoImxpc3RhX2VwZyIpCglpZiBub3QgeGJtY3Zmcy5leGlzdHMoX19GT0xERVJfRVBHX18pOgoJCXhibWN2ZnMubWtkaXJzKF9fRk9MREVSX0VQR19fKQoKCXVuY29tcHJlc3NlZF9wYXRoID0gb3MucGF0aC5qb2luKF9fRk9MREVSX0VQR19fLCAnZXBnLnhtbCcpCgl1cmwgPSB1cmxsaWIudXJsb3BlbihfX0VQR19fKQoJY29kaWdvID0gdXJsLnJlYWQoKQoJdXJsLmNsb3NlCgkKCW9wZW4odW5jb21wcmVzc2VkX3BhdGgsICd3Jykud3JpdGUoY29kaWdvKQoKZGVmIGdldFByb2dyYW1hY2FvRGlhcmlhKGlkQ2FuYWwsIGRpYWhvcmEsIGNvZGlnbyk6Cglzb3VyY2UgPSByZS5jb21waWxlKCc8cHJvZ3JhbW1lIHN0YXJ0PSIoLis/KSBcKzAxMDAiIHN0b3A9IiguKz8pIFwrMDEwMCIgY2hhbm5lbD0iJytpZENhbmFsKyciPlxzKzx0aXRsZSBsYW5nPSJwdCI+KC4rPyk8XC90aXRsZT4nKS5maW5kYWxsKGNvZGlnbykKCglwcm9ncmFtYSA9ICcnCgoJZm9yIHN0YXJ0LCBzdG9wLCBwcm9ncmFtYTEgIGluIHNvdXJjZToKCgkJaWYoaW50KHN0YXJ0KSA8IGRpYWhvcmEgYW5kIGludChzdG9wKSA+IGRpYWhvcmEpOgoJCQlwcm9ncmFtYSA9IHByb2dyYW1hMQoJcmV0dXJuIHByb2dyYW1hCgoKZGVmIHByb2dyYW1hY2FvX2NhbmFsKGlkQ2FuYWwpOgoJX19FUEdfXyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJsaXN0YV9lcGciKQoJdXJsID0gdXJsbGliLnVybG9wZW4oX19FUEdfXykKCWNvZGlnbyA9IHVybC5yZWFkKCkKCXVybC5jbG9zZQoJCgl0cyA9IHRpbWUudGltZSgpCglzdCA9IGludChkYXRldGltZS5kYXRldGltZS5mcm9tdGltZXN0YW1wKHRzKS5zdHJmdGltZSgnJVklbSVkJykpCgoJZGlhaG9yYSA9IGludChzdHIoc3QpKycwNjAwMDAnKQoJZGlhYW1hbmhhID0gaW50KHN0cihzdCsxKSsnMDYwMDAwJykKCglzb3VyY2UgPSByZS5jb21waWxlKCc8cHJvZ3JhbW1lIHN0YXJ0PSIoLis/KSBcKzAxMDAiIHN0b3A9IiguKz8pIFwrMDEwMCIgY2hhbm5lbD0iJytpZENhbmFsKyciPlxzKzx0aXRsZSBsYW5nPSJwdCI+KC4rPyk8XC90aXRsZT4nKS5maW5kYWxsKGNvZGlnbykKCglwcm9ncmFtYSA9ICcnCgoJdGl0bGVzPVsnW0JdW0NPTE9SIHdoaXRlXVByb2dyYW1hw6fDo286Wy9DT0xPUl1bL0JdJ10KCgkKCWZvciBzdGFydCwgc3RvcCwgcHJvZ3JhbWExIGluIHNvdXJjZToKCgkJc3RhcnQxID0gcmUuY29tcGlsZSgnKFswLTldezR9WzAtMV1bMC05XVswLTNdWzAtOV0pKFswLTldezJ9KShbMC05XXsyfSkoWzAtOV17Mn0pJykuZmluZGFsbChzdGFydCkKCQlzdG9wMSA9IHJlLmNvbXBpbGUoJyhbMC05XXs0fVswLTFdWzAtOV1bMC0zXVswLTldKShbMC05XXsyfSkoWzAtOV17Mn0pKFswLTldezJ9KScpLmZpbmRhbGwoc3RvcCkKCgkJaWYoaW50KHN0YXJ0KSA+IGRpYWhvcmEgYW5kIGludChzdGFydCkgPCBkaWFhbWFuaGEgKToKCQkJdGl0bGVzLmFwcGVuZCgnXG5bQl0lczolcyAtPiAlczolc1svQl0gLSAlcycgJSAoc3RhcnQxWzBdWzFdLCBzdGFydDFbMF1bMl0sIHN0b3AxWzBdWzFdLCBzdG9wMVswXVsyXSwgcHJvZ3JhbWExKSkKCgoJcHJvZ3JhbWFjYW8gPSAnXG4nLmpvaW4odGl0bGVzKQoJdHJ5OgoJCXhibWMuZXhlY3V0ZWJ1aWx0aW4oIkFjdGl2YXRlV2luZG93KDEwMTQ3KSIpCgkJd2luZG93ID0geGJtY2d1aS5XaW5kb3coMTAxNDcpCgkJeGJtYy5zbGVlcCgxMDApCgkJd2luZG93LmdldENvbnRyb2woMSkuc2V0TGFiZWwoQWRkb25UaXRsZSkKCQl3aW5kb3cuZ2V0Q29udHJvbCg1KS5zZXRUZXh0KHByb2dyYW1hY2FvKQoJZXhjZXB0OgoJCXBhc3MKCmRlZiBhYnJpcl91cmwodXJsLCBwb3N0PU5vbmUsIGhlYWRlcj1Ob25lLCBjb2RlPUZhbHNlLCBlcnJvPUZhbHNlLCBjb29raWU9Tm9uZSk6CglpZiBoZWFkZXIgPT0gTm9uZToKCQloZWFkZXIgPSBoZWFkZXJzCglpZiBjb29raWU6CgkJaGVhZGVyWydDb29raWUnXSA9IGNvb2tpZQoJCglpZiBwb3N0OgoJCWhlYWRlclsnQ29udGVudC1UeXBlJ10gPSdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnCgkJcmVxID0gdXJsbGliMi5SZXF1ZXN0KHVybCwgZGF0YT1wb3N0LCBoZWFkZXJzPWhlYWRlcikKCWVsc2U6CgkJcmVxID0gdXJsbGliMi5SZXF1ZXN0KHVybCwgaGVhZGVycz1oZWFkZXIpCgl0cnk6CgkJcmVzcG9uc2UgPSB1cmxsaWIyLnVybG9wZW4ocmVxLGNvbnRleHQ9Y29udGV4dCkKCWV4Y2VwdDoKCQl0cnk6CgkJCXJlc3BvbnNlID0gdXJsbGliMi51cmxvcGVuKHJlcSkKCQlleGNlcHQgdXJsbGliMi5IVFRQRXJyb3IgYXMgcmVzcG9uc2U6CgkJCWlmIGVycm8gPT0gVHJ1ZToKCQkJCXJldHVybiBzdHIocmVzcG9uc2UuY29kZSksICJhc2QiCglsaW5rPXJlc3BvbnNlLnJlYWQoKQoJCglpZiAnanVkaWNpYWwgYmxibGJsYmxibCcgaW4gbGluazoKCQlyZXR1cm4gJ0ROUycKCWlmIGNvZGU6CgkJcmV0dXJuIHN0cihyZXNwb25zZS5jb2RlKSwgbGluawoKCXJlc3BvbnNlLmNsb3NlKCkKCXJldHVybiBsaW5rCgpkZWYgYWRkTGluazIobmFtZSx1cmwsaWNvbmltYWdlKToKCW9rPVRydWUKCWxpeiA9IHhibWNndWkuTGlzdEl0ZW0obmFtZSwgaWNvbkltYWdlPWljb25pbWFnZSwgdGh1bWJuYWlsSW1hZ2U9aWNvbmltYWdlKQoJbGl6LnNldFByb3BlcnR5KCdmYW5hcnRfaW1hZ2UnLCBpY29uaW1hZ2UpCglsaXouc2V0QXJ0KHsnZmFuYXJ0JzogaWNvbmltYWdlfSkKCWxpei5zZXRJbmZvKCB0eXBlPSJWaWRlbyIsIGluZm9MYWJlbHM9eyAiVGl0bGUiOiBuYW1lIH0pCglsaXouc2V0UHJvcGVydHkoJ0lzUGxheWFibGUnLCAndHJ1ZScpCgl1ID0gc3lzLmFyZ3ZbMF0gKyAiP3VybD0iICsgdXJsICsgIiZtb2RlPTEwNiZuYW1lPSIgKyBuYW1lICsgIiZpY29uaW1hZ2U9IiArIGljb25pbWFnZQoJb2s9eGJtY3BsdWdpbi5hZGREaXJlY3RvcnlJdGVtKGhhbmRsZT1pbnQoc3lzLmFyZ3ZbMV0pLCB1cmw9dSwgbGlzdGl0ZW09bGl6KQoJcmV0dXJuIG9rCgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwkJCQkJCQkgIERFRklOSU5DT0VTCQkJCQkJCQkJCSAgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwkKCmRlZiB2aXN0YV9HcnVwb3MoKToKCW9wY2FvID0gX19BRERPTl9fLmdldFNldHRpbmcoJ2NhbmFpc1ZpZXcnKQoJaWYgb3BjYW8gPT0gJzAnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTApIikKCWVsaWYgb3BjYW8gPT0gJzEnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTEpIikKCWVsaWYgb3BjYW8gPT0gJzInOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTAwKSIpCgllbGlmIG9wY2FvID09ICczJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwOSkiKQoJZWxpZiBvcGNhbyA9PSAnMyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDgpIikKCWVsaWYgb3BjYW8gPT0gJzQnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA0KSIpCgllbGlmIG9wY2FvID09ICc1JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwMykiKQoJZWxpZiBvcGNhbyA9PSAnNic6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MTUpIikKCWVsaWYgb3BjYW8gPT0gJzcnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTUpIikKCmRlZiB2aXN0YV9DYW5haXMoKToKCW9wY2FvID0gX19BRERPTl9fLmdldFNldHRpbmcoJ2NhbmFpc1ZpZXcyJykKCWlmIG9wY2FvID09ICcwJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwKSIpCgllbGlmIG9wY2FvID09ICcxJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUxKSIpCgllbGlmIG9wY2FvID09ICcyJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwMCkiKQoJZWxpZiBvcGNhbyA9PSAnMyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDkpIikKCWVsaWYgb3BjYW8gPT0gJzMnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA4KSIpCgllbGlmIG9wY2FvID09ICc0JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwNCkiKQoJZWxpZiBvcGNhbyA9PSAnNSc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDMpIikKCWVsaWYgb3BjYW8gPT0gJzYnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTE1KSIpCgllbGlmIG9wY2FvID09ICc3JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDU1KSIpCgpkZWYgdmlzdGFfbWVudSgpOgoJb3BjYW8gPSBfX0FERE9OX18uZ2V0U2V0dGluZygnbWVudVZpZXcnKQoJaWYgb3BjYW8gPT0gJzAnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTApIikKCWVsaWYgb3BjYW8gPT0gJzEnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTEpIikKCWVsaWYgb3BjYW8gPT0gJzInOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTAwKSIpCgllbGlmIG9wY2FvID09ICczJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwOSkiKQoJZWxpZiBvcGNhbyA9PSAnMyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDgpIikKCWVsaWYgb3BjYW8gPT0gJzQnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA0KSIpCgllbGlmIG9wY2FvID09ICc1JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwMykiKQoJZWxpZiBvcGNhbyA9PSAnNic6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MTUpIikKCWVsaWYgb3BjYW8gPT0gJzcnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTUpIikKCmRlZiB2aXN0YV9maWxtZXNTZXJpZXMoKToKCW9wY2FvID0gX19BRERPTl9fLmdldFNldHRpbmcoJ2ZpbG1lc1Nlcmllc1ZpZXcnKQoJaWYgb3BjYW8gPT0gJzAnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTApIikKCWVsaWYgb3BjYW8gPT0gJzEnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTEpIikKCWVsaWYgb3BjYW8gPT0gJzInOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTAwKSIpCgllbGlmIG9wY2FvID09ICczJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwOSkiKQoJZWxpZiBvcGNhbyA9PSAnMyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDgpIikKCWVsaWYgb3BjYW8gPT0gJzQnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA0KSIpCgllbGlmIG9wY2FvID09ICc1JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwMykiKQoJZWxpZiBvcGNhbyA9PSAnNic6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MTUpIikKCWVsaWYgb3BjYW8gPT0gJzcnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTUpIikKCgpkZWYgdmlzdGFfdGVtcG9yYWRhcygpOgoJb3BjYW8gPSBfX0FERE9OX18uZ2V0U2V0dGluZygndGVtcG9yYWRhc1ZpZXcnKQoJaWYgb3BjYW8gPT0gJzAnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTApIikKCWVsaWYgb3BjYW8gPT0gJzEnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTEpIikKCWVsaWYgb3BjYW8gPT0gJzInOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTAwKSIpCgllbGlmIG9wY2FvID09ICczJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwOSkiKQoJZWxpZiBvcGNhbyA9PSAnMyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDgpIikKCWVsaWYgb3BjYW8gPT0gJzQnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA0KSIpCgllbGlmIG9wY2FvID09ICc1JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwMykiKQoJZWxpZiBvcGNhbyA9PSAnNic6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MTUpIikKCWVsaWYgb3BjYW8gPT0gJzcnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTUpIikKCmRlZiB2aXN0YV9lcGlzb2Rpb3MoKToKCXhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MCkiKQoJI29wY2FvID0gX19BRERPTl9fLmdldFNldHRpbmcoJ2VwaXNvZGlvc1ZpZXcnKQoJaWYgb3BjYW8gPT0gJzAnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTApIikKCWVsaWYgb3BjYW8gPT0gJzEnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTEpIikKCWVsaWYgb3BjYW8gPT0gJzInOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTAwKSIpCgllbGlmIG9wY2FvID09ICczJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwOSkiKQoJZWxpZiBvcGNhbyA9PSAnMyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDgpIikKCWVsaWYgb3BjYW8gPT0gJzQnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA0KSIpCgllbGlmIG9wY2FvID09ICc1JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwMykiKQoJZWxpZiBvcGNhbyA9PSAnNic6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MTUpIikKCWVsaWYgb3BjYW8gPT0gJzcnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTUpIikKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMJCQkJCQkJCQkJCQlHRVQgUEFSQU1TCQkJCQkJCQkJCQkJICMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCQkgIApkZWYgZ2V0X3BhcmFtcygpOgoJcGFyYW09W10KCXBhcmFtc3RyaW5nPXN5cy5hcmd2WzJdCglpZiBsZW4ocGFyYW1zdHJpbmcpPj0yOgoJCXBhcmFtcz1zeXMuYXJndlsyXQoJCWNsZWFuZWRwYXJhbXM9cGFyYW1zLnJlcGxhY2UoJz8nLCcnKQoJCWlmIChwYXJhbXNbbGVuKHBhcmFtcyktMV09PScvJyk6IHBhcmFtcz1wYXJhbXNbMDpsZW4ocGFyYW1zKS0yXQoJCXBhaXJzb2ZwYXJhbXM9Y2xlYW5lZHBhcmFtcy5zcGxpdCgnJicpCgkJcGFyYW09e30KCQlmb3IgaSBpbiByYW5nZShsZW4ocGFpcnNvZnBhcmFtcykpOgoJCQlzcGxpdHBhcmFtcz17fQoJCQlzcGxpdHBhcmFtcz1wYWlyc29mcGFyYW1zW2ldLnNwbGl0KCc9JykKCQkJaWYgKGxlbihzcGxpdHBhcmFtcykpPT0yOiBwYXJhbVtzcGxpdHBhcmFtc1swXV09c3BsaXRwYXJhbXNbMV0KCXJldHVybiBwYXJhbQoKCnBhcmFtcz1nZXRfcGFyYW1zKCkKdXJsPU5vbmUKYnVpbGR0aXBvPU5vbmUKbmFtZT1Ob25lCm1vZGU9Tm9uZQptb2RvPU5vbmUKaWNvbmltYWdlPU5vbmUKbGluaz1Ob25lCnNlbmhhPU5vbmUKZXN0aWxvPU5vbmUKc3J0ZmlsbT1Ob25lCmlkQ2FuYWw9Tm9uZQppZGZmQ2FuYWw9Tm9uZQp0aXBvbG9naWE9Tm9uZQpkZXNjcmljYW89Tm9uZQp0aXBvX3VzZXI9Tm9uZQpzZXJ2aWRvcl91c2VyPU5vbmUKZGF0YV91c2VyPU5vbmUKc19zZXJ2PU5vbmUKdGlwbz1Ob25lCnNfdXNlcj1Ob25lCnNfcGFzcz1Ob25lCmxlZ2VuZGE9Tm9uZQpwYWdpbmE9Tm9uZQp0ZW1wb3JhZGE9Tm9uZQplcGlzb2Rpbz1Ob25lCnNlcmllTm9tZT1Ob25lCmZhbmFydD1Ob25lCnRodW1ibmFpbD1Ob25lCnN0cmVhbV9pZD1Ob25lCmR1cmF0aW9uPU5vbmUKdGlwb3NlbGVjdD1Ob25lCmJhY2tncm91bmQ9Tm9uZQppbmZvPU5vbmUKbG9nb3M9Tm9uZQpjYWNoZT1Ob25lCmluZGV4PU5vbmUKbW92ZT1Ob25lCm1ldGFoPU5vbmUKcGxvdD1Ob25lCgp0cnk6IAoJbG9nb3M9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImxvZ29zIl0pCmV4Y2VwdDogCglwYXJhbXMgPSBkaWN0KHVybHBhcnNlLnBhcnNlX3FzbChzeXMuYXJndlsyXS5yZXBsYWNlKCc/JywnJykpKQoJbG9nb3MgPSBwYXJhbXMuZ2V0KCdsb2dvcycsICcnKQoKdHJ5OiAKCWNhY2hlPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJjYWNoZSJdKQpleGNlcHQ6IAoJcGFyYW1zID0gZGljdCh1cmxwYXJzZS5wYXJzZV9xc2woc3lzLmFyZ3ZbMl0ucmVwbGFjZSgnPycsJycpKSkKCWNhY2hlID0gcGFyYW1zLmdldCgnY2FjaGUnLCAnJykKCnRyeTogCglpbmRleD11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1siaW5kZXgiXSkKZXhjZXB0OiAKCXBhcmFtcyA9IGRpY3QodXJscGFyc2UucGFyc2VfcXNsKHN5cy5hcmd2WzJdLnJlcGxhY2UoJz8nLCcnKSkpCglpbmRleCA9IHBhcmFtcy5nZXQoJ2luZGV4JywgJycpCgp0cnk6IAoJbW92ZT11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sibW92ZSJdKQpleGNlcHQ6IAoJcGFyYW1zID0gZGljdCh1cmxwYXJzZS5wYXJzZV9xc2woc3lzLmFyZ3ZbMl0ucmVwbGFjZSgnPycsJycpKSkKCW1vdmUgPSBwYXJhbXMuZ2V0KCdtb3ZlJywgJycpCgp0cnk6IAoJbWV0YWg9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbIm1ldGFoIl0pCmV4Y2VwdDogCglwYXJhbXMgPSBkaWN0KHVybHBhcnNlLnBhcnNlX3FzbChzeXMuYXJndlsyXS5yZXBsYWNlKCc/JywnJykpKQoJbWV0YWggPSBwYXJhbXMuZ2V0KCdtZXRhaCcsICcnKQoKdHJ5OiAKCWJhY2tncm91bmQ9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImJhY2tncm91bmQiXSkKZXhjZXB0OiAKCXBhcmFtcyA9IGRpY3QodXJscGFyc2UucGFyc2VfcXNsKHN5cy5hcmd2WzJdLnJlcGxhY2UoJz8nLCcnKSkpCgliYWNrZ3JvdW5kID0gcGFyYW1zLmdldCgnYmFja2dyb3VuZCcsICcnKQoKdHJ5OiAKCWluZm89dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImluZm8iXSkKZXhjZXB0OiAKCXBhcmFtcyA9IGRpY3QodXJscGFyc2UucGFyc2VfcXNsKHN5cy5hcmd2WzJdLnJlcGxhY2UoJz8nLCcnKSkpCglpbmZvID0gcGFyYW1zLmdldCgnaW5mbycsICcnKQoKdHJ5OiB0aXBvPXBhcmFtc1sidGlwbyJdCmV4Y2VwdDogcGFzcwp0cnk6IGR1cmF0aW9uPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJkdXJhdGlvbiJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBzdHJlYW1faWQ9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbInN0cmVhbV9pZCJdKQpleGNlcHQ6IHBhc3MKdHJ5OiB1cmw9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbInVybCJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBuYW1lPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJuYW1lIl0pCmV4Y2VwdDogcGFzcwp0cnk6IGVzdGlsbz11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1siZXN0aWxvIl0pCmV4Y2VwdDogcGFzcwp0cnk6IG1vZGU9aW50KHBhcmFtc1sibW9kZSJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBtb2RvPXBhcmFtc1sibW9kbyJdCmV4Y2VwdDogcGFzcwp0cnk6IGljb25pbWFnZT11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1siaWNvbmltYWdlIl0pCmV4Y2VwdDogcGFzcwp0cnk6IHNlbmhhPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJzZW5oYSJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBpZENhbmFsPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJpZENhbmFsIl0pCmV4Y2VwdDogcGFzcwp0cnk6IGlkZmZDYW5hbD1wYXJhbXNbImlkZmZDYW5hbCJdCmV4Y2VwdDogcGFzcwp0cnk6IHNydGZpbG09dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbInNydGZpbG0iXSkKZXhjZXB0OiBwYXNzCnRyeTogdGlwb2xvZ2lhPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJ0aXBvbG9naWEiXSkKZXhjZXB0OiBwYXNzCnRyeTogZGVzY3JpY2FvPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJkZXNjcmljYW8iXSkKZXhjZXB0OiBwYXNzCnRyeTogdGlwb191c2VyPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJ0aXBvX3VzZXIiXSkKZXhjZXB0OiBwYXNzCnRyeTogc2Vydmlkb3JfdXNlcj11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sic2Vydmlkb3JfdXNlciJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBzX3NlcnY9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImxvbHNlcnYiXSkKZXhjZXB0OiBwYXNzCnRyeTogc191c2VyPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJsb2x1c2VyIl0pCmV4Y2VwdDogcGFzcwp0cnk6IHNfcGFzcz11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sibG9scGFzcyJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBsaW5rPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJsaW5rIl0pCmV4Y2VwdDogcGFzcwp0cnk6IGxlZ2VuZGE9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImxlZ2VuZGEiXSkKZXhjZXB0OiBwYXNzCnRyeTogbmFtZT11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sibmFtZSJdKQpleGNlcHQ6IHBhc3MKdHJ5OiB0ZW1wb3JhZGE9aW50KHBhcmFtc1sidGVtcG9yYWRhIl0pCmV4Y2VwdDogcGFzcwp0cnk6IGVwaXNvZGlvPWludChwYXJhbXNbImVwaXNvZGlvIl0pCmV4Y2VwdDogcGFzcwp0cnk6IG1vZGU9aW50KHBhcmFtc1sibW9kZSJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBwYWdpbmE9aW50KHBhcmFtc1sicGFnaW5hIl0pCmV4Y2VwdDogcGFzcwp0cnk6IGljb25pbWFnZT11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1siaWNvbmltYWdlIl0pCmV4Y2VwdDogcGFzcwp0cnkgOiBzZXJpZU5vbWU9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbInNlcmllTm9tZSJdKQpleGNlcHQ6IHBhc3MKdHJ5IDogYnVpbGR0aXBvPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJidWlsZHRpcG8iXSkKZXhjZXB0OiBwYXNzCnRyeSA6IGZhbmFydD11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1siZmFuYXJ0Il0pCmV4Y2VwdDogcGFzcwp0cnkgOiBwbG90PXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJwbG90Il0pCmV4Y2VwdDogcGFzcwp0cnkgOiB0aHVtYm5haWw9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbInRodW1ibmFpbCJdKQpleGNlcHQ6IHBhc3MKdHJ5IDogZGF0YV91c2VyPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJkYXRhX3VzZXIiXSkKZXhjZXB0OiBwYXNzCnRyeSA6IHRpcG9zZWxlY3Q9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbInRpcG9zZWxlY3QiXSkKZXhjZXB0OiBwYXNzCgoKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCQkJCQkJCQkJCQkJCU1PRE9TCQkJCQkJCQkJCQkJCSAjCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwppZiBtb2RlPT1Ob25lIG9yIHVybD09Tm9uZSBvciBsZW4odXJsKTwxOiBtZW51KCkKZWxpZiBtb2RlPT0xOiBhYnJpclZpZGVvQ2x1YmUoc3RyKHVybCkpCmVsaWYgbW9kZT09MTAxOiBsaXN0YXJfZ3J1cG9zMShtb2RlLHVybCxmYW5hcnQpCmVsaWYgbW9kZT09MTAyOiBsaXN0YXJfZ3J1cG9zMihtb2RlLHVybCxmYW5hcnQpCmVsaWYgbW9kZT09MTAzOiBsaXN0YXJfZ3J1cG9zMyhtb2RlLHVybCxmYW5hcnQpCmVsaWYgbW9kZT09MTA0OiBsaXN0YXJfZ3J1cG9zNChtb2RlLHVybCxpY29uaW1hZ2UsZmFuYXJ0KQplbGlmIG1vZGU9PTEwNjogYWJyaXJFeHRyYXMoKQplbGlmIG1vZGU9PTEwNzogbGlzdGFyX2dydXBvczUobW9kZSx1cmwsZmFuYXJ0KQplbGlmIG1vZGU9PTEwODogbGlzdGFyX2dydXBvczYobW9kZSx1cmwsaWNvbmltYWdlLGZhbmFydCkKZWxpZiBtb2RlPT0xMDk6IHBsYXlfbXVsdF9jYW5hbDIodXJsLGljb25pbWFnZSxzdHIobmFtZSkpCmVsaWYgbW9kZT09MjogQWJyaXJfQ29udGEoc3RyKHVybCkpCmVsaWYgbW9kZT09MzogYWJyaW0zdShzdHIodXJsKSkKZWxpZiBtb2RlPT00OiBkZXRlY3RfbW9kaWZpY2F0aW9uKHN0cih1cmwpKQplbGlmIG1vZGU9PTU6IGFicmlyRGVmaW5pbmNvZXMoKQplbGlmIG1vZGU9PTY6IGxpc3RhdHZhcmNoaXZlKHN0cih1cmwpKQplbGlmIG1vZGU9PTc6IGxpc3RhdHZhcmNoaXZlY2FuYWlzKHN0cihuYW1lKSxzdHJlYW1faWQsc3RyKHVybCksZHVyYXRpb24saWNvbmltYWdlLGZhbmFydCkKZWxpZiBtb2RlPT04OiBzdHJlYW1fdmlkZW8obmFtZSx1cmwsaWNvbmltYWdlKQplbGlmIG1vZGU9PTk6IGdldF9teWFjY291bnQobmFtZSx1cmwsaWNvbmltYWdlKQplbGlmIG1vZGU9PTEwOiBydW5fY3JvbmpvYihuYW1lLHN0cih1cmwpLGljb25pbWFnZSxwbG90LGZhbmFydCkKZWxpZiBtb2RlPT0xMTogUGxheVVybChuYW1lLHVybCxpY29uaW1hZ2UpCmVsaWYgbW9kZT09MTM6IENMRUFSQ0FDSEUoKQplbGlmIG1vZGU9PTE0OiBQVVJHRVBBQ0tBR0VTKCkKZWxpZiBtb2RlPT0yMDogbGlzdGFtZW51c3NlcmllcyhzdHIobmFtZSksc3RyKHVybCksZXN0aWxvLHRpcG9sb2dpYSx0aXBvX3VzZXIsc2Vydmlkb3JfdXNlcixpY29uaW1hZ2UsZmFuYXJ0KQplbGlmIG1vZGU9PTIxOiBsaXN0YW1lbnVzZmlsbWVzKHN0cihuYW1lKSxzdHIodXJsKSxlc3RpbG8sdGlwb2xvZ2lhLHRpcG9fdXNlcixzZXJ2aWRvcl91c2VyLGljb25pbWFnZSxmYW5hcnQpCmVsaWYgbW9kZT09MjQ6IGxpc3RhbWVudXNhbmltZXMoc3RyKG5hbWUpLHN0cih1cmwpLGVzdGlsbyx0aXBvbG9naWEsdGlwb191c2VyLHNlcnZpZG9yX3VzZXIsaWNvbmltYWdlLGZhbmFydCkKZWxpZiBtb2RlPT0xMTExMTogZmlsbWVzMih1cmwpCmVsaWYgbW9kZT09MTExMTI6IHNlcmllczIodXJsKQplbGlmIG1vZGU9PTExMTEzOiBwbGF5ZXIyKG5hbWUsIHVybCwgaWNvbmltYWdlLCBtb2RvLCB0ZW1wb3JhZGEsIGVwaXNvZGlvLCB0aXBvKQplbGlmIG1vZGU9PTExMTE0OiBnZXRTZWFzb25zMih1cmwsIG1vZG8pCmVsaWYgbW9kZT09MTExMTU6IGdldEVwaXNvZGVzMih1cmwpCmVsaWYgbW9kZT09MTExMTg6IGdldFllYXJzX2xpdmUodXJsLCBtb2RvKQplbGlmIG1vZGU9PTExMTE5OiBnZXRHZW5lcm9zX2xpdmUodXJsLCBtb2RvKQplbGlmIG1vZGU9PTExMTE5OTogZ2V0R2VuZXJvczJfbGl2ZSh1cmwsIG1vZG8pCmVsaWYgbW9kZT09MTExMjA6IHBlc3F1aXNhX2xpdmUodXJsLCBtb2RvKQplbGlmIG1vZGU9PTExMTIxOiBnZXRJbmZvX2xpdmUodXJsLCBtb2RvKQplbGlmIG1vZGU9PTIxMTExOiBsaXN0YW1lbnVzX2xpdmVpdDEoKQplbGlmIG1vZGU9PTIxMTEyOiBsaXN0YW1lbnVzX2xpdmVpdDIoKQplbGlmIG1vZGU9PTExMTogZmlsbWVzKHVybCwgcGFnaW5hKQplbGlmIG1vZGU9PTEyMzogc2VyaWVzKHVybCkKZWxpZiBtb2RlPT0xMTg6IGdldEdlbmVyb3ModXJsKQplbGlmIG1vZGU9PTExOTogZ2V0WWVhcnModXJsKQplbGlmIG1vZGU9PTEyMDogcGVzcXVpc2EodXJsKQplbGlmIG1vZGU9PTEyMTogYW5vcyh1cmwpCmVsaWYgbW9kZT09MTIyOiBjYXRlZ29yaWFzKHVybCkKZWxpZiBtb2RlPT0xMTM6IHBsYXllcihuYW1lLCB1cmwsIGljb25pbWFnZSwgdGVtcG9yYWRhLCBlcGlzb2Rpbywgc2VyaWVOb21lKQplbGlmIG1vZGU9PTExNDogZ2V0U2Vhc29ucyh1cmwpCmVsaWYgbW9kZT09MTE1OiBnZXRFcGlzb2Rlcyh1cmwpCmVsaWYgbW9kZT09MTE3OiBkb3dubG9hZCh1cmwsIG5hbWUsIHRlbXBvcmFkYSwgZXBpc29kaW8sIHNlcmllTm9tZSkKZWxpZiBtb2RlPT0zMTogcHJvZ3JhbWFjYW9fY2FuYWwoaWRDYW5hbCkKZWxpZiBtb2RlID09IDMyOgoJUGxheVVybDIobmFtZSwgdXJsLCBpY29uaW1hZ2UpCgppZiBtb2RlPT1Ob25lIG9yIHVybD09Tm9uZSBvciBsZW4odXJsKTwxOgoJeGJtY3BsdWdpbi5lbmRPZkRpcmVjdG9yeShpbnQoc3lzLmFyZ3ZbMV0pLGNhY2hlVG9EaXNjPUZhbHNlKQplbHNlOgoJaWYgbW9kZSAhPTMgYW5kIG1vZGUgIT02IGFuZCBtb2RlICE9NzogCgkJeGJtY3BsdWdpbi5lbmRPZkRpcmVjdG9yeShpbnQoc3lzLmFyZ3ZbMV0pLGNhY2hlVG9EaXNjPUZhbHNlKQoJZWxzZTogCgkJeGJtY3BsdWdpbi5lbmRPZkRpcmVjdG9yeShpbnQoc3lzLmFyZ3ZbMV0pLGNhY2hlVG9EaXNjPVRydWUp"))