exec("import re;import base64");exec(base64.b64decode("IyMjIyMjIyMjIyMjIyNCSUJMSU9URUNBUyBBIElNUE9SVEFSIEUgREVGSU5JQ09FUyMjIyMjIyMjIyMjIyMjIyMjIyMjCmltcG9ydCB1cmxsaWIsdXJsbGliMixzeXMscmUseGJtY3BsdWdpbix4Ym1jZ3VpLHhibWNhZGRvbix4Ym1jLG9zLGpzb24sZ2xvYix0aHJlYWRpbmcsZ3ppcCx4Ym1jdmZzLGNvb2tpZWxpYixwcHJpbnQsZGF0ZXRpbWUsdGhyZWFkLHRpbWUsdXJscGFyc2UsYmFzZTY0LHBsdWdpbnRvb2xzLGNhbGVuZGFyCmltcG9ydCB4bWwuZXRyZWUuRWxlbWVudFRyZWUgYXMgRVQKaW1wb3J0IGZpbGVVdGlscyBhcyBmdQppbXBvcnQgYXN0CmZyb20gcmVzb3VyY2VzLmxpYiBpbXBvcnQgY29tbW9uCmZyb20gdXJsbGliMiBpbXBvcnQgUmVxdWVzdCwgdXJsb3Blbgpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRlCmZyb20gYnM0IGltcG9ydCBCZWF1dGlmdWxTb3VwCmZyb20gcmVzb3VyY2VzLmxpYiBpbXBvcnQgRG93bmxvYWRlciAjRW5lbjkyIGNsYXNzCmZyb20gcmVzb3VyY2VzLmxpYiBpbXBvcnQgUGxheWVyCmZyb20gcmVzb3VyY2VzLmxpYiBpbXBvcnQgVFZBcmNoaXZlCmZyb20gdDBtbTAuY29tbW9uLm5ldCBpbXBvcnQgTmV0CmZyb20gdDBtbTAuY29tbW9uLmFkZG9uIGltcG9ydCBBZGRvbgpmcm9tIHQwbW0wLmNvbW1vbi5uZXQgaW1wb3J0IEh0dHBSZXNwb25zZQpmcm9tIHJlc291cmNlcy5saWIgaW1wb3J0IFVSTFJlc29sdmVyTWVkaWEKZnJvbSByZXNvdXJjZXMubGliIGltcG9ydCBUcmFrdApmcm9tIHJlc291cmNlcy5saWIgaW1wb3J0IERhdGFiYXNlCmZyb20gdW5pY29kZWRhdGEgaW1wb3J0IG5vcm1hbGl6ZQp0cnk6CiAgICBpbXBvcnQgc3NsCiAgICBjb250ZXh0ID0gc3NsLlNTTENvbnRleHQoc3NsLlBST1RPQ09MX1RMU3YxKQpleGNlcHQ6CiAgICBwYXNzCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMgQ09OU1RBTlRFUyAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZ2xvYmFsIGdfdGltZXIKZ2xvYmFsIHRlbGV2aXNpb29uaWxpbmsKZ2xvYmFsIGZpbG1pbGluawpnbG9iYWwgYW5kbWVsaW5rCmdsb2JhbCB1dWVuZHVzbGluawpnbG9iYWwgdXVlbmR1c2VkCmdsb2JhbCB2YW5lbWFsdWtrCmdsb2JhbCB2ZXJzaW9uCmdsb2JhbCBtb2RlCgpyZWxvYWQoc3lzKQpzeXMuc2V0ZGVmYXVsdGVuY29kaW5nKCd1dGY4JykKbW9kZSA9IDMzMzMKdmVyc2lvbiA9ICIiCmthc3V0YWphbmltaSA9ICIiCnNhbGFzb25hID0gIiIKbGVoZWt5bGcgPSAiIgp2YW5lbWFrb29kID0gIiIKdmFuZW1hbHVrayA9ICIiCnRlbGV2aXNpb29uaWxpbmsgPSAiIgpmaWxtaWxpbmsgPSAiIgphbmRtZWxpbmsgPSAiIgoKX0xJSUxMXyA9ICJhSFIwY0RvdkwyeHBkbVZwZEd0dlpHa3VZMjl0TDFCSVVDOTJZV3hwWkdGMFpVRlFVQzV3YUhBPSIKX19BRERPTl9JRF9fCT0geGJtY2FkZG9uLkFkZG9uKCkuZ2V0QWRkb25JbmZvKCJpZCIpCl9fQURET05fXwk9IHhibWNhZGRvbi5BZGRvbihfX0FERE9OX0lEX18pCl9fQURET05WRVJTSU9OX18gPSBfX0FERE9OX18uZ2V0QWRkb25JbmZvKCd2ZXJzaW9uJykKQWRkb25UaXRsZSA9IF9fQURET05fXy5nZXRBZGRvbkluZm8oJ25hbWUnKQpETlNfREVGSU5FID0gJycKX19BRERPTl9GT0xERVJfXwk9IF9fQURET05fXy5nZXRBZGRvbkluZm8oJ3BhdGgnKQpfX1NFVFRJTkdfXwk9IHhibWNhZGRvbi5BZGRvbigpLmdldFNldHRpbmcKX19BUlRfRk9MREVSX18JPSBfX0FERE9OX0ZPTERFUl9fICsgJy9yZXNvdXJjZXMvaW1nLycKX19TS0lOX18gPSAndjInCl9fUXVhbGlkYWRlX18gPSBfX0FERE9OX18uZ2V0U2V0dGluZygncXVhbGlkYWRlRmlsbWVzJykKX19GQU5BUlRfXyA9IG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kby5wbmcnKQpfX1BBU1RBX0RBRE9TX18gPSBBZGRvbihfX0FERE9OX0lEX18pLmdldF9wcm9maWxlKCkuZGVjb2RlKCJ1dGYtOCIpCl9fQVBJX18gPSBiYXNlNjQudXJsc2FmZV9iNjRkZWNvZGUoJ2FIUjBjRG92TDIxd1lYQnBMbTFzTHc9PScpCl9fQVBJX1NJVEVfXyA9IGJhc2U2NC51cmxzYWZlX2I2NGRlY29kZSgnYUhSMGNEb3ZMMjF3WVhCcExtMXNMMkZ3YVc1bGR5OD0nKQpfX1NJVEVfXyA9IGJhc2U2NC51cmxzYWZlX2I2NGRlY29kZSgnYUhSMGNEb3ZMMjF5Y0dseVlXTjVMbWR4THc9PScpCl9fRk9MREVSX0VQR19fID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnZXBnbGl2ZW5vdycpCl9fQ09PS0lFX0ZJTEVfXyA9IG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ2xpdmVub3cnKQpfX1NJVEVBZGRvbl9fID0gYmFzZTY0LnVybHNhZmVfYjY0ZGVjb2RlKCdhSFIwY0RvdkwzZDNkeTV3WTNSbFkydHpaWEoyTG1OdmJTOUhjblZ3YjB0dlpHa3ZRV1JrYjI0dicpCl9JQ09OXyA9IG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29uLnBuZycpCl9fSEVBREVSU19fID0geydVc2VyLUFnZW50JzogJ01vemlsbGEvNS4wIChNYWNpbnRvc2g7IEludGVsIE1hYyBPUyBYIDEwLjExOyBydjo0My4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzQzLjAnLCAnQWNjZXB0JzogJ3RleHQvaHRtbCxhcHBsaWNhdGlvbi94aHRtbCt4bWwsYXBwbGljYXRpb24veG1sO3E9MC45LCovKjtxPTAuOCd9CmhlYWRlcnMgPSB7J1VzZXItQWdlbnQnOiAnTW96aWxsYS81LjAgKE1hY2ludG9zaDsgSW50ZWwgTWFjIE9TIFggMTAuMTE7IHJ2OjQzLjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvNDMuMCcsICdBY2NlcHQtQ2hhcnNldCc6ICd1dGYtODtxPTAuNywqO3E9MC43JywgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ30KCkNhdCA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJDYXQiKQpjT3JkTkNGID0gX19BRERPTl9fLmdldFNldHRpbmcoImNPcmROQ0YiKQpjT3JkTkNTID0gX19BRERPTl9fLmdldFNldHRpbmcoImNPcmROQ1MiKQoKQ2xpc3RhPVsgInRvZG9zIiwgImFjYW8iLCAiYW5pbWFjYW8iLCAiYXZlbnR1cmEiLCAiY29tZWRpYSIsICJkcmFtYSIsICJmYW50YXNpYSIsICJmaWNjYW8tY2llbnRpZmljYSIsICJyb21hbmNlIiwgInN1c3BlbnNlIiwgInRlcnJvciJdCkNsaXN0YTM9WyJTZW0gZmlsdHJvIChNb3N0cmFyIFRvZG9zKSIsIkHDp8OjbyIsICJBbmltYcOnw6NvIiwgIkF2ZW50dXJhIiwgIkNvbcOpZGlhIiwgIkRyYW1hIiwgIkZhbnRhc2lhIiwgIkZpY8Onw6NvLUNpZW50w61maWNhIiwgIlJvbWFuY2UiLCAiU3VzcGVuc2UiLCAiVGVycm9yIl0KCmRlZiBzZXRWaWV3UygpOgoJeGJtY3BsdWdpbi5zZXRDb250ZW50KGludChzeXMuYXJndlsxXSksICd0dnNob3dzJykKZGVmIHNldFZpZXdNKCk6Cgl4Ym1jcGx1Z2luLnNldENvbnRlbnQoaW50KHN5cy5hcmd2WzFdKSwgJ21vdmllcycpCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCQkJCQkJCSAgSW5pY2lhciBBZGRvbgkJCQkJCQkJCQkgICMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCmRlZiBfX0FMRVJUQV9fKHRleHQxPSIiLHRleHQyPSIiLHRleHQzPSIiKToKCWlmIHRleHQzPT0iIjogeGJtY2d1aS5EaWFsb2coKS5vayh0ZXh0MSx0ZXh0MikKCWVsaWYgdGV4dDI9PSIiOiB4Ym1jZ3VpLkRpYWxvZygpLm9rKCIiLHRleHQxKQoJZWxzZTogeGJtY2d1aS5EaWFsb2coKS5vayh0ZXh0MSx0ZXh0Mix0ZXh0MykKCmRlZiBjcmlhck1lbnUocGFpLG5vbWUsbG9nbyx1cmwsdGlwbyxmYW5hcnQpOgoJbWVudXMgPSB7CgkJCSdub21lJzogJycsCgkJCSdsb2dvJzogJycsCgkJCSd1cmwnOiAnJywKCQkJJ3RpcG8nOiAnJywKCQkJJ2ZhbmFydCc6ICcnCgkJCX0KCW1lbnVzWydub21lJ10gPSBub21lCgltZW51c1snbG9nbyddID0gbG9nbwoJbWVudXNbJ3VybCddID0gdXJsCgltZW51c1sndGlwbyddID0gdGlwbwoJbWVudXNbJ2ZhbmFydCddID0gZmFuYXJ0CglwYWkuYXBwZW5kKG1lbnVzKQoJCmRlZiBtZW51KCk6CglpZiAobm90IF9fQURET05fXy5nZXRTZXR0aW5nKCdsb2dpbl9uYW1lJykgb3Igbm90IF9fQURET05fXy5nZXRTZXR0aW5nKCdsb2dpbl9wYXNzd29yZCcpKToKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdQcmVjaXNhIGRlIGRlZmluaXIgbyBzZXUgVXRpbGl6YWRvciBlIFNlbmhhJykKCQlhYnJpckRlZmluaW5jb2VzKCkKCQkKCWVsc2U6CQoJCWNoZWNrX2xvZ2luMiA9IGxvZ2lucGFpbmVsKCkKCQlpZiBjaGVja19sb2dpbjJbJ3VzZXInXVsnRXJybyddICE9ICcnOgoJCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsIGNoZWNrX2xvZ2luMlsndXNlciddWydFcnJvJ10pCgkJZWxzZToKCQkJX0xJSUxMXyA9IGNoZWNrX2xvZ2luMlsndXNlciddWydETlMnXQoJCQljaGVja19sb2dpbiA9IGxvZ2luKF9MSUlMTF8pCgkJCWlmIGNoZWNrX2xvZ2luWyd1c2VyJ11bJ3VzZXJuYW1lJ10gIT0gJyc6CgkJCQlpZiBjaGVja19sb2dpblsndXNlciddWydlc3RhZG8nXSA9PSAnRXhwaXJlZCc6CgkJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnQSBzdWEgY29udGEgZXN0w6EgRXhwaXJhZGEuIFBvciBmYXZvciBmYcOnYSBhIHN1YSBSZW5vdmHDp8OjbyBvdSBSZWFjdGl2YcOnw6NvLicpCQkKCQkJCWVsc2U6CgkJCQkJaWYgY2hlY2tfbG9naW5bJ3VzZXInXVsndHJpYWwnXSA9PSAnWWVzJyBhbmQgY2hlY2tfbG9naW5bJ3VzZXInXVsnZGF0YSddICE9ICdOZXZlcic6CgkJCQkJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0EgY29udGEgw6kgdW1hIGNvbnRhIGRlIFRlc3RlLiBBcMOzcyBvIHRlc3RlIGUgZ29zdGFyIGZhw6dhIGEgc3VhIEFxdWlzacOnw6NvLicpCgkJCQkJaWYgY2hlY2tfbG9naW5bJ3VzZXInXVsnZGF0YSddICE9ICdOZXZlcicgYW5kIGNoZWNrX2xvZ2luWyd1c2VyJ11bJ3RyaWFsJ10gPT0gJ05vJzoKCQkJCQkJaWYgY2hlY2tfbG9naW5bJ3VzZXInXVsnZGF0YSddID09ICcwJyBhbmQgY2hlY2tfbG9naW5bJ3VzZXInXVsndHJpYWwnXSAhPSAnWWVzJzoKCQkJCQkJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0Egc3VhIGNvbnRhIGV4cGlyYSBIb2plLiBGYcOnYSBqw6EgYSBzdWEgUmVub3Zhw6fDo28uJykKCQkJCQkJZWxzZToKCQkJCQkJCWlmIGludChjaGVja19sb2dpblsndXNlciddWydkYXRhJ10pIDwgNSBhbmQgY2hlY2tfbG9naW5bJ3VzZXInXVsnZGF0YSddID4gMDoKCQkJCQkJCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdBIHN1YSBjb250YSBleHBpcmEgZGFxdWkgYSAnK3N0cihjaGVja19sb2dpblsndXNlciddWydkYXRhJ10pKyAnIGRpYXMuIEZhw6dhIGrDoSBhIHN1YSBSZW5vdmHDp8Ojby4nKQoJCQkJCWNyaWFyTWVudShjaGVja19sb2dpblsnbWVudXMnXSwiTWluaGEgQ29udGEiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fY29uLnBuZycpLF9MSUlMTF8sImNvbnRhIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fY29uLnBuZycpKQoJCQkJCWNyaWFyTWVudShjaGVja19sb2dpblsnbWVudXMnXSwiVmVyIFRWIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX3R2LnBuZycpLF9MSUlMTF8sInR2Iixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fdHYucG5nJykpCgkJCQkJY3JpYXJNZW51KGNoZWNrX2xvZ2luWydtZW51cyddLCJWw61kZW8gQ2x1YmUiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fdmlkLnBuZycpLF9MSUlMTF8sImZpbG1lcyIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3ZpZC5wbmcnKSkKCQkJCQljcmlhck1lbnUoY2hlY2tfbG9naW5bJ21lbnVzJ10sIlRWIEFyY2hpdmUiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fdHZfYXJjLnBuZycpLF9MSUlMTF8sInR2YXJjaGl2ZSIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3R2X2FyYy5wbmcnKSkKCQkJCQkKCQkJCQlmaWxtZXNfYXBwID0gY2hlY2tfbG9naW4yWyd1c2VyJ11bJ0ZpbG1lc19hcHAnXTsKCQkJCQlpZiBmaWxtZXNfYXBwID09IDQgb3IgZmlsbWVzX2FwcCA9PSAnNCc6CgkJCQkJCWNyaWFyTWVudShjaGVja19sb2dpblsnbWVudXMnXSwiRXh0cmFzIixfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsiQWRkb24vSW1hZ2Vucy9ub3ZpZGFkZXN0di5wbmciLCJleHRyYXMiLCJleHRyYXMiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb190dl9hcmMucG5nJykpCgkJCQkJY3JpYXJNZW51KGNoZWNrX2xvZ2luWydtZW51cyddLCJDb25maWd1cmHDp8O1ZXMiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fZGVmLnBuZycpLCJjb25maWd1cmFyIiwiY29uZmlndXJhciIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2RlZi5wbmcnKSkKCQkJCQljcmlhck1lbnUoY2hlY2tfbG9naW5bJ21lbnVzJ10sIkxpbXBhciBDYWNoZSIsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb19saW0ucG5nJyksImxpbXBhcmNhY2hlIiwibGltcGFyY2FjaGUiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19saW0ucG5nJykpCgkJCQkJY3JpYXJNZW51KGNoZWNrX2xvZ2luWydtZW51cyddLCJMaW1wYXIgVHVkbyBHcmF2YWRvIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX2xpbS5wbmcnKSwibGltcGFydHVkbyIsImxpbXBhcnR1ZG8iLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19saW0ucG5nJykpCgkJCQkJaWYoY2hlY2tfbG9naW4yWyd1c2VyJ11bJ0VtYWlsJ10gIT0gJycgYW5kIGNoZWNrX2xvZ2luMlsndXNlciddWydFbWFpbCddICE9ICdlbWFpbCcpOgoJCQkJCQlhZGRMaW5rQ2FuYWxMaXN0YSgiW0NPTE9SID0gd2hpdGVdRW1haWwgRMO6dmlkYXM6IFsvQ09MT1JdIitjaGVja19sb2dpbjJbJ3VzZXInXVsnRW1haWwnXSwiIiwiIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX2Nvbi5wbmcnKSxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fY29uLnBuZycpLCcnKQoJCQkJCWlmKGNoZWNrX2xvZ2luMlsndXNlciddWydXZWJTaXRlJ10gIT0gJycgYW5kIGNoZWNrX2xvZ2luMlsndXNlciddWydXZWJTaXRlJ10gIT0gJ2h0dHA6Ly8nKToKCQkJCQkJYWRkTGlua0NhbmFsTGlzdGEoIltDT0xPUiA9IHdoaXRlXUFxdWlzacOnw6NvOiBbL0NPTE9SXSIrY2hlY2tfbG9naW4yWyd1c2VyJ11bJ1dlYlNpdGUnXSwiIiwiIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX2Nvbi5wbmcnKSxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fY29uLnBuZycpLCcnKQoJCQkJCU1lbnVfaW5pY2lhbChjaGVja19sb2dpbixGYWxzZSwnJykKCQkJCV9fRVBHX18gPSBfTElJTExfKyd4bWx0di5waHA/dXNlcm5hbWU9JytfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fbmFtZScpKycmcGFzc3dvcmQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fcGFzc3dvcmQnKSsnJmVwZ19zaGlmdD0wJwoJCQkJX19BRERPTl9fLnNldFNldHRpbmcoJ2xpc3RhX2VwZycsIF9fRVBHX18pCgkJCQl0aHJlYWQuc3RhcnRfbmV3X3RocmVhZChvYnRlcl9maWNoZWlyb19lcGcsICgpICkKCQkJCXZpc3RhX21lbnUoKQoJCQllbHNlOgoJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVXRpbGl6YWRvciBvdSBzZW5oYSBJbmNvcnJlY3Rvcy4gQWx0ZXJlIGUgdGVudGUgbm92YW1lbnRlLicpCgkJCQlhZGREaXIoJ0FsdGVyYXIgRGVmaW5pw6fDtWVzJywgJ3VybCcsIDUsICdNaW5pYXR1cmEnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX2RlZi5wbmcnKSwnJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2RlZi5wbmcnKSkKCQkJCWFkZERpcignRW50cmFyIG5vdmFtZW50ZScsICd1cmwnLCBOb25lLCAnTWluaWF0dXJhJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb19saW0ucG5nJyksJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX2xpbS5wbmcnKSkKCQkJCXZpc3RhX21lbnUoKQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwkJCQkJCQkgIExvZ2luIEFkZG9uCQkJCQkJCQkJCSAgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZGVmIGxvZ2lucGFpbmVsKCk6CglpbmZvcm1hY29lcyA9IHsKCQkndXNlcicgOiB7CgkJCSdOb21lJzogJycsCgkJCSdBY2Vzc19Ub2tlbic6ICcnLAoJCQknRE5TJzogJycsCgkJCSdFbWFpbCc6ICcnLAoJCQknV2ViU2l0ZSc6ICcnLAoJCQknVmVyQVBQJzogJycsCgkJCSdMaW5rQVBQJzogJycsCgkJCSdFcnJvJzogJycsCgkJCSdNZWxob3JhbWVudG9zJzogJycsCgkJCSdDbGllbnRfU2VjcmV0X1VzZXInOiAnJywKCQkJJ0ZpbG1lc19hcHAnOiAnJwoJCX0KCX0KCXRyeToKCQluZXQgPSBOZXQoKQoJCWRhZG9zID0geydub21lX2FwcCc6IEFkZG9uVGl0bGUsICd0aXBvX2FwcCc6ICdBZGRvbicsICd1c2VybmFtZSc6IF9fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9uYW1lIiksICdwYXNzd29yZCc6IF9fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9wYXNzd29yZCIpfQoJCWNvZGlnb19mb250ZSA9IG5ldC5odHRwX1BPU1QoYmFzZTY0LmI2NGRlY29kZShfTElJTExfKSxmb3JtX2RhdGE9ZGFkb3MsaGVhZGVycz1fX0hFQURFUlNfXykuY29udGVudAoJCWVsZW1zID0gRVQuZnJvbXN0cmluZyhjb2RpZ29fZm9udGUpCgkJZm9yIGNoaWxkIGluIGVsZW1zOgoJCQlpZihjaGlsZC50YWcgPT0gJ2Vycm8nKToKCQkJCSNpbmZvcm1hY29lc1sndXNlciddWydFcnJvJ10gPSBjaGlsZC50ZXh0CgkJCQlpbmZvcm1hY29lc1sndXNlciddWydOb21lJ10gPSBBZGRvblRpdGxlCgkJCQlpbmZvcm1hY29lc1sndXNlciddWydBY2Vzc19Ub2tlbiddID0gJycKCQkJCV9fQURET05fXy5zZXRTZXR0aW5nKCdhY2Vzc19Ub2tlbicsICcnKQoJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnRE5TJ10gPSBiYXNlNjQudXJsc2FmZV9iNjRkZWNvZGUoX19BRERPTl9fLmdldFNldHRpbmcoJ2Ruc19hZGRvbicpKQoJCQkJX19FUEdfXyA9IGluZm9ybWFjb2VzWyd1c2VyJ11bJ0ROUyddKyd4bWx0di5waHA/dXNlcm5hbWU9JytfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fbmFtZScpKycmcGFzc3dvcmQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fcGFzc3dvcmQnKSsnJmVwZ19zaGlmdD0wJwoJCQkJX19BRERPTl9fLnNldFNldHRpbmcoJ2xpc3RhX2VwZycsIF9fRVBHX18pCgkJCQlpbmZvcm1hY29lc1sndXNlciddWydFbWFpbCddID0gJycKCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ1dlYlNpdGUnXSA9ICcnCgkJCQlpbmZvcm1hY29lc1sndXNlciddWydWZXJBUFAnXSA9IF9fQURET05WRVJTSU9OX18KCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ0xpbmtBUFAnXSA9ICcnCgkJCQlpbmZvcm1hY29lc1sndXNlciddWydNZWxob3JhbWVudG9zJ10gPSAnJwoJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnRmlsbWVzX2FwcCddID0gJzUnCgkJCQlfX0FERE9OX18uc2V0U2V0dGluZygnZW1haWwnLCAnJykKCQkJCV9fQURET05fXy5zZXRTZXR0aW5nKCdwYXNzd29yZCcsICcnKQoJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnQ2xpZW50X1NlY3JldF9Vc2VyJ10gPSAnJwoJCQkJX19BRERPTl9fLnNldFNldHRpbmcoJ2NsaWVudF9zZWNyZXRfdXNlcicsICcnKQoJCQllbGlmKGNoaWxkLnRhZyA9PSAndmFsaWRhY2FvJyk6CgkJCQlmb3IgZCBpbiBjaGlsZDoKCQkJCQlpZihkLnRhZyA9PSAnTm9tZScpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydOb21lJ10gPSBkLnRleHQKCQkJCQllbGlmKGQudGFnID09ICdBY2Vzc19Ub2tlbicpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydBY2Vzc19Ub2tlbiddID0gZC50ZXh0CgkJCQkJCV9fQURET05fXy5zZXRTZXR0aW5nKCdhY2Vzc19Ub2tlbicsIGQudGV4dCkKCQkJCQllbGlmKGQudGFnID09ICdETlMnKToKCQkJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnRE5TJ10gPSBkLnRleHQKCQkJCQllbGlmKGQudGFnID09ICdFbWFpbCcpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydFbWFpbCddID0gZC50ZXh0CgkJCQkJZWxpZihkLnRhZyA9PSAnV2ViU2l0ZScpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydXZWJTaXRlJ10gPSBkLnRleHQKCQkJCQllbGlmKGQudGFnID09ICdWZXJBUFAnKToKCQkJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnVmVyQVBQJ10gPSBkLnRleHQKCQkJCQllbGlmKGQudGFnID09ICdMaW5rQVBQJyk6CgkJCQkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ0xpbmtBUFAnXSA9IGQudGV4dAoJCQkJCWVsaWYoZC50YWcgPT0gJ01lbGhvcmFtZW50b3MnKToKCQkJCQkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnTWVsaG9yYW1lbnRvcyddID0gZC50ZXh0CgkJCQkJZWxpZihkLnRhZyA9PSAnZmlsbWVzX2FwcCcpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydGaWxtZXNfYXBwJ10gPSBkLnRleHQKCQkJCQllbGlmKGQudGFnID09ICd1c2VyX2tvZGknKToKCQkJCQkJX19BRERPTl9fLnNldFNldHRpbmcoJ2VtYWlsJywgZC50ZXh0KQoJCQkJCWVsaWYoZC50YWcgPT0gJ3NlbmhhX2tvZGknKToKCQkJCQkJX19BRERPTl9fLnNldFNldHRpbmcoJ3Bhc3N3b3JkJywgZC50ZXh0KQoJCQkJCWVsaWYoZC50YWcgPT0gJ0NsaWVudF9TZWNyZXRfVXNlcicpOgoJCQkJCQlpbmZvcm1hY29lc1sndXNlciddWydDbGllbnRfU2VjcmV0X1VzZXInXSA9IGQudGV4dAoJCQkJCQlfX0FERE9OX18uc2V0U2V0dGluZygnY2xpZW50X3NlY3JldF91c2VyJywgZC50ZXh0KQoJCQllbHNlOgoJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnTsOjbyBzZWkgbyBxdWUgZXN0b3UgYSBsZXIuJykKCWV4Y2VwdDoKCQlpbmZvcm1hY29lc1sndXNlciddWydOb21lJ10gPSBBZGRvblRpdGxlCgkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnQWNlc3NfVG9rZW4nXSA9ICcnCgkJX19BRERPTl9fLnNldFNldHRpbmcoJ2FjZXNzX1Rva2VuJywgJycpCgkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnRE5TJ10gPSBiYXNlNjQudXJsc2FmZV9iNjRkZWNvZGUoX19BRERPTl9fLmdldFNldHRpbmcoJ2Ruc19hZGRvbicpKQoJCV9fRVBHX18gPSBpbmZvcm1hY29lc1sndXNlciddWydETlMnXSsneG1sdHYucGhwP3VzZXJuYW1lPScrX19BRERPTl9fLmdldFNldHRpbmcoJ2xvZ2luX25hbWUnKSsnJnBhc3N3b3JkPScrX19BRERPTl9fLmdldFNldHRpbmcoJ2xvZ2luX3Bhc3N3b3JkJykrJyZlcGdfc2hpZnQ9MCcKCQlfX0FERE9OX18uc2V0U2V0dGluZygnbGlzdGFfZXBnJywgX19FUEdfXykKCQlpbmZvcm1hY29lc1sndXNlciddWydFbWFpbCddID0gJycKCQlpbmZvcm1hY29lc1sndXNlciddWydXZWJTaXRlJ10gPSAnJwoJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ1ZlckFQUCddID0gX19BRERPTlZFUlNJT05fXwoJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ0xpbmtBUFAnXSA9ICcnCgkJaW5mb3JtYWNvZXNbJ3VzZXInXVsnTWVsaG9yYW1lbnRvcyddID0gJycKCQlpbmZvcm1hY29lc1sndXNlciddWydGaWxtZXNfYXBwJ10gPSAnNScKCQlfX0FERE9OX18uc2V0U2V0dGluZygnZW1haWwnLCAnJykKCQlfX0FERE9OX18uc2V0U2V0dGluZygncGFzc3dvcmQnLCAnJykKCQlpbmZvcm1hY29lc1sndXNlciddWydDbGllbnRfU2VjcmV0X1VzZXInXSA9ICcnCgkJX19BRERPTl9fLnNldFNldHRpbmcoJ2NsaWVudF9zZWNyZXRfdXNlcicsICcnKQoJCSNfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdOw6NvIGZvaSBwb3Nzw612ZWwgYWJyaXIgYSBww6FnaW5hLiBQb3IgZmF2b3IgdGVudGUgbm92YW1lbnRlLicpCgkJcmV0dXJuIGluZm9ybWFjb2VzCgoJcmV0dXJuIGluZm9ybWFjb2VzCgpkZWYgbG9naW4odXJsKToKCWluZm9ybWFjb2VzID0gewoJCSd1c2VyJyA6IHsKCQkJJ3VzZXJuYW1lJzogJycsCgkJCSdwYXNzd29yZCc6ICcnLAoJCQknZXN0YWRvJzogJycsCgkJCSdkYXRhJzogJycsCgkJCSd0cmlhbCc6ICcnLAoJCQknbGlzdGEnOiAnJywKCQkJJ2NvbmVjY29lcyc6ICcnCgkJCQoJCX0sCgkJJ21lbnVzJzogW10KCX0gIyAKCWFuZG1lbGluayA9IHVybCsncGxheWVyX2FwaS5waHA/bW9kZT11c2VyX2luZm8mdXNlcm5hbWU9JytfX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fbmFtZSIpKycmcGFzc3dvcmQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fcGFzc3dvcmQiKQoJYW5kbWVkID0gZ3JhYl9lcGcoYW5kbWVsaW5rKQoJaWYgYW5kbWVkICE9IE5vbmU6CgkJa2FzdXRhamFBbmRtZWQgPSBhbmRtZWRbc3luY19kYXRhKCJkWE5sY2w5cGJtWnYiKV0KCQlrYXN1dGFqYUFuZG1lZDIgPSBhbmRtZWRbc3luY19kYXRhKCJjMlZ5ZG1WeVgybHVabTg9IildCgkJc2VpcyA9IGthc3V0YWphQW5kbWVkW2dldF9saXZlKCJjM1JoZEhWeiIpXQoJCWFlZ3ViID0ga2FzdXRhamFBbmRtZWRbc3luY19kYXRhKCJaWGh3WDJSaGRHVT0iKV0KCQlpZiBhZWd1YjoKCQkJYWVndWIgPSBkYXRlLmZyb210aW1lc3RhbXAoaW50KGFlZ3ViKSkuc3RyZnRpbWUoIiVZLSVtLSVkIikKCQkJZWFlYWVuID0ga2FzdXRhamFBbmRtZWQyW3N5bmNfZGF0YSgiZEdsdFpWOXViM2M9IildCgkJCQoJCQl2aWV3U3RhcnREYXRlID0gZGF0ZXRpbWUuZGF0ZXRpbWUubm93KCkuc3RyZnRpbWUoIiVZLSVtLSVkIikKCQkJCgkJCWZvcm1hdCA9ICIlWS0lbS0lZCIKCQkJCgkJCXRyeToKCQkJCWhvamUxID0gZGF0ZXRpbWUuZGF0ZXRpbWUuc3RycHRpbWUoYWVndWIsIGZvcm1hdCkKCQkJZXhjZXB0IFR5cGVFcnJvcjoKCQkJCWhvamUxID0gZGF0ZXRpbWUuZGF0ZXRpbWUoKih0aW1lLnN0cnB0aW1lKGFlZ3ViLCBmb3JtYXQpWzA6Nl0pKQoJCQkKCQkJdHJ5OgoJCQkJaG9qZTIgPSBkYXRldGltZS5kYXRldGltZS5zdHJwdGltZSh2aWV3U3RhcnREYXRlLCBmb3JtYXQpCgkJCWV4Y2VwdCBUeXBlRXJyb3I6CgkJCQlob2plMiA9IGRhdGV0aW1lLmRhdGV0aW1lKCoodGltZS5zdHJwdGltZSh2aWV3U3RhcnREYXRlLCBmb3JtYXQpWzA6Nl0pKQoJCQkKCQkJYWVndWIgPSBzdHIoYWJzKChob2plMS1ob2plMikuZGF5cykpCgkJZWxzZToKCQkJYWVndWIgPSB2b2RfY2hhbm5lbHMoIlRtVjJaWEk9IikgCgkJcmFiYml0cyA9IGthc3V0YWphQW5kbWVkW3ZvZF9jaGFubmVscygiYVhOZmRISnBZV3c9IildCgkJaWYgcmFiYml0cyA9PSAiMCI6CgkJCXJhYmJpdHMgPSBzeW5jX2RhdGEoIlRtOD0iKQoJCWVsc2U6CgkJCXJhYmJpdHMgPSBzeW5jX2RhdGEoIldXVnoiKQoJCWxlYXZlbWVhbG9uZSA9IGthc3V0YWphQW5kbWVkW2dldF9saXZlKCJiV0Y0WDJOdmJtNWxZM1JwYjI1eiIpXQoJCXBvbGFyYmVhcnMgPSBrYXN1dGFqYUFuZG1lZFtzeW5jX2RhdGEoImRYTmxjbTVoYldVPSIpXQoJCQoJCWlmKHBvbGFyYmVhcnMgIT0gJycpOgoJCQlpbmZvcm1hY29lc1sndXNlciddWyd1c2VybmFtZSddID0gIltDT0xPUiA9IHdoaXRlXVV0aWxpemFkb3I6IFsvQ09MT1JdIitwb2xhcmJlYXJzCgkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ2VzdGFkbyddID0gc2VpcwoJCQlpbmZvcm1hY29lc1sndXNlciddWydkYXRhJ10gPSBhZWd1YgoJCQlpbmZvcm1hY29lc1sndXNlciddWyd0cmlhbCddID0gcmFiYml0cwoJCQlpbmZvcm1hY29lc1sndXNlciddWydjb25lY2NvZXMnXSA9ICJbQ09MT1IgPSB3aGl0ZV1NYXhpbW8gZGUgQ29ubmVjOiBbL0NPTE9SXSIrbGVhdmVtZWFsb25lCgkJCWluZm9ybWFjb2VzWyd1c2VyJ11bJ2xpc3RhJ10gPSB1cmwKCQoJcmV0dXJuIGluZm9ybWFjb2VzCgpkZWYgbG9naW4yKCk6CglyZXN1bHRhZG8gPSBGYWxzZQoJdHJ5OgoJCXBvc3QgPSB1cmxsaWIudXJsZW5jb2RlKHsndXNlcm5hbWUnOiBfX0FERE9OX18uZ2V0U2V0dGluZygnZW1haWwnKSwgJ3Bhc3N3b3JkJzogX19BRERPTl9fLmdldFNldHRpbmcoJ3Bhc3N3b3JkJykgfSkKCQlyZXN1bHRhZG8gPSBhYnJpcl91cmwoX19BUElfU0lURV9fKydsb2dpbi5waHAnLCBwb3N0PXBvc3QsIGhlYWRlcj1oZWFkZXJzKQoJCQoJCWlmIHJlc3VsdGFkbyA9PSAnRE5TJzoKCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVGVtIGRlIGFsdGVyYXIgb3MgRE5TIHBhcmEgcG9kZXIgdXN1ZnJ1aXIgZG8gX19BRERPTl9fLicpCgkJCXJldHVybiBGYWxzZQoJCQkKCQl0cnk6CgkJCXJlc3VsdGFkbyA9IHJlc3VsdGFkby5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6CgkJCXJlc3VsdGFkbyA9IHJlc3VsdGFkby5lbmNvZGUoJ3V0Zi04JykKCQl0cnk6CgkJCWlmIHJlc3VsdGFkb1snY29kaWdvJ10gPT0gMjA0OgoJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCByZXN1bHRhZG9bJ21lbnNhZ2VtJ10pCgkJCQlyZXR1cm4gRmFsc2UKCQlleGNlcHQ6CgkJCXBhc3MKCQkKCQllc2NyZXZlcl9maWNoZWlybyhvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdkZWZpbmljb2VzLmxpdmVpdCcpLCByZXN1bHRhZG8pCgkJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pCgkJI2NvbG9jYXIgbyBsb2dnZWRpbgoJCXRva2VuID0gcmVzdWx0YWRvWydjb29raWUnXQoJCXJlZnJlc2ggPSByZXN1bHRhZG9bJ2V4cGlyYSddCgkJCgkJdHJ5OgoJCQl1c2VybmFtZSA9IHJlc3VsdGFkb1sndXNlcm5hbWUnXS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6CgkJCXVzZXJuYW1lID0gcmVzdWx0YWRvWyd1c2VybmFtZSddLmVuY29kZSgndXRmLTgnKQoJCQoJCV9fQURET05fXy5zZXRTZXR0aW5nKCd0b2tlbk1ycGlyYWN5JywgdG9rZW4pCgkJX19BRERPTl9fLnNldFNldHRpbmcoJ3JlZnJlc2hNcnBpcmFjeScsIHJlZnJlc2gpCgkJX19BRERPTl9fLnNldFNldHRpbmcoJ2xvZ2dlZGluJywgdXNlcm5hbWUpCgkJCgkJY2F0ZWdvcmlhcyA9IHJlc3VsdGFkb1snY2F0ZWdvcmlhcyddCgkJZXNjcmV2ZXJfZmljaGVpcm8ob3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnY2F0ZWdvcmlhcy5saXZlaXQnKSwgc3RyKGNhdGVnb3JpYXMpKQoJCXJldHVybiBUcnVlCglleGNlcHQ6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnTsOjbyBmb2kgcG9zc8OtdmVsIGFicmlyIGEgcMOhZ2luYS4gUG9yIGZhdm9yIHRlbnRlIG5vdmFtZW50ZS4nKQoJCXJldHVybiBGYWxzZQoKZGVmIE1lbnVfaW5pY2lhbChtZW4sYnVpbGQsdGlwbyk6Cglfbm9tZXVzZXIgPSBtZW5bJ3VzZXInXVsndXNlcm5hbWUnXQoJZm9yIG1lbnUgaW4gbWVuWydtZW51cyddOgoJCW5vbWUgPSBtZW51Wydub21lJ10KCQlsb2dvID0gbWVudVsnbG9nbyddCgkJbGluayA9IG1lbnVbJ3VybCddCgkJdGlwbyA9IG1lbnVbJ3RpcG8nXQoJCWZhbmFydCA9IG1lbnVbJ2ZhbmFydCddCgkJCgkJaWYgdGlwbyA9PSAnY29udGEnIDoKCQkJYWRkRGlyKG5vbWUsbGluaywyLCdMaXN0YScsbG9nbyx0aXBvLGZhbmFydCkKCQllbGlmKHRpcG8gPT0gJ3R2Jyk6CgkJCWFkZERpcihub21lLGxpbmssMywnTGlzdGEnLGxvZ28sdGlwbyxmYW5hcnQpCgkJZWxpZih0aXBvID09ICdmaWxtZXMnKToKCQkJYWRkRGlyKG5vbWUsbGluaywxLCdMaXN0YScsbG9nbyx0aXBvLGZhbmFydCkKCQllbGlmKHRpcG8gPT0gJ2V4dHJhcycpOgoJCQlhZGREaXIobm9tZSxsaW5rLDEwNiwnTGlzdGEnLGxvZ28sdGlwbyxmYW5hcnQpCgkJZWxpZih0aXBvID09ICdjb25maWd1cmFyJyk6CgkJCWFkZERpcihub21lLGxpbmssNSwnTGlzdGEnLGxvZ28sdGlwbyxmYW5hcnQpCgkJZWxpZiB0aXBvID09ICd0dmFyY2hpdmUnOgoJCQlhZGREaXIobm9tZSxsaW5rLDYsJ0xpc3RhJyxsb2dvLCcnLGZhbmFydCkKCQllbGlmKHRpcG8gPT0gJ2xpbXBhcmNhY2hlJyk6CgkJCWFkZERpcihub21lLCBsaW5rLCAxMywgJ0xpc3RhJyxsb2dvLHRpcG8sZmFuYXJ0KQoJCWVsaWYodGlwbyA9PSAnbGltcGFydHVkbycpOgoJCQlhZGREaXIobm9tZSwgbGluaywgMTQsICdMaXN0YScsbG9nbyx0aXBvLGZhbmFydCkKCQkKCXhibWMuZXhlY3V0ZWJ1aWx0aW4oJ05vdGlmaWNhdGlvbiglcywgJXMsICVpLCAlcyknJShBZGRvblRpdGxlLF9ub21ldXNlciwgODAwMCwgX0lDT05fKSkKCXhibWNwbHVnaW4uZW5kT2ZEaXJlY3RvcnkoaW50KHN5cy5hcmd2WzFdKSxjYWNoZVRvRGlzYz1GYWxzZSkKCmRlZiBhYnJpckV4dHJhcygpOgoJdXJsbm9vMSA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L2J1c2NhcnJhZGlvcy5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJmFkZG9uPTEnCglhZGREaXIoIlLDoWRpb3MiLHVybG5vbzEsMTAyLCdMaXN0YScsX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrIkFkZG9uL0ltYWdlbnMvcmFkaW9zLnBuZyIsJ3ByYWlhcycsX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrIkFkZG9uL0ltYWdlbnMvcmFkaW9zX2ZhbmFydC5wbmciKQoJdXJsbm9vMSA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L2J1c2NhcnByYWlhcy5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJmFkZG9uPTEnCglhZGREaXIoIlByYWlhcyIsdXJsbm9vMSwxMDEsJ0xpc3RhJyxfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsiQWRkb24vSW1hZ2Vucy9ub3ZpZGFkZXN0di5wbmciLCdwcmFpYXMnLF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJBZGRvbi9JbWFnZW5zL25vdmlkYWRlc19mYW5hcnQucG5nIikKCXVybG5vbzEgPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC9idXNjYXJuZXd0ZWxlbm92ZWxhcy5waHA/dGlwbz1Qcm9ncmFtYXMmY2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJmFkZG9uPTEnCglhZGREaXIoIlByb2dyYW1hcyBlIFRlbGVub3ZlbGFzIix1cmxub28xLDEwMywnTGlzdGEnLF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJBZGRvbi9JbWFnZW5zL25vdmlkYWRlc3R2LnBuZyIsJ3ByYWlhcycsX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrIkFkZG9uL0ltYWdlbnMvbm92aWRhZGVzX2ZhbmFydC5wbmciKQoJdXJsbm9vMSA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L2J1c2Nhcm5ld3RlbGVub3ZlbGFzLnBocD90aXBvPUpvcm5haXMmY2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJmFkZG9uPTEnCglhZGREaXIoIkpvcm5haXMiLHVybG5vbzEsMTA3LCdMaXN0YScsX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrIkFkZG9uL0ltYWdlbnMvbm92aWRhZGVzdHYucG5nIiwnam9ybmFpcycsX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrIkFkZG9uL0ltYWdlbnMvbm92aWRhZGVzX2ZhbmFydC5wbmciKQoJCgl2aXN0YV9tZW51KCkKCmRlZiBsaXN0YXJfZ3J1cG9zMShtb2Rvbix1cmwsZmFuYXJ0KToKCXJlc3VsdGFkbzEgPSBkZXZvbHZlcmVzdWx0YWRvKHVybCkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvMSkKCWZvciBpIGluIHJlc3VsdGFkb1snY2FuYWlzJ106CgkJaWQgPSBpWydJRCddCgkJbm9tZSA9ICIiCgkJaW1hZ2VtID0gIiIKCQl1cmxuID0gIiIKCQl0cnk6IG5vbWUgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ05vbWUnXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OiBwYXNzCgkJdHJ5OiAKCQkJaW1hZ2VtID0gYmFzZTY0LmI2NGRlY29kZShpWydJbWFnZW0nXSkuZGVjb2RlKCd1dGYtOCcpCgkJCWltYWdlbSA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJMb2dvcy8iK2ltYWdlbQoJCWV4Y2VwdDogcGFzcwoJCXRyeTogdXJsbiA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnVXJsJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCWFkZExpbmtDYW5hbExpc3RhKG5vbWUsdXJsbixpbWFnZW0sJycsZmFuYXJ0LCAnMDAwMScpCgkJCmRlZiBsaXN0YXJfZ3J1cG9zMihtb2Rvbix1cmwsZmFuYXJ0KToKCXJlc3VsdGFkbzEgPSBkZXZvbHZlcmVzdWx0YWRvKHVybCkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvMSkKCWZvciBpIGluIHJlc3VsdGFkb1snY2FuYWlzJ106CgkJaWQgPSBpWydJRCddCgkJbm9tZSA9ICIiCgkJaW1hZ2VtID0gIiIKCQl1cmxuID0gIiIKCQl0cnk6IG5vbWUgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ05vbWUnXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OiBwYXNzCgkJdHJ5OiAKCQkJaW1hZ2VtID0gYmFzZTY0LmI2NGRlY29kZShpWydJbWFnZW0nXSkuZGVjb2RlKCd1dGYtOCcpCgkJCWltYWdlbSA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJMb2dvcy8iK2ltYWdlbQoJCWV4Y2VwdDogcGFzcwoJCXRyeTogdXJsbiA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnVXJsJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCWFkZExpbmtDYW5hbExpc3RhKG5vbWUsdXJsbixpbWFnZW0sJycsZmFuYXJ0LCAnMDAwMScpCgkKZGVmIGxpc3Rhcl9ncnVwb3MzKG1vZG9uLHVybCxmYW5hcnQpOgoJcmVzdWx0YWRvMSA9IGRldm9sdmVyZXN1bHRhZG8odXJsKQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8xKQoJZm9yIGkgaW4gcmVzdWx0YWRvWydjYW5haXMnXToKCQlub21lID0gIiIKCQlpbWFnZW0gPSAiIgoJCXVybG4gPSAiIgoJCXRpcG8gPSAiIgoJCXdlYnNpdGUgPSAiIgoJCWNhbmFsID0gIiIKCQl0cnk6IG5vbWUgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ05vbWUnXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OiBwYXNzCgkJdHJ5OiAKCQkJaW1hZ2VtID0gYmFzZTY0LmI2NGRlY29kZShpWydJbWFnZW0nXSkuZGVjb2RlKCd1dGYtOCcpCgkJCWltYWdlbSA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJMb2dvcy8iK2ltYWdlbQoJCWV4Y2VwdDogcGFzcwoJCXRyeTogdXJsbiA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnVXJsJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCXRyeTogd2Vic2l0ZSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnV2ViU2l0ZSddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQl0cnk6IHRpcG8gPSBpWydUaXBvJ10KCQlleGNlcHQ6IHBhc3MKCQl0cnk6IGNhbmFsID0gaVsnQ2FuYWwnXQoJCWV4Y2VwdDogcGFzcwoJCXVybG5vbzMgPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC9idXNjYXJpbmZvdGVsZW5vdmVsYXMucGhwP3RpcG89Jyt0aXBvKycmd2Vic2l0ZT0nK3dlYnNpdGUrJyZ1cmw9Jyt1cmxuKycmY2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJmFkZG9uPTEnCgkJYWRkRGlyKG5vbWUsdXJsbm9vMywxMDQsJ0xpc3RhJyxpbWFnZW0sJ1Byb2dyYW1hcycsX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrIkFkZG9uL0ltYWdlbnMvbm92aWRhZGVzX2ZhbmFydC5wbmciKQoKZGVmIGxpc3Rhcl9ncnVwb3M0KG1vZG9uLHVybCxpY29uaW1hZ2UsZmFuYXJ0KToKCXJlc3VsdGFkbzEgPSBkZXZvbHZlcmVzdWx0YWRvKHVybCkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvMSkKCWZvciBpIGluIHJlc3VsdGFkb1snZXBpc29kaW9zJ106CgkJbm9tZSA9ICIiCgkJdXJsbiA9IGlbJ3VybCddCgkJdHJ5OiBub21lID0gYmFzZTY0LmI2NGRlY29kZShpWyd0aXR1bG8nXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OiBwYXNzCgkJYWRkTGlua0NhbmFsTGlzdGEobm9tZSx1cmxuLGljb25pbWFnZSwncHJvZ3JhbWFzJyxmYW5hcnQsICcwMDAxJykKCQkKZGVmIGxpc3Rhcl9ncnVwb3M1KG1vZG9uLHVybCxmYW5hcnQpOgoJcmVzdWx0YWRvMSA9IGRldm9sdmVyZXN1bHRhZG8odXJsKQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8xKQoJZm9yIGkgaW4gcmVzdWx0YWRvWydjYW5haXMnXToKCQlub21lID0gIiIKCQlpbWFnZW0gPSAiIgoJCXVybG4gPSAiIgoJCXRpcG8gPSAiIgoJCXdlYnNpdGUgPSAiIgoJCWNhbmFsID0gIiIKCQl0cnk6IG5vbWUgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ05vbWUnXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OiBwYXNzCgkJdHJ5OiAKCQkJaW1hZ2VtID0gYmFzZTY0LmI2NGRlY29kZShpWydJbWFnZW0nXSkuZGVjb2RlKCd1dGYtOCcpCgkJCWltYWdlbSA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJMb2dvcy8iK2ltYWdlbQoJCWV4Y2VwdDogcGFzcwoJCXRyeTogdXJsbiA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnVXJsJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCXRyeTogd2Vic2l0ZSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnV2ViU2l0ZSddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQl0cnk6IHRpcG8gPSBpWydUaXBvJ10KCQlleGNlcHQ6IHBhc3MKCQl0cnk6IGNhbmFsID0gaVsnQ2FuYWwnXQoJCWV4Y2VwdDogcGFzcwoJCXVybG5vbzMgPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC9idXNjYXJpbmZvdGVsZW5vdmVsYXMucGhwP3RpcG89am9ybmFpcyZ1cmw9Jyt1cmxuKycmY2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJmFkZG9uPTEnCgkJYWRkRGlyKG5vbWUsdXJsbm9vMywxMDgsJ0xpc3RhJyxpbWFnZW0sJ0pvcm5haXMnLF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyJBZGRvbi9JbWFnZW5zL25vdmlkYWRlc19mYW5hcnQucG5nIikKCmRlZiBsaXN0YXJfZ3J1cG9zNihtb2Rvbix1cmwsaWNvbmltYWdlLGZhbmFydCk6CglyZXN1bHRhZG8xID0gZGV2b2x2ZXJlc3VsdGFkbyh1cmwpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbzEpCglmb3IgaSBpbiByZXN1bHRhZG9bJ2VwaXNvZGlvcyddOgoJCW5vbWUgPSAiIgoJCXVybG4gPSAiIgoJCXRyeTogbm9tZSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsndGl0dWxvJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCXRyeTogdXJsbiA9IGJhc2U2NC5iNjRkZWNvZGUoaVsndXJsJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCQoJCWFkZERpcihub21lLHVybG4sMTA5LCdMaXN0YScsaWNvbmltYWdlLCdQcm9ncmFtYXMnLGZhbmFydCkKCXhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1NSkiKQoKZGVmIHBsYXlfbXVsdF9jYW5hbDIoYXJnLCBpY29uLCBub21lKToKCXhibWMuZXhlY3V0ZWJ1aWx0aW4oJ1Nob3dQaWN0dXJlKCJ7MH0iKScuZm9ybWF0KGFyZykpCgpkZWYgYWJyaXJWaWRlb0NsdWJlKHVybCk6CgljaGVja19sb2dpbjIgPSBsb2dpbnBhaW5lbCgpCglmaWxtZXNfYXBwID0gY2hlY2tfbG9naW4yWyd1c2VyJ11bJ0ZpbG1lc19hcHAnXTsKCWZpbG1pbGluayA9IHVybCsnZW5pZ21hMi5waHA/dXNlcm5hbWU9JytfX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fbmFtZSIpKycmcGFzc3dvcmQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fcGFzc3dvcmQiKSsnJnR5cGU9Z2V0X3ZvZF9jYXRlZ29yaWVzJwoJaWYgZmlsbWVzX2FwcCA9PSAwIG9yIGZpbG1lc19hcHAgPT0gJzAnOgoJCWRhdGFiYXNlID0gRGF0YWJhc2UuY3JpYXJGaWNoZWlyb3MoKQoJCWFkZERpcignRmlsbWVzIGRhIExpc3RhJyxmaWxtaWxpbmssNCwnTWluaWF0dXJhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZmlsbWVzLnBuZycpLCcnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19fX0FERE9OX18ucG5nJykpCgkJYWRkRGlyKCdGaWxtZXMgZG8gQWRkb24nLHVybCwyMSwnTWluaWF0dXJhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZmlsbWVzLnBuZycpLCcnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19fX0FERE9OX18ucG5nJykpCgkJYWRkRGlyKCdTw6lyaWVzIGRvIEFkZG9uJyx1cmwsMjAsJ01pbmlhdHVyYScsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Nlcmllcy5wbmcnKSwnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fX19BRERPTl9fLnBuZycpKQoJCWFkZERpcignQW5pbWVzIGRvIEFkZG9uJyx1cmwsMjQsJ01pbmlhdHVyYScsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2FuaW1lLnBuZycpLCcnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19fX0FERE9OX18ucG5nJykpCgkJYWRkRGlyKCdbQ09MT1IgcGlua11bQl1QZXNxdWlzYVsvQl1bL0NPTE9SXScsX19BUElfU0lURV9fLDEyMCwnTGlzdGEnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdwZXNxdWlzYS5wbmcnKSwnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fX19BRERPTl9fLnBuZycpKQoJZWxpZiBmaWxtZXNfYXBwID09IDEgb3IgZmlsbWVzX2FwcCA9PSAnMSc6CgkJYWRkRGlyKCdGaWxtZXMgZGEgTGlzdGEnLGZpbG1pbGluayw0LCdNaW5pYXR1cmEnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmaWxtZXMucG5nJyksJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX19fQURET05fXy5wbmcnKSkJCQoJZWxpZiBmaWxtZXNfYXBwID09IDIgb3IgZmlsbWVzX2FwcCA9PSAnMic6CgkJYWRkRGlyKCdGaWxtZXMgZGEgTGlzdGEnLGZpbG1pbGluayw0LCdNaW5pYXR1cmEnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmaWxtZXMucG5nJyksJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX19fQURET05fXy5wbmcnKSkKCQlhZGREaXIoJ0ZpbG1lcyBkbyBBZGRvbicsdXJsLDcxLCdNaW5pYXR1cmEnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmaWxtZXMucG5nJyksJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX19fQURET05fXy5wbmcnKSkKCQlhZGREaXIoJ1PDqXJpZXMgZG8gQWRkb24nLHVybCw2MCwnTWluaWF0dXJhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnc2VyaWVzLnBuZycpLCcnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19fX0FERE9OX18ucG5nJykpCgkJYWRkRGlyKCdbQ09MT1IgcGlua11bQl1QZXNxdWlzYVsvQl1bL0NPTE9SXScsdXJsLDE2MCwnTGlzdGEnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdwZXNxdWlzYS5wbmcnKSwnJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fX19BRERPTl9fLnBuZycpKQoJZWxpZiBmaWxtZXNfYXBwID09IDQgb3IgZmlsbWVzX2FwcCA9PSAnNCc6CgkJYWRkRGlyKCdGaWxtZXMgZGEgTGlzdGEnLGZpbG1pbGluayw0LCdNaW5pYXR1cmEnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmaWxtZXMucG5nJyksJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX19fQURET05fXy5wbmcnKSkKCQlhZGREaXIoJ0ZpbG1lcyBkbyBBZGRvbicsdXJsLDIxMTExLCdNaW5pYXR1cmEnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmaWxtZXMucG5nJyksJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX19fQURET05fXy5wbmcnKSkKCQlhZGREaXIoJ1PDqXJpZXMgZG8gQWRkb24nLHVybCwyMTExMiwnTWluaWF0dXJhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnc2VyaWVzLnBuZycpLCcnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19fX0FERE9OX18ucG5nJykpCgllbHNlOgoJCWFkZERpcignRmlsbWVzIGRhIExpc3RhJyxmaWxtaWxpbmssNCwnTWluaWF0dXJhJyxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZmlsbWVzLnBuZycpLCcnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19fX0FERE9OX18ucG5nJykpCQkKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMJCQkJCQkJICBBYnJpciBJbmZvIENvbnRhCQkJCQkJCQkJICAjCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpkZWYgQWJyaXJfQ29udGEodXJsKToKCWFuZG1lbGluayA9IHVybCsncGFuZWxfYXBpLnBocD91c2VybmFtZT0nK19fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9uYW1lIikrJyZwYXNzd29yZD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9wYXNzd29yZCIpCglleGVjdXRlX2FpbmZvKGFuZG1lbGluaykKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCQkJCQkJCQkJCQkJCUFicmlyIEluZm8gVFZTCQkJCQkJCQkJCQkgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCmRlZiBhYnJpbTN1KHVybCk6Cgl2ZXJzaW9uID0gX19BRERPTlZFUlNJT05fXwoJa2FzdXRhamFuaW1pPV9fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9uYW1lIikKCXNhbGFzb25hPV9fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9wYXNzd29yZCIpCglsZWhla3lsZz11cmwKCXZhbmVtYWtvb2Q9X19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX2FkdWx0b3MiKQoJdmFuZW1hbHVraz1fX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fYWR1bHRvc19zaW0iKQoJCgl0ZWxldmlzaW9vbmlsaW5rID0gdXJsKycvZW5pZ21hMi5waHA/dXNlcm5hbWU9JytfX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fbmFtZSIpKycmcGFzc3dvcmQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fcGFzc3dvcmQiKSsnJnR5cGU9Z2V0X2xpdmVfY2F0ZWdvcmllcycKCXNlY3VyaXR5X2NoZWNrKHRlbGV2aXNpb29uaWxpbmspCgpkZWYgc2VjdXJpdHlfY2hlY2sodXJsKToKCXUgPSB1cmxsaWIyLlJlcXVlc3QodXJsLCcnKQoJdS5hZGRfaGVhZGVyKCdBY2NlcHQnLCAnYXBwbGljYXRpb24veG1sJykKCXUuYWRkX2hlYWRlcignVXNlci1hZ2VudCcsICdNb3ppbGxhLzUuMCAoV2luZG93czsgVTsgV2luZG93cyBOVCA1LjE7IGVuLUdCOyBydjoxLjkuMC4zKSBHZWNrby8yMDA4MDkyNDE3IEZpcmVmb3gvMy4wLjMnKQoJcmVzcG9uc2UgPSB1cmxsaWIyLnVybG9wZW4odSkKCXRyZWUgPSBFVC5wYXJzZShyZXNwb25zZSkKCXJvb3RFbGVtID0gdHJlZS5nZXRyb290KCkKCWZvciBjaGFubmVsIGluIHRyZWUuZmluZGFsbCgiY2hhbm5lbCIpOgoJCWthbmFsaW5pbWkgPSBjaGFubmVsLmZpbmQoInRpdGxlIikudGV4dAoJCWthbmFsaW5pbWkgPSBiYXNlNjQuYjY0ZGVjb2RlKGthbmFsaW5pbWkpCgkJa2F0ZWdvb3JpYWxpbmsgPSBjaGFubmVsLmZpbmQoInBsYXlsaXN0X3VybCIpLnRleHQKCQkKCQlhZGREaXIoa2FuYWxpbmltaSxrYXRlZ29vcmlhbGluayw4LCdNaW5pYXR1cmEnLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fdHYucG5nJyksJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3R2LnBuZycpKQoJCgl2aXN0YV9HcnVwb3MoKQoKZGVmIGRldGVjdF9tb2RpZmljYXRpb24odXJsKToKCWZpbG1pbGluayA9IHVybCsnL2VuaWdtYTIucGhwP3VzZXJuYW1lPScrX19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX25hbWUiKSsnJnBhc3N3b3JkPScrX19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX3Bhc3N3b3JkIikrJyZ0eXBlPWdldF92b2RfY2F0ZWdvcmllcycKCXUgPSB1cmxsaWIyLlJlcXVlc3QoZmlsbWlsaW5rLCcnKQoJdS5hZGRfaGVhZGVyKCdBY2NlcHQnLCAnYXBwbGljYXRpb24veG1sJykKCXUuYWRkX2hlYWRlcignVXNlci1hZ2VudCcsICdNb3ppbGxhLzUuMCAoV2luZG93czsgVTsgV2luZG93cyBOVCA1LjE7IGVuLUdCOyBydjoxLjkuMC4zKSBHZWNrby8yMDA4MDkyNDE3IEZpcmVmb3gvMy4wLjMnKQoJcmVzcG9uc2UgPSB1cmxsaWIyLnVybG9wZW4odSkKCXRyZWUgPSBFVC5wYXJzZShyZXNwb25zZSkKCXJvb3RFbGVtID0gdHJlZS5nZXRyb290KCkKCWZvciBjaGFubmVsIGluIHRyZWUuZmluZGFsbCgiY2hhbm5lbCIpOgoJCWZpbG1pbmltaSA9IGNoYW5uZWwuZmluZCgidGl0bGUiKS50ZXh0CgkJZmlsbWluaW1pID0gYmFzZTY0LmI2NGRlY29kZShmaWxtaW5pbWkpCgkJa2F0ZWdvb3JpYWxpbmsgPSBjaGFubmVsLmZpbmQoInBsYXlsaXN0X3VybCIpLnRleHQKCQkKCQlhZGREaXIoZmlsbWluaW1pLGthdGVnb29yaWFsaW5rLDksJ01pbmlhdHVyYScsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ljb192aWQucG5nJyksJycsb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3ZpZC5wbmcnKSkKCQoJdmlzdGFfR3J1cG9zKCkKCmRlZiBzdHJlYW1fdmlkZW8obmFtZSx1cmwsaW1hZ2UpOgoJdmFuZW1hbHVraz1fX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fYWR1bHRvc19zaW0iKQoJaWYgdmFuZW1hbHVrayA9PSAidHJ1ZSI6CgkJdmFuZW1hX2x1a2sobmFtZSkKCXUgPSB1cmxsaWIyLlJlcXVlc3QodXJsLCcnKQoJdS5hZGRfaGVhZGVyKCdBY2NlcHQnLCAnYXBwbGljYXRpb24veG1sJykKCXUuYWRkX2hlYWRlcignVXNlci1hZ2VudCcsICdNb3ppbGxhLzUuMCAoV2luZG93czsgVTsgV2luZG93cyBOVCA1LjE7IGVuLUdCOyBydjoxLjkuMC4zKSBHZWNrby8yMDA4MDkyNDE3IEZpcmVmb3gvMy4wLjMnKQoJcmVzcG9uc2UgPSB1cmxsaWIyLnVybG9wZW4odSkKCXRyZWUgPSBFVC5wYXJzZShyZXNwb25zZSkKCXJvb3RFbGVtID0gdHJlZS5nZXRyb290KCkKCWZvciBjaGFubmVsIGluIHRyZWUuZmluZGFsbChzeW5jX2RhdGEoIlkyaGhibTVsYkE9PSIpKToKCQlrYW5hbGluaW1pID0gY2hhbm5lbC5maW5kKGdldF9saXZlKCJkR2wwYkdVPSIpKS50ZXh0CgkJa2FuYWxpbmltaSA9IGJhc2U2NC5iNjRkZWNvZGUoa2FuYWxpbmltaSkKCQlrYW5hbGluaW1pID0ga2FuYWxpbmltaS5wYXJ0aXRpb24oIlsiKQoJCXN0cmlpbWlsaW5rID0gY2hhbm5lbC5maW5kKGdldF9saXZlKCJjM1J5WldGdFgzVnliQT09IikpLnRleHQKCQkKCQl1cmxjaGFtYSA9IHN0cmlpbWlsaW5rLnNwbGl0KCcvJykKCQl1cmxub28gPSAnJwoJCXRyeToKCQkJdXJsbm9vID0gdXJsY2hhbWFbNV0KCQkJdXJsbm9vID0gdXJsbm9vLnJlcGxhY2UoJ3RzJywnJykKCQkJdXJsbm9vID0gdXJsbm9vLnJlcGxhY2UoJ20zdTgnLCcnKQoJCWV4Y2VwdDoKCQkJcGFzcwoJCQoJCXBpbHQgPSBjaGFubmVsLmZpbmQoImRlc2NfaW1hZ2UiKS50ZXh0CgkJa2F2YSA9IGthbmFsaW5pbWlbMV0ra2FuYWxpbmltaVsyXQoJCWthdmEgPSBrYXZhLnBhcnRpdGlvbigiXSIpCgkJa2F2YSA9IGthdmFbMl0KCQlrYXZhID0ga2F2YS5wYXJ0aXRpb24oIgkiKQoJCWthdmEgPSBrYXZhWzJdCgkJc2hvdSA9IGdldF9saXZlKCJXME5QVEU5U0lIZG9hWFJsWFNWeklGc3ZRMDlNVDFKZCIpJShrYW5hbGluaW1pWzBdKStrYXZhCgkJa2lyamVsZHVzID0gY2hhbm5lbC5maW5kKCJkZXNjcmlwdGlvbiIpLnRleHQKCQlpZiBraXJqZWxkdXM6CgkJCWtpcmplbGR1cyA9IGJhc2U2NC5iNjRkZWNvZGUoa2lyamVsZHVzKQoJCQlueXlkID0ga2lyamVsZHVzLnBhcnRpdGlvbigiKCIpCgkJCW55eWQgPSAiQWdvcmE6ICIrbnl5ZFswXQoJCQlqYXJnbWluZSA9IGtpcmplbGR1cy5wYXJ0aXRpb24oIilcbiIpCgkJCWphcmdtaW5lID0gamFyZ21pbmVbMl0ucGFydGl0aW9uKCIoIikKCQkJamFyZ21pbmUgPSAiQSBzZWd1aXI6ICIramFyZ21pbmVbMF0KCQkJa29ra3UgPSBueXlkK2phcmdtaW5lCgkJZWxzZToKCQkJa29ra3UgPSAiIgoJCWlmIHBpbHQ6CgkJCWFkZExpbmtDYW5hbExpc3RhKHNob3Usc3RyaWltaWxpbmsscGlsdCxrb2trdSxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fdHYucG5nJyksIHVybG5vbykKCQllbHNlOgoJCQlhZGRMaW5rQ2FuYWxMaXN0YShzaG91LHN0cmlpbWlsaW5rLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fdHYucG5nJyksa29ra3Usb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3R2LnBuZycpLCB1cmxub28pCgkKCXhibWNwbHVnaW4uc2V0Q29udGVudChpbnQoc3lzLmFyZ3ZbMV0pICwiZXBpc29kZXMiKQoJdmlzdGFfQ2FuYWlzKCkKCmRlZiBnZXRfbXlhY2NvdW50KG5hbWUsdXJsLGltYWdlKToKCXZhbmVtYWx1a2s9X19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX2FkdWx0b3Nfc2ltIikKCWlmIHZhbmVtYWx1a2sgPT0gInRydWUiOgoJCXZhbmVtYV9sdWtrKG5hbWUpCgl1ID0gdXJsbGliMi5SZXF1ZXN0KHVybCwnJykKCXUuYWRkX2hlYWRlcignQWNjZXB0JywgJ2FwcGxpY2F0aW9uL3htbCcpCgl1LmFkZF9oZWFkZXIoJ1VzZXItYWdlbnQnLCAnTW96aWxsYS81LjAgKFdpbmRvd3M7IFU7IFdpbmRvd3MgTlQgNS4xOyBlbi1HQjsgcnY6MS45LjAuMykgR2Vja28vMjAwODA5MjQxNyBGaXJlZm94LzMuMC4zJykKCXJlc3BvbnNlID0gdXJsbGliMi51cmxvcGVuKHUpCgl0cmVlID0gRVQucGFyc2UocmVzcG9uc2UpCglyb290RWxlbSA9IHRyZWUuZ2V0cm9vdCgpCglmb3IgY2hhbm5lbCBpbiB0cmVlLmZpbmRhbGwoImNoYW5uZWwiKToKCQlwZWFsa2lyaSA9IGNoYW5uZWwuZmluZCgidGl0bGUiKS50ZXh0CgkJcGVhbGtpcmkgPSBiYXNlNjQuYjY0ZGVjb2RlKHBlYWxraXJpKQoJCXBlYWxraXJpID0gcGVhbGtpcmkuZW5jb2RlKCJ1dGYtOCIpCgkJc3RyaWltaWxpbmsgPSBjaGFubmVsLmZpbmQoInN0cmVhbV91cmwiKS50ZXh0CgkJCgkJdXJsY2hhbWEgPSBzdHJpaW1pbGluay5zcGxpdCgnLycpCgkJdXJsbm9vID0gJycKCQl0cnk6CgkJCXVybG5vbyA9IHVybGNoYW1hWzVdCgkJCXVybG5vbyA9IHVybG5vby5yZXBsYWNlKCd0cycsJycpCgkJCXVybG5vbyA9IHVybG5vby5yZXBsYWNlKCdtM3U4JywnJykKCQlleGNlcHQ6CgkJCXBhc3MKCQkKCQlwaWx0ID0gY2hhbm5lbC5maW5kKCJkZXNjX2ltYWdlIikudGV4dCAKCQlkZXNjcmlwdCA9IGNoYW5uZWwuZmluZCgiZGVzY3JpcHRpb24iKS50ZXh0CgkJaWYgZGVzY3JpcHQ6CgkJCWRlc2NyaXB0ID0gYmFzZTY0LmI2NGRlY29kZShkZXNjcmlwdCkKCQlpZiBwaWx0OgoJCQlhZGRMaW5rQ2FuYWxMaXN0YShwZWFsa2lyaSxzdHJpaW1pbGluayxwaWx0LGRlc2NyaXB0LG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb192aWQucG5nJyksIHVybG5vbykKCQllbHNlOgoJCQlhZGRMaW5rQ2FuYWxMaXN0YShwZWFsa2lyaSxzdHJpaW1pbGluayxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX3R2LnBuZycpLGRlc2NyaXB0LG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb192aWQucG5nJyksIHVybG5vbykKCQoJeGJtY3BsdWdpbi5zZXRDb250ZW50KGludChzeXMuYXJndlsxXSkgLCJtb3ZpZXMiKQoJdmlzdGFfQ2FuYWlzKCkKCmRlZiBhZGRMaW5rQ2FuYWxMaXN0YSh0aXRsZSwgdXJsLCB0aHVtYm5haWwsIHBsb3QsIGZhbmFydCwgaWRjYW5hbCwgaXNQbGF5YWJsZT1UcnVlLCBmb2xkZXI9RmFsc2UpOgoJb2s9VHJ1ZQoJY209W10KCWlmKGlkY2FuYWwgIT0gJzAwMDEnKToKCQljbS5hcHBlbmQoKCdWZXIgcHJvZ3JhbWHDp8OjbycsICdYQk1DLlJ1blBsdWdpbiglcz9tb2RlPTMxJm5hbWU9JXMmdXJsPSVzJmljb25pbWFnZT0lcyZpZENhbmFsPSVzJmlkZmZDYW5hbD0lcyknJShzeXMuYXJndlswXSx1cmxsaWIucXVvdGVfcGx1cyh0aXRsZSksIHVybGxpYi5xdW90ZV9wbHVzKHVybCksIHVybGxpYi5xdW90ZV9wbHVzKHRodW1ibmFpbCksIGlkY2FuYWwsICcnKSkpCgkKCWxpc3RpdGVtPXhibWNndWkuTGlzdEl0ZW0odGl0bGUsaWNvbkltYWdlPXRodW1ibmFpbCx0aHVtYm5haWxJbWFnZT10aHVtYm5haWwpCglsaXN0aXRlbS5hZGRDb250ZXh0TWVudUl0ZW1zKGNtLCByZXBsYWNlSXRlbXM9RmFsc2UpCglpbmZvX2xhYmVscz17IlRpdGxlIjp0aXRsZSwiRmlsZU5hbWUiOnRpdGxlLCJQbG90IjpwbG90fQoJbGlzdGl0ZW0uc2V0SW5mbyggInZpZGVvIiwgaW5mb19sYWJlbHMgKQoJbGlzdGl0ZW0uc2V0UHJvcGVydHkoJ2ZhbmFydF9pbWFnZScsIGZhbmFydCkKCWxpc3RpdGVtLnNldEFydCh7J2ZhbmFydCc6IGZhbmFydH0pCglsaXN0aXRlbS5zZXRQcm9wZXJ0eSgiVmlkZW8iLCJ0cnVlIikKCXUgPSBzeXMuYXJndlswXSArICI/dXJsPSIgKyBzdHIodXJsKSArICImbW9kZT0xMCZuYW1lPSIgKyBzdHIobmFtZSkgKyAiJmljb25pbWFnZT0iK3N0cihpY29uaW1hZ2UpKyImZmFuYXJ0PSIrc3RyKGZhbmFydCkrIiZwbG90PSIrc3RyKHBsb3QpCglvaz14Ym1jcGx1Z2luLmFkZERpcmVjdG9yeUl0ZW0oaGFuZGxlPWludChzeXMuYXJndlsxXSksdXJsPXUsbGlzdGl0ZW09bGlzdGl0ZW0saXNGb2xkZXI9Zm9sZGVyKQoJcmV0dXJuIG9rCgpkZWYgcnVuX2Nyb25qb2IodGl0bGUsdXJsLGltYWdlLHBsb3QsZmFuYXJ0KToKCXZhbmVtYWx1a2s9X19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX2FkdWx0b3Nfc2ltIikKCWlmIHZhbmVtYWx1a2sgPT0gInRydWUiOgoJCXZhbmVtYV9sdWtrKG5hbWUpCgkKCWlmIHBsb3QgPT0gJ3Byb2dyYW1hcyc6CgkJdXJsbiA9ICIiCgkJdHJ5OiB1cmxuID0gYmFzZTY0LmI2NGRlY29kZSh1cmwpLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCXVybGNoYW1hID0gdXJsbi5zcGxpdCgnOzs7JykKCQl1cmxub28gPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC9zZWFyY2h1cmwucGhwP2NhbmFsPScrdXJsY2hhbWFbMF0rJyZ1cmw9Jyt1cmxjaGFtYVsxXSsnJmNsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZhZGRvbj0xJwoJCQoJCW1lbnNhZ2VtcHJvZ3Jlc3NvID0geGJtY2d1aS5EaWFsb2dQcm9ncmVzcygpCgkJbWVuc2FnZW1wcm9ncmVzc28uY3JlYXRlKEFkZG9uVGl0bGUsIHUnQWJyaXIgZW1pc3PDo28nLCdQb3IgZmF2b3IgYWd1YXJkZS4uLicpCgkJbWVuc2FnZW1wcm9ncmVzc28udXBkYXRlKDI1LCAiIiwgdSdPYnRlciB2aWRlbycsICIiKQoJCXJlc3VsdGFkbzEgPSBkZXZvbHZlcmVzdWx0YWRvKHVybG5vbykKCQltZW5zYWdlbXByb2dyZXNzby51cGRhdGUoNTAsICIiLCB1J1ByZXBhcmEtdGUsIHZhaSBjb21lw6dhciEnLCAiIikKCQlyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbzEpCgkJbWVuc2FnZW1wcm9ncmVzc28udXBkYXRlKDc1LCAiIiwgdSdCb2EgU2Vzc8OjbyEhIScsICIiKQoJCXVybG4gPSAiIgoJCWZvciBpIGluIHJlc3VsdGFkb1snaW5mb3JtYWNhbyddOgoJCQl0cnk6IHVybG4gPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ3VybCddKS5kZWNvZGUoJ3V0Zi04JykKCQkJZXhjZXB0OiBwYXNzCgkJCQoJCW1lbnNhZ2VtcHJvZ3Jlc3NvLmNsb3NlKCkKCQl4Ym1jLnNsZWVwKDUwMDApCgkJcGxheWxpc3QgPSB4Ym1jLlBsYXlMaXN0KHhibWMuUExBWUxJU1RfVklERU8pCgkJcGxheWxpc3QuY2xlYXIoKQoJCWluZm9fbGFiZWxzPXsiVGl0bGUiOnRpdGxlLCJGaWxlTmFtZSI6dGl0bGUsIlBsb3QiOnBsb3R9CgkJbGlzdGl0ZW09eGJtY2d1aS5MaXN0SXRlbSh0aXRsZSxpY29uSW1hZ2U9aW1hZ2UsdGh1bWJuYWlsSW1hZ2U9aW1hZ2UpCgkJbGlzdGl0ZW0uc2V0SW5mbyggInZpZGVvIiwgaW5mb19sYWJlbHMgKQoJCXBsYXlsaXN0LmFkZCh1cmw9dXJsbiwgbGlzdGl0ZW09bGlzdGl0ZW0sIGluZGV4PTEpCgkJeGJtYy5QbGF5ZXIoKS5wbGF5KHBsYXlsaXN0KQoJZWxzZToKCQlwbGF5bGlzdCA9IHhibWMuUGxheUxpc3QoeGJtYy5QTEFZTElTVF9WSURFTykKCQlwbGF5bGlzdC5jbGVhcigpCgkJaW5mb19sYWJlbHM9eyJUaXRsZSI6dGl0bGUsIkZpbGVOYW1lIjp0aXRsZSwiUGxvdCI6cGxvdH0KCQlsaXN0aXRlbT14Ym1jZ3VpLkxpc3RJdGVtKHRpdGxlLGljb25JbWFnZT1pbWFnZSx0aHVtYm5haWxJbWFnZT1pbWFnZSkKCQlsaXN0aXRlbS5zZXRJbmZvKCAidmlkZW8iLCBpbmZvX2xhYmVscyApCgkJcGxheWxpc3QuYWRkKHVybD11cmwsIGxpc3RpdGVtPWxpc3RpdGVtLCBpbmRleD0xKQoJCXhibWMuUGxheWVyKCkucGxheShwbGF5bGlzdCkKCQoKZGVmIHN5bmNfZGF0YShjaGFubmVsKToKCXZpZGVvID0gYmFzZTY0LmI2NGRlY29kZShjaGFubmVsKQoJcmV0dXJuIHZpZGVvCgpkZWYgcmVzdGFydF9zZXJ2aWNlKHBhcmFtcyk6Cgl2YW5lbWFsdWtrPV9fQURET05fXy5nZXRTZXR0aW5nKCJsb2dpbl9hZHVsdG9zX3NpbSIpCglpZiB2YW5lbWFsdWtrID09ICJ0cnVlIjoKCQlwZWFsa2lyaSA9IHBhcmFtcy5nZXQoc3luY19kYXRhKCJkR2wwYkdVPSIpKQoJCXZhbmVtYV9sdWtrKHBlYWxraXJpKQoJbG9wcGxpbmsgPSBwYXJhbXMuZ2V0KHZvZF9jaGFubmVscygiZFhKcyIpKQoJCgl4Ym1jcGx1Z2luLnNldFJlc29sdmVkVXJsKGludChzeXMuYXJndlsxXSksIFRydWUsIGxpc3RpdGVtKQoKZGVmIGdyYWJfZXBnKHVybCk6CglyZXEgPSB1cmxsaWIyLlJlcXVlc3QodXJsKQoJcmVxLmFkZF9oZWFkZXIoJ1VzZXItYWdlbnQnLCAnTW96aWxsYS81LjAgKFdpbmRvd3M7IFU7IFdpbmRvd3MgTlQgNS4xOyBlbi1HQjsgcnY6MS45LjAuMykgR2Vja28vMjAwODA5MjQxNyBGaXJlZm94LzMuMC4zJykKCXJlcS5hZGRfaGVhZGVyKHN5bmNfZGF0YSgiVlhObGNpMUJaMlZ1ZEE9PSIpICwgdm9kX2NoYW5uZWxzKCJTMjlrYVNCd2JIVm5hVzRnWW5rZ1RHbDJaU0YwIikpCglyZXNwb25zZSA9IHVybGxpYjIudXJsb3BlbihyZXEpCglsaW5rPXJlc3BvbnNlLnJlYWQoKQoJaWYgbGluayAhPSAneyJ1c2VyX2luZm8iOnsiYXV0aCI6MH19JzoKCQlqZGF0YSA9IGpzb24ubG9hZHMobGluay5kZWNvZGUoJ3V0ZjgnKSkKCQlyZXNwb25zZS5jbG9zZSgpCgkJaWYgamRhdGE6CgkJCXJldHVybiBqZGF0YQoJZWxzZToKCQlyZXR1cm4gTm9uZQoJCmRlZiBrb250cm9sbCh1cmwpOgoJcmFuZG9tc3RyaW5nID0gZ3JhYl9lcGcodXJsKQoJa2FzdXRhamFpbmZvID0gcmFuZG9tc3RyaW5nW3N5bmNfZGF0YSgiZFhObGNsOXBibVp2IildCglrb250cm9sbCA9IGthc3V0YWphaW5mb1tnZXRfbGl2ZSgiWVhWMGFBPT0iKV0KCXJldHVybiBrb250cm9sbApkZWYgZ2V0X2xpdmUoY2hhbm5lbCk6Cgl2aWRlbyA9IGJhc2U2NC5iNjRkZWNvZGUoY2hhbm5lbCkKCXJldHVybiB2aWRlbwpkZWYgZXhlY3V0ZV9haW5mbyh1cmwpOgoJYW5kbWVkID0gZ3JhYl9lcGcodXJsKQoJa2FzdXRhamFBbmRtZWQgPSBhbmRtZWRbc3luY19kYXRhKCJkWE5sY2w5cGJtWnYiKV0KCXNlaXMgPSBrYXN1dGFqYUFuZG1lZFtnZXRfbGl2ZSgiYzNSaGRIVnoiKV0KCWFlZ3ViID0ga2FzdXRhamFBbmRtZWRbc3luY19kYXRhKCJaWGh3WDJSaGRHVT0iKV0KCWlmIGFlZ3ViOgoJCWFlZ3ViID0gZGF0ZXRpbWUuZGF0ZXRpbWUuZnJvbXRpbWVzdGFtcChpbnQoYWVndWIpKS5zdHJmdGltZSgnJUg6JU0gJWQuJW0uJVknKQoJZWxzZToKCQlhZWd1YiA9IHZvZF9jaGFubmVscygiVG1WMlpYST0iKSAKCXJhYmJpdHMgPSBrYXN1dGFqYUFuZG1lZFt2b2RfY2hhbm5lbHMoImFYTmZkSEpwWVd3PSIpXQoJaWYgcmFiYml0cyA9PSAiMCI6CgkJcmFiYml0cyA9IHN5bmNfZGF0YSgiVG04PSIpCgllbHNlOgoJCXJhYmJpdHMgPSBzeW5jX2RhdGEoIldXVnoiKQoJbGVhdmVtZWFsb25lID0ga2FzdXRhamFBbmRtZWRbZ2V0X2xpdmUoImJXRjRYMk52Ym01bFkzUnBiMjV6IildCglwb2xhcmJlYXJzID0ga2FzdXRhamFBbmRtZWRbc3luY19kYXRhKCJkWE5sY201aGJXVT0iKV0KCQoJYWRkTGlua0NhbmFsTGlzdGEoIltDT0xPUiA9IHdoaXRlXVV0aWxpemFkb3I6IFsvQ09MT1JdIitwb2xhcmJlYXJzLCIiLCIiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fY29uLnBuZycpLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19jb24ucG5nJyksJycpCgkKCWFkZExpbmtDYW5hbExpc3RhKCJbQ09MT1IgPSB3aGl0ZV1Fc3RhZG86IFsvQ09MT1JdIitzZWlzLCIiLCIiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fY29uLnBuZycpLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19jb24ucG5nJyksJycpCgkKCWFkZExpbmtDYW5hbExpc3RhKCJbQ09MT1IgPSB3aGl0ZV1FeHBpcmE6IFsvQ09MT1JdIithZWd1YiwiIiwiIixvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnaWNvX2Nvbi5wbmcnKSxvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZnVuZG9fY29uLnBuZycpLCcnKQoJCglhZGRMaW5rQ2FuYWxMaXN0YSgiW0NPTE9SID0gd2hpdGVdQ29udGEgZGUgVGVzdGU6IFsvQ09MT1JdIityYWJiaXRzLCIiLCIiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fY29uLnBuZycpLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19jb24ucG5nJyksJycpCgkKCWFkZExpbmtDYW5hbExpc3RhKCJbQ09MT1IgPSB3aGl0ZV1NYXhpbW8gZGUgQ29ubmVjOiBbL0NPTE9SXSIrbGVhdmVtZWFsb25lLCIiLCIiLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdpY29fY29uLnBuZycpLG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb19jb24ucG5nJyksJycpCgkKCXZpc3RhX0dydXBvcygpCgpkZWYgdmFuZW1hX2x1a2sobmFtZSk6CglhID0gJ1hYWCcsICdBZHVsdCcsICdBZHVsdHMnLCdBRFVMVCcsJ0FEVUxUUycsJ2FkdWx0JywnYWR1bHRzJywnUG9ybicsJ1BPUk4nLCdwb3JuJywnUG9ybicsJ3h4eCcKCWlmIGFueShzIGluIG5hbWUgZm9yIHMgaW4gYSk6CgkJeGJtYy5leGVjdXRlYnVpbHRpbigodSdYQk1DLk5vdGlmaWNhdGlvbigiQ29udHJvbG8gUGFyZW50YWwiLCAiTyBjYW5hbCBjb250ZW0gY29udGV1ZG8gYWR1bHRvIiwgMjAwMCknKSkKCQl0ZXh0ID0gcGx1Z2ludG9vbHMua2V5Ym9hcmRfaW5wdXQoZGVmYXVsdF90ZXh0PSIiLCB0aXRsZT0iQ29kaWdvIHBhcmEgY29udHJvbG8gcGFyZW50YWwiKQoJCWlmIHRleHQ9PXBsdWdpbnRvb2xzLmdldF9zZXR0aW5nKHN5bmNfZGF0YSgiYkc5bmFXNWZZV1IxYkhSdmN3PT0iKSk6CgkJICByZXR1cm4KCQllbHNlOgoJCSAgZXhpdCgpCgllbHNlOgoJCW5hbWUgPSAiIgoKZGVmIERvd25sb2FkZXJDbGFzcyh1cmwsZGVzdCk6CglkcCA9IHhibWNndWkuRGlhbG9nUHJvZ3Jlc3MoKQoJZHAuY3JlYXRlKHN5bmNfZGF0YSgiUjJWMGRHbHVaeUIxY0dSaGRHVT0iKSxnZXRfbGl2ZSgiUkc5M2JteHZZV1JwYm1jPSIpKQoJdXJsbGliLnVybHJldHJpZXZlKHVybCxkZXN0LGxhbWJkYSBuYiwgYnMsIGZzLCB1cmw9dXJsOiBfcGJob29rKG5iLGJzLGZzLHVybCxkcCkpCgpkZWYgX3BiaG9vayhudW1ibG9ja3MsIGJsb2Nrc2l6ZSwgZmlsZXNpemUsIHVybD1Ob25lLGRwPU5vbmUpOgoJdHJ5OgoJCXBlcmNlbnQgPSBtaW4oKG51bWJsb2NrcypibG9ja3NpemUqMTAwKS9maWxlc2l6ZSwgMTAwKQoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJycrcGVyY2VudCkKCQlkcC51cGRhdGUocGVyY2VudCkKCWV4Y2VwdDoKCQlwZXJjZW50ID0gMTAwCgkJZHAudXBkYXRlKHBlcmNlbnQpCglpZiBkcC5pc2NhbmNlbGVkKCk6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnTyBkb3dubG9hZCBmb2kgY2FuY2VsYWRvLicpCgkJZHAuY2xvc2UoKQoKZGVmIHZvZF9jaGFubmVscyhjaGFubmVsKToKCXZpZGVvID0gYmFzZTY0LmI2NGRlY29kZShjaGFubmVsKQoJcmV0dXJuIHZpZGVvCgpkZWYgUGxheVVybChuYW1lLCB1cmwsIGljb25pbWFnZT1Ob25lKToKCWxpc3RpdGVtID0geGJtY2d1aS5MaXN0SXRlbShwYXRoPXVybCwgdGh1bWJuYWlsSW1hZ2U9aWNvbmltYWdlKQoJbGlzdGl0ZW0uc2V0SW5mbyh0eXBlPSJWaWRlbyIsIGluZm9MYWJlbHM9eyAiVGl0bGUiOiBuYW1lIH0pCgl4Ym1jcGx1Z2luLnNldFJlc29sdmVkVXJsKGludChzeXMuYXJndlsxXSksIFRydWUsIGxpc3RpdGVtKQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMJCQkJCQkJCQkJCQkJTWVudSBUViBBcnF1aXZvCQkJCQkJCQkJCQkgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCmRlZiBsaXN0YXR2YXJjaGl2ZSh1cmwpOgoJZW5kZXJlY28gPSB1cmwrInBhbmVsX2FwaS5waHA/dXNlcm5hbWU9IitfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fbmFtZScpKyImcGFzc3dvcmQ9IitfX0FERE9OX18uZ2V0U2V0dGluZygnbG9naW5fcGFzc3dvcmQnKSsiJmFjdGlvbj1nZXRfbGl2ZV9zdHJlYW1zIgoJI2lJaUlJSWkgPSB1cmxsaWIyLnVybG9wZW4oZW5kZXJlY28pCgkjb29vMDBPT09vb08JPSBqc29uLmxvYWQoaUlpSUlJaSkKCXJlcSA9IHVybGxpYjIuUmVxdWVzdChlbmRlcmVjbykKCXJlcS5hZGRfaGVhZGVyKHN5bmNfZGF0YSgiVlhObGNpMUJaMlZ1ZEE9PSIpICwgdm9kX2NoYW5uZWxzKCJTMjlrYVNCd2JIVm5hVzRnWW5rZ1RHbDJaU0YwIikpCglyZXNwb25zZSA9IHVybGxpYjIudXJsb3BlbihyZXEpCglsaW5rPXJlc3BvbnNlLnJlYWQoKQoJb29vMDBPT09vb08JPSBqc29uLmxvYWRzKGxpbmsuZGVjb2RlKCd1dGY4JykpCglyZXNwb25zZS5jbG9zZSgpCglPMDBPT09vT29vME8gPSBvb28wME9PT29vT1snYXZhaWxhYmxlX2NoYW5uZWxzJ10KCWZvcglPMDAwT09vMDBvbwlpbglPMDBPT09vT29vME8udmFsdWVzKCk6CgkJb28wT09vID0gTzAwME9PbzAwb29bJ3R2X2FyY2hpdmUnXQoJCWlmKG9vME9PbyA9PSAxKToKCQkJbmFtZXR2PU8wMDBPT28wMG9vWyduYW1lJ10KCQkJc3RyZWFtX2lkPU8wMDBPT28wMG9vWydzdHJlYW1faWQnXQoJCQlsb2dvX3R2PU8wMDBPT28wMG9vWydzdHJlYW1faWNvbiddCgkJCWR1cmF0aW9uID0gTzAwME9PbzAwb29bJ3R2X2FyY2hpdmVfZHVyYXRpb24nXQoJCQkKCQkJYWRkTGlua0dydXBvKG5hbWV0dixsb2dvX3R2LHN0cmVhbV9pZCx1cmwsZHVyYXRpb24sb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3R2X2FyYy5wbmcnKSwxKQoJCgl2aXN0YV9HcnVwb3MoKQoKZGVmIGxpc3RhdHZhcmNoaXZlY2FuYWlzKG5hbWUsc3RyZWFtX2lkLHVybCxkdXJhdGlvbixpY29uaW1hZ2UsZmFuYXJ0KToKCWVuZGVyZWNvID0gdXJsKyJwYW5lbF9hcGkucGhwP3VzZXJuYW1lPSIrX19BRERPTl9fLmdldFNldHRpbmcoJ2xvZ2luX25hbWUnKSsiJnBhc3N3b3JkPSIrX19BRERPTl9fLmdldFNldHRpbmcoJ2xvZ2luX3Bhc3N3b3JkJykrIiZhY3Rpb249Z2V0X2VwZyZzdHJlYW1faWQ9IitzdHJlYW1faWQKCSNpSWlJSUlpID0gdXJsbGliMi51cmxvcGVuKGVuZGVyZWNvKQoJI2lpaUkxMQk9IGpzb24ubG9hZChpSWlJSUlpKQoJcmVxID0gdXJsbGliMi5SZXF1ZXN0KGVuZGVyZWNvKQoJcmVxLmFkZF9oZWFkZXIoc3luY19kYXRhKCJWWE5sY2kxQloyVnVkQT09IikgLCB2b2RfY2hhbm5lbHMoIlMyOWthU0J3YkhWbmFXNGdZbmtnVEdsMlpTRjAiKSkKCXJlc3BvbnNlID0gdXJsbGliMi51cmxvcGVuKHJlcSkKCWxpbms9cmVzcG9uc2UucmVhZCgpCglpaWlJMTEJPSBqc29uLmxvYWRzKGxpbmsuZGVjb2RlKCd1dGY4JykpCglyZXNwb25zZS5jbG9zZSgpCgkKCWlpSWlJID0gZGF0ZXRpbWUuZGF0ZXRpbWUudXRjbm93KCkgLSBkYXRldGltZS50aW1lZGVsdGEoZGF5cz1pbnQoZHVyYXRpb24pKQoJbzAwb29vTzBPbwk9Y2FsZW5kYXIudGltZWdtKGlpSWlJLnRpbWV0dXBsZSgpKQoJbzAwb29vTzBPbwk9aW50KG8wMG9vb08wT28pCglvME8wT09PME9vbwk9dGltZS50aW1lKCkKCW8wTzBPT08wT29vCT1pbnQobzBPME9PTzBPb28pCgkKCWZvcglpaUlpSUkxCWluCWlpaUkxMQk6CgkJdGl0bGVfdHYgPSBpaUlpSUkxWyd0aXRsZSddCgkJdGl0bGVfdHY9YmFzZTY0LmI2NGRlY29kZSh0aXRsZV90dikKCQlzdGFydAk9IGludChpaUlpSUkxWydzdGFydCddKQoJCWVuZAk9IGludChpaUlpSUkxWydlbmQnXSkKCQlzZWd1bmRvID0gMC4wMTY2NjY2NjY3CgkJCgkJZHVyYWNhbyA9IGludCgoZW5kLXN0YXJ0KSpzZWd1bmRvKQoJCQoJCWlmKHN0YXJ0ID4gbzAwb29vTzBPbyBhbmQgc3RhcnQgPCBvME8wT09PME9vbyk6CgkJCWlmIDkwIC0gOTA6CU9vbzAJJQlPbzBvb08wb28wb08JLwlPbzBvTzBvb28KCQkJSUlpID0gZGF0ZXRpbWUuZGF0ZXRpbWUuZnJvbXRpbWVzdGFtcChpbnQoc3RhcnQpKS5zdHJmdGltZSgnJWQuJW0gJUg6JU0nKQoJCQlpMUlpaTFpMUkgPSBkYXRldGltZS5kYXRldGltZS5mcm9tdGltZXN0YW1wKGludChzdGFydCkpLnN0cmZ0aW1lKCclWS0lbS0lZDolSDolTScpCgkJCXRpdGxlX3R2ID0gSUlpICsgIiAiICsgdGl0bGVfdHYKCQkJZW5kZXJlY28gPSB1cmwrInN0cmVhbWluZy90aW1lc2hpZnQucGhwP3VzZXJuYW1lPSIrX19BRERPTl9fLmdldFNldHRpbmcoJ2xvZ2luX25hbWUnKSsiJnBhc3N3b3JkPSIrX19BRERPTl9fLmdldFNldHRpbmcoJ2xvZ2luX3Bhc3N3b3JkJykrIiZzdHJlYW09IitzdHJlYW1faWQrIiZzdGFydD0iK2kxSWlpMWkxSSsiJmR1cmF0aW9uPSIrc3RyKGR1cmFjYW8pCgkJCQoJCQlhZGRMaW5rQ2FuYWwodGl0bGVfdHYsZW5kZXJlY28saWNvbmltYWdlLCcwMDAxJywnJykKCQoJdmlzdGFfQ2FuYWlzKCkKCmRlZiBhZGRMaW5rR3J1cG8odGl0bGUsdGh1bWJuYWlsLHN0cmVhbV9pZCx1cmwsZHVyYXRpb24sZmFuYXJ0LHR5cGUpOgoJb2s9VHJ1ZQoJCglsaXN0aXRlbT14Ym1jZ3VpLkxpc3RJdGVtKHRpdGxlLGljb25JbWFnZT10aHVtYm5haWwsdGh1bWJuYWlsSW1hZ2U9dGh1bWJuYWlsKQoJaW5mb19sYWJlbHM9eyJUaXRsZSI6dGl0bGUsIkZpbGVOYW1lIjp0aXRsZX0KCWxpc3RpdGVtLnNldEluZm8oICJ2aWRlbyIsIGluZm9fbGFiZWxzICkKCWxpc3RpdGVtLnNldFByb3BlcnR5KCdmYW5hcnRfaW1hZ2UnLGZhbmFydCkKCXhibWNwbHVnaW4uc2V0UGx1Z2luRmFuYXJ0KGludChzeXMuYXJndlsxXSksZmFuYXJ0KQoJCgl1ID0gc3lzLmFyZ3ZbMF0gKyAiP3VybD0iICsgc3RyKHVybCkgKyAiJm1vZGU9NyZuYW1lPSIgKyBzdHIodGl0bGUpICsgIiZpY29uaW1hZ2U9IitzdHIodGh1bWJuYWlsKSsiJmZhbmFydD0iK3N0cihmYW5hcnQpKyImc3RyZWFtX2lkPSIrc3RyKHN0cmVhbV9pZCkrIiZkdXJhdGlvbj0iK2R1cmF0aW9uCgkKCW9rPXhibWNwbHVnaW4uYWRkRGlyZWN0b3J5SXRlbShoYW5kbGU9aW50KHN5cy5hcmd2WzFdKSx1cmw9dSxsaXN0aXRlbT1saXN0aXRlbSxpc0ZvbGRlcj1UcnVlKQoJCglyZXR1cm4gb2sKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCQkJCQkJCQkJCQkJCUFicmlyIFNldHRpbmcJCQkJCQkJCQkJICMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpkZWYgYWJyaXJEZWZpbmluY29lcygpOgoJX19BRERPTl9fLm9wZW5TZXR0aW5ncygpCgl2aXN0YV9tZW51KCkKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMjIwkJQ2xlYXIgQ2FjaGUJCSMjIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZGVmIENMRUFSQ0FDSEUoKToKCXhibWNfY2FjaGVfcGF0aCA9IG9zLnBhdGguam9pbih4Ym1jLnRyYW5zbGF0ZVBhdGgoJ3NwZWNpYWw6Ly9ob21lJyksICdjYWNoZScpCglpZiBvcy5wYXRoLmV4aXN0cyh4Ym1jX2NhY2hlX3BhdGgpPT1UcnVlOgkKCQlmb3Igcm9vdCwgZGlycywgZmlsZXMgaW4gb3Mud2Fsayh4Ym1jX2NhY2hlX3BhdGgpOgoJCQlmaWxlX2NvdW50ID0gMAoJCQlmaWxlX2NvdW50ICs9IGxlbihmaWxlcykKCQkJaWYgZmlsZV9jb3VudCA+IDA6CgkKCQkJCWRpYWxvZyA9IHhibWNndWkuRGlhbG9nKCkKCQkJCWlmIGRpYWxvZy55ZXNubygiQXBhZ2FyIENhY2hlIG5vIFhCTUMuIiwgc3RyKGZpbGVfY291bnQpICsgIiBmaWNoZWlyb3MgZW5jb250cmFkb3MuIiwgIlF1ZXIgYXBhZ2FyIHRvZG9zIG9zIGZpY2hlaXJvcyBlbSBjYWNoZT8iKToKCQkJCQoJCQkJCWZvciBmIGluIGZpbGVzOgoJCQkJCQl0cnk6CgkJCQkJCQlvcy51bmxpbmsob3MucGF0aC5qb2luKHJvb3QsIGYpKQoJCQkJCQlleGNlcHQ6CgkJCQkJCQlwYXNzCgkJCQkJZm9yIGQgaW4gZGlyczoKCQkJCQkJdHJ5OgoJCQkJCQkJc2h1dGlsLnJtdHJlZShvcy5wYXRoLmpvaW4ocm9vdCwgZCkpCgkJCQkJCWV4Y2VwdDoKCQkJCQkJCXBhc3MKCQkJCQkJCgkJCWVsc2U6CgkJCQlwYXNzCglpZiB4Ym1jLmdldENvbmRWaXNpYmlsaXR5KCdzeXN0ZW0ucGxhdGZvcm0uQVRWMicpOgoJCWF0djJfY2FjaGVfYSA9IG9zLnBhdGguam9pbignL3ByaXZhdGUvdmFyL21vYmlsZS9MaWJyYXJ5L0NhY2hlcy9BcHBsZVRWL1ZpZGVvLycsICdPdGhlcicpCgkJCgkJZm9yIHJvb3QsIGRpcnMsIGZpbGVzIGluIG9zLndhbGsoYXR2Ml9jYWNoZV9hKToKCQkJZmlsZV9jb3VudCA9IDAKCQkJZmlsZV9jb3VudCArPSBsZW4oZmlsZXMpCgkJCgkJCWlmIGZpbGVfY291bnQgPiAwOgoKCQkJCWRpYWxvZyA9IHhibWNndWkuRGlhbG9nKCkKCQkJCWlmIGRpYWxvZy55ZXNubygiQXBhZ2FyIGZpY2hlaXJvcyBBVFYyLiIsIHN0cihmaWxlX2NvdW50KSArICIgZmljaGVpcm9zIGVuY29udHJhZG9zIGVtICdPdXRyb3MnIiwgIlF1ZXIgYXBhZ2FyIHRvZG9zIG9zIGZpY2hlaXJvcyBlbSBjYWNoZT8iKToKCQkJCQoJCQkJCWZvciBmIGluIGZpbGVzOgoJCQkJCQlvcy51bmxpbmsob3MucGF0aC5qb2luKHJvb3QsIGYpKQoJCQkJCWZvciBkIGluIGRpcnM6CgkJCQkJCXNodXRpbC5ybXRyZWUob3MucGF0aC5qb2luKHJvb3QsIGQpKQoJCQkJCQkKCQkJZWxzZToKCQkJCXBhc3MKCQlhdHYyX2NhY2hlX2IgPSBvcy5wYXRoLmpvaW4oJy9wcml2YXRlL3Zhci9tb2JpbGUvTGlicmFyeS9DYWNoZXMvQXBwbGVUVi9WaWRlby8nLCAnTG9jYWxBbmRSZW50YWwnKQoJCQoJCWZvciByb290LCBkaXJzLCBmaWxlcyBpbiBvcy53YWxrKGF0djJfY2FjaGVfYik6CgkJCWZpbGVfY291bnQgPSAwCgkJCWZpbGVfY291bnQgKz0gbGVuKGZpbGVzKQoJCQoJCQlpZiBmaWxlX2NvdW50ID4gMDoKCgkJCQlkaWFsb2cgPSB4Ym1jZ3VpLkRpYWxvZygpCgkJCQlpZiBkaWFsb2cueWVzbm8oIkFwYWdhciBmaWNoZWlyb3MgQVRWMi4iLCBzdHIoZmlsZV9jb3VudCkgKyAiIGZpY2hlaXJvcyBlbmNvbnRyYWRvcyBlbSAnTG9jYWwnIiwgIlF1ZXIgYXBhZ2FyIHRvZG9zIG9zIGZpY2hlaXJvcyBlbSBjYWNoZT8iKToKCQkJCQoJCQkJCWZvciBmIGluIGZpbGVzOgoJCQkJCQlvcy51bmxpbmsob3MucGF0aC5qb2luKHJvb3QsIGYpKQoJCQkJCWZvciBkIGluIGRpcnM6CgkJCQkJCXNodXRpbC5ybXRyZWUob3MucGF0aC5qb2luKHJvb3QsIGQpKQoJCQkJCQkKCQkJZWxzZToKCQkJCXBhc3MKCQkJICAjIFNldCBwYXRoIHRvIEN5ZGlhIEFyY2hpdmVzIGNhY2hlIGZpbGVzCgkJCQkJCQkgCgoJIyBTZXQgcGF0aCB0byBXaGF0IHRoIEZ1cmsgY2FjaGUgZmlsZXMKCXd0Zl9jYWNoZV9wYXRoID0gb3MucGF0aC5qb2luKHhibWMudHJhbnNsYXRlUGF0aCgnc3BlY2lhbDovL3Byb2ZpbGUvYWRkb25fZGF0YS9wbHVnaW4udmlkZW8ud2hhdHRoZWZ1cmsvY2FjaGUnKSwgJycpCglpZiBvcy5wYXRoLmV4aXN0cyh3dGZfY2FjaGVfcGF0aCk9PVRydWU6CQoJCWZvciByb290LCBkaXJzLCBmaWxlcyBpbiBvcy53YWxrKHd0Zl9jYWNoZV9wYXRoKToKCQkJZmlsZV9jb3VudCA9IDAKCQkJZmlsZV9jb3VudCArPSBsZW4oZmlsZXMpCgkJCgkJIyBDb3VudCBmaWxlcyBhbmQgZ2l2ZSBvcHRpb24gdG8gZGVsZXRlCgkJCWlmIGZpbGVfY291bnQgPiAwOgoJCgkJCQlkaWFsb2cgPSB4Ym1jZ3VpLkRpYWxvZygpCgkJCQlpZiBkaWFsb2cueWVzbm8oIkFwYWdhciBhIGNhY2hlIFdURi4iLCBzdHIoZmlsZV9jb3VudCkgKyAiIGZpY2hlaXJvcyBlbmNvbnRyYWRvcy4iLCAiUXVlciBhcGFnYXIgdG9kb3Mgb3MgZmljaGVpcm9zIGVtIGNhY2hlPyIpOgoJCQkJCgkJCQkJZm9yIGYgaW4gZmlsZXM6CgkJCQkJCW9zLnVubGluayhvcy5wYXRoLmpvaW4ocm9vdCwgZikpCgkJCQkJZm9yIGQgaW4gZGlyczoKCQkJCQkJc2h1dGlsLnJtdHJlZShvcy5wYXRoLmpvaW4ocm9vdCwgZCkpCgkJCQkJCQoJCQllbHNlOgoJCQkJcGFzcwoJCQkJCgkJCQkjIFNldCBwYXRoIHRvIDRvRCBjYWNoZSBmaWxlcwoJY2hhbm5lbDRfY2FjaGVfcGF0aD0gb3MucGF0aC5qb2luKHhibWMudHJhbnNsYXRlUGF0aCgnc3BlY2lhbDovL3Byb2ZpbGUvYWRkb25fZGF0YS9wbHVnaW4udmlkZW8uNG9kL2NhY2hlJyksICcnKQoJaWYgb3MucGF0aC5leGlzdHMoY2hhbm5lbDRfY2FjaGVfcGF0aCk9PVRydWU6CQoJCWZvciByb290LCBkaXJzLCBmaWxlcyBpbiBvcy53YWxrKGNoYW5uZWw0X2NhY2hlX3BhdGgpOgoJCQlmaWxlX2NvdW50ID0gMAoJCQlmaWxlX2NvdW50ICs9IGxlbihmaWxlcykKCQkKCQkjIENvdW50IGZpbGVzIGFuZCBnaXZlIG9wdGlvbiB0byBkZWxldGUKCQkJaWYgZmlsZV9jb3VudCA+IDA6CgkKCQkJCWRpYWxvZyA9IHhibWNndWkuRGlhbG9nKCkKCQkJCWlmIGRpYWxvZy55ZXNubygiQXBhZ2FyIGZpY2hlaXJvcyA0b0QgZW0gY2FjaGUuIiwgc3RyKGZpbGVfY291bnQpICsgIiBmaWNoZWlyb3MgZW5jb250cmFkb3MuIiwgIlF1ZXIgYXBhZ2FyIHRvZG9zIG9zIGZpY2hlaXJvcyBlbSBjYWNoZT8iKToKCQkJCQoJCQkJCWZvciBmIGluIGZpbGVzOgoJCQkJCQlvcy51bmxpbmsob3MucGF0aC5qb2luKHJvb3QsIGYpKQoJCQkJCWZvciBkIGluIGRpcnM6CgkJCQkJCXNodXRpbC5ybXRyZWUob3MucGF0aC5qb2luKHJvb3QsIGQpKQoJCQkJCQkKCQkJZWxzZToKCQkJCXBhc3MKCQkJCQoJCQkJIyBTZXQgcGF0aCB0byBCQkMgaVBsYXllciBjYWNoZSBmaWxlcwoJaXBsYXllcl9jYWNoZV9wYXRoPSBvcy5wYXRoLmpvaW4oeGJtYy50cmFuc2xhdGVQYXRoKCdzcGVjaWFsOi8vcHJvZmlsZS9hZGRvbl9kYXRhL3BsdWdpbi52aWRlby5pcGxheWVyL2lwbGF5ZXJfaHR0cF9jYWNoZScpLCAnJykKCWlmIG9zLnBhdGguZXhpc3RzKGlwbGF5ZXJfY2FjaGVfcGF0aCk9PVRydWU6CQoJCWZvciByb290LCBkaXJzLCBmaWxlcyBpbiBvcy53YWxrKGlwbGF5ZXJfY2FjaGVfcGF0aCk6CgkJCWZpbGVfY291bnQgPSAwCgkJCWZpbGVfY291bnQgKz0gbGVuKGZpbGVzKQoJCQoJCSMgQ291bnQgZmlsZXMgYW5kIGdpdmUgb3B0aW9uIHRvIGRlbGV0ZQoJCQlpZiBmaWxlX2NvdW50ID4gMDoKCQoJCQkJZGlhbG9nID0geGJtY2d1aS5EaWFsb2coKQoJCQkJaWYgZGlhbG9nLnllc25vKCJBcGFnYXIgZmljaGVpcm9zIEJCQyBpUGxheWVyIGVtIGNhY2hlLiIsIHN0cihmaWxlX2NvdW50KSArICIgZmljaGVpcm9zIGVuY29udHJhZG9zLiIsICJRdWVyIGFwYWdhciB0b2RvcyBvcyBmaWNoZWlyb3MgZW0gY2FjaGU/Iik6CgkJCQkKCQkJCQlmb3IgZiBpbiBmaWxlczoKCQkJCQkJb3MudW5saW5rKG9zLnBhdGguam9pbihyb290LCBmKSkKCQkJCQlmb3IgZCBpbiBkaXJzOgoJCQkJCQlzaHV0aWwucm10cmVlKG9zLnBhdGguam9pbihyb290LCBkKSkKCQkJCQkJCgkJCWVsc2U6CgkJCQlwYXNzCgkJCQkKCQkJCQoJCQkJIyBTZXQgcGF0aCB0byBTaW1wbGUgRG93bmxvYWRlciBjYWNoZSBmaWxlcwoJZG93bmxvYWRlcl9jYWNoZV9wYXRoID0gb3MucGF0aC5qb2luKHhibWMudHJhbnNsYXRlUGF0aCgnc3BlY2lhbDovL3Byb2ZpbGUvYWRkb25fZGF0YS9zY3JpcHQubW9kdWxlLnNpbXBsZS5kb3dubG9hZGVyJyksICcnKQoJaWYgb3MucGF0aC5leGlzdHMoZG93bmxvYWRlcl9jYWNoZV9wYXRoKT09VHJ1ZToJCgkJZm9yIHJvb3QsIGRpcnMsIGZpbGVzIGluIG9zLndhbGsoZG93bmxvYWRlcl9jYWNoZV9wYXRoKToKCQkJZmlsZV9jb3VudCA9IDAKCQkJZmlsZV9jb3VudCArPSBsZW4oZmlsZXMpCgkJCgkJIyBDb3VudCBmaWxlcyBhbmQgZ2l2ZSBvcHRpb24gdG8gZGVsZXRlCgkJCWlmIGZpbGVfY291bnQgPiAwOgoJCgkJCQlkaWFsb2cgPSB4Ym1jZ3VpLkRpYWxvZygpCgkJCQlpZiBkaWFsb2cueWVzbm8oIkFwYWdhciBmaWNoZWlyb3MgU2ltcGxlIERvd25sb2FkZXIgZW0gY2FjaGUuIiwgc3RyKGZpbGVfY291bnQpICsgIiBmaWNoZWlyb3MgZW5jb250cmFkb3MuIiwgIlF1ZXIgYXBhZ2FyIHRvZG9zIG9zIGZpY2hlaXJvcyBlbSBjYWNoZT8iKToKCQkJCQoJCQkJCWZvciBmIGluIGZpbGVzOgoJCQkJCQlvcy51bmxpbmsob3MucGF0aC5qb2luKHJvb3QsIGYpKQoJCQkJCWZvciBkIGluIGRpcnM6CgkJCQkJCXNodXRpbC5ybXRyZWUob3MucGF0aC5qb2luKHJvb3QsIGQpKQoJCQkJCQkKCQkJZWxzZToKCQkJCXBhc3MKCQoJaXR2X2NhY2hlX3BhdGggPSBvcy5wYXRoLmpvaW4oeGJtYy50cmFuc2xhdGVQYXRoKCdzcGVjaWFsOi8vcHJvZmlsZS9hZGRvbl9kYXRhL3BsdWdpbi52aWRlby5pdHYvSW1hZ2VzJyksICcnKQoJaWYgb3MucGF0aC5leGlzdHMoaXR2X2NhY2hlX3BhdGgpPT1UcnVlOgkKCQlmb3Igcm9vdCwgZGlycywgZmlsZXMgaW4gb3Mud2FsayhpdHZfY2FjaGVfcGF0aCk6CgkJCWZpbGVfY291bnQgPSAwCgkJCWZpbGVfY291bnQgKz0gbGVuKGZpbGVzKQoJCQkKCQkJaWYgZmlsZV9jb3VudCA+IDA6CgkKCQkJCWRpYWxvZyA9IHhibWNndWkuRGlhbG9nKCkKCQkJCWlmIGRpYWxvZy55ZXNubygiQXBhZ2FyIGl0ZW1zIGVtIGNhY2hlIiwgc3RyKGZpbGVfY291bnQpICsgIiBmaWNoZWlyb3MgZW5jb250cmFkb3MuIiwgIlF1ZXIgYXBhZ2FyIHRvZG9zIG9zIGZpY2hlaXJvcyBlbSBjYWNoZT8iKToKCQkJCQoJCQkJCWZvciBmIGluIGZpbGVzOgoJCQkJCQlvcy51bmxpbmsob3MucGF0aC5qb2luKHJvb3QsIGYpKQoJCQkJCWZvciBkIGluIGRpcnM6CgkJCQkJCXNodXRpbC5ybXRyZWUob3MucGF0aC5qb2luKHJvb3QsIGQpKQoJCQkJCQkKCQkJZWxzZToKCQkJCXBhc3MKCWRpYWxvZyA9IHhibWNndWkuRGlhbG9nKCkKCWRpYWxvZy5vayhBZGRvblRpdGxlLCAiCQlDYWNoZSBhcGFnYWRhIGNvbSBzdWNlc3NvISIpCgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyMjCSBQdXJnZSBQYWNrYWdlcwkJIyMjCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpkZWYgUFVSR0VQQUNLQUdFUygpOgoJcGFja2FnZXNfY2FjaGVfcGF0aCA9IHhibWMudHJhbnNsYXRlUGF0aChvcy5wYXRoLmpvaW4oJ3NwZWNpYWw6Ly9ob21lL2FkZG9ucy9wYWNrYWdlcycsICcnKSkKCXRyeToJCgkJZm9yIHJvb3QsIGRpcnMsIGZpbGVzIGluIG9zLndhbGsocGFja2FnZXNfY2FjaGVfcGF0aCk6CgkJCWZpbGVfY291bnQgPSAwCgkJCWZpbGVfY291bnQgKz0gbGVuKGZpbGVzKQoJCQkKCQkJaWYgZmlsZV9jb3VudCA+IDA6CgkKCQkJCWRpYWxvZyA9IHhibWNndWkuRGlhbG9nKCkKCQkJCWlmIGRpYWxvZy55ZXNubygiRXhjbHVpciBpbmZvcm1hw6fDo28gZW0gQ2FjaGUuIiwgc3RyKGZpbGVfY291bnQpICsgIiBmaWNoZWlyb3MgZW5jb250cmFkb3MuIiwgIlF1ZXIgYXBhZ2FyIHRvZG9zIG9zIGZpY2hlaXJvcz8iKToKCQkJCQkJCQoJCQkJCWZvciBmIGluIGZpbGVzOgoJCQkJCQlvcy51bmxpbmsob3MucGF0aC5qb2luKHJvb3QsIGYpKQoJCQkJCWZvciBkIGluIGRpcnM6CgkJCQkJCXNodXRpbC5ybXRyZWUob3MucGF0aC5qb2luKHJvb3QsIGQpKQoJCQkJCWRpYWxvZyA9IHhibWNndWkuRGlhbG9nKCkKCQkJCQlkaWFsb2cub2soQWRkb25UaXRsZSwgIgkJS29kaSBsaW1wbyBjb20gc3VjZXNzby4iKQoJCQkJZWxzZToKCQkJCQkJcGFzcwoJCQllbHNlOgoJCQkJZGlhbG9nID0geGJtY2d1aS5EaWFsb2coKQoJCQkJZGlhbG9nLm9rKEFkZG9uVGl0bGUsICIJCU7Do28gZm9yYW0gZW5jb250cmFkb3MgZmljaGVpcm9zIGEgYXBhZ2FyLiIpCglleGNlcHQ6IAoJCWRpYWxvZyA9IHhibWNndWkuRGlhbG9nKCkKCQlkaWFsb2cub2soQWRkb25UaXRsZSwgIkVycm8gYW8gdGVudGFyIGFwYWdhciBmaWNoZWlyb3MgZW0gY2FjaGUuIikKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCQkJCQkJCQkJCQkJQWRkb24gTElWRUlUIEZpbG1lcyBlIFNlcmllcwkJCQkJCQkgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKZGVmIGRldm9sdmVyZXN1bHRhZG8odXJsbm9vKToKCXJlc3VsdGFkbyA9IGFicmlyX3VybCh1cmxub28sIGhlYWRlcj1oZWFkZXJzKQoJdHJ5OgoJCXJlc3VsdGFkbyA9IHJlc3VsdGFkby5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDoKCQlyZXN1bHRhZG8gPSByZXN1bHRhZG8uZW5jb2RlKCd1dGYtOCcpCglyZXR1cm4gcmVzdWx0YWRvCgpkZWYgZ2V0Q2F0ZWdvcmlhbGl2ZShpZCxpbmljaW8pOgoJY2F0ID0gbGVyX2ZpY2hlaXJvKG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ2NhdGVnb3JpYXNfbGl2ZS5saXZlaXQnKSkucmVwbGFjZSgnIicsICInIikKCXJldHVybiBjYXQKCQpkZWYgZ2V0U2FnYXNsaXZlKGlkLGluaWNpbyk6CgljYXQgPSBsZXJfZmljaGVpcm8ob3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnc2FnYXNfbGl2ZS5saXZlaXQnKSkucmVwbGFjZSgnIicsICInIikKCXJldHVybiBjYXQKCmRlZiBnZXRBbm9zbGl2ZShpZCxpbmljaW8pOgoJY2F0ID0gbGVyX2ZpY2hlaXJvKG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ2Fub3NfbGl2ZS5saXZlaXQnKSkucmVwbGFjZSgnIicsICInIikKCXJldHVybiBjYXQKCmRlZiBsb2dpbmxpbGkoaW5pY2lvKToKCXJlc3VsdGFkbyA9IEZhbHNlCgllcnJvcyA9ICIiCgl0cnk6CgkJdXJsbm9vID0gX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJmFkZG9uPTEmdGlwbz0nK2luaWNpbwoJCXJlc3VsdGFkbyA9IGRldm9sdmVyZXN1bHRhZG8odXJsbm9vKQoJCWVzY3JldmVyX2ZpY2hlaXJvKG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ2RlZmluaWNvZXNfbGl2ZS5saXZlaXQnKSwgcmVzdWx0YWRvKQoJCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJCWNhdGVnb3JpYXMgPSByZXN1bHRhZG9bJ2dydXBvcyddCgkJZXNjcmV2ZXJfZmljaGVpcm8ob3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnY2F0ZWdvcmlhc19saXZlLmxpdmVpdCcpLCBzdHIoY2F0ZWdvcmlhcykpCgkJYW5vcyA9IHJlc3VsdGFkb1snYW5vcyddCgkJZXNjcmV2ZXJfZmljaGVpcm8ob3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnYW5vc19saXZlLmxpdmVpdCcpLCBzdHIoYW5vcykpCgkJCgkJaWYgaW5pY2lvID09ICdpbmljaW9fZmlsbWVzJzoKCQkJc2FnYXMgPSByZXN1bHRhZG9bJ3NhZ2FzJ10KCQkJZXNjcmV2ZXJfZmljaGVpcm8ob3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnc2FnYXNfbGl2ZS5saXZlaXQnKSwgc3RyKHNhZ2FzKSkKCQlyZXR1cm4gVHJ1ZQoJZXhjZXB0OgoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ07Do28gZm9pIHBvc3PDrXZlbCBhYnJpciBhIHDDoWdpbmEuIFBvciBmYXZvciB0ZW50ZSBub3ZhbWVudGUuJykKCQlyZXR1cm4gRmFsc2UKCmRlZiBsaXN0YW1lbnVzX2xpdmVpdDEoKToKCWNoZWNrX2xvZ2luID0gbG9naW5saWxpKCdpbmljaW9fZmlsbWVzJykKCWlmIGNoZWNrX2xvZ2luID09IFRydWU6CgkJbWVudUZpbG1lczIob3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ZpbG1lcy5wbmcnKSxfX1NJVEVBZGRvbl9fKydJbWFnZW5zL2ZpbG1lc19mYW5hcnQucG5nJykKCWVsc2U6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnRXJybyBhIGZhemVyIGxvZ2luIG5lc3RhIHBhcnRlLiBUZW50ZSBub3ZhbWVudGUgbWFpcyB0YXJkZS4nKQoKZGVmIGxpc3RhbWVudXNfbGl2ZWl0MigpOgoJY2hlY2tfbG9naW4gPSBsb2dpbmxpbGkoJ2luaWNpb19zZXJpZXMnKQoJaWYgY2hlY2tfbG9naW4gPT0gVHJ1ZToKCQltZW51U2VyaWVzMihvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnc2VyaWVzLnBuZycpLF9fU0lURUFkZG9uX18rJ0ltYWdlbnMvc2VyaWVzX2ZhbmFydC5wbmcnKQoJZWxzZToKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdFcnJvIGEgZmF6ZXIgbG9naW4gbmVzdGEgcGFydGUuIFRlbnRlIG5vdmFtZW50ZSBtYWlzIHRhcmRlLicpCgpkZWYgbWVudUZpbG1lczIoaWNvbmltYWdlLGZhbmFydCk6CglhZGREaXIyKCdUb2RvcyBvcyBGaWxtZXMnLCBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1maWxtZXMmZ2VuZXJvPXRvZG9zJmFkZG9uPTEnLCAxMTExMSwgJ2ZpbG1lcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignVG9kb3Mgb3MgRGVzdGFxdWVzJywgX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89ZmlsbWVzJmdlbmVybz1kZXN0YXF1ZXMmYWRkb249MScsIDExMTExLCAnZmlsbWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdUb2RhcyBhcyBTYWdhcycsIF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPWZpbG1lcyZnZW5lcm89c2FnYXMmYWRkb249MScsIDExMTE5OSwgJ2ZpbG1lcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignUG9yIEFubycsIF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPWZpbG1lcyZnZW5lcm89YW5vcyZhZGRvbj0xJywgMTExMTgsICdmaWxtZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ1BvciBDYXRlZ29yaWEnLCBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1maWxtZXMmZ2VuZXJvPWNhdGVnb3JpYSZhZGRvbj0xJywgMTExMTksICdmaWxtZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ1BvciBSYXRpbmcnLCBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1maWxtZXMmZ2VuZXJvPXJhdGluZyZhZGRvbj0xJywgMTExMTEsICdmaWxtZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ1BhcmEgQ3JpYW7Dp2FzJywgX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89ZmlsbWVzJmdlbmVybz1raWRzJmFkZG9uPTEnLCAxMTExMSwgJ2ZpbG1lcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignW0NPTE9SIHBpbmtdW0JdUGVzcXVpc2FbL0JdWy9DT0xPUl0nLCBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1maWxtZXMmYWRkb249MScsIDExMTIwLCAnZmlsbWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCgl2aXN0YV9tZW51KCkKCmRlZiBtZW51U2VyaWVzMihpY29uaW1hZ2UsZmFuYXJ0KToKCWFkZERpcjIoJ1RvZGFzIFNlcmllcycsIF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPXNlcmllcyZnZW5lcm89dG9kb3MmYWRkb249MScsIDExMTEyLCAnc2VyaWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdUb2RvcyBvcyBEZXN0YXF1ZXMnLCBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1zZXJpZXMmZ2VuZXJvPWRlc3RhcXVlcyZhZGRvbj0xJywgMTExMTIsICdzZXJpZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ1BvciBBbm8nLCBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1zZXJpZXMmZ2VuZXJvPWFub3MmYWRkb249MScsIDExMTE4LCAnc2VyaWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdQb3IgQ2F0ZWdvcmlhJywgX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89c2VyaWVzJmdlbmVybz1jYXRlZ29yaWEmYWRkb249MScsIDExMTE5LCAnc2VyaWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdQb3IgUmF0aW5nJywgX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89c2VyaWVzJmdlbmVybz1yYXRpbmcmYWRkb249MScsIDExMTEyLCAnc2VyaWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdQYXJhIENyaWFuw6dhcycsIF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPXNlcmllcyZnZW5lcm89a2lkcyZhZGRvbj0xJywgMTExMTIsICdzZXJpZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ1tDT0xPUiBwaW5rXVtCXVBlc3F1aXNhWy9CXVsvQ09MT1JdJywgX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89c2VyaWVzJmFkZG9uPTEnLCAxMTEyMCwgJ3NlcmllcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJdmlzdGFfbWVudSgpCgkKZGVmIGZpbG1lczIodXJsKToKCXJlc3VsdGFkbyA9IGRldm9sdmVyZXN1bHRhZG8odXJsKQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pCglmb3IgaSBpbiByZXN1bHRhZG9bJ2l0ZW0nXToKCQlzZXRGaWxtZTIoaSkKCQoJY3VycmVudCA9IHJlc3VsdGFkb1sncGFnaW5hY2FvJ11bJ2F0dWFsJ10KCXRvdGFsID0gMAoJdHJ5OiB0b3RhbCA9IHJlc3VsdGFkb1sncGFnaW5hY2FvJ11bJ3RvdGFsJ10KCWV4Y2VwdDogcGFzcwoJdHJ5OiBwcm94aW1vID0gYmFzZTY0LmI2NGRlY29kZShyZXN1bHRhZG9bJ3BhZ2luYWNhbyddWydzZWd1aW50ZSddKQoJZXhjZXB0OiBwYXNzCglpZiBpbnQoY3VycmVudCkgPCBpbnQodG90YWwpOgoJCWFkZERpcjIoJ1Byw7N4aW1hIHDDoWdpbmEgKCcrc3RyKGN1cnJlbnQpKycvJytzdHIodG90YWwpKycpJywgcHJveGltbywgMTExMTEsICdmaWxtZXMnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncHJveGltby5wbmcnKSwxKQoJdmlzdGFfZmlsbWVzU2VyaWVzKCkKCQkKZGVmIHNlcmllczIodXJsKToKCXJlc3VsdGFkbyA9IGRldm9sdmVyZXN1bHRhZG8odXJsKQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pCgkKCWZvciBpIGluIHJlc3VsdGFkb1snaXRlbSddOgoJCXNldFNlcmllczIoaSkKCQoJY3VycmVudCA9IHJlc3VsdGFkb1sncGFnaW5hY2FvJ11bJ2F0dWFsJ10KCXRvdGFsID0gMAoJdHJ5OiB0b3RhbCA9IHJlc3VsdGFkb1sncGFnaW5hY2FvJ11bJ3RvdGFsJ10KCWV4Y2VwdDogcGFzcwoJdHJ5OiBwcm94aW1vID0gYmFzZTY0LmI2NGRlY29kZShyZXN1bHRhZG9bJ3BhZ2luYWNhbyddWydzZWd1aW50ZSddKQoJZXhjZXB0OiBwYXNzCglpZiBpbnQoY3VycmVudCkgPCBpbnQodG90YWwpOgoJCWFkZERpcjIoJ1Byb3hpbWEgcGFnaW5hICgnK3N0cihjdXJyZW50KSsnLycrc3RyKHRvdGFsKSsnKScsIHByb3hpbW8sIDExMTEyLCAnc2VyaWVzJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Byb3hpbW8ucG5nJykpCgl2aXN0YV9maWxtZXNTZXJpZXMoKQoJCgkKZGVmIHNldEZpbG1lMihpKToKCWNhdGVnb3JpYSA9ICIiCgl0cnk6IGNhdGVnb3JpYSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnR3J1cG8nXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJZ3J1cG8yID0gIiIKCXRyeTogZ3J1cG8yID0gYmFzZTY0LmI2NGRlY29kZShpWydHcnVwbzInXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MgCgkKCWdydXBvMyA9ICIiCgl0cnk6IGdydXBvMyA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnR3J1cG8zJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCWlmIGdydXBvMiAhPSAiIjoKCQljYXRlZ29yaWEgKz0gJywnK2dydXBvMgoJaWYgZ3J1cG8zICE9ICIiOgoJCWNhdGVnb3JpYSArPSAnLCcrZ3J1cG8zCgkKCXB0ID0gJycKCWJyID0gJycKCXNlbUxlZ2VuZGEgPSAnJwoJaWRfdmlkZW8gPSBpWydJRCddCgkKCW5vbWUgPSAnJwoJdHJ5OiBub21lID0gYmFzZTY0LmI2NGRlY29kZShpWydOb21lJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCW5vbWVlbiA9ICcnCgl0cnk6IG5vbWVlbiA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnTm9tZUVOJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCWRlc2NyaWNhbyA9ICcnCgl0cnk6IGRlc2NyaWNhbyA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnRGVzY3JpY2FvJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCXJlYWxpemFkb3IgPSAnJwoJdHJ5OiByZWFsaXphZG9yID0gYmFzZTY0LmI2NGRlY29kZShpWydSZWFsaXphZG9yJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCWFjdG9yZXMgPSAnJwoJdHJ5OiBhY3RvcmVzID0gYmFzZTY0LmI2NGRlY29kZShpWydBY3RvcmVzJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCXlvdXR1YmUgPSAnJwoJdHJ5OiB5b3V0dWJlID0gYmFzZTY0LmI2NGRlY29kZShpWydZb3V0dWJlJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCXVybDEgPSAnJwoJdHJ5OiB1cmwxID0gYmFzZTY0LmI2NGRlY29kZShpWydVcmwnXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJdXJsMiA9ICcnCgl0cnk6IHVybDIgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ1VybDEnXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJdXJsMyA9ICcnCgl0cnk6IHVybDMgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ1VybDInXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJdXJsNCA9ICcnCgl0cnk6IHVybDQgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ1VybDMnXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJaW1kYiA9ICcnCgl0cnk6IGltZGIgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0ltZGInXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJaW1hZ2VtID0gJycKCXRyeTogaW1hZ2VtID0gYmFzZTY0LmI2NGRlY29kZShpWydJbWFnZW0nXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJbGVnZW5kYXMgPSAnJwoJdHJ5OiBsZWdlbmRhcyA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnTGVnZW5kYXMnXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJYW5vcyA9IGlbJ0Fub05vdm8nXQoJCglpZiAnaHR0cCcgbm90IGluIGltYWdlbToKCQlpbWFnZW0gPSBfX0FQSV9fK2ltYWdlbQoJCglpZiBsZWdlbmRhcyA9PSAic2VtbGVnZW5kYSIgb3IgaVsnTGVnZW5kYXMnXSA9PSAiIjoKCQlzZW1MZWdlbmRhID0gJ1tDT0xPUiByZWRdW0JdUy8gTEVHRU5EQSBbL0JdWy9DT0xPUl0nCglpZiAnQnJhc2lsZWlybycgaW4gY2F0ZWdvcmlhOgoJCWJyID0gJ1tCXVtDT0xPUiBncmVlbl1CWy9DT0xPUl1bQ09MT1IgeWVsbG93XVJbL0NPTE9SXTogWy9CXScKCWlmICdQb3J0dScgaW4gY2F0ZWdvcmlhOgoJCXB0ID0gJ1tCXVtDT0xPUiBncmVlbl1QWy9DT0xPUl1bQ09MT1IgcmVkXVRbL0NPTE9SXTogWy9CXScKCQoJdmlzdG8gPSBGYWxzZQoJY29yID0gJ3doaXRlJwoJaWYgJ1BUJyBpbiBpbWRiOgoJCWltZGIgPSByZS5jb21waWxlKCcoLis/KVBUJykuZmluZGFsbChpbWRiKVswXQoJCXB0ID0gJ1tCXVtDT0xPUiBncmVlbl1QWy9DT0xPUl1bQ09MT1IgcmVkXVRbL0NPTE9SXTogWy9CXScKCQoJaW5mb0xhYmVscyA9IHsnVGl0bGUnOiBub21lZW4sICdZZWFyJzogYW5vcywgJ0dlbnJlJzogY2F0ZWdvcmlhLCAnUGxvdCc6IGRlc2NyaWNhbywgJ0Nhc3QnOiBhY3RvcmVzLnNwbGl0KCcsJyksICdUcmFpbGVyJzogeW91dHViZSwgJ0RpcmVjdG9yJzogcmVhbGl6YWRvciwgJ1JhdGluZyc6IGlbJ1JhdGluZyddLCAnSU1EQk51bWJlcic6IGltZGIgfQoKCW5vbWVlZSA9ICdbQ09MT1IgJytjb3IrJ10nK3B0K2JyK3NlbUxlZ2VuZGErcmVtb3ZlckFjZW50b3Mobm9tZSkrJyAoJythbm9zKycpWy9DT0xPUl0nCgl1cmxub28gPSBfX0FERE9OX18uZ2V0U2V0dGluZygiYWNlc3NfVG9rZW4iKSsnUEhQL2xpdmVpdC90dWdhbGl2ZWl0LnBocD9jbGllbnRfc2VjcmV0PScrX19BRERPTl9fLmdldFNldHRpbmcoImNsaWVudF9zZWNyZXRfdXNlciIpKycmdGlwbz1maWxtZXMmZ2VuZXJvPWdldF92aWRlbyZhZGRvbj0xJnBlc3F1aXNhPScrc3RyKGlkX3ZpZGVvKQoJZm90b29vID0gaW1hZ2VtCglmYW5hcnR0dCA9ICdpbWFnZXMvYmFja2dyb3VuZC8nK2ltZGIrJy5qcGcnCgkKCWFkZFZpZGVvKG5vbWVlZSwgdXJsbm9vLCAxMTExMywgZm90b29vLCB2aXN0bywgJ2ZpbG1lJywgMCwgMCwgaW5mb0xhYmVscywgZmFuYXJ0dHQsIHRyYWlsZXI9eW91dHViZSkKCmRlZiBnZXRHZW5lcm9zMl9saXZlKHVybCwgbW9kbyk6CglsaXN0YSA9IFtdCglsaXN0YSA9IGdldFNhZ2FzbGl2ZSgnaW5pY2lvX3NhZ2FzJywgbW9kbykKCQoJZm9yIGMgaW4gYXN0LmxpdGVyYWxfZXZhbChsaXN0YSk6CgkJaWYgY1snSUQnXSA9PSAiMCI6CgkJCWNvbnRpbnVlCgkJdHJ5OgoJCQljYXQgPSBiYXNlNjQuYjY0ZGVjb2RlKGNbJ05vbWUnXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OgoJCQlwYXNzCgkJCgkJdXJsbm92byA9IHVybCsnJnBlc3F1aXNhPScrc3RyKGNbJ0lEJ10pOwoJCWFkZERpcjIoY2F0LCB1cmxub3ZvLCAxMTEyMSwgbW9kbywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2dlbmVyby5wbmcnKSkKCQoJdmlzdGFfbWVudSgpCgpkZWYgZ2V0R2VuZXJvc19saXZlKHVybCwgbW9kbyk6CglsaXN0YSA9IFtdCglpZiBtb2RvID09ICdmaWxtZXMnOgoJCWxpc3RhID0gZ2V0Q2F0ZWdvcmlhbGl2ZSgnaW5pY2lvX2ZpbG1lcycsIG1vZG8pCgllbHNlOgoJCWxpc3RhID0gZ2V0Q2F0ZWdvcmlhbGl2ZSgnaW5pY2lvX3NlcmllcycsIG1vZG8pCgkKCWZvciBjIGluIGFzdC5saXRlcmFsX2V2YWwobGlzdGEpOgoJCWlmIGNbJ0lEJ10gPT0gIjAiOgoJCQljb250aW51ZQoJCXRyeToKCQkJY2F0ID0gYmFzZTY0LmI2NGRlY29kZShjWydOb21lJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDoKCQkJcGFzcwoJCQoJCXVybG5vdm8gPSB1cmwrJyZwZXNxdWlzYT0nK3N0cihjWydJRCddKTsKCQlhZGREaXIyKGNhdCwgdXJsbm92bywgMTExMjEsIG1vZG8sIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdnZW5lcm8ucG5nJykpCgkKCXZpc3RhX21lbnUoKQoKZGVmIGdldFllYXJzX2xpdmUodXJsLCBtb2RvKToKCWxpc3RhID0gW10KCWlmIG1vZG8gPT0gJ2ZpbG1lcyc6CgkJbGlzdGEgPSBnZXRBbm9zbGl2ZSgnaW5pY2lvX2ZpbG1lcycsIG1vZG8pCgllbHNlOgoJCWxpc3RhID0gZ2V0QW5vc2xpdmUoJ2luaWNpb19zZXJpZXMnLCBtb2RvKQoJCglmb3IgYyBpbiBhc3QubGl0ZXJhbF9ldmFsKGxpc3RhKToKCQlpZiBjWydJRCddID09ICIwIjoKCQkJY29udGludWUKCQl0cnk6CgkJCWNhdCA9IGJhc2U2NC5iNjRkZWNvZGUoY1snTm9tZSddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6CgkJCXBhc3MKCQkKCQl1cmxub3ZvID0gdXJsKycmcGVzcXVpc2E9JytzdHIoY1snSUQnXSk7CgkJYWRkRGlyMihjYXQsIHVybG5vdm8sIDExMTIxLCBtb2RvLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZ2VuZXJvLnBuZycpKQoJCgl2aXN0YV9tZW51KCkKCQpkZWYgZ2V0SW5mb19saXZlKHVybCwgdGlwbyk6CglyZXN1bHRhZG8gPSBkZXZvbHZlcmVzdWx0YWRvKHVybCkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJZm9yIGkgaW4gcmVzdWx0YWRvWyJpdGVtIl06CgkJaWYgdGlwbyA9PSAnZmlsbWVzJzoKCQkJc2V0RmlsbWUyKGkpCgkJZWxzZToKCQkJc2V0U2VyaWVzMihpKQoJCgljdXJyZW50ID0gcmVzdWx0YWRvWydwYWdpbmFjYW8nXVsnYXR1YWwnXQoJdG90YWwgPSAwCgl0cnk6IHRvdGFsID0gcmVzdWx0YWRvWydwYWdpbmFjYW8nXVsndG90YWwnXQoJZXhjZXB0OiBwYXNzCgl0cnk6IHByb3hpbW8gPSBiYXNlNjQuYjY0ZGVjb2RlKHJlc3VsdGFkb1sncGFnaW5hY2FvJ11bJ3NlZ3VpbnRlJ10pCglleGNlcHQ6IHBhc3MKCWlmIGludChjdXJyZW50KSA8IGludCh0b3RhbCk6CgkJYWRkRGlyMignUHJveGltYSBwYWdpbmEgKCcrc3RyKGN1cnJlbnQpKycvJytzdHIodG90YWwpKycpJywgcHJveGltbywgMTExMjEsIHRpcG8sIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdwcm94aW1vLnBuZycpKQoJdmlzdGFfZmlsbWVzU2VyaWVzKCkKCQpkZWYgcGVzcXVpc2FfbGl2ZSh1cmwsIHRpcG9sbyk6Cgljb2RpZ29fZm9udGUgPSAnJwoJZGFkb3MgPSAnJwoJdGFiZWxhID0gJycKCXN0clBlc3F1aXNhID0gJycKCWZpY2hlaXJvID0gJycKCXNpdGUgPSAnJwoJcXVhbGlkYWRlID0gJycKCXRva2VuUGVzcXVpc2E9ICcnCglyZXN1bHRhZG8gPSAnJwoJdGlwb2xvcGVzcXVpc2FOb3ZvID0gJzAnCglpZiB0aXBvbG8gPT0gJ2ZpbG1lcyc6CgkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdmaWxtZXNfcGVzcXVpc2EubGl2ZWl0JykKCQl0aXBvID0gMAoJCXF1YWxpZGFkZSA9IF9fUXVhbGlkYWRlX18KCWVsc2U6CgkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdzZXJpZXNfcGVzcXVpc2EubGl2ZWl0JykKCQl0aXBvID0gMQoJCXNpdGUgPSAnc2VyaWVzJwoJCglpZiAncGFnZScgbm90IGluIHVybDoKCQl0cnk6CgkJCXRpcG9sb3Blc3F1aXNhID0geGJtY2d1aS5EaWFsb2coKS5zZWxlY3QodSdPIHF1ZSBwcmV0ZW5kZSBwZXNxdWlzYXI/JywgWydQb3I6IE5vbWVQVCBvdSBOb21lIEVOJywgJ1BvcjogUmVhbGl6YWRvcicsJ1BvcjogQWN0b3InXSkKCQlleGNlcHQ6CgkJCXJldHVybiBGYWxzZQoJCQoJCWlmIHRpcG9sb3Blc3F1aXNhID09IDA6CgkJCXRpcG9sb3Blc3F1aXNhTm92byA9ICcwJwoJCWVsaWYgdGlwbyA9PSAxOgoJCQl0aXBvbG9wZXNxdWlzYU5vdm8gPSAnMScKCQllbGlmIHRpcG8gPT0gMjoKCQkJdGlwb2xvcGVzcXVpc2FOb3ZvID0gJzInCgkJCQoJCV9fQURET05fXy5zZXRTZXR0aW5nKCd0b2tlblBlc3F1aXNhJywgdGlwb2xvcGVzcXVpc2FOb3ZvKQoJCXRlY2xhZG8gPSB4Ym1jLktleWJvYXJkKCcnLCAnTyBxdWUgcXVlciBwZXNxdWlzYXI/JykKCQl0ZWNsYWRvLmRvTW9kYWwoKQoJCQoJCWlmIHRlY2xhZG8uaXNDb25maXJtZWQoKToKCQkJc3RyUGVzcXVpc2EgPSB0ZWNsYWRvLmdldFRleHQoKQoJCQlpZiBzdHJQZXNxdWlzYSA9PSAnJzoKCQkJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0luc2lyYSBhbGdvIG5hIHBlc3F1aXNhLicpCgkJCQlhZGREaXIyKCdBbHRlcmFyIFBlc3F1aXNhJywgdXJsLCAxMTEyMCwgdGlwb2xvLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncGVzcXVpc2EucG5nJyksIDApCgkJCQlyZXR1cm4gRmFsc2UKCQkJZWxzZToKCQkJCXRva2VuUGVzcXVpc2EgPSBzdHJQZXNxdWlzYS5yZXBsYWNlKCIgIiwgIiUyMCIpCgkJCQlfX0FERE9OX18uc2V0U2V0dGluZygndG9rZW5QZXNxdWlzYVRleHRvJywgdG9rZW5QZXNxdWlzYSkKCQoJcmVzdWx0YWRvID0gZGV2b2x2ZXJlc3VsdGFkbyh1cmwrJyZwZXNxdWlzYT0nK19fQURET05fXy5nZXRTZXR0aW5nKCd0b2tlblBlc3F1aXNhVGV4dG8nKSsnJmdlbmVybz1wZXNxdWlzYScrX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuUGVzcXVpc2EnKSkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJZm9yIGkgaW4gcmVzdWx0YWRvWyJpdGVtIl06CgkJaWYgdGlwb2xvID09ICdmaWxtZXMnOgoJCQlzZXRGaWxtZTIoaSkKCQllbHNlOgoJCQlzZXRTZXJpZXMyKGkpCgkKCWN1cnJlbnQgPSByZXN1bHRhZG9bJ3BhZ2luYWNhbyddWydhdHVhbCddCgl0b3RhbCA9IDAKCXRyeTogdG90YWwgPSByZXN1bHRhZG9bJ3BhZ2luYWNhbyddWyd0b3RhbCddCglleGNlcHQ6IHBhc3MKCXRyeTogcHJveGltbyA9IGJhc2U2NC5iNjRkZWNvZGUocmVzdWx0YWRvWydwYWdpbmFjYW8nXVsnc2VndWludGUnXSkKCWV4Y2VwdDogcGFzcwoJaWYgaW50KGN1cnJlbnQpIDwgaW50KHRvdGFsKToKCQlhZGREaXIyKCdQcm94aW1hIHBhZ2luYSAoJytzdHIoY3VycmVudCkrJy8nK3N0cih0b3RhbCkrJyknLCBwcm94aW1vLCAxMTEyMCwgdGlwb2xvLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncHJveGltby5wbmcnKSkKCWVsc2U6CgkJeGJtY3BsdWdpbi5lbmRPZkRpcmVjdG9yeShpbnQoc3lzLmFyZ3ZbMV0pLGNhY2hlVG9EaXNjPUZhbHNlKQoJCgl2aXN0YV9maWxtZXNTZXJpZXMoKQoKZGVmIHNldFNlcmllczIoaSk6CgljYXRlZ29yaWEgPSAiIgoJdHJ5OiBjYXRlZ29yaWEgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0dydXBvJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzCgkKCWdydXBvMiA9ICIiCgl0cnk6IGdydXBvMiA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnR3J1cG8yJ10pLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OiBwYXNzIAoJCglncnVwbzMgPSAiIgoJdHJ5OiBncnVwbzMgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0dydXBvMyddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglpZiBncnVwbzIgIT0gIiI6CgkJY2F0ZWdvcmlhICs9ICcsJytncnVwbzIKCWlmIGdydXBvMyAhPSAiIjoKCQljYXRlZ29yaWEgKz0gJywnK2dydXBvMwoJCglpZF92aWRlbyA9IGlbJ0lEJ10KCQoJbm9tZSA9ICcnCgl0cnk6IG5vbWUgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ05vbWUnXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJbm9tZWVuID0gJycKCXRyeTogbm9tZWVuID0gYmFzZTY0LmI2NGRlY29kZShpWydOb21lRU4nXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJZGVzY3JpY2FvID0gJycKCXRyeTogZGVzY3JpY2FvID0gYmFzZTY0LmI2NGRlY29kZShpWydEZXNjcmljYW8nXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJcmVhbGl6YWRvciA9ICcnCgl0cnk6IHJlYWxpemFkb3IgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ1JlYWxpemFkb3InXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJYWN0b3JlcyA9ICcnCgl0cnk6IGFjdG9yZXMgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0FjdG9yZXMnXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJeW91dHViZSA9ICcnCgl0cnk6IHlvdXR1YmUgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ1lvdXR1YmUnXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJaW1kYiA9ICcnCgl0cnk6IGltZGIgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0ltZGInXSkuZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6IHBhc3MKCQoJYW5vcyA9IGlbJ0Fub05vdm8nXQoJdGVtcG9yYWRhcyA9IGlbJ1RlbXBvcmFkYXMnXQoJCglpbWFnZW0gPSAnJwoJdHJ5OiBpbWFnZW0gPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0ltYWdlbSddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCgl2aXN0byA9IEZhbHNlCglwdCA9ICcnCgliciA9ICcnCglzZW1MZWdlbmRhID0gJycKCWlmICdCcmFzaWxlaXJvJyBpbiBjYXRlZ29yaWE6CgkJYnIgPSAnW0JdW0NPTE9SIGdyZWVuXUJbL0NPTE9SXVtDT0xPUiB5ZWxsb3ddUlsvQ09MT1JdOiBbL0JdJwoJaWYgJ1BvcnR1JyBpbiBjYXRlZ29yaWE6CgkJcHQgPSAnW0JdW0NPTE9SIGdyZWVuXVBbL0NPTE9SXVtDT0xPUiByZWRdVFsvQ09MT1JdOiBbL0JdJwoJaWYgJ1BUJyBpbiBpbWRiOgoJCXB0ID0gJ1tCXVtDT0xPUiBncmVlbl1QWy9DT0xPUl1bQ09MT1IgcmVkXVRbL0NPTE9SXTogWy9CXScKCQoJaWYgJ2h0dHAnIG5vdCBpbiBpbWFnZW06CgkJaW1hZ2VtID0gX19BUElfXytpbWFnZW0KCQoJdXJsbm9vID0gX19BRERPTl9fLmdldFNldHRpbmcoImFjZXNzX1Rva2VuIikrJ1BIUC9saXZlaXQvdHVnYWxpdmVpdC5waHA/Y2xpZW50X3NlY3JldD0nK19fQURET05fXy5nZXRTZXR0aW5nKCJjbGllbnRfc2VjcmV0X3VzZXIiKSsnJnRpcG89c2VyaWVzJmdlbmVybz10ZW1wb3JhZGEmYWRkb249MSZzZXJpZT0nK2lkX3ZpZGVvKycmdGVtcG9yYWRhPScKCQoJaW5mb0xhYmVscyA9IHsnVGl0bGUnOiBub21lZW4sICdZZWFyJzogYW5vcywgJ0dlbnJlJzogY2F0ZWdvcmlhLCAnUGxvdCc6IGRlc2NyaWNhbywgJ0Nhc3QnOiBhY3RvcmVzLnNwbGl0KCcsJyksICdUcmFpbGVyJzogeW91dHViZSwgJ0RpcmVjdG9yJzogcmVhbGl6YWRvciwgJ1JhdGluZyc6IGlbJ1JhdGluZyddLCAnSU1EQk51bWJlcic6IGltZGIgfQoJCglub21lZWUgPSBwdCticitzZW1MZWdlbmRhK3JlbW92ZXJBY2VudG9zKG5vbWUpKycgKCcrYW5vcysnKScKCWZvdG9vbyA9IGltYWdlbQoJZmFuYXJ0dHQgPSBfX0FQSV9fKydpbWFnZXMvYmFja2dyb3VuZC8nK2ltZGIrJy5qcGcnCglhZGREaXIyKG5vbWVlZSwgdXJsbm9vLCAxMTExNCwgdGVtcG9yYWRhcywgZm90b29vLCB0aXBvPSdzZXJpZScsIGluZm9MYWJlbHM9aW5mb0xhYmVscyxwb3N0ZXI9ZmFuYXJ0dHQsdmlzdG89dmlzdG8pCgkKCQpkZWYgZ2V0U2Vhc29uczIodXJsLCBtb2RvKToKCWo9aW50KG1vZG8pCglmb3IgaSBpbiByYW5nZShqKToKCQlhZGREaXIyKCJbQl1UZW1wb3JhZGFbL0JdICIrc3RyKGkrMSksIHVybCtzdHIoaSsxKSwgMTExMTUsICdlcGlzb2Rpb3MnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCd0ZW1wb3JhZGFzJywgJ3RlbXBvcmFkYScrc3RyKGkrMSkrJy5wbmcnKSkKCQoJdmlzdGFfdGVtcG9yYWRhcygpCgpkZWYgZ2V0RXBpc29kZXMyKHVybCk6CglyZXN1bHRhZG8gPSBkZXZvbHZlcmVzdWx0YWRvKHVybCkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJZm9yIGkgaW4gcmVzdWx0YWRvWydpdGVtJ106CgkJcHQgPSAnJwoJCWJyID0gJycKCQlmaW5hbCA9ICcnCgkJc2VtTGVnZW5kYSA9ICcnCgkJCgkJdmlzdG8gPSBGYWxzZQoJCWNvciA9ICd3aGl0ZScKCQkKCQlub21lID0gJycKCQl0cnk6IG5vbWUgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ05vbWUnXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OiBwYXNzCgkKCQlpbWRiID0gJycKCQl0cnk6IGltZGIgPSBiYXNlNjQuYjY0ZGVjb2RlKGlbJ0ltZGInXSkuZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OiBwYXNzCgkJCgkJaW1hZ2VtID0gJycKCQl0cnk6IGltYWdlbSA9IGJhc2U2NC5iNjRkZWNvZGUoaVsnSW1hZ2VtJ10pLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDogcGFzcwoJCQoJCWxlZ2VuZGFzID0gJycKCQl0cnk6IGxlZ2VuZGFzID0gYmFzZTY0LmI2NGRlY29kZShpWydMZWdlbmRhcyddKS5kZWNvZGUoJ3V0Zi04JykKCQlleGNlcHQ6IHBhc3MKCQkKCQlhbm9zID0gaVsnQW5vTm92byddCgkKCQlpZiAnaHR0cCcgbm90IGluIGltYWdlbToKCQkJaW1hZ2VtID0gX19BUElfXytpbWFnZW0KCQoJCWlmIGxlZ2VuZGFzID09ICJzZW1sZWdlbmRhIiBvciBpWydMZWdlbmRhcyddID09ICIiOgoJCQlzZW1MZWdlbmRhID0gJ1tDT0xPUiByZWRdW0JdUy8gTEVHRU5EQSBbL0JdWy9DT0xPUl0nCgkJCgkJZXBpc29kaW8gPSBpWydFcGlzb2RpbyddCgkJdGVtcG9yYWRhID0gaVsnVGVtcG9yYWRhJ10KCQlpZF92aWRlbyA9IGlbJ0lEJ10KCQkKCQlpbmZvTGFiZWxzID0geydUaXRsZSc6IG5vbWUsICdDb2RlJzogaW1kYiwgJ0VwaXNvZGUnOiBlcGlzb2RpbywgJ1NlYXNvbic6IHRlbXBvcmFkYSB9CgkJbm9tZWVlID0gcHQrYnIrZmluYWwrc2VtTGVnZW5kYSsnW0NPTE9SICcrY29yKyddW0JdRXBpc29kaW8gJytzdHIoZXBpc29kaW8pKydbL0JdWy9DT0xPUl0gJytyZW1vdmVyQWNlbnRvcyhub21lKQoJCQoJCXVybG5vbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKydQSFAvbGl2ZWl0L3R1Z2FsaXZlaXQucGhwP2NsaWVudF9zZWNyZXQ9JytfX0FERE9OX18uZ2V0U2V0dGluZygiY2xpZW50X3NlY3JldF91c2VyIikrJyZ0aXBvPXNlcmllcyZnZW5lcm89Z2V0X3ZpZGVvJmFkZG9uPTEmcGVzcXVpc2E9JytzdHIoaWRfdmlkZW8pCgkJZm90b29vID0gaW1hZ2VtCgkJZmFuYXJ0dHQgPSBfX0FQSV9fKydpbWFnZXMvYmFja2dyb3VuZC8nK2ltZGIrJy5qcGcnCgkJYWRkVmlkZW8obm9tZWVlLCB1cmxub28sIDExMTEzLCBpbWFnZW0sIHZpc3RvLCAnZXBpc29kaW8nLCB0ZW1wb3JhZGEsIGVwaXNvZGlvLCBpbmZvTGFiZWxzLCBmYW5hcnR0dCkKCQoJdmlzdGFfZXBpc29kaW9zKCkKCmRlZiBwbGF5ZXIyKG5hbWUsIHVybCwgaWNvbmltYWdlLCBtb2RvLCB0ZW1wb3JhZGEsIGVwaXNvZGlvLCB0aXBvbG9naSk6CglyZXN1bHRhZG8gPSBkZXZvbHZlcmVzdWx0YWRvKHVybCkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJaW5mb2xhYmVscyA9IGRpY3QoKQoJcGFzdGFEYXRhID0gJycKCW5vbWUgPSAnJwoJaWRWaWRlbyA9ICcwJwoJbWVuc2FnZW1wcm9ncmVzc28gPSB4Ym1jZ3VpLkRpYWxvZ1Byb2dyZXNzKCkKCW1lbnNhZ2VtcHJvZ3Jlc3NvLmNyZWF0ZShBZGRvblRpdGxlLCB1J0FicmlyIGVtaXNzw6NvJywnUG9yIGZhdm9yIGFndWFyZGUuLi4nKQoJbWVuc2FnZW1wcm9ncmVzc28udXBkYXRlKDI1LCAiIiwgdSdPYnRlciB2aWRlbyBlIGxlZ2VuZGEnLCAiIikKCglzdHJlYW0sIGxlZ2VuZGEsIGV4dF9nID0gZ2V0U3RyZWFtTGVnZW5kYTIocmVzdWx0YWRvWzBdLHRpcG9sb2dpKQoJaWYgc3RyZWFtID09IEZhbHNlIGFuZCBsZWdlbmRhID09IDIwNDoKCQltZW5zYWdlbXByb2dyZXNzby5jbG9zZSgpCgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnQWxndW0gZXJyby4gVGVudGUgbWFpcyB0YXJkZScpCgkJcmV0dXJuIEZhbHNlCgllbHNlOgoJCW1lbnNhZ2VtcHJvZ3Jlc3NvLnVwZGF0ZSg1MCwgIiIsIHUnUHJlcGFyYS10ZSwgdmFpIGNvbWXDp2FyIScsICIiKQoJCXBsYXlsaXN0ID0geGJtYy5QbGF5TGlzdCgxKQoJCXBsYXlsaXN0LmNsZWFyKCkKCQlsaXN0aXRlbSA9IHhibWNndWkuTGlzdEl0ZW0obmFtZSwgaWNvbkltYWdlPSJEZWZhdWx0VmlkZW8ucG5nIiwgdGh1bWJuYWlsSW1hZ2U9aWNvbmltYWdlKQoKCQlsaXN0aXRlbS5zZXRJbmZvKHR5cGU9IlZpZGVvIiwgaW5mb0xhYmVscz1pbmZvbGFiZWxzKQoJCWxpc3RpdGVtLnNldFByb3BlcnR5KCdtaW1ldHlwZScsICd2aWRlby94LW1zdmlkZW8nKQoJCWxpc3RpdGVtLnNldFByb3BlcnR5KCdJc1BsYXlhYmxlJywgJ3RydWUnKQoJCQoJCWxpc3RpdGVtLnNldFBhdGgocGF0aD1zdHJlYW0pCgkJcGxheWxpc3QuYWRkKHN0cmVhbSwgbGlzdGl0ZW0pCgkJeGJtY3BsdWdpbi5zZXRSZXNvbHZlZFVybChpbnQoc3lzLmFyZ3ZbMV0pLCBUcnVlLCBsaXN0aXRlbSkKCQltZW5zYWdlbXByb2dyZXNzby51cGRhdGUoNzUsICIiLCB1J0JvYSBTZXNzw6NvISEhJywgIiIpCgoJCWlmIHN0cmVhbSA9PSBGYWxzZToKCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnTyBzZXJ2aWRvciBlc2NvbGhpZG8gbsOjbyBkaXNwb27DrXZlbCwgZXNjb2xoYSBvdXRybyBvdSB0ZW50ZSBub3ZhbWVudGUgbWFpcyB0YXJkZS4nKQoJCWVsc2U6CgkJCXBsYXllcl9tciA9IFBsYXllci5QbGF5ZXIodXJsPXVybCwgaWRGaWxtZT1pZFZpZGVvLCBwYXN0YURhdGE9X19QQVNUQV9EQURPU19fLCB0ZW1wb3JhZGE9dGVtcG9yYWRhLCBlcGlzb2Rpbz1lcGlzb2Rpbywgbm9tZT1uYW1lLCBsb2dvPW9zLnBhdGguam9pbihfX0FERE9OX0ZPTERFUl9fLCdpY29uLnBuZycpKQoJCQltZW5zYWdlbXByb2dyZXNzby5jbG9zZSgpCgkJCXBsYXllcl9tci5wbGF5KHBsYXlsaXN0KQoJCQlwbGF5ZXJfbXIuc2V0U3VidGl0bGVzKGxlZ2VuZGEpCgkJCXdoaWxlIHBsYXllcl9tci5wbGF5aW5nOgoJCQkJeGJtYy5zbGVlcCg1MDAwKQoJCQkJI3BsYXllcl9tci50cmFja2VyVGVtcG8oKQoKZGVmIGdldFN0cmVhbUxlZ2VuZGEyKHR1ZG9pbmZvLHRpcG9vbyk6CglyZXN1bHRhZG8gPSB0dWRvaW5mbwoJaSA9IDAKCXNlcnZpZG9yZXMgPSBbXQoJdGl0dWxvcyA9IFtdCglub21lID0gJycKCXVybDEgPSAnJwoJdHJ5OiB1cmwxID0gYmFzZTY0LmI2NGRlY29kZShyZXN1bHRhZG9bJ1VybCddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJdXJsMiA9ICcnCgl0cnk6IHVybDIgPSBiYXNlNjQuYjY0ZGVjb2RlKHJlc3VsdGFkb1snVXJsMSddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJdXJsMyA9ICcnCgl0cnk6IHVybDMgPSBiYXNlNjQuYjY0ZGVjb2RlKHJlc3VsdGFkb1snVXJsMiddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJdXJsNCA9ICcnCgl0cnk6IHVybDQgPSBiYXNlNjQuYjY0ZGVjb2RlKHJlc3VsdGFkb1snVXJsMyddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJdXJsNSA9ICcnCgl0cnk6IHVybDUgPSBiYXNlNjQuYjY0ZGVjb2RlKHJlc3VsdGFkb1snVXJsNCddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDogcGFzcwoJCglpZiB1cmwxICE9ICcnOgoJCWkrPTEKCQlpZiAnb2xvYWQnIGluIHVybDE6CgkJCW5vbWUgPSAiT3BlbkxvYWQiCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDEpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICd2aWR6aScgaW4gdXJsMToKCQkJbm9tZSA9ICdWaWR6aScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ2dvb2dsZScgaW4gdXJsMSBvciAnY2xvdWQubWFpbC5ydScgaW4gdXJsMSBvciAnLm1wNCcgaW4gdXJsMSBvciAnLmF2aScgaW4gdXJsMToKCQkJbm9tZSA9IEFkZG9uVGl0bGUKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3VwdG9zdHJlYW0uY29tJyBpbiB1cmwxOgoJCQlub21lID0gJ1VwVG9TdHJlYW0nCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDEpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICdyYXBpZHZpZGVvLmNvbScgaW4gdXJsMSBvciAncmFwdHUnIGluIHVybDE6CgkJCW5vbWUgPSAnUmFwdHUnCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDEpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICd2aWRvemEubmV0JyBpbiB1cmwxOgoJCQlub21lID0gJ1ZpZG96YScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3N0cmVhbWFuZ28uJyBpbiB1cmwxOgoJCQlub21lID0gJ1N0cmVhbWFuZ28nCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDEpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICd2ZXJ5c3RyZWFtLicgaW4gdXJsMToKCQkJbm9tZSA9ICdWZXJ5U3RyZWFtJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwxKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCglpZiB1cmwyICE9ICcnOgoJCWkrPTEKCQlpZiAnb2xvYWQnIGluIHVybDI6CgkJCW5vbWUgPSAiT3BlbkxvYWQiCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDIpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICd2aWR6aScgaW4gdXJsMjoKCQkJbm9tZSA9ICdWaWR6aScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMikKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ2dvb2dsZScgaW4gdXJsMiBvciAnY2xvdWQubWFpbC5ydScgaW4gdXJsMiBvciAnLm1wNCcgaW4gdXJsMiBvciAnLmF2aScgaW4gdXJsMjoKCQkJbm9tZSA9IEFkZG9uVGl0bGUKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMikKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3VwdG9zdHJlYW0uY29tJyBpbiB1cmwyOgoJCQlub21lID0gJ1VwVG9TdHJlYW0nCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDIpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICdyYXBpZHZpZGVvLmNvbScgaW4gdXJsMiBvciAncmFwdHUnIGluIHVybDI6CgkJCW5vbWUgPSAnUmFwdHUnCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDIpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICd2aWRvemEubmV0JyBpbiB1cmwyOgoJCQlub21lID0gJ1ZpZG96YScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMikKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3N0cmVhbWFuZ28uJyBpbiB1cmwyOgoJCQlub21lID0gJ1N0cmVhbWFuZ28nCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDIpCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICd2ZXJ5c3RyZWFtLicgaW4gdXJsMjoKCQkJbm9tZSA9ICdWZXJ5U3RyZWFtJwoJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwyKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCQoJdHJ5OgoJCWlmIHVybDMgIT0gJyc6CgkJCWkrPTEKCQkJaWYgJ29sb2FkJyBpbiB1cmwzOgoJCQkJbm9tZSA9ICJPcGVuTG9hZCIKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDMpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3ZpZHppJyBpbiB1cmwzOgoJCQkJbm9tZSA9ICdWaWR6aScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDMpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ2dvb2dsZScgaW4gdXJsMyBvciAnY2xvdWQubWFpbC5ydScgaW4gdXJsMyBvciAnLm1wNCcgaW4gdXJsMyBvciAnLmF2aScgaW4gdXJsMzoKCQkJCW5vbWUgPSBBZGRvblRpdGxlCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwzKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd1cHRvc3RyZWFtLmNvbScgaW4gdXJsMzoKCQkJCW5vbWUgPSAnVXBUb1N0cmVhbScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDMpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3JhcGlkdmlkZW8uY29tJyBpbiB1cmwzIG9yICdyYXB0dScgaW4gdXJsMzoKCQkJCW5vbWUgPSAnUmFwdHUnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwzKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd2aWRvemEubmV0JyBpbiB1cmwzOgoJCQkJbm9tZSA9ICdWaWRvemEnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmwzKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdzdHJlYW1hbmdvLicgaW4gdXJsMzoKCQkJCW5vbWUgPSAnU3RyZWFtYW5nbycKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDMpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3ZlcnlzdHJlYW0uJyBpbiB1cmwzOgoJCQkJbm9tZSA9ICdWZXJ5U3RyZWFtJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsMykKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCWV4Y2VwdDoKCQlwYXNzCgl0cnk6CgkJaWYgdXJsNCAhPSAnJzoKCQkJaSs9MQoJCQlpZiAnb2xvYWQnIGluIHVybDQ6CgkJCQlub21lID0gIk9wZW5Mb2FkIgoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsNCkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndmlkemknIGluIHVybDQ6CgkJCQlub21lID0gJ1ZpZHppJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsNCkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAnZ29vZ2xlJyBpbiB1cmw0IG9yICdjbG91ZC5tYWlsLnJ1JyBpbiB1cmw0IG9yICcubXA0JyBpbiB1cmw0IG9yICcuYXZpJyBpbiB1cmw0OgoJCQkJbm9tZSA9IEFkZG9uVGl0bGUKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDQpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3VwdG9zdHJlYW0uY29tJyBpbiB1cmw0OgoJCQkJbm9tZSA9ICdVcFRvU3RyZWFtJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsNCkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAncmFwaWR2aWRlby5jb20nIGluIHVybDQgb3IgJ3JhcHR1JyBpbiB1cmw0OgoJCQkJbm9tZSA9ICdSYXB0dScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDQpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3ZpZG96YS5uZXQnIGluIHVybDQ6CgkJCQlub21lID0gJ1ZpZG96YScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDQpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3N0cmVhbWFuZ28uJyBpbiB1cmw0OgoJCQkJbm9tZSA9ICdTdHJlYW1hbmdvJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsNCkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndmVyeXN0cmVhbS4nIGluIHVybDQ6CgkJCQlub21lID0gJ1ZlcnlTdHJlYW0nCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw0KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJZXhjZXB0OgoJCXBhc3MKCQoJdHJ5OgoJCWlmIHVybDUgIT0gJyc6CgkJCWkrPTEKCQkJaWYgJ29sb2FkJyBpbiB1cmw1OgoJCQkJbm9tZSA9ICJPcGVuTG9hZCIKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDUpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3ZpZHppJyBpbiB1cmw1OgoJCQkJbm9tZSA9ICdWaWR6aScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDUpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ2dvb2dsZScgaW4gdXJsNSBvciAnY2xvdWQubWFpbC5ydScgaW4gdXJsNSBvciAnLm1wNCcgaW4gdXJsNSBvciAnLmF2aScgaW4gdXJsNToKCQkJCW5vbWUgPSBBZGRvblRpdGxlCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw1KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd1cHRvc3RyZWFtLmNvbScgaW4gdXJsNToKCQkJCW5vbWUgPSAnVXBUb1N0cmVhbScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDUpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3JhcGlkdmlkZW8uY29tJyBpbiB1cmw1IG9yICdyYXB0dScgaW4gdXJsNToKCQkJCW5vbWUgPSAnUmFwdHUnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw1KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd2aWRvemEubmV0JyBpbiB1cmw1OgoJCQkJbm9tZSA9ICdWaWRvemEnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZCh1cmw1KQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdzdHJlYW1hbmdvLicgaW4gdXJsNToKCQkJCW5vbWUgPSAnU3RyZWFtYW5nbycKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHVybDUpCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3ZlcnlzdHJlYW0uJyBpbiB1cmw1OgoJCQkJbm9tZSA9ICdWZXJ5U3RyZWFtJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQodXJsNSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCWV4Y2VwdDoKCQlwYXNzCgkKCXN0cmVhbSA9ICcnCglsZWdlbmRhID0gJycKCWxlZ2VuZGFub3ZhID0gJycKCXRyeToKCQlsZWdlbmRhbm92YSA9IGJhc2U2NC5iNjRkZWNvZGUocmVzdWx0YWRvWydMZWdlbmRhcyddKS5kZWNvZGUoJ3V0Zi04JykKCWV4Y2VwdDoKCQlwYXNzCgkKCWlmICdsaXZlaXQnIGluIGxlZ2VuZGFub3ZhOgoJCWxlZ2VuZGEgPSAnJwoJZWxpZiAnaHR0cCcgaW4gbGVnZW5kYW5vdmE6CgkJbGVnZW5kYSA9IGxlZ2VuZGFub3ZhCgllbGlmICdzdWJzLycgaW4gbGVnZW5kYW5vdmE6CgkJbGVnZW5kYSA9IF9fQVBJX18rbGVnZW5kYW5vdmEKCWVsc2U6CgkJbGVnZW5kYSA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJhY2Vzc19Ub2tlbiIpKyAibGVnZW5kYXMvIiArbGVnZW5kYW5vdmEKCQoJZXh0X2cgPSAnY29pc28nCglsZWdlbmRhQXV4ID0gbGVnZW5kYQoJc2Vydmlkb3IgPSAwCglpZiBsZW4odGl0dWxvcykgPiAxOgoJCXNlcnZpZG9yID0geGJtY2d1aS5EaWFsb2coKS5zZWxlY3QoJ0VzY29saGEgbyBzZXJ2aWRvcicsIHRpdHVsb3MpCgllbHNlOgoJCXNlcnZpZG9yID0gMAoJCglpZiAndmlkemknIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXZpZHppID0gVVJMUmVzb2x2ZXJNZWRpYS5WaWR6aShzZXJ2aWRvcmVzW3NlcnZpZG9yXSkKCQlzdHJlYW0gPSB2aWR6aS5nZXRNZWRpYVVybCgpCgkJbGVnZW5kYSA9IHZpZHppLmdldFN1YnRpdGxlKCkKCWVsaWYgJ3VwdG9zdHJlYW0uY29tJyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQlzdHJlYW0gPSBVUkxSZXNvbHZlck1lZGlhLlVwVG9TdHJlYW0oc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pLmdldE1lZGlhVXJsKCkKCWVsaWYgJ3NlcnZlci5tcnBpcmFjeS53aW4nIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXN0cmVhbSA9IHNlcnZpZG9yZXNbc2Vydmlkb3JdCgllbGlmICdvbG9hZCcgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJc3RyZWFtID0gVVJMUmVzb2x2ZXJNZWRpYS5PcGVuTG9hZChzZXJ2aWRvcmVzW3NlcnZpZG9yXSkuZ2V0TWVkaWFVcmwoKQoJCWxlZ2VuZGEgPSBVUkxSZXNvbHZlck1lZGlhLk9wZW5Mb2FkKHNlcnZpZG9yZXNbc2Vydmlkb3JdKS5nZXRTdWJ0aXRsZSgpCgkJaWYgbm90ICcudnR0JyBpbiBsZWdlbmRhIG9yIGxlZ2VuZGEgPT0gJyc6CgkJCWxlZ2VuZGEgPSBsZWdlbmRhQXV4CgllbGlmICdkcml2ZS5nb29nbGUuY29tLycgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJc3RyZWFtLCBleHRfZyA9IFVSTFJlc29sdmVyTWVkaWEuR29vZ2xlVmlkZW8oc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pLmdldE1lZGlhVXJsKCkKCWVsaWYgJ2Nsb3VkLm1haWwucnUnIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXN0cmVhbSwgZXh0X2cgPSBVUkxSZXNvbHZlck1lZGlhLkNsb3VkTWFpbFJ1KHNlcnZpZG9yZXNbc2Vydmlkb3JdKS5nZXRNZWRpYVVybCgpCgllbGlmICdyYXBpZHZpZGVvLmNvbScgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl0gb3IgJ3JhcHR1JyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQlyYXBpZCA9IFVSTFJlc29sdmVyTWVkaWEuUmFwaWRWaWRlbyhzZXJ2aWRvcmVzW3NlcnZpZG9yXSkKCQlzdHJlYW0gPSByYXBpZC5nZXRNZWRpYVVybCgpCgkJbGVnZW5kYSA9IHJhcGlkLmdldExlZ2VuZGEoKQoJZWxpZiAndmlkb3phLm5ldCcgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJdmlkb3ogPSBVUkxSZXNvbHZlck1lZGlhLlZpZG96YShzZXJ2aWRvcmVzW3NlcnZpZG9yXSkKCQlzdHJlYW0gPSB2aWRvei5nZXRNZWRpYVVybCgpCgkJbGVnZW5kYSA9IHZpZG96LmdldExlZ2VuZGEoKQoJZWxpZiAnc3RyZWFtYW5nby4nIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXN0cmVhbWFuID0gVVJMUmVzb2x2ZXJNZWRpYS5TdHJlYW1hbmdvKHNlcnZpZG9yZXNbc2Vydmlkb3JdKQoJCXN0cmVhbSA9IHN0cmVhbWFuLmdldE1lZGlhVXJsKCkKCQlsZWdlbmRhID0gc3RyZWFtYW4uZ2V0TGVnZW5kYSgpCgllbGlmICd2ZXJ5c3RyZWFtLicgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJc3RyZWFtYW4gPSBVUkxSZXNvbHZlck1lZGlhLlZlcnlTdHJlYW0oc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pCgkJc3RyZWFtID0gc3RyZWFtYW4uZ2V0TWVkaWFVcmwoKQoJCWxlZ2VuZGEgPSBzdHJlYW1hbi5nZXRMZWdlbmRhKCkKCWVsc2U6CgkJc3RyZWFtID0gc2Vydmlkb3Jlc1tzZXJ2aWRvcl0KCXJldHVybiBzdHJlYW0sIGxlZ2VuZGEsIGV4dF9nCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwkJCQkJCQkJCQkJCUFkZG9uIEZpbG1lcyBlIFNlcmllcwkJCQkJCQkJCSAgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCmRlZiBsaXN0YW1lbnVzc2VyaWVzKG5vbWVfbm92LHVybCxlc3RpbG8sdGlwbyx0aXBvX3VzZXIsc2Vydmlkb3JfdXNlcixpY29uaW1hZ2UsZmFuYXJ0KToKCWNoZWNrX2xvZ2luID0gbG9naW4yKCkKCWlmIGNoZWNrX2xvZ2luID09IFRydWU6CgkJZGF0YWJhc2UgPSBEYXRhYmFzZS5pc0V4aXN0cygpCgkJbWVudVNlcmllcyhvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnc2VyaWVzLnBuZycpLF9fU0lURUFkZG9uX18rJ0ltYWdlbnMvc2VyaWVzX2ZhbmFydC5wbmcnKQoJZWxzZToKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdFcnJvIGEgZmF6ZXIgbG9naW4gbmVzdGEgcGFydGUuIFRlbnRlIG5vdmFtZW50ZSBtYWlzIHRhcmRlLicpCgpkZWYgbGlzdGFtZW51c2ZpbG1lcyhub21lX25vdix1cmwsZXN0aWxvLHRpcG8sdGlwb191c2VyLHNlcnZpZG9yX3VzZXIsaWNvbmltYWdlLGZhbmFydCk6CgljaGVja19sb2dpbiA9IGxvZ2luMigpCglpZiBjaGVja19sb2dpbiA9PSBUcnVlOgoJCWRhdGFiYXNlID0gRGF0YWJhc2UuaXNFeGlzdHMoKQoJCW1lbnVGaWxtZXMob3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2ZpbG1lcy5wbmcnKSxfX1NJVEVBZGRvbl9fKydJbWFnZW5zL2ZpbG1lc19mYW5hcnQucG5nJykKCWVsc2U6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnRXJybyBhIGZhemVyIGxvZ2luIG5lc3RhIHBhcnRlLiBUZW50ZSBub3ZhbWVudGUgbWFpcyB0YXJkZS4nKQoKZGVmIGxpc3RhbWVudXNhbmltZXMobm9tZV9ub3YsdXJsLGVzdGlsbyx0aXBvLHRpcG9fdXNlcixzZXJ2aWRvcl91c2VyLGljb25pbWFnZSxmYW5hcnQpOgoJY2hlY2tfbG9naW4gPSBsb2dpbjIoKQoJaWYgY2hlY2tfbG9naW4gPT0gVHJ1ZToKCQlkYXRhYmFzZSA9IERhdGFiYXNlLmlzRXhpc3RzKCkKCQltZW51QW5pbWVzKG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdhbmltZXMucG5nJyksX19TSVRFQWRkb25fXysnSW1hZ2Vucy9zZXJpZXNfZmFuYXJ0LnBuZycpCgllbHNlOgoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0Vycm8gYSBmYXplciBsb2dpbiBuZXN0YSBwYXJ0ZS4gVGVudGUgbm92YW1lbnRlIG1haXMgdGFyZGUuJykKCmRlZiBtZW51RmlsbWVzKGljb25pbWFnZSxmYW5hcnQpOgoJYWRkRGlyMignVG9kb3Mgb3MgRmlsbWVzJywgX19BUElfU0lURV9fKydmaWxtZXMucGhwP3F1YWxpZGFkZT0nK19fUXVhbGlkYWRlX18sIDExMSwgJ2ZpbG1lcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignRmlsbWVzIGVtIERlc3RhcXVlJywgIF9fQVBJX1NJVEVfXysnZmlsbWVzLnBocD9hY3Rpb249ZGVzdGFxdWUmcXVhbGlkYWRlPScrX19RdWFsaWRhZGVfXywgMTExLCAnZmlsbWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdGaWxtZXMgcG9yIEFubycsIF9fQVBJX1NJVEVfXysnZmlsbWVzLnBocD9hY3Rpb249YW5vJywgMTE5LCAnbGlzdGFnZW1Bbm9zJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Fuby5wbmcnKSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignRmlsbWVzIHBvciBHZW5lcm8nLCBfX0FQSV9TSVRFX18rJ2ZpbG1lcy5waHA/YWN0aW9uPWNhdGVnb3JpYScsIDExOCwgJ2xpc3RhZ2VtR2VuZXJvcycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdnZW5lcm8ucG5nJyksIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ0ZpbG1lcyBwb3IgSU1EQiBSYWtpbmcnLCAgX19BUElfU0lURV9fKydmaWxtZXMucGhwP2FjdGlvbj1pbWRiUmFuayZxdWFsaWRhZGU9JytfX1F1YWxpZGFkZV9fLCAxMTEsICdmaWxtZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ0ZpbG1lcyBQYXJhIENyaWFuw6dhcycsICBfX0FQSV9TSVRFX18rJ2ZpbG1lcy5waHA/YWN0aW9uPXB0JnF1YWxpZGFkZT0nK19fUXVhbGlkYWRlX18sIDExMSwgJ2ZpbG1lcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJCgl2aXN0YV9tZW51KCkKCmRlZiBtZW51U2VyaWVzKGljb25pbWFnZSxmYW5hcnQpOgoJYWRkRGlyMignVG9kYXMgYXMgU2VyaWVzJywgX19BUElfU0lURV9fKydzZXJpZXMucGhwJywgMTIzLCAnc2VyaWVzJywgaWNvbmltYWdlLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdTZXJpZXMgZW0gRGVzdGFxdWUnLCAgX19BUElfU0lURV9fKydzZXJpZXMucGhwP2FjdGlvbj1kZXN0YXF1ZScsIDEyMywgJ3NlcmllcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignU2VyaWVzIHBvciBBbm8nLCBfX0FQSV9TSVRFX18rJ3Nlcmllcy5waHA/YWN0aW9uPWFubycsIDExOSwgJ2xpc3RhZ2VtQW5vcycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdhbm8ucG5nJyksIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ1NlcmllcyBwb3IgR2VuZXJvJywgX19BUElfU0lURV9fKydzZXJpZXMucGhwP2FjdGlvbj1jYXRlZ29yaWEnLCAxMTgsICdsaXN0YWdlbUdlbmVyb3MnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnZ2VuZXJvLnBuZycpLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCgoJdmlzdGFfbWVudSgpCgpkZWYgbWVudUFuaW1lcyhpY29uaW1hZ2UsZmFuYXJ0KToKCWFkZERpcjIoJ1RvZG9zIG9zIEFuaW1lcycsIF9fQVBJX1NJVEVfXysnYW5pbWVzLnBocCcsIDEyMywgJ2FuaW1lcycsIGljb25pbWFnZSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoJYWRkRGlyMignQW5pbWVzIGVtIERlc3RhcXVlJywgIF9fQVBJX1NJVEVfXysnYW5pbWVzLnBocD9hY3Rpb249ZGVzdGFxdWUnLCAxMjMsICdhbmltZXMnLCBpY29uaW1hZ2UsIDEsIE5vbmUsIE5vbmUsIGZhbmFydCkKCWFkZERpcjIoJ0FuaW1lcyBwb3IgQW5vJywgX19BUElfU0lURV9fKydhbmltZXMucGhwP2FjdGlvbj1hbm8nLCAxMTksICdsaXN0YWdlbUFub3MnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAnYW5vLnBuZycpLCAxLCBOb25lLCBOb25lLCBmYW5hcnQpCglhZGREaXIyKCdBbmltZXMgcG9yIEdlbmVybycsIF9fQVBJX1NJVEVfXysnYW5pbWVzLnBocD9hY3Rpb249Y2F0ZWdvcmlhJywgMTE4LCAnbGlzdGFnZW1HZW5lcm9zJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2dlbmVyby5wbmcnKSwgMSwgTm9uZSwgTm9uZSwgZmFuYXJ0KQoKCXZpc3RhX21lbnUoKQoKZGVmIGdldExpc3RDYXRlZ29yaWEoKToKCWNhdCA9IGxlcl9maWNoZWlybyhvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdjYXRlZ29yaWFzLmxpdmVpdCcpKS5yZXBsYWNlKCciJywgIiciKQoJcmV0dXJuIGNhdAoKZGVmIHJlbW92ZXJBY2VudG9zKHR4dCwgZW5jb2Rpbmc9J3V0Zi04Jyk6CglyZXR1cm4gbm9ybWFsaXplKCdORktEJywgdHh0LmRlY29kZShlbmNvZGluZykpLmVuY29kZSgnQVNDSUknLCdpZ25vcmUnKQoKZGVmIGVzY3JldmVyX2ZpY2hlaXJvKGZpY2hlaXJvLCBjb250ZXVkbyk6CiAgICBmID0gb3BlbihmaWNoZWlybywgbW9kZT0idyIpCiAgICBmLndyaXRlKGNvbnRldWRvKQogICAgZi5jbG9zZSgpCgpkZWYgbGVyX2ZpY2hlaXJvKGZpY2hlaXJvKToKICAgIGYgPSBvcGVuKGZpY2hlaXJvLCAiciIpCiAgICBjb250ZXVkbyA9ICBmLnJlYWQoKQogICAgZi5jbG9zZSgpCiAgICByZXR1cm4gY29udGV1ZG8KCmRlZiBnZXRDYXRlZ29yaWEoaWQpOgoJY2F0ID0gbGVyX2ZpY2hlaXJvKG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ2NhdGVnb3JpYXMubGl2ZWl0JykpLnJlcGxhY2UoJyInLCAiJyIpCglmb3IgYyBpbiBhc3QubGl0ZXJhbF9ldmFsKGNhdCk6CgkJaWYgaW50KGlkKSA9PSAwOgoJCQlyZXR1cm4gJycKCQlpZiBpbnQoY1snaWRfY2F0ZWdvcmlhJ10pID09IGludChpZCk6CgkJCXRyeToKCQkJCWNhdCA9IGNbJ2NhdGVnb3JpYXMnXS5kZWNvZGUoJ3V0Zi04JykKCQkJZXhjZXB0OgoJCQkJY2F0ID0gY1snY2F0ZWdvcmlhcyddLmVuY29kZSgndXRmLTgnKQoJCQlyZXR1cm4gY2F0CgkKCSIiImlmIGludChpZCkgPT0gMDoKCQlyZXR1cm4gJycKCQoJZm9yIGMsIGkgaW4gY2F0czoKCQlpZiBpbnQoaSkgPT0gaW50KGlkKToKCQkJcmV0dXJuIGMiIiIKCglyZXR1cm4gJycKCQpkZWYgZ2V0Q29va2llKCk6CglyZXR1cm4gJ3VzZXJuYW1lPScrX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuTXJwaXJhY3knKQoKZGVmIHZlcmlmaWNhclZpc3RvTG9jYWwoaWRWaWRlbywgdGVtcG9yYWRhPU5vbmUsIGVwaXNvZGlvPU5vbmUpOgoJcGFzdGFWaXN0bz1vcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCd2aXN0b3MnKQoKCWlmIHRlbXBvcmFkYSBhbmQgZXBpc29kaW86CgkJZmljaGVpcm9WaXN0byA9IG9zLnBhdGguam9pbihwYXN0YVZpc3RvLHN0cihpZFZpZGVvKSsnX1MnK3N0cih0ZW1wb3JhZGEpKyd4JytzdHIoZXBpc29kaW8pKycubGl2ZWl0JykKCWVsc2U6CgkJZmljaGVpcm9WaXN0byA9IG9zLnBhdGguam9pbihwYXN0YVZpc3RvLHN0cihpZFZpZGVvKSsnLmxpdmVpdCcpCgoJaWYgb3MucGF0aC5leGlzdHMoZmljaGVpcm9WaXN0byk6CgkJcmV0dXJuIFRydWUKCWVsc2U6CgkJcmV0dXJuIEZhbHNlCgpkZWYgZmlsbWVzKHVybCwgcGFnaW5hKToKCSNoZWFkZXJzWydBdXRob3JpemF0aW9uJ10gPSAnQmVhcmVyICVzJyAlIF9fQURET05fXy5nZXRTZXR0aW5nKCd0b2tlbk1ycGlyYWN5JykKCSNpZiByZXN1bHRhZG8gPT0gJ0ROUyc6CgkjCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1RlbSBkZSBhbHRlcmFyIG9zIEROUyBwYXJhIHBvZGVyIHVzdWZydWlyIGRvIF9fQURET05fXy4nKQoJIwlyZXR1cm4gRmFsc2UKCXJlc3VsdGFkbyA9IGFicmlyX3VybCh1cmwsIGhlYWRlcj1oZWFkZXJzLCBjb29raWU9Z2V0Q29va2llKCkpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCXZpc3RvcyA9IERhdGFiYXNlLnNlbGVjdEZpbG1lcygpCglvcGNhbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCdtYXJjYXJWaXN0bycpCglmb3IgaSBpbiByZXN1bHRhZG9bJ2RhdGEnXToKCQlzZXRGaWxtZShpLCB2aXN0b3MsIG9wY2FvKQoJdHJ5OiAKCQljdXJyZW50ID0gcmVzdWx0YWRvWydtZXRhJ11bJ2N1cnJlbnQnXQoJZXhjZXB0OiAKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdBZ3VhcmRlIHBlbGEgcHLDs3hpbWEgYXR1YWxpemHDp8Ojby4gT3UgdGVudGUgbWFpcyB0YXJkZS4nKQoJCXJldHVybiBGYWxzZQoJY3VycmVudCA9IHJlc3VsdGFkb1snbWV0YSddWydjdXJyZW50J10KCXRvdGFsID0gcmVzdWx0YWRvWydtZXRhJ11bJ3RvdGFsJ10KCXRyeTogcHJveGltbyA9IHJlc3VsdGFkb1snbWV0YSddWydwYWdpbmFjYW8nXVsnbmV4dCddCglleGNlcHQ6IHBhc3MgCglpZiBpbnQoY3VycmVudCkgPCBpbnQodG90YWwpOgoJCWFkZERpcjIoJ1Byw7N4aW1hIHDDoWdpbmEgKCcrc3RyKGN1cnJlbnQpKycvJytzdHIodG90YWwpKycpJywgcHJveGltbywgMTExLCAnZmlsbWVzJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Byb3hpbW8ucG5nJyksMSkKCXZpc3RhX2ZpbG1lc1NlcmllcygpCgkJCmRlZiBzZXJpZXModXJsKToKCSNoZWFkZXJzWydBdXRob3JpemF0aW9uJ10gPSAnQmVhcmVyICVzJyAlIF9fQURET05fXy5nZXRTZXR0aW5nKCd0b2tlbk1ycGlyYWN5JykKCSNpZiByZXN1bHRhZG8gPT0gJ0ROUyc6CgkjCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1RlbSBkZSBhbHRlcmFyIG9zIEROUyBwYXJhIHBvZGVyIHVzdWZydWlyIGRvIF9fQURET05fXy4nKQoJIwlyZXR1cm4gRmFsc2UKCXJlc3VsdGFkbyA9IGFicmlyX3VybCh1cmwsIGhlYWRlcj1oZWFkZXJzLCBjb29raWU9Z2V0Q29va2llKCkpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCWlmICdzZXJpZScgaW4gdXJsOgoJCXRpcG8gPSAnc2VyaWUnCgllbGlmICdhbmltZScgaW4gdXJsOgoJCXRpcG8gPSAnYW5pbWUnCgkJCglpZiAnc2VyaWUnIGluIHVybDoKCQl0aXBvID0gJ3NlcmllcycKCWVsaWYgJ2FuaW1lJyBpbiB1cmw6CgkJdGlwbyA9ICdhbmltZXMnCgl2aXN0b3MgPSBEYXRhYmFzZS5zZWxlY3RGaWxtZXMoKQoJb3BjYW8gPSBfX0FERE9OX18uZ2V0U2V0dGluZygnbWFyY2FyVmlzdG8nKQoJZm9yIGkgaW4gcmVzdWx0YWRvWydkYXRhJ106CgkJc2V0U2VyaWVzKGksIHZpc3Rvcywgb3BjYW8sIHRpcG8pCgl0cnk6IAoJCWN1cnJlbnQgPSByZXN1bHRhZG9bJ21ldGEnXVsnY3VycmVudCddCglleGNlcHQ6IAoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0FndWFyZGUgcGVsYSBwcsOzeGltYSBhdHVhbGl6YcOnw6NvLiBPdSB0ZW50ZSBtYWlzIHRhcmRlLicpCgkJcmV0dXJuIEZhbHNlCgljdXJyZW50ID0gcmVzdWx0YWRvWydtZXRhJ11bJ2N1cnJlbnQnXQoJdG90YWwgPSByZXN1bHRhZG9bJ21ldGEnXVsndG90YWwnXQoJdHJ5OiBwcm94aW1vID0gcmVzdWx0YWRvWydtZXRhJ11bJ3BhZ2luYWNhbyddWyduZXh0J10KCWV4Y2VwdDogcGFzcyAKCWlmIGludChjdXJyZW50KSA8IGludCh0b3RhbCk6CgkJYWRkRGlyMignUHJveGltYSBwYWdpbmEgKCcrc3RyKGN1cnJlbnQpKycvJytzdHIodG90YWwpKycpJywgcHJveGltbywgMTIzLCAnc2VyaWVzJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ3Byb3hpbW8ucG5nJykpCgl2aXN0YV9maWxtZXNTZXJpZXMoKQoKZGVmIGdldFNlYXNvbnModXJsKToKCSNoZWFkZXJzWydBdXRob3JpemF0aW9uJ10gPSAnQmVhcmVyICVzJyAlIF9fQURET05fXy5nZXRTZXR0aW5nKCd0b2tlbk1ycGlyYWN5JykKCXJlc3VsdGFkbyA9IGFicmlyX3VybCh1cmwsIGhlYWRlcj1oZWFkZXJzLCBjb29raWU9Z2V0Q29va2llKCkpCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbylbJ2RhdGEnXVswXQoJaWQgPSB1cmwuc3BsaXQoJz0nKVstMV0KCWlmICdzZXJpZScgaW4gdXJsOgoJCXVybCA9IF9fQVBJX1NJVEVfXysnc2VyaWVzLnBocD9hY3Rpb249dGVtcG9yYWRhJmlkU2VyaWU9JytpZCsnJm49JXMnCgllbGlmICdhbmltZScgaW4gdXJsOgoJCXVybCA9IF9fQVBJX1NJVEVfXysnYW5pbWVzLnBocD9hY3Rpb249dGVtcG9yYWRhJmlkU2VyaWU9JytpZCsnJm49JXMnCgkKCXRyeToKCQlyZXN1bHRhZG9bJ3RlbXBvcmFkYXMnXSA9IHJlc3VsdGFkb1sndGVtcG9yYWRhcyddLnJlcGxhY2UoJ2VzcGVjaWFsJywgJzk5OScpCglleGNlcHQ6CgkJcGFzcwoJaWYgcmVzdWx0YWRvID09ICdETlMnOgoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1RlbSBkZSBhbHRlcmFyIG9zIEROUyBwYXJhIHBvZGVyIHVzdWZydWlyIGRvIF9fQURET05fXy4nKQoJCXJldHVybiBGYWxzZQoJCglqPTEKCQoJaWYgcmVzdWx0YWRvWyd0ZW1wb3JhZGFzJ10gPT0gIiI6CgkJcmV0dXJuIEZhbHNlCglmb3IgYywgaSBpbiBzb3J0ZWQoanNvbi5sb2FkcyhyZXN1bHRhZG9bJ3RlbXBvcmFkYXMnXSkuaXRlcml0ZW1zKCksIGtleT1sYW1iZGEgaTogaW50KGlbMF0pKToKCQlpZiBjICE9ICc5OTknOgoJCQlhZGREaXIyKCJbQl1UZW1wb3JhZGFbL0JdICIrc3RyKGMpLCAodXJsICUgc3RyKGMpKSwgMTE1LCAnZXBpc29kaW9zJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywndGVtcG9yYWRhcycsICd0ZW1wb3JhZGEnK3N0cihjKSsnLnBuZycpLHBvc3Rlcj1fX0FQSV9fK3Jlc3VsdGFkb1snYmFja2dyb3VuZCddKQoJCWVsc2U6CgkJCWFkZERpcjIoIltCXVRlbXBvcmFkYVsvQl0gIitzdHIoYyksICh1cmwgJSAnOTk5JyksIDExNSwgJ2VwaXNvZGlvcycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sJ3RlbXBvcmFkYXMnLCAndGVtcG9yYWRhJytzdHIoYykrJy5wbmcnKSxwb3N0ZXI9X19BUElfXytyZXN1bHRhZG9bJ2JhY2tncm91bmQnXSkKCQoJdmlzdGFfdGVtcG9yYWRhcygpCgpkZWYgZ2V0RXBpc29kZXModXJsKToKCSNoZWFkZXJzWydBdXRob3JpemF0aW9uJ10gPSAnQmVhcmVyICVzJyAlIF9fQURET05fXy5nZXRTZXR0aW5nKCd0b2tlbk1ycGlyYWN5JykKCXJlc3VsdGFkbyA9IGFicmlyX3VybCh1cmwsIGhlYWRlcj1oZWFkZXJzLCBjb29raWU9Z2V0Q29va2llKCkpCglpZiByZXN1bHRhZG8gPT0gJ0ROUyc6CgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnVGVtIGRlIGFsdGVyYXIgb3MgRE5TIHBhcmEgcG9kZXIgdXN1ZnJ1aXIgZG8gX19BRERPTl9fLicpCgkJcmV0dXJuIEZhbHNlCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCWlmICdzZXJpZScgaW4gdXJsOgoJCXRpcG8gPSAnc2VyaWVzJwoJZWxpZiAnYW5pbWUnIGluIHVybDoKCQl0aXBvID0gJ2FuaW1lcycKCWZvciBpIGluIHJlc3VsdGFkb1snZGF0YSddOgoJCXB0ID0gJycKCQlpbmZvTGFiZWxzID0geydUaXRsZSc6IGlbJ25vbWVfZXBpc29kaW8nXSwgJ0NvZGUnOiBpWydJTUJEJ10sICdFcGlzb2RlJzogaVsnZXBpc29kaW8nXSwgJ1NlYXNvbic6IGlbJ3RlbXBvcmFkYSddIH0KCQkKCQl0cnk6CgkJCW5vbWUgPSBpWydub21lX2VwaXNvZGlvJ10uZGVjb2RlKCd1dGYtOCcpCgkJZXhjZXB0OgoJCQlub21lID0gaVsnbm9tZV9lcGlzb2RpbyddLmVuY29kZSgndXRmLTgnKQoJCWJyID0gJycKCQlmaW5hbCA9ICcnCgkJc2VtTGVnZW5kYSA9ICcnCgkJaWYgaVsnZmltdGVtcG9yYWRhJ10gPT0gMToKCQkJZmluYWwgPSAnW0JdRmluYWwgZGEgVGVtcG9yYWRhIFsvQl0nCgkJaWYgaVsnc2VtbGVnZW5kYSddID09IDE6CgkJCXNlbUxlZ2VuZGEgPSAnW0NPTE9SIHJlZF1bQl1TLyBMRUdFTkRBIFsvQl1bL0NPTE9SXScKCQkjaWYgJ0JyYXNpbGVpcm8nIGluIGNhdGVnb3JpYToKCQkjCWJyID0gJ1tCXVtDT0xPUiBncmVlbl1CWy9DT0xPUl1bQ09MT1IgeWVsbG93XVJbL0NPTE9SXTogWy9CXScKCQkjaWYgJ1BvcnR1JyBpbiBjYXRlZ29yaWE6CgkJIwlwdCA9ICdbQl1bQ09MT1IgZ3JlZW5dUFsvQ09MT1JdW0NPTE9SIHJlZF1UWy9DT0xPUl06IFsvQl0nCgkJaWYgJ1BUJyBpbiBpWydJTUJEJ106CgkJCWlbJ0lNQkQnXSA9IHJlLmNvbXBpbGUoJyguKz8pUFQnKS5maW5kYWxsKGlbJ0lNQkQnXSlbMF0KCQkJcHQgPSAnW0JdW0NPTE9SIGdyZWVuXVBbL0NPTE9SXVtDT0xPUiByZWRdVFsvQ09MT1JdOiBbL0JdJwoJCXZpc3RvID0gRmFsc2UKCQljb3IgPSAnd2hpdGUnCgkJI2lmIGlbJ3Zpc3RvJ10gPT0gMToKCQkjCXZpc3RvID0gVHJ1ZQkKCQkKCQlpbWFnZW0gPSAnJwoJCWlmIGlbJ2ltYWdlbSddID09IDE6CgkJCWltYWdlbSA9IF9fQVBJX18rJ2ltYWdlcy9zZXJpZXMvJytpWydJTUJEJ10rJy5qcGcnCgkJZWxpZiBpWydpbWFnZW0nXSA9PSAwOgoJCQlpbWFnZW0gPSBfX0FQSV9fKydpbWFnZXMvY2FwYXMvJytpWydpbWRiU2VyaWUnXSsnLmpwZycKCQkKCQkjaW1hZ2VtID0gaW1hZ2VtLnJlcGxhY2UoJ1BUJywnJykKCQkjaVsnYmFja2dyb3VuZCddID0gaVsnYmFja2dyb3VuZCddLnJlcGxhY2UoJ1BUJywnJykKCQlpWydiYWNrZ3JvdW5kJ10gPSAnaW1hZ2VzL2JhY2tncm91bmQvJytpWydJTUJEJ10rJy5qcGcnCgkJZmFuYXJ0dHQgPSBfX0FQSV9fK2lbJ2JhY2tncm91bmQnXQoJCQoJCW5vbWVlZSA9IHB0K2JyK2ZpbmFsK3NlbUxlZ2VuZGErJ1tDT0xPUiAnK2NvcisnXVtCXUVwaXNvZGlvICcrc3RyKGlbJ2VwaXNvZGlvJ10pKydbL0JdWy9DT0xPUl0gJytyZW1vdmVyQWNlbnRvcyhub21lKQoJCXVybG5vdm8gPSBfX0FQSV9TSVRFX18rdGlwbysnLnBocD9hY3Rpb249ZXBpc29kaW8maWRTZXJpZT0nK3N0cihpWydpZF9zZXJpZSddKSsnJmlkRXBpc29kaW89JytzdHIoaVsnaWRfZXBpc29kaW8nXSkKCQlhZGRWaWRlbyhub21lZWUsIHVybG5vdm8sIDExMywgaW1hZ2VtLCB2aXN0bywgJ2VwaXNvZGlvJywgaVsndGVtcG9yYWRhJ10sIGlbJ2VwaXNvZGlvJ10sIGluZm9MYWJlbHMsIGZhbmFydHR0KQoJCgl2aXN0YV9lcGlzb2Rpb3MoKQoKZGVmIGdldEdlbmVyb3ModXJsKToKCWxpc3RhID0gZ2V0TGlzdENhdGVnb3JpYSgpCglpZiAnZmlsbWVzJyBpbiB1cmw6CgkJdGlwbyA9IDAKCQlxdWFsaWRhZGUgPSAnJnF1YWxpZGFkZT0nK19fUXVhbGlkYWRlX18KCWVsaWYgJ3NlcmllcycgaW4gdXJsOgoJCXRpcG8gPSAxCgkJcXVhbGlkYWRlID0gJycKCWVsaWYgJ2FuaW1lcycgaW4gdXJsOgoJCXRpcG8gPSAyCgkJcXVhbGlkYWRlID0gJycKCQoJZm9yIGMgaW4gYXN0LmxpdGVyYWxfZXZhbChsaXN0YSk6CgkJaWYgY1snaWRfY2F0ZWdvcmlhJ10gPT0gIjAiOgoJCQljb250aW51ZQoJCXRyeToKCQkJY2F0ID0gY1snY2F0ZWdvcmlhcyddLmRlY29kZSgndXRmLTgnKQoJCWV4Y2VwdDoKCQkJY2F0ID0gY1snY2F0ZWdvcmlhcyddLmVuY29kZSgndXRmLTgnKQoJCQoJCXVybG5vdm8gPSB1cmwrJyZjYXRlZ29yaWE9JytzdHIoY1snaWRfY2F0ZWdvcmlhJ10pK3F1YWxpZGFkZTsKCQlhZGREaXIyKGNhdCwgdXJsbm92bywgMTIyLCAnY2F0ZWdvcmlhcycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdnZW5lcm8ucG5nJykpCgkKCXZpc3RhX21lbnUoKQoKZGVmIHNldEZpbG1lKGksIHZpc3Rvcywgb3BjYW8pOgoJY2F0ZWdvcmlhID0gZ2V0Q2F0ZWdvcmlhKGlbJ2NhdGVnb3JpYTEnXSkKCWlmIGludChpWydjYXRlZ29yaWEyJ10pICE9IDA6CgkJY2F0ZWdvcmlhICs9ICcsJytnZXRDYXRlZ29yaWEoaVsnY2F0ZWdvcmlhMiddKQoJaWYgaW50KGlbJ2NhdGVnb3JpYTMnXSkgIT0gMDoKCQljYXRlZ29yaWEgKz0gJywnK2dldENhdGVnb3JpYShpWydjYXRlZ29yaWEzJ10pCgkKCXB0ID0gJycKCWJyID0gJycKCXNlbUxlZ2VuZGEgPSAnJwoJdmlzdG8gPSBGYWxzZQoJdmlzdG9hID0gRmFsc2UKCXZlcmlmaWNhclZpc3RvTG9jYWwoaVsnaWRfdmlkZW8nXSkKCQoJdHJ5OgoJCW5vbWUgPSBpWydub21lX2luZ2xlcyddLmRlY29kZSgndXRmLTgnKQoJZXhjZXB0OgoJCW5vbWUgPSBpWydub21lX2luZ2xlcyddLmVuY29kZSgndXRmLTgnKQoJaWYgJ2h0dHAnIG5vdCBpbiBpWydmb3RvJ106CgkJaVsnZm90byddID0gX19BUElfXysnaW1hZ2VzL2NhcGFzLycraVsnZm90byddLnNwbGl0KCcvJylbLTFdCgkKCWlmIGlbJ2xlZ2VuZGEnXSA9PSAic2VtbGVnZW5kYSI6CgkJc2VtTGVnZW5kYSA9ICdbQ09MT1IgcmVkXVtCXVMvIExFR0VOREEgWy9CXVsvQ09MT1JdJwoJaWYgJ0JyYXNpbGVpcm8nIGluIGNhdGVnb3JpYToKCQliciA9ICdbQl1bQ09MT1IgZ3JlZW5dQlsvQ09MT1JdW0NPTE9SIHllbGxvd11SWy9DT0xPUl06IFsvQl0nCglpZiAnUG9ydHUnIGluIGNhdGVnb3JpYToKCQlwdCA9ICdbQl1bQ09MT1IgZ3JlZW5dUFsvQ09MT1JdW0NPTE9SIHJlZF1UWy9DT0xPUl06IFsvQl0nCgljb3IgPSAid2hpdGUiCglpZiAnUFQnIGluIGlbJ0lNQkQnXToKCQlpWydJTUJEJ10gPSByZS5jb21waWxlKCcoLis/KVBUJykuZmluZGFsbChpWydJTUJEJ10pWzBdCgkJcHQgPSAnW0JdW0NPTE9SIGdyZWVuXVBbL0NPTE9SXVtDT0xPUiByZWRdVFsvQ09MT1JdOiBbL0JdJwoJCglpbWRiUiA9IGpzb24ubG9hZHMoaVsnaW1kYlJhdGluZyddKQoJCglpbmZvTGFiZWxzID0geydUaXRsZSc6IGlbJ25vbWVfaW5nbGVzJ10sICdZZWFyJzogaVsnYW5vJ10sICdHZW5yZSc6IGNhdGVnb3JpYSwgJ1Bsb3QnOmlbJ2Rlc2NyaWNhb192aWRlbyddLCAnQ2FzdCc6aVsnYXRvcmVzJ10uc3BsaXQoJywnKSwgJ1RyYWlsZXInOiBpbWRiUlsndHJhaWxlciddLCAnRGlyZWN0b3InOiBpWydkaXJldG9yJ10sICdSYXRpbmcnOiBpbWRiUlsncmFua2luZyddLCAnSU1EQk51bWJlcic6IGlbJ0lNQkQnXSB9CgoJbm9tZWVlID0gJ1tDT0xPUiAnK2NvcisnXScrcHQrYnIrc2VtTGVnZW5kYStyZW1vdmVyQWNlbnRvcyhub21lKSsnICgnK2lbJ2FubyddKycpWy9DT0xPUl0nCgl1cmxub28gPSBfX0FQSV9TSVRFX18rJ2ZpbG1lcy5waHA/YWN0aW9uPWlkJmlkRmlsbWU9JytzdHIoaVsnaWRfdmlkZW8nXSkKCWZvdG9vbyA9IGlbJ2ZvdG8nXQoJaVsnYmFja2dyb3VuZCddID0gJ2ltYWdlcy9iYWNrZ3JvdW5kLycraVsnSU1CRCddKycuanBnJwoJZmFuYXJ0dHQgPSBfX0FQSV9fK2lbJ2JhY2tncm91bmQnXQoJCglhZGRWaWRlbyhub21lZWUsIHVybG5vbywgMTEzLCBmb3Rvb28sdmlzdG8sICdwbGF5ZXInLCAwLCAwLCBpbmZvTGFiZWxzLCBmYW5hcnR0dCwgdHJhaWxlcj1pbWRiUlsndHJhaWxlciddKQoKZGVmIHNldFNlcmllcyhpLCB2aXN0b3MsIG9wY2FvLCB0aXBvKToKCWNhdGVnb3JpYSA9IGdldENhdGVnb3JpYShpWydjYXRlZ29yaWExJ10pCglpZiBpbnQoaVsnY2F0ZWdvcmlhMiddKSAhPSAwOgoJCWNhdGVnb3JpYSArPSAnLCcrZ2V0Q2F0ZWdvcmlhKGlbJ2NhdGVnb3JpYTInXSkKCWlmIGludChpWydjYXRlZ29yaWEzJ10pICE9IDA6CgkJY2F0ZWdvcmlhICs9ICcsJytnZXRDYXRlZ29yaWEoaVsnY2F0ZWdvcmlhMyddKQoJCglwdCA9ICcnCgliciA9ICcnCglzZW1MZWdlbmRhID0gJycKCSNpZiBpWydsZWdlbmRhJ10gPT0gInNlbWxlZ2VuZGEiOgoJIwlzZW1MZWdlbmRhID0gJ1tDT0xPUiByZWRdW0JdUy8gTEVHRU5EQSBbL0JdWy9DT0xPUl0nCglpZiAnQnJhc2lsZWlybycgaW4gY2F0ZWdvcmlhOgoJCWJyID0gJ1tCXVtDT0xPUiBncmVlbl1CWy9DT0xPUl1bQ09MT1IgeWVsbG93XVJbL0NPTE9SXTogWy9CXScKCWlmICdQb3J0dScgaW4gY2F0ZWdvcmlhOgoJCXB0ID0gJ1tCXVtDT0xPUiBncmVlbl1QWy9DT0xPUl1bQ09MT1IgcmVkXVRbL0NPTE9SXTogWy9CXScKCWlmICdQVCcgaW4gaVsnSU1CRCddOgoJCXB0ID0gJ1tCXVtDT0xPUiBncmVlbl1QWy9DT0xPUl1bQ09MT1IgcmVkXVRbL0NPTE9SXTogWy9CXScKCXZpc3RvID0gRmFsc2UKCXZpc3RvYSA9IEZhbHNlCgl2ZXJpZmljYXJWaXN0b0xvY2FsKGlbJ2lkX3ZpZGVvJ10pCgl0cnk6CgkJbm9tZSA9IGlbJ25vbWVfaW5nbGVzJ10uZGVjb2RlKCd1dGYtOCcpCglleGNlcHQ6CgkJbm9tZSA9IGlbJ25vbWVfaW5nbGVzJ10uZW5jb2RlKCd1dGYtOCcpCglpZiAnaHR0cCcgbm90IGluIGlbJ2ZvdG8nXToKCQlpWydmb3RvJ10gPSBfX0FQSV9fKydpbWFnZXMvY2FwYXMvJytpWydmb3RvJ10uc3BsaXQoJy8nKVstMV0KCQkjaVsnZm90byddID0gaVsnZm90byddLnJlcGxhY2UoJ1BUJywnJykKCQoJaW1kYlIgPSBqc29uLmxvYWRzKGlbJ2ltZGJSYXRpbmcnXSkKCXVybG5vbyA9IF9fQVBJX1NJVEVfXyt0aXBvKycucGhwP2FjdGlvbj1pZCZpZFNlcmllPScrc3RyKGlbJ2lkX3ZpZGVvJ10pCglpbmZvTGFiZWxzID0geydUaXRsZSc6IGlbJ25vbWVfaW5nbGVzJ10sICdZZWFyJzogaVsnYW5vJ10sICdHZW5yZSc6IGNhdGVnb3JpYSwgJ1Bsb3QnOiBpWydkZXNjcmljYW9fdmlkZW8nXSwgJ0Nhc3QnOmlbJ2F0b3JlcyddLnNwbGl0KCcsJyksICdUcmFpbGVyJzogaW1kYlJbJ3RyYWlsZXInXSwgJ0RpcmVjdG9yJzogaVsnZGlyZXRvciddLCAnUmF0aW5nJzogaW1kYlJbJ3JhbmtpbmcnXSwgJ0NvZGUnOiBpWydJTUJEJ10gfQoJCglub21lZWUgPSBwdCticitzZW1MZWdlbmRhK3JlbW92ZXJBY2VudG9zKG5vbWUpKycgKCcraVsnYW5vJ10rJyknCglmb3Rvb28gPSBpWydmb3RvJ10KCSNpWydiYWNrZ3JvdW5kJ10gPSBpWydiYWNrZ3JvdW5kJ10ucmVwbGFjZSgnUFQnLCcnKQoJaVsnYmFja2dyb3VuZCddID0gJ2ltYWdlcy9iYWNrZ3JvdW5kLycraVsnSU1CRCddKycuanBnJwoJZmFuYXJ0dHQgPSBfX0FQSV9fK2lbJ2JhY2tncm91bmQnXQoJYWRkRGlyMihub21lZWUsIHVybG5vbywgMTE0LCAndGVtcG9yYWRhcycsIGZvdG9vbywgdGlwbz0nc2VyaWUnLCBpbmZvTGFiZWxzPWluZm9MYWJlbHMscG9zdGVyPWZhbmFydHR0LHZpc3RvPXZpc3RvKQoKZGVmIGNhdGVnb3JpYXModXJsKToKCSNoZWFkZXJzWydBdXRob3JpemF0aW9uJ10gPSAnQmVhcmVyICVzJyAlIF9fQURET05fXy5nZXRTZXR0aW5nKCd0b2tlbk1ycGlyYWN5JykKCXJlc3VsdGFkbyA9IGFicmlyX3VybCh1cmwsIGhlYWRlcj1oZWFkZXJzLCBjb29raWU9Z2V0Q29va2llKCkpCgkjaWYgcmVzdWx0YWRvID09ICdETlMnOgoJIwlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdUZW0gZGUgYWx0ZXJhciBvcyBETlMgcGFyYSBwb2RlciB1c3VmcnVpciBkbyBfX0FERE9OX18uJykKCSMJcmV0dXJuIEZhbHNlCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCXZpc3RvcyA9IERhdGFiYXNlLnNlbGVjdEZpbG1lcygpCglvcGNhbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCdtYXJjYXJWaXN0bycpCglpZiAnc2VyaWUnIGluIHVybDoKCQl0aXBvID0gJ3NlcmllcycKCWVsaWYgJ2FuaW1lJyBpbiB1cmw6CgkJdGlwbyA9ICdhbmltZXMnCglmb3IgaSBpbiByZXN1bHRhZG9bImRhdGEiXToKCQlpZiAnZmlsbWUnIGluIHVybDoKCQkJc2V0RmlsbWUoaSwgdmlzdG9zLCBvcGNhbykKCQllbGlmICdzZXJpZScgaW4gdXJsIG9yICdhbmltZScgaW4gdXJsOgoJCQlzZXRTZXJpZXMoaSwgdmlzdG9zLCBvcGNhbywgdGlwbykKCWN1cnJlbnQgPSByZXN1bHRhZG9bJ21ldGEnXVsnY3VycmVudCddCgl0b3RhbCA9IHJlc3VsdGFkb1snbWV0YSddWyd0b3RhbCddCgl0cnk6IHByb3hpbW8gPSByZXN1bHRhZG9bJ21ldGEnXVsncGFnaW5hY2FvJ11bJ25leHQnXQoJZXhjZXB0OiBwYXNzIAoJaWYgaW50KGN1cnJlbnQpIDwgaW50KHRvdGFsKToKCQlhZGREaXIyKCdQcsOzeGltYSBww6FnaW5hICgnK3N0cihjdXJyZW50KSsnLycrc3RyKHRvdGFsKSsnKScsIHByb3hpbW8sIDEyMSwgJ2Fub3MnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncHJveGltby5wbmcnKSwxKQoJCgl2aXN0YV9maWxtZXNTZXJpZXMoKQoKZGVmIGdldFllYXJzKHVybCk6Cglhbm9zID0gWwoJCQknMjAxOScsCgkJCScyMDE4JywKCQkJJzIwMTcnLAoJCQknMjAxNicsCgkJCScyMDE1JywKCQkJJzIwMTQnLAoJCQknMjAxMycsCgkJCScyMDEyJywKCQkJJzIwMTEnLAoJCQknMjAxMCcsCgkJCScyMDA5JywKCQkJJzIwMDgnLAoJCQknMjAwNycsCgkJCScyMDA2JywKCQkJJzIwMDAtMjAwNScsCgkJCScxOTkwLTE5OTknLAoJCQknMTk4MC0xOTg5JywKCQkJJzE5NzAtMTk3OScsCgkJCScxOTYwLTE5NjknLAoJCQknMTk1MC0xOTU5JywKCQkJJzE5MDAtMTk0OScKCQldCglpZiAnZmlsbWVzJyBpbiB1cmw6CgkJdGlwbyA9IDAKCQlxdWFsaWRhZGUgPSAnJnF1YWxpZGFkZT0nK19fUXVhbGlkYWRlX18KCWVsaWYgJ3NlcmllcycgaW4gdXJsOgoJCXRpcG8gPSAxCgkJcXVhbGlkYWRlID0gJycKCWVsaWYgJ2FuaW1lcycgaW4gdXJsOgoJCXRpcG8gPSAyCgkJcXVhbGlkYWRlID0gJycKCWZvciBpIGluIGFub3M6CgkJdXJsbm92byA9IHVybCsnJmFubz0nK2krcXVhbGlkYWRlOwoJCWFkZERpcjIoaSwgdXJsbm92bywgMTIxLCAnYW5vcycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdhbm8ucG5nJykpCgkJCgl2aXN0YV9tZW51KCkKCmRlZiBhbm9zKHVybCk6CgkjaGVhZGVyc1snQXV0aG9yaXphdGlvbiddID0gJ0JlYXJlciAlcycgJSBfX0FERE9OX18uZ2V0U2V0dGluZygndG9rZW5NcnBpcmFjeScpCglyZXN1bHRhZG8gPSBhYnJpcl91cmwodXJsLCBoZWFkZXI9aGVhZGVycywgY29va2llPWdldENvb2tpZSgpKQoJaWYgcmVzdWx0YWRvID09ICdETlMnOgoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1RlbSBkZSBhbHRlcmFyIG9zIEROUyBwYXJhIHBvZGVyIHVzdWZydWlyIGRvIF9fQURET05fXy4nKQoJCXJldHVybiBGYWxzZQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pCgl2aXN0b3MgPSBEYXRhYmFzZS5zZWxlY3RGaWxtZXMoKQoJb3BjYW8gPSBfX0FERE9OX18uZ2V0U2V0dGluZygnbWFyY2FyVmlzdG8nKQoJaWYgJ3NlcmllJyBpbiB1cmw6CgkJdGlwbyA9ICdzZXJpZXMnCgllbGlmICdhbmltZScgaW4gdXJsOgoJCXRpcG8gPSAnYW5pbWVzJwoJZm9yIGkgaW4gcmVzdWx0YWRvWyJkYXRhIl06CgkJaWYgJ2ZpbG1lJyBpbiB1cmw6CgkJCXNldEZpbG1lKGksIHZpc3Rvcywgb3BjYW8pCgkJZWxpZiAnc2VyaWUnIGluIHVybCBvciAnYW5pbWUnIGluIHVybDoKCQkJc2V0U2VyaWVzKGksIHZpc3Rvcywgb3BjYW8sIHRpcG8pCgkKCXRyeTogCgkJY3VycmVudCA9IHJlc3VsdGFkb1snbWV0YSddWydjdXJyZW50J10KCWV4Y2VwdDogCgkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnQWd1YXJkZSBwZWxhIHByw7N4aW1hIGF0dWFsaXphw6fDo28uIE91IHRlbnRlIG1haXMgdGFyZGUuJykKCQlyZXR1cm4gRmFsc2UKCWN1cnJlbnQgPSByZXN1bHRhZG9bJ21ldGEnXVsnY3VycmVudCddCgl0b3RhbCA9IHJlc3VsdGFkb1snbWV0YSddWyd0b3RhbCddCgl0cnk6IHByb3hpbW8gPSByZXN1bHRhZG9bJ21ldGEnXVsncGFnaW5hY2FvJ11bJ25leHQnXQoJZXhjZXB0OiBwYXNzIAoJaWYgaW50KGN1cnJlbnQpIDwgaW50KHRvdGFsKToKCQlhZGREaXIyKCdQcsOzeGltYSBww6FnaW5hICgnK3N0cihjdXJyZW50KSsnLycrc3RyKHRvdGFsKSsnKScsIHByb3hpbW8sIDEyMSwgJ2Fub3MnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncHJveGltby5wbmcnKSwxKQoJCgl2aXN0YV9maWxtZXNTZXJpZXMoKQoKZGVmIGdldEV2ZW50b3MoKToKCSNoZWFkZXJzWydBdXRob3JpemF0aW9uJ10gPSAnQmVhcmVyICVzJyAlIF9fQURET05fXy5nZXRTZXR0aW5nKCd0b2tlbk1ycGlyYWN5JykKCXJlc3VsdGFkbyA9IGFicmlyX3VybChfX0FQSV9TSVRFX18rJ2V2ZW50b3MnLCBoZWFkZXI9aGVhZGVycywgY29va2llPWdldENvb2tpZSgpKQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pCgl0cnk6CgkJaWYgcmVzdWx0YWRvWydjb2RpZ28nXSA9PSAyMDQ6CgkJCXJldHVybiBGYWxzZQoJZXhjZXB0OgoJCXBhc3MKCXJldHVybiByZXN1bHRhZG9bJ2RhdGEnXVsnbm9tZSddCgkJCgkJCmRlZiBwbGF5ZXIobmFtZSx1cmwsaWNvbmltYWdlLHRlbXBvcmFkYSxlcGlzb2RpbyxzZXJpZU5vbWUpOgoJI2hlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICdCZWFyZXIgJXMnICUgX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuTXJwaXJhY3knKQoJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCwgaGVhZGVyPWhlYWRlcnMsIGNvb2tpZT1nZXRDb29raWUoKSkKCWlmIHJlc3VsdGFkbyA9PSAnRE5TJzoKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdUZW0gZGUgYWx0ZXJhciBvcyBETlMgcGFyYSBwb2RlciB1c3VmcnVpciBkbyBfX0FERE9OX18uJykKCQlyZXR1cm4gRmFsc2UKCQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pWzBdCgkjcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pCglpbmZvbGFiZWxzID0gZGljdCgpCgljb2lzbyA9ICcnCglwYXN0YURhdGEgPSAnJwoJdGlwbyA9ICcnCglpZFZpZGVvID0gJycKCWlmICdmaWxtZScgaW4gdXJsOgoJCXRpcG8gPSAnZmlsbWUnCgkJaW5mb2xhYmVsc1snQ29kZSddID0gcmVzdWx0YWRvWydJTUJEJ10KCQlpbmZvbGFiZWxzWydZZWFyJ10gPSByZXN1bHRhZG9bJ2FubyddCgkJaWRWaWRlbyA9IHJlc3VsdGFkb1snaWRfdmlkZW8nXQoJCW5vbWUgPSByZXN1bHRhZG9bJ25vbWVfaW5nbGVzJ10KCQl0ZW1wb3JhZGEgPSAwCgkJZXBpc29kaW8gPSAwCgkJY29pc28gPSAnZmlsbWUnCgllbHNlOgoJCWlmICdzZXJpZScgaW4gdXJsOgoJCQl0aXBvID0gJ3NlcmllJwoJCWVsc2U6CgkJCXRpcG8gPSAnYW5pbWUnCgkJaWRWaWRlbyA9IHJlc3VsdGFkb1snaWRfc2VyaWUnXQoJCW5vbWUgPSByZXN1bHRhZG9bJ25vbWVfZXBpc29kaW8nXQoJCXRlbXBvcmFkYSA9IHJlc3VsdGFkb1sndGVtcG9yYWRhJ10KCQllcGlzb2RpbyA9IHJlc3VsdGFkb1snZXBpc29kaW8nXQoJCWNvaXNvID0gJ291dHJvJwoKCW1lbnNhZ2VtcHJvZ3Jlc3NvID0geGJtY2d1aS5EaWFsb2dQcm9ncmVzcygpCgltZW5zYWdlbXByb2dyZXNzby5jcmVhdGUoQWRkb25UaXRsZSwgdSdBYnJpciBlbWlzc8OjbycsJ1BvciBmYXZvciBhZ3VhcmRlLi4uJykKCW1lbnNhZ2VtcHJvZ3Jlc3NvLnVwZGF0ZSgyNSwgIiIsIHUnT2J0ZXIgdmlkZW8gZSBsZWdlbmRhJywgIiIpCgoJc3RyZWFtLCBsZWdlbmRhLCBleHRfZyA9IGdldFN0cmVhbUxlZ2VuZGEoaWRWaWRlbywgdGlwbywgY29pc289Y29pc28pCglpZiBzdHJlYW0gPT0gRmFsc2UgYW5kIGxlZ2VuZGEgPT0gMjA0OgoJCW1lbnNhZ2VtcHJvZ3Jlc3NvLmNsb3NlKCkKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdUZW0gZGUgZXNwZXJhciA4IGhvcmFzIGF0w6kgY29uc2VndWlyIHZpc3VhbGl6YXIgYWxndW0gdmlkZW8uJykKCQlyZXR1cm4gRmFsc2UKCQoJbWVuc2FnZW1wcm9ncmVzc28udXBkYXRlKDUwLCAiIiwgdSdQcmVwYXJhLXRlLCB2YWkgY29tZcOnYXIhJywgIiIpCglwbGF5bGlzdCA9IHhibWMuUGxheUxpc3QoMSkKCXBsYXlsaXN0LmNsZWFyKCkKCWxpc3RpdGVtID0geGJtY2d1aS5MaXN0SXRlbShuYW1lLCBpY29uSW1hZ2U9IkRlZmF1bHRWaWRlby5wbmciLCB0aHVtYm5haWxJbWFnZT1pY29uaW1hZ2UpCgoJbGlzdGl0ZW0uc2V0SW5mbyh0eXBlPSJWaWRlbyIsIGluZm9MYWJlbHM9aW5mb2xhYmVscykKCWxpc3RpdGVtLnNldFByb3BlcnR5KCdtaW1ldHlwZScsICd2aWRlby94LW1zdmlkZW8nKQoJbGlzdGl0ZW0uc2V0UHJvcGVydHkoJ0lzUGxheWFibGUnLCAndHJ1ZScpCgkKCWxpc3RpdGVtLnNldFBhdGgocGF0aD1zdHJlYW0pCglwbGF5bGlzdC5hZGQoc3RyZWFtLCBsaXN0aXRlbSkKCXhibWNwbHVnaW4uc2V0UmVzb2x2ZWRVcmwoaW50KHN5cy5hcmd2WzFdKSwgVHJ1ZSwgbGlzdGl0ZW0pCgltZW5zYWdlbXByb2dyZXNzby51cGRhdGUoNzUsICIiLCB1J0JvYSBTZXNzw6NvISEhJywgIiIpCgoJaWYgc3RyZWFtID09IEZhbHNlOgoJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ08gc2Vydmlkb3IgZXNjb2xoaWRvIG7Do28gZGlzcG9uw612ZWwsIGVzY29saGEgb3V0cm8gb3UgdGVudGUgbm92YW1lbnRlIG1haXMgdGFyZGUuJykKCWVsc2U6CgkJI19fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1N0cmVhbTogJytzdHJlYW0pCgkJcGxheWVyX21yID0gUGxheWVyLlBsYXllcih1cmw9dXJsLCBpZEZpbG1lPWlkVmlkZW8sIHBhc3RhRGF0YT1fX1BBU1RBX0RBRE9TX18sIHRlbXBvcmFkYT10ZW1wb3JhZGEsIGVwaXNvZGlvPWVwaXNvZGlvLCBub21lPW5hbWUsIGxvZ289b3MucGF0aC5qb2luKF9fQURET05fRk9MREVSX18sJ2ljb24ucG5nJykpCgkJCgkJbWVuc2FnZW1wcm9ncmVzc28uY2xvc2UoKQoJCXBsYXllcl9tci5wbGF5KHBsYXlsaXN0KQoJCXBsYXllcl9tci5zZXRTdWJ0aXRsZXMobGVnZW5kYSkKCgkJd2hpbGUgcGxheWVyX21yLnBsYXlpbmc6CgkJCXhibWMuc2xlZXAoNTAwMCkKCQkJI3BsYXllcl9tci50cmFja2VyVGVtcG8oKQoKZGVmIG1hcmNhclZpc3RvKHVybCk6CglyZXN1bHRhZG8gPSBhYnJpcl91cmwodXJsLCBoZWFkZXI9aGVhZGVycywgY29va2llPWdldENvb2tpZSgpKQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pWzBdCglsaW5rcyA9IHVybC5zcGxpdCgnLycpCglvcGNhbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCdtYXJjYXJWaXN0bycpCglpZiAnZmlsbWUnIGluIHVybDoKCQlpZF92aWRlbyA9IHJlc3VsdGFkb1snaWRfdmlkZW8nXQoJCWltZGIgPSByZXN1bHRhZG9bJ0lNQkQnXQoJCXBvc3QgPSB7J2lkX2ZpbG1lJzogaWRfdmlkZW99CgkJdGlwbyA9IDAKCWVsaWYgJ3NlcmllJyBpbiB1cmw6CgkJaW1kYiAgPSByZXN1bHRhZG9bJ2ZvdG9TZXJpZSddLnNwbGl0KCcvJylbLTFdLnNwbGl0KCcuJylbMF0KCQlpZF92aWRlbyA9IHJlc3VsdGFkb1snaWRfc2VyaWUnXQoJCXRlbXBvcmFkYSA9IHJlc3VsdGFkb1sndGVtcG9yYWRhJ10KCQllcGlzb2RpbyA9IHJlc3VsdGFkb1snZXBpc29kaW8nXQoJCXBvc3QgPSB7J2lkX3NlcmllJzogaWRfdmlkZW8sICd0ZW1wb3JhZGEnOiB0ZW1wb3JhZGEsICdlcGlzb2Rpbyc6ZXBpc29kaW99CgkJdGlwbyA9IDEKCWVsaWYgJ2FuaW1lJyBpbiB1cmw6CgkJaW1kYiAgPSByZXN1bHRhZG9bJ2ZvdG9TZXJpZSddLnNwbGl0KCcvJylbLTFdLnNwbGl0KCcuJylbMF0KCQlpZF92aWRlbyA9IHJlc3VsdGFkb1snaWRfc2VyaWUnXQoJCXRlbXBvcmFkYSA9IHJlc3VsdGFkb1sndGVtcG9yYWRhJ10KCQllcGlzb2RpbyA9IHJlc3VsdGFkb1snZXBpc29kaW8nXQoJCXBvc3QgPSB7J2lkX2FuaW1lJzogaWRfdmlkZW8sICd0ZW1wb3JhZGEnOiB0ZW1wb3JhZGEsICdlcGlzb2Rpbyc6ZXBpc29kaW99CgkJdGlwbyA9IDIKCXBhc3RhVmlzdG89b3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywndmlzdG9zJykKCXRyeToKCQlvcy5tYWtlZGlycyhwYXN0YVZpc3RvKQoJZXhjZXB0OgoJCXBhc3MKCWlmIHRpcG8gPT0gMSBvciB0aXBvID09IDI6CgkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4ocGFzdGFWaXN0bywgc3RyKGlkX3ZpZGVvKSsnX1MnK3N0cih0ZW1wb3JhZGEpKyd4JytzdHIoZXBpc29kaW8pKycubGl2ZWl0JykKCWVsaWYgdGlwbyA9PSAwOgoJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKHBhc3RhVmlzdG8sIHN0cihpZF92aWRlbykrJy5saXZlaXQnKQoJaWYgbm90IG9zLnBhdGguZXhpc3RzKGZpY2hlaXJvKToKCQlmID0gb3BlbihmaWNoZWlybywgJ3cnKQoJCWYud3JpdGUoJycpCgkJZi5jbG9zZSgpCgllc2NyZXZlcl9maWNoZWlybyhvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCd2aXN0b3NfZmlsbWVzLmxpdmVpdCcpLCB2aXN0b3NfZmlsbWVzKQoJeGJtYy5leGVjdXRlYnVpbHRpbigiWEJNQy5Ob3RpZmljYXRpb24oIitBZGRvblRpdGxlKyIsIisiTWFyY2FkbyBjb21vIHZpc3RvIisiLCIrIjYwMDEiKyIsIisgb3MucGF0aC5qb2luKGNvbnRyb2xvLmFkZG9uRm9sZGVyLCdpY29uLnBuZycpKyIpIikKCXhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5SZWZyZXNoIikKCmRlZiBtYXJjYXJOYW9WaXN0byh1cmwpOgoJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCwgaGVhZGVyPWhlYWRlcnMsIGNvb2tpZT1nZXRDb29raWUoKSkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKVswXQoJbGlua3MgPSB1cmwuc3BsaXQoJy8nKQoJb3BjYW8gPSBfX0FERE9OX18uZ2V0U2V0dGluZygnbWFyY2FyVmlzdG8nKQoJaWYgJ2ZpbG1lJyBpbiB1cmw6CgkJaWRfdmlkZW8gPSByZXN1bHRhZG9bJ2lkX3ZpZGVvJ10KCQlpbWRiID0gcmVzdWx0YWRvWydJTUJEJ10KCQlwb3N0ID0geydpZF9maWxtZSc6IGlkX3ZpZGVvfQoJCXRpcG8gPSAwCgllbGlmICdzZXJpZScgaW4gdXJsOgoJCWltZGIgID0gcmVzdWx0YWRvWydmb3RvU2VyaWUnXS5zcGxpdCgnLycpWy0xXS5zcGxpdCgnLicpWzBdCgkJaWRfdmlkZW8gPSByZXN1bHRhZG9bJ2lkX3NlcmllJ10KCQl0ZW1wb3JhZGEgPSByZXN1bHRhZG9bJ3RlbXBvcmFkYSddCgkJZXBpc29kaW8gPSByZXN1bHRhZG9bJ2VwaXNvZGlvJ10KCQlwb3N0ID0geydpZF9zZXJpZSc6IGlkX3ZpZGVvLCAndGVtcG9yYWRhJzogdGVtcG9yYWRhLCAnZXBpc29kaW8nOmVwaXNvZGlvfQoJCXRpcG8gPSAxCgllbGlmICdhbmltZScgaW4gdXJsOgoJCWltZGIgID0gcmVzdWx0YWRvWydmb3RvU2VyaWUnXS5zcGxpdCgnLycpWy0xXS5zcGxpdCgnLicpWzBdCgkJaWRfdmlkZW8gPSByZXN1bHRhZG9bJ2lkX3NlcmllJ10KCQl0ZW1wb3JhZGEgPSByZXN1bHRhZG9bJ3RlbXBvcmFkYSddCgkJZXBpc29kaW8gPSByZXN1bHRhZG9bJ2VwaXNvZGlvJ10KCQlwb3N0ID0geydpZF9hbmltZSc6IGlkX3ZpZGVvLCAndGVtcG9yYWRhJzogdGVtcG9yYWRhLCAnZXBpc29kaW8nOmVwaXNvZGlvfQoJCXRpcG8gPSAyCgkKCXBhc3RhVmlzdG89b3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywndmlzdG9zJykKCXRyeToKCQlvcy5tYWtlZGlycyhwYXN0YVZpc3RvKQoJZXhjZXB0OgoJCXBhc3MKCglpZiB0aXBvID09IDEgb3IgdGlwbyA9PSAyOgoJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKHBhc3RhVmlzdG8sIHN0cihpZF92aWRlbykrJ19TJytzdHIodGVtcG9yYWRhKSsneCcrc3RyKGVwaXNvZGlvKSsnLm1ycGlyYWN5JykKCWVsaWYgdGlwbyA9PSAwOgoJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKHBhc3RhVmlzdG8sIHN0cihpZF92aWRlbykrJy5tcnBpcmFjeScpCgoJaWYgb3MucGF0aC5leGlzdHMoZmljaGVpcm8pOgoJCW9zLnJlbW92ZShmaWNoZWlybykKCWVzY3JldmVyX2ZpY2hlaXJvKG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ3Zpc3Rvc19maWxtZXMubGl2ZWl0JyksIHZpc3RvcykKCXhibWMuZXhlY3V0ZWJ1aWx0aW4oIlhCTUMuTm90aWZpY2F0aW9uKCIrQWRkb25UaXRsZSsiLCIrIk1hcmNhZG8gY29tbyB2aXN0byIrIiwiKyI2MDAxIisiLCIrIG9zLnBhdGguam9pbihjb250cm9sby5hZGRvbkZvbGRlciwnaWNvbi5wbmcnKSsiKSIpCgl4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuUmVmcmVzaCIpCgpkZWYgZ2V0U3RyZWFtTGVnZW5kYShpZCwgdGlwbywgY29pc289Tm9uZSk6CglpZiB0aXBvID09ICdmaWxtZSc6CgkJdXJsID0gX19BUElfU0lURV9fK3RpcG8rJ3MucGhwP2FjdGlvbj1saW5rcyZpZEZpbG1lPScraWQKCWlmIHRpcG8gPT0gJ3NlcmllJzoKCQl1cmwgPSBfX0FQSV9TSVRFX18rdGlwbysncy5waHA/YWN0aW9uPWxpbmtzJmlkRXBpc29kaW89JytpZAoJaWYgdGlwbyA9PSAnYW5pbWUnOgoJCXVybCA9IF9fQVBJX1NJVEVfXyt0aXBvKydzLnBocD9hY3Rpb249bGlua3MmaWRFcGlzb2Rpbz0nK2lkCgoJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCwgaGVhZGVyPWhlYWRlcnMsIGNvb2tpZT1nZXRDb29raWUoKSkKCXJlc3VsdGFkbyA9IGpzb24ubG9hZHMocmVzdWx0YWRvKQoJdHJ5OgoJCWlmIHJlc3VsdGFkb1snY29kaWdvJ10gPT0gMjA0OgoJCQlyZXR1cm4gRmFsc2UsIDIwNCwgMjA0CglleGNlcHQ6IAoJCXJlc3VsdGFkbyA9IHJlc3VsdGFkb1swXQoJCglpID0gMAoJc2Vydmlkb3JlcyA9IFtdCgl0aXR1bG9zID0gW10KCW5vbWUgPSAnJwoJCglpZiByZXN1bHRhZG9bJ1VSTCddICE9ICcnOgoJCWkrPTEKCQlpZiAnb3BlbmxvYWQnIGluIHJlc3VsdGFkb1snVVJMJ106CgkJCW5vbWUgPSAiT3BlbkxvYWQiCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMJ10pCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICd2aWR6aScgaW4gcmVzdWx0YWRvWydVUkwnXToKCQkJbm9tZSA9ICdWaWR6aScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwnXSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ2dvb2dsZScgaW4gcmVzdWx0YWRvWydVUkwnXSBvciAnY2xvdWQubWFpbC5ydScgaW4gcmVzdWx0YWRvWydVUkwnXToKCQkJbm9tZSA9IEFkZG9uVGl0bGUKCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwnXSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3VwdG9zdHJlYW0uY29tJyBpbiByZXN1bHRhZG9bJ1VSTCddOgoJCQlub21lID0gJ1VwVG9TdHJlYW0nCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMJ10pCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICdyYXBpZHZpZGVvLmNvbScgaW4gcmVzdWx0YWRvWydVUkwnXSBvciAncmFwdHUnIGluIHJlc3VsdGFkb1snVVJMJ106CgkJCW5vbWUgPSAnUmFwdHUnCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMJ10pCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICd2aWRvemEubmV0JyBpbiByZXN1bHRhZG9bJ1VSTCddOgoJCQlub21lID0gJ1ZpZG96YScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwnXSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3N0cmVhbWFuZ28uJyBpbiByZXN1bHRhZG9bJ1VSTCddOgoJCQlub21lID0gJ1N0cmVhbWFuZ28nCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMJ10pCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCWlmIHJlc3VsdGFkb1snVVJMMiddICE9ICcnOgoJCWkrPTEKCQlpZiAnb3BlbmxvYWQnIGluIHJlc3VsdGFkb1snVVJMMiddOgoJCQlub21lID0gIk9wZW5Mb2FkIgoJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDInXSkKCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCWVsaWYgJ3ZpZHppJyBpbiByZXN1bHRhZG9bJ1VSTDInXToKCQkJbm9tZSA9ICdWaWR6aScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwyJ10pCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICdnb29nbGUnIGluIHJlc3VsdGFkb1snVVJMMiddIG9yICdjbG91ZC5tYWlsLnJ1JyBpbiByZXN1bHRhZG9bJ1VSTDInXToKCQkJbm9tZSA9IEFkZG9uVGl0bGUKCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwyJ10pCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICd1cHRvc3RyZWFtLmNvbScgaW4gcmVzdWx0YWRvWydVUkwyJ106CgkJCW5vbWUgPSAnVXBUb1N0cmVhbScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwyJ10pCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICdyYXBpZHZpZGVvLmNvbScgaW4gcmVzdWx0YWRvWydVUkwyJ10gb3IgJ3JhcHR1JyBpbiByZXN1bHRhZG9bJ1VSTDInXToKCQkJbm9tZSA9ICdSYXB0dScKCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwyJ10pCgkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQllbGlmICd2aWRvemEubmV0JyBpbiByZXN1bHRhZG9bJ1VSTDInXToKCQkJbm9tZSA9ICdWaWRvemEnCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMMiddKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJZWxpZiAnc3RyZWFtYW5nby4nIGluIHJlc3VsdGFkb1snVVJMMiddOgoJCQlub21lID0gJ1N0cmVhbWFuZ28nCgkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMMiddKQoJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgl0cnk6CgkJaWYgcmVzdWx0YWRvWydVUkwzJ10gIT0gJyc6CgkJCWkrPTEKCQkJaWYgJ29wZW5sb2FkJyBpbiByZXN1bHRhZG9bJ1VSTDMnXToKCQkJCW5vbWUgPSAiT3BlbkxvYWQiCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDMnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndmlkemknIGluIHJlc3VsdGFkb1snVVJMMyddOgoJCQkJbm9tZSA9ICdWaWR6aScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMMyddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICdnb29nbGUnIGluIHJlc3VsdGFkb1snVVJMMyddIG9yICdjbG91ZC5tYWlsLnJ1JyBpbiByZXN1bHRhZG9bJ1VSTDMnXToKCQkJCW5vbWUgPSBBZGRvblRpdGxlCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDMnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAndXB0b3N0cmVhbS5jb20nIGluIHJlc3VsdGFkb1snVVJMMyddOgoJCQkJbm9tZSA9ICdVcFRvU3RyZWFtJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwzJ10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3JhcGlkdmlkZW8uY29tJyBpbiByZXN1bHRhZG9bJ1VSTDMnXSBvciAncmFwdHUnIGluIHJlc3VsdGFkb1snVVJMMyddOgoJCQkJbm9tZSA9ICdSYXB0dScKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMMyddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd2aWRvemEubmV0JyBpbiByZXN1bHRhZG9bJ1VSTDMnXToKCQkJCW5vbWUgPSAnVmlkb3phJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkwzJ10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3N0cmVhbWFuZ28uJyBpbiByZXN1bHRhZG9bJ1VSTDMnXToKCQkJCW5vbWUgPSAnU3RyZWFtYW5nbycKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMMyddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJZXhjZXB0OgoJCXBhc3MKCXRyeToKCQlpZiByZXN1bHRhZG9bJ1VSTDQnXSAhPSAnJzoKCQkJaSs9MQoJCQlpZiAnb3BlbmxvYWQnIGluIHJlc3VsdGFkb1snVVJMNCddOgoJCQkJbm9tZSA9ICJPcGVuTG9hZCIKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMNCddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd2aWR6aScgaW4gcmVzdWx0YWRvWydVUkw0J106CgkJCQlub21lID0gJ1ZpZHppJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkw0J10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ2dvb2dsZScgaW4gcmVzdWx0YWRvWydVUkw0J10gb3IgJ2Nsb3VkLm1haWwucnUnIGluIHJlc3VsdGFkb1snVVJMNCddOgoJCQkJbm9tZSA9IEFkZG9uVGl0bGUKCQkJCXNlcnZpZG9yZXMuYXBwZW5kKHJlc3VsdGFkb1snVVJMNCddKQoJCQkJdGl0dWxvcy5hcHBlbmQoJ1NlcnZpZG9yICMlczogJXMnICUgKGksIG5vbWUpKQoJCQllbGlmICd1cHRvc3RyZWFtLmNvbScgaW4gcmVzdWx0YWRvWydVUkw0J106CgkJCQlub21lID0gJ1VwVG9TdHJlYW0nCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDQnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAncmFwaWR2aWRlby5jb20nIGluIHJlc3VsdGFkb1snVVJMNCddIG9yICdyYXB0dScgaW4gcmVzdWx0YWRvWydVUkw0J106CgkJCQlub21lID0gJ1JhcHR1JwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkw0J10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCgkJCWVsaWYgJ3ZpZG96YS5uZXQnIGluIHJlc3VsdGFkb1snVVJMNCddOgoJCQkJbm9tZSA9ICdWaWRvemEnCgkJCQlzZXJ2aWRvcmVzLmFwcGVuZChyZXN1bHRhZG9bJ1VSTDQnXSkKCQkJCXRpdHVsb3MuYXBwZW5kKCdTZXJ2aWRvciAjJXM6ICVzJyAlIChpLCBub21lKSkKCQkJZWxpZiAnc3RyZWFtYW5nby4nIGluIHJlc3VsdGFkb1snVVJMNCddOgoJCQkJbm9tZSA9ICdTdHJlYW1hbmdvJwoJCQkJc2Vydmlkb3Jlcy5hcHBlbmQocmVzdWx0YWRvWydVUkw0J10pCgkJCQl0aXR1bG9zLmFwcGVuZCgnU2Vydmlkb3IgIyVzOiAlcycgJSAoaSwgbm9tZSkpCglleGNlcHQ6CgkJcGFzcwoJbGVnZW5kYSA9ICcnCglzdHJlYW0gPSAnJwoJaWYgJzovLycgaW4gcmVzdWx0YWRvWydsZWdlbmRhJ10gb3IgcmVzdWx0YWRvWydsZWdlbmRhJ10gPT0gJyc6CgkJbGVnZW5kYSA9IF9fQVBJX18rJ3N1YnMvJXMuc3J0JyAlIHJlc3VsdGFkb1snSU1CRCddCgllbGlmIHJlc3VsdGFkb1snbGVnZW5kYSddICE9ICcnOgoJCWlmIG5vdCAnLnNydCcgaW4gcmVzdWx0YWRvWydsZWdlbmRhJ106CgkJCXJlc3VsdGFkb1snbGVnZW5kYSddID0gcmVzdWx0YWRvWydsZWdlbmRhJ10rJy5zcnQnCgkJbGVnZW5kYSA9IF9fQVBJX18rJ3N1YnMvJXMnICUgcmVzdWx0YWRvWydsZWdlbmRhJ10KCXRyeToKCQlpZiByZXN1bHRhZG9bJ3NlbWxlZ2VuZGEnXSA9PSAxOgoJCQlsZWdlbmRhID0gJycKCWV4Y2VwdDoKCQlwYXNzCglleHRfZyA9ICdjb2lzbycKCWxlZ2VuZGFBdXggPSBsZWdlbmRhCglzZXJ2aWRvciA9IDAKCWlmIGxlbih0aXR1bG9zKSA+IDE6CgkJc2Vydmlkb3IgPSB4Ym1jZ3VpLkRpYWxvZygpLnNlbGVjdCgnRXNjb2xoYSBvIHNlcnZpZG9yJywgdGl0dWxvcykKCWVsc2U6CgkJc2Vydmlkb3IgPSAwCgkKCWlmICd2aWR6aScgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJCXZpZHppID0gVVJMUmVzb2x2ZXJNZWRpYS5WaWR6aShzZXJ2aWRvcmVzW3NlcnZpZG9yXSkKCQkJc3RyZWFtID0gdmlkemkuZ2V0TWVkaWFVcmwoKQoJCQlsZWdlbmRhID0gdmlkemkuZ2V0U3VidGl0bGUoKQoJZWxpZiAndXB0b3N0cmVhbS5jb20nIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXN0cmVhbSA9IFVSTFJlc29sdmVyTWVkaWEuVXBUb1N0cmVhbShzZXJ2aWRvcmVzW3NlcnZpZG9yXSkuZ2V0TWVkaWFVcmwoKQoJZWxpZiAnc2VydmVyLm1ycGlyYWN5LndpbicgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJc3RyZWFtID0gc2Vydmlkb3Jlc1tzZXJ2aWRvcl0KCWVsaWYgJ29wZW5sb2FkJyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQlzdHJlYW0gPSBVUkxSZXNvbHZlck1lZGlhLk9wZW5Mb2FkKHNlcnZpZG9yZXNbc2Vydmlkb3JdKS5nZXRNZWRpYVVybCgpCgkJbGVnZW5kYSA9IFVSTFJlc29sdmVyTWVkaWEuT3BlbkxvYWQoc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pLmdldFN1YnRpdGxlKCkKCQlpZiBub3QgJy52dHQnIGluIGxlZ2VuZGEgb3IgbGVnZW5kYSA9PSAnJzoKCQkJbGVnZW5kYSA9IGxlZ2VuZGFBdXgKCWVsaWYgJ2RyaXZlLmdvb2dsZS5jb20vJyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQlzdHJlYW0sIGV4dF9nID0gVVJMUmVzb2x2ZXJNZWRpYS5Hb29nbGVWaWRlbyhzZXJ2aWRvcmVzW3NlcnZpZG9yXSkuZ2V0TWVkaWFVcmwoKQoJZWxpZiAnY2xvdWQubWFpbC5ydScgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJc3RyZWFtLCBleHRfZyA9IFVSTFJlc29sdmVyTWVkaWEuQ2xvdWRNYWlsUnUoc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pLmdldE1lZGlhVXJsKCkKCWVsaWYgJ3JhcGlkdmlkZW8uY29tJyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXSBvciAncmFwdHUnIGluIHNlcnZpZG9yZXNbc2Vydmlkb3JdOgoJCXJhcGlkID0gVVJMUmVzb2x2ZXJNZWRpYS5SYXBpZFZpZGVvKHNlcnZpZG9yZXNbc2Vydmlkb3JdKQoJCXN0cmVhbSA9IHJhcGlkLmdldE1lZGlhVXJsKCkKCQlsZWdlbmRhID0gcmFwaWQuZ2V0TGVnZW5kYSgpCgllbGlmICd2aWRvemEubmV0JyBpbiBzZXJ2aWRvcmVzW3NlcnZpZG9yXToKCQl2aWRveiA9IFVSTFJlc29sdmVyTWVkaWEuVmlkb3phKHNlcnZpZG9yZXNbc2Vydmlkb3JdKQoJCXN0cmVhbSA9IHZpZG96LmdldE1lZGlhVXJsKCkKCQlsZWdlbmRhID0gdmlkb3ouZ2V0TGVnZW5kYSgpCgllbGlmICdzdHJlYW1hbmdvLicgaW4gc2Vydmlkb3Jlc1tzZXJ2aWRvcl06CgkJc3RyZWFtYW4gPSBVUkxSZXNvbHZlck1lZGlhLlN0cmVhbWFuZ28oc2Vydmlkb3Jlc1tzZXJ2aWRvcl0pCgkJc3RyZWFtID0gc3RyZWFtYW4uZ2V0TWVkaWFVcmwoKQoJCWxlZ2VuZGEgPSBzdHJlYW1hbi5nZXRMZWdlbmRhKCkKCQoJaWYgY29pc28gPT0gJ2ZpbG1lJzoKCQlsZWdlbmRhID0gbGVnZW5kYUF1eAoJCWlmIHJlc3VsdGFkb1snSU1CRCddIG5vdCBpbiBsZWdlbmRhOgoJCQlsZWdlbmRhID0gX19BUElfXysnc3Vicy8lcy5zcnQnICUgcmVzdWx0YWRvWydJTUJEJ10KCQoJaWYgbGVnZW5kYSA9PSAnJzoKCQlsZWdlbmRhID0gbGVnZW5kYUF1eAoJcmV0dXJuIHN0cmVhbSwgbGVnZW5kYSwgZXh0X2cKCgpkZWYgcGVzcXVpc2FNb3YodXJsKToKCWNvZGlnb19mb250ZSA9ICcnCglkYWRvcyA9ICcnCgl0YWJlbGEgPSAnJwoJc3RyUGVzcXVpc2EgPSAnJwoJZmljaGVpcm8gPSAnJwoJc2l0ZSA9ICcnCglxdWFsaWRhZGUgPSAnJwoJaWYgJ2ZpbG1lcycgaW4gdXJsOgoJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnZmlsbWVzX3Blc3F1aXNhLmxpdmVpdCcpCgkJdGlwbyA9IDAKCQlxdWFsaWRhZGUgPSBfX1F1YWxpZGFkZV9fCgllbGlmICdzZXJpZXMnIGluIHVybDoKCQlmaWNoZWlybyA9IG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ3Nlcmllc19wZXNxdWlzYS5saXZlaXQnKQoJCXRpcG8gPSAxCgkJc2l0ZSA9ICdzZXJpZXMnCgkJcXVhbGlkYWRlID0gJzInCgllbGlmICdhbmltZXMnIGluIHVybDoKCQlmaWNoZWlybyA9IG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ2FuaW1lc19wZXNxdWlzYS5saXZlaXQnKQoJCXRpcG8gPSAyCgkJc2l0ZSA9ICdhbmltZXMnCgkJcXVhbGlkYWRlID0gJzInCglpZiAncGFnZScgbm90IGluIHVybDoKCQl0cnk6CgkJCXRpcG8gPSB4Ym1jZ3VpLkRpYWxvZygpLnNlbGVjdCh1J09uZGUgcXVlciBwZXNxdWlzYXI/JywgWydGaWxtZXMnLCAnU2VyaWVzJywgJ0FuaW1lcyddKQoJCWV4Y2VwdDoKCQkJcmV0dXJuIEZhbHNlCgkJdGVjbGFkbyA9IHhibWMuS2V5Ym9hcmQoJycsICdPIHF1ZSBxdWVyIHBlc3F1aXNhcj8nKQoJCWlmIHRpcG8gPT0gMDoKCQkJdXJsID0gX19BUElfU0lURV9fKydmaWxtZXMucGhwP2FjdGlvbj1wZXNxdWlzYScKCQkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdmaWxtZXNfcGVzcXVpc2EubGl2ZWl0JykKCQkJcXVhbGlkYWRlID0gX19RdWFsaWRhZGVfXwoJCWVsaWYgdGlwbyA9PSAxOgoJCQl1cmwgPSBfX0FQSV9TSVRFX18rJ3Nlcmllcy5waHA/YWN0aW9uPXBlc3F1aXNhJwoJCQlmaWNoZWlybyA9IG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ3Nlcmllc19wZXNxdWlzYS5saXZlaXQnKQoJCQlxdWFsaWRhZGUgPSAnMicKCQkJc2l0ZSA9ICdzZXJpZXMnCgkJZWxpZiB0aXBvID09IDI6CgkJCXVybCA9IF9fQVBJX1NJVEVfXysnYW5pbWVzLnBocD9hY3Rpb249cGVzcXVpc2EnCgkJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywnYW5pbWVzX3Blc3F1aXNhLmxpdmVpdCcpCgkJCXF1YWxpZGFkZSA9ICcyJwoJCQlzaXRlID0gJ2FuaW1lcycKCQlpZiB4Ym1jdmZzLmV4aXN0cyhmaWNoZWlybyk6CgkJCWYgPSBvcGVuKGZpY2hlaXJvLCAiciIpCgkJCXRleHRvID0gZi5yZWFkKCkKCQkJZi5jbG9zZSgpCgkJCXRlY2xhZG8uc2V0RGVmYXVsdCh0ZXh0bykKCQl0ZWNsYWRvLmRvTW9kYWwoKQkKCgkJaWYgdGVjbGFkby5pc0NvbmZpcm1lZCgpOgoJCQlzdHJQZXNxdWlzYSA9IHRlY2xhZG8uZ2V0VGV4dCgpCgkJCWlmIHN0clBlc3F1aXNhID09ICcnOgoJCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnSW5zaXJhIGFsZ28gbmEgcGVzcXVpc2EuJykKCQkJCWFkZERpcjIoJ0FsdGVyYXIgUGVzcXVpc2EnLCB1cmwsIDEyNCwgJycsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdwZXNxdWlzYS5wbmcnKSwgMCkKCQkJCXJldHVybiBGYWxzZQoJCQlkYWRvcyA9IHVybGxpYi51cmxlbmNvZGUoeyd0ZXh0byc6IHN0clBlc3F1aXNhLCAncXVhbGlkYWRlJzogcXVhbGlkYWRlfSkKCQkJdHJ5OgoJCQkJZiA9IG9wZW4oZmljaGVpcm8sIG1vZGU9InciKQoJCQkJZi53cml0ZShzdHJQZXNxdWlzYSkKCQkJCWYuY2xvc2UoKQoJCQlleGNlcHQ6CgkJCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdOw6NvIGdyYXZvdSBvIGNvbnRldWRvIGVtICcrZmljaGVpcm8pCgkJCXJlc3VsdGFkbyA9IGFicmlyX3VybCh1cmwscG9zdD1kYWRvcywgaGVhZGVyPWhlYWRlcnMsIGNvb2tpZT1nZXRDb29raWUoKSkKCWVsc2U6CgkJaWYgeGJtY3Zmcy5leGlzdHMoZmljaGVpcm8pOgoJCQlmID0gb3BlbihmaWNoZWlybywgInIiKQoJCQl0ZXh0byA9IGYucmVhZCgpCgkJCWYuY2xvc2UoKQoJCWRhZG9zID0gdXJsbGliLnVybGVuY29kZSh7J3RleHRvJzogdGV4dG8sICdxdWFsaWRhZGUnOnF1YWxpZGFkZX0pCgkJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCxwb3N0PWRhZG9zLCBoZWFkZXI9aGVhZGVycywgY29va2llPWdldENvb2tpZSgpKQoJCglyZXN1bHRhZG8gPSBqc29uLmxvYWRzKHJlc3VsdGFkbykKCXRyeToKCQlpZiByZXN1bHRhZG9bJ2NvZGlnbyddID09IDIwNDoKCQkJX19BTEVSVEFfXyhBZGRvblRpdGxlLCAnRGV2ZSBJbmRpY2FyIHVtIHZhbG9yIHBhcmEgcGVzcXVpc2EuJykKCQkJcmV0dXJuIEZhbHNlCglleGNlcHQ6CgkJcmVzdWx0YWRvID0gcmVzdWx0YWRvCgl2aXN0b3MgPSBEYXRhYmFzZS5zZWxlY3RGaWxtZXMoKQoJb3BjYW8gPSBfX0FERE9OX18uZ2V0U2V0dGluZygnbWFyY2FyVmlzdG8nKQoKCWlmIHJlc3VsdGFkb1snZGF0YSddICE9ICcnOgoJCWlmIHRpcG8gPT0gMDoKCQkJZm9yIGkgaW4gcmVzdWx0YWRvWydkYXRhJ106CgkJCQlzZXRGaWxtZShpLCB2aXN0b3MsIG9wY2FvKQoJCWVsaWYgdGlwbyA9PSAxIG9yIHRpcG8gPT0gMjoKCQkJZm9yIGkgaW4gcmVzdWx0YWRvWydkYXRhJ106CgkJCQlzZXRTZXJpZXMoaSwgdmlzdG9zLCBvcGNhbywgc2l0ZSkKCQkKCQljdXJyZW50ID0gcmVzdWx0YWRvWydtZXRhJ11bJ2N1cnJlbnQnXQoJCXRvdGFsID0gcmVzdWx0YWRvWydtZXRhJ11bJ3RvdGFsJ10KCQl0cnk6IHByb3hpbW8gPSByZXN1bHRhZG9bJ21ldGEnXVsncGFnaW5hY2FvJ11bJ25leHQnXQoJCWV4Y2VwdDogcGFzcyAKCQlpZiBpbnQoY3VycmVudCkgPCBpbnQodG90YWwpOgoJCQlhZGREaXIyKCdQcm94aW1hIHBhZ2luYSAoJytzdHIoY3VycmVudCkrJy8nK3N0cih0b3RhbCkrJyknLCBwcm94aW1vLCAxMjQsICdwZXNxdWlzYScsIG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdwcm94aW1vLnBuZycpKQoJCWVsc2U6CgkJCXhibWNwbHVnaW4uZW5kT2ZEaXJlY3RvcnkoaW50KHN5cy5hcmd2WzFdKSxjYWNoZVRvRGlzYz1GYWxzZSkKCXZpc3RhX2ZpbG1lc1NlcmllcygpCgpkZWYgcGVzcXVpc2Eoc2VydnVzcyk6Cgljb2RpZ29fZm9udGUgPSAnJwoJZGFkb3MgPSAnJwoJbmV0ID0gTmV0KCkKCSNuZXQuc2V0X2Nvb2tpZXMoX19DT09LSUVfRklMRV9fKQoJdGFiZWxhID0gJycKCXN0clBlc3F1aXNhID0gJycKCWZpY2hlaXJvID0gJycKCXVybCA9ICcnCglpZiAncGFnZScgbm90IGluIHVybDoKCQl1cmwgPSBfX1NJVEVCRF9fKydzZWFyY2gucGhwJwoJCWlmIHRpcG8gPT0gMzoKCQkJdGFiZWxhID0gJ2NhbmFpc19rb2RpJwoJCQlmaWNoZWlybyA9IG9zLnBhdGguam9pbihfX1BBU1RBX0RBRE9TX18sJ2NhbmFpcy5saXZlaXQnKQoJCWVsaWYgdGlwbyA9PSA0OgoJCQl0YWJlbGEgPSAncHJhaWFzX2tvZGknCgkJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywncHJhaWFzLmxpdmVpdCcpCgkJZWxpZiB0aXBvID09IDU6CgkJCXRhYmVsYSA9ICdyYWRpb3Nfa29kaScKCQkJZmljaGVpcm8gPSBvcy5wYXRoLmpvaW4oX19QQVNUQV9EQURPU19fLCdyYWRpb3MubGl2ZWl0JykKCQllbHNlOgoJCQl0YWJlbGEgPSAncHJvZ3JhbWFzX2tvZGknCgkJCWZpY2hlaXJvID0gb3MucGF0aC5qb2luKF9fUEFTVEFfREFET1NfXywncHJvZ3JhbWFzLmxpdmVpdCcpCgkJCgkJaWYgeGJtY3Zmcy5leGlzdHMoZmljaGVpcm8pOgoJCQlmID0gb3BlbihmaWNoZWlybywgInIiKQoJCQl0ZXh0byA9IGYucmVhZCgpCgkJCWYuY2xvc2UoKQoJCQl0ZWNsYWRvLnNldERlZmF1bHQodGV4dG8pCgkJdGVjbGFkby5kb01vZGFsKCkJCgoJCWlmIHRlY2xhZG8uaXNDb25maXJtZWQoKToKCQkJc3RyUGVzcXVpc2EgPSB0ZWNsYWRvLmdldFRleHQoKQoJCQlkYWRvcyA9IHVybGxpYi51cmxlbmNvZGUoeyd0ZXh0byc6IHN0clBlc3F1aXNhLCAncXVhbGlkYWRlJzogcXVhbGlkYWRlfSkKCQkJdHJ5OgoJCQkJZiA9IG9wZW4oZmljaGVpcm8sIG1vZGU9InciKQoJCQkJZi53cml0ZShzdHJQZXNxdWlzYSkKCQkJCWYuY2xvc2UoKQoJCQlleGNlcHQ6CgkJCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdOw6NvIGdyYXZvdSBvIGNvbnRldWRvIGVtICcrZmljaGVpcm8pCgkJCXJlc3VsdGFkbyA9IGFicmlyX3VybCh1cmwscG9zdD1kYWRvcywgaGVhZGVyPWhlYWRlcnMsIGNvb2tpZT1nZXRDb29raWUoKSkKCWVsc2U6CgkJaWYgeGJtY3Zmcy5leGlzdHMoZmljaGVpcm8pOgoJCQlmID0gb3BlbihmaWNoZWlybywgInIiKQoJCQl0ZXh0byA9IGYucmVhZCgpCgkJCWYuY2xvc2UoKQoJCWRhZG9zID0gdXJsbGliLnVybGVuY29kZSh7J3RleHRvJzogdGV4dG8sICdxdWFsaWRhZGUnOnF1YWxpZGFkZX0pCgkJcmVzdWx0YWRvID0gYWJyaXJfdXJsKHVybCxwb3N0PWRhZG9zLCBoZWFkZXI9aGVhZGVycywgY29va2llPWdldENvb2tpZSgpKQoJCglpZiBzdHJQZXNxdWlzYSAhPSAnJzoKCQlpZiByZXN1bHRhZG8gPT0gJ0ROUyc6CgkJCV9fQUxFUlRBX18oQWRkb25UaXRsZSwgJ1RlbSBkZSBhbHRlcmFyIG9zIEROUyBwYXJhIHBvZGVyIHVzdWZydWlyIGRvIF9fQURET05fXy4nKQoJCQlyZXR1cm4gRmFsc2UKCQkKCQl4Ym1jcGx1Z2luLmVuZE9mRGlyZWN0b3J5KGludChzeXMuYXJndlsxXSksY2FjaGVUb0Rpc2M9RmFsc2UpCgkJZGFkb3MgPSB7J3NlYXJjaEJveCc6IHN0clBlc3F1aXNhLCAndGFiZWxhJzogdGFiZWxhfQoJCWNvZGlnb19mb250ZSA9IG5ldC5odHRwX1BPU1QodXJsLCBmb3JtX2RhdGE9ZGFkb3MsIGhlYWRlcnM9X19IRUFERVJTX18pLmNvbnRlbnQuZGVjb2RlKCdsYXRpbi0xJykuZW5jb2RlKCJ1dGYtOCIpCgkJaW5mb3JtYSA9IHsKCQkJCSdzZXJ2aWRvcicgOiB7CgkJCQkJJ25vbWUnOiAnJywKCQkJCQknc2Vydic6ICcnCgkJCQl9LAoJCQkJJ3NlcnZpZG9yZXMnOiBbXSwKCQkJCSdjYW5haXMnOiBbXQoJCQl9CgkJc3VjZXNzbyA9ICdubycKCQllbGVtcyA9IEVULmZyb21zdHJpbmcoY29kaWdvX2ZvbnRlKQoJCQoJCWZvciBjaGlsZGVlIGluIGVsZW1zOgoJCQlpZihjaGlsZGVlLnRhZyA9PSAnc2Vydmlkb3JlcycpOgoJCQkJc2Vydmlkb3IgPSB7CgkJCQkJJ25vbWUnOiAnJywKCQkJCQknbGluayc6ICcnCgkJCQl9CgkJCQlmb3IgZ2cgaW4gY2hpbGRlZToJCgkJCQkJaWYoZ2cudGFnID09ICdOb21lJyk6CgkJCQkJCXNlcnZpZG9yWydub21lJ10gPSBnZy50ZXh0CQoJCQkJCWVsaWYoZ2cudGFnID09ICdTZXJ2aWRvcicpOgoJCQkJCQlzZXJ2aWRvclsnbGluayddID0gZ2cudGV4dAkJCgkJCQkJaW5mb3JtYVsnc2Vydmlkb3JlcyddLmFwcGVuZChzZXJ2aWRvcikKCQkJCgkJZm9yIHNlcnZ2dnYgaW4gaW5mb3JtYVsnc2Vydmlkb3JlcyddOgoJCQlpZihzZXJ2dnZ2Wydub21lJ10gPT0gc2VydnVzcyk6CgkJCQlpbmZvcm1hWydzZXJ2aWRvciddWydub21lJ10gPSBzZXJ2dnZ2Wydub21lJ10KCQkJCWluZm9ybWFbJ3NlcnZpZG9yJ11bJ3NlcnYnXSA9IHNlcnZ2dnZbJ2xpbmsnXQkJCQoJCQoJCWZvciBjaGlsZCBpbiBlbGVtczoKCQkJaWYoY2hpbGQudGFnID09ICdzdWNlc3NvJyk6CgkJCQlzdWNlc3NvID0gY2hpbGQudGV4dAoJCQllbGlmKGNoaWxkLnRhZyA9PSAnY2FuYWlzJyk6CgkJCQljYW5hbCA9IHsKCQkJCQknbm9tZSc6ICcnLAoJCQkJCSdsb2dvJzogJycsCgkJCQkJJ2xpbmsnOiAnJywKCQkJCQknZ3J1cG8nOiAnJywKCQkJCQknbm9tZWlkJzogJycsCgkJCQkJJ2lkbm92byc6ICcnCgkJCQl9CgkJCQlhZGljaW9uYSA9IFRydWUKCQkJCXBhZ2FudGUgPSBGYWxzZQoJCQkJZm9yIGcgaW4gY2hpbGQ6CgkJCQkJYWRpY2lvbmEgPSBUcnVlCgkJCQkJaWYoZy50YWcgPT0gJ05vbWUnKToKCQkJCQkJY2FuYWxbJ25vbWUnXSA9IGcudGV4dAoJCQkJCWVsaWYoZy50YWcgPT0gJ0ltYWdlbScpOgoJCQkJCQljYW5hbFsnbG9nbyddID0gZy50ZXh0CgkJCQkJZWxpZihnLnRhZyA9PSAnUGFnYW50ZScpOgoJCQkJCQlpZihnLnRleHQgPT0gJ3RydWUnKToKCQkJCQkJCXBhZ2FudGUgPSBUcnVlCgkJCQkJZWxpZihnLnRhZyA9PSAnVXJsJyk6CgkJCQkJCXVybGNoYW1hID0gZy50ZXh0LnNwbGl0KCc7JykKCQkJCQkJdXJsbm9vID0gZy50ZXh0CgkJCQkJCXRyeToKCQkJCQkJCWlmKHNlcnZ1c3MgPT0gJ1NlcnZpZG9yMScpOgoJCQkJCQkJCXVybG5vbyA9IHVybGNoYW1hWzBdCgkJCQkJCQllbGlmKHNlcnZ1c3MgPT0gJ1NlcnZpZG9yMicpOgoJCQkJCQkJCXVybG5vbyA9IHVybGNoYW1hWzFdCgkJCQkJCQllbGlmKHNlcnZ1c3MgPT0gJ1NlcnZpZG9yMycpOgoJCQkJCQkJCXVybG5vbyA9IHVybGNoYW1hWzJdCgkJCQkJCQllbGlmKHNlcnZ1c3MgPT0gJ1NlcnZpZG9yNCcpOgoJCQkJCQkJCXVybG5vbyA9IHVybGNoYW1hWzNdCgkJCQkJCQllbGlmKHNlcnZ1c3MgPT0gJ1NlcnZpZG9yNScpOgoJCQkJCQkJCXVybG5vbyA9IHVybGNoYW1hWzRdCgkJCQkJCQllbGlmKHNlcnZ1c3MgPT0gJ1NlcnZpZG9yNicpOgoJCQkJCQkJCXVybG5vbyA9IHVybGNoYW1hWzVdCgkJCQkJCQllbGlmKHNlcnZ1c3MgPT0gJ1NlcnZpZG9yNycpOgoJCQkJCQkJCXVybG5vbyA9IHVybGNoYW1hWzZdCgkJCQkJCQllbGlmKHNlcnZ1c3MgPT0gJ1NlcnZpZG9yOCcpOgoJCQkJCQkJCXVybG5vbyA9IHVybGNoYW1hWzddCgkJCQkJCQkKCQkJCQkJCWlmKHVybG5vbyA9PSAnbmFkYScpOgoJCQkJCQkJCWFkaWNpb25hID0gRmFsc2UKCQkJCQkJCWVsc2U6CgkJCQkJCQkJaWYgcGFnYW50ZToKCQkJCQkJCQkJY2FuYWxbJ2xpbmsnXSA9IGluZm9ybWFbJ3NlcnZpZG9yJ11bJ3NlcnYnXSsnbGl2ZS91dGlsaXphZG9ybGl2ZWl0L3NlbmhhbGl2ZWl0LycrdXJsbm9vCgkJCQkJCQkJZWxzZToKCQkJCQkJCQkJY2FuYWxbJ2xpbmsnXSA9IHVybG5vbwoJCQkJCQlleGNlcHQ6CgkJCQkJCQljYW5hbFsnbGluayddID0gZy50ZXh0CgkJCQkJZWxpZihnLnRhZyA9PSAnR3J1cG8nKToKCQkJCQkJY2FuYWxbJ2dydXBvJ10gPSBnLnRleHQKCQkJCQllbGlmKGcudGFnID09ICdOb21lSUQnKToKCQkJCQkJY2FuYWxbJ25vbWVpZCddID0gZy50ZXh0CgkJCQkJZWxpZihnLnRhZyA9PSAnSUQnKToKCQkJCQkJY2FuYWxbJ2lkbm92byddID0gZy50ZXh0CgkJCQlpZiBhZGljaW9uYToKCQkJCQlpbmZvcm1hWydjYW5haXMnXS5hcHBlbmQoY2FuYWwpCgoJCWlmIHN1Y2Vzc28gPT0gJ3llcyc6CgkJCWFkZERpcjIoJ0FsdGVyYXIgUGVzcXVpc2EnLCBzZXJ2dXNzLCAxMjAsICcnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncGVzcXVpc2EucG5nJyksIDApCgkJCWZvciBjYW5uIGluIGluZm9ybWFbJ2NhbmFpcyddOgoJCQkJbm9tZWUgPSBjYW5uWydub21lJ10KCQkJCWltZyA9IGNhbm5bJ2xvZ28nXQoJCQkJcnRtcCA9IGNhbm5bJ2xpbmsnXS5yZXBsYWNlKCcgcnRtcCcsJ3J0bXAnKS5yZXBsYWNlKCcgcnRzcCcsJ3J0c3AnKS5yZXBsYWNlKCcgaHR0cCcsJ2h0dHAnKS5yZXBsYWNlKCd1dGlsaXphZG9ybGl2ZWl0JyxfX0FERE9OX18uZ2V0U2V0dGluZygibG9naW5fbmFtZSIpKS5yZXBsYWNlKCdzZW5oYWxpdmVpdCcsX19BRERPTl9fLmdldFNldHRpbmcoImxvZ2luX3Bhc3N3b3JkIikpCgkJCQlncnVwID0gY2FublsnZ3J1cG8nXQoJCQkJaWRfaXQgPSBjYW5uWydub21laWQnXQoJCQkJaWRfcCA9IGNhbm5bJ2lkbm92byddCgkJCQlzcnRfZiA9ICcnCgkJCQlkZXNjcmkgPSAnJwoJCQkJCgkJCQlhZGRMaW5rMihub21lZSxydG1wLCdodHRwOi8vbGl2ZWl0a29kaS5jb20vTG9nb3MvJytpbWcpCgkJCQoJCQl2aXN0YV9DYW5haXMoKQoJZWxzZToKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdJbnNpcmEgYWxnbyBuYSBwZXNxdWlzYS4nKQoJCWFkZERpcjIoJ0FsdGVyYXIgUGVzcXVpc2EnLCBzZXJ2dXNzLCAxMjAsICcnLCBvcy5wYXRoLmpvaW4oX19BUlRfRk9MREVSX18sIF9fU0tJTl9fLCAncGVzcXVpc2EucG5nJyksIDApCgpkZWYgZG93bmxvYWQodXJsLG5hbWUsIHRlbXBvcmFkYSxlcGlzb2RpbyxzZXJpZU5vbWUpOgoJI2hlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICdCZWFyZXIgJXMnICUgX19BRERPTl9fLmdldFNldHRpbmcoJ3Rva2VuTXJwaXJhY3knKQoJbGlua3MgPSB1cmwuc3BsaXQoJy8nKQoJaWYgJ2ZpbG1lJyBpbiB1cmw6CgkJaWRfdmlkZW8gPSBsaW5rc1stMV0KCQl0aXBvID0gMAoJZWxpZiAnc2VyaWUnIGluIHVybDoKCQlpZF92aWRlbyA9IGxpbmtzWzVdCgkJdGVtcG9yYWRhID0gbGlua3NbN10KCQllcGlzb2RpbyA9IGxpbmtzWy0xXQoJCXRpcG8gPSAxCgllbGlmICdhbmltZScgaW4gdXJsOgoJCWlkX3ZpZGVvID0gbGlua3NbNV0KCQl0ZW1wb3JhZGEgPSBsaW5rc1s3XQoJCWVwaXNvZGlvID0gbGlua3NbLTFdCgkJdGlwbyA9IDIKCglyZXN1bHRhZG8gPSBhYnJpcl91cmwodXJsLCBoZWFkZXI9aGVhZGVycykKCWlmIHJlc3VsdGFkbyA9PSAnRE5TJzoKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdUZW0gZGUgYWx0ZXJhciBvcyBETlMgcGFyYSBwb2RlciB1c3VmcnVpciBkbyBfX0FERE9OX18uJykKCQlyZXR1cm4gRmFsc2UKCQoJcmVzdWx0YWRvID0ganNvbi5sb2FkcyhyZXN1bHRhZG8pCgoJc3RyZWFtLCBsZWdlbmRhLCBleHRfZyA9IGdldFN0cmVhbUxlZ2VuZGEocmVzdWx0YWRvKQoKCWZvbGRlciA9IHhibWMudHJhbnNsYXRlUGF0aChfX0FERE9OX18uZ2V0U2V0dGluZygncGFzdGFEb3dubG9hZHMnKSkKCWlmKGZvbGRlciA9PSAnRXNjb2xoYSBhIHBhc3RhIHBhcmEgRG93bmxvYWQnKToKCQlfX0FMRVJUQV9fKEFkZG9uVGl0bGUsICdTZWxlY2Npb25lIHVtYSBwYXN0YSBwcmltZWlybyBubyBzdWJtZW51IENyZWTDqm5jaWFpcyBvdSBuYXMgQ29uZmlndXJhw6fDtWVzIGRvIF9fQURET05fXy4nKQoJZWxzZToKCQlpZiB0aXBvID4gMDoKCQkJaWYgdGlwbyA9PSAxOgoJCQkJcmVzdWx0YWRvYSA9IGFicmlyX3VybChfX0FQSV9TSVRFX18rJ3NlcmllLycraWRfdmlkZW8sIGhlYWRlcj1oZWFkZXJzKQoJCQllbGlmIHRpcG8gPT0gMjoKCQkJCXJlc3VsdGFkb2EgPSBhYnJpcl91cmwoX19BUElfU0lURV9fKydhbmltZS8nK2lkX3ZpZGVvLCBoZWFkZXI9aGVhZGVycykKCQkJcmVzdWx0YWRvYSA9IGpzb24ubG9hZHMocmVzdWx0YWRvYSkKCQkJaWYgbm90IHhibWN2ZnMuZXhpc3RzKG9zLnBhdGguam9pbihmb2xkZXIsJ3NlcmllcycpKToKCQkJCXhibWN2ZnMubWtkaXJzKG9zLnBhdGguam9pbihmb2xkZXIsJ3NlcmllcycpKQoJCQlpZiBub3QgeGJtY3Zmcy5leGlzdHMob3MucGF0aC5qb2luKGZvbGRlciwnc2VyaWVzJyxyZXN1bHRhZG9hWydub21lX2luZ2xlcyddKSk6CgkJCQl4Ym1jdmZzLm1rZGlycyhvcy5wYXRoLmpvaW4oZm9sZGVyLCdzZXJpZXMnLHJlc3VsdGFkb2FbJ25vbWVfaW5nbGVzJ10pKQoJCQlpZiBub3QgeGJtY3Zmcy5leGlzdHMob3MucGF0aC5qb2luKGZvbGRlciwnc2VyaWVzJyxyZXN1bHRhZG9hWydub21lX2luZ2xlcyddLCJUZW1wb3JhZGEgIitzdHIodGVtcG9yYWRhKSkpOgoJCQkJeGJtY3Zmcy5ta2RpcnMob3MucGF0aC5qb2luKGZvbGRlciwnc2VyaWVzJyxyZXN1bHRhZG9hWydub21lX2luZ2xlcyddLCJUZW1wb3JhZGEgIitzdHIodGVtcG9yYWRhKSkpCgkJCWZvbGRlciA9IG9zLnBhdGguam9pbihmb2xkZXIsICdzZXJpZXMnLCByZXN1bHRhZG9hWydub21lX2luZ2xlcyddLCAiVGVtcG9yYWRhIiwgc3RyKHRlbXBvcmFkYSkpCgkJCW5hbWUgPSAiZSIrc3RyKGVwaXNvZGlvKSsiIC0gIitjbGVhbihyZXN1bHRhZG9bJ25vbWVfZXBpc29kaW8nXSkKCQllbHNlOgoJCQlpZiBub3QgeGJtY3Zmcy5leGlzdHMob3MucGF0aC5qb2luKGZvbGRlciwnZmlsbWVzJykpOgoJCQkJeGJtY3Zmcy5ta2RpcnMob3MucGF0aC5qb2luKGZvbGRlciwnZmlsbWVzJykpCgkJCWZvbGRlciA9IG9zLnBhdGguam9pbihmb2xkZXIsJ2ZpbG1lcycpCgkJCW5hbWUgPSByZXN1bHRhZG9bJ25vbWVfaW5nbGVzJ10KCgkJc3RyZWFtQXV4ID0gY2xlYW4oc3RyZWFtLnNwbGl0KCcvJylbLTFdKQoJCWV4dGVuc2FvU3RyZWFtID0gY2xlYW4oc3RyZWFtQXV4LnNwbGl0KCcuJylbLTFdKQoKCQlpZiAnP21pbScgaW4gZXh0ZW5zYW9TdHJlYW06CgkJCWV4dGVuc2FvU3RyZWFtID0gcmUuY29tcGlsZSgnKC4rPylcP21pbWU9JykuZmluZGFsbChleHRlbnNhb1N0cmVhbSlbMF0KCgkJaWYgZXh0X2cgIT0gJ2NvaXNvJzoKCQkJZXh0ZW5zYW9TdHJlYW0gPSBleHRfZwoKCQlub21lU3RyZWFtID0gbmFtZSsnLicrZXh0ZW5zYW9TdHJlYW0KCQlub21lbGVnZW5kYSA9ICcnCgkJRG93bmxvYWRlci5Eb3dubG9hZGVyKCkuZG93bmxvYWQob3MucGF0aC5qb2luKGZvbGRlci5kZWNvZGUoInV0Zi04IiksIG5vbWVTdHJlYW0pLCBzdHJlYW0sIG5hbWUpCgkJCgkJaWYgbGVnZW5kYXNPbjoKCQkJbGVnZW5kYUF1eCA9IGNsZWFuKGxlZ2VuZGEuc3BsaXQoJy8nKVstMV0pCgkJCWV4dGVuc2FvTGVnZW5kYSA9IGNsZWFuKGxlZ2VuZGFBdXguc3BsaXQoJy4nKVsxXSkKCQkJbm9tZUxlZ2VuZGEgPSBuYW1lKycuJytleHRlbnNhb0xlZ2VuZGEKCQkJZG93bmxvYWRfbGVnZW5kYXMobGVnZW5kYSwgb3MucGF0aC5qb2luKGZvbGRlciwgbm9tZUxlZ2VuZGEpKQoKZGVmIGRvd25sb2FkX2xlZ2VuZGFzKHVybCxwYXRoKToKCWNvbnRlbnRzID0gYWJyaXJfdXJsKHVybCkKCWlmIGNvbnRlbnRzOgoJCWZoID0gb3BlbihwYXRoLCAndycpCgkJZmgud3JpdGUoY29udGVudHMpCgkJZmguY2xvc2UoKQoJcmV0dXJuCgpkZWYgY2xlYW4odGV4dCk6Cgljb21tYW5kPXsnJiM4MjIwOyc6JyInLCcmIzgyMjE7JzonIicsICcmIzgyMTE7JzonLScsJyZhbXA7JzonJicsJyYjODIxNzsnOiInIiwnJiM4MjE2Oyc6IicifQoJcmVnZXggPSByZS5jb21waWxlKCJ8Ii5qb2luKG1hcChyZS5lc2NhcGUsIGNvbW1hbmQua2V5cygpKSkpCglyZXR1cm4gcmVnZXguc3ViKGxhbWJkYSBtbzogY29tbWFuZFttby5ncm91cCgwKV0sIHRleHQpCgpkZWYgYWRkVmlkZW8obmFtZSx1cmwsbW9kZSxpY29uaW1hZ2UsdmlzdG8sdGlwbyx0ZW1wb3JhZGEsZXBpc29kaW8saW5mb0xhYmVscyxwb3N0ZXIsdHJhaWxlcj1GYWxzZSxzZXJpZU5vbWU9RmFsc2UpOgoJbWVudSA9IFtdCgkKCWlmIGluZm9MYWJlbHM6IGluZm9MYWJlbHNBdXggPSBpbmZvTGFiZWxzCgllbHNlOiBpbmZvTGFiZWxzQXV4ID0geydUaXRsZSc6IG5hbWV9CgoJaWYgcG9zdGVyOiBwb3N0ZXJBdXggPSBwb3N0ZXIKCWVsc2U6IHBvc3RlckF1eCA9IGljb25pbWFnZQoJCgl0cnk6CgkJbmFtZSA9IG5hbWUuZW5jb2RlKCd1dGYtOCcpCglleGNlcHQ6CgkJbmFtZSA9IG5hbWUKCQoJdHJ5OgoJCXNlcmllTm9tZSA9IHNlcmllTm9tZS5lbmNvZGUoJ3V0Zi04JykKCWV4Y2VwdDoKCQlzZXJpZU5vbWUgPSBzZXJpZU5vbWUKCWVsc2U6CgkJcGFzcwoKCWZhbmFydCA9IF9fRkFOQVJUX18KCQoJaWYgdGlwbyA9PSAnZmlsbWUnOgoJCXhibWNwbHVnaW4uc2V0Q29udGVudChpbnQoc3lzLmFyZ3ZbMV0pLCAnTW92aWVzJykKCQlpZiBfX0FERE9OX18uZ2V0U2V0dGluZygndHJhaWxlci1maWxtZXMnKSA9PSAndHJ1ZSc6CgkJCXRyeToKCQkJCWlkWW91dHViZSA9IHRyYWlsZXIuc3BsaXQoJz92PScpWy0xXS5zcGxpdCgnLycpWy0xXS5zcGxpdCgnPycpWzBdLnNwbGl0KCcmJylbMF0KCQkJCWxpbmtUcmFpbGVyID0gJ3BsdWdpbjovL3BsdWdpbi52aWRlby55b3V0dWJlL3BsYXkvP3ZpZGVvX2lkPScraWRZb3V0dWJlCgkJCQkjaWRZb3V0dWJlPXRyYWlsZXIuc3BsaXQoJz0nKQoJCQkJI19fQUxFUlRBX18oQWRkb25UaXRsZSwgJ0lEOiAnK2lkWW91dHViZVsxXSkKCQkJCSNsaW5rVHJhaWxlciA9ICdwbHVnaW46Ly9wbHVnaW4udmlkZW8ueW91dHViZS8/cGF0aD0vcm9vdC92aWRlbyZhY3Rpb249cGxheV92aWRlbyZ2aWRlb2lkPScraWRZb3V0dWJlWzFdCgkJCQkjbGlua1RyYWlsZXIgPSB0cmFpbGVyCgkJCWV4Y2VwdDoKCQkJCWxpbmtUcmFpbGVyID0gJycKCQllbHNlOgoJCQlsaW5rVHJhaWxlciA9ICcnCgllbGlmIHRpcG8gPT0gJ3NlcmllJzoKCQl4Ym1jcGx1Z2luLnNldENvbnRlbnQoaW50KHN5cy5hcmd2WzFdKSwgJ3R2c2hvd3MnKQoJCWlkSU1EYiA9IHJlLmNvbXBpbGUoJ2ltZGI9KC4rPykmJykuZmluZGFsbCh1cmwpWzBdCgkJbGlua1RyYWlsZXIgPSAiIgoJZWxpZiB0aXBvID09ICdlcGlzb2Rpbyc6CgkJeGJtY3BsdWdpbi5zZXRDb250ZW50KGludChzeXMuYXJndlsxXSksICdlcGlzb2RlcycpCgkJbGlua1RyYWlsZXIgPSAiIgoJZWxzZToKCQl4Ym1jcGx1Z2luLnNldENvbnRlbnQoaW50KHN5cy5hcmd2WzFdKSwgJ01vdmllcycpCgkJbGlua1RyYWlsZXIgPSAiIgoJCglvdmVybGF5ID0gNgoJcGxheWNvdW50ID0gMAoKCWluZm9MYWJlbHNBdXhbIm92ZXJsYXkiXSA9IG92ZXJsYXkKCWluZm9MYWJlbHNBdXhbInBsYXljb3VudCJdID0gcGxheWNvdW50CgkKCWxpej14Ym1jZ3VpLkxpc3RJdGVtKG5hbWUsIGljb25JbWFnZT1pY29uaW1hZ2UsIHRodW1ibmFpbEltYWdlPWljb25pbWFnZSkKCWxpei5zZXRJbmZvKCB0eXBlPSJWaWRlbyIsIGluZm9MYWJlbHM9aW5mb0xhYmVsc0F1eCkKCWxpei5zZXRQcm9wZXJ0eSgnZmFuYXJ0X2ltYWdlJywgcG9zdGVyKQoJbGl6LnNldEFydCh7J2ZhbmFydCc6IHBvc3Rlcn0pCgkKCQoJaWYgbm90IHNlcmllTm9tZToKCQlzZXJpZU5vbWUgPSAnJwoKCXU9c3lzLmFyZ3ZbMF0rIj91cmw9Iit1cmxsaWIucXVvdGVfcGx1cyh1cmwpKyImbW9kZT0iK3N0cihtb2RlKSsiJnRlbXBvcmFkYT0iK3N0cih0ZW1wb3JhZGEpKyImZXBpc29kaW89IitzdHIoZXBpc29kaW8pKyImbmFtZT0iK3VybGxpYi5xdW90ZV9wbHVzKG5hbWUpKyImaWNvbmltYWdlPSIrdXJsbGliLnF1b3RlX3BsdXMoaWNvbmltYWdlKSsiJnNlcmllTm9tZT0iK3VybGxpYi5xdW90ZV9wbHVzKHNlcmllTm9tZSkKCW9rPVRydWUKCQoJaWYgbGlua1RyYWlsZXIgIT0gIiI6CgkJbWVudS5hcHBlbmQoKCdWZXIgVHJhaWxlcicsICdYQk1DLlBsYXlNZWRpYSglcyknICUgKGxpbmtUcmFpbGVyKSkpCgkJI21lbnUuYXBwZW5kKCgnVmVyIFRyYWlsZXInLCAnWEJNQy5SdW5QbHVnaW4oJXM/bW9kZT0xMDUmbmFtZT0lcyZ1cmw9JXMmaWNvbmltYWdlPSVzKSclKHN5cy5hcmd2WzBdLHVybGxpYi5xdW90ZV9wbHVzKG5hbWUpLCBsaW5rVHJhaWxlciwgdXJsbGliLnF1b3RlX3BsdXMoaWNvbmltYWdlKSkpKQoJCgltZW51LmFwcGVuZCgoJ0Rvd25sb2FkJywgJ1hCTUMuUnVuUGx1Z2luKCVzP21vZGU9MTE3Jm5hbWU9JXMmdXJsPSVzJmljb25pbWFnZT0lcyZzZXJpZU5vbWU9JXMmdGVtcG9yYWRhPSVzJmVwaXNvZGlvPSVzKSclKHN5cy5hcmd2WzBdLHVybGxpYi5xdW90ZV9wbHVzKG5hbWUpLCB1cmxsaWIucXVvdGVfcGx1cyh1cmwpLCB1cmxsaWIucXVvdGVfcGx1cyhpY29uaW1hZ2UpLCB1cmxsaWIucXVvdGVfcGx1cyhzZXJpZU5vbWUpLCBzdHIodGVtcG9yYWRhKSwgc3RyKGVwaXNvZGlvKSkpKQoJbGl6LmFkZENvbnRleHRNZW51SXRlbXMobWVudSwgcmVwbGFjZUl0ZW1zPVRydWUpCglvaz14Ym1jcGx1Z2luLmFkZERpcmVjdG9yeUl0ZW0oaGFuZGxlPWludChzeXMuYXJndlsxXSksdXJsPXUsbGlzdGl0ZW09bGl6LGlzRm9sZGVyPUZhbHNlKQoJcmV0dXJuIG9rCgpkZWYgQWRkRGlyKG5hbWUsIHVybCwgbW9kZSwgaWNvbmltYWdlPScnLCBsb2dvcz0nJywgaW5kZXg9LTEsIG1vdmU9MCwgaXNGb2xkZXI9VHJ1ZSwgSXNQbGF5YWJsZT1GYWxzZSwgYmFja2dyb3VuZD1Ob25lLCBjYWNoZU1pbj0nMCcsIGluZm89JycsIG1ldGFoPScnKToKCXVybFBhcmFtcyA9IHsnbmFtZSc6IG5hbWUsICd1cmwnOiB1cmwsICdtb2RlJzogbW9kZSwgJ2ljb25pbWFnZSc6IGljb25pbWFnZSwgJ2xvZ29zJzogbG9nb3MsICdjYWNoZSc6IGNhY2hlTWluLCAnaW5mbyc6IGluZm8sICdiYWNrZ3JvdW5kJzogYmFja2dyb3VuZCwgJ21ldGFoJzogbWV0YWh9CglsaXogPSB4Ym1jZ3VpLkxpc3RJdGVtKG5hbWUsIGljb25JbWFnZT1pY29uaW1hZ2UsIHRodW1ibmFpbEltYWdlPWljb25pbWFnZSApCglpZiBtZXRhaDoKCQlsaXouc2V0SW5mbyh0eXBlPSJWaWRlbyIsIGluZm9MYWJlbHM9bWV0YWgpCgkJbGl6LnNldEFydCh7InRodW1iIjogbWV0YWhbJ2NvdmVyX3VybCddLCAicG9zdGVyIjogbWV0YWhbJ2NvdmVyX3VybCddLCAiYmFubmVyIjogbWV0YWhbJ2NvdmVyX3VybCddLCAiZmFuYXJ0IjogbWV0YWhbJ2JhY2tkcm9wX3VybCddIH0pCgllbHNlOgoJCWxpei5zZXRJbmZvKHR5cGU9IlZpZGVvIiwgaW5mb0xhYmVscz17ICJUaXRsZSI6IG5hbWUsICJQbG90IjogaW5mbyB9KQoJCSNsaXouc2V0UHJvcGVydHkoIkZhbmFydF9JbWFnZSIsIGxvZ29zKQoJCWxpei5zZXRBcnQoeyJwb3N0ZXIiOiBpY29uaW1hZ2UsICJiYW5uZXIiOiBsb2dvcywgImZhbmFydCI6IGxvZ29zIH0pCgkjbGlzdE1vZGUgPSAyMSAjIExpc3RzCglpZiBJc1BsYXlhYmxlOgoJCWxpei5zZXRQcm9wZXJ0eSgnSXNQbGF5YWJsZScsICd0cnVlJykKCWl0ZW1zID0gW10KCWlmIG1vZGUgPT0gMSBvciBtb2RlID09IDI6CgkJaXRlbXMgPSBbXQoJaWYgbW9kZSA9PSAxMDoKCQl1cmxQYXJhbXNbJ2luZGV4J10gPSBpbmRleAoJCgkjdT1zeXMuYXJndlswXSsiP3VybD0iK3VybGxpYi5xdW90ZV9wbHVzKHVybCkrIiZuYW1lPSIrdXJsbGliLnF1b3RlX3BsdXMobmFtZSkrIiZtb2RlPSIraW50KG1vZGUpKyImbW92ZT0iK2ludChtb3ZlKSsiJmluZGV4PSIraW50KGluZGV4KSsiJmljb25pbWFnZT0iK3N0cihpY29uaW1hZ2UpKyImbG9nb3M9IitzdHIobG9nb3MpKyImY2FjaGU9IitzdHIoY2FjaGVNaW4pKyImaW5mbz0iK3N0cihpbmZvKSsiJmJhY2tncm91bmQ9IitiYWNrZ3JvdW5kKyImbWV0YWg9IitzdHIobWV0YWgpCgkjdT1zeXMuYXJndlswXSsiP3VybD0iK3VybGxpYi5xdW90ZV9wbHVzKHVybCkrIiZtb2RlPSIrc3RyKG1vZGUpKyImbmFtZT0iK3VybGxpYi5xdW90ZV9wbHVzKG5hbWUpKyImc2VuaGE9IitzdHIoc2VuaGEpKyImZXN0aWxvPSIrdXJsbGliLnF1b3RlX3BsdXMoZXN0aWxvKSsiJnRpcG9sb2dpYT0iK3N0cih0aXBvKSsiJnRpcG9fdXNlcj0iK3N0cih0aXBvX3VzZXIpKyImc2Vydmlkb3JfdXNlcj0iK3N0cihzZXJ2aWRvcl91c2VyKSsiJmRhdGFfdXNlcj0iK3N0cihkYXRhX3VzZXIpKyImZmFuYXJ0PSIrc3RyKGZhbmFydCkKCXUgPSAnezB9P3sxfScuZm9ybWF0KHN5cy5hcmd2WzBdLCB1cmxsaWIudXJsZW5jb2RlKHVybFBhcmFtcykpCglvaz14Ym1jcGx1Z2luLmFkZERpcmVjdG9yeUl0ZW0oaGFuZGxlPWludChzeXMuYXJndlsxXSksdXJsPXUsIGxpc3RpdGVtPWxpeixpc0ZvbGRlcj1pc0ZvbGRlcikKCXJldHVybiBvawoKZGVmIEdldEtleWJvYXJkVGV4dCh0aXRsZSA9ICIiLCBkZWZhdWx0VGV4dCA9ICIiKToKCWtleWJvYXJkID0geGJtYy5LZXlib2FyZChkZWZhdWx0VGV4dCwgdGl0bGUpCglrZXlib2FyZC5kb01vZGFsKCkKCXRleHQgPSAiIiBpZiBub3Qga2V5Ym9hcmQuaXNDb25maXJtZWQoKSBlbHNlIGtleWJvYXJkLmdldFRleHQoKQoJcmV0dXJuIHRleHQKCmRlZiBSZWZyZXNoKCk6Cgl4Ym1jLmV4ZWN1dGVidWlsdGluKCJYQk1DLkNvbnRhaW5lci5SZWZyZXNoKCkiKQoKZGVmIFBsYXlVcmwobmFtZSwgdXJsLCBpY29uaW1hZ2U9Tm9uZSwgaW5mbz0nJywgc3ViPScnLCBtZXRhaD0nJyk6CglpZiAiOzs7IiBpbiBiYWNrZ3JvdW5kOgoJCWIgPSBiYWNrZ3JvdW5kLnNwbGl0KCI7OzsiKQoJdXJsID0gcmUuc3ViKCdcLm1wNCQnLCAnLm1wND9wbGF5JywgdXJsKQoJdXJsID0gY29tbW9uLmdldEZpbmFsVXJsKHVybCkKCSN4Ym1jLmxvZygnLS0tIFBsYXlpbmcgInswfSIuIHsxfScuZm9ybWF0KG5hbWUsIHVybCksIDIpCglsaXN0aXRlbSA9IHhibWNndWkuTGlzdEl0ZW0ocGF0aD11cmwpCglpZiBtZXRhaDoKCQlsaXN0aXRlbS5zZXRJbmZvKHR5cGU9IlZpZGVvIiwgaW5mb0xhYmVscz1tZXRhaCkKCWVsc2U6CgkJbGlzdGl0ZW0uc2V0SW5mbyh0eXBlPSJWaWRlbyIsIGluZm9MYWJlbHM9eyJtZWRpYXR5cGUiOiAidmlkZW8iLCAiVGl0bGUiOiBuYW1lLCAiUGxvdCI6IGluZm8gfSkKCWlmIHN1YiE9Jyc6CgkJbGlzdGl0ZW0uc2V0U3VidGl0bGVzKFsnc3BlY2lhbDovL3RlbXAvZXhhbXBsZS5zcnQnLCBzdWIgXSkKCWlmIGljb25pbWFnZSBpcyBub3QgTm9uZToKCQl0cnk6CgkJCWxpc3RpdGVtLnNldEFydCh7J3RodW1iJyA6IGljb25pbWFnZX0pCgkJZXhjZXB0OgoJCQlsaXN0aXRlbS5zZXRUaHVtYm5haWxJbWFnZShpY29uaW1hZ2UpCgl4Ym1jcGx1Z2luLnNldFJlc29sdmVkVXJsKGludChzeXMuYXJndlsxXSksIFRydWUsIGxpc3RpdGVtKQojIC0tLS0tLS0tLS0tLS0tICBGSU0gTkVUQ0lORQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCQkJCQkJCQlGVU5DT0VTIEpBIEZFSVRBUwkJCQkJCQkJICMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKZGVmIGFkZERpcihuYW1lLHVybCxtb2RlLGVzdGlsbyxpY29uaW1hZ2UsdGlwbyxmYW5hcnQscGFzdGE9VHJ1ZSx0b3RhbD0xKToKCXRyeToKCQluYW1lID0gbmFtZS5lbmNvZGUoJ3V0Zi04JykKCWV4Y2VwdDoKCQluYW1lID0gbmFtZQoJaWYodGlwbyA9PSAnbGltcGFyY2FjaGUnIGFuZCB0aXBvID09ICdsaW1wYXJ0dWRvJyk6CQkJCQoJCXU9c3lzLmFyZ3ZbMF0rIj91cmw9Iit1cmxsaWIucXVvdGVfcGx1cyh1cmwpKyImbW9kZT0iK3N0cihtb2RlKQoJZWxzZToKCQl1PXN5cy5hcmd2WzBdKyI/dXJsPSIrdXJsbGliLnF1b3RlX3BsdXModXJsKSsiJm1vZGU9IitzdHIobW9kZSkrIiZuYW1lPSIrdXJsbGliLnF1b3RlX3BsdXMobmFtZSkrIiZlc3RpbG89Iit1cmxsaWIucXVvdGVfcGx1cyhlc3RpbG8pKyImZmFuYXJ0PSIrc3RyKGZhbmFydCkKCW9rPVRydWUKCWxpej14Ym1jZ3VpLkxpc3RJdGVtKG5hbWUsIGljb25JbWFnZT1pY29uaW1hZ2UsIHRodW1ibmFpbEltYWdlPWljb25pbWFnZSkKCWxpei5zZXRQcm9wZXJ0eSgnZmFuYXJ0X2ltYWdlJywgZmFuYXJ0KQoJbGl6LnNldEFydCh7J2ZhbmFydCc6IGZhbmFydH0pCglvaz14Ym1jcGx1Z2luLmFkZERpcmVjdG9yeUl0ZW0oaGFuZGxlPWludChzeXMuYXJndlsxXSksdXJsPXUsbGlzdGl0ZW09bGl6LGlzRm9sZGVyPXBhc3RhLHRvdGFsSXRlbXM9dG90YWwpCglyZXR1cm4gb2sKCmRlZiBhZGREaXIyKG5hbWUsdXJsLG1vZGUsbW9kZTIsaWNvbmltYWdlLHBhZ2luYT0xLHRpcG89Tm9uZSxpbmZvTGFiZWxzPU5vbmUscG9zdGVyPU5vbmUsdmlzdG89RmFsc2UpOgoJaWYgaW5mb0xhYmVsczogaW5mb0xhYmVsc0F1eCA9IGluZm9MYWJlbHMKCWVsc2U6IGluZm9MYWJlbHNBdXggPSB7J1RpdGxlJzogbmFtZX0KCWZhbmFydCA9ICcnCglpZiBwb3N0ZXI6IGZhbmFydCA9IHBvc3RlcgoJZWxzZTogZmFuYXJ0ID0gaWNvbmltYWdlCgkKCXRyeToKCQluYW1lID0gbmFtZS5lbmNvZGUoJ3V0Zi04JykKCWV4Y2VwdDoKCQluYW1lID0gbmFtZQoKCXU9c3lzLmFyZ3ZbMF0rIj91cmw9Iit1cmxsaWIucXVvdGVfcGx1cyh1cmwpKyImbW9kbz0iK21vZGUyKyImbW9kZT0iK3N0cihtb2RlKSsiJm5hbWU9Iit1cmxsaWIucXVvdGVfcGx1cyhuYW1lKQoJCglvaz1UcnVlCgoJI2ZhbmFydCA9IF9fRkFOQVJUX18KCglpZiB0aXBvID09ICdmaWxtZSc6CgkJI2ZhbmFydCA9IHBvc3RlckF1eAoJCXhibWNwbHVnaW4uc2V0Q29udGVudChpbnQoc3lzLmFyZ3ZbMV0pLCAnTW92aWVzJykKCWVsaWYgdGlwbyA9PSAnc2VyaWUnOgoJCSNmYW5hcnQgPSBwb3N0ZXJBdXgKCQl4Ym1jcGx1Z2luLnNldENvbnRlbnQoaW50KHN5cy5hcmd2WzFdKSwgJ3R2c2hvd3MnKQoJZWxpZiB0aXBvID09ICdlcGlzb2Rpbyc6CgkJI2ZhbmFydCA9IHBvc3RlckF1eAoJCXhibWNwbHVnaW4uc2V0Q29udGVudChpbnQoc3lzLmFyZ3ZbMV0pLCAnZXBpc29kZXMnKQoJZWxzZToKCQlpZiBuYW1lICE9ICdSZWZyZXNoJzoKCQkJeGJtY3BsdWdpbi5zZXRDb250ZW50KGludChzeXMuYXJndlsxXSksICdNb3ZpZXMnKQoJCglvdmVybGF5ID0gNgoJcGxheWNvdW50ID0gMAoJCglpbmZvTGFiZWxzQXV4WyJvdmVybGF5Il0gPSBvdmVybGF5CglpbmZvTGFiZWxzQXV4WyJwbGF5Y291bnQiXSA9IHBsYXljb3VudAoJCglsaXo9eGJtY2d1aS5MaXN0SXRlbShuYW1lLCBpY29uSW1hZ2U9aWNvbmltYWdlLCB0aHVtYm5haWxJbWFnZT1pY29uaW1hZ2UpCglsaXouc2V0UHJvcGVydHkoJ2ZhbmFydF9pbWFnZScsIGZhbmFydCkKCWxpei5zZXRBcnQoeydmYW5hcnQnOiBmYW5hcnR9KQoJbGl6LnNldEluZm8oIHR5cGU9IlZpZGVvIiwgaW5mb0xhYmVscz1pbmZvTGFiZWxzQXV4ICkKCglvaz14Ym1jcGx1Z2luLmFkZERpcmVjdG9yeUl0ZW0oaGFuZGxlPWludChzeXMuYXJndlsxXSksdXJsPXUsbGlzdGl0ZW09bGl6LGlzRm9sZGVyPVRydWUpCglyZXR1cm4gb2sKCmRlZiBhZGRMaW5rQ2FuYWwobmFtZSx1cmwsaWNvbmltYWdlLGlkY2FuYWwsaWRfcCk6CglpbmZvTGFiZWxzc3NzID0geyJ0aXRsZSI6IG5hbWUsICJnZW5yZSI6ICdBbGwnfQoJb2s9VHJ1ZQoJY209W10KCQoJaWYoaWRjYW5hbCAhPSAnMDAwMScpOgoJCWNtLmFwcGVuZCgoJ1ZlciBwcm9ncmFtYcOnw6NvJywgJ1hCTUMuUnVuUGx1Z2luKCVzP21vZGU9MzEmbmFtZT0lcyZ1cmw9JXMmaWNvbmltYWdlPSVzJmlkQ2FuYWw9JXMmaWRmZkNhbmFsPSVzKSclKHN5cy5hcmd2WzBdLHVybGxpYi5xdW90ZV9wbHVzKG5hbWUpLCB1cmxsaWIucXVvdGVfcGx1cyh1cmwpLCB1cmxsaWIucXVvdGVfcGx1cyhpY29uaW1hZ2UpLCBpZENhbmFsLCBpZF9wKSkpCgkKCWxpeiA9IHhibWNndWkuTGlzdEl0ZW0obmFtZSwgaWNvbkltYWdlPWljb25pbWFnZSwgdGh1bWJuYWlsSW1hZ2U9aWNvbmltYWdlKQoJbGl6LnNldEluZm8oIHR5cGU9IlZpZGVvIiwgaW5mb0xhYmVscz1pbmZvTGFiZWxzc3NzKQoJbGl6LmFkZENvbnRleHRNZW51SXRlbXMoY20sIHJlcGxhY2VJdGVtcz1GYWxzZSkKCWxpei5zZXRQcm9wZXJ0eSgnSXNQbGF5YWJsZScsICd0cnVlJykKCWxpei5zZXRQcm9wZXJ0eSgnZmFuYXJ0X2ltYWdlJywgb3MucGF0aC5qb2luKF9fQVJUX0ZPTERFUl9fLCBfX1NLSU5fXywgJ2Z1bmRvX3R2LnBuZycpKQoJbGl6LnNldEFydCh7J2ZhbmFydCc6IG9zLnBhdGguam9pbihfX0FSVF9GT0xERVJfXywgX19TS0lOX18sICdmdW5kb190di5wbmcnKX0pCgl1ID0gc3lzLmFyZ3ZbMF0gKyAiP3VybD0iICsgdXJsbGliLnF1b3RlX3BsdXModXJsKSArICImbW9kZT0xMSZuYW1lPSIgKyB1cmxsaWIucXVvdGVfcGx1cyhuYW1lKSArICImaWNvbmltYWdlPSIgKyB1cmxsaWIucXVvdGVfcGx1cyhpY29uaW1hZ2UpKyImc3RyZWFtX2lkPSIrc3RyKGlkY2FuYWwpCglvaz14Ym1jcGx1Z2luLmFkZERpcmVjdG9yeUl0ZW0oaGFuZGxlPWludChzeXMuYXJndlsxXSksIHVybD11LCBsaXN0aXRlbT1saXopCglyZXR1cm4gb2sKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCQkJCQkJCQkJCQkJCUVQRwkJCQkJCQkJCQkJCQkgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKZGVmIG9idGVyX2ZpY2hlaXJvX2VwZygpOgoJX19FUEdfXyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCJsaXN0YV9lcGciKQoJaWYgbm90IHhibWN2ZnMuZXhpc3RzKF9fRk9MREVSX0VQR19fKToKCQl4Ym1jdmZzLm1rZGlycyhfX0ZPTERFUl9FUEdfXykKCgl1bmNvbXByZXNzZWRfcGF0aCA9IG9zLnBhdGguam9pbihfX0ZPTERFUl9FUEdfXywgJ2VwZy54bWwnKQoJdXJsID0gdXJsbGliLnVybG9wZW4oX19FUEdfXykKCWNvZGlnbyA9IHVybC5yZWFkKCkKCXVybC5jbG9zZQoJCglvcGVuKHVuY29tcHJlc3NlZF9wYXRoLCAndycpLndyaXRlKGNvZGlnbykKCmRlZiBnZXRQcm9ncmFtYWNhb0RpYXJpYShpZENhbmFsLCBkaWFob3JhLCBjb2RpZ28pOgoJc291cmNlID0gcmUuY29tcGlsZSgnPHByb2dyYW1tZSBzdGFydD0iKC4rPykgXCswMTAwIiBzdG9wPSIoLis/KSBcKzAxMDAiIGNoYW5uZWw9IicraWRDYW5hbCsnIj5ccys8dGl0bGUgbGFuZz0icHQiPiguKz8pPFwvdGl0bGU+JykuZmluZGFsbChjb2RpZ28pCgoJcHJvZ3JhbWEgPSAnJwoKCWZvciBzdGFydCwgc3RvcCwgcHJvZ3JhbWExICBpbiBzb3VyY2U6CgoJCWlmKGludChzdGFydCkgPCBkaWFob3JhIGFuZCBpbnQoc3RvcCkgPiBkaWFob3JhKToKCQkJcHJvZ3JhbWEgPSBwcm9ncmFtYTEKCXJldHVybiBwcm9ncmFtYQoKCmRlZiBwcm9ncmFtYWNhb19jYW5hbChpZENhbmFsKToKCV9fRVBHX18gPSBfX0FERE9OX18uZ2V0U2V0dGluZygibGlzdGFfZXBnIikKCXVybCA9IHVybGxpYi51cmxvcGVuKF9fRVBHX18pCgljb2RpZ28gPSB1cmwucmVhZCgpCgl1cmwuY2xvc2UKCQoJdHMgPSB0aW1lLnRpbWUoKQoJc3QgPSBpbnQoZGF0ZXRpbWUuZGF0ZXRpbWUuZnJvbXRpbWVzdGFtcCh0cykuc3RyZnRpbWUoJyVZJW0lZCcpKQoKCWRpYWhvcmEgPSBpbnQoc3RyKHN0KSsnMDYwMDAwJykKCWRpYWFtYW5oYSA9IGludChzdHIoc3QrMSkrJzA2MDAwMCcpCgoJc291cmNlID0gcmUuY29tcGlsZSgnPHByb2dyYW1tZSBzdGFydD0iKC4rPykgXCswMTAwIiBzdG9wPSIoLis/KSBcKzAxMDAiIGNoYW5uZWw9IicraWRDYW5hbCsnIj5ccys8dGl0bGUgbGFuZz0icHQiPiguKz8pPFwvdGl0bGU+JykuZmluZGFsbChjb2RpZ28pCgoJcHJvZ3JhbWEgPSAnJwoKCXRpdGxlcz1bJ1tCXVtDT0xPUiB3aGl0ZV1Qcm9ncmFtYcOnw6NvOlsvQ09MT1JdWy9CXSddCgoJCglmb3Igc3RhcnQsIHN0b3AsIHByb2dyYW1hMSBpbiBzb3VyY2U6CgoJCXN0YXJ0MSA9IHJlLmNvbXBpbGUoJyhbMC05XXs0fVswLTFdWzAtOV1bMC0zXVswLTldKShbMC05XXsyfSkoWzAtOV17Mn0pKFswLTldezJ9KScpLmZpbmRhbGwoc3RhcnQpCgkJc3RvcDEgPSByZS5jb21waWxlKCcoWzAtOV17NH1bMC0xXVswLTldWzAtM11bMC05XSkoWzAtOV17Mn0pKFswLTldezJ9KShbMC05XXsyfSknKS5maW5kYWxsKHN0b3ApCgoJCWlmKGludChzdGFydCkgPiBkaWFob3JhIGFuZCBpbnQoc3RhcnQpIDwgZGlhYW1hbmhhICk6CgkJCXRpdGxlcy5hcHBlbmQoJ1xuW0JdJXM6JXMgLT4gJXM6JXNbL0JdIC0gJXMnICUgKHN0YXJ0MVswXVsxXSwgc3RhcnQxWzBdWzJdLCBzdG9wMVswXVsxXSwgc3RvcDFbMF1bMl0sIHByb2dyYW1hMSkpCgoKCXByb2dyYW1hY2FvID0gJ1xuJy5qb2luKHRpdGxlcykKCXRyeToKCQl4Ym1jLmV4ZWN1dGVidWlsdGluKCJBY3RpdmF0ZVdpbmRvdygxMDE0NykiKQoJCXdpbmRvdyA9IHhibWNndWkuV2luZG93KDEwMTQ3KQoJCXhibWMuc2xlZXAoMTAwKQoJCXdpbmRvdy5nZXRDb250cm9sKDEpLnNldExhYmVsKEFkZG9uVGl0bGUpCgkJd2luZG93LmdldENvbnRyb2woNSkuc2V0VGV4dChwcm9ncmFtYWNhbykKCWV4Y2VwdDoKCQlwYXNzCgpkZWYgYWJyaXJfdXJsKHVybCwgcG9zdD1Ob25lLCBoZWFkZXI9Tm9uZSwgY29kZT1GYWxzZSwgZXJybz1GYWxzZSwgY29va2llPU5vbmUpOgoJaWYgaGVhZGVyID09IE5vbmU6CgkJaGVhZGVyID0gaGVhZGVycwoJaWYgY29va2llOgoJCWhlYWRlclsnQ29va2llJ10gPSBjb29raWUKCQoJaWYgcG9zdDoKCQloZWFkZXJbJ0NvbnRlbnQtVHlwZSddID0nYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJwoJCXJlcSA9IHVybGxpYjIuUmVxdWVzdCh1cmwsIGRhdGE9cG9zdCwgaGVhZGVycz1oZWFkZXIpCgllbHNlOgoJCXJlcSA9IHVybGxpYjIuUmVxdWVzdCh1cmwsIGhlYWRlcnM9aGVhZGVyKQoJdHJ5OgoJCXJlc3BvbnNlID0gdXJsbGliMi51cmxvcGVuKHJlcSxjb250ZXh0PWNvbnRleHQpCglleGNlcHQ6CgkJdHJ5OgoJCQlyZXNwb25zZSA9IHVybGxpYjIudXJsb3BlbihyZXEpCgkJZXhjZXB0IHVybGxpYjIuSFRUUEVycm9yIGFzIHJlc3BvbnNlOgoJCQlpZiBlcnJvID09IFRydWU6CgkJCQlyZXR1cm4gc3RyKHJlc3BvbnNlLmNvZGUpLCAiYXNkIgoJbGluaz1yZXNwb25zZS5yZWFkKCkKCQoJaWYgJ2p1ZGljaWFsIGJsYmxibGJsYmwnIGluIGxpbms6CgkJcmV0dXJuICdETlMnCglpZiBjb2RlOgoJCXJldHVybiBzdHIocmVzcG9uc2UuY29kZSksIGxpbmsKCglyZXNwb25zZS5jbG9zZSgpCglyZXR1cm4gbGluawoKZGVmIGFkZExpbmsyKG5hbWUsdXJsLGljb25pbWFnZSk6Cglvaz1UcnVlCglsaXogPSB4Ym1jZ3VpLkxpc3RJdGVtKG5hbWUsIGljb25JbWFnZT1pY29uaW1hZ2UsIHRodW1ibmFpbEltYWdlPWljb25pbWFnZSkKCWxpei5zZXRQcm9wZXJ0eSgnZmFuYXJ0X2ltYWdlJywgaWNvbmltYWdlKQoJbGl6LnNldEFydCh7J2ZhbmFydCc6IGljb25pbWFnZX0pCglsaXouc2V0SW5mbyggdHlwZT0iVmlkZW8iLCBpbmZvTGFiZWxzPXsgIlRpdGxlIjogbmFtZSB9KQoJbGl6LnNldFByb3BlcnR5KCdJc1BsYXlhYmxlJywgJ3RydWUnKQoJdSA9IHN5cy5hcmd2WzBdICsgIj91cmw9IiArIHVybCArICImbW9kZT0xMDYmbmFtZT0iICsgbmFtZSArICImaWNvbmltYWdlPSIgKyBpY29uaW1hZ2UKCW9rPXhibWNwbHVnaW4uYWRkRGlyZWN0b3J5SXRlbShoYW5kbGU9aW50KHN5cy5hcmd2WzFdKSwgdXJsPXUsIGxpc3RpdGVtPWxpeikKCXJldHVybiBvawoKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMJCQkJCQkJICBERUZJTklOQ09FUwkJCQkJCQkJCQkgICMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMJCgpkZWYgdmlzdGFfR3J1cG9zKCk6CglvcGNhbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCdjYW5haXNWaWV3JykKCWlmIG9wY2FvID09ICcwJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwKSIpCgllbGlmIG9wY2FvID09ICcxJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUxKSIpCgllbGlmIG9wY2FvID09ICcyJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwMCkiKQoJZWxpZiBvcGNhbyA9PSAnMyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDkpIikKCWVsaWYgb3BjYW8gPT0gJzMnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA4KSIpCgllbGlmIG9wY2FvID09ICc0JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwNCkiKQoJZWxpZiBvcGNhbyA9PSAnNSc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDMpIikKCWVsaWYgb3BjYW8gPT0gJzYnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTE1KSIpCgllbGlmIG9wY2FvID09ICc3JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDU1KSIpCgpkZWYgdmlzdGFfQ2FuYWlzKCk6CglvcGNhbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCdjYW5haXNWaWV3MicpCglpZiBvcGNhbyA9PSAnMCc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MCkiKQoJZWxpZiBvcGNhbyA9PSAnMSc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MSkiKQoJZWxpZiBvcGNhbyA9PSAnMic6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDApIikKCWVsaWYgb3BjYW8gPT0gJzMnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA5KSIpCgllbGlmIG9wY2FvID09ICczJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwOCkiKQoJZWxpZiBvcGNhbyA9PSAnNCc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDQpIikKCWVsaWYgb3BjYW8gPT0gJzUnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTAzKSIpCgllbGlmIG9wY2FvID09ICc2JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUxNSkiKQoJZWxpZiBvcGNhbyA9PSAnNyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1NSkiKQoKZGVmIHZpc3RhX21lbnUoKToKCW9wY2FvID0gX19BRERPTl9fLmdldFNldHRpbmcoJ21lbnVWaWV3JykKCWlmIG9wY2FvID09ICcwJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwKSIpCgllbGlmIG9wY2FvID09ICcxJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUxKSIpCgllbGlmIG9wY2FvID09ICcyJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwMCkiKQoJZWxpZiBvcGNhbyA9PSAnMyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDkpIikKCWVsaWYgb3BjYW8gPT0gJzMnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA4KSIpCgllbGlmIG9wY2FvID09ICc0JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwNCkiKQoJZWxpZiBvcGNhbyA9PSAnNSc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDMpIikKCWVsaWYgb3BjYW8gPT0gJzYnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTE1KSIpCgllbGlmIG9wY2FvID09ICc3JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDU1KSIpCgpkZWYgdmlzdGFfZmlsbWVzU2VyaWVzKCk6CglvcGNhbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCdmaWxtZXNTZXJpZXNWaWV3JykKCWlmIG9wY2FvID09ICcwJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwKSIpCgllbGlmIG9wY2FvID09ICcxJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUxKSIpCgllbGlmIG9wY2FvID09ICcyJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwMCkiKQoJZWxpZiBvcGNhbyA9PSAnMyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDkpIikKCWVsaWYgb3BjYW8gPT0gJzMnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA4KSIpCgllbGlmIG9wY2FvID09ICc0JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwNCkiKQoJZWxpZiBvcGNhbyA9PSAnNSc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDMpIikKCWVsaWYgb3BjYW8gPT0gJzYnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTE1KSIpCgllbGlmIG9wY2FvID09ICc3JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDU1KSIpCgoKZGVmIHZpc3RhX3RlbXBvcmFkYXMoKToKCW9wY2FvID0gX19BRERPTl9fLmdldFNldHRpbmcoJ3RlbXBvcmFkYXNWaWV3JykKCWlmIG9wY2FvID09ICcwJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwKSIpCgllbGlmIG9wY2FvID09ICcxJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUxKSIpCgllbGlmIG9wY2FvID09ICcyJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwMCkiKQoJZWxpZiBvcGNhbyA9PSAnMyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDkpIikKCWVsaWYgb3BjYW8gPT0gJzMnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA4KSIpCgllbGlmIG9wY2FvID09ICc0JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwNCkiKQoJZWxpZiBvcGNhbyA9PSAnNSc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDMpIikKCWVsaWYgb3BjYW8gPT0gJzYnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTE1KSIpCgllbGlmIG9wY2FvID09ICc3JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDU1KSIpCgpkZWYgdmlzdGFfZXBpc29kaW9zKCk6Cgl4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTApIikKCSNvcGNhbyA9IF9fQURET05fXy5nZXRTZXR0aW5nKCdlcGlzb2Rpb3NWaWV3JykKCWlmIG9wY2FvID09ICcwJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwKSIpCgllbGlmIG9wY2FvID09ICcxJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUxKSIpCgllbGlmIG9wY2FvID09ICcyJzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwMCkiKQoJZWxpZiBvcGNhbyA9PSAnMyc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDkpIikKCWVsaWYgb3BjYW8gPT0gJzMnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTA4KSIpCgllbGlmIG9wY2FvID09ICc0JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDUwNCkiKQoJZWxpZiBvcGNhbyA9PSAnNSc6IHhibWMuZXhlY3V0ZWJ1aWx0aW4oIkNvbnRhaW5lci5TZXRWaWV3TW9kZSg1MDMpIikKCWVsaWYgb3BjYW8gPT0gJzYnOiB4Ym1jLmV4ZWN1dGVidWlsdGluKCJDb250YWluZXIuU2V0Vmlld01vZGUoNTE1KSIpCgllbGlmIG9wY2FvID09ICc3JzogeGJtYy5leGVjdXRlYnVpbHRpbigiQ29udGFpbmVyLlNldFZpZXdNb2RlKDU1KSIpCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojCQkJCQkJCQkJCQkJR0VUIFBBUkFNUwkJCQkJCQkJCQkJCSAjCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwkJICAKZGVmIGdldF9wYXJhbXMoKToKCXBhcmFtPVtdCglwYXJhbXN0cmluZz1zeXMuYXJndlsyXQoJaWYgbGVuKHBhcmFtc3RyaW5nKT49MjoKCQlwYXJhbXM9c3lzLmFyZ3ZbMl0KCQljbGVhbmVkcGFyYW1zPXBhcmFtcy5yZXBsYWNlKCc/JywnJykKCQlpZiAocGFyYW1zW2xlbihwYXJhbXMpLTFdPT0nLycpOiBwYXJhbXM9cGFyYW1zWzA6bGVuKHBhcmFtcyktMl0KCQlwYWlyc29mcGFyYW1zPWNsZWFuZWRwYXJhbXMuc3BsaXQoJyYnKQoJCXBhcmFtPXt9CgkJZm9yIGkgaW4gcmFuZ2UobGVuKHBhaXJzb2ZwYXJhbXMpKToKCQkJc3BsaXRwYXJhbXM9e30KCQkJc3BsaXRwYXJhbXM9cGFpcnNvZnBhcmFtc1tpXS5zcGxpdCgnPScpCgkJCWlmIChsZW4oc3BsaXRwYXJhbXMpKT09MjogcGFyYW1bc3BsaXRwYXJhbXNbMF1dPXNwbGl0cGFyYW1zWzFdCglyZXR1cm4gcGFyYW0KCgpwYXJhbXM9Z2V0X3BhcmFtcygpCnVybD1Ob25lCmJ1aWxkdGlwbz1Ob25lCm5hbWU9Tm9uZQptb2RlPU5vbmUKbW9kbz1Ob25lCmljb25pbWFnZT1Ob25lCmxpbms9Tm9uZQpzZW5oYT1Ob25lCmVzdGlsbz1Ob25lCnNydGZpbG09Tm9uZQppZENhbmFsPU5vbmUKaWRmZkNhbmFsPU5vbmUKdGlwb2xvZ2lhPU5vbmUKZGVzY3JpY2FvPU5vbmUKdGlwb191c2VyPU5vbmUKc2Vydmlkb3JfdXNlcj1Ob25lCmRhdGFfdXNlcj1Ob25lCnNfc2Vydj1Ob25lCnRpcG89Tm9uZQpzX3VzZXI9Tm9uZQpzX3Bhc3M9Tm9uZQpsZWdlbmRhPU5vbmUKcGFnaW5hPU5vbmUKdGVtcG9yYWRhPU5vbmUKZXBpc29kaW89Tm9uZQpzZXJpZU5vbWU9Tm9uZQpmYW5hcnQ9Tm9uZQp0aHVtYm5haWw9Tm9uZQpzdHJlYW1faWQ9Tm9uZQpkdXJhdGlvbj1Ob25lCnRpcG9zZWxlY3Q9Tm9uZQpiYWNrZ3JvdW5kPU5vbmUKaW5mbz1Ob25lCmxvZ29zPU5vbmUKY2FjaGU9Tm9uZQppbmRleD1Ob25lCm1vdmU9Tm9uZQptZXRhaD1Ob25lCnBsb3Q9Tm9uZQoKdHJ5OiAKCWxvZ29zPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJsb2dvcyJdKQpleGNlcHQ6IAoJcGFyYW1zID0gZGljdCh1cmxwYXJzZS5wYXJzZV9xc2woc3lzLmFyZ3ZbMl0ucmVwbGFjZSgnPycsJycpKSkKCWxvZ29zID0gcGFyYW1zLmdldCgnbG9nb3MnLCAnJykKCnRyeTogCgljYWNoZT11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1siY2FjaGUiXSkKZXhjZXB0OiAKCXBhcmFtcyA9IGRpY3QodXJscGFyc2UucGFyc2VfcXNsKHN5cy5hcmd2WzJdLnJlcGxhY2UoJz8nLCcnKSkpCgljYWNoZSA9IHBhcmFtcy5nZXQoJ2NhY2hlJywgJycpCgp0cnk6IAoJaW5kZXg9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImluZGV4Il0pCmV4Y2VwdDogCglwYXJhbXMgPSBkaWN0KHVybHBhcnNlLnBhcnNlX3FzbChzeXMuYXJndlsyXS5yZXBsYWNlKCc/JywnJykpKQoJaW5kZXggPSBwYXJhbXMuZ2V0KCdpbmRleCcsICcnKQoKdHJ5OiAKCW1vdmU9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbIm1vdmUiXSkKZXhjZXB0OiAKCXBhcmFtcyA9IGRpY3QodXJscGFyc2UucGFyc2VfcXNsKHN5cy5hcmd2WzJdLnJlcGxhY2UoJz8nLCcnKSkpCgltb3ZlID0gcGFyYW1zLmdldCgnbW92ZScsICcnKQoKdHJ5OiAKCW1ldGFoPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJtZXRhaCJdKQpleGNlcHQ6IAoJcGFyYW1zID0gZGljdCh1cmxwYXJzZS5wYXJzZV9xc2woc3lzLmFyZ3ZbMl0ucmVwbGFjZSgnPycsJycpKSkKCW1ldGFoID0gcGFyYW1zLmdldCgnbWV0YWgnLCAnJykKCnRyeTogCgliYWNrZ3JvdW5kPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJiYWNrZ3JvdW5kIl0pCmV4Y2VwdDogCglwYXJhbXMgPSBkaWN0KHVybHBhcnNlLnBhcnNlX3FzbChzeXMuYXJndlsyXS5yZXBsYWNlKCc/JywnJykpKQoJYmFja2dyb3VuZCA9IHBhcmFtcy5nZXQoJ2JhY2tncm91bmQnLCAnJykKCnRyeTogCglpbmZvPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJpbmZvIl0pCmV4Y2VwdDogCglwYXJhbXMgPSBkaWN0KHVybHBhcnNlLnBhcnNlX3FzbChzeXMuYXJndlsyXS5yZXBsYWNlKCc/JywnJykpKQoJaW5mbyA9IHBhcmFtcy5nZXQoJ2luZm8nLCAnJykKCnRyeTogdGlwbz1wYXJhbXNbInRpcG8iXQpleGNlcHQ6IHBhc3MKdHJ5OiBkdXJhdGlvbj11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1siZHVyYXRpb24iXSkKZXhjZXB0OiBwYXNzCnRyeTogc3RyZWFtX2lkPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJzdHJlYW1faWQiXSkKZXhjZXB0OiBwYXNzCnRyeTogdXJsPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJ1cmwiXSkKZXhjZXB0OiBwYXNzCnRyeTogbmFtZT11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sibmFtZSJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBlc3RpbG89dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImVzdGlsbyJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBtb2RlPWludChwYXJhbXNbIm1vZGUiXSkKZXhjZXB0OiBwYXNzCnRyeTogbW9kbz1wYXJhbXNbIm1vZG8iXQpleGNlcHQ6IHBhc3MKdHJ5OiBpY29uaW1hZ2U9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImljb25pbWFnZSJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBzZW5oYT11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sic2VuaGEiXSkKZXhjZXB0OiBwYXNzCnRyeTogaWRDYW5hbD11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1siaWRDYW5hbCJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBpZGZmQ2FuYWw9cGFyYW1zWyJpZGZmQ2FuYWwiXQpleGNlcHQ6IHBhc3MKdHJ5OiBzcnRmaWxtPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJzcnRmaWxtIl0pCmV4Y2VwdDogcGFzcwp0cnk6IHRpcG9sb2dpYT11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sidGlwb2xvZ2lhIl0pCmV4Y2VwdDogcGFzcwp0cnk6IGRlc2NyaWNhbz11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1siZGVzY3JpY2FvIl0pCmV4Y2VwdDogcGFzcwp0cnk6IHRpcG9fdXNlcj11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sidGlwb191c2VyIl0pCmV4Y2VwdDogcGFzcwp0cnk6IHNlcnZpZG9yX3VzZXI9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbInNlcnZpZG9yX3VzZXIiXSkKZXhjZXB0OiBwYXNzCnRyeTogc19zZXJ2PXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJsb2xzZXJ2Il0pCmV4Y2VwdDogcGFzcwp0cnk6IHNfdXNlcj11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sibG9sdXNlciJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBzX3Bhc3M9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImxvbHBhc3MiXSkKZXhjZXB0OiBwYXNzCnRyeTogbGluaz11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sibGluayJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBsZWdlbmRhPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJsZWdlbmRhIl0pCmV4Y2VwdDogcGFzcwp0cnk6IG5hbWU9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbIm5hbWUiXSkKZXhjZXB0OiBwYXNzCnRyeTogdGVtcG9yYWRhPWludChwYXJhbXNbInRlbXBvcmFkYSJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBlcGlzb2Rpbz1pbnQocGFyYW1zWyJlcGlzb2RpbyJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBtb2RlPWludChwYXJhbXNbIm1vZGUiXSkKZXhjZXB0OiBwYXNzCnRyeTogcGFnaW5hPWludChwYXJhbXNbInBhZ2luYSJdKQpleGNlcHQ6IHBhc3MKdHJ5OiBpY29uaW1hZ2U9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImljb25pbWFnZSJdKQpleGNlcHQ6IHBhc3MKdHJ5IDogc2VyaWVOb21lPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJzZXJpZU5vbWUiXSkKZXhjZXB0OiBwYXNzCnRyeSA6IGJ1aWxkdGlwbz11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1siYnVpbGR0aXBvIl0pCmV4Y2VwdDogcGFzcwp0cnkgOiBmYW5hcnQ9dXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbXNbImZhbmFydCJdKQpleGNlcHQ6IHBhc3MKdHJ5IDogcGxvdD11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1sicGxvdCJdKQpleGNlcHQ6IHBhc3MKdHJ5IDogdGh1bWJuYWlsPXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJ0aHVtYm5haWwiXSkKZXhjZXB0OiBwYXNzCnRyeSA6IGRhdGFfdXNlcj11cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtc1siZGF0YV91c2VyIl0pCmV4Y2VwdDogcGFzcwp0cnkgOiB0aXBvc2VsZWN0PXVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1zWyJ0aXBvc2VsZWN0Il0pCmV4Y2VwdDogcGFzcwoKCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIwkJCQkJCQkJCQkJCQlNT0RPUwkJCQkJCQkJCQkJCQkgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKaWYgbW9kZT09Tm9uZSBvciB1cmw9PU5vbmUgb3IgbGVuKHVybCk8MTogbWVudSgpCmVsaWYgbW9kZT09MTogYWJyaXJWaWRlb0NsdWJlKHN0cih1cmwpKQplbGlmIG1vZGU9PTEwMTogbGlzdGFyX2dydXBvczEobW9kZSx1cmwsZmFuYXJ0KQplbGlmIG1vZGU9PTEwMjogbGlzdGFyX2dydXBvczIobW9kZSx1cmwsZmFuYXJ0KQplbGlmIG1vZGU9PTEwMzogbGlzdGFyX2dydXBvczMobW9kZSx1cmwsZmFuYXJ0KQplbGlmIG1vZGU9PTEwNDogbGlzdGFyX2dydXBvczQobW9kZSx1cmwsaWNvbmltYWdlLGZhbmFydCkKZWxpZiBtb2RlPT0xMDY6IGFicmlyRXh0cmFzKCkKZWxpZiBtb2RlPT0xMDc6IGxpc3Rhcl9ncnVwb3M1KG1vZGUsdXJsLGZhbmFydCkKZWxpZiBtb2RlPT0xMDg6IGxpc3Rhcl9ncnVwb3M2KG1vZGUsdXJsLGljb25pbWFnZSxmYW5hcnQpCmVsaWYgbW9kZT09MTA5OiBwbGF5X211bHRfY2FuYWwyKHVybCxpY29uaW1hZ2Usc3RyKG5hbWUpKQplbGlmIG1vZGU9PTI6IEFicmlyX0NvbnRhKHN0cih1cmwpKQplbGlmIG1vZGU9PTM6IGFicmltM3Uoc3RyKHVybCkpCmVsaWYgbW9kZT09NDogZGV0ZWN0X21vZGlmaWNhdGlvbihzdHIodXJsKSkKZWxpZiBtb2RlPT01OiBhYnJpckRlZmluaW5jb2VzKCkKZWxpZiBtb2RlPT02OiBsaXN0YXR2YXJjaGl2ZShzdHIodXJsKSkKZWxpZiBtb2RlPT03OiBsaXN0YXR2YXJjaGl2ZWNhbmFpcyhzdHIobmFtZSksc3RyZWFtX2lkLHN0cih1cmwpLGR1cmF0aW9uLGljb25pbWFnZSxmYW5hcnQpCmVsaWYgbW9kZT09ODogc3RyZWFtX3ZpZGVvKG5hbWUsdXJsLGljb25pbWFnZSkKZWxpZiBtb2RlPT05OiBnZXRfbXlhY2NvdW50KG5hbWUsdXJsLGljb25pbWFnZSkKZWxpZiBtb2RlPT0xMDogcnVuX2Nyb25qb2IobmFtZSxzdHIodXJsKSxpY29uaW1hZ2UscGxvdCxmYW5hcnQpCmVsaWYgbW9kZT09MTE6IFBsYXlVcmwobmFtZSx1cmwsaWNvbmltYWdlKQplbGlmIG1vZGU9PTEzOiBDTEVBUkNBQ0hFKCkKZWxpZiBtb2RlPT0xNDogUFVSR0VQQUNLQUdFUygpCmVsaWYgbW9kZT09MjA6IGxpc3RhbWVudXNzZXJpZXMoc3RyKG5hbWUpLHN0cih1cmwpLGVzdGlsbyx0aXBvbG9naWEsdGlwb191c2VyLHNlcnZpZG9yX3VzZXIsaWNvbmltYWdlLGZhbmFydCkKZWxpZiBtb2RlPT0yMTogbGlzdGFtZW51c2ZpbG1lcyhzdHIobmFtZSksc3RyKHVybCksZXN0aWxvLHRpcG9sb2dpYSx0aXBvX3VzZXIsc2Vydmlkb3JfdXNlcixpY29uaW1hZ2UsZmFuYXJ0KQplbGlmIG1vZGU9PTI0OiBsaXN0YW1lbnVzYW5pbWVzKHN0cihuYW1lKSxzdHIodXJsKSxlc3RpbG8sdGlwb2xvZ2lhLHRpcG9fdXNlcixzZXJ2aWRvcl91c2VyLGljb25pbWFnZSxmYW5hcnQpCmVsaWYgbW9kZT09MTExMTE6IGZpbG1lczIodXJsKQplbGlmIG1vZGU9PTExMTEyOiBzZXJpZXMyKHVybCkKZWxpZiBtb2RlPT0xMTExMzogcGxheWVyMihuYW1lLCB1cmwsIGljb25pbWFnZSwgbW9kbywgdGVtcG9yYWRhLCBlcGlzb2RpbywgdGlwbykKZWxpZiBtb2RlPT0xMTExNDogZ2V0U2Vhc29uczIodXJsLCBtb2RvKQplbGlmIG1vZGU9PTExMTE1OiBnZXRFcGlzb2RlczIodXJsKQplbGlmIG1vZGU9PTExMTE4OiBnZXRZZWFyc19saXZlKHVybCwgbW9kbykKZWxpZiBtb2RlPT0xMTExOTogZ2V0R2VuZXJvc19saXZlKHVybCwgbW9kbykKZWxpZiBtb2RlPT0xMTExOTk6IGdldEdlbmVyb3MyX2xpdmUodXJsLCBtb2RvKQplbGlmIG1vZGU9PTExMTIwOiBwZXNxdWlzYV9saXZlKHVybCwgbW9kbykKZWxpZiBtb2RlPT0xMTEyMTogZ2V0SW5mb19saXZlKHVybCwgbW9kbykKZWxpZiBtb2RlPT0yMTExMTogbGlzdGFtZW51c19saXZlaXQxKCkKZWxpZiBtb2RlPT0yMTExMjogbGlzdGFtZW51c19saXZlaXQyKCkKZWxpZiBtb2RlPT0xMTE6IGZpbG1lcyh1cmwsIHBhZ2luYSkKZWxpZiBtb2RlPT0xMjM6IHNlcmllcyh1cmwpCmVsaWYgbW9kZT09MTE4OiBnZXRHZW5lcm9zKHVybCkKZWxpZiBtb2RlPT0xMTk6IGdldFllYXJzKHVybCkKZWxpZiBtb2RlPT0xMjA6IHBlc3F1aXNhKHVybCkKZWxpZiBtb2RlPT0xMjE6IGFub3ModXJsKQplbGlmIG1vZGU9PTEyMjogY2F0ZWdvcmlhcyh1cmwpCmVsaWYgbW9kZT09MTEzOiBwbGF5ZXIobmFtZSwgdXJsLCBpY29uaW1hZ2UsIHRlbXBvcmFkYSwgZXBpc29kaW8sIHNlcmllTm9tZSkKZWxpZiBtb2RlPT0xMTQ6IGdldFNlYXNvbnModXJsKQplbGlmIG1vZGU9PTExNTogZ2V0RXBpc29kZXModXJsKQplbGlmIG1vZGU9PTExNzogZG93bmxvYWQodXJsLCBuYW1lLCB0ZW1wb3JhZGEsIGVwaXNvZGlvLCBzZXJpZU5vbWUpCmVsaWYgbW9kZT09MzE6IHByb2dyYW1hY2FvX2NhbmFsKGlkQ2FuYWwpCmVsaWYgbW9kZSA9PSAzMjoKCVBsYXlVcmwyKG5hbWUsIHVybCwgaWNvbmltYWdlKQoKaWYgbW9kZT09Tm9uZSBvciB1cmw9PU5vbmUgb3IgbGVuKHVybCk8MToKCXhibWNwbHVnaW4uZW5kT2ZEaXJlY3RvcnkoaW50KHN5cy5hcmd2WzFdKSxjYWNoZVRvRGlzYz1GYWxzZSkKZWxzZToKCWlmIG1vZGUgIT0zIGFuZCBtb2RlICE9NiBhbmQgbW9kZSAhPTc6IAoJCXhibWNwbHVnaW4uZW5kT2ZEaXJlY3RvcnkoaW50KHN5cy5hcmd2WzFdKSxjYWNoZVRvRGlzYz1GYWxzZSkKCWVsc2U6IAoJCXhibWNwbHVnaW4uZW5kT2ZEaXJlY3RvcnkoaW50KHN5cy5hcmd2WzFdKSxjYWNoZVRvRGlzYz1UcnVlKQ=="))